import{m as je,a as Me,n as Se,b as Ve,c as qe,d as Le,l as ee,_ as Ne,e as Be,f as Ue}from"./mj_v3-1691429277723.js";import{d as He,aK as De,k as Re,g as m,aY as J,aL as Ae,bq as Pe,Q as Je,br as Ee,o as r,a as _,aw as o,f as l,w as n,u as a,bs as b,F as L,aE as N,ax as ve,aQ as Fe,az as x,ay as h,aI as Oe,e as E,n as fe,b as v,bt as Ge,q as Ke,bu as Qe,bv as Ye,bb as We,b0 as Xe,aU as Ze,b5 as et,be as tt,bi as lt,bj as nt,_ as st}from"./index-1691429277723.js";import{l as ot}from"./lodash-1691429277723.js";import{g as te,u as at,d as it,c as ct}from"./chat-1691429277723.js";import{b as rt,a as dt}from"./Tabs-1691429277723.js";import{_ as ut,a as _t}from"./Grid-1691429277723.js";import{_ as pt}from"./Scrollbar-1691429277723.js";import{N as mt,_ as vt}from"./Icon-1691429277723.js";import{_ as ft,a as gt}from"./Upload-1691429277723.js";import{_ as ht}from"./Spin-1691429277723.js";import"./Add-1691429277723.js";const w=D=>(lt("data-v-3a381cb6"),D=D(),nt(),D),yt={class:"mx-auto draw_container"},bt={class:"topTitle_box"},xt=w(()=>o("div",{class:"title"},"选择模型",-1)),wt=w(()=>o("span",null,"使用说明",-1)),kt={class:"model_list"},zt=["title","onClick"],$t=["alt"],Ct={class:"model_label"},It=w(()=>o("div",{class:"title"},"图片比例",-1)),Tt={class:"proportion_list"},jt=["onClick"],Mt={style:{"margin-left":"3px"}},St={class:"other_arg"},Vt={class:"arg_item"},qt=w(()=>o("div",{class:"arg_title"},"随机抽象",-1)),Lt={class:"arg_value"},Nt={class:"arg_item"},Bt=w(()=>o("div",{class:"arg_title"},"艺术程度",-1)),Ut={class:"arg_value"},Ht={class:"arg_item"},Dt=w(()=>o("div",{class:"arg_title"},"图片质量",-1)),Rt={class:"arg_value"},At={class:"arg_item",style:{height:"80px"}},Pt=w(()=>o("div",{class:"arg_title"},"基于图片生成",-1)),Jt={class:"arg_value"},Et=w(()=>o("div",{style:{"font-size":"12px","margin-top":"5px"}},"图片上传",-1)),Ft={key:0,class:"img_box"},Ot={class:"top_input"},Gt={class:"btn_box"},Kt={class:"bottom_input"},Qt={class:"prod_btn"},Yt={class:"work_box"},Wt={key:0,style:{flex:"1"}},Xt={key:0,class:"empty_box"},Zt=w(()=>o("div",{style:{width:"100%","text-align":"center","margin-top":"6px","font-weight":"400"}},"你还没作品，请创作你的神作吧！",-1)),el=["onClick"],tl={key:1,style:{flex:"1"}},ll={key:0,class:"empty_box"},nl=w(()=>o("div",{style:{width:"100%","text-align":"center","margin-top":"6px","font-weight":"400"}},"还没有优秀作品，请创作你的神作吧！",-1)),sl={key:2,style:{flex:"1"}},ol={key:0,class:"empty_box"},al=w(()=>o("div",{style:{width:"100%","text-align":"center","margin-top":"6px","font-weight":"400"}},"没有作品等待中，请创作你的神作吧！",-1)),il=["onClick"],cl=He({__name:"index",setup(D){const{drew_introduce:ge,midj_cdn:V,img_bed_url:le}=De(),q=Re(),ne=m(0),B=m(""),U=m(""),C=m("person"),F=J({}),O=Ae(),I=m(null),y=m([]),k=m([]),G=m([]);let se=m(null),H=m(-1);const c=J({model:"--v 5",img:"",ar:"--ar 1:1",stylize:100,chaos:1,q:1}),T=m("small"),z=m("small"),K=J({models:[{title:"Midj Version5",label:"MJ V5",value:"--v 5",img:je},{title:"Niji version5",label:"NIJI V5",value:"--niji 5",img:Me},{title:"Midj Version5.1",label:"MJ V5.1",value:"--v 5.1",img:Se},{title:"Niji version4",label:"NIJI V4",value:"--niji 4",img:Ve},{title:"Midj Version4",label:"MJ V4",value:"--v 4",img:qe},{title:"Midj Version3",label:"MJ V3",value:"--v 3",img:Le}],ars:[{label:"1:1",value:"--ar 1:1",icon:"tabler:square"},{label:"4:3",value:"--ar 4:3",icon:"tabler:rectangle"},{label:"3:4",value:"--ar 3:4",icon:"tabler:rectangle-vertical"},{label:"16:9",value:"--ar 16:9",icon:"lucide:rectangle-horizontal"},{label:"9:16",value:"--ar 9:16",icon:"lucide:rectangle-vertical"}]}),p=J({main:!1,showGpt:!0,upload:!1,percent:0}),Q=m([]);let R=Pe.get("token"),oe=window.innerHeight;const ae=()=>{let s=window.innerHeight;if(oe!=s){oe=s;let e=I.value.offsetHeight;e>750?(T.value="large",z.value="medium",I.value.classList.add("large_left")):e>720?(T.value="large",z.value="medium",I.value.classList.remove("large_left")):e>700?(T.value="large",z.value="small",I.value.classList.remove("large_left")):e>680?(T.value="medium",z.value="small",I.value.classList.remove("large_left")):(T.value="small",z.value="small",I.value.classList.remove("large_left"))}else return};let he=ot.debounce(ae,100);Je(()=>{ae(),window.addEventListener("resize",he)});const ye=s=>{ne.value=s,c.ar=K.ars[s].value},Y=(s,e)=>i=>{let d=i.target.value;d<s?c.chaos=1:d>e&&(c.chaos=100)},ie=s=>{let e=s=="right"?233:-233;se.value.scrollBy({left:e,behavior:"smooth"})},be=({file:s,onFinish:e})=>{p.upload=!0;const i=new FormData;i.append("file",s.file),Ge(le,{method:"post",data:i,headers:{"content-type":"multipart/form-data",Authentication:R,token:R},onUploadProgress:d=>{p.percent=d.loaded/d.total*100}}).then(d=>{var u;c.img="",c.img=d.data.data.links.url,(u=window.$message)==null||u.success("上传成功"),e()}).finally(()=>{p.upload=!1,Q.value.length=0})},xe=()=>{var s;(s=window.$dialog)==null||s.info({title:"使用说明",content:()=>Ke("div",{innerHTML:ge}),positiveText:"确定"})},we=async s=>{await te(s).then(e=>{const i=y.value.findIndex(d=>d.id===s);i>-1&&(e.data[0].status==="成功"||e.data[0].status==="失败"?(k.value.unshift(e.data[0]),y.value.splice(i,1),C.value="person"):y.value.splice(i,1,e.data[0]))})};setInterval(()=>{if(location.href.indexOf("draw")!==-1)for(const s of y.value)F[s.id]||(F[s.id]=!0,we(s.id).then(()=>{setTimeout(()=>{F[s.id]=!1},1e3)}))},1e3);const ke=(s,e,i)=>{var d;e==="成功"||i==="retry"?at(s,i).then(u=>{var j;(j=window.$message)==null||j.success("操作成功");const f=k.value.findIndex(W=>W.id===s);f>-1&&k.value.splice(f,1),u.data.status==="成功"?k.value.unshift(u.data):y.value.unshift(u.data)}):(d=window.$message)==null||d.error("操作失败，当前任务状态不是成功")},ce=(s,e=0)=>{it(s).then(()=>{var i;if((i=window.$message)==null||i.success("删除成功"),e===0){const d=k.value.findIndex(u=>u.id===s);d>-1&&k.value.splice(d,1)}else{const d=y.value.findIndex(u=>u.id===s);d>-1&&y.value.splice(d,1)}})},re=(s=0,e={},i={})=>{var d,u;if(B.value.trim()||s!==0){if(!U.value.trim()){(d=window.$message)==null||d.warning("请点击优化或翻译");return}C.value="wait";let f=`${U.value} ${c.model} ${c.ar}`;s===0?(c.stylize&&c.stylize!==100&&(f+=` --stylize ${c.stylize}`),c.chaos&&c.chaos!==1&&(f+=` --chaos ${c.chaos}`),c.q&&c.q!==1&&(f+=` --q ${c.q}`),c.img&&(f=`${c.img} ${f}`)):f=e.content,p.main=!0,s===1&&(i.task=e.id,i.message_id=e.message_id),ct(f,s,i).then(j=>{j.data&&y.value.unshift(j.data)}).finally(()=>{p.main=!1})}else(u=window.$message)==null||u.info("请输入Prompt")};te("","public").then(s=>{s.data.forEach(e=>{G.value.push(e)})}),te().then(s=>{s.data.forEach(e=>{e.status==="成功"||e.status==="失败"?k.value.push(e):y.value.unshift(e)})});const de=s=>{var i;const e=document.createElement("textarea");e.value=s,document.body.appendChild(e),e.select(),document.execCommand("copy")&&(document.execCommand("copy"),(i=window.$message)==null||i.success("复制成功")),document.body.removeChild(e)};async function ue(s){p.main=!0;let e="";H.value=s,s===0?e=`你需要为我生成AI绘画提示词，回答的形式是：
		(image we're prompting), (7 descriptivekeywords), (time of day), (Hd degree).
		这是一段段按照上述形式的示例问答：
		问题：
		参考以上midjoruney prompt formula写1个midjourney prompt内容，用英文回复，不要括号，内容：宫崎骏风格的春天小镇
		回答：
		英文：Miyazaki Hayao-style town,Green willow and red flowers, breeze coming, dreamy colors, fantastic elements, fairy-tale situation, warm breath, shooting in the evening, 4K ultra HD
		现在严格参考以上的示例回答形式和风格（这很重要），根据以下的内容生成提示词(直接以英文输出，需要补全):${B.value}`:e=`下面我让你来充当翻译家，你的目标是把任何语言翻译成英文，请翻译时不要带翻译腔，而是要翻译得自然、流畅和地道，使用优美和高雅的表达方式并且不需要解释，直接告诉我答案。请翻译下面这句话：“${B.value}”`,Qe.post("chat/gpt/",{list:[{content:e,role:"user"}],prompt:e},{onDownloadProgress:i=>{var d,u;i.currentTarget.response.indexOf("购买套餐")!==-1?(d=window.$dialog)==null||d.info({title:"提示",content:"套餐余额不足啦，快来购买一点吧？",positiveText:"购买",negativeText:"免费领取",onPositiveClick:()=>{O.push({name:"pay"})},onNegativeClick:()=>{O.push({name:"invite"})}}):i.currentTarget.response.indexOf("可前往登录体验完整功能")!==-1&&((u=window.$dialog)==null||u.info({title:"提示",content:"试用电力试用完啦，快来注册登录使用吧？",positiveText:"登录",onPositiveClick:()=>{O.push({name:"login"})}})),U.value=i.currentTarget.response}}).finally(()=>{p.main=!1})}return(s,e)=>{const i=pt,d=Ne,u=Be,f=mt,j=ft,W=gt,ze=ht,M=Ye,_e=We,A=Xe,X=rt,$e=dt,pe=vt,me=Ue,$=ut,S=Ze,P=_t,Z=et,Ce=tt,Ie=Ee("lazy");return r(),_("div",yt,[o("div",{class:"left_box",ref_key:"leftBoxRef",ref:I,style:fe({backgroundColor:a(q).darkMode?"#18181c":"#fff",boxShadow:a(q).darkMode?"":"0px 0px 6px 0px #e5e5e5",border:a(q).darkMode?"1px solid #2d2d30":"1px solid #e5e5e5"})},[l(i,{class:"left_scroll",trigger:"hover"},{default:n(()=>[o("div",bt,[xt,o("div",{class:"use_illustrate",onClick:xe},[l(a(b),{icon:"ep:info-filled",width:"18",height:"18"}),wt])]),l(i,{"x-scrollable":"",style:{height:"105px",position:"relative"},trigger:"none",class:"models_scrollbar",ref_key:"modelScrollRef",ref:se},{default:n(()=>[o("div",kt,[(r(!0),_(L,null,N(K.models,t=>(r(),_("div",{key:t.value,class:ve(["model_item",{model_active:c.model==t.value}]),title:t.title,onClick:g=>c.model=t.value},[Fe(o("img",{alt:t.label},null,8,$t),[[Ie,t.img]]),o("span",Ct,x(t.label),1)],10,zt))),128))]),o("span",{class:"pre_btn",onClick:e[0]||(e[0]=t=>ie("left"))},[l(a(b),{icon:"mingcute:left-fill",width:"24",height:"24"})]),o("span",{class:"next_btn",onClick:e[1]||(e[1]=t=>ie("right"))},[l(a(b),{icon:"mingcute:right-fill",width:"24",height:"24"})])]),_:1},512),It,o("div",Tt,[(r(!0),_(L,null,N(K.ars,(t,g)=>(r(),_("div",{class:ve(["proportion_item",{proportion_active:ne.value==g}]),key:t.label,onClick:Te=>ye(g)},[l(a(b),{icon:t.icon,width:"24",height:"24"},null,8,["icon"]),o("span",Mt,x(t.label),1)],10,jt))),128))]),o("div",St,[o("div",Vt,[qt,o("div",Lt,[l(d,{value:c.chaos,"onUpdate:value":e[2]||(e[2]=t=>c.chaos=t),min:1,max:100,size:z.value,"on-blur":Y(1,100)},null,8,["value","size","on-blur"])])]),o("div",Nt,[Bt,o("div",Ut,[l(d,{value:c.stylize,"onUpdate:value":e[3]||(e[3]=t=>c.stylize=t),min:100,max:1e3,size:z.value,"on-blur":Y(100,1e3)},null,8,["value","size","on-blur"])])]),o("div",Ht,[Dt,o("div",Rt,[l(d,{value:c.q,"onUpdate:value":e[4]||(e[4]=t=>c.q=t),min:.25,max:2,step:.1,size:z.value,"on-blur":Y(.25,2)},null,8,["value","size","on-blur"])])]),o("div",At,[Pt,o("div",Jt,[l(ze,{show:p.upload},{description:n(()=>[h(x(p.percent.toFixed(2))+"% ",1)]),default:n(()=>[l(W,{"file-list":Q.value,"onUpdate:fileList":e[5]||(e[5]=t=>Q.value=t),style:{height:"80px",width:"80px"},"file-list-style":"display:none","directory-dnd":"",action:a(le),max:1,method:"post",name:"image",accept:"image/*",headers:{authentication:a(R)},data:{token:a(R)},"custom-request":be},{default:n(()=>[l(j,{style:{height:"80px"}},{default:n(()=>[o("div",null,[l(f,{size:"48",depth:3},{default:n(()=>[l(u)]),_:1}),Et])]),_:1})]),_:1},8,["file-list","action","headers","data"])]),_:1},8,["show"])]),c.img!=""?(r(),_("div",Ft,[l(M,{src:c.img},null,8,["src"]),o("div",{class:"clearImg_btn",onClick:e[6]||(e[6]=Oe(t=>c.img="",["stop"]))},[l(a(b),{icon:"material-symbols:close"})])])):E("",!0)])]),o("div",Ot,[l(_e,{value:B.value,"onUpdate:value":e[7]||(e[7]=t=>B.value=t),placeholder:"请输入你的创作灵感，如：夕阳下的海边，4个小伙伴围着膏火干杯，此处将调用AI为你优化创作灵感",type:"textarea",round:"",size:T.value},null,8,["value","size"])]),o("div",Gt,[l(A,{loading:p.main&&a(H)==0,disabled:p.main&&a(H)!=0,type:"primary",size:"small",onClick:e[8]||(e[8]=t=>ue(0))},{icon:n(()=>[l(a(b),{icon:"icon-park-outline:smart-optimization"})]),default:n(()=>[h(" 优化 ")]),_:1},8,["loading","disabled"]),l(A,{loading:p.main&&a(H)==1,disabled:p.main&&a(H)!=1,type:"primary",size:"small",onClick:e[9]||(e[9]=t=>ue(1))},{icon:n(()=>[l(a(b),{icon:"mingcute:translate-line"})]),default:n(()=>[h(" 翻译 ")]),_:1},8,["loading","disabled"])]),o("div",Kt,[l(_e,{value:U.value,"onUpdate:value":e[10]||(e[10]=t=>U.value=t),loading:p.main,placeholder:"不出意外的话我应该是自动生成的，但是您如果有魔法咒语的话，可以在此处编辑后直接点击生成图片，如果使用英文将会更好",type:"textarea",round:"",size:T.value},null,8,["value","loading","size"])]),o("div",Qt,[l(A,{type:"primary",size:"medium",onClick:e[11]||(e[11]=t=>re(0))},{icon:n(()=>[l(a(b),{icon:"fa6-regular:image",width:"16",height:"16"})]),default:n(()=>[h(" 生成图片 ")]),_:1})])]),_:1})],4),o("div",{class:"right_box",style:fe({backgroundColor:a(q).darkMode?"#18181c":"#fff",boxShadow:a(q).darkMode?"":"0px 0px 6px 0px #e5e5e5",border:a(q).darkMode?"1px solid #2d2d30":"1px solid #e5e5e5"})},[o("div",Yt,[l($e,{value:C.value,"onUpdate:value":e[12]||(e[12]=t=>C.value=t),class:"mb-12px","justify-content":"space-evenly",type:"line"},{default:n(()=>[l(X,{name:"person",tab:"个人作品展示区"}),l(X,{name:"public",tab:"优秀作品展示区"}),l(X,{name:"wait",tab:"作品等候区"})]),_:1},8,["value"]),C.value==="person"?(r(),_("div",Wt,[l(i,{style:{"min-height":"100%",height:"100px"}},{default:n(()=>[k.value.length==0?(r(),_("div",Xt,[l(a(b),{icon:"icomoon-free:file-empty",width:"32",height:"32"}),Zt])):(r(),v(P,{key:1,id:"wss","item-responsive":"","x-gap":"20","y-gap":"20",cols:12},{default:n(()=>[(r(!0),_(L,null,N(k.value,t=>(r(),v($,{key:t.id,span:"12 400:6 600:4 800:3"},{default:n(()=>[l(Z,{hoverable:""},{header:n(()=>[l(pe,{line:1},{default:n(()=>[o("span",{style:{cursor:"pointer"},onClick:g=>de(t.content)},x(t.content),9,el)]),_:2},1024)]),cover:n(()=>[l(me,{cross:"",rotate:-15,selectable:"","y-offset":28,"font-size":10,height:100,width:100,content:"此内容由AI生成"},{default:n(()=>[t.attachments.length>0?(r(),v(M,{key:0,lazy:"","preview-src":t.attachments[0].url.replace("https://cdn.discordapp.com/",a(V)),src:t.attachments[0].url.replace("https://cdn.discordapp.com/",a(V))},null,8,["preview-src","src"])):(r(),v(M,{key:1,lazy:"",src:a(ee)},null,8,["src"]))]),_:2},1024)]),default:n(()=>[l(P,{style:{"text-align":"center",margin:"10px 0"},"x-gap":10,"y-gap":10,cols:4},{default:n(()=>[(r(!0),_(L,null,N(t.components,g=>(r(),v($,{key:g.label},{default:n(()=>[l(A,{dashed:"",type:"success",size:"small",style:{cursor:"pointer"},onClick:Te=>re(1,t,g)},{default:n(()=>[h(x(g.label),1)]),_:2},1032,["onClick"])]),_:2},1024))),128)),l($,{style:{overflow:"hidden"}},{default:n(()=>[l(S,{type:"success"},{default:n(()=>[h(x(t.message),1)]),_:2},1024)]),_:2},1024),l($,null,{default:n(()=>[l(S,{type:"info"},{default:n(()=>[h(x(t.status),1)]),_:2},1024)]),_:2},1024),l($,null,{default:n(()=>[l(S,{type:"primary",style:{cursor:"pointer"},onClick:g=>ke(t.id,t.status,"public")},{default:n(()=>[h(x(t.public),1)]),_:2},1032,["onClick"])]),_:2},1024),l($,null,{default:n(()=>[l(S,{type:"error",style:{cursor:"pointer"},onClick:g=>ce(t.id)},{default:n(()=>[h("删除")]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1}))]),_:1})])):E("",!0),C.value==="public"?(r(),_("div",tl,[l(i,{style:{"min-height":"100%",height:"100px"}},{default:n(()=>[G.value.length==0?(r(),_("div",ll,[l(a(b),{icon:"icomoon-free:file-empty",width:"32",height:"32"}),nl])):(r(),v(P,{key:1,"item-responsive":"","x-gap":"20","y-gap":"20",cols:4},{default:n(()=>[(r(!0),_(L,null,N(G.value,t=>(r(),v($,{key:t.id,span:"4 400:2 600:2 800:1"},{default:n(()=>[l(Z,{hoverable:""},{cover:n(()=>[l(me,{cross:"",rotate:-15,selectable:"","y-offset":28,"font-size":10,height:100,width:100,content:"此内容由AI生成"},{default:n(()=>[t.attachments.length>0?(r(),v(M,{key:0,lazy:"","preview-src":t.attachments[0].url.replace("https://cdn.discordapp.com/",a(V)),src:t.attachments[0].url.replace("https://cdn.discordapp.com/",a(V))},null,8,["preview-src","src"])):(r(),v(M,{key:1,lazy:"",src:a(ee)},null,8,["src"]))]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1}))]),_:1})])):E("",!0),C.value==="wait"?(r(),_("div",sl,[l(i,{style:{"min-height":"100%",height:"100px"}},{default:n(()=>[y.value.length==0?(r(),_("div",ol,[l(a(b),{icon:"icomoon-free:file-empty",width:"32",height:"32"}),al])):(r(),v(P,{key:1,"item-responsive":"","x-gap":"20","y-gap":"20",cols:"4"},{default:n(()=>[(r(!0),_(L,null,N(y.value,t=>(r(),v($,{key:t.id,span:"4 400:2 600:2 800:1"},{default:n(()=>[l(Z,{hoverable:""},{header:n(()=>[l(pe,{line:1},{default:n(()=>[o("span",{style:{cursor:"pointer"},onClick:g=>de(t.content)},x(t.content),9,il)]),_:2},1024)]),cover:n(()=>[t.attachments.length>0?(r(),v(M,{key:0,lazy:"","preview-src":t.attachments[0].url.replace("https://cdn.discordapp.com/",a(V)),src:t.attachments[0].url.replace("https://cdn.discordapp.com/",a(V))},null,8,["preview-src","src"])):(r(),v(M,{key:1,lazy:"",src:a(ee)},null,8,["src"]))]),default:n(()=>[l(Ce,null,{default:n(()=>[l(S,{type:"success"},{default:n(()=>[h(x(t.message),1)]),_:2},1024),l(S,{type:"info"},{default:n(()=>[h(x(t.status),1)]),_:2},1024),l(S,{type:"error",style:{cursor:"pointer"},onClick:g=>ce(t.id,1)},{default:n(()=>[h("删除")]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1}))]),_:1})])):E("",!0)])],4)])}}});const bl=st(cl,[["__scopeId","data-v-3a381cb6"]]);export{bl as default};

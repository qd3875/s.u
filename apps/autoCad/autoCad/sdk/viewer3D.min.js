/*!
 * LMV v7.67.0
 *
 * Copyright 2022 Autodesk, Inc.
 * All rights reserved.
 *
 * This computer source code and related instructions and comments are the
 * unpublished confidential and proprietary information of Autodesk, Inc.
 * and are protected under Federal copyright and state trade secret law.
 * They may not be disclosed to, copied or used by any third party without
 * the prior written consent of Autodesk, Inc.
 *
 * Autodesk Forge Viewer Usage Limitations:
 *
 * The Autodesk Forge Viewer JavaScript must be delivered from an
 * Autodesk-hosted URL.
 */
var LMV;(()=>{var e,t,r={32263:e=>{e.exports="#if NUM_CUTPLANES > 0\nuniform vec4 cutplanes[NUM_CUTPLANES];\nvoid checkCutPlanes(vec3 worldPosition) {\n    for (int i=0; i<NUM_CUTPLANES; i++) {\n        if (dot(vec4(worldPosition, 1.0), cutplanes[i]) > 0.0) {\n            discard;\n        }\n    }\n}\n#endif\n"},16006:e=>{e.exports="uniform float point_size;"},25334:e=>{e.exports="\nuniform sampler2D tDepth;\nuniform vec4 projInfo;\nuniform float isOrtho;\nuniform mat4 worldMatrix_mainPass;\nvec3 reconstructCSPosition(vec2 fragCoords, float z) {\n    return vec3((fragCoords * projInfo.xy + projInfo.zw) * mix(z, -1.0, isOrtho), z);\n}\nvec3 reconstructWorldPosition(vec2 fragCoords, vec2 screenUv) {\n    float zCam = texture2D(tDepth, screenUv).z;\n    vec3 csPos = reconstructCSPosition(fragCoords, zCam);\n    return (worldMatrix_mainPass * vec4(csPos, 1.0)).xyz;\n}\n"},7246:e=>{e.exports="\nuniform float envRotationSin;\nuniform float envRotationCos;\nvec3 adjustLookupVector(in vec3 lookup) {\n    return vec3(\n            envRotationCos * lookup.x - envRotationSin * lookup.z,\n            lookup.y,\n            envRotationSin * lookup.x + envRotationCos * lookup.z);\n}\nvec3 RGBMDecode(in vec4 vRGBM, in float exposure) {\n    vec3 ret = vRGBM.rgb * (vRGBM.a * 16.0);\n    ret *= ret;\n    ret *= exposure;\n    return ret;\n}\nvec3 GammaDecode(in vec4 vRGBA, in float exposure) {\n    return vRGBA.xyz * vRGBA.xyz * exposure;\n}\nvec3 sampleIrradianceMap(vec3 dirWorld, samplerCube irrMap, float exposure) {\n    vec4 cubeColor4 = textureCube(irrMap, adjustLookupVector(dirWorld));\n#ifdef IRR_GAMMA\n    vec3 indirectDiffuse = GammaDecode(cubeColor4, exposure);\n#elif defined(IRR_RGBM)\n    vec3 indirectDiffuse = RGBMDecode(cubeColor4, exposure);\n#else\n    vec3 indirectDiffuse = cubeColor4.xyz;\n#ifdef GAMMA_INPUT\n    indirectDiffuse.xyz *= indirectDiffuse.xyz;\n#endif\n#endif\n    return indirectDiffuse;\n}\n"},53833:e=>{e.exports="#ifdef HATCH_PATTERN\ngl_FragColor = calculateHatchPattern(hatchParams, gl_FragCoord.xy, gl_FragColor, hatchTintColor, hatchTintIntensity);\n#endif\n#ifdef MRT_NORMALS\noutNormal = vec4(geomNormal.x, geomNormal.y, depth, gl_FragColor.a < 1.0 ? 0.0 : 1.0);\n#endif\n#include <id_frag>\n"},72448:e=>{e.exports="float averageOfFloat3(in vec3 value) { \n    const float oneThird = 1.0 / 3.0; \n    return dot(value, vec3(oneThird, oneThird, oneThird)); \n} \n"},52698:e=>{e.exports="#ifdef HATCH_PATTERN\nuniform vec2 hatchParams;\nuniform vec3 hatchTintColor;\nuniform float hatchTintIntensity;\nfloat curveGaussian(float r, float invWidth) {\n    float amt = clamp(r * invWidth, 0.0, 1.0);\n    float exponent = amt * 3.5;\n    return exp(-exponent*exponent);\n}\nvec4 calculateHatchPattern(vec2 hatchParams, vec2 coord, vec4 fragColor, vec3 hatchTintColor, float hatchTintIntensity ) {\n    float hatchSlope = hatchParams.x;\n    float hatchPeriod = hatchParams.y;\n    if (abs(hatchSlope) <= 1.0) {\n        float hatchPhase = coord.y - hatchSlope * coord.x;\n        float dist = abs(mod((hatchPhase), (hatchPeriod)));\n        if (dist < 1.0) {\n            fragColor = vec4(0.0,0.0,0.0,1.0);\n        } else {\n            fragColor.xyz = mix(fragColor.xyz, hatchTintColor, hatchTintIntensity);\n        }\n    } else {\n        float hatchPhase = - coord.y / hatchSlope + coord.x;\n        float dist = abs(mod((hatchPhase), (hatchPeriod)));\n        if (dist < 1.0) {\n            fragColor = vec4(0.0,0.0,0.0,1.0);\n        } else {\n            fragColor.xyz = mix(fragColor.xyz, hatchTintColor, hatchTintIntensity);\n        }\n    }\n    return fragColor;\n}\n#endif\n"},68643:e=>{e.exports="vec3 rgb2hsv(vec3 color)\n{\n    float delta;\n    float colorMax, colorMin;\n    float h,s,v;\n    vec3 hsv;\n    colorMax = max(color.r,color.g);\n    colorMax = max(colorMax,color.b);\n    colorMin = min(color.r,color.g);\n    colorMin = min(colorMin,color.b);\n    v = colorMax;\n    if(colorMax != 0.0)\n    {\n        s = (colorMax - colorMin)/colorMax;\n    }\n    else\n    {\n        s = 0.0;\n    }\n    if(s != 0.0)\n    {\n        delta = colorMax-colorMin;\n        if (color.r == colorMax)\n        {\n            h = (color.g-color.b)/delta;\n        }\n        else if (color.g == colorMax)\n        {\n            h = 2.0 + (color.b-color.r) / delta;\n        }\n        else\n        {\n            h = 4.0 + (color.r-color.g)/delta;\n        }\n        h /= 6.0;\n        if( h < 0.0)\n        {\n            h +=1.0;\n        }\n    }\n    else\n    {\n        h = 0.0;\n    }\n    hsv = vec3(h,s,v);\n    return hsv;\n}\nvec3 hsv2rgb(vec3 hsv)\n{\n    vec3 color;\n    float f,p,q,t;\n    float h,s,v;\n    float i,hi;\n    {\n        h = hsv.x*6.0;\n        s = hsv.y;\n        v = hsv.z;\n        i = floor(h);\n        f = h-i;\n        p = v * (1.0 - s);\n        q = v * (1.0 - (s * f));\n        t = v * (1.0 - (s * (1.0 - f)));\n        float r,g,b;\n        if (i == 0.0)\n        {\n            r = v;\n            g = t;\n            b = p;\n        }\n        else if (i == 1.0)\n        {\n            r = q;\n            g = v;\n            b = p;\n        }\n        else if (i == 2.0)\n        {\n            r = p;\n            g = v;\n            b = t;\n        }\n        else if (i == 3.0)\n        {\n            r = p;\n            g = q;\n            b = v;\n        }\n        else if (i == 4.0)\n        {\n            r = t;\n            g = p;\n            b = v;\n        }\n        else\n        {\n            r = v;\n            g = p;\n            b = q;\n        }\n        color = vec3(r,g,b);\n    }\n    return color;\n}"},74610:e=>{e.exports="#if defined(MRT_NORMALS) || defined(MRT_ID_BUFFER)\n    varying highp float depth;\n#endif\n#if defined(MRT_ID_BUFFER) || defined(ID_COLOR)\n    #ifdef USE_VERTEX_ID\n        varying vec3 vId;\n    #elif defined(LINE_2D_SHADER)\n        varying vec4 dbId;\n    #else\n        uniform vec3 dbId;\n    #endif\n#endif\n#if defined(MRT_ID_BUFFER) || defined(MODEL_COLOR)\n    uniform vec3 modelId;\n#endif\n#ifdef _LMVWEBGL2_\n    #if defined(MRT_NORMALS)\n        layout(location = 1) out vec4 outNormal;\n        #if defined(MRT_ID_BUFFER)\n            layout(location = 2) out vec4 outId;\n            #if defined(MODEL_COLOR)\n                layout(location = 3) out vec4 outModelId;\n            #endif\n        #endif\n    #elif defined(MRT_ID_BUFFER)\n        layout(location = 1) out vec4 outId;\n        #if defined(MODEL_COLOR)\n            layout(location = 2) out vec4 outModelId;\n        #endif\n    #endif\n#else\n    #define gl_FragColor gl_FragData[0]\n    #if defined(MRT_NORMALS)\n        #define outNormal gl_FragData[1]\n        #if defined(MRT_ID_BUFFER)\n            #define outId gl_FragData[2]\n            #if defined(MODEL_COLOR)\n                #define outModelId gl_FragData[3]\n            #endif\n        #endif\n    #elif defined(MRT_ID_BUFFER)\n        #define outId gl_FragData[1]\n        #if defined(MODEL_COLOR)\n            #define outModelId gl_FragData[2]\n        #endif\n    #endif\n#endif"},7959:e=>{e.exports="#ifdef USE_VERTEX_ID\nattribute vec3 id;\nvarying   vec3 vId;\n#endif\n"},46223:e=>{e.exports="\n#if defined(USE_VERTEX_ID) && (defined(MRT_ID_BUFFER) || defined(ID_COLOR))\n    vec3 dbId = vId;\n#endif\n#ifdef MRT_ID_BUFFER\n    #ifndef ENABLE_ID_DISCARD\n        const float writeId = 1.0;\n    #endif\n    outId = vec4(dbId.rgb, writeId);\n    #ifdef MODEL_COLOR\n        outModelId = vec4(modelId.rgb, writeId);\n    #endif\n#elif defined(ID_COLOR)\n    #ifdef ENABLE_ID_DISCARD\n        if (writeId==0.0) {\n            discard;\n        }\n    #endif\n    gl_FragColor = vec4(dbId.rgb, 1.0);\n#elif defined(MODEL_COLOR)\n    #ifdef ENABLE_ID_DISCARD\n        if (writeId==0.0) {\n            discard;\n        }\n    #endif\n    gl_FragColor = vec4(modelId.rgb, 1.0);\n#endif\n"},61539:e=>{e.exports="\n#ifdef USE_VERTEX_ID\nvId = id;\n#endif\n"},21600:e=>{e.exports="#if defined( IMPORTANTSAMPLING )\n#define SAMPLECOUNT 32\nvec2 Hammersley(int index)\n{\n    float u = (float(index) + 0.5) / 32.0;\n    float v = 0.5;\n    float noise = texture2D(importantSamplingRandomMap, vec2(u, v), 0.0).r;\n   return vec2(2.0 * PI * float(index/SAMPLECOUNT), noise);\n}\nvec3 ImportanceSampleAnisotropicGGX(int index, vec2 alpha, vec3 N, vec3 Tu, vec3 Tv)\n{\n    vec2 uniformSample2D = Hammersley(index);\n    float coef = sqrt(uniformSample2D.y / (1.0 - uniformSample2D.y));\n    float sinSigma, cosSigma;\n    sinSigma = sin(uniformSample2D.x);\n    cosSigma = cos(uniformSample2D.x);\n    vec3 H = coef * ((alpha.x * cosSigma) * Tu + (alpha.y * sinSigma) * Tv) + N;\n    H = normalize(H);\n    return H;\n}\nfloat ComputePDF(vec2 alpha, float NdotH, float HdotTu, float HdotTv, float VdotH)\n{\n    float factor1 = HdotTu / alpha.x;\n    float factor2 = HdotTv / alpha.y;\n    float factor3 = factor1 * factor1 + factor2 * factor2 + NdotH * NdotH;\n    float factor = factor3 * factor3 * alpha.x * alpha.y * VdotH * 4.0 * PI;\n    if (factor > 0.0)\n    {\n        return (NdotH / factor);\n    }\n    else\n    {\n        return 0.0;\n    }\n}\n#define INVFACESIZE 0.0078125\nfloat DirectionToSolidAngle(vec3 dir)\n{\n    dir = abs(dir);\n    float first = min(dir.x, dir.y);\n    float temp = max(dir.x, dir.y);\n    float second = min(temp, dir.z);\n    float third = max(temp, dir.z);\n    first /= third;\n    second /= third;\n    float u = (first+1.0)/2.0;\n    float v = (second + 1.0) / 2.0;\n    float solidAngle = texture2D(importantSamplingSolidAngleMap, vec2(u, v), 0.0).r * 0.000255;\n    return solidAngle;\n}\nfloat Smith_GGX(float value)\n{\n    return 2.0 / (1.0 + sqrt(1.0 + value));\n}\nvec2 RoughnessAnisotropyToAlpha(float roughness, float anisotropy)\n{\n    float aspect = sqrt(1.0 - 0.9 * anisotropy);\n    vec2 alpha = vec2(roughness * roughness / aspect, roughness * roughness * aspect);\n    return alpha;\n}\nvec3 ImportanceSamplingSpecular(float angle, vec3 reflectance, float roughness, float anisotropy, vec3 V, vec3 N, vec3 Tu, vec3 Tv)\n{\n    vec3 specular = vec3(0.0);\n    float radAngle;\n    if (anisotropy < 1e-10)\n    {\n        radAngle = 0.0;\n    }\n    else\n    {\n        radAngle = -PI * angle;\n    }\n    vec2 alpha = RoughnessAnisotropyToAlpha(roughness, anisotropy);\n    float alpha2 = max(alpha.x * alpha.x, alpha.y * alpha.y);\n    float NdotV = dot(N, V);\n    float alpha2NV = aSqrd(alpha2, NdotV);\n    vec2 sincosTheta;\n    sincosTheta.x = sin(radAngle);\n    sincosTheta.y = cos(radAngle);\n    vec3 Tu1, Tv1;\n    Tu1 = sincosTheta.y * Tu - sincosTheta.x * Tv;\n    Tv1 = sincosTheta.x * Tu + sincosTheta.y * Tv;\n    vec3 H;\n    vec3 sampleLightIntensity;\n    vec3 L;\n    float effectiveSample = 0.0;\n    for (int i = 0; i < SAMPLECOUNT; i++)\n    {\n        H = ImportanceSampleAnisotropicGGX(i, alpha, N, Tu1, Tv1);\n        float VdotH = dot(V, H);\n        L = 2.0 * VdotH * H - V;\n        float NdotH = dot(N, H);\n        float NdotL = dot(N, L);\n        if (NdotL >= 0.0 && NdotV > 0.0 && NdotH > 0.0)\n        {\n            float alpha2NL = aSqrd(alpha2, NdotL);\n            float HdotTu = dot(H, Tu1);\n            float HdotTv = dot(H, Tv1);\n            float pdf = ComputePDF(alpha, NdotH, HdotTu, HdotTv, VdotH);\n            float mipmapLevel = 0.0;\n            if (pdf > 0.0)\n            {\n                mipmapLevel = 0.3 * log2(1.0 / (float(SAMPLECOUNT) * pdf * DirectionToSolidAngle(L)));\n            }\n            mipmapLevel = clamp(mipmapLevel, 0.0, 4.0);\n            L = normalize(L);\n            sampleLightIntensity = sampleReflection(L, L, mipmapLevel).rgb;\n            float G = Smith_GGX(alpha2NL) * Smith_GGX(alpha2NV);\n            vec3 F = Fresnel_Schlick(reflectance, VdotH);\n            float factor = G * VdotH / (NdotH * NdotV);\n            if (factor >= 0.0)\n            {\n                specular += abs(sampleLightIntensity * F * factor);\n                effectiveSample += 1.0;\n            }\n        }\n    }\n    if (effectiveSample > 0.0)\n    {\n        specular /= effectiveSample;\n    }\n    return specular;\n}\n#endif"},58121:e=>{e.exports="\n#ifdef USE_INSTANCING\nattribute vec3 instOffset;\nattribute vec4 instRotation;\nattribute vec3 instScaling;\nvec3 applyQuaternion(vec3 p, vec4 q) {\n    return p + 2.0 * cross(q.xyz, cross(q.xyz, p) + q.w * p);\n}\nvec3 getInstancePos(vec3 pos) {\n    return instOffset + applyQuaternion(instScaling * pos, instRotation);\n}\nvec3 getInstanceNormal(vec3 normal) {\n    return applyQuaternion(normal/instScaling, instRotation);\n}\n#else\nvec3 getInstancePos(vec3 pos)       { return pos;    }\nvec3 getInstanceNormal(vec3 normal) { return normal; }\n#endif\n"},81456:e=>{e.exports="\n#define LINE_2D_SHADER 1\n#define TAU     6.28318530718\n#define PI      3.14159265358979\n#define HALF_PI 1.57079632679\n#define PI_0_5  HALF_PI\n#define PI_1_5  4.71238898038\n#define ENABLE_ID_DISCARD\n#define VBB_GT_TRIANGLE_INDEXED  0.0\n#define VBB_GT_LINE_SEGMENT      1.0\n#define VBB_GT_ARC_CIRCULAR      2.0\n#define VBB_GT_ARC_ELLIPTICAL    3.0\n#define VBB_GT_TEX_QUAD          4.0\n#define VBB_GT_ONE_TRIANGLE      5.0\n#define VBB_GT_MSDF_TRIANGLE_INDEXED 6.0\n#define VBB_GT_LINE_SEGMENT_CAPPED 8.0\n#define VBB_GT_LINE_SEGMENT_CAPPED_START 9.0\n#define VBB_GT_LINE_SEGMENT_CAPPED_END 10.0\n#define VBB_INSTANCED_FLAG   0.0\n#define VBB_SEG_START_RIGHT  0.0\n#define VBB_SEG_START_LEFT   1.0\n#define VBB_SEG_END_RIGHT    2.0\n#define VBB_SEG_END_LEFT     3.0\n#define LTSCALE 0.25\nvarying vec4 fsColor;\nvarying vec2 fsOffsetDirection;\nvarying vec4 fsMultipurpose;\nvarying float fsHalfWidth;\nvarying vec2 fsVpTC;\nvarying float fsGhosting;\n#ifdef LOADING_ANIMATION\nvarying float loadingProgress;\n#endif\n"},14227:e=>{e.exports="#if defined(USE_SURFACE_NORMAL_MAP) || defined( USE_LAYERED_NORMAL_MAP ) || defined( USE_TILING_NORMAL )\nvoid heightMapTransform(\n    sampler2D bumpTexture,\n    vec2 uv,\n    mat3 transform,\n    vec2 bumpScale,\n    inout vec3 T,\n    inout vec3 B,\n    inout vec3 N\n) {\n    vec2 st = (transform * vec3(uv, 1.0)).xy;\n    mat3 mtxTangent = mat3(T, B, N);\n    T = normalize(mtxTangent * (transform * vec3(1.0, 0.0, 0.0)));\n    B = normalize(mtxTangent * (transform * vec3(0.0, 1.0, 0.0)));\n    const float oneThird = 1.0 / 3.0;\n    vec3 avg = vec3(oneThird, oneThird, oneThird);\n    vec2 offset = fwidth(st);\n    float h0 = dot(texture2D(bumpTexture, st).xyz, avg);\n    float hx = dot(texture2D(bumpTexture, st + vec2(offset.x, 0.0)).xyz, avg);\n    float hy = dot(texture2D(bumpTexture, st + vec2(0.0, offset.y)).xyz, avg);\n    vec2 diff = vec2(h0 - hx, h0 - hy) / offset;\n    N = normalize(\n        N + (\n            diff.x * T * bumpScale.x +\n            diff.y * B * bumpScale.y\n        )\n    );\n}\nvoid normalMapTransform(\n    sampler2D bumpTexture,\n    vec2 uv,\n    mat3 transform,\n    vec2 bumpScale,\n    inout vec3 T,\n    inout vec3 B,\n    inout vec3 N\n) {\n    vec2 st = (transform * vec3(uv, 1.0)).xy;\n    vec3 mapN =  2.0 * texture2D(bumpTexture, st).xyz - 1.0;\n    mapN.xy *= bumpScale.x;\n    mapN.z *= bumpScale.y;\n    vec3 v = vec3(mapN.y, -mapN.x, 0.0);\n    float c = -mapN.z;\n    mat3 skewV = mat3(\n        0.0, v.z, -v.y,\n        -v.z, 0.0, v.x,\n        v.y, -v.x, 0.0\n    );\n    mat3 rot = mat3(1.0) + skewV + skewV*skewV * 1.0/(1.0-c);\n    N *= rot;\n    T *= rot;\n    B *= rot;\n}\n#endif\n"},52035:e=>{e.exports="vec3 orderedDithering(vec3 col) {\n    const vec4 m0 = vec4( 1.0, 13.0,  4.0, 16.0);\n    const vec4 m1 = vec4( 9.0,  5.0, 12.0,  8.0);\n    const vec4 m2 = vec4( 3.0, 15.0,  2.0, 14.0);\n    const vec4 m3 = vec4(11.0,  7.0, 10.0,  6.0);\n#ifdef _LMVWEBGL2_\n    int i = int(gl_FragCoord.x) & 3;\n    int j = int(gl_FragCoord.y) & 3;\n#else\n    int i = int(mod(float(gl_FragCoord.x), 4.0));\n    int j = int(mod(float(gl_FragCoord.y), 4.0));\n#endif\n    vec4 biasRow;\n    if      (i==0) biasRow = m0;\n    else if (i==1) biasRow = m1;\n    else if (i==2) biasRow = m2;\n    else           biasRow = m3;\n    float bias;\n    if      (j==0) bias = biasRow.x;\n    else if (j==1) bias = biasRow.y;\n    else if (j==2) bias = biasRow.z;\n    else           bias = biasRow.w;\n    return col + bias * (1.0 / (17.0 * 256.0));\n}\n"},23300:e=>{e.exports="\nvec4 packDepth( const in float depth ) {\n    vec4 enc = vec4(1.0, 255.0, 65025.0, 160581375.0) * depth;\n    enc = fract(enc);\n    enc -= enc.yzww * vec4(1.0/255.0,1.0/255.0,1.0/255.0,0.0);\n    return enc;\n}\nfloat unpackDepth( const in vec4 rgba_depth ) {\n    return dot( rgba_depth, vec4(1.0, 1.0/255.0, 1.0/65025.0, 1.0/160581375.0) );\n}\n"},15931:e=>{e.exports="\n#define kPI 3.14159265358979\nvec2 encodeNormal (vec3 n) {\n    return (vec2(atan(n.y,n.x)/kPI, n.z)+1.0)*0.5;\n}\nvec3 decodeNormal (vec2 enc) {\n    vec2 ang = enc * 2.0 - 1.0;\n    vec2 scth = vec2(sin(ang.x * kPI), cos(ang.x * kPI));\n    vec2 scphi = vec2(sqrt(1.0 - ang.y * ang.y), ang.y);\n    return vec3(scth.y * scphi.x, scth.x * scphi.x, scphi.y);\n}\n"},26649:e=>{e.exports="gl_PointSize = point_size;"},58998:e=>{e.exports="\nvec3 TransmitAdjust(vec3 transmission, vec3 f0) \n{ \n   vec3 limit = max(1.0 - f0, 0.00001); \n   return clamp(transmission, vec3(0.0, 0.0, 0.0), limit) / limit; \n} \nfloat ColorToIlluminance(in vec3 color) \n{ \n   const vec3 rgb2grey = vec3(0.299, 0.587, 0.114); \n   float illuminance = dot(rgb2grey, color); \n   return illuminance; \n} \nvoid applyPrismGlazingOpacity(\n    inout vec4 color,\n    vec3 transmissionF,\n    float transmissionAlpha,\n    float NdotV,\n    float glazingIlluminace) \n{\n    const float third = 1.0/3.0; \n    float transSurface = exp(-(transmissionAlpha + (transmissionAlpha < 0.0025 ? 0.0 : 0.25)) * NdotV * PI); \n    float opacity = 1.0- dot((1.0 - transmissionF), vec3(third,third,third)) * transSurface * glazingIlluminace; \n    opacity = clamp(opacity, 0.01, 0.99);\n    color.a *= opacity;\n} \n"},72438:e=>{e.exports="void applyPrismTransparency(\n    inout vec4 color,\n    vec3 transparentColor,\n    float transparentIor\n) {\n    float fsLevel = max(max(color.r, color.g), color.b);\n    color = vec4(color.rgb/fsLevel, fsLevel);\n    float transLevel = min(min(transparentColor.r, transparentColor.g), transparentColor.b);\n    transLevel = min( (1.0 - surface_roughness), transLevel );\n    float transAlpha = (1.0 - transLevel) * 0.4 + surface_roughness * 0.55;\n    vec3 tr_g_color = sqrt(transparentColor);\n    vec4 transColor = vec4(0.5 * vec3(tr_g_color), transAlpha);\n    float strength = 1.0 - (1.0 - fsLevel) * (1.0 - fsLevel);\n    color = mix(transColor, color, strength);\n    color.a = max(color.a, 0.05);\n    if (transparentIor == 1.0 && tr_g_color == vec3(1.0)) {\n        color.a = 0.0;\n    }\n}"},65355:e=>{e.exports="#if defined( PRISMWOOD )\n#define ONE 0.00390625\nfloat GetIndexedValue(vec4 array, int index)\n{\n    if (index == 0)\n        return array[0];\n    else if (index == 1)\n        return array[1];\n    else if (index == 2)\n        return array[2];\n    else if (index == 3)\n        return array[3];\n    else\n        return 0.0;\n}\nint GetIndexedValue(ivec2 array, int index)\n{\n    if (index == 0)\n        return array[0];\n    else if (index == 1)\n        return array[1];\n    else\n        return 0;\n}\n#if defined( USE_WOOD_CURLY_DISTORTION_MAP )\nfloat SampleCurlyPattern(vec2 uv)\n{\n    vec2 uv_wood_curly_distortion_map = (wood_curly_distortion_map_texMatrix * vec3(uv, 1.0)).xy;\n    WOOD_CURLY_DISTORTION_CLAMP_TEST;\n    vec3 curlyDistortion = texture2D(wood_curly_distortion_map, uv_wood_curly_distortion_map).xyz;\n    if(wood_curly_distortion_map_invert) curlyDistortion = vec3(1.0) - curlyDistortion;\n    return curlyDistortion.r;\n}\nvec3 DistortCurly(vec3 p)\n{\n    if (!wood_curly_distortion_enable) return p;\n    float r = length(p.xy);\n    if (r < 0.00001) return p;\n    const float INV_ANGLE_INTERVAL = 1.27323954;\n    const float NUM_INTERVAL = 8.0;\n    float theta = atan(p.y, p.x);\n    if (theta < 0.0)\n        theta += PI2;\n    float intIdx = theta * INV_ANGLE_INTERVAL;\n    int idx0 = int(mod(floor(intIdx), NUM_INTERVAL));\n    int idx1 = int(mod(ceil(intIdx), NUM_INTERVAL));\n    const vec4 HASH_TABLE1 = vec4(0.450572,0.114598, 0.886043, 0.315119);\n    const vec4 HASH_TABLE2 = vec4(0.216133,0.306264, 0.685616, 0.317907);\n    float offset0 = idx0 < 4 ? GetIndexedValue(HASH_TABLE1, idx0) : GetIndexedValue(HASH_TABLE2, idx0-4);\n    float offset1 = idx1 < 4 ? GetIndexedValue(HASH_TABLE1, idx1) : GetIndexedValue(HASH_TABLE2, idx1-4);\n    const float maxOffset = 100.0;\n    offset0 = (offset0 - 0.5) * maxOffset;\n    offset1 = (offset1 - 0.5) * maxOffset;\n    vec2 uv0 = vec2(p.z + offset0, r);\n    float shiftWeight0 =  SampleCurlyPattern(uv0);\n    vec2 uv1 = vec2(p.z + offset1, r);\n    float shiftWeight1 =  SampleCurlyPattern(uv1);\n    float interpWeight = fract(intIdx);\n    float shiftWeight = mix(shiftWeight0, shiftWeight1, interpWeight);\n    const float INV_MIN_RADIUS = 2.0;\n    float shiftWeightAdjust = smoothstep(0.0, 1.0, r * INV_MIN_RADIUS);\n    r -= wood_curly_distortion_scale * (shiftWeight * shiftWeightAdjust);\n    float thetaNew = atan(p.y, p.x);\n    vec3 pNew = p;\n    pNew.x = r * cos(thetaNew);\n    pNew.y = r * sin(thetaNew);\n    return pNew;\n}\n#endif\nvec3 un2sn(vec3 range)\n{\n    return range * 2.0 - 1.0;\n}\nfloat inoise(vec3 p)\n{\n    vec3 modp = mod(floor(p), 256.0);\n    modp.xy = modp.xy * ONE;\n    vec4 AA = texture2D(perm2DMap, vec2(modp.x, modp.y), 0.0) * 255.0;\n    AA = AA + modp.z;\n    AA = mod(floor(AA), 256.0);\n    AA *= ONE;\n    vec3 gradx1 = un2sn(texture2D(permGradMap,vec2(AA.x,0.0),0.0).xyz);\n    vec3 grady1 = un2sn(texture2D(permGradMap,vec2(AA.y,0.0),0.0).xyz);\n    vec3 gradz1 = un2sn(texture2D(permGradMap,vec2(AA.z,0.0),0.0).xyz);\n    vec3 gradw1 = un2sn(texture2D(permGradMap,vec2(AA.w,0.0),0.0).xyz);\n    vec3 gradx2 = un2sn(texture2D(permGradMap,vec2(AA.x + ONE,0.0),0.0).xyz);\n    vec3 grady2 = un2sn(texture2D(permGradMap,vec2(AA.y + ONE,0.0),0.0).xyz);\n    vec3 gradz2 = un2sn(texture2D(permGradMap,vec2(AA.z + ONE,0.0),0.0).xyz);\n    vec3 gradw2 = un2sn(texture2D(permGradMap,vec2(AA.w + ONE,0.0),0.0).xyz);\n    p -= floor(p);\n    vec3 fadep = p * p * p * (p * (p * 6.0 - 15.0) + 10.0);\n    return mix( mix( mix( dot(gradx1, p ),\n                          dot(gradz1, p + vec3(-1.0, 0.0, 0.0)), fadep.x),\n                     mix( dot(grady1, p + vec3(0.0, -1.0, 0.0)),\n                          dot(gradw1, p + vec3(-1.0, -1.0, 0.0)), fadep.x), fadep.y),\n                mix( mix( dot(gradx2, p + vec3(0.0, 0.0, -1.0)),\n                          dot(gradz2, p + vec3(-1.0, 0.0, -1.0)), fadep.x),\n                     mix( dot(grady2, p + vec3(0.0, -1.0, -1.0)),\n                          dot(gradw2, p + vec3(-1.0, -1.0, -1.0)), fadep.x), fadep.y), fadep.z);\n}\nfloat inoise(float p)\n{\n    float modp = mod(floor(p), 256.0);\n    modp = (modp + 256.0) * ONE;\n    float permx = texture2D(permutationMap, vec2(modp, 0.0), 0.0).r;\n    float gradx = texture2D(gradientMap, vec2(permx, 0.0), 0.0).r*2.0-1.0;\n    float permy = texture2D(permutationMap, vec2(modp + ONE, 0.0), 0.0).r;\n    float grady = texture2D(gradientMap, vec2(permy, 0.0), 0.0).r*2.0-1.0;\n    p -= floor(p);\n    float fadep = p * p * p * (p * (p * 6.0 - 15.0) + 10.0);\n    return mix(gradx * p, grady * (p - 1.0), fadep);\n}\nfloat multiband_inoise(vec3 p, int bands, vec4 w, vec4 f)\n{\n    float noise = 0.0;\n    for(int i = 0; i < 4; ++i)\n    {\n        if (i >= bands) break;\n        noise += GetIndexedValue(w, i) * inoise(p * GetIndexedValue(f, i));\n    }\n    return noise;\n}\nfloat multiband_inoise(float p, int bands, vec4 w, vec4 f)\n{\n    float noise = 0.0;\n    for(int i = 0; i < 4; ++i)\n    {\n        if (i >= bands) break;\n        noise += GetIndexedValue(w, i) * inoise(p * GetIndexedValue(f, i));\n    }\n    return noise;\n}\nvec3 Distort3DCosineRadialDir(vec3 p)\n{\n    float radius = length(p.xy);\n    if (radius < 0.00001) return p;\n    vec2 theta = p.xy / radius;\n    float radiusShift = 0.0;\n    for (int i = 0; i < 4; ++i)\n    {\n        if (i >= wood_fiber_cosine_bands) break;\n        radiusShift += GetIndexedValue(wood_fiber_cosine_weights, i) * cos(p.z * RECIPROCAL_PI2 * GetIndexedValue(wood_fiber_cosine_frequencies, i));\n    }\n    const float MIN_RADIUS = 1.5;\n    float weight = clamp(radius / MIN_RADIUS, 0.0, 1.0);\n    if(weight >= 0.5)\n        weight = weight * weight * (3.0 - (weight + weight));\n    p.xy += theta * radiusShift * weight;\n    return p;\n}\nvec3 Distort3DPerlin(vec3 p)\n{\n    vec3 pAniso = vec3(p.xy, p.z * wood_fiber_perlin_scale_z);\n    p.xy += multiband_inoise(pAniso, wood_fiber_perlin_bands, wood_fiber_perlin_weights, wood_fiber_perlin_frequencies);\n    return p;\n}\nvec3 Distort(vec3 p)\n{\n    if(wood_fiber_cosine_enable)\n        p = Distort3DCosineRadialDir(p);\n    if(wood_fiber_perlin_enable)\n        p = Distort3DPerlin(p);\n    return p;\n}\nfloat DistortRadiusLength(float radiusLength)\n{\n    radiusLength += multiband_inoise(radiusLength, wood_growth_perlin_bands, wood_growth_perlin_weights, wood_growth_perlin_frequencies);\n    if (radiusLength < 0.0) radiusLength = 0.0;\n    return radiusLength;\n}\nfloat ComputeEarlyWoodRatio(float radiusLength)\n{\n    float fraction = mod(radiusLength, wood_ring_thickness) / wood_ring_thickness;\n    if (fraction <= wood_ring_fraction.y)\n       return 1.0;\n    else if(fraction <= wood_ring_fraction.x)\n       return (1.0 - (fraction - wood_ring_fraction.y) / wood_fall_rise.x);\n    else if(fraction <= wood_ring_fraction.w)\n       return 0.0;\n    else\n       return ((fraction - wood_ring_fraction.w) / wood_fall_rise.y);\n}\nvec3 DistortEarlyColor(vec3 earlyColor, float radiusLength)\n{\n    float expValue = 1.0 + multiband_inoise(radiusLength,wood_earlycolor_perlin_bands,wood_earlycolor_perlin_weights,wood_earlycolor_perlin_frequencies);\n    earlyColor = pow(abs(earlyColor), vec3(expValue));\n    return earlyColor;\n}\nvec3 DistortLateColor(vec3 lateColor, float radiusLength)\n{\n    float expValue = 1.0 + multiband_inoise(radiusLength,wood_latecolor_perlin_bands,wood_latecolor_perlin_weights,wood_latecolor_perlin_frequencies);\n    lateColor = pow(abs(lateColor), vec3(expValue));\n    return lateColor;\n}\nvec3 DistortDiffuseColor(vec3 diffAlbedo, vec3 p)\n{\n    p.z *= wood_diffuse_perlin_scale_z;\n    float expValue = 1.0 + multiband_inoise(p, wood_diffuse_perlin_bands, wood_diffuse_perlin_weights, wood_diffuse_perlin_frequencies);\n    diffAlbedo = pow(abs(diffAlbedo), vec3(expValue));\n    return diffAlbedo;\n}\nfloat LayerRoughnessVar(float roughness, float earlyWoodRatio)\n{\n    return earlyWoodRatio * wood_groove_roughness + (1.0 - earlyWoodRatio) * roughness;\n}\nfloat hashword(vec2 k)\n{\n    k = mod(k, vec2(256.0)) * ONE;\n    float a = texture2D(permutationMap, vec2(k.x, 0.0)).x + k.y ;\n    a = texture2D(permutationMap, vec2(a, 0.0)).x ;\n    return a*255.0;\n}\nfloat wyvillsq(float rsq)\n{\n    if (rsq >= 1.0) return 0.0;\n    float tmp = 1.0 - rsq;\n    return tmp*tmp*tmp;\n}\nfloat Weight2DNeighborImpulses(vec3 p, float woodWeight)\n{\n    if(woodWeight <= 0.0) return 0.0;\n    float poreRadius = wood_pore_radius * woodWeight;\n    vec2 left = floor((p.xy - poreRadius) / wood_pore_cell_dim);\n    vec2 right = floor((p.xy + poreRadius) / wood_pore_cell_dim);\n    float weight = 0.0;\n    float invRsq = 1.0 / (poreRadius * poreRadius);\n    const float norm =  1.0 / 15.0;\n    for (int j = 0; j <= 4; j++)\n    {\n        if (j > int(right.y - left.y)) continue;\n        for (int i = 0; i <= 4; i++)\n        {\n            if (i > int(right.x - left.x)) continue;\n            vec2 pij = vec2(float(i) + left.x,float(j) + left.y);\n            float hRNum = hashword(pij);\n            float impPosX = mod(hRNum, 16.0) * norm;\n            float impPosY = floor(hRNum / 16.0) * norm;\n            impPosX = (pij.x + impPosX)* wood_pore_cell_dim;\n            impPosY = (pij.y + impPosY)* wood_pore_cell_dim;\n            float dsq = (p.x - impPosX) * (p.x - impPosX) + (p.y - impPosY) * (p.y - impPosY);\n            weight += wyvillsq(dsq * invRsq);\n        }\n    }\n    return weight;\n}\nfloat Weight3DRayImpulses(vec3 p)\n{\n    int segIdx = int(floor(p.z / wood_ray_seg_length_z));\n    float factor = p.z / wood_ray_seg_length_z - float(segIdx);\n    int segIdx1 = segIdx - 1;\n    if ( factor > 0.5 )\n        segIdx1 = segIdx + 1;\n    float theta = atan(p.y, p.x);\n    float sliceIdx = floor(((theta + PI) * RECIPROCAL_PI2) * wood_ray_num_slices);\n    if ( sliceIdx == wood_ray_num_slices)\n        sliceIdx-=1.0;\n    ivec2 arrSegs = ivec2(segIdx, segIdx1);\n    float weight = 0.0;\n    const float norm =  1.0 / 15.0;\n    float radialOffset = 5.0;\n    float radialLength = length(p.xy);\n    for (int seg = 0; seg < 2; seg++)\n    {\n        float hRNum = hashword(vec2(sliceIdx, GetIndexedValue(arrSegs, seg)));\n        float rn1 = mod(hRNum,16.0) * norm;\n        if (radialLength < radialOffset * rn1)\n            continue;\n        float rayTheta = rn1;\n        rayTheta = ( ( sliceIdx + rayTheta ) / wood_ray_num_slices ) * ( 2.0 * PI ) - PI;\n        float rayPosZ = (hRNum/16.0)* norm;\n        rayPosZ = ( float(GetIndexedValue(arrSegs, seg)) + rayPosZ ) * wood_ray_seg_length_z;\n        vec3 pt1 = vec3(0.0);\n        vec3 pt2 = vec3(cos(rayTheta), sin(rayTheta), 0.0);\n        vec3 p1 = p;\n        p1.z -= rayPosZ;\n        p1.z /=  wood_ray_ellipse_z2x;\n        vec3 v1 = pt2 - pt1;\n        vec3 v2 = pt1 - p1;\n        v2 = cross(v1, v2);\n        float dist = length(v2) / length(v1);\n        float invRsq = 1.0 / ( wood_ray_ellipse_radius_x * wood_ray_ellipse_radius_x);\n        weight += wyvillsq( (dist * dist) * invRsq );\n    }\n    return weight;\n}\nvec3 DarkenColorWithPores(vec3 p, vec3 diffColor, float woodWeight)\n{\n    float poresWeight = Weight2DNeighborImpulses(p, woodWeight);\n    float a = wood_pore_color_power - 1.0;\n    float b = 1.0;\n    float y = a * poresWeight + b;\n    return pow(abs(diffColor), vec3(y));\n}\nvec3 DarkenColorWithRays(vec3 p, vec3 diffColor)\n{\n    float raysWeight = Weight3DRayImpulses(p);\n    float a = wood_ray_color_power - 1.0;\n    float b = 1.0;\n    float y = a * raysWeight + b;\n    return pow(abs(diffColor), vec3(y));\n}\nfloat ComputeWoodWeight(float earlyWoodRatio)\n{\n    float woodWeight = 0.0;\n    if (wood_pore_type == 0)\n        woodWeight = 1.0;\n    else if (wood_pore_type == 1)\n        woodWeight = earlyWoodRatio;\n    else if (wood_pore_type == 2)\n        woodWeight = 1.0 - earlyWoodRatio;\n    else\n        woodWeight = -1.0;\n    return woodWeight;\n}\n#if defined( PRISMWOODBUMP )\nfloat ComputeEarlyWoodRatioAA(float radiusLength, float invUnitExt)\n{\n    float transPixels = min(wood_fall_rise.x, wood_fall_rise.y) * wood_ring_thickness * invUnitExt;\n    float samplesf = clamp(4.0 / transPixels, 1.0, 4.0);\n    int samples = int(samplesf);\n    float inverseSamples = 1.0 / float(samples);\n    vec2 rdelta = vec2(dFdx(radiusLength), dFdy(radiusLength)) * inverseSamples;\n    float earlywoodRatio = 0.0;\n    for (int i = 0; i < 4; ++i)\n    {\n        if (i >= samples) break;\n        for (int j = 0; j < 4; ++j)\n        {\n            if (j >= samples) break;\n            float r = radiusLength + dot(vec2(i, j), rdelta);\n            earlywoodRatio += ComputeEarlyWoodRatio(r);\n        }\n    }\n    return earlywoodRatio * (inverseSamples * inverseSamples);\n}\nfloat LatewoodDepthVariation(float invUnitExt)\n{\n    float transPixels = min(wood_fall_rise.x, wood_fall_rise.y) * wood_ring_thickness * invUnitExt;\n    return clamp(transPixels * 0.5, 0.0, 1.0);\n}\nfloat LatewoodHeightVariation(float earlyWoodRatio, float latewoodBumpDepth,\n                              float depthVar)\n{\n    return ( 1.0 - earlyWoodRatio ) * latewoodBumpDepth * depthVar;\n}\nfloat PoreDepthVariation(float woodWeight, float invUnitExt)\n{\n    float porePixels = woodWeight * wood_pore_radius * invUnitExt;\n    return clamp(porePixels, 0.0, 1.0);\n}\nfloat PoreHeightVariation(float earlyWoodRatio, float poresWeight, float poreDepth,\n                          float depthVar)\n{\n    return poresWeight * (-1.0 * poreDepth) * depthVar;\n}\nvoid ComputeTangents(vec3 normal, out vec3 u, out vec3 v)\n{\n    float scale = normal.z < 0.0 ? -1.0 : 1.0;\n    vec3 temp = scale * normal;\n    float e    = temp.z;\n    float h    = 1.0/(1.0 + e);\n    float hvx  = h   *  temp.y;\n    float hvxy = hvx * -temp.x;\n    u = vec3(e + hvx * temp.y, hvxy,                -temp.x);\n    v = vec3(hvxy,             e + h * temp.x * temp.x, -temp.y);\n    u *= scale;\n    v *= scale;\n}\nvec3 WoodBumpHeight(float heightLeft, float heightRight, float heightBack, float heightFront)\n{\n    const float epsilon = 0.001;\n    float heightDeltaX = heightRight - heightLeft;\n    vec3 Tu = vec3(2.0 * epsilon, 0.0, heightDeltaX);\n    float heightDeltaY = heightFront - heightBack;\n    vec3 Tv = vec3(0.0, 2.0 * epsilon, heightDeltaY);\n    return cross(Tu, Tv);\n}\nvec3 SelectNormal(vec3 N, vec3 bumpN, vec3 V)\n{\n    float bumpNdotV = dot(bumpN, V);\n    if(bumpNdotV > 0.0)\n        return bumpN;\n    else return N;\n}\nfloat MinInverseUnitExtent(vec3 p)\n{\n    return 1.0 / max(max(length(dFdx(p.xy)), length(dFdy(p.xy))), 0.000001);\n}\nfloat HeightVariation(vec3 pos)\n{\n    vec3 p = Distort(pos);\n    float radiusLength = length(p.xy);\n    if (wood_growth_perlin_enable)\n        radiusLength = DistortRadiusLength(radiusLength);\n    float invUnitExt = MinInverseUnitExtent(p);\n    float earlyWoodRatio = ComputeEarlyWoodRatioAA(radiusLength, invUnitExt);\n    float woodWeight = ComputeWoodWeight(earlyWoodRatio);\n    float poresWeight = Weight2DNeighborImpulses(p, woodWeight);\n    float depthVar = PoreDepthVariation(woodWeight, invUnitExt);\n    float poreHeightVariation = -1.0 * poresWeight * wood_pore_depth * depthVar;\n    float latewoodHeightVariation = 0.0;\n    if (wood_use_latewood_bump)\n    {\n        float latewoodDepthVar = LatewoodDepthVariation(invUnitExt);\n        latewoodHeightVariation = (1.0 - earlyWoodRatio) * wood_latewood_bump_depth * latewoodDepthVar;\n    }\n    float sumHeightVariation = poreHeightVariation + latewoodHeightVariation;\n    return sumHeightVariation;\n}\n#endif\nvec3 NoiseWood(vec3 p, inout float roughness)\n{\n    p = Distort(p);\n    float radiusLength = length(p.xy);\n    if(wood_growth_perlin_enable)\n        radiusLength = DistortRadiusLength(radiusLength);\n#if defined( PRISMWOODBUMP )\n    float invUnitExt = MinInverseUnitExtent( p );\n    float earlyWoodRatio = ComputeEarlyWoodRatioAA(radiusLength, invUnitExt);\n#else\n    float earlyWoodRatio = ComputeEarlyWoodRatio(radiusLength);\n#endif\n    vec3 earlyColor = wood_early_color;\n    if (wood_earlycolor_perlin_enable)\n        earlyColor = DistortEarlyColor(earlyColor, radiusLength);\n    vec3 lateColor;\n    if (wood_use_manual_late_color)\n        lateColor = wood_manual_late_color;\n    else\n        lateColor = pow(abs(earlyColor), vec3(wood_late_color_power));\n    if(wood_latecolor_perlin_enable)\n        lateColor = DistortLateColor(lateColor, radiusLength);\n    vec3 diffAlbedo = earlyWoodRatio * earlyColor + (1.0 - earlyWoodRatio) * lateColor;\n    if(wood_diffuse_perlin_enable)\n        diffAlbedo = DistortDiffuseColor(diffAlbedo, p);\n    if (wood_use_pores)\n    {\n        float woodWeight = ComputeWoodWeight(earlyWoodRatio);\n        diffAlbedo = DarkenColorWithPores(p, diffAlbedo, woodWeight);\n    }\n    if (wood_use_rays)\n        diffAlbedo = DarkenColorWithRays(p, diffAlbedo);\n    if(wood_use_groove_roughness)\n        roughness = LayerRoughnessVar(roughness, earlyWoodRatio);\n    return clamp(diffAlbedo, vec3(0.0), vec3(1.0));\n}\n#if defined(PRISMWOODBUMP)\nvoid getFinalWoodContext(\n    inout vec3 N, vec3 V, inout vec3 Tu, inout vec3 Tv, vec3 p,\n    vec3 geoNormal, vec3 tNormal, mat3 normalMatrix\n) {\n    vec3 offsetTuLeft = p - 0.001 * Tu;\n    vec3 offsetTuRight = p + 0.001 * Tu;\n    vec3 offsetTvLeft = p - 0.001 * Tv;\n    vec3 offsetTvRight = p + 0.001 * Tv;\n    float heightVariationTuLeft = HeightVariation(offsetTuLeft);\n    float heightVariationTuRight = HeightVariation(offsetTuRight);\n    float heightVariationTvLeft = HeightVariation(offsetTvLeft);\n    float heightVariationTvRight = HeightVariation(offsetTvRight);\n    vec3 bumpHeight = WoodBumpHeight(heightVariationTuLeft, heightVariationTuRight, heightVariationTvLeft, heightVariationTvRight);\n    vec3 newNormal = normalize(bumpHeight.x * Tu + bumpHeight.y * Tv + bumpHeight.z * vtNormal);\n    vec3 newNormalView = normalize(vNormalMatrix * newNormal);\n    vec3 selectedNormal = SelectNormal(geoNormal, newNormalView, V);\n    ComputeTangents(selectedNormal, Tu, Tv);\n    Tu = normalize(Tu);\n    Tv = normalize(Tv);\n    N = faceforward(selectedNormal, -V, selectedNormal);\n}\n#endif\n#endif\n"},4949:e=>{e.exports="\nuniform float shadowESMConstant;\nuniform float shadowMapRangeMin;\nuniform float shadowMapRangeSize;\n"},65080:e=>{e.exports="\n#ifdef USE_SHADOWMAP\nuniform sampler2D shadowMap;\nuniform vec2      shadowMapSize;\nuniform float     shadowDarkness;\nuniform float     shadowBias;\nuniform vec3      shadowLightDir;\nvarying vec4 vShadowCoord;\n#include <shadowmap_decl_common>\nfloat getShadowValue() {\n    float fDepth;\n    vec3 shadowColor = vec3( 1.0 );\n    vec3 shadowCoord = vShadowCoord.xyz / vShadowCoord.w;\n    shadowCoord.xyz = 0.5 * (shadowCoord.xyz + vec3(1.0, 1.0, 1.0));\n    bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n    bool inFrustum = all( inFrustumVec );\n    float shadowValue = 1.0;\n    if (inFrustum) {\n        shadowCoord.z = min(0.999, shadowCoord.z);\n        shadowCoord.z -= shadowBias;\n#ifdef USE_HARD_SHADOWS\n        vec4 rgbaDepth = texture2D( shadowMap, shadowCoord.xy );\n        float fDepth = rgbaDepth.r;\n        if ( fDepth < shadowCoord.z ) {\n            shadowValue = 1.0 - shadowDarkness;\n        }\n#else\n        vec4 rgbaDepth = texture2D( shadowMap, shadowCoord.xy );\n        float shadowMapValue = rgbaDepth.r;\n        shadowValue = exp(-shadowESMConstant * shadowCoord.z) * shadowMapValue;\n        shadowValue = min(shadowValue, 1.0);\n        shadowValue = mix(1.0 - shadowDarkness, 1.0, shadowValue);\n#endif\n    }\n    return shadowValue;\n}\n#else\nfloat getShadowValue() { return 1.0; }\n#endif\nvec3 applyEnvShadow(vec3 colorWithoutShadow, vec3 worldNormal) {\n#if defined(USE_SHADOWMAP)\n    float dp  = dot(shadowLightDir, worldNormal);\n    float dpValue = (dp + 1.0) / 2.0;\n    dpValue = min(1.0, dpValue * 1.5);\n    float sv = getShadowValue();\n    vec3 result = colorWithoutShadow * min(sv, dpValue);\n    return result;\n#else\n    return colorWithoutShadow;\n#endif\n}\n"},11458:e=>{e.exports="\n#ifdef USE_SHADOWMAP\nvarying vec4 vShadowCoord;\nuniform mat4 shadowMatrix;\n#endif\n"},36238:e=>{e.exports="\n#ifdef USE_SHADOWMAP\n{\n    vec4 worldPosition = modelMatrix * vec4( position, 1.0 );\n    vShadowCoord = shadowMatrix * worldPosition;\n}\n#endif\n"},94005:e=>{e.exports="uniform vec4 themingColor;\n"},25759:e=>{e.exports="gl_FragColor.rgb = mix(gl_FragColor.rgb, themingColor.rgb, themingColor.a);\n"},73985:e=>{e.exports="\nfloat luminance_post(vec3 rgb) {\n    return dot(rgb, vec3(0.299, 0.587, 0.114));\n}\nfloat luminance_pre(vec3 rgb) {\n    return dot(rgb, vec3(0.212671, 0.715160, 0.072169));\n}\nvec3 xyz2rgb(vec3 xyz) {\n    vec3 R = vec3( 3.240479, -1.537150, -0.498535);\n    vec3 G = vec3(-0.969256,  1.875992,  0.041556);\n    vec3 B = vec3( 0.055648, -0.204043,  1.057311);\n    vec3 rgb;\n    rgb.b = dot(xyz, B);\n    rgb.g = dot(xyz, G);\n    rgb.r = dot(xyz, R);\n    return rgb;\n}\nvec3 rgb2xyz(vec3 rgb) {\n    vec3 X = vec3(0.412453, 0.35758, 0.180423);\n    vec3 Y = vec3(0.212671, 0.71516, 0.0721688);\n    vec3 Z = vec3(0.0193338, 0.119194, 0.950227);\n    vec3 xyz;\n    xyz.x = dot(rgb, X);\n    xyz.y = dot(rgb, Y);\n    xyz.z = dot(rgb, Z);\n    return xyz;\n}\nvec3 xyz2xyY(vec3 xyz) {\n    float sum = xyz.x + xyz.y + xyz.z;\n    sum = 1.0 / sum;\n    vec3 xyY;\n    xyY.z = xyz.y;\n    xyY.x = xyz.x * sum;\n    xyY.y = xyz.y * sum;\n    return xyY;\n}\nvec3 xyY2xyz(vec3 xyY) {\n    float x = xyY.x;\n    float y = xyY.y;\n    float Y = xyY.z;\n    vec3 xyz;\n    xyz.y = Y;\n    xyz.x = x * (Y / y);\n    xyz.z = (1.0 - x - y) * (Y / y);\n    return xyz;\n}\nfloat toneMapCanon_T(float x)\n{\n    float xpow = pow(x, 1.60525727);\n    float tmp = ((1.05542877*4.68037409)*xpow) / (4.68037409*xpow + 1.0);\n    return clamp(tmp, 0.0, 1.0);\n}\nconst float Shift = 1.0 / 0.18;\nfloat toneMapCanonFilmic_NoGamma(float x) {\n    x *= Shift;\n    const float A = 0.2;\n    const float B = 0.34;\n    const float C = 0.002;\n    const float D = 1.68;\n    const float E = 0.0005;\n    const float F = 0.252;\n    const float scale = 1.0/0.833837;\n    return (((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F) * scale;\n}\nvec3 toneMapCanonFilmic_WithGamma(vec3 x) {\n    x *= Shift;\n    const float A = 0.27;\n    const float B = 0.29;\n    const float C = 0.052;\n    const float D = 0.2;\n    const float F = 0.18;\n    const float scale = 1.0/0.897105;\n    return (((x*(A*x+C*B))/(x*(A*x+B)+D*F))) * scale;\n}\nvec3 toneMapCanonOGS_WithGamma_WithColorPerserving(vec3 x) {\n    vec3 outColor = x.rgb;\n    outColor = min(outColor, vec3(3.0));\n    float inLum = luminance_pre(outColor);\n    if (inLum > 0.0) {\n        float outLum = toneMapCanon_T(inLum);\n        outColor = outColor * (outLum / inLum);\n        outColor = clamp(outColor, vec3(0.0), vec3(1.0));\n    }\n    float gamma = 1.0/2.2;\n    outColor = pow(outColor, vec3(gamma));\n    return outColor;\n}\n"},13458:e=>{e.exports="\n#ifdef WIDE_LINES\nattribute vec3 prev;\nattribute vec3 next;\nattribute float side;\nuniform vec2 view_size;\nvec2 to2d(vec4 i) {\n  return i.xy / i.w;\n}\n#endif\n"},16017:e=>{e.exports="\n#ifdef WIDE_LINES\nvec4 mvpPosition = projectionMatrix * mvPosition; \nmat3 vectorMatrix = mat3(modelViewMatrix);\nvec2 _pos = to2d(mvpPosition) * view_size;\nvec2 _prev = to2d(projectionMatrix * vec4(mvPosition.xyz + vectorMatrix * (prev * 0.01), 1.0)) * view_size;\nvec2 _next = to2d(projectionMatrix * vec4(mvPosition.xyz - vectorMatrix * (next * 0.01), 1.0)) * view_size;\nvec2 dir1 = _pos - _next;\nvec2 dir2 = _prev - _pos;\ndir2 = (length(dir2) > 0.0000001) ? normalize(dir2) : vec2(0.0, 0.0);\ndir1 = (length(dir1) > 0.0000001) ? normalize(dir1) : dir2;\nvec2 dir_sharp = normalize(dir1 + dir2);\nvec2 dir = normalize(dir1 + dir_sharp);\nvec2 offset = vec2(-dir.y, dir.x);\nfloat len = 1.0 / cross(vec3(offset, 0), vec3(dir1, 0)).z;\noffset *= len;\noffset /= view_size;\noffset *= side;\noffset *= mvpPosition.w;\nmvpPosition.xy += offset;\ngl_Position = mvpPosition;\n#endif\n"},2867:e=>{e.exports="varying vec3 vColor;\nvarying vec2 vUv;\nuniform samplerCube envMap;\nuniform vec3 uCamDir;\nuniform vec3 uCamUp;\nuniform vec2 uResolution;\nuniform float uHalfFovTan;\nuniform float opacity;\nuniform bool envMapBackground;\n#ifdef USE_BACKGROUND_TEXTURE\nuniform sampler2D backgroundTexture;\n#endif\n#include <env_sample>\nconst int bloomRange = 4;\n#include <ordered_dither>\nuniform float envMapExposure;\n#if TONEMAP_OUTPUT > 0\nuniform float exposureBias;\n#include <tonemap>\n#endif\nvec3 rayDir(in vec2 vUv) {\n    vec3 A = (uResolution.x/uResolution.y)*normalize(cross(uCamDir,uCamUp)) * (uHalfFovTan * 2.0);\n    vec3 B = normalize(uCamUp) * (uHalfFovTan * 2.0);\n    vec3 C = normalize(uCamDir);\n    vec3 ray = normalize( C + (2.0*vUv.x-1.0)*A + (2.0*vUv.y-1.0)*B );\n    return ray;\n}\nvec3 getColor(in vec3 rd) {\n    return RGBMDecode(textureCube(envMap, adjustLookupVector(rd)), envMapExposure);\n}\nvoid main() {\n    vec3 rd = rayDir(vUv);\n    vec3 outColor;\n    float alpha = opacity;\n#ifdef USE_BACKGROUND_TEXTURE\n    vec4 texel = texture2D(backgroundTexture, vUv);\n    outColor = texel.rgb;\n    alpha *= texel.a;\n#else\n    if (envMapBackground) {\n        outColor = getColor(rd);\n#if TONEMAP_OUTPUT == 1\n        outColor = toneMapCanonOGS_WithGamma_WithColorPerserving(exposureBias * outColor);\n#elif TONEMAP_OUTPUT == 2\n        outColor = toneMapCanonFilmic_WithGamma(exposureBias * outColor);\n#endif\n    }\n    else {\n        outColor = vColor;\n    }\n#endif\n    gl_FragColor = vec4(orderedDithering(outColor), alpha);\n}\n"},59047:e=>{e.exports="uniform vec3 color1;\nuniform vec3 color2;\nvarying vec2 vUv;\nvarying vec3 vColor;\nvoid main() {\n    if (uv.y == 0.0)\n        vColor = color2;\n    else\n        vColor = color1;\n    vUv = uv;\n    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}\n"},48544:e=>{e.exports="uniform vec3 diffuse;\nuniform float opacity;\n#if defined(DEPTH_OCCLUSION) && DEPTH_OCCLUSION == 1\nuniform sampler2D tDepthTest;\nuniform vec2 tDepthResolution;\nvarying float vDepthPositionZ;\n#endif\n#include <common>\n#include <color_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#if NUM_CUTPLANES > 0\nvarying highp vec3 vWorldPosition;\n#endif\n#if defined( PARTICLE_UV )\nvarying highp vec4 vUVp;\n#endif\n#include <cutplanes>\n#include <id_decl_frag>\n#include <theming_decl_frag>\nvoid main() {\n#if NUM_CUTPLANES > 0\n    checkCutPlanes(vWorldPosition);\n#endif\n    vec3 outgoingLight = vec3( 0.0 );\n    vec4 diffuseColor = vec4( diffuse, opacity );\n#if defined( USE_MAP ) && defined ( PARTICLE_FRAGMENT )\n    #if defined( PARTICLE_UV )\n        vec2 uv3 = mix( vUVp.xy, vUVp.zw, gl_PointCoord );\n        diffuseColor = texture2D( map, uv3);\n    #else\n    \tdiffuseColor = texture2D( map, gl_PointCoord );\n    #endif\n#else\n    #include <map_fragment>\n#endif\n#include <color_fragment>\n#include <alphamap_fragment>\n#include <alphatest_fragment>\n#include <specularmap_fragment>\n    outgoingLight = diffuseColor.rgb;\n#if !defined ( PARTICLE_FRAGMENT )\n    #include <lightmap_fragment>\n    #include <envmap_fragment>\n#endif\n#include <linear_to_gamma_fragment>\n    gl_FragColor = vec4( outgoingLight, diffuseColor.a );\n    vec3 geomNormal = vec3(0.0,0.0,0.0);\n    float depth = 0.0;\n#include <theming_frag>\n#if defined(DEPTH_OCCLUSION) && DEPTH_OCCLUSION == 1\n    vec2 depthUV = gl_FragCoord.xy * tDepthResolution;\n    float depthVal = texture2D(tDepthTest, depthUV).z;\n    if(depthVal > vDepthPositionZ && depthVal != 0.) {\n        discard;\n    }\n#endif\n#include <final_frag>\n}\n"},75101:e=>{e.exports="#include <id_decl_vert>\n#include <decl_point_size>\n#include <common>\n#include <map_pars_vertex>\n#include <lightmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <wide_lines_decl>\n#include <pack_normals>\n#ifdef USE_INSTANCING\n    #include <instancing_decl_vert>\n#endif\n#if defined( PARTICLE_UV )\nattribute vec4 uvp;\nvarying highp vec4 vUVp;\n#endif\n#if defined (PARTICLE_FLAGS)\nattribute float pointScale;\n#endif\n#if NUM_CUTPLANES > 0\nvarying vec3 vWorldPosition;\n#endif\n#if defined(DEPTH_OCCLUSION) && DEPTH_OCCLUSION == 1\nvarying float vDepthPositionZ;\n#endif\nvoid main() {\n#ifdef USE_INSTANCING\n    vec3 instancePosition = getInstancePos(position);\n    #define position instancePosition\n#endif\n#if defined(USE_ENVMAP) && (defined(UNPACK_NORMALS) || defined(USE_INSTANCE))\n    vec3 correctNormal;\n    #ifdef UNPACK_NORMALS\n        correctNormal = decodeNormal(normal);\n    #else\n        correctNormal = normal;\n    #endif\n    #ifdef USE_INSTANCING\n        correctNormal = getInstanceNormal(correctNormal);\n    #endif\n    #define normal correctNormal\n#endif\n#include <map_vertex>\n#include <lightmap_vertex>\n#include <color_vertex>\n#ifdef USE_ENVMAP\n#include <defaultnormal_vertex>\n#endif\n#include <default_vertex>\n#include <wide_lines_vert>\n#include <worldpos_vertex>\n#if NUM_CUTPLANES > 0\n    vec4 _worldPosition = modelMatrix * vec4( position, 1.0 );\n    vWorldPosition = _worldPosition.xyz;\n#endif\n#if defined(DEPTH_OCCLUSION) && DEPTH_OCCLUSION == 1\n    vec4 _vDepthPosition = modelViewMatrix * vec4( position, 1.0 );\n    vDepthPositionZ = _vDepthPosition.z;\n#endif\n#if defined( PARTICLE_UV )\n    vUVp = uvp;\n#endif\n#include <envmap_vertex>\n#include <id_vert>\n#include <point_size>\n#if defined (PARTICLE_FLAGS) \n    gl_PointSize *= clamp(pointScale, 0.0, 2.0);\n#endif\n}\n"},20505:e=>{e.exports="uniform sampler2D tDiffuse;\nuniform sampler2D tAO;\nuniform int useAO;\nuniform float aoOpacity;\nuniform sampler2D tOverlay;\nuniform int useOverlay;\nuniform int useOverlayAlpha;\nuniform vec2 resolution;\nuniform vec4 objIDv4;\nuniform sampler2D tID;\nuniform vec4 edgeObjIDv4;\n#if defined(USE_MODEL_ID)\n#if defined(HIGHLIGHT_MODEL_ID_COUNT)\nuniform vec2 modelIDsv2v[HIGHLIGHT_MODEL_ID_COUNT];\n#else\nuniform vec2 modelIDv2;\n#endif\nuniform sampler2D tID2;\nuniform vec2 edgeModelIDv2;\n#endif\nuniform float highlightIntensity;\nuniform vec3 selectionColor;\nuniform float highlightFullModel;\nuniform vec3 highlightColor;\n#ifdef IS_2D\nuniform float expand2dSelection;\n#endif\nuniform sampler2D tCrossFadeTex0;\nuniform sampler2D tCrossFadeTex1;\nuniform float     crossFadeOpacity0;\nuniform float     crossFadeOpacity1;\nvarying vec2 vUv;\n#ifdef SPATIAL_FILTER\n#include <depth_texture>\n#endif\n#include <tonemap>\n#ifdef USE_IDBUFFER_SELECTION\nbool isSelection(vec2 vUv, float I, float J) {\n    vec4 idAtPixel = texture2D(tID, vUv+resolution*vec2(I,J));\n    if (idAtPixel.rgb == vec3(0.0))\n        return false;\n#if defined(USE_MODEL_ID)\n    vec4 modelAtPixel = texture2D(tID2, vUv+resolution*vec2(I,J));\n    idAtPixel.a = modelAtPixel.b;\n    vec4 idDelta = abs(idAtPixel.rgba - edgeObjIDv4.rgba);\n    vec2 modelDelta = abs(modelAtPixel.rg - edgeModelIDv2.rg);\n#else\n    vec4 idDelta = vec4(abs(idAtPixel.rgb - edgeObjIDv4.rgb), 0.0);\n    vec2 modelDelta = vec2(0.0, 0.0);\n#endif\n    if (max(max(modelDelta.r, modelDelta.g), max(max(idDelta.r, idDelta.g), max(idDelta.b, idDelta.a))) < 1e-3) {\n        return true;\n    } else {\n        return false;\n    }\n}\n#else\nbool isSelected(vec3 C) {\n    float minS = min(selectionColor.r, min(selectionColor.g, selectionColor.b));\n    float maxS = max(selectionColor.r, max(selectionColor.g, selectionColor.b));\n    float satS = maxS - minS;\n    float minC = min(C.r, min(C.g, C.b));\n    float maxC = max(C.r, max(C.g, C.b));\n    float satC = maxC - minC;\n    if (satC < .01 || satS < .01)\n        return false;\n    vec3 S = (selectionColor - minS) / satS;\n    vec3 H = (C - minC) / satC;\n    vec3 D = H - S;\n    float eps = .15;\n    return (abs(D.r) + abs(D.g) + abs(D.b) < eps)\n        || (maxC >= (1.0 - eps) && D.r >= -eps && D.g >= -eps && D.b >= -eps);\n}\n#define IS_SELECTION(C) isSelected((C).rgb)\n#endif\nvec4 overlayEdgeDetect(vec2 vUv) {\n#ifdef IS_2D\n#define MAX_ALPHA(c)\n#define SUM_ALPHA(c, w) sumAlpha += c.a * w; sumWeight += w;\n#else\n#define MAX_ALPHA(c) maxAlpha = max(maxAlpha, c.a);\n#define SUM_ALPHA(c, w) \n#endif\n#ifdef USE_IDBUFFER_SELECTION\n#define CHECK_EDGE_ALPHA(I, J, W)     { vec4 c = texture2D( tOverlay, vUv+resolution*vec2((I),(J)) ); MAX_ALPHA(c) if (c.a > 0.0 && isSelection(vUv, I, J)) { hasEdge++; SUM_ALPHA(c, W) selectionPixel = c; } }\n#else\n#define CHECK_EDGE_ALPHA(I, J, W)     { vec4 c = texture2D( tOverlay, vUv+resolution*vec2((I),(J)) ); MAX_ALPHA(c) if (c.a > 0.0 && IS_SELECTION(c)) { hasEdge++; SUM_ALPHA(c, W) selectionPixel = c; } }\n#endif\n#ifndef IS_2D\n#define CHECK_EDGE_SELECTION(I, J) { vec4 c = texture2D( tOverlay, vUv+resolution*vec2((I),(J)) ); MAX_ALPHA(c) if (c.a <= 0.0) hasEdge++; }\n#endif\n    int hasEdge = 0;\n    vec4 center = texture2D(tOverlay, vUv);\n    vec4 selectionPixel = vec4(0.0);\n#ifdef IS_2D\n    float sumAlpha = 0.0, sumWeight = 0.0;\n#else\n    float maxAlpha = 0.0;\n    bool paintOutline = false;\n#endif\n    if (center.a <= 0.0) {\n        CHECK_EDGE_ALPHA(-1.0,-1.0, 1.0);\n        CHECK_EDGE_ALPHA( 0.0,-1.0, 2.0);\n        CHECK_EDGE_ALPHA( 1.0,-1.0, 1.0);\n        CHECK_EDGE_ALPHA(-1.0, 0.0, 2.0);\n        CHECK_EDGE_ALPHA( 1.0, 0.0, 2.0);\n        CHECK_EDGE_ALPHA(-1.0, 1.0, 1.0);\n        CHECK_EDGE_ALPHA( 0.0, 1.0, 2.0);\n        CHECK_EDGE_ALPHA( 1.0, 1.0, 1.0);\n        if (hasEdge != 0) {\n#ifdef IS_2D\n            center.a = -clamp(expand2dSelection - 1.0 + sumAlpha / sumWeight, 0.0, 1.0);\n            center.rgb = center.a < 0.0 ? selectionPixel.rgb : center.rgb;\n#else\n            center = selectionPixel;\n            paintOutline = true;\n#endif\n        }\n    }\n#ifdef USE_IDBUFFER_SELECTION\n    else if (center.a > 0.0 && isSelection(vUv, 0.0, 0.0)) {\n#else\n    else if (center.a > 0.0 && IS_SELECTION(center)) {\n#endif\n#ifdef IS_2D\n        center.a = -clamp(center.a + expand2dSelection, 0.0, 1.0);\n#else\n        CHECK_EDGE_SELECTION(-1.0,-1.0);\n        CHECK_EDGE_SELECTION( 0.0,-1.0);\n        CHECK_EDGE_SELECTION( 1.0,-1.0);\n        CHECK_EDGE_SELECTION(-1.0, 0.0);\n        CHECK_EDGE_SELECTION( 1.0, 0.0);\n        CHECK_EDGE_SELECTION(-1.0, 1.0);\n        CHECK_EDGE_SELECTION( 0.0, 1.0);\n        CHECK_EDGE_SELECTION( 1.0, 1.0);\n        if (hasEdge != 0)\n            paintOutline = true;\n        else\n            center.a = -center.a;\n#endif\n    }\n#ifndef IS_2D\n    if (paintOutline) {\n        float maxComponent = max(center.r, max(center.g, center.b));\n        center.rgb /= maxComponent;\n        center.rgb = sqrt(center.rgb);\n        center.a = 0.5 + 0.5 * maxAlpha * 0.125 * float(hasEdge);\n    }\n#endif\n    return center;\n}\n#ifdef SPATIAL_FILTER\nSPATIAL_FILTER\n#endif\nvec4 sampleColor() {\n    return texture2D( tDiffuse, vUv );\n}\nfloat sampleAO() {\n    return (useAO != 0) ? sqrt(texture2D(tAO, vUv).r) : 1.0;\n}\nvec3 applyCrossFade(vec3 srcColor, sampler2D fadeTex, float opacity, vec2 vUv) {\n    vec4 blendCol = texture2D(fadeTex, vUv);\n    return mix(srcColor.rgb, blendCol.rgb, blendCol.a * opacity);\n}\nvoid applyHighlighting(inout vec3 rgb, float filterValue) {\n#ifdef IS_2D\n    rgb = mix(rgb, vec3(1.0,1.0,0.0), filterValue * highlightIntensity * 0.25);\n#else\n    rgb += highlightColor * filterValue * highlightIntensity * 0.20;\n#endif\n}\n#ifdef USE_MODEL_ID\nfloat getModelIdDelta(vec2 a, vec2 b) {\n    vec2 delta = abs(a-b);\n    return max(delta.r, delta.g);\n}\nfloat getModelIdDelta(vec2 modelAtPixel) {\n    \n#ifdef HIGHLIGHT_MODEL_ID_COUNT\n    float delta = 1.0;\n    for (int i=0; i<HIGHLIGHT_MODEL_ID_COUNT; i++) {\n        delta = min(delta, getModelIdDelta(modelAtPixel, modelIDsv2v[i]));\n    }\n    return delta;\n#else\n    return getModelIdDelta(modelAtPixel, modelIDv2.rg);\n#endif\n}\n#endif\nvoid main() {\n    vec4 texel = sampleColor();\n    float ao = sampleAO();\n    #ifdef NUM_CROSSFADE_TARGETS\n        #if (NUM_CROSSFADE_TARGETS > 1)\n            #if (TARGET_FADE_MODE == 0)\n                texel.rgb = applyCrossFade(texel.rgb, tCrossFadeTex0, crossFadeOpacity0, vUv);\n                texel.rgb = applyCrossFade(texel.rgb, tCrossFadeTex1, crossFadeOpacity1, vUv);\n            #else\n                vec4 t0 = texture2D(tCrossFadeTex0, vUv);\n                vec4 t1 = texture2D(tCrossFadeTex1, vUv);\n                vec4 mixed = mix(t0, t1, crossFadeOpacity1);\n                texel.rgb = mix(texel.rgb, mixed.rgb, mixed.a);\n                float aoGamma = 1.0 + 3.0 * (1.0 - 2.0 * abs(crossFadeOpacity1 - 0.5));\n                if (aoGamma == 0.0)\n                    aoGamma = 1.0;\n                ao = pow(ao, 1.0 / aoGamma);\n            #endif\n        #else\n            vec4 mixed = texture2D(tCrossFadeTex0, vUv);\n            texel.rgb = mix(texel.rgb, mixed.rgb, mixed.a);\n        #endif\n    #else\n    #endif\n    ao = 1.0 - (1.0 - ao) * aoOpacity;\n    texel.rgb *= ao;\n    if (useOverlay != 0) {\n        vec4 overlay = overlayEdgeDetect(vUv);\n        if (overlay.a < 0.0) {\n            overlay.a = -overlay.a;\n#ifdef IS_2D\n            overlay.a *= 0.6;\n#else\n            if (overlay.a >= 0.99) {\n                overlay.a = 0.75;\n                texel.rgb = vec3(luminance_post(texel.rgb));\n            }\n#endif\n        }\n#ifdef IS_2D\n        texel.rgb = texel.rgb * (1.0 - overlay.a) + overlay.rgb;\n#else\n        texel.rgb = texel.rgb * (1.0 - overlay.a) + sqrt(overlay.rgb * overlay.a);\n#endif\n        if (useOverlayAlpha != 0) {\n            texel.a += overlay.a * (1.0 - texel.a);\n        }\n    }\n    if (objIDv4 != vec4(0.0)) {\n    vec4 idAtPixel = texture2D(tID, vUv);\n    #ifdef SPATIAL_FILTER\n        vec3 worldPos = reconstructWorldPosition(gl_FragCoord.xy, vUv);\n        float filterValue = (spatialFilter(worldPos) ? 1.0 : 0.0);\n        if (idAtPixel != vec4(1,1,1,1)) {\n            applyHighlighting(texel.rgb, filterValue);\n        }\n    #else\n        #if defined(USE_MODEL_ID)\n            vec4 modelAtPixel = texture2D(tID2, vUv);\n            idAtPixel.a = modelAtPixel.b;\n            vec4 idDelta = abs(idAtPixel.rgba - objIDv4.rgba) * (1.0 - highlightFullModel);\n            float modelDelta = getModelIdDelta(modelAtPixel.rg);\n        #else\n            vec4 idDelta = vec4(abs(idAtPixel.rgb - objIDv4.rgb), 0.0);\n            float modelDelta = 0.0;\n        #endif\n            if (max(modelDelta, max(max(idDelta.r, idDelta.g), max(idDelta.b, idDelta.a))) < 1e-3) {\n                applyHighlighting(texel.rgb, 1.0);\n            }\n    #endif\n    }\n    gl_FragColor = texel;\n}\n"},40518:e=>{e.exports="\n#include <depth_texture>\nuniform sampler2D tDiffuse;\nuniform sampler2D tID;\nuniform vec2 resolution;\nuniform float cameraNear;\nuniform float cameraFar;\nuniform sampler2D tFill;\nuniform sampler2D tPaper;\nuniform int style;\nuniform int idEdges;\nuniform int normalEdges;\nuniform int depthEdges;\nuniform float brightness;\nuniform float contrast;\nuniform int grayscale;\nuniform int preserveColor;\nuniform int outlineNoise;\nuniform float levels;\nuniform float repeats;\nuniform float rotation;\nuniform float outlineRadius;\nuniform sampler2D tGraphite1;\nuniform sampler2D tGraphite2;\nuniform sampler2D tGraphite3;\nuniform sampler2D tGraphite4;\nuniform sampler2D tGraphite5;\nuniform sampler2D tGraphite6;\nuniform sampler2D tGraphite7;\nuniform sampler2D tGraphite8;\nvarying vec2 vUv;\nvec4 recoverNZ(vec4 nrmz) {\n    float z = sqrt(1.0 - dot(nrmz.xy, nrmz.xy));\n    nrmz.w = -(nrmz.z + cameraNear) / (cameraFar - cameraNear);\n    nrmz.z = z;\n    return nrmz;\n}\n#include <tonemap>\n#include <hsv>\nvec3 quantize(vec3 c) {\n    float L = max(c.r, max(c.g, c.b));\n    c *= floor(L * (levels-1.0) + 0.5) / (L * (levels-1.0));\n    return c;\n}\nvec3 quantizeRGB(vec3 c) {\n    c *= c;\n    c *= floor(c * levels * 0.9999) / (levels-1.0);\n    return sqrt(c);\n}\nvec3 clampHue(vec3 c, float hues, float sats, float vals) {\n    vec3 hsv = rgb2hsv(c);\n    hsv.x = floor(hsv.x * hues + 0.5) / hues;\n    hsv.y = floor(hsv.y * sats + 0.5) / sats;\n    hsv.z = floor(hsv.z * vals + 0.5) / vals;\n    vec3 col = hsv2rgb(hsv);\n    return col;\n}\nvec3 reconstructCSFaceNormal(vec3 C) {\n    return normalize(cross(dFdy(C), dFdx(C)));\n}\nvec3 getPosition(ivec2 ssP, float depth) {\n    vec3 P;\n    P = reconstructCSPosition(vec2(ssP) + vec2(0.5), depth);\n    return P;\n}\nint isObjectEdge() {\n    vec2 uv = vUv;\n    if (outlineNoise == 1) {\n        vec4 noise = texture2D(tGraphite7, vUv);\n        uv = vUv + 0.02 * (noise.xy - vec2(0.25));\n    }\n    vec4 MM = texture2D(tID, uv);\n    vec4 LL = texture2D(tID, uv + vec2(-outlineRadius, -outlineRadius) * resolution);\n    if (MM != LL) return 1;\n    vec4 LM = texture2D(tID, uv + vec2( 0.0, -outlineRadius) * resolution);\n    if (MM != LM) return 1;\n    vec4 LR = texture2D(tID, uv + vec2( outlineRadius, -outlineRadius) * resolution);\n    if (MM != LR) return 1;\n    vec4 ML = texture2D(tID, uv + vec2(-outlineRadius,  0.0) * resolution);\n    if (MM != ML) return 1;\n    vec4 MR = texture2D(tID, uv + vec2( outlineRadius,  0.0) * resolution);\n    if (MM != MR) return 1;\n    vec4 UL = texture2D(tID, uv + vec2(-outlineRadius,  outlineRadius) * resolution);\n    if (MM != UL) return 1;\n    vec4 UM = texture2D(tID, uv + vec2( 0.0,  outlineRadius) * resolution);\n    if (MM != UM) return 1;\n    vec4 UR = texture2D(tID, uv + vec2( outlineRadius,  outlineRadius) * resolution);\n    if (MM != UR) return 1;\n    return (MM.x + MM.y + MM.z + MM.w) >= 4.0 ? 0 : -1;\n}\nfloat normalDiff(vec3 n1, vec3 n2) {\n    float d = dot(n1.xyz, n2.xyz);\n    return acos(clamp(d, -1.0, 1.0));\n}\nint isNormalDepthEdge() {\n    ivec2 ssC = ivec2(gl_FragCoord.xy);\n    vec2 uv = vUv;\n    if (outlineNoise == 1) {\n        vec4 noise = texture2D(tGraphite7, vUv);\n        uv = vUv + 0.02 * (noise.xy - vec2(0.25));\n    }\n    vec4 MM = texture2D(tDepth, uv);\n    vec4 LL = texture2D(tDepth, uv + vec2(-outlineRadius, -outlineRadius) * resolution);\n    vec4 LM = texture2D(tDepth, uv + vec2( 0.0, -outlineRadius) * resolution);\n    vec4 LR = texture2D(tDepth, uv + vec2( outlineRadius, -outlineRadius) * resolution);\n \n    vec4 ML = texture2D(tDepth, uv + vec2(-outlineRadius,  0.0) * resolution);\n    vec4 MR = texture2D(tDepth, uv + vec2( outlineRadius,  0.0) * resolution);\n    vec4 UL = texture2D(tDepth, uv + vec2(-outlineRadius, outlineRadius) * resolution);\n    vec4 UM = texture2D(tDepth, uv + vec2( 0.0,  outlineRadius) * resolution);\n    vec4 UR = texture2D(tDepth, uv + vec2( outlineRadius,  outlineRadius) * resolution);\n    LL = recoverNZ(LL);\n    LM = recoverNZ(LM);\n    LR = recoverNZ(LR);\n    ML = recoverNZ(ML);\n    MM = recoverNZ(MM);\n    MR = recoverNZ(MR);\n    UL = recoverNZ(UL);\n    UM = recoverNZ(UM);\n    UR = recoverNZ(UR);\n    float dd = 0.0;\n    if ( depthEdges == 1 ) {\n        float G = (abs(UL.w - MM.w) + 2.0 * abs(UM.w - MM.w) + abs(UR.w - MM.w) + 2.0 * abs(ML.w - MM.w) + 2.0 * abs(MR.w - MM.w) + abs(LL.w - MM.w) + 2.0 * abs(LM.w - MM.w) + abs(LR.w - MM.w));\n        dd = abs(dFdx(G)) + abs(dFdy(G));\n    }\n    float Gn = 0.0;\n    if ( normalEdges == 1 ) {\n        float pLL = normalDiff(LL.xyz, MM.xyz);\n        float pLM = normalDiff(LM.xyz, MM.xyz);\n        float pLR = normalDiff(LR.xyz, MM.xyz);\n        float pML = normalDiff(ML.xyz, MM.xyz);\n        float pMM = normalDiff(MM.xyz, MM.xyz);\n        float pMR = normalDiff(MR.xyz, MM.xyz);\n        float pUL = normalDiff(UL.xyz, MM.xyz);\n        float pUM = normalDiff(UM.xyz, MM.xyz);\n        float pUR = normalDiff(UR.xyz, MM.xyz);\n        Gn = (abs(pUL - pMM) + 2.0 * abs(pUM - pMM) + abs(pUR - pMM) + 2.0 * abs(pML - pMM) + 2.0 * abs(pMR - pMM) + abs(pLL - pMM) + 2.0 * abs(pLM - pMM) + abs(pLR - pMM));\n    }\n    \n    return (dd > 0.004 || Gn > 2.0) ? 1 : 0;\n}\nvec3 computeGraphite( vec3 color, vec2 loc ) {\n    float lum = 0.299 * color.r + 0.587 * color.g + 0.114 * color.b;\n    float offset;\n    vec3 col1, col2;\n    if ( lum > 6.0/7.0 ) {\n        col1 = texture2D(tGraphite1, loc ).xyz;\n        col2 = texture2D(tGraphite2, loc ).xyz;\n        offset = 6.0/7.0;\n    } else if ( lum > 5.0/7.0 ) {\n        col1 = texture2D(tGraphite2, loc ).xyz;\n        col2 = texture2D(tGraphite3, loc ).xyz;\n        offset = 5.0/7.0;\n    } else if ( lum > 4.0/7.0 ) {\n        col1 = texture2D(tGraphite3, loc ).xyz;\n        col2 = texture2D(tGraphite4, loc ).xyz;\n        offset = 4.0/7.0;\n    } else if ( lum > 3.0/7.0 ) {\n        col1 = texture2D(tGraphite4, loc ).xyz;\n        col2 = texture2D(tGraphite5, loc ).xyz;\n        offset = 3.0/7.0;\n    } else if ( lum > 2.0/7.0 ) {\n        col1 = texture2D(tGraphite5, loc ).xyz;\n        col2 = texture2D(tGraphite6, loc ).xyz;\n        offset = 2.0/7.0;\n    } else if ( lum > 1.0/7.0 ) {\n        col1 = texture2D(tGraphite6, loc ).xyz;\n        col2 = texture2D(tGraphite7, loc ).xyz;\n        offset = 1.0/7.0;\n    } else {\n        col1 = texture2D(tGraphite7, loc ).xyz;\n        col2 = texture2D(tGraphite8, loc ).xyz;\n        offset = 0.0;\n    }\n    if ( col1.r == 0.0 && col2.r == 0.0 ) {\n        return vec3(lum,lum,lum);\n    }\n    float t = (lum-offset)*7.0;\n    return (col1 * t + col2 * (1.0 - t));\n}\nvec3 colorWithAdjustments() {\n    vec3 sceneRGB = texture2D(tDiffuse, vUv).xyz;\n    if ( brightness != 0.0 || contrast != 0.0) {\n        if ( brightness < 0.0 )\n        {\n            sceneRGB = sceneRGB * (1.0 + brightness);\n        }\n        else\n        {\n            sceneRGB = sceneRGB + ((1.0 - sceneRGB) * brightness);\n        }\n        float slant = tan(( clamp(contrast,-1.0,1.0) + 1.0) * 3.141592/4.001);\n        sceneRGB = (sceneRGB - 0.5) * slant + 0.5;\n        if ( preserveColor == 1 )\n        {\n            float maxval = max( sceneRGB.r, sceneRGB.g );\n            maxval = max( maxval, sceneRGB.b );\n            if ( maxval > 1.0 )\n            {\n                sceneRGB /= maxval;\n            }\n        }\n        sceneRGB = clamp(sceneRGB,0.0,1.0);\n    }\n    if ( grayscale == 1 ) {\n        sceneRGB.rgb = vec3(luminance_post(sceneRGB.rgb));\n    }\n    return sceneRGB;\n}\nvoid main() {\n    int foundEdge = 0;\n    foundEdge = ( idEdges == 1 && isObjectEdge() == 1 ) ? 1 : 0;\n    if ( foundEdge == 0 && (normalEdges == 1 || depthEdges == 1) ) {\n        foundEdge = isNormalDepthEdge();\n    }\n    vec2 loc = vec2((vUv.x-0.5)*(resolution.y/resolution.x),vUv.y-0.5)*repeats;\n    if ( style > 2 && rotation != 0.0 ) {\n        float rot = 3.14159*rotation;\n        float sinr = sin(rot);\n        float cosr = cos(rot);\n        loc = vec2(loc.x*cosr + -loc.y*sinr, loc.x*sinr + loc.y*cosr);\n    }\n    loc += vec2(0.5,0.5);\n    vec3 color;\n    if ( style == 2 ) {\n        if ( foundEdge == 1 ) {\n            gl_FragColor = vec4(0.0,0.0,0.0,1.0);\n        } else {\n            gl_FragColor = vec4(quantize(colorWithAdjustments()),1.0);\n        }\n    } else if ( style == 3 ) {\n        color = colorWithAdjustments();\n        vec3 graphColor = computeGraphite( color, loc );\n        if ( foundEdge == 1 ) {\n            gl_FragColor = vec4(0.16,0.16,0.16,1.0) + vec4(0.18 * graphColor,0.0);\n        } else {\n            gl_FragColor = vec4(graphColor,1.0);\n        }\n        return;\n    } else if ( style == 4 ) {\n        float fill = texture2D(tFill, loc ).r;\n        float paperStrength = 0.3;\n        vec3 paper = texture2D(tPaper, loc ).rgb;\n        paper = paperStrength * paper + (1.0-paperStrength)*vec3(1.0,1.0,1.0);\n        if ( foundEdge == 1 ) {\n            gl_FragColor = 0.75 * vec4(paper * fill, 1.0);\n        } else {\n            fill = pow(fill,1.6);\n            gl_FragColor = vec4(colorWithAdjustments() * (1.0 - fill) + paper * fill, 1.0);\n        }\n    } else {\n        if ( foundEdge == 1 ) {\n            gl_FragColor = vec4(0.0,0.0,0.0,1.0);\n        } else {\n            gl_FragColor = vec4(colorWithAdjustments(),1.0);\n        }\n        return;        \n    }\n}\n"},67086:e=>{e.exports="uniform sampler2D tDiffuse;\nvarying vec2 vUv;\nvoid main() {\n    gl_FragColor = texture2D(tDiffuse, vUv);\n}\n"},6750:e=>{e.exports="\n#if NUM_CUTPLANES > 0\nvarying vec3 vWorldPosition;\n#endif\n#include <cutplanes>\nuniform vec4 color;\n#include <id_decl_frag>\nvoid main() {\n#if NUM_CUTPLANES > 0\n    checkCutPlanes(vWorldPosition);\n#endif\n    gl_FragColor = color;\n#ifdef MRT_NORMALS\noutNormal = vec4(0.0);\n#endif\n#ifdef MRT_ID_BUFFER\n    outId = vec4(0.0);\n    #ifdef MODEL_COLOR\n        outModelId = vec4(0.0);\n    #endif\n#elif defined(ID_COLOR)\n    gl_FragColor = vec4(0.0);\n#elif defined(MODEL_COLOR)\n    gl_FragColor = vec4(0.0);\n#endif\n}"},79282:e=>{e.exports="\n#if NUM_CUTPLANES > 0\nvarying vec3 vWorldPosition;\n#endif\n#include <instancing_decl_vert>\nvoid main() {\n    vec3 instPos = getInstancePos(position);\n#if NUM_CUTPLANES > 0\n    vec4 worldPosition = modelMatrix * vec4( instPos, 1.0 );\n    vWorldPosition = worldPosition.xyz;\n#endif\n    vec4 mvPosition = modelViewMatrix * vec4( instPos, 1.0 );\n    vec4 p_Position = projectionMatrix * mvPosition;\n    gl_Position = p_Position;\n}"},49510:e=>{e.exports="#define FXAA_EDGE_SHARPNESS (8.0)\n#define FXAA_EDGE_THRESHOLD (0.125)\n#define FXAA_EDGE_THRESHOLD_MIN (0.05)\n#define FXAA_RCP_FRAME_OPT (0.50)\n#define FXAA_RCP_FRAME_OPT2 (2.0)\nuniform sampler2D tDiffuse;\nuniform highp vec2 uResolution;\nvarying vec2 vPos;\nvarying vec4 vPosPos;\nfloat FxaaLuma(vec3 rgb) {\n    return dot(rgb, vec3(0.299, 0.587, 0.114));\n}\nvoid main() {\n    float lumaNw = FxaaLuma(texture2D(tDiffuse, vPosPos.xy).rgb);\n    float lumaSw = FxaaLuma(texture2D(tDiffuse, vPosPos.xw).rgb);\n    float lumaNe = FxaaLuma(texture2D(tDiffuse, vPosPos.zy).rgb) + 1.0/384.0;\n    float lumaSe = FxaaLuma(texture2D(tDiffuse, vPosPos.zw).rgb);\n    vec4 rgbaM = texture2D(tDiffuse, vPos.xy);    \n    float lumaM = FxaaLuma(rgbaM.rgb);\n    float lumaMax = max(max(lumaNe, lumaSe), max(lumaNw, lumaSw));\n    float lumaMin = min(min(lumaNe, lumaSe), min(lumaNw, lumaSw));\n    float lumaMaxSubMinM = max(lumaMax, lumaM) - min(lumaMin, lumaM);\n    float lumaMaxScaledClamped = max(FXAA_EDGE_THRESHOLD_MIN, lumaMax * FXAA_EDGE_THRESHOLD);\n    if (lumaMaxSubMinM < lumaMaxScaledClamped) {\n        gl_FragColor = rgbaM;\n        return;\n    }\n    float dirSwMinusNe = lumaSw - lumaNe;\n    float dirSeMinusNw = lumaSe - lumaNw;\n    vec2 dir1 = normalize(vec2(dirSwMinusNe + dirSeMinusNw, dirSwMinusNe - dirSeMinusNw));\n    vec3 rgbN1 = texture2D(tDiffuse, vPos.xy - dir1 * FXAA_RCP_FRAME_OPT*uResolution).rgb;\n    vec3 rgbP1 = texture2D(tDiffuse, vPos.xy + dir1 * FXAA_RCP_FRAME_OPT*uResolution).rgb;\n    float dirAbsMinTimesC = min(abs(dir1.x), abs(dir1.y)) * FXAA_EDGE_SHARPNESS;\n    vec2 dir2 = clamp(dir1.xy / dirAbsMinTimesC, -2.0, 2.0);\n    vec3 rgbN2 = texture2D(tDiffuse, vPos.xy - dir2 * FXAA_RCP_FRAME_OPT2*uResolution).rgb;\n    vec3 rgbP2 = texture2D(tDiffuse, vPos.xy + dir2 * FXAA_RCP_FRAME_OPT2*uResolution).rgb;\n    vec3 rgbA = rgbN1 + rgbP1;\n    vec3 rgbB = ((rgbN2 + rgbP2) * 0.25) + (rgbA * 0.25);\n    float lumaB = FxaaLuma(rgbB);\n    float alpha = rgbaM.a;\n    if ((lumaB < lumaMin) || (lumaB > lumaMax))\n        gl_FragColor = vec4(rgbA * 0.5, rgbaM.a);\n    else\n        gl_FragColor = vec4(rgbB, rgbaM.a);\n}\n"},63332:e=>{e.exports="uniform vec2 uResolution;\nvarying vec2 vPos;\nvarying vec4 vPosPos;\nvoid main() {\n    vPos = uv;\n    vPosPos.xy = uv + vec2(-0.5, -0.5) * uResolution;\n    vPosPos.zw = uv + vec2( 0.5,  0.5) * uResolution;\n    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}\n"},93285:e=>{e.exports="uniform sampler2D tDiffuse;\nuniform vec4 uColor;\nvarying vec2 vUv;\n#ifdef HORIZONTAL\n#define GET_UV(X) vec2(vUv.x + KERNEL_SCALE_H*(X), vUv.y)\n#else\n#define GET_UV(Y) vec2(vUv.x, vUv.y + KERNEL_SCALE_V*(Y))\n#endif\n#define PI 3.14159265358979\n#define SIGMA ((KERNEL_RADIUS+KERNEL_RADIUS+1.0) / 6.0)\n#define SIGMASQ2 (2.0 * SIGMA * SIGMA)\n#define GAUSSIAN(X) ( (1.0 / sqrt(PI * SIGMASQ2)) * exp(-(X)*(X)/SIGMASQ2) )\nvoid main() {\n    vec4 texColSum = vec4(0.0);\n    float gaussSum = 0.0;\n    for (float x=-KERNEL_RADIUS; x<=KERNEL_RADIUS; x+=1.0) {\n        float gauss = GAUSSIAN(x);\n        vec4 texCol = texture2D(tDiffuse, GET_UV(x));\n#ifdef HAS_ALPHA\n        texCol.rgb *= texCol.a;\n#endif\n        texColSum += texCol * gauss;\n        gaussSum += gauss;\n    }\n#ifdef HAS_ALPHA\n    texColSum.rgb /= (texColSum.a == 0.0 ? 0.0001 : texColSum.a);\n#endif\n#ifdef HORIZONTAL\n    gl_FragColor = texColSum/gaussSum;\n#else\n    gl_FragColor = texColSum/gaussSum * uColor;\n#endif\n}\n"},3911:e=>{e.exports="varying vec2 vUv;\nvoid main() {\n#if defined(HORIZONTAL) && defined(FLIP_UV)\n    vUv = vec2(uv.x, 1.0-uv.y);\n#else\n    vUv = vec2(uv.x, uv.y);\n#endif\n    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}\n"},24687:e=>{e.exports="uniform sampler2D tDiffuse;\nvarying vec2 vUv;\nvoid main() {\n    vec4 texel = texture2D( tDiffuse, vUv );\n    gl_FragColor = texel;\n}\n"},24009:e=>{e.exports="#define NUM_SAMPLES 29.0\n#define NUM_SPIRAL_TURNS 7.0\nuniform sampler2D tDepth;\nuniform vec3 worldSize;\nvarying vec2 vUv;\n#ifdef PRESET_2\n#define SAMPLE_RADIUS 0.3\n#define AO_GAMMA 1.0\n#define AO_INTENSITY 1.0\n#else\n#define SAMPLE_RADIUS 0.2\n#define AO_GAMMA 3.0\n#define AO_INTENSITY 0.8\n#endif\n#include <pack_depth>\n#define PI 3.14159265358979\nfloat rand(vec2 co) {\n    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\nfloat getRandomAngle(vec2 pos) {\n    return rand(pos) * (2.0 * PI);\n}\nvec2 tapLocation(float sampleNumber, float spinAngle, out float ssR){\n    float alpha = float(sampleNumber + 0.5) * (1.0 / NUM_SAMPLES);\n    float angle = alpha * (NUM_SPIRAL_TURNS * PI * 2.0) + spinAngle;\n    ssR = alpha;\n    return vec2(cos(angle), sin(angle));\n}\nvec2 sampleAO(vec2 unitDirection, float radius) {\n    vec2 sampleOffset = unitDirection * radius;\n    float idepth = unpackDepth(texture2D(tDepth, vUv + sampleOffset));\n    float depth = 1.0 - idepth;\n    if (depth < 1e-6) {\n        if (radius == 0.0)\n            return vec2(1.0, 1.0);\n        else\n            return vec2(0.0, 1.0);\n    }\n    vec3 dir = vec3(sampleOffset.x, depth, sampleOffset.y) * worldSize;\n    float distance2 = dot(dir,dir);\n    float idistance = 1.0 / sqrt(distance2);\n    vec3 ndir = dir * idistance;\n#ifdef PRESET_2\n    float importance = ndir.y * idistance;\n#else\n    float importance = ndir.y / distance2;\n#endif\n    vec2 ret;\n    ret.x = (idepth == 0.0) ? 0.0 : importance;\n    ret.y = importance;\n    return ret;\n}\nvoid main() {\n    vec2 sum = vec2(0.0);\n    float angle = getRandomAngle(vUv);\n    for (float i = 0.0; i<NUM_SAMPLES; i+= 1.0) {\n        float ssR;\n        vec2 uv = tapLocation(i, angle, ssR);\n        sum += sampleAO(uv, ssR * SAMPLE_RADIUS);\n    }\n    float ao = sum.x / sum.y;\n    gl_FragColor = packDepth(AO_INTENSITY * clamp(pow(ao, AO_GAMMA), 0.0, 0.9999));\n}\n"},8242:e=>{e.exports="uniform sampler2D tDepth;\nvarying vec2 vUv;\n#ifdef HORIZONTAL\n#define GET_UV(X) vec2(vUv.x + KERNEL_SCALE*(X), vUv.y)\n#else\n#define GET_UV(Y) vec2(vUv.x, vUv.y + KERNEL_SCALE*(Y))\n#endif\n#include <pack_depth>\n#define PI 3.14159265358979\n#define SIGMA ((2.0 * KERNEL_RADIUS+1.0) / 6.0)\n#define SIGMASQ2 (2.0 * SIGMA * SIGMA)\n#ifdef BOX\n#define KERNEL_VAL(X) 1.0\n#else\n#define KERNEL_VAL(X) ( (1.0 / sqrt(PI * SIGMASQ2)) * exp(-(X)*(X)/SIGMASQ2) )\n#endif\nvoid main() {\n    float depthVal = 0.0;\n    float sum = 0.0;\n    for (float x=-KERNEL_RADIUS; x<=KERNEL_RADIUS; x+=1.0) {\n        depthVal += unpackDepth(texture2D(tDepth, GET_UV(x))) * KERNEL_VAL(x);\n        sum += KERNEL_VAL(x);\n    }\n    gl_FragColor = packDepth(depthVal/sum);\n}\n"},14810:e=>{e.exports="uniform sampler2D tDepth;\nuniform vec4 uShadowColor;\nvarying vec2 vUv;\n#include <pack_depth>\nvoid main() {\n    float depthVal = unpackDepth(texture2D(tDepth, vUv));\n    gl_FragColor = vec4(uShadowColor.rgb, uShadowColor.a * depthVal);\n}\n"},57165:e=>{e.exports="#include <pack_depth>\n#if NUM_CUTPLANES > 0\nvarying vec3 vWorldPosition;\n#endif\n#include <cutplanes>\nvoid main() {\n#if NUM_CUTPLANES > 0\n    checkCutPlanes(vWorldPosition);\n#endif\n    float depth = gl_FragCoord.z / gl_FragCoord.w;\n    depth = 1.0 - depth;\n    gl_FragColor = packDepth(depth);\n}\n"},40520:e=>{e.exports="#if NUM_CUTPLANES > 0\nvarying vec3 vWorldPosition;\n#endif\nvoid main() {\n    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );;\n#if NUM_CUTPLANES > 0\n    vec4 worldPosition = modelMatrix * vec4( position, 1.0 );\n    vWorldPosition = worldPosition.xyz;\n#endif\n}\n"},13518:e=>{e.exports="#include <common>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <id_decl_frag>\n#include <theming_decl_frag>\n#define ENABLE_ID_DISCARD\nuniform float opacity;\nuniform vec4 selectionColor;\n#if NUM_CUTPLANES>0\nvarying highp vec3 vWorldPosition;\n#endif\n#ifdef VIEWPORT_CLIPPING\nuniform highp vec4 viewportBounds;\nvarying vec4 vPosition;\n#endif\n#include <cutplanes>\nvoid main(){\n    #if NUM_CUTPLANES>0\n        checkCutPlanes(vWorldPosition);\n    #endif\n    \n    #ifdef VIEWPORT_CLIPPING\n    \n    if (vPosition.x < viewportBounds.x || vPosition.x > viewportBounds.z || vPosition.y < viewportBounds.y || vPosition.y > viewportBounds.w) {\n        discard;\n    }\n    #endif\n    \n    float depth = 0.;\n    vec3 geomNormal = vec3(0.);\n    vec3 outgoingLight = vec3(0.);\n    vec4 diffuseColor = vec4(opacity);\n    \n    #include <map_fragment>\n    #include <alphamap_fragment>\n    #include <alphatest_fragment>\n    \n    outgoingLight = diffuseColor.rgb;\n    \n    #include <linear_to_gamma_fragment>\n    \n    gl_FragColor = vec4(outgoingLight, diffuseColor.a);\n    float writeId = 1.0;\n    #ifdef GHOSTED \n        writeId = 0.;\n        gl_FragColor.a *= 0.1;\n    #endif\n    \n    #include <theming_frag>\n    gl_FragColor.rgb = mix(gl_FragColor.rgb, selectionColor.rgb, selectionColor.a);\n    #include <final_frag>\n}\n"},34722:e=>{e.exports="#include <common>\n#include <map_pars_vertex>\n#if NUM_CUTPLANES>0\nvarying vec3 vWorldPosition;\n#endif\n#ifdef VIEWPORT_CLIPPING\nuniform mat4 modelLocalMatrix;\nvarying vec4 vPosition;\n#endif\nvoid main(){\n    vUv = uv * offsetRepeat.zw + offsetRepeat.xy;\n    \n    #if NUM_CUTPLANES>0\n        vWorldPosition = (modelMatrix * vec4(position,1.)).xyz;\n    #endif\n    \n    #ifdef VIEWPORT_CLIPPING\n        vPosition = modelLocalMatrix * vec4(position.xy,0.,1.);\n    #endif\n    \n    gl_Position = projectionMatrix * modelViewMatrix * vec4(position.xy,0.,1.);\n}\n"},18350:e=>{e.exports="\r\n\r\n#define LINE\r\n#include <line_decl_common>\r\n#include <id_decl_frag>\r\n\r\nuniform highp float pixelsPerUnit;\r\nuniform highp float aaRange;\r\n\r\nuniform float opacity;\r\nuniform highp float viewportId;\r\nuniform highp float swap;\r\nuniform highp float grayscale;\r\n\r\n#ifdef HAS_RASTER_QUADS\r\nuniform sampler2D tRaster;\r\n#endif\r\n\r\n#ifdef HAS_LINESTYLES\r\nuniform sampler2D tLineStyle;\r\nuniform vec2 vLineStyleTexSize;\r\n#endif\r\n\r\n#ifdef VIEWPORT_CLIPPING\r\nuniform highp vec4 viewportBounds;\r\nvarying highp vec2 vPosition;\r\n#endif\r\n\r\n#ifdef IMAGE_UV_TEXTURE\r\nvarying highp vec2 vuv;\r\nuniform sampler2D tRaster;\r\n#endif\r\n\r\n\r\nfloat curveGaussian(float r, float invWidth) {\r\n    float amt = clamp(r * invWidth, 0.0, 1.0);\r\n\r\n    float exponent = amt * 2.0;\r\n\r\n    return exp(-exponent*exponent);\r\n\r\n\r\n\r\n}\r\n\r\n#ifdef HAS_LINESTYLES\r\nfloat getLinePatternPixel(int i, int j) {\r\n\r\n    return texture2D(tLineStyle, (vec2(i, j) + 0.5) / vLineStyleTexSize).x * 255.0;\r\n}\r\n\r\nfloat getPatternLength(int whichPattern) {\r\n    float p1 = getLinePatternPixel(0, whichPattern);\r\n    float p2 = getLinePatternPixel(1, whichPattern);\r\n    return (p2 * 256.0 + p1);\r\n}\r\n#endif\r\n\r\n\r\nvoid fillLineSegment() {\r\n\r\n    float radius = abs(fsHalfWidth);\r\n    float parametricDistance = fsMultipurpose.x;\r\n    float segmentLength      = fsMultipurpose.y;\r\n    float totalDistance      = fsMultipurpose.z;\r\n\r\n#ifdef LOADING_ANIMATION\r\n    float distFromStart = parametricDistance / segmentLength;\r\n    if (loadingProgress < 1.0 && distFromStart > loadingProgress) {\r\n        discard;\r\n    }\r\n#endif\r\n\r\n\r\n#ifdef HAS_LINESTYLES\r\n    int whichPattern         = int(fsMultipurpose.w);\r\n\r\n    if (whichPattern > 0) {\r\n        const float TEX_TO_UNIT = 1.0 / 96.0;\r\n\r\n        float patternScale;\r\n\r\n\r\n\r\n        if (fsHalfWidth < 0.0) {\r\n            patternScale = LTSCALE;\r\n        } else {\r\n            patternScale = LTSCALE * TEX_TO_UNIT * pixelsPerUnit;\r\n        }\r\n\r\n        float patLen = patternScale * getPatternLength(whichPattern);\r\n        float phase = mod((totalDistance + parametricDistance) * pixelsPerUnit, patLen);\r\n\r\n        bool onPixel = true;\r\n        float radiusPixels = radius * pixelsPerUnit;\r\n\r\n        for (int i=2; i<MAX_LINESTYLE_LENGTH; i+=2) {\r\n\r\n            float on = getLinePatternPixel(i, whichPattern);\r\n            if (on == 1.0) on = 0.0;\r\n            on *= patternScale;\r\n\r\n            onPixel = true;\r\n            phase -= on;\r\n            if (phase < 0.0) {\r\n                break;\r\n            }\r\n            else if (phase <= radiusPixels) {\r\n                onPixel = false;\r\n                break;\r\n            }\r\n\r\n            float off = getLinePatternPixel(i+1, whichPattern);\r\n            if (off <= 1.0) off = 0.0;\r\n            off *= patternScale;\r\n\r\n            onPixel = false;\r\n            phase -= off;\r\n            if (phase < -radiusPixels)\r\n                discard;\r\n            if (phase <= 0.0)\r\n                break;\r\n        }\r\n\r\n\r\n\r\n\r\n        if (!onPixel && (abs(phase) <= radiusPixels)) {\r\n            segmentLength = 0.0;\r\n            parametricDistance = phase / pixelsPerUnit;\r\n        }\r\n    }\r\n#endif\r\n\r\n\r\n\r\n\r\n    float dist;\r\n    float offsetLength2 = dot(fsOffsetDirection, fsOffsetDirection);\r\n\r\n\r\n\r\n\r\n    float ltz = max(0.0, sign(-parametricDistance));\r\n    float gtsl = max(0.0, sign(parametricDistance - segmentLength));\r\n    float d = (ltz + gtsl) * (parametricDistance - gtsl * segmentLength);\r\n    dist = sqrt(max(0.0, offsetLength2 + d*d));\r\n\r\n\r\n\r\n\r\n    float range =  dist - radius;\r\n\r\n    if (range > aaRange) {\r\n        discard;\r\n    }\r\n\r\n\r\n\r\n\r\n\r\n\r\n    gl_FragColor = fsColor;\r\n    gl_FragColor.a *= curveGaussian(range+aaRange, pixelsPerUnit);\r\n}\r\n\r\n#ifdef HAS_CIRCLES\r\nvoid fillCircularArc() {\r\n\r\n    float dist   = length(fsOffsetDirection);\r\n    vec2 angles  = fsMultipurpose.xz;\r\n    float radius = abs(fsMultipurpose.y);\r\n    float range  =  abs(dist - radius);\r\n    range -= fsHalfWidth;\r\n\r\n\r\n\r\n    if (range > aaRange) {\r\n        discard;\r\n    }\r\n\r\n    vec2 direction = fsOffsetDirection;\r\n    float angle = atan(direction.y, direction.x);\r\n\r\n\r\n\r\n\r\n    if (angles.x > angles.y) {\r\n\r\n        if (angle > angles.x && angle < PI) {\r\n                angle -= TAU;\r\n        }\r\n        angles.x -= TAU;\r\n\r\n\r\n\r\n        if (angle < angles.x ) {\r\n            angle += TAU;\r\n        }\r\n    }\r\n    else if (angle < 0.0)\r\n        angle += TAU;\r\n\r\n#ifdef LOADING_ANIMATION\r\n    if ((angle - angles.x) / (angles.y - angles.x) > loadingProgress) {\r\n        discard;\r\n    }\r\n#endif\r\n\r\n\r\n    if (angle > angles.x && angle < angles.y) {\r\n        gl_FragColor = fsColor;\r\n        gl_FragColor.a *= curveGaussian(range+aaRange, pixelsPerUnit);\r\n    }\r\n    else {\r\n        discard;\r\n    }\r\n\r\n}\r\n#endif\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n#ifdef HAS_ELLIPTICALS\r\n\r\n\r\n\r\n\r\n\r\n\r\nfloat EllipticalApprox(\r\n        const int iters,\r\n        inout float t0, inout float t1,\r\n        const vec2 y,   out   vec2 x,\r\n        const vec2 e,   const vec2 ey, const vec2 esqr\r\n        ) {\r\n    vec2 r;\r\n    for (int i = 0; i < 10; ++i) {\r\n        if(i >= iters) break;\r\n\r\n        float t = mix(t0, t1, 0.5);\r\n        r = ey / (vec2(t) + esqr);\r\n\r\n        vec2 rsq = r * r;\r\n        float f = rsq.x + rsq.y - 1.0;\r\n\r\n        if(f > 0.0) { t0 = t; } else { t1 = t; }\r\n    }\r\n\r\n    x = e * r;\r\n    return distance(x, y);\r\n}\r\n\r\nfloat DistancePointEllipseSpecial (vec2 e, vec2 y, out vec2 x, float width, float aaRange) {\r\n    float dist;\r\n\r\n\r\n    vec2 esqr = e * e;\r\n    vec2 ey   = e * y;\r\n    float t0 = -esqr[1] + ey[1];\r\n    float t1 = -esqr[1] + length(ey);\r\n\r\n\r\n\r\n    dist = EllipticalApprox(6, t0, t1, y, x, e, ey, esqr);\r\n\r\n\r\n    if (dist > max(2.0 * (width + aaRange), e[0] * 0.05))\r\n        return dist;\r\n\r\n\r\n    dist = EllipticalApprox(6, t0, t1, y, x, e, ey, esqr);\r\n\r\n\r\n\r\n\r\n    float ecc = 1.0 +  0.1 * e[0] / e[1];\r\n\r\n    if (dist > max(ecc * (width + aaRange), e[0] * 0.001))\r\n        return dist;\r\n    if (dist < (width - aaRange) / ecc)\r\n        return dist;\r\n\r\n\r\n\r\n\r\n    dist = EllipticalApprox(10, t0, t1, y, x, e, ey, esqr);\r\n    return dist;\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\nfloat DistancePointEllipse(vec2 e, vec2 y, out vec2 locX, float width, float aaRange) {\r\n    vec2 locE, locY;\r\n\r\n\r\n\r\n\r\n    float diff = sign(e[0] - e[1]);\r\n    vec2 swizzle = vec2(max(diff, 0.0), -min(diff, 0.0));\r\n    locE.x = dot(e, swizzle.xy);\r\n    locE.y = dot(e, swizzle.yx);\r\n    locY.x = dot(y, swizzle.xy);\r\n    locY.y = dot(y, swizzle.yx);\r\n\r\n\r\n    vec2 refl = sign(locY);\r\n    locY *= refl;\r\n\r\n    vec2 x;\r\n    float distance = DistancePointEllipseSpecial(locE, locY, x, width, aaRange);\r\n\r\n    x *= refl;\r\n\r\n    locX.x = dot(x, swizzle.xy);\r\n    locX.y = dot(x, swizzle.yx);\r\n\r\n    return distance;\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\nvoid fillEllipticalArc() {\r\n    vec2 angles = fsMultipurpose.xz;\r\n    vec2 radii  = abs(fsMultipurpose.yw);\r\n    vec2 dir    = fsOffsetDirection;\r\n\r\n\r\n\r\n\r\n    vec2 pos;\r\n    float range = DistancePointEllipse(radii, dir, pos, fsHalfWidth, aaRange);\r\n    range -= fsHalfWidth;\r\n\r\n    if (range > aaRange)\r\n        discard;\r\n\r\n    float ar = radii[0] / radii[1];\r\n\r\n\r\n\r\n\r\n    float angle = atan(ar * pos.y, pos.x);\r\n\r\n\r\n\r\n\r\n    if (angles.x > angles.y) {\r\n\r\n        if (angle > angles.x && angle < PI) {\r\n            angle -= TAU;\r\n        }\r\n        angles.x -= TAU;\r\n\r\n\r\n\r\n        if (angle < angles.x ) {\r\n            angle += TAU;\r\n        }\r\n    }\r\n    else if (angle < 0.0)\r\n        angle += TAU;\r\n\r\n#ifdef LOADING_ANIMATION\r\n    if ((angle - angles.x) / (angles.y - angles.x) > loadingProgress) {\r\n        discard;\r\n    }\r\n#endif\r\n\r\n\r\n    if (angle > angles.x && angle < angles.y) {\r\n        gl_FragColor = fsColor;\r\n        gl_FragColor.a *= curveGaussian(range+aaRange, pixelsPerUnit);\r\n    }\r\n    else {\r\n        discard;\r\n    }\r\n}\r\n#endif\r\n\r\n#ifdef HAS_RASTER_QUADS\r\n    void fillTexQuad() {\r\n        gl_FragColor = texture2D(tRaster, fsMultipurpose.xy);\r\n        #ifdef LOADING_ANIMATION\r\n            gl_FragColor.a *= loadingProgress;\r\n        #endif\r\n    }\r\n#endif\r\n\r\nvoid fillTriangle() {\r\n#ifdef IMAGE_UV_TEXTURE\r\n    gl_FragColor = texture2D(tRaster, fract(vuv));\r\n#else\r\n    gl_FragColor = fsColor;\r\n#endif\r\n\r\n#ifdef LOADING_ANIMATION\r\n    gl_FragColor.a *= loadingProgress;\r\n#endif\r\n}\r\n\r\n#if NUM_CUTPLANES > 0\r\nvarying highp vec3 vWorldPosition;\r\n#endif\r\n\r\n#ifdef MSDF_TEXTURE_FONT\r\nvarying highp vec2 vuv;\r\nvarying float isMSDFQuards;\r\nuniform sampler2D tRaster;\r\nfloat median(float r, float g, float b) {\r\n  return max(min(r, g), min(max(r, g), b));\r\n}\r\n\r\n#endif\r\n\r\n#include <cutplanes>\r\n\r\nvoid main() {\r\n\r\n\r\n\r\n\r\n\r\n    if (fsColor == vec4(0.0)) {\r\n        discard;\r\n    }\r\n\r\n\r\n#ifdef VIEWPORT_CLIPPING\r\n    if(vPosition.x < viewportBounds.x || vPosition.x > viewportBounds.z || vPosition.y < viewportBounds.y || vPosition.y > viewportBounds.w) {\r\n        discard;\r\n    }\r\n#endif\r\n\r\n#ifdef MSDF_TEXTURE_FONT\r\n    vec4 msdfColor = texture2D(tRaster, vuv);\r\n    float dist = median(msdfColor.r, msdfColor.g, msdfColor.b);\r\n\r\n\r\n    float delta = mix(0.25, 0.5, 1.0 - fwidth(dist));\r\n\r\n    float sigDist = dist - delta;\r\n    float msdfAlpha = clamp(sigDist/fwidth(sigDist) + delta, 0.0, 1.0);\r\n\r\n    msdfAlpha = smoothstep(0., 1., msdfAlpha);\r\n    gl_FragColor.a =  mix(msdfAlpha, 1., 1.-isMSDFQuards);\r\n    if (gl_FragColor.a < 0.0001) discard;\r\n\r\n#endif\r\n\r\n\r\n    if (fsHalfWidth == 0.0) {\r\n#ifdef HAS_RASTER_QUADS\r\n        if (fsMultipurpose.z != 0.0)\r\n            fillTexQuad();\r\n        else\r\n#endif\r\n            fillTriangle();\r\n    }\r\n    else if (fsMultipurpose.y < 0.0) {\r\n#ifdef HAS_CIRCLES\r\n#ifdef HAS_ELLIPTICALS\r\n        if (abs(fsMultipurpose.y) == fsMultipurpose.w)\r\n#endif\r\n            fillCircularArc();\r\n#endif\r\n#ifdef HAS_ELLIPTICALS\r\n#ifdef HAS_CIRCLES\r\n        else\r\n#endif\r\n            fillEllipticalArc();\r\n#endif\r\n    }\r\n    else\r\n        fillLineSegment();\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n    float writeId = 1.0;\r\n    \r\n    gl_FragColor.a *= opacity;\r\n\r\n    if (gl_FragColor.a == 0.0) {\r\n        discard;\r\n    }\r\n\r\n\r\n\r\n\r\n    if (fsGhosting != 0.0 || \r\n            ((viewportId != 0.0) && (abs(fsVpTC.x * 255.0 + fsVpTC.y) >= 0.5 && abs(fsVpTC.x * 255.0 + fsVpTC.y - viewportId) >= 0.5))) {\r\n\r\n        writeId = 0.0;\r\n\r\n\r\n\r\n        gl_FragColor.a *= ((swap == 1.0) ? 0.21 : 0.1);\r\n    }\r\n\r\n#ifndef SELECTION_RENDERER\r\n\r\n    if (grayscale != 0.0) {\r\n        const vec3 rgb2grey = vec3(0.299, 0.587, 0.114);\r\n        float gray = dot(gl_FragColor.rgb, rgb2grey);\r\n        gl_FragColor.rgb = vec3(gray);\r\n    }\r\n#endif\r\n\r\n#if NUM_CUTPLANES > 0\r\n    checkCutPlanes(vWorldPosition);\r\n#endif\r\n\r\n#ifdef MRT_NORMALS\r\n\r\n    outNormal = vec4(0.0, 0.0, 0.0, 1.0);\r\n#endif\r\n\r\n#ifdef NO_ID_OUTPUT\r\n\r\n    writeId = 0.0;\r\n#endif\r\n\r\n#include <id_frag>\r\n}\r\n"},71519:e=>{e.exports="\r\n\r\n#include <line_decl_common>\r\n\r\nattribute vec2 fields1;\r\nattribute vec4 fields2;\r\nattribute vec4 flags4b;\r\nattribute vec4 layerVp4b;\r\n\r\n#ifdef HAS_ELLIPTICALS\r\nattribute vec3 extraParams;\r\n#endif\r\n\r\n#ifdef USE_INSTANCING\r\nattribute vec4 instFlags4b;\r\n#endif\r\n\r\n#ifdef MSDF_TEXTURE_FONT\r\nvarying highp vec2 vuv;\r\nvarying float isMSDFQuards;\r\n#endif\r\n\r\n#ifdef IMAGE_UV_TEXTURE\r\nvarying highp vec2 vuv;\r\n#endif\r\n\r\n#ifdef VIEWPORT_CLIPPING\r\nvarying vec2 vPosition;\r\n#endif\r\n\r\nuniform mat4 mvpMatrix;\r\n\r\nuniform float pixelsPerUnit;\r\nuniform float aaRange;\r\nuniform float viewportId;\r\nuniform float swap;\r\n\r\n\r\n\r\n\r\n\r\n#ifdef HAS_LAYERS\r\nuniform sampler2D tLayerMask;\r\n#endif\r\n\r\n#ifdef SELECTION_RENDERER\r\nuniform sampler2D tSelectionTexture;\r\nuniform vec2 vSelTexSize;\r\n#endif\r\n\r\n#ifdef SELECTION_RENDERER\r\nuniform vec4 selectionColor;\r\n#endif\r\n\r\n#ifdef LOADING_ANIMATION\r\nuniform float meshAnimTime;\r\n#endif\r\n\r\n#if NUM_CUTPLANES > 0\r\nvarying vec3 vWorldPosition;\r\n#endif\r\n\r\nvarying vec4 dbId;\r\n\r\n#ifdef UNPACK_POSITIONS\r\nuniform sampler2D tIdColor;\r\nuniform vec2 vIdColorTexSize;\r\nuniform vec4 unpackXform;\r\nattribute vec2 uvIdColor;\r\nfloat unpackLineWeight(float w) {\r\n    if (w > 0.5) {\r\n        return - (w - 0.5) * 1024.0;\r\n    } else {\r\n        return w * max(unpackXform.x, unpackXform.y) * 2.0;\r\n    }\r\n}\r\nvec4 getVertexColor() {\r\n    float u = (uvIdColor.x + 0.5) / vIdColorTexSize.x;\r\n    return texture2D(tIdColor, vec2(u, 0.5));\r\n}\r\nvec4 getDbId() {\r\n    float u = (uvIdColor.y + 0.5) / vIdColorTexSize.x;\r\n    vec4 normDbId = texture2D(tIdColor, vec2(u, 0.5));\r\n    return normDbId * 255.0;\r\n}\r\n#else\r\nattribute vec4 color4b;\r\nattribute vec4 dbId4b;\r\nvec4 unpackXform;\r\nfloat unpackLineWeight(float w) {\r\n    return w;\r\n}\r\nvec4 getVertexColor() {\r\n    return color4b;\r\n}\r\nvec4 getDbId() {\r\n    return dbId4b;\r\n}\r\n#endif\r\n\r\n\r\nvec2 centralVertex;\r\nvec2 offsetPosition;\r\n\r\nvec2 cos_sin(const float angle) { return vec2(cos(angle), sin(angle)); }\r\n\r\nvoid min_max(inout vec2 minPt, inout vec2 maxPt, const vec2 p) {\r\n    minPt = min(minPt, p);\r\n    maxPt = max(maxPt, p);\r\n}\r\n\r\n#if defined(USE_INSTANCING)\r\nfloat getVertexId() { return instFlags4b.x; }\r\n#else\r\nfloat getVertexId() { return flags4b.x; }\r\n#endif\r\n\r\nbool isStartVertex() { return (getVertexId() < VBB_SEG_END_RIGHT); }\r\nbool isLeftVertex()  { float id = getVertexId(); return ((id == VBB_SEG_END_LEFT || id == VBB_SEG_START_LEFT)); }\r\n\r\nstruct SegmentData { float angle, distAlong, distTotal, lineWidthHalf, lineType; };\r\nvoid decodeSegmentData(out SegmentData seg) {\r\n    seg.angle         = fields2.x * TAU - PI;\r\n    seg.distAlong     = fields2.y * max(unpackXform.x, unpackXform.y);\r\n    seg.distTotal     = fields2.w;\r\n    seg.lineWidthHalf = unpackLineWeight(fields2.z);\r\n    seg.lineType      = flags4b.z;\r\n}\r\n\r\nvoid strokeLineSegment() {\r\n    SegmentData seg; decodeSegmentData(seg);\r\n\r\n    float isStartCapVertex = isStartVertex() ? -1.0 :  1.0;\r\n    float isLeftSide       = isLeftVertex( ) ?  1.0 : -1.0;\r\n\r\n\r\n    float angleTransverse = seg.angle + isLeftSide * HALF_PI;\r\n    float lwAdjustment = fsHalfWidth + aaRange;\r\n    vec2 transverseOffset = cos_sin(angleTransverse) * lwAdjustment;\r\n    offsetPosition.xy += transverseOffset;\r\n\r\n\r\n\r\n\r\n    float distanceFromStart = max(isStartCapVertex, 0.0) * seg.distAlong;\r\n    vec2 along = distanceFromStart * cos_sin(seg.angle);\r\n    offsetPosition.xy += along;\r\n    centralVertex.xy  += along;\r\n\r\n\r\n    vec2 moveOffset = isStartCapVertex * isLeftSide * vec2(-transverseOffset.y, transverseOffset.x);\r\n    offsetPosition.xy -= moveOffset;\r\n    centralVertex.xy  -= moveOffset;\r\n\r\n\r\n\r\n\r\n    fsMultipurpose.x = (isStartCapVertex * lwAdjustment) + distanceFromStart;\r\n    fsMultipurpose.y = seg.distAlong;\r\n    fsMultipurpose.z = seg.distTotal;\r\n    fsMultipurpose.w = seg.lineType;\r\n\r\n    if (seg.lineWidthHalf < 0.0)\r\n        fsHalfWidth = -fsHalfWidth;\r\n}\r\n\r\n\r\n#ifdef HAS_TRIANGLE_GEOMS\r\nstruct TriangleData { vec2 p0, p1, p2; };\r\nvoid decodeTriangleData(out TriangleData tri) {\r\n\r\n    tri.p1 = vec2(fields2.x, fields2.y) * unpackXform.xy + unpackXform.zw;\r\n    tri.p2 = fields2.zw * unpackXform.xy + unpackXform.zw;\r\n}\r\n\r\nvoid strokeOneTriangle() {\r\n    TriangleData tri; decodeTriangleData(tri);\r\n\r\n\r\n\r\n\r\n\r\n\r\n    fsHalfWidth = 0.0;\r\n    fsMultipurpose.z = 0.0;\r\n\r\n\r\n\r\n\r\n\r\n    float vertexId = getVertexId();\r\n    if (vertexId == VBB_SEG_END_RIGHT)\r\n        offsetPosition.xy = tri.p1;\r\n    else if (vertexId == VBB_SEG_END_LEFT)\r\n        offsetPosition.xy = tri.p2;\r\n}\r\n#endif\r\n\r\n\r\n\r\n\r\n#ifdef HAS_RASTER_QUADS\r\nstruct TexQuadData { float angle; vec2 size; };\r\nvoid decodeTexQuadData(out TexQuadData quad) {\r\n    quad.angle     = fields2.x * TAU;\r\n    quad.size   = fields2.yz * max(unpackXform.x, unpackXform.y);\r\n}\r\n\r\nvoid strokeTexQuad() {\r\n    TexQuadData quad; decodeTexQuadData(quad);\r\n\r\n    vec2 corner = vec2(isLeftVertex() ? -1.0 : 1.0, isStartVertex() ? -1.0 : 1.0);\r\n\r\n    vec2 p      = 0.5 * corner * quad.size;\r\n    vec2 rot    = cos_sin(quad.angle);\r\n    vec2 offset = vec2(p.x * rot.x - p.y * rot.y, p.x * rot.y + p.y * rot.x);\r\n\r\n    offsetPosition.xy += offset;\r\n\r\n    fsMultipurpose.xy = max(vec2(0.0), corner);\r\n\r\n\r\n    fsMultipurpose.z = 1.0;\r\n    fsHalfWidth = 0.0;\r\n}\r\n#endif\r\n\r\n#if defined(HAS_CIRCLES) || defined(HAS_ELLIPTICALS)\r\nstruct ArcData { vec2 c; float start, end, major, minor, tilt; };\r\nvoid decodeArcData(out ArcData arc) {\r\n    arc.c     = fields1.xy * unpackXform.xy + unpackXform.zw;\r\n    arc.start = fields2.x * TAU;\r\n    arc.end   = fields2.y * TAU;\r\n    arc.major = fields2.w * max(unpackXform.x, unpackXform.y);\r\n#if defined(HAS_ELLIPTICALS)\r\n    arc.minor = extraParams.x;\r\n    arc.tilt  = extraParams.y * TAU;\r\n#endif\r\n}\r\n\r\nvoid strokeArc(const ArcData arc) {\r\n\r\n\r\n    float isStart = isStartVertex() ? -1.0 : 1.0;\r\n    float isLeft  = isLeftVertex()  ? -1.0 : 1.0;\r\n\r\n\r\n\r\n\r\n    vec2 minPt;\r\n    vec2 maxPt;\r\n\r\n    vec2 angles = vec2(arc.start, arc.end);\r\n    vec2 endsX = vec2(arc.c.x) + arc.major * cos(angles);\r\n    vec2 endsY = vec2(arc.c.y) + arc.minor * sin(angles);\r\n    minPt = maxPt = vec2(endsX.x, endsY.x);\r\n    min_max(minPt, maxPt, vec2(endsX.y, endsY.y));\r\n\r\n    if (arc.end > arc.start) {\r\n        if (arc.start < PI_0_5 && arc.end > PI_0_5) {\r\n            min_max(minPt, maxPt, vec2(arc.c.x, arc.c.y + arc.minor));\r\n        }\r\n        if (arc.start < PI && arc.end > PI) {\r\n            min_max(minPt, maxPt, vec2(arc.c.x - arc.major, arc.c.y));\r\n        }\r\n        if (arc.start < PI_1_5 && arc.end > PI_1_5) {\r\n            min_max(minPt, maxPt, vec2(arc.c.x, arc.c.y - arc.minor));\r\n        }\r\n    } else {\r\n\r\n        min_max(minPt, maxPt, vec2(arc.c.x + arc.major, arc.c.y));\r\n\r\n\r\n\r\n        if (arc.start < PI_0_5 || arc.end > PI_0_5) {\r\n            min_max(minPt, maxPt, vec2(arc.c.x, arc.c.y + arc.minor));\r\n        }\r\n        if (arc.start < PI || arc.end > PI) {\r\n            min_max(minPt, maxPt, vec2(arc.c.x - arc.major, arc.c.y));\r\n        }\r\n        if (arc.start < PI_1_5 || arc.end > PI_1_5) {\r\n            min_max(minPt, maxPt, vec2(arc.c.x, arc.c.y - arc.minor));\r\n        }\r\n    }\r\n\r\n    minPt -= fsHalfWidth + aaRange;\r\n    maxPt += fsHalfWidth + aaRange;\r\n\r\n    offsetPosition.x = (isStart < 0.0) ? minPt.x : maxPt.x;\r\n    offsetPosition.y = (isLeft < 0.0)  ? minPt.y : maxPt.y;\r\n\r\n\r\n\r\n\r\n\r\n    fsMultipurpose.x = arc.start;\r\n    fsMultipurpose.y = -arc.major;\r\n    fsMultipurpose.z = arc.end;\r\n    fsMultipurpose.w = arc.minor;\r\n}\r\n#endif\r\n\r\n#if defined(HAS_CIRCLES)\r\n\r\nvoid strokeCircularArc() {\r\n    ArcData arc; decodeArcData(arc);\r\n\r\n    float r = arc.major;\r\n    if (r * pixelsPerUnit < 0.125)\r\n        r = 0.25 * aaRange;\r\n    arc.major = arc.minor = r;\r\n\r\n    strokeArc(arc);\r\n}\r\n\r\n#endif\r\n\r\n#if defined(HAS_ELLIPTICALS)\r\nvoid strokeEllipticalArc() {\r\n    ArcData arc; decodeArcData(arc);\r\n    strokeArc(arc);\r\n}\r\n#endif\r\n\r\nstruct CommonAttribs { vec2 pos; vec4 color; vec2 layerTC, vpTC; float lineWidthHalf, geomType, ghosting; };\r\nvoid decodeCommonAttribs(out CommonAttribs attribs) {\r\n    attribs.pos           = fields1.xy * unpackXform.xy + unpackXform.zw;\r\n    attribs.color         = getVertexColor();\r\n    attribs.geomType      = flags4b.y;\r\n    attribs.layerTC       = layerVp4b.xy / 255.0;\r\n    attribs.vpTC          = layerVp4b.zw / 255.0;\r\n    attribs.lineWidthHalf = unpackLineWeight(fields2.z);\r\n    attribs.ghosting      = flags4b.w;\r\n}\r\n\r\nvoid strokeIndexedTriangle() {\r\n\r\n    fsHalfWidth = 0.0;\r\n    fsMultipurpose.z = 0.0;\r\n}\r\n\r\n#ifdef SELECTION_RENDERER\r\nbool isSelected(const CommonAttribs attribs) {\r\n\r\n\r\n    vec3 oid = getDbId().rgb;\r\n\r\n\r\n    float id01 = oid.r + oid.g * 256.0;\r\n    float t = (id01 + 0.5) * (1.0 / 4096.0);\r\n    float flrt = floor(t);\r\n    float texU = t - flrt;\r\n\r\n\r\n    float id23 = oid.b * (65536.0 / 4096.0) + flrt;\r\n    t = (id23 + 0.5) / vSelTexSize.y;\r\n    float texV = fract(t);\r\n\r\n    vec4 selBit = texture2D(tSelectionTexture, vec2(texU, texV));\r\n    return selBit.r == 1.0;\r\n}\r\n#endif\r\n\r\nbool isLayerOff(const CommonAttribs attribs) {\r\n#ifdef HAS_LAYERS\r\n    vec4 layerBit = texture2D(tLayerMask, attribs.layerTC);\r\n    return (layerBit.r == 0.0);\r\n#else\r\n    return false;\r\n#endif\r\n}\r\n\r\nvec4 getColor(const CommonAttribs attribs) {\r\n\r\n    if (isLayerOff(attribs)) { return vec4(0.0); }\r\n\r\n#ifdef SELECTION_RENDERER\r\n    if (isSelected(attribs)) { return selectionColor; }\r\n    return vec4(0.0);\r\n#else\r\n    return attribs.color;\r\n#endif\r\n}\r\n\r\n#ifdef GAMMA_INPUT\r\nvec4 inputToLinear(vec4 c) {\r\n    return vec4(vec3(c*c), c.a);\r\n}\r\n#endif\r\n\r\nvoid main() {\r\n#ifndef UNPACK_POSITIONS\r\n    unpackXform = vec4(1.0, 1.0, 0.0, 0.0);\r\n#endif\r\n\r\n    CommonAttribs attribs; decodeCommonAttribs(attribs);\r\n#ifdef MSDF_TEXTURE_FONT\r\n    vuv = fields2.xy;\r\n    isMSDFQuards = 1.0 - abs(sign(attribs.geomType - VBB_GT_MSDF_TRIANGLE_INDEXED));\r\n#endif\r\n\r\n#ifdef IMAGE_UV_TEXTURE\r\n    vuv = fields2.xy;\r\n#endif\r\n\r\n    fsColor = getColor(attribs);\r\n\r\n    #ifdef GAMMA_INPUT\r\n    fsColor = inputToLinear(fsColor);\r\n    #endif\r\n\r\n\r\n    if (swap != 0.0 ) {\r\n\r\n        if ( fsColor.r == 0.0 && fsColor.g == 0.0 && fsColor.b == 0.0 )\r\n            fsColor.rgb = vec3(1.0,1.0,1.0);\r\n\r\n        else if ( fsColor.r == 1.0 && fsColor.g == 1.0 && fsColor.b == 1.0 )\r\n            fsColor.rgb = vec3(0.0,0.0,0.0);\r\n    }\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n    centralVertex = offsetPosition = attribs.pos;\r\n\r\n    float lineWeight = attribs.lineWidthHalf;\r\n    if (lineWeight > 0.0) {\r\n\r\n\r\n        if(lineWeight < 0.5 / pixelsPerUnit) {\r\n            lineWeight = 0.5 / pixelsPerUnit;\r\n        }\r\n    }\r\n    else {\r\n\r\n\r\n        lineWeight = abs(lineWeight) / pixelsPerUnit;\r\n    }\r\n\r\n    fsHalfWidth = lineWeight;\r\n\r\n    dbId = getDbId() / 255.0;\r\n\r\n    fsVpTC     = attribs.vpTC;\r\n    fsGhosting = attribs.ghosting;\r\n\r\n    if      (attribs.geomType == VBB_GT_LINE_SEGMENT || attribs.geomType == VBB_GT_LINE_SEGMENT_CAPPED || attribs.geomType == VBB_GT_LINE_SEGMENT_CAPPED_START || attribs.geomType == VBB_GT_LINE_SEGMENT_CAPPED_END)     strokeLineSegment();\n#ifdef HAS_CIRCLES\r\n    else if (attribs.geomType == VBB_GT_ARC_CIRCULAR)     strokeCircularArc();\r\n#endif\r\n#ifdef HAS_ELLIPTICALS\r\n    else if (attribs.geomType == VBB_GT_ARC_ELLIPTICAL)   strokeEllipticalArc();\r\n#endif\r\n#ifdef HAS_RASTER_QUADS\r\n    else if (attribs.geomType == VBB_GT_TEX_QUAD)         strokeTexQuad();\r\n#endif\r\n#ifdef HAS_TRIANGLE_GEOMS\r\n    else if (attribs.geomType == VBB_GT_ONE_TRIANGLE)     strokeOneTriangle();\r\n#endif\r\n    else if (attribs.geomType == VBB_GT_TRIANGLE_INDEXED) strokeIndexedTriangle();\r\n\r\n\r\n\r\n    fsOffsetDirection = offsetPosition - centralVertex;\r\n\r\n\r\n    gl_Position = mvpMatrix * modelMatrix * vec4( offsetPosition.xy, 0.0, 1.0 );\r\n\r\n#ifdef LOADING_ANIMATION\r\n\r\n    if (dbId.rgb == vec3(1.0)) {\r\n        loadingProgress = 1.0;\r\n    } else {\r\n        loadingProgress = smoothstep(0.0, 1.0, meshAnimTime);\r\n    }\r\n#endif\r\n\r\n#ifdef IMAGE_UV_TEXTURE\r\n    fsHalfWidth = 0.0;\r\n#endif\r\n\r\n\r\n#if NUM_CUTPLANES > 0\r\n    vec4 worldPosition = modelMatrix * vec4( offsetPosition.xy, 0.0, 1.0 );\r\n    vWorldPosition = worldPosition.xyz;\r\n#endif\r\n\r\n#ifdef VIEWPORT_CLIPPING\r\n    vPosition = offsetPosition.xy;\r\n#endif\r\n}\r\n"},59191:e=>{e.exports="\n#define LINE_SS\n#include <line_decl_common>\n#include <id_decl_frag>\nuniform highp float aaRange;\nuniform float opacity;\nuniform highp float viewportId;\nuniform highp float swap;\nuniform highp float grayscale;\n#ifdef HAS_LINESTYLES\nuniform sampler2D tLineStyle;\nuniform vec2 vLineStyleTexSize;\nvarying highp float vPixelsPerUnit;\n#endif\n#ifdef VIEWPORT_CLIPPING\nuniform highp vec4 viewportBounds;\nvarying highp vec2 vPosition;\nuniform mat4 mvpMatrix;\nuniform mat4 modelMatrix;\n#endif\nfloat curveGaussian(float r, float width) {\n    float amt = clamp(abs(r / (width * 1.0)), 0.0, 1.0);\n    amt = max(amt - 0.0, 0.0);\n    float exponent = amt * 2.0;\n    return clamp(exp(-exponent*exponent), 0.0, 1.0);\n}\n#ifdef HAS_LINESTYLES\nfloat getLinePatternPixel(int i, int j) {\n    return texture2D(tLineStyle, (vec2(i, j) + 0.5) / vLineStyleTexSize).x * 255.0;\n}\nfloat getPatternLength(int whichPattern) {\n    float p1 = getLinePatternPixel(0, whichPattern);\n    float p2 = getLinePatternPixel(1, whichPattern);\n    return (p2 * 256.0 + p1);\n}\n#endif\nvoid fillLineSegment() {\n    float radius = abs(fsHalfWidth);\n    float parametricDistance = fsMultipurpose.x;\n    float segmentLength      = fsMultipurpose.y;\n    float totalDistance      = fsMultipurpose.z;\n#ifdef LOADING_ANIMATION\n    float distFromStart = parametricDistance / segmentLength;\n    if (loadingProgress < 1.0 && distFromStart > loadingProgress) {\n        discard;\n    }\n#endif\n#ifdef HAS_LINESTYLES\n    int whichPattern         = int(fsMultipurpose.w);\n    if (whichPattern > 0) {\n        const float TEX_TO_UNIT = 1.0 / 96.0;\n        float patternScale;\n        if (fsHalfWidth < 0.0) {\n            patternScale = LTSCALE;\n        } else {\n            patternScale = LTSCALE * TEX_TO_UNIT * vPixelsPerUnit;\n        }\n        float patLen = patternScale * getPatternLength(whichPattern);\n        float phase = mod((totalDistance + parametricDistance), patLen);\n        bool onPixel = true;\n        float radiusPixels = radius + aaRange;\n        for (int i=2; i<MAX_LINESTYLE_LENGTH; i+=2) {\n            float on = getLinePatternPixel(i, whichPattern);\n            if (on == 1.0) on = 0.0;\n            on *= patternScale;\n            onPixel = true;\n            phase -= on;\n            if (phase < 0.0) {\n                break;\n            }\n            else if (phase <= radiusPixels) {\n                onPixel = false;\n                break;\n            }\n            float off = getLinePatternPixel(i+1, whichPattern);\n            if (off <= 1.0) off = 0.0;\n            off *= patternScale;\n            onPixel = false;\n            phase -= off;\n            if (phase < -radiusPixels)\n                discard;\n            if (phase <= 0.0)\n                break;\n        }\n        if (!onPixel && (abs(phase) <= radiusPixels)) {\n            segmentLength = 0.0;\n            parametricDistance = phase;\n        }\n    }\n#endif\n    float dist;\n    float offsetLength2 = dot(fsOffsetDirection, fsOffsetDirection);\n    float ltz = max(0.0, sign(-parametricDistance));\n    float gtsl = max(0.0, sign(parametricDistance - segmentLength));\n    float d = (ltz + gtsl) * (parametricDistance - gtsl * segmentLength);\n    dist = sqrt(max(0.0, offsetLength2 + d*d));\n    float range =  dist - radius;\n    if (range > aaRange) {\n        discard;\n    }\n    gl_FragColor = fsColor;\n    if (range > -aaRange)\n        gl_FragColor.a *= curveGaussian(range+aaRange, aaRange * 2.0);\n}\n#ifdef LOADING_ANIMATION\n    void fillTriangle() { gl_FragColor = vec4(fsColor.rgb, fsColor.a * loadingProgress); }\n#else\n    void fillTriangle() { gl_FragColor = fsColor; }\n#endif\n#if NUM_CUTPLANES > 0\nvarying highp vec3 vWorldPosition;\n#endif\n#include <cutplanes>\nfloat getSide(vec2 a, vec2 b, vec2 c) {\n    return sign((b.x - a.x) * (c.y - a.y) - (b.y - a.y) * (c.x - a.x));\n}\nvoid main() {\n    if (fsColor == vec4(0.0)) {\n        discard;\n    }\n#ifdef VIEWPORT_CLIPPING\n    vec2 bottomLeft = (mvpMatrix * modelMatrix * vec4(viewportBounds.xy, 0., 1.)).xy;\n    vec2 bottomRight = (mvpMatrix * modelMatrix * vec4(viewportBounds.zy, 0., 1.)).xy;\n    vec2 topRight = (mvpMatrix * modelMatrix * vec4(viewportBounds.zw, 0., 1.)).xy;\n    vec2 topLeft = (mvpMatrix * modelMatrix * vec4(viewportBounds.xw, 0., 1.)).xy;\n    float side = getSide(topLeft, topRight, bottomLeft);\n    if (side * getSide(topRight, bottomRight, vPosition) < 0.0 ||\n        side * getSide(bottomRight, bottomLeft, vPosition) < 0.0 ||\n        side * getSide(bottomLeft, topLeft, vPosition) < 0.0 ||\n        side * getSide(topLeft, topRight, vPosition) < 0.0) {\n        discard;\n    }\n#endif\n    if (fsHalfWidth == 0.0) {\n        fillTriangle();\n    }\n    else\n        fillLineSegment();\n    float writeId = 1.0;\n    gl_FragColor.a *= opacity;\n    if (gl_FragColor.a == 0.0) {\n        discard;\n    }\n    if (fsGhosting != 0.0 || \n            ((viewportId != 0.0) && (abs(fsVpTC.x * 255.0 + fsVpTC.y) >= 0.5 && abs(fsVpTC.x * 255.0 + fsVpTC.y - viewportId) >= 0.5))) {\n        writeId = 0.0;\n        gl_FragColor.a *= ((swap == 1.0) ? 0.21 : 0.1);\n    }\n#ifndef SELECTION_RENDERER\n    if (grayscale != 0.0) {\n        const vec3 rgb2grey = vec3(0.299, 0.587, 0.114);\n        float gray = dot(gl_FragColor.rgb, rgb2grey);\n        gl_FragColor.rgb = vec3(gray);\n    }\n#endif\n#if NUM_CUTPLANES > 0\n    checkCutPlanes(vWorldPosition);\n#endif\n#ifdef MRT_NORMALS\n    outNormal = vec4(0.0, 0.0, 0.0, 1.0);\n#endif\n#ifdef NO_ID_OUTPUT\n    writeId = 0.0;\n#endif\n#include <id_frag>\n}\n"},84325:e=>{e.exports="\n#include <line_decl_common>\nattribute vec2 fields1;\nattribute vec4 fields2;\nattribute vec4 flags4b;\nattribute vec4 layerVp4b;\n#ifdef USE_INSTANCING\nattribute vec4 instFlags4b;\n#endif\n#ifdef VIEWPORT_CLIPPING\nvarying vec2 vPosition;\n#endif\nuniform mat4 mvpMatrix;\nuniform float pixelsPerUnit;\nuniform float aaRange;\nuniform vec2 size;\nuniform float viewportId;\nuniform float swap;\nuniform vec3 cameraPos;\nuniform float tanHalfFov;\n#ifdef HAS_LINESTYLES\nvarying float vPixelsPerUnit;\n#endif\n#ifdef HAS_LAYERS\nuniform sampler2D tLayerMask;\n#endif\n#ifdef SELECTION_RENDERER\nuniform sampler2D tSelectionTexture;\nuniform vec2 vSelTexSize;\n#endif\n#ifdef SELECTION_RENDERER\nuniform vec4 selectionColor;\n#endif\n#ifdef LOADING_ANIMATION\nuniform float meshAnimTime;\n#endif\n#if NUM_CUTPLANES > 0\nvarying vec3 vWorldPosition;\n#endif\nvarying vec4 dbId;\n#ifdef UNPACK_POSITIONS\nuniform sampler2D tIdColor;\nuniform vec2 vIdColorTexSize;\nuniform vec4 unpackXform;\nattribute vec2 uvIdColor;\nfloat unpackLineWeight(float w) {\n    if (w > 0.5) {\n        return - (w - 0.5) * 1024.0;\n    } else {\n        return w * max(unpackXform.x, unpackXform.y) * 2.0;\n    }\n}\nvec4 getVertexColor() {\n    float u = (uvIdColor.x + 0.5) / vIdColorTexSize.x;\n    return texture2D(tIdColor, vec2(u, 0.5));\n}\nvec4 getDbId() {\n    float u = (uvIdColor.y + 0.5) / vIdColorTexSize.x;\n    vec4 normDbId = texture2D(tIdColor, vec2(u, 0.5));\n    return normDbId * 255.0;\n}\n#else\nattribute vec4 color4b;\nattribute vec4 dbId4b;\nvec4 unpackXform;\nfloat unpackLineWeight(float w) {\n    return w;\n}\nvec4 getVertexColor() {\n    return color4b;\n}\nvec4 getDbId() {\n    return dbId4b;\n}\n#endif\nvec2 centralVertex;\nvec2 offsetPosition;\nvec2 offsetPosDepth;\nvec2 cos_sin(const float angle) { return vec2(cos(angle), sin(angle)); }\nvoid min_max(inout vec2 minPt, inout vec2 maxPt, const vec2 p) {\n    minPt = min(minPt, p);\n    maxPt = max(maxPt, p);\n}\n#if defined(USE_INSTANCING)\nfloat getVertexId() { return instFlags4b.x; }\n#else\nfloat getVertexId() { return flags4b.x; }\n#endif\nbool isStartVertex() { return (getVertexId() < VBB_SEG_END_RIGHT); }\nbool isLeftVertex()  { float id = getVertexId(); return ((id == VBB_SEG_END_LEFT || id == VBB_SEG_START_LEFT)); }\nstruct SegmentData { float angle, distAlong, distTotal, lineWidthHalf, lineType; };\nvoid decodeSegmentData(out SegmentData seg) {\n    seg.angle         = fields2.x * TAU - PI;\n    seg.distAlong     = fields2.y * max(unpackXform.x, unpackXform.y);\n    seg.distTotal     = fields2.w;\n    seg.lineWidthHalf = unpackLineWeight(fields2.z);\n    seg.lineType      = flags4b.z;\n}\nvoid strokeLineSegment(float geomType) {\n    SegmentData seg; decodeSegmentData(seg);\n    float isStartCapVertex = isStartVertex() ? -1.0 :  1.0;\n    float isLeftSide       = isLeftVertex( ) ?  1.0 : -1.0;\n    vec4 startPosition = (mvpMatrix * modelMatrix * vec4(centralVertex.xy, 0.0, 1.0));\n    float distanceAlong = seg.distAlong;\n    vec2 along = distanceAlong * cos_sin(seg.angle);\n    vec4 endPosition = (mvpMatrix * modelMatrix * vec4(centralVertex.xy + along, 0.0, 1.0));\n    vec2 screenStart = startPosition.xy * 0.5 * size / startPosition.w;\n    vec2 screenEnd = endPosition.xy * 0.5 * size / endPosition.w;\n    float roundedEnd = 0.0;\n    if (isStartCapVertex < 0.0) {\n        offsetPosition = centralVertex = screenStart;\n        offsetPosDepth = startPosition.zw;\n        roundedEnd = (geomType == VBB_GT_LINE_SEGMENT || geomType == VBB_GT_LINE_SEGMENT_CAPPED_END) ? 1.0 : 0.0;\n    } else {\n        offsetPosition = centralVertex = screenEnd;\n        offsetPosDepth = endPosition.zw;\n        roundedEnd = (geomType == VBB_GT_LINE_SEGMENT || geomType == VBB_GT_LINE_SEGMENT_CAPPED_START) ? 1.0 : 0.0;\n    }\n    vec2 screenDelta = screenEnd - screenStart;\n    float screenAngle = (distanceAlong == 0.0) ? 0.0 : atan(screenDelta.y, screenDelta.x);\n    float angleTransverse = screenAngle - isLeftSide * HALF_PI;\n    float lwAdjustment = fsHalfWidth + aaRange;\n    vec2 transverseOffset = cos_sin(angleTransverse) * lwAdjustment;\n    offsetPosition += transverseOffset;\n    float distanceFromStart = max(0.0, isStartCapVertex) * length(screenDelta);\n    if (roundedEnd > 0.0) {\n        vec2 moveOffset = isStartCapVertex * isLeftSide * vec2(-transverseOffset.y, transverseOffset.x);\n        offsetPosition += moveOffset;\n        centralVertex += moveOffset;\n        fsMultipurpose.x = (isStartCapVertex * lwAdjustment) + distanceFromStart;\n    }\n    else {\n        fsMultipurpose.x = distanceFromStart;\n    }\n    fsMultipurpose.y = length(screenDelta);\n    fsMultipurpose.z = seg.distTotal;\n    fsMultipurpose.w = seg.lineType;\n    if (seg.lineWidthHalf < 0.0)\n        fsHalfWidth = -fsHalfWidth;\n    fsOffsetDirection = offsetPosition - centralVertex;\n    gl_Position = vec4(2.0 * offsetPosition / size * offsetPosDepth.y, offsetPosDepth.xy);\n}\nstruct CommonAttribs { vec2 pos; vec4 color; vec2 layerTC, vpTC; float lineWidthHalf, geomType, ghosting; };\nvoid decodeCommonAttribs(out CommonAttribs attribs) {\n    attribs.pos           = fields1.xy * unpackXform.xy + unpackXform.zw;\n    attribs.color         = getVertexColor();\n    attribs.geomType      = flags4b.y;\n    attribs.layerTC       = layerVp4b.xy / 255.0;\n    attribs.vpTC          = layerVp4b.zw / 255.0;\n    attribs.lineWidthHalf = unpackLineWeight(fields2.z);\n    attribs.ghosting      = flags4b.w;\n}\nvoid strokeIndexedTriangle() {\n    fsHalfWidth = 0.0;\n    fsMultipurpose.z = 0.0;\n    gl_Position = (mvpMatrix * modelMatrix * vec4(centralVertex.xy, 0.0, 1.0));\n}\n#ifdef SELECTION_RENDERER\nbool isSelected(const CommonAttribs attribs) {\n    vec3 oid = getDbId().rgb;\n    float id01 = oid.r + oid.g * 256.0;\n    float t = (id01 + 0.5) * (1.0 / 4096.0);\n    float flrt = floor(t);\n    float texU = t - flrt;\n    float id23 = oid.b * (65536.0 / 4096.0) + flrt;\n    t = (id23 + 0.5) / vSelTexSize.y;\n    float texV = fract(t);\n    vec4 selBit = texture2D(tSelectionTexture, vec2(texU, texV));\n    return selBit.r == 1.0;\n}\n#endif\nbool isLayerOff(const CommonAttribs attribs) {\n#ifdef HAS_LAYERS\n    vec4 layerBit = texture2D(tLayerMask, attribs.layerTC);\n    return (layerBit.r == 0.0);\n#else\n    return false;\n#endif\n}\nvec4 getColor(const CommonAttribs attribs) {\n    if (isLayerOff(attribs)) { return vec4(0.0); }\n#ifdef SELECTION_RENDERER\n    if (isSelected(attribs)) { return selectionColor; }\n    return vec4(0.0);\n#else\n    return attribs.color;\n#endif\n}\n#ifdef GAMMA_INPUT\nvec4 inputToLinear(vec4 c) {\n    return vec4(vec3(c*c), c.a);\n}\n#endif\nvoid main() {\n#ifndef UNPACK_POSITIONS\n    unpackXform = vec4(1.0, 1.0, 0.0, 0.0);\n#endif\n    CommonAttribs attribs; decodeCommonAttribs(attribs);\n    fsColor = getColor(attribs);\n    #ifdef GAMMA_INPUT\n    fsColor = inputToLinear(fsColor);\n    #endif\n    if (swap != 0.0 ) {\n        if ( fsColor.r == 0.0 && fsColor.g == 0.0 && fsColor.b == 0.0 )\n            fsColor.rgb = vec3(1.0,1.0,1.0);\n        else if ( fsColor.r == 1.0 && fsColor.g == 1.0 && fsColor.b == 1.0 )\n            fsColor.rgb = vec3(0.0,0.0,0.0);\n    }\n    centralVertex = offsetPosition = attribs.pos;\n    float lineWeight = attribs.lineWidthHalf;\n    float ppu = pixelsPerUnit;\n    if (tanHalfFov > 0.0) {\n        vec4 worldPos = modelMatrix * vec4(offsetPosition.xy, 0.0, 1.0);\n        float distanceToCamera = length(cameraPos - worldPos.xyz);\n        ppu = size.y / (2.0 * distanceToCamera * tanHalfFov);\n    } \n#ifdef HAS_LINESTYLES\n    vPixelsPerUnit = ppu;\n#endif\n    if (lineWeight > 0.0) {\n        lineWeight = max(0.5, lineWeight * ppu);\n    }\n    else {\n        lineWeight = max(0.5, abs(lineWeight));\n    }\n    fsHalfWidth = lineWeight;\n    dbId = dbId4b / 255.0;\n    fsVpTC     = attribs.vpTC;\n    fsGhosting = attribs.ghosting;\n#ifdef LOADING_ANIMATION\n    if (dbId.rgb == vec3(1.0)) {\n        loadingProgress = 1.0;\n    } else {\n        loadingProgress = smoothstep(0.0, 1.0, meshAnimTime);\n    }\n#endif\n    if      (attribs.geomType == VBB_GT_LINE_SEGMENT || attribs.geomType == VBB_GT_LINE_SEGMENT_CAPPED || attribs.geomType == VBB_GT_LINE_SEGMENT_CAPPED_START || attribs.geomType == VBB_GT_LINE_SEGMENT_CAPPED_END)     strokeLineSegment(attribs.geomType);\n    else strokeIndexedTriangle();\n#if NUM_CUTPLANES > 0\n    vec4 worldPosition = modelMatrix * vec4( offsetPosition.xy, 0.0, 1.0 );\n    vWorldPosition = worldPosition.xyz;\n#endif\n#ifdef VIEWPORT_CLIPPING\n    vPosition = gl_Position.xy;\n#endif\n}\n"},74957:e=>{e.exports="varying highp vec3 vNormal;\nvarying highp float depth;\n#if NUM_CUTPLANES > 0\nvarying vec3 vWorldPosition;\n#endif\n#include <cutplanes>\nvoid main() {\n#if NUM_CUTPLANES > 0\n    checkCutPlanes(vWorldPosition);\n#endif\n    vec3 n = vNormal;\n    n = n * ( -1.0 + 2.0 * float( gl_FrontFacing ) );\n    n = normalize( n );\n    gl_FragColor = vec4(n.x, n.y, depth, 1.0);\n}\n"},5030:e=>{e.exports="varying vec3 vNormal;\nvarying float depth;\n#if NUM_CUTPLANES > 0\nvarying vec3 vWorldPosition;\n#endif\n#include <pack_normals>\n#include <instancing_decl_vert>\nvoid main() {\n#ifdef UNPACK_NORMALS\n    vec3 objectNormal = decodeNormal(normal);\n#else\n    vec3 objectNormal = normal;\n#endif\n#ifdef FLIP_SIDED\n    objectNormal = -objectNormal;\n#endif\n    objectNormal = getInstanceNormal(objectNormal);\n    vec3 instPos = getInstancePos(position);\n    vec3 transformedNormal = normalMatrix * objectNormal;\n    vNormal = normalize( transformedNormal );\n#if NUM_CUTPLANES > 0\n    vec4 worldPosition = modelMatrix * vec4( instPos, 1.0 );\n    vWorldPosition = worldPosition.xyz;\n#endif\n    vec4 mvPosition = modelViewMatrix * vec4( instPos, 1.0 );\n    depth = mvPosition.z;\n    vec4 p_Position = projectionMatrix * mvPosition;\n    gl_Position = p_Position;\n}\n"},83039:e=>{e.exports="uniform vec3 diffuse;\r\nuniform float opacity;\r\n\r\nuniform vec3 emissive;\r\nuniform vec3 specular;\r\nuniform float shininess;\r\n\r\n#include <env_sample>\r\n\r\n#ifdef USE_COLOR\r\nvarying vec3 vColor;\r\n#endif\r\n\r\n#ifdef GAMMA_INPUT\r\nvec3 InputToLinear(vec3 c) {\r\n    return c * c;\r\n}\r\nfloat InputToLinear(float c) {\r\n    return c * c;\r\n}\r\n#else\r\nvec3 InputToLinear(vec3 c) {\r\n    return c;\r\n}\r\nfloat InputToLinear(float c) {\r\n    return c;\r\n}\r\n#endif\r\n\r\n#if defined( USE_MAP ) || defined( USE_SPECULARMAP )\r\nvarying vec2 vUv;\r\n#endif\r\n\r\n#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\r\nvarying vec2 vUvBump;\r\n#endif\r\n\r\n#if defined( USE_ALPHAMAP )\r\nvarying vec2 vUvAlpha;\r\n#endif\r\n\r\n#ifdef USE_MAP\r\nuniform sampler2D map;\r\n#endif\r\n\r\n#if TONEMAP_OUTPUT > 0\r\nuniform float exposureBias;\r\n#include <tonemap>\r\n#endif\r\n\r\n#if defined(IRR_RGBM) || defined(ENV_RGBM) || defined(ENV_GAMMA) || defined(IRR_GAMMA)\r\nuniform float envMapExposure;\r\n#endif\r\n\r\n#ifdef USE_FOG\r\nuniform vec3 fogColor;\r\nuniform float fogNear;\r\nuniform float fogFar;\r\n#endif\r\n#include <id_decl_frag>\r\n#include <theming_decl_frag>\r\n#include <shadowmap_decl_frag>\r\n\r\n#ifdef USE_ENVMAP\r\n\r\nuniform float reflMipIndex;\r\n\r\nuniform float reflectivity;\r\nuniform samplerCube envMap;\r\n\r\n#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\r\n\r\nuniform float refractionRatio;\r\n\r\n#endif\r\n\r\nvec3 sampleReflection(vec3 dir, float mipIndex) {\r\n\r\n    vec3 adjDir = adjustLookupVector(dir);\r\n\r\n#ifdef ENV_GAMMA\r\n\r\n#ifdef HAVE_TEXTURE_LOD\r\n    vec4 envTexColor = textureCubeLodEXT( envMap, adjDir, mipIndex );\r\n#else\r\n\r\n\r\n    vec4 envTexColor = textureCube( envMap, adjDir, mipIndex );\r\n#endif\r\n\r\n    return GammaDecode(envTexColor, envMapExposure);\r\n\r\n#elif defined(ENV_RGBM)\r\n\r\n#ifdef HAVE_TEXTURE_LOD\r\n    vec4 envTexColor = textureCubeLodEXT( envMap, adjDir, mipIndex );\r\n#else\r\n\r\n\r\n    vec4 envTexColor = textureCube( envMap, adjDir, mipIndex );\r\n#endif\r\n\r\n    return RGBMDecode(envTexColor, envMapExposure);\r\n\r\n#else\r\n\r\n\r\n\r\n    vec4 envTexColor = textureCube( envMap, adjDir );\r\n    vec3 cubeColor = envTexColor.xyz;\r\n\r\n#ifdef GAMMA_INPUT\r\n    cubeColor *= cubeColor;\r\n#endif\r\n\r\n    return cubeColor;\r\n\r\n#endif\r\n\r\n}\r\n\r\n#endif\r\n\r\n\r\nuniform vec3 ambientLightColor;\r\n\r\n#if MAX_DIR_LIGHTS > 0\r\n\r\nuniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\r\nuniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\r\n\r\n#endif\r\n\r\n#if MAX_POINT_LIGHTS > 0\r\n\r\nuniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\r\n\r\nuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\r\nuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\r\n\r\n#endif\r\n\r\n#if MAX_SPOT_LIGHTS > 0\r\n\r\nuniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];\r\nuniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\r\nuniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];\r\nuniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];\r\nuniform float spotLightExponent[ MAX_SPOT_LIGHTS ];\r\n\r\nuniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\r\n\r\n#endif\r\n\r\n#ifdef USE_IRRADIANCEMAP\r\nuniform samplerCube irradianceMap;\r\n#endif\r\n\r\n#if MAX_SPOT_LIGHTS > 0 || NUM_CUTPLANES > 0\r\nvarying highp vec3 vWorldPosition;\r\n#endif\r\n\r\nvarying highp vec3 vViewPosition;\r\n#ifndef FLAT_SHADED\r\nvarying highp vec3 vNormal;\r\n#endif\r\n\r\n#ifdef USE_BUMPMAP\r\n\r\nuniform sampler2D bumpMap;\r\nuniform float bumpScale;\r\n\r\n\r\n\r\n\r\n\r\n\r\nvec2 dHdxy_fwd() {\r\n\r\n    vec2 dSTdx = dFdx( vUvBump );\r\n    vec2 dSTdy = dFdy( vUvBump );\r\n\r\n    float Hll = bumpScale * GET_BUMPMAP(vUvBump).x;\r\n    float dBx = bumpScale * GET_BUMPMAP(vUvBump + dSTdx).x - Hll;\r\n    float dBy = bumpScale * GET_BUMPMAP(vUvBump + dSTdy).x - Hll;\r\n\r\n    return vec2( dBx, dBy );\r\n\r\n}\r\n\r\nvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\r\n\r\n    vec3 vSigmaX = dFdx( surf_pos );\r\n    vec3 vSigmaY = dFdy( surf_pos );\r\n    vec3 vN = surf_norm;\r\n\r\n    vec3 R1 = cross( vSigmaY, vN );\r\n    vec3 R2 = cross( vN, vSigmaX );\r\n\r\n    float fDet = dot( vSigmaX, R1 );\r\n\r\n    vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\r\n    return normalize( abs( fDet ) * surf_norm - vGrad );\r\n\r\n}\r\n\r\n#endif\r\n\r\n\r\n#ifdef USE_NORMALMAP\r\n\r\nuniform sampler2D normalMap;\r\nuniform vec2 normalScale;\r\n\r\n\r\n\r\n\r\nvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\r\n\r\n    vec3 q0 = dFdx( eye_pos.xyz );\r\n    vec3 q1 = dFdy( eye_pos.xyz );\r\n    vec2 st0 = dFdx( vUvBump.st );\r\n    vec2 st1 = dFdy( vUvBump.st );\r\n\r\n    vec3 S = normalize(  q0 * st1.t - q1 * st0.t );\r\n    vec3 T = normalize( -q0 * st1.s + q1 * st0.s );\r\n    vec3 N = normalize( surf_norm );\r\n\r\n    vec3 mapN = GET_NORMALMAP(vUvBump).xyz * 2.0 - 1.0;\r\n    mapN.xy = normalScale * mapN.xy;\r\n    mat3 tsn = mat3( S, T, N );\r\n    return normalize( tsn * mapN );\r\n\r\n}\r\n\r\n#endif\r\n\r\n\r\n#ifdef USE_SPECULARMAP\r\nuniform sampler2D specularMap;\r\n#endif\r\n\r\n#ifdef USE_ALPHAMAP\r\nuniform sampler2D alphaMap;\r\n#endif\r\n\r\n#include <hatch_pattern>\r\n\r\nvec3 Schlick_v3(vec3 v, float cosHV) {\r\n    float facing = max(1.0 - cosHV, 0.0);\r\n    return v + (1.0 - v) * pow(facing, 5.0);\r\n}\r\n\r\nfloat Schlick_f(float v, float cosHV) {\r\n    float facing = max(1.0 - cosHV, 0.0);\r\n    return v + ( 1.0 - v ) * pow(facing, 5.0);\r\n}\r\n\r\n#include <cutplanes>\r\n\r\nvoid main() {\r\n\r\n#if NUM_CUTPLANES > 0\r\n    checkCutPlanes(vWorldPosition);\r\n#endif\r\n\r\n    gl_FragColor = vec4( vec3 ( 1.0 ), opacity );\r\n\r\n#ifdef USE_MAP\r\n    vec4 texelColor = GET_MAP(vUv);\r\n#ifdef MAP_INVERT\r\n    texelColor.xyz = 1.0-texelColor.xyz;\r\n#endif\r\n#ifdef GAMMA_INPUT\r\n    texelColor.xyz *= texelColor.xyz;\r\n#endif\r\n    gl_FragColor = gl_FragColor * texelColor;\r\n#endif\r\n\r\n#ifdef USE_ALPHAMAP\r\n    vec4 texelAlpha = GET_ALPHAMAP(vUvAlpha);\r\n    gl_FragColor.a *= texelAlpha.r;\r\n#endif\r\n\r\n#ifdef ALPHATEST\r\n    if ( gl_FragColor.a < ALPHATEST ) discard;\r\n#endif\r\n\r\n    float specularStrength;\r\n\r\n#ifdef USE_SPECULARMAP\r\n    vec4 texelSpecular = GET_SPECULARMAP(vUv);\r\n    specularStrength = texelSpecular.r;\r\n#else\r\n    specularStrength = 1.0;\r\n#endif\r\n\r\n#ifndef FLAT_SHADED\r\n    vec3 normal = normalize( vNormal );\r\n#ifdef DOUBLE_SIDED\r\n\r\n#endif\r\n#else\r\n    vec3 fdx = dFdx( vViewPosition );\r\n    vec3 fdy = dFdy( vViewPosition );\r\n    vec3 normal = normalize( cross( fdx, fdy ) );\r\n#endif\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n    vec3 viewDirection;\r\n    if (projectionMatrix[3][3] == 0.0) {\r\n        viewDirection = normalize( vViewPosition );\r\n    } else {\r\n        viewDirection = vec3(0.0, 0.0, 1.0);\r\n    }\r\n    normal = faceforward(normal, -viewDirection, normal);\r\n\r\n    vec3 geomNormal = normal;\r\n\r\n#ifdef USE_NORMALMAP\r\n    normal = perturbNormal2Arb( -vViewPosition, normal );\r\n#elif defined( USE_BUMPMAP )\r\n    normal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\r\n#endif\r\n\r\n    vec3 totalDiffuse = vec3( 0.0 );\r\n    vec3 totalSpecular = vec3( 0.0 );\r\n\r\n\r\n\r\n    float shininessB = shininess * 4.0;\r\n\r\n#if MAX_POINT_LIGHTS > 0\r\n\r\n    vec3 pointDiffuse  = vec3( 0.0 );\r\n    vec3 pointSpecular = vec3( 0.0 );\r\n\r\n    for ( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\r\n\r\n        vec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\r\n        vec3 lVector = lPosition.xyz + vViewPosition.xyz;\r\n\r\n        float lDistance = 1.0;\r\n        if ( pointLightDistance[ i ] > 0.0 )\r\n            lDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );\r\n\r\n        lVector = normalize( lVector );\r\n\r\n\r\n\r\n        float dotProduct = dot( normal, lVector );\r\n\r\n        float pointDiffuseWeight = max( dotProduct, 0.0 );\r\n\r\n\r\n        pointDiffuse  += InputToLinear(diffuse) * InputToLinear(pointLightColor[ i ]) * pointDiffuseWeight * lDistance;\r\n\r\n\r\n\r\n        vec3 pointHalfVector = normalize( lVector + viewDirection );\r\n        float pointDotNormalHalf = max( dot( normal, pointHalfVector ), 0.0 );\r\n\r\n        float pointSpecularWeight = specularStrength * max( pow( pointDotNormalHalf, shininessB ), 0.0 );\r\n        float specularNormalization = shininessB * 0.125 + 0.25;\r\n        vec3 schlick = Schlick_v3(InputToLinear(specular), dot( lVector, pointHalfVector ) );\r\n        pointSpecular += schlick * InputToLinear(pointLightColor[ i ]) * pointSpecularWeight * pointDiffuseWeight * lDistance * specularNormalization ;\r\n\r\n    }\r\n\r\n    totalDiffuse += pointDiffuse;\r\n    totalSpecular += pointSpecular;\r\n\r\n#endif\r\n\r\n#if MAX_SPOT_LIGHTS > 0\r\n\r\n    vec3 spotDiffuse  = vec3( 0.0 );\r\n    vec3 spotSpecular = vec3( 0.0 );\r\n\r\n    for ( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\r\n\r\n        vec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );\r\n        vec3 lVector = lPosition.xyz + vViewPosition.xyz;\r\n\r\n        float lDistance = 1.0;\r\n        if ( spotLightDistance[ i ] > 0.0 )\r\n            lDistance = 1.0 - min( ( length( lVector ) / spotLightDistance[ i ] ), 1.0 );\r\n\r\n        lVector = normalize( lVector );\r\n\r\n        float spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - vWorldPosition ) );\r\n\r\n        if ( spotEffect > spotLightAngleCos[ i ] ) {\r\n\r\n            spotEffect = max( pow( spotEffect, spotLightExponent[ i ] ), 0.0 );\r\n\r\n\r\n\r\n            float dotProduct = dot( normal, lVector );\r\n\r\n            float spotDiffuseWeight = max( dotProduct, 0.0 );\r\n\r\n            spotDiffuse += InputToLinear(diffuse) * InputToLinear(spotLightColor[ i ]) * spotDiffuseWeight * lDistance * spotEffect;\r\n\r\n\r\n\r\n            vec3 spotHalfVector = normalize( lVector + viewDirection );\r\n            float spotDotNormalHalf = max( dot( normal, spotHalfVector ), 0.0 );\r\n            float spotSpecularWeight = specularStrength * max( pow( spotDotNormalHalf, shininessB ), 0.0 );\r\n\r\n            float specularNormalization = shininessB * 0.125 + 0.25;\r\n            vec3 schlick = Schlick_v3(InputToLinear(specular), dot( lVector, spotHalfVector ) );\r\n            spotSpecular += schlick * InputToLinear(spotLightColor[ i ]) * spotSpecularWeight * spotDiffuseWeight * lDistance * specularNormalization * spotEffect;\r\n        }\r\n\r\n    }\r\n\r\n    totalDiffuse += spotDiffuse;\r\n    totalSpecular += spotSpecular;\r\n\r\n#endif\r\n\r\n#if MAX_DIR_LIGHTS > 0\r\n\r\n    vec3 dirDiffuse  = vec3( 0.0 );\r\n    vec3 dirSpecular = vec3( 0.0 );\r\n\r\n    for( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {\r\n\r\n        vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ i ], 0.0 );\r\n        vec3 dirVector = normalize( lDirection.xyz );\r\n\r\n\r\n\r\n        float dotProduct = dot( normal, dirVector );\r\n\r\n        float dirDiffuseWeight = max( dotProduct, 0.0 );\r\n\r\n        dirDiffuse  += InputToLinear(diffuse) * InputToLinear(directionalLightColor[ i ]) * dirDiffuseWeight;\r\n\r\n\r\n\r\n        vec3 dirHalfVector = normalize( dirVector + viewDirection );\r\n        float dirDotNormalHalf = max( dot( normal, dirHalfVector ), 0.0 );\r\n        float dirSpecularWeight = specularStrength * max( pow( dirDotNormalHalf, shininessB ), 0.0 );\r\n\r\n        float specularNormalization = shininessB * 0.125 + 0.25;\r\n        vec3 schlick = Schlick_v3(InputToLinear(specular), dot( dirVector, dirHalfVector ));\r\n\r\n        dirSpecular += schlick * InputToLinear(directionalLightColor[ i ]) * dirSpecularWeight * dirDiffuseWeight * specularNormalization;\r\n\r\n    }\r\n\r\n    totalDiffuse += dirDiffuse;\r\n    totalSpecular += dirSpecular;\r\n\r\n#endif\r\n\r\n\r\n\r\n#ifdef USE_IRRADIANCEMAP\r\n    vec3 worldNormal = mat3(viewMatrixInverse) * normal;\r\n    vec3 indirectDiffuse = sampleIrradianceMap(worldNormal, irradianceMap, envMapExposure);\r\n\r\n    indirectDiffuse = applyEnvShadow(indirectDiffuse, worldNormal);\r\n\r\n    totalDiffuse += InputToLinear(diffuse) * indirectDiffuse;\r\n#endif\r\n\r\n\r\n#ifdef METAL\r\n    gl_FragColor.xyz = gl_FragColor.xyz * ( InputToLinear(emissive) + totalDiffuse + ambientLightColor * InputToLinear(diffuse) + totalSpecular );\r\n#else\r\n    gl_FragColor.xyz = gl_FragColor.xyz * ( InputToLinear(emissive) + totalDiffuse + ambientLightColor * InputToLinear(diffuse) ) + totalSpecular;\r\n#endif\r\n\r\n\r\n\r\n#ifdef USE_COLOR\r\n    gl_FragColor = gl_FragColor * vec4( vColor, 1.0 );\r\n#endif\r\n\r\n\r\n#if defined(USE_ENVMAP)\r\n\r\n    vec3 reflectVec;\r\n\r\n#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\r\n\r\n#ifdef ENVMAP_MODE_REFLECTION\r\n    reflectVec = reflect( -viewDirection, normal );\r\n#else \r\n    reflectVec = refract( -viewDirection, normal, refractionRatio );\r\n#endif\r\n\r\n#else\r\n\r\n    reflectVec = reflect( -viewDirection, normal );\r\n\r\n#endif\r\n\r\n    reflectVec = mat3(viewMatrixInverse) * reflectVec;\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n    float reflectScale = 1.0;\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n    vec3 cubeColor = sampleReflection(reflectVec, reflMipIndex);\r\n\r\n    cubeColor *= reflectScale;\r\n\r\n    float facing = dot( viewDirection, normal );\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n    if (facing < -1e-2  || reflectivity == 0.0)\r\n        facing = 1.0;\r\n    else\r\n        facing = max(1e-6, facing);\r\n\r\n#ifdef USE_BUMPMAP\r\n\r\n\r\n\r\n    facing = min(1.0, facing + bumpScale * 7.0);\r\n\r\n#endif\r\n\r\n    vec3 schlickRefl;\r\n\r\n#ifdef METAL\r\n\r\n\r\n    schlickRefl = InputToLinear(specular);\r\n\r\n#else\r\n\r\n\r\n    schlickRefl = Schlick_v3(InputToLinear(specular), facing);\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n    gl_FragColor.a = mix(gl_FragColor.a, Schlick_f(gl_FragColor.a, facing), reflectivity);\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n    float invSchlick = pow(1.0 - facing * 0.5, 5.0);\r\n\r\n\r\n    float norm_factor = (28.0 / 23.0) * (1.0 - invSchlick) * (1.0 - invSchlick);\r\n\r\n    gl_FragColor.xyz *= norm_factor * (1.0 - InputToLinear(specular));\r\n\r\n#endif\r\n\r\n\r\n    gl_FragColor.xyz += cubeColor.xyz * specularStrength * schlickRefl.xyz;\r\n\r\n#ifdef CLEARCOAT\r\n\r\n    vec3 reflectVecClearcoat = reflect( -viewDirection, geomNormal );\r\n    reflectVecClearcoat = mat3(viewMatrixInverse) * reflectVecClearcoat;\r\n\r\n    vec3 cubeColorClearcoat = sampleReflection(reflectVecClearcoat, 0.0);\r\n\r\n\r\n    float schlickClearcoat = Schlick_f(InputToLinear(reflectivity), facing);\r\n\r\n\r\n\r\n    gl_FragColor.xyz = mix(gl_FragColor.xyz, cubeColorClearcoat * schlickClearcoat, 0.5);\r\n\r\n#endif\r\n\r\n\r\n\r\n\r\n#endif\r\n\r\n#if TONEMAP_OUTPUT == 1\r\n    gl_FragColor.xyz = toneMapCanonOGS_WithGamma_WithColorPerserving(exposureBias * gl_FragColor.xyz);\r\n#elif TONEMAP_OUTPUT == 2\r\n    gl_FragColor.xyz = toneMapCanonFilmic_WithGamma( exposureBias * gl_FragColor.xyz );\r\n#endif\r\n\r\n\r\n\r\n#ifdef USE_FOG\r\n    float depth = gl_FragCoord.z / gl_FragCoord.w;\r\n    float fogFactor = smoothstep( fogNear, fogFar, depth );\r\n    gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );\r\n#endif\r\n#include <theming_frag>\r\n#include <final_frag>\r\n\r\n}\r\n"},4352:e=>{e.exports="varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\nvarying vec3 vNormal;\n#endif\n#if defined( USE_MAP ) || defined( USE_SPECULARMAP )\nvarying vec2 vUv;\nuniform mat3 texMatrix;\n#endif\n#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\nvarying vec2 vUvBump;\nuniform mat3 texMatrixBump;\n#endif\n#if defined( USE_ALPHAMAP )\nvarying vec2 vUvAlpha;\nuniform mat3 texMatrixAlpha;\n#endif\n#if defined( USE_ENVMAP )\n#if ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP )\nuniform float refractionRatio;\n#endif\n#endif\n#if MAX_SPOT_LIGHTS > 0 || NUM_CUTPLANES > 0\nvarying vec3 vWorldPosition;\n#endif\n#ifdef USE_COLOR\nvarying vec3 vColor;\n#endif\n#ifdef MRT_NORMALS\nvarying float depth;\n#endif\n#include <pack_normals>\n#include <instancing_decl_vert>\n#include <id_decl_vert>\n#include <wide_lines_decl>\n#include <shadowmap_decl_vert>\nvoid main() {\n#if defined( USE_MAP ) || defined( USE_SPECULARMAP )\n    vUv = (texMatrix * vec3(uv, 1.0)).xy;\n#endif\n#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\n    vUvBump = (texMatrixBump * vec3(uv, 1.0)).xy;\n#endif\n#if defined( USE_ALPHAMAP )\n    vUvAlpha = (texMatrixAlpha * vec3(uv, 1.0)).xy;\n#endif\n#ifdef USE_COLOR\n#ifdef GAMMA_INPUT\n    vColor = color * color;\n#else\n    vColor = color;\n#endif\n#endif\n#ifdef UNPACK_NORMALS\n    vec3 objectNormal = decodeNormal(normal);\n#else\n    vec3 objectNormal = normal;\n#endif\n#ifdef FLIP_SIDED\n    objectNormal = -objectNormal;\n#endif\n    objectNormal = getInstanceNormal(objectNormal);\n    vec3 instPos = getInstancePos(position);\n    vec3 transformedNormal = normalMatrix * objectNormal;\n#ifndef FLAT_SHADED\n    vNormal = normalize( transformedNormal );\n#endif\n    vec4 mvPosition = modelViewMatrix * vec4( instPos, 1.0 );\n    gl_Position = projectionMatrix * mvPosition;\n#include <wide_lines_vert>\n    vViewPosition = -mvPosition.xyz;\n#if MAX_SPOT_LIGHTS > 0 || NUM_CUTPLANES > 0\n    vec4 worldPosition = modelMatrix * vec4( instPos, 1.0 );\n    vWorldPosition = worldPosition.xyz;\n#endif\n#ifdef MRT_NORMALS\n    depth = mvPosition.z;\n#endif\n#include <shadowmap_vert>\n#include <id_vert>\n}\n"},50410:e=>{e.exports="\n#define EDGE_SHARPNESS     (3.0)\n#define SCALE               (2)\n#define R                   (4)\n#define VALUE_TYPE        float\n#define VALUE_COMPONENTS   r\n#define VALUE_IS_KEY       0\n#define KEY_COMPONENTS     gb\n#if __VERSION__ >= 330\nconst float gaussian[R + 1] =\nfloat[](0.153170, 0.144893, 0.122649, 0.092902, 0.062970);\n#endif\nuniform sampler2D   tDiffuse;\nuniform vec2 size;\nuniform vec2 resolution;\nuniform vec2       axis;\nuniform float radius;\n#define  result         gl_FragColor.VALUE_COMPONENTS\n#define  keyPassThrough gl_FragColor.KEY_COMPONENTS\nfloat unpackKey(vec2 p) {\n    return p.x + p.y * (1.0 / 255.0);\n}\nvarying vec2 vUv;\nvoid main() {\n#   if __VERSION__ < 330\n    float gaussian[R + 1];\n#       if R == 3\n    gaussian[0] = 0.153170; gaussian[1] = 0.144893; gaussian[2] = 0.122649; gaussian[3] = 0.092902;\n#       elif R == 4\n    gaussian[0] = 0.153170; gaussian[1] = 0.144893; gaussian[2] = 0.122649; gaussian[3] = 0.092902; gaussian[4] = 0.062970;\n#       elif R == 6\n    gaussian[0] = 0.111220; gaussian[1] = 0.107798; gaussian[2] = 0.098151; gaussian[3] = 0.083953; gaussian[4] = 0.067458; gaussian[5] = 0.050920; gaussian[6] = 0.036108;\n#       endif\n#   endif\n    ivec2 axisi = ivec2(axis);\n    ivec2 ssC = ivec2(gl_FragCoord.xy);\n    vec4 temp = texture2D(tDiffuse, vUv);\n    gl_FragColor.gb = temp.KEY_COMPONENTS;\n    gl_FragColor.a = temp.a;\n    VALUE_TYPE sum = temp.VALUE_COMPONENTS;\n    if (temp.a == 0.0) {\n        result = sum;\n        return;\n    }\n    float key = unpackKey(keyPassThrough);\n    float BASE = gaussian[0];\n    float totalWeight = BASE;\n    sum *= totalWeight;\n    float scale = 1.5 / radius;\n    int r = -4; {\n        vec2 ssUV = vec2(ssC + axisi * (r * SCALE))*resolution;\n        temp = texture2D(tDiffuse, ssUV);\n        float      tapKey = unpackKey(temp.KEY_COMPONENTS);\n        VALUE_TYPE value  = temp.VALUE_COMPONENTS;\n        float weight = 0.3 + gaussian[4];\n        float dz = tapKey - key;\n        weight *= max(0.0, 1.0 - (EDGE_SHARPNESS * 2000.0) * abs(dz) * scale);\n        sum += value * weight;\n        totalWeight += weight;\n    }\n    r = -3; {\n        vec2 ssUV = vec2(ssC + axisi * (r * SCALE))*resolution;\n        temp = texture2D(tDiffuse, ssUV);\n        float      tapKey = unpackKey(temp.KEY_COMPONENTS);\n        VALUE_TYPE value  = temp.VALUE_COMPONENTS;\n        float weight = 0.3 + gaussian[3];\n        float dz = tapKey - key;\n        weight *= max(0.0, 1.0 - (EDGE_SHARPNESS * 2000.0) * abs(dz) * scale);\n        sum += value * weight;\n        totalWeight += weight;\n    }\n    r = -2; {\n        vec2 ssUV = vec2(ssC + axisi * (r * SCALE))*resolution;\n        temp = texture2D(tDiffuse, ssUV);\n        float      tapKey = unpackKey(temp.KEY_COMPONENTS);\n        VALUE_TYPE value  = temp.VALUE_COMPONENTS;\n        float weight = 0.3 + gaussian[2];\n        float dz = tapKey - key;\n        weight *= max(0.0, 1.0 - (EDGE_SHARPNESS * 2000.0) * abs(dz) * scale);\n        sum += value * weight;\n        totalWeight += weight;\n    }\n    r=-1; {\n        vec2 ssUV = vec2(ssC + axisi * (r * SCALE))*resolution;\n        temp = texture2D(tDiffuse, ssUV);\n        float      tapKey = unpackKey(temp.KEY_COMPONENTS);\n        VALUE_TYPE value  = temp.VALUE_COMPONENTS;\n        float weight = 0.3 + gaussian[1];\n        float dz = tapKey - key;\n        weight *= max(0.0, 1.0 - (EDGE_SHARPNESS * 2000.0) * abs(dz) * scale);\n        sum += value * weight;\n        totalWeight += weight;\n    }\n    r = 1; {\n        vec2 ssUV = vec2(ssC + axisi * (r * SCALE))*resolution;\n        temp = texture2D(tDiffuse, ssUV);\n        float      tapKey = unpackKey(temp.KEY_COMPONENTS);\n        VALUE_TYPE value  = temp.VALUE_COMPONENTS;\n        float weight = 0.3 + gaussian[1];\n        float dz = tapKey - key;\n        weight *= max(0.0, 1.0 - (EDGE_SHARPNESS * 2000.0) * abs(dz) * scale);\n        sum += value * weight;\n        totalWeight += weight;\n    }\n    r = 2; {\n        vec2 ssUV = vec2(ssC + axisi * (r * SCALE))*resolution;\n        temp = texture2D(tDiffuse, ssUV);\n        float      tapKey = unpackKey(temp.KEY_COMPONENTS);\n        VALUE_TYPE value  = temp.VALUE_COMPONENTS;\n        float weight = 0.3 + gaussian[2];\n        float dz = tapKey - key;\n        weight *= max(0.0, 1.0 - (EDGE_SHARPNESS * 2000.0) * abs(dz) * scale);\n        sum += value * weight;\n        totalWeight += weight;\n    }\n    r = 3; {\n        vec2 ssUV = vec2(ssC + axisi * (r * SCALE))*resolution;\n        temp = texture2D(tDiffuse, ssUV);\n        float      tapKey = unpackKey(temp.KEY_COMPONENTS);\n        VALUE_TYPE value  = temp.VALUE_COMPONENTS;\n        float weight = 0.3 + gaussian[3];\n        float dz = tapKey - key;\n        weight *= max(0.0, 1.0 - (EDGE_SHARPNESS * 2000.0) * abs(dz) * scale);\n        sum += value * weight;\n        totalWeight += weight;\n    }\n    r = 4; {\n        vec2 ssUV = vec2(ssC + axisi * (r * SCALE))*resolution;\n        temp = texture2D(tDiffuse, ssUV);\n        float      tapKey = unpackKey(temp.KEY_COMPONENTS);\n        VALUE_TYPE value  = temp.VALUE_COMPONENTS;\n        float weight = 0.3 + gaussian[4];\n        float dz = tapKey - key;\n        weight *= max(0.0, 1.0 - (EDGE_SHARPNESS * 2000.0) * abs(dz) * scale);\n        sum += value * weight;\n        totalWeight += weight;\n    }\n    const float epsilon = 0.0001;\n    result = sum / (totalWeight + epsilon);\n}\n"},6890:e=>{e.exports="\n#include <depth_texture>\n#define USE_MIPMAP 1\nuniform float cameraNear;\nuniform float cameraFar;\nuniform vec2 size;\nuniform vec2 resolution;\nuniform float lumInfluence;\nvarying vec2 vUv;\n#define NUM_SAMPLES (17)\n#define LOG_MAX_OFFSET (3)\n#define MAX_MIP_LEVEL (5)\n#define NUM_SPIRAL_TURNS (5)\n#define MIN_RADIUS (3.0)\n#define TAU 6.28318530718\nuniform float           projScale;\n#ifdef USE_MIPMAP\nuniform sampler2D tDepth_mip1;\nuniform sampler2D tDepth_mip2;\nuniform sampler2D tDepth_mip3;\nuniform sampler2D tDepth_mip4;\nuniform sampler2D tDepth_mip5;\n#endif\nuniform float radius;\nuniform float bias;\nuniform float intensity;\nvec2 tapLocation(int sampleNumber, float spinAngle, out float ssR){\n    float alpha = float(float(sampleNumber) + 0.5) * (1.0 / float(NUM_SAMPLES));\n    float angle = alpha * (float(NUM_SPIRAL_TURNS) * TAU) + spinAngle;\n    ssR = alpha;\n    return vec2(cos(angle), sin(angle));\n}\nfloat CSZToKey(float z) {\n    return clamp( (z+cameraNear) / (cameraNear-cameraFar), 0.0, 1.0);\n}\nvoid packKey(float key, out vec2 p) {\n    float temp = floor(key * 255.0);\n    p.x = temp * (1.0 / 255.0);\n    p.y = key * 255.0 - temp;\n}\n#include <pack_depth>\nfloat unpackDepthNearFar( const in vec4 rgba_depth ) {\n    float depth = unpackDepth( rgba_depth );\n    if (depth == 0.0)\n        return -cameraFar * 1.0e10;\n    return depth * (cameraNear - cameraFar) - cameraNear;\n}\nvec3 reconstructCSFaceNormal(vec3 C) {\n    return normalize(cross(dFdy(C), dFdx(C)));\n}\nvec3 reconstructNonUnitCSFaceNormal(vec3 C) {\n    return cross(dFdy(C), dFdx(C));\n}\nvec3 getPosition(ivec2 ssP, float depth) {\n    vec3 P;\n    P = reconstructCSPosition(vec2(ssP) + vec2(0.5), depth);\n    return P;\n}\nvec3 getOffsetPosition(ivec2 ssC, vec2 unitOffset, float ssR) {\n    ivec2 ssP = ivec2(ssR * unitOffset) + ssC;\n    vec3 P;\n#ifdef _LMVWEBGL2_\n#ifdef USE_MIPMAP\n    int mipLevel = clamp(int(floor(log2(ssR))) - LOG_MAX_OFFSET, 0, MAX_MIP_LEVEL);\n    if (mipLevel == 0) {\n        P.z = texelFetch(tDepth, ssP, 0).z;\n        if (P.z == 0.0) P.z = -cameraFar * 1.0e10;\n    }\n    else if (mipLevel == 1) {\n        ivec2 mipP = clamp(ssP >> mipLevel, ivec2(0), textureSize(tDepth_mip1, 0) - ivec2(1));\n        P.z = unpackDepthNearFar(texelFetch(tDepth_mip1, mipP, 0));\n    } else if (mipLevel == 2) {\n        ivec2 mipP = clamp(ssP >> mipLevel, ivec2(0), textureSize(tDepth_mip2, 0) - ivec2(1));\n        P.z = unpackDepthNearFar(texelFetch(tDepth_mip2, mipP, 0));\n    } else if (mipLevel == 3) {\n        ivec2 mipP = clamp(ssP >> mipLevel, ivec2(0), textureSize(tDepth_mip3, 0) - ivec2(1));\n        P.z = unpackDepthNearFar(texelFetch(tDepth_mip3, mipP, 0));\n    } else if (mipLevel == 4) {\n        ivec2 mipP = clamp(ssP >> mipLevel, ivec2(0), textureSize(tDepth_mip4, 0) - ivec2(1));\n        P.z = unpackDepthNearFar(texelFetch(tDepth_mip4, mipP, 0));\n    } else if (mipLevel == 5) {\n        ivec2 mipP = clamp(ssP >> mipLevel, ivec2(0), textureSize(tDepth_mip5, 0) - ivec2(1));\n        P.z = unpackDepthNearFar(texelFetch(tDepth_mip5, mipP, 0));\n    }\n#else\n    P.z = texelFetch(tDepth, ssP, 0).z;\n    if (P.z == 0.0) P.z = -cameraFar * 1.0e10;\n#endif\n#else\n    vec2 screenUV = (vec2(ssP) + vec2(0.5)) * resolution;\n#ifdef USE_MIPMAP\n    int mipLevel = int(max(0.0, min(floor(log2(ssR)) - float(LOG_MAX_OFFSET), float(MAX_MIP_LEVEL))));\n    if (mipLevel == 0) {\n        P.z = texture2D(tDepth, screenUV).z;\n        if (P.z == 0.0) P.z = -cameraFar * 1.0e10;\n    }\n    else if (mipLevel == 1)\n        P.z = unpackDepthNearFar(texture2D(tDepth_mip1, screenUV));\n    else if (mipLevel == 2)\n        P.z = unpackDepthNearFar(texture2D(tDepth_mip2, screenUV));\n    else if (mipLevel == 3)\n        P.z = unpackDepthNearFar(texture2D(tDepth_mip3, screenUV));\n    else if (mipLevel == 4)\n        P.z = unpackDepthNearFar(texture2D(tDepth_mip4, screenUV));\n    else if (mipLevel == 5)\n        P.z = unpackDepthNearFar(texture2D(tDepth_mip5, screenUV));\n#else\n    P.z = texture2D(tDepth, screenUV).z;\n    if (P.z == 0.0) P.z = -cameraFar * 1.0e10;\n#endif\n#endif\n    P = reconstructCSPosition(vec2(ssP) + vec2(0.5), P.z);\n    return P;\n}\nfloat sampleAO(in ivec2 ssC, in vec3 C, in vec3 n_C, in float ssDiskRadius, in int tapIndex, in float randomPatternRotationAngle) {\n    float ssR;\n    vec2 unitOffset = tapLocation(tapIndex, randomPatternRotationAngle, ssR);\n    ssR = max(0.75, ssR * ssDiskRadius);\n    vec3 Q = getOffsetPosition(ssC, unitOffset, ssR);\n    vec3 v = Q - C;\n    float vv = dot(v, v);\n    float vn = dot(v, n_C);\n    const float epsilon = 0.001;\n    float angAdjust = mix(1.0, max(0.0, 1.5 * n_C.z), 0.35);\n#define HIGH_QUALITY\n#ifdef HIGH_QUALITY\n    float f = max(1.0 - vv / (radius * radius), 0.0); return angAdjust * f * max((vn - bias) / sqrt(epsilon + vv), 0.0);\n#else\n    float f = max(radius * radius - vv, 0.0); return angAdjust * f * f * f * max((vn - bias) / (epsilon + vv), 0.0);\n#endif\n}\nconst bool useNoise = true;\nfloat getRandomAngle(vec2 pos) {\n    float dt= dot(pos ,vec2(12.9898,78.233));\n    return TAU * fract(sin(mod(dt,3.14)) * 43758.5453);\n}\nvoid main() {\n    ivec2 ssC = ivec2(gl_FragCoord.xy);\n    vec4 nrmz = texture2D(tDepth, vUv);\n    if (nrmz.z == 0.0) {\n        gl_FragColor.r = 1.0;\n        gl_FragColor.a = 0.0;\n        packKey(1.0, gl_FragColor.gb);\n        return;\n    }\n    vec3 C = getPosition(ssC, nrmz.z);\n    packKey(CSZToKey(C.z), gl_FragColor.gb);\n    float ssDiskRadius = -projScale * radius / mix(C.z, -1.0, isOrtho);\n    float A;\n    if (ssDiskRadius <= MIN_RADIUS) {\n        A = 1.0;\n    } else {\n        float sum = 0.0;\n        float randomPatternRotationAngle = getRandomAngle(vUv);\n        vec3 n_C = vec3(nrmz.x, nrmz.y, sqrt(1.0 - dot(nrmz.xy, nrmz.xy)));\n        sum += sampleAO(ssC, C, n_C, ssDiskRadius, 0, randomPatternRotationAngle);\n        sum += sampleAO(ssC, C, n_C, ssDiskRadius, 1, randomPatternRotationAngle);\n        sum += sampleAO(ssC, C, n_C, ssDiskRadius, 2, randomPatternRotationAngle);\n        sum += sampleAO(ssC, C, n_C, ssDiskRadius, 3, randomPatternRotationAngle);\n        sum += sampleAO(ssC, C, n_C, ssDiskRadius, 4, randomPatternRotationAngle);\n        sum += sampleAO(ssC, C, n_C, ssDiskRadius, 5, randomPatternRotationAngle);\n        sum += sampleAO(ssC, C, n_C, ssDiskRadius, 6, randomPatternRotationAngle);\n        sum += sampleAO(ssC, C, n_C, ssDiskRadius, 7, randomPatternRotationAngle);\n        sum += sampleAO(ssC, C, n_C, ssDiskRadius, 8, randomPatternRotationAngle);\n        sum += sampleAO(ssC, C, n_C, ssDiskRadius, 9, randomPatternRotationAngle);\n        sum += sampleAO(ssC, C, n_C, ssDiskRadius, 10, randomPatternRotationAngle);\n        sum += sampleAO(ssC, C, n_C, ssDiskRadius, 11, randomPatternRotationAngle);\n        sum += sampleAO(ssC, C, n_C, ssDiskRadius, 12, randomPatternRotationAngle);\n        sum += sampleAO(ssC, C, n_C, ssDiskRadius, 13, randomPatternRotationAngle);\n        sum += sampleAO(ssC, C, n_C, ssDiskRadius, 14, randomPatternRotationAngle);\n        sum += sampleAO(ssC, C, n_C, ssDiskRadius, 15, randomPatternRotationAngle);\n        sum += sampleAO(ssC, C, n_C, ssDiskRadius, 16, randomPatternRotationAngle);\n        float intensityDivR6 = intensity / pow(radius, 6.0);\n#ifdef HIGH_QUALITY\n        A = pow(max(0.0, 1.0 - sqrt(sum * (3.0 / float(NUM_SAMPLES)))), intensity);\n#else\n        A = max(0.0, 1.0 - sum * intensityDivR6 * (5.0 / float(NUM_SAMPLES)));\n        A = (pow(A, 0.2) + 1.2 * A*A*A*A) / 2.2;\n#endif\n        if (abs(dFdx(C.z)) < 0.02) {\n            A -= dFdx(A) * (mod(float(ssC.x), 2.0) - 0.5);\n        }\n        if (abs(dFdy(C.z)) < 0.02) {\n            A -= dFdy(A) * (mod(float(ssC.y), 2.0) - 0.5);\n        }\n        A = mix(1.0, A, clamp(ssDiskRadius - MIN_RADIUS,0.0,1.0));\n    }\n    gl_FragColor.r = A;\n    gl_FragColor.a = 1.0;\n}\n"},3819:e=>{e.exports="uniform sampler2D tDiffuse;\nuniform vec2 resolution;\nvoid main() {\n    vec2 ssP = vec2(gl_FragCoord.xy);\n    ssP = ssP * 2.0 + mod(ssP, 2.0);\n    ssP = (ssP + 0.5) * resolution * 0.5;\n    gl_FragColor = texture2D(tDiffuse, ssP);\n}\n"},92003:e=>{e.exports="uniform sampler2D tDiffuse;\nuniform vec2 resolution;\nuniform float cameraNear;\nuniform float cameraInvNearFar;\n#include <pack_depth>\nvoid main() {\n    vec2 ssP = vec2(gl_FragCoord.xy);\n    ssP = ssP * 2.0 + mod(ssP, 2.0);\n    ssP = (ssP + 0.5) * resolution * 0.5;\n    float depth = texture2D(tDiffuse, ssP).z;\n    if (depth != 0.0)\n        depth = (depth + cameraNear) * cameraInvNearFar;\n    gl_FragColor = packDepth(depth);\n}\n"},66209:e=>{e.exports="varying vec2 vUv;\nvoid main() {\n    vUv = uv;\n    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}\n"},11342:e=>{e.exports="\nvoid main() {\n    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}\n"},18214:e=>{e.exports="#include <shadowmap_decl_common>\nvarying float depth;\n#ifdef USE_SURFACE_CUTOUT_MAP\n#include <float3_average>\n#if defined( USE_SURFACE_CUTOUT_MAP )\n    uniform sampler2D surface_cutout_map;\n    uniform mat3 surface_cutout_map_texMatrix;\n    uniform bool surface_cutout_map_invert;\n#endif\nvarying vec2 vUv;\n#else\n#ifdef USE_MAP\nvarying vec2 vUv;\nuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\nvarying vec2 vUvAlpha;\nuniform sampler2D alphaMap;\n#endif\n#endif\nuniform float shadowMinOpacity;\nvoid applyCutoutMaps() {\n    float opacity = 1.0;\n#ifdef USE_SURFACE_CUTOUT_MAP\n    #if defined( USE_SURFACE_CUTOUT_MAP )\n        vec2 uv_surface_cutout_map = (surface_cutout_map_texMatrix * vec3(uv, 1.0)).xy;\n        SURFACE_CUTOUT_CLAMP_TEST;\n        vec3 opacity_v3 = texture2D(surface_cutout_map, uv_surface_cutout_map).xyz;\n        if(surface_cutout_map_invert) opacity_v3 = vec3(1.0) - opacity_v3;\n        opacity = average(opacity_v3);\n    #else\n        opacity = surface_cutout;\n    #endif\n#else\n#ifdef USE_MAP\n    opacity *= GET_MAP(vUv).a;\n#endif\n#ifdef USE_ALPHAMAP\n    opacity *= GET_ALPHAMAP(vUvAlpha).r;\n#endif\n#endif\n#if defined(USE_SURFACE_CUTOUT_MAP) || defined(USE_MAP) || defined(USE_ALPHAMAP)\n    if (opacity < shadowMinOpacity) discard;\n#endif\n}\nvoid main() {\n    float normalizedLinearDepth = (depth - shadowMapRangeMin) / shadowMapRangeSize;\n    float val = exp(shadowESMConstant * normalizedLinearDepth);\n#ifdef USE_HARD_SHADOWS\n    val = normalizedLinearDepth;\n#endif\n    applyCutoutMaps();\n    gl_FragColor = vec4(val, 0, 0, 1);\n}\n"},83159:e=>{e.exports="#include <shadowmap_decl_frag>\nvoid main() {\n    float shadowIntensity = 0.5 * (1.0 - getShadowValue());\n    gl_FragColor = vec4(0.0, 0.0, 0.0, shadowIntensity);\n}\n"},2680:e=>{e.exports="#include <shadowmap_decl_vert>\nvoid main() {\n    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n#include <shadowmap_vert>\n}\n"},47065:e=>{e.exports="#include <shadowmap_decl_common>\nvarying float depth;\n#ifdef USE_SURFACE_CUTOUT_MAP\nvarying vec2 vUv;\n#else\n#ifdef USE_MAP\nvarying vec2 vUv;\nuniform mat3 texMatrix;\n#endif\n#ifdef USE_ALPHAMAP\nvarying vec2 vUvAlpha;\nuniform mat3 texMatrixAlpha;\n#endif\n#endif\nvoid passCutoutUVCoords() {\n#ifdef USE_SURFACE_CUTOUT_MAP\n    vUv = uv;\n#else\n#ifdef USE_MAP\n    vUv = (texMatrix * vec3(uv, 1.0)).xy;\n#endif\n#ifdef USE_ALPHAMAP\n    vUvAlpha = (texMatrixAlpha * vec3(uv, 1.0)).xy;\n#endif\n#endif\n}\nvoid main() {\n    vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n    vec4 p_Position = projectionMatrix * mvPosition;\n    gl_Position = p_Position;\n    depth = -mvPosition.z;\n    passCutoutUVCoords();\n}\n"},70125:e=>{e.exports="#include <id_decl_frag>\nuniform sampler2D sheetMap;\nuniform sampler2D idMap;\nuniform vec2 resolution;\nuniform vec3 modelIDv2;\nuniform float alphaTest;\nvoid main() {\n    vec2 uv = vec2(gl_FragCoord.x * resolution.x, gl_FragCoord.y * resolution.y);\n    vec4 c = texture2D(sheetMap, uv);\n    if (c.a <= alphaTest)\n        discard;\n    \n    gl_FragColor = c;\n    vec4 dbId = texture2D(idMap, uv);\n#ifdef MRT_NORMALS\n    outNormal = vec4(0.0, 0.0, 0.0, 1.0);\n#endif\n#ifdef MRT_ID_BUFFER\n    outId = vec4(dbId.rgb, 1.0);\n    #ifdef MODEL_COLOR\n    outModelId = vec4(modelIDv2.rgb, 1.0);\n    #endif\n#elif defined(ID_COLOR)\n    gl_FragColor = vec4(dbId.rgb, 1.0);\n#elif defined(MODEL_COLOR)\n    gl_FragColor = vec4(modelIDv2.rgb, 1.0);\n#endif\n}\n"},70057:e=>{e.exports="void main() {\n    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}"},52072:e=>{e.exports=function(){"use strict";var e=function(){for(var e=3,t=document.createElement("b"),r=t.all||[];t.innerHTML="\x3c!--[if gt IE "+ ++e+"]><i><![endif]--\x3e",r[0];);return e>4?e:document.documentMode}(),t=navigator.platform.toLowerCase().indexOf("mac")+1,r=function(e){if(!(this instanceof r))return new r(e);var a=this,s={rows_in_block:50,blocks_in_cluster:4,tag:null,show_no_data_row:!0,no_data_class:"clusterize-no-data",no_data_text:"No data",keep_parity:!0,callbacks:{}};a.options={};for(var l,u=["rows_in_block","blocks_in_cluster","show_no_data_row","no_data_class","no_data_text","keep_parity","tag","callbacks"],c=0;l=u[c];c++)a.options[l]=void 0!==e[l]&&null!=e[l]?e[l]:s[l];var h,d=["scroll","content"];for(c=0;h=d[c];c++)if(a[h+"_elem"]=e[h+"Id"]?document.getElementById(e[h+"Id"]):e[h+"Elem"],!a[h+"_elem"])throw new Error("Error! Could not find "+h+" element");a.content_elem.hasAttribute("tabindex")||a.content_elem.setAttribute("tabindex",0);var f=o(e.rows)?e.rows:a.fetchMarkup(),p={},m=a.scroll_elem.scrollTop;a.insertToDOM(f,p),a.scroll_elem.scrollTop=m;var g=!1,v=0,y=!1,b=function(){t&&(y||(a.content_elem.style.pointerEvents="none"),y=!0,clearTimeout(v),v=setTimeout((function(){a.content_elem.style.pointerEvents="auto",y=!1}),50)),g!=(g=a.getClusterNum())&&a.insertToDOM(f,p),a.options.callbacks.scrollingProgress&&a.options.callbacks.scrollingProgress(a.getScrollProgress())},x=0,_=function(){clearTimeout(x),x=setTimeout(a.refresh,100)};n("scroll",a.scroll_elem,b),n("resize",window,_),a.destroy=function(e){i("scroll",a.scroll_elem,b),i("resize",window,_),a.html((e?a.generateEmptyRow():f).join(""))},a.refresh=function(e){(a.getRowsHeight(f)||e)&&a.update(f)},a.update=function(e){f=o(e)?e:[];var t=a.scroll_elem.scrollTop;f.length*a.options.item_height<t&&(a.scroll_elem.scrollTop=0,g=0),a.insertToDOM(f,p),a.scroll_elem.scrollTop=t},a.clear=function(){a.update([])},a.getRowsAmount=function(){return f.length},a.getScrollProgress=function(){return this.options.scroll_top/(f.length*this.options.item_height)*100||0};var E=function(e,t){var r=o(t)?t:[];r.length&&(f="append"==e?f.concat(r):r.concat(f),a.insertToDOM(f,p))};a.append=function(e){E("append",e)},a.prepend=function(e){E("prepend",e)}};function n(e,t,r){return t.addEventListener?t.addEventListener(e,r,!1):t.attachEvent("on"+e,r)}function i(e,t,r){return t.removeEventListener?t.removeEventListener(e,r,!1):t.detachEvent("on"+e,r)}function o(e){return"[object Array]"===Object.prototype.toString.call(e)}function a(e,t){return window.getComputedStyle?window.getComputedStyle(t)[e]:t.currentStyle[e]}return r.prototype={constructor:r,fetchMarkup:function(){for(var e=[],t=this.getChildNodes(this.content_elem);t.length;)e.push(t.shift().outerHTML);return e},exploreEnvironment:function(t,r){var n=this.options;n.content_tag=this.content_elem.tagName.toLowerCase(),t.length&&(e&&e<=9&&!n.tag&&(n.tag=t[0].match(/<([^>\s/]*)/)[1].toLowerCase()),this.content_elem.children.length<=1&&(r.data=this.html(t[0]+t[0]+t[0])),n.tag||(n.tag=this.content_elem.children[0].tagName.toLowerCase()),this.getRowsHeight(t))},getRowsHeight:function(e){var t=this.options,r=t.item_height;if(t.cluster_height=0,e.length){var n=this.content_elem.children;if(n.length){var i=n[Math.floor(n.length/2)];if(t.item_height=i.offsetHeight,"tr"==t.tag&&"collapse"!=a("borderCollapse",this.content_elem)&&(t.item_height+=parseInt(a("borderSpacing",this.content_elem),10)||0),"tr"!=t.tag){var o=parseInt(a("marginTop",i),10)||0,s=parseInt(a("marginBottom",i),10)||0;t.item_height+=Math.max(o,s)}return t.block_height=t.item_height*t.rows_in_block,t.rows_in_cluster=t.blocks_in_cluster*t.rows_in_block,t.cluster_height=t.blocks_in_cluster*t.block_height,r!=t.item_height}}},getClusterNum:function(){return this.options.scroll_top=this.scroll_elem.scrollTop,Math.floor(this.options.scroll_top/(this.options.cluster_height-this.options.block_height))||0},generateEmptyRow:function(){var e=this.options;if(!e.tag||!e.show_no_data_row)return[];var t,r=document.createElement(e.tag),n=document.createTextNode(e.no_data_text);return r.className=e.no_data_class,"tr"==e.tag&&((t=document.createElement("td")).colSpan=100,t.appendChild(n)),r.appendChild(t||n),[r.outerHTML]},generate:function(e,t){var r=this.options,n=e.length;if(n<r.rows_in_block)return{top_offset:0,bottom_offset:0,rows_above:0,rows:n?e:this.generateEmptyRow()};var i=Math.max((r.rows_in_cluster-r.rows_in_block)*t,0),o=i+r.rows_in_cluster,a=Math.max(i*r.item_height,0),s=Math.max((n-o)*r.item_height,0),l=[],u=i;a<1&&u++;for(var c=i;c<o;c++)e[c]&&l.push(e[c]);return{top_offset:a,bottom_offset:s,rows_above:u,rows:l}},renderExtraTag:function(e,t){var r=document.createElement(this.options.tag),n="clusterize-";return r.className=[n+"extra-row",n+e].join(" "),t&&(r.style.height=t+"px"),r.outerHTML},insertToDOM:function(e,t){this.options.cluster_height||this.exploreEnvironment(e,t);var r=this.generate(e,this.getClusterNum()),n=r.rows.join(""),i=this.checkChanges("data",n,t),o=this.checkChanges("top",r.top_offset,t),a=this.checkChanges("bottom",r.bottom_offset,t),s=this.options.callbacks,l=[];i||o?(r.top_offset&&(this.options.keep_parity&&l.push(this.renderExtraTag("keep-parity")),l.push(this.renderExtraTag("top-space",r.top_offset))),l.push(n),r.bottom_offset&&l.push(this.renderExtraTag("bottom-space",r.bottom_offset)),s.clusterWillChange&&s.clusterWillChange(),this.html(l.join("")),"ol"==this.options.content_tag&&this.content_elem.setAttribute("start",r.rows_above),this.content_elem.style["counter-increment"]="clusterize-counter "+(r.rows_above-1),s.clusterChanged&&s.clusterChanged()):a&&(this.content_elem.lastChild.style.height=r.bottom_offset+"px")},html:function(t){var r=this.content_elem;if(e&&e<=9&&"tr"==this.options.tag){var n,i=document.createElement("div");for(i.innerHTML="<table><tbody>"+t+"</tbody></table>";n=r.lastChild;)r.removeChild(n);for(var o=this.getChildNodes(i.firstChild.firstChild);o.length;)r.appendChild(o.shift())}else r.innerHTML=t},getChildNodes:function(e){for(var t=e.children,r=[],n=0,i=t.length;n<i;n++)r.push(t[n]);return r},checkChanges:function(e,t,r){var n=t!=r[e];return r[e]=t,n}},r}()},19662:(e,t,r)=>{var n=r(17854),i=r(60614),o=r(66330),a=n.TypeError;e.exports=function(e){if(i(e))return e;throw a(o(e)+" is not a function")}},39483:(e,t,r)=>{var n=r(17854),i=r(4411),o=r(66330),a=n.TypeError;e.exports=function(e){if(i(e))return e;throw a(o(e)+" is not a constructor")}},96077:(e,t,r)=>{var n=r(17854),i=r(60614),o=n.String,a=n.TypeError;e.exports=function(e){if("object"==typeof e||i(e))return e;throw a("Can't set "+o(e)+" as a prototype")}},51223:(e,t,r)=>{var n=r(5112),i=r(70030),o=r(3070),a=n("unscopables"),s=Array.prototype;null==s[a]&&o.f(s,a,{configurable:!0,value:i(null)}),e.exports=function(e){s[a][e]=!0}},31530:(e,t,r)=>{"use strict";var n=r(28710).charAt;e.exports=function(e,t,r){return t+(r?n(e,t).length:1)}},25787:(e,t,r)=>{var n=r(17854),i=r(47976),o=n.TypeError;e.exports=function(e,t){if(i(t,e))return e;throw o("Incorrect invocation")}},19670:(e,t,r)=>{var n=r(17854),i=r(70111),o=n.String,a=n.TypeError;e.exports=function(e){if(i(e))return e;throw a(o(e)+" is not an object")}},24019:e=>{e.exports="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView},7556:(e,t,r)=>{var n=r(47293);e.exports=n((function(){if("function"==typeof ArrayBuffer){var e=new ArrayBuffer(8);Object.isExtensible(e)&&Object.defineProperty(e,"a",{value:8})}}))},90260:(e,t,r)=>{"use strict";var n,i,o,a=r(24019),s=r(19781),l=r(17854),u=r(60614),c=r(70111),h=r(92597),d=r(70648),f=r(66330),p=r(68880),m=r(31320),g=r(3070).f,v=r(47976),y=r(79518),b=r(27674),x=r(5112),_=r(69711),E=l.Int8Array,w=E&&E.prototype,A=l.Uint8ClampedArray,S=A&&A.prototype,M=E&&y(E),T=w&&y(w),C=Object.prototype,P=l.TypeError,D=x("toStringTag"),L=_("TYPED_ARRAY_TAG"),R=_("TYPED_ARRAY_CONSTRUCTOR"),I=a&&!!b&&"Opera"!==d(l.opera),O=!1,N={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},k={BigInt64Array:8,BigUint64Array:8},F=function(e){if(!c(e))return!1;var t=d(e);return h(N,t)||h(k,t)};for(n in N)(o=(i=l[n])&&i.prototype)?p(o,R,i):I=!1;for(n in k)(o=(i=l[n])&&i.prototype)&&p(o,R,i);if((!I||!u(M)||M===Function.prototype)&&(M=function(){throw P("Incorrect invocation")},I))for(n in N)l[n]&&b(l[n],M);if((!I||!T||T===C)&&(T=M.prototype,I))for(n in N)l[n]&&b(l[n].prototype,T);if(I&&y(S)!==T&&b(S,T),s&&!h(T,D))for(n in O=!0,g(T,D,{get:function(){return c(this)?this[L]:void 0}}),N)l[n]&&p(l[n],L,n);e.exports={NATIVE_ARRAY_BUFFER_VIEWS:I,TYPED_ARRAY_CONSTRUCTOR:R,TYPED_ARRAY_TAG:O&&L,aTypedArray:function(e){if(F(e))return e;throw P("Target is not a typed array")},aTypedArrayConstructor:function(e){if(u(e)&&(!b||v(M,e)))return e;throw P(f(e)+" is not a typed array constructor")},exportTypedArrayMethod:function(e,t,r,n){if(s){if(r)for(var i in N){var o=l[i];if(o&&h(o.prototype,e))try{delete o.prototype[e]}catch(r){try{o.prototype[e]=t}catch(e){}}}T[e]&&!r||m(T,e,r?t:I&&w[e]||t,n)}},exportTypedArrayStaticMethod:function(e,t,r){var n,i;if(s){if(b){if(r)for(n in N)if((i=l[n])&&h(i,e))try{delete i[e]}catch(e){}if(M[e]&&!r)return;try{return m(M,e,r?t:I&&M[e]||t)}catch(e){}}for(n in N)!(i=l[n])||i[e]&&!r||m(i,e,t)}},isView:function(e){if(!c(e))return!1;var t=d(e);return"DataView"===t||h(N,t)||h(k,t)},isTypedArray:F,TypedArray:M,TypedArrayPrototype:T}},13331:(e,t,r)=>{"use strict";var n=r(17854),i=r(1702),o=r(19781),a=r(24019),s=r(76530),l=r(68880),u=r(12248),c=r(47293),h=r(25787),d=r(19303),f=r(17466),p=r(57067),m=r(11179),g=r(79518),v=r(27674),y=r(8006).f,b=r(3070).f,x=r(21285),_=r(41589),E=r(58003),w=r(29909),A=s.PROPER,S=s.CONFIGURABLE,M=w.get,T=w.set,C="ArrayBuffer",P="DataView",D="Wrong index",L=n.ArrayBuffer,R=L,I=R&&R.prototype,O=n.DataView,N=O&&O.prototype,k=Object.prototype,F=n.Array,V=n.RangeError,U=i(x),B=i([].reverse),z=m.pack,G=m.unpack,H=function(e){return[255&e]},W=function(e){return[255&e,e>>8&255]},j=function(e){return[255&e,e>>8&255,e>>16&255,e>>24&255]},q=function(e){return e[3]<<24|e[2]<<16|e[1]<<8|e[0]},X=function(e){return z(e,23,4)},Y=function(e){return z(e,52,8)},K=function(e,t){b(e.prototype,t,{get:function(){return M(this)[t]}})},Z=function(e,t,r,n){var i=p(r),o=M(e);if(i+t>o.byteLength)throw V(D);var a=M(o.buffer).bytes,s=i+o.byteOffset,l=_(a,s,s+t);return n?l:B(l)},Q=function(e,t,r,n,i,o){var a=p(r),s=M(e);if(a+t>s.byteLength)throw V(D);for(var l=M(s.buffer).bytes,u=a+s.byteOffset,c=n(+i),h=0;h<t;h++)l[u+h]=c[o?h:t-h-1]};if(a){var J=A&&L.name!==C;if(c((function(){L(1)}))&&c((function(){new L(-1)}))&&!c((function(){return new L,new L(1.5),new L(NaN),J&&!S})))J&&S&&l(L,"name",C);else{(R=function(e){return h(this,I),new L(p(e))}).prototype=I;for(var $,ee=y(L),te=0;ee.length>te;)($=ee[te++])in R||l(R,$,L[$]);I.constructor=R}v&&g(N)!==k&&v(N,k);var re=new O(new R(2)),ne=i(N.setInt8);re.setInt8(0,2147483648),re.setInt8(1,2147483649),!re.getInt8(0)&&re.getInt8(1)||u(N,{setInt8:function(e,t){ne(this,e,t<<24>>24)},setUint8:function(e,t){ne(this,e,t<<24>>24)}},{unsafe:!0})}else I=(R=function(e){h(this,I);var t=p(e);T(this,{bytes:U(F(t),0),byteLength:t}),o||(this.byteLength=t)}).prototype,N=(O=function(e,t,r){h(this,N),h(e,I);var n=M(e).byteLength,i=d(t);if(i<0||i>n)throw V("Wrong offset");if(i+(r=void 0===r?n-i:f(r))>n)throw V("Wrong length");T(this,{buffer:e,byteLength:r,byteOffset:i}),o||(this.buffer=e,this.byteLength=r,this.byteOffset=i)}).prototype,o&&(K(R,"byteLength"),K(O,"buffer"),K(O,"byteLength"),K(O,"byteOffset")),u(N,{getInt8:function(e){return Z(this,1,e)[0]<<24>>24},getUint8:function(e){return Z(this,1,e)[0]},getInt16:function(e){var t=Z(this,2,e,arguments.length>1?arguments[1]:void 0);return(t[1]<<8|t[0])<<16>>16},getUint16:function(e){var t=Z(this,2,e,arguments.length>1?arguments[1]:void 0);return t[1]<<8|t[0]},getInt32:function(e){return q(Z(this,4,e,arguments.length>1?arguments[1]:void 0))},getUint32:function(e){return q(Z(this,4,e,arguments.length>1?arguments[1]:void 0))>>>0},getFloat32:function(e){return G(Z(this,4,e,arguments.length>1?arguments[1]:void 0),23)},getFloat64:function(e){return G(Z(this,8,e,arguments.length>1?arguments[1]:void 0),52)},setInt8:function(e,t){Q(this,1,e,H,t)},setUint8:function(e,t){Q(this,1,e,H,t)},setInt16:function(e,t){Q(this,2,e,W,t,arguments.length>2?arguments[2]:void 0)},setUint16:function(e,t){Q(this,2,e,W,t,arguments.length>2?arguments[2]:void 0)},setInt32:function(e,t){Q(this,4,e,j,t,arguments.length>2?arguments[2]:void 0)},setUint32:function(e,t){Q(this,4,e,j,t,arguments.length>2?arguments[2]:void 0)},setFloat32:function(e,t){Q(this,4,e,X,t,arguments.length>2?arguments[2]:void 0)},setFloat64:function(e,t){Q(this,8,e,Y,t,arguments.length>2?arguments[2]:void 0)}});E(R,C),E(O,P),e.exports={ArrayBuffer:R,DataView:O}},1048:(e,t,r)=>{"use strict";var n=r(47908),i=r(51400),o=r(26244),a=Math.min;e.exports=[].copyWithin||function(e,t){var r=n(this),s=o(r),l=i(e,s),u=i(t,s),c=arguments.length>2?arguments[2]:void 0,h=a((void 0===c?s:i(c,s))-u,s-l),d=1;for(u<l&&l<u+h&&(d=-1,u+=h-1,l+=h-1);h-- >0;)u in r?r[l]=r[u]:delete r[l],l+=d,u+=d;return r}},21285:(e,t,r)=>{"use strict";var n=r(47908),i=r(51400),o=r(26244);e.exports=function(e){for(var t=n(this),r=o(t),a=arguments.length,s=i(a>1?arguments[1]:void 0,r),l=a>2?arguments[2]:void 0,u=void 0===l?r:i(l,r);u>s;)t[s++]=e;return t}},18533:(e,t,r)=>{"use strict";var n=r(42092).forEach,i=r(9341)("forEach");e.exports=i?[].forEach:function(e){return n(this,e,arguments.length>1?arguments[1]:void 0)}},97745:(e,t,r)=>{var n=r(26244);e.exports=function(e,t){for(var r=0,i=n(t),o=new e(i);i>r;)o[r]=t[r++];return o}},48457:(e,t,r)=>{"use strict";var n=r(17854),i=r(49974),o=r(46916),a=r(47908),s=r(53411),l=r(97659),u=r(4411),c=r(26244),h=r(86135),d=r(18554),f=r(71246),p=n.Array;e.exports=function(e){var t=a(e),r=u(this),n=arguments.length,m=n>1?arguments[1]:void 0,g=void 0!==m;g&&(m=i(m,n>2?arguments[2]:void 0));var v,y,b,x,_,E,w=f(t),A=0;if(!w||this==p&&l(w))for(v=c(t),y=r?new this(v):p(v);v>A;A++)E=g?m(t[A],A):t[A],h(y,A,E);else for(_=(x=d(t,w)).next,y=r?new this:[];!(b=o(_,x)).done;A++)E=g?s(x,m,[b.value,A],!0):b.value,h(y,A,E);return y.length=A,y}},41318:(e,t,r)=>{var n=r(45656),i=r(51400),o=r(26244),a=function(e){return function(t,r,a){var s,l=n(t),u=o(l),c=i(a,u);if(e&&r!=r){for(;u>c;)if((s=l[c++])!=s)return!0}else for(;u>c;c++)if((e||c in l)&&l[c]===r)return e||c||0;return!e&&-1}};e.exports={includes:a(!0),indexOf:a(!1)}},42092:(e,t,r)=>{var n=r(49974),i=r(1702),o=r(68361),a=r(47908),s=r(26244),l=r(65417),u=i([].push),c=function(e){var t=1==e,r=2==e,i=3==e,c=4==e,h=6==e,d=7==e,f=5==e||h;return function(p,m,g,v){for(var y,b,x=a(p),_=o(x),E=n(m,g),w=s(_),A=0,S=v||l,M=t?S(p,w):r||d?S(p,0):void 0;w>A;A++)if((f||A in _)&&(b=E(y=_[A],A,x),e))if(t)M[A]=b;else if(b)switch(e){case 3:return!0;case 5:return y;case 6:return A;case 2:u(M,y)}else switch(e){case 4:return!1;case 7:u(M,y)}return h?-1:i||c?c:M}};e.exports={forEach:c(0),map:c(1),filter:c(2),some:c(3),every:c(4),find:c(5),findIndex:c(6),filterReject:c(7)}},86583:(e,t,r)=>{"use strict";var n=r(22104),i=r(45656),o=r(19303),a=r(26244),s=r(9341),l=Math.min,u=[].lastIndexOf,c=!!u&&1/[1].lastIndexOf(1,-0)<0,h=s("lastIndexOf"),d=c||!h;e.exports=d?function(e){if(c)return n(u,this,arguments)||0;var t=i(this),r=a(t),s=r-1;for(arguments.length>1&&(s=l(s,o(arguments[1]))),s<0&&(s=r+s);s>=0;s--)if(s in t&&t[s]===e)return s||0;return-1}:u},81194:(e,t,r)=>{var n=r(47293),i=r(5112),o=r(7392),a=i("species");e.exports=function(e){return o>=51||!n((function(){var t=[];return(t.constructor={})[a]=function(){return{foo:1}},1!==t[e](Boolean).foo}))}},9341:(e,t,r)=>{"use strict";var n=r(47293);e.exports=function(e,t){var r=[][e];return!!r&&n((function(){r.call(null,t||function(){return 1},1)}))}},53671:(e,t,r)=>{var n=r(17854),i=r(19662),o=r(47908),a=r(68361),s=r(26244),l=n.TypeError,u=function(e){return function(t,r,n,u){i(r);var c=o(t),h=a(c),d=s(c),f=e?d-1:0,p=e?-1:1;if(n<2)for(;;){if(f in h){u=h[f],f+=p;break}if(f+=p,e?f<0:d<=f)throw l("Reduce of empty array with no initial value")}for(;e?f>=0:d>f;f+=p)f in h&&(u=r(u,h[f],f,c));return u}};e.exports={left:u(!1),right:u(!0)}},41589:(e,t,r)=>{var n=r(17854),i=r(51400),o=r(26244),a=r(86135),s=n.Array,l=Math.max;e.exports=function(e,t,r){for(var n=o(e),u=i(t,n),c=i(void 0===r?n:r,n),h=s(l(c-u,0)),d=0;u<c;u++,d++)a(h,d,e[u]);return h.length=d,h}},50206:(e,t,r)=>{var n=r(1702);e.exports=n([].slice)},94362:(e,t,r)=>{var n=r(41589),i=Math.floor,o=function(e,t){var r=e.length,l=i(r/2);return r<8?a(e,t):s(e,o(n(e,0,l),t),o(n(e,l),t),t)},a=function(e,t){for(var r,n,i=e.length,o=1;o<i;){for(n=o,r=e[o];n&&t(e[n-1],r)>0;)e[n]=e[--n];n!==o++&&(e[n]=r)}return e},s=function(e,t,r,n){for(var i=t.length,o=r.length,a=0,s=0;a<i||s<o;)e[a+s]=a<i&&s<o?n(t[a],r[s])<=0?t[a++]:r[s++]:a<i?t[a++]:r[s++];return e};e.exports=o},77475:(e,t,r)=>{var n=r(17854),i=r(43157),o=r(4411),a=r(70111),s=r(5112)("species"),l=n.Array;e.exports=function(e){var t;return i(e)&&(t=e.constructor,(o(t)&&(t===l||i(t.prototype))||a(t)&&null===(t=t[s]))&&(t=void 0)),void 0===t?l:t}},65417:(e,t,r)=>{var n=r(77475);e.exports=function(e,t){return new(n(e))(0===t?0:t)}},60956:(e,t,r)=>{"use strict";var n=r(35005),i=r(1702),o=r(19662),a=r(26244),s=r(47908),l=r(65417),u=n("Map"),c=u.prototype,h=i(c.forEach),d=i(c.has),f=i(c.set),p=i([].push);e.exports=function(e){var t,r,n,i=s(this),c=a(i),m=l(i,0),g=new u,v=null!=e?o(e):function(e){return e};for(t=0;t<c;t++)n=v(r=i[t]),d(g,n)||f(g,n,r);return h(g,(function(e){p(m,e)})),m}},53411:(e,t,r)=>{var n=r(19670),i=r(99212);e.exports=function(e,t,r,o){try{return o?t(n(r)[0],r[1]):t(r)}catch(t){i(e,"throw",t)}}},17072:(e,t,r)=>{var n=r(5112)("iterator"),i=!1;try{var o=0,a={next:function(){return{done:!!o++}},return:function(){i=!0}};a[n]=function(){return this},Array.from(a,(function(){throw 2}))}catch(e){}e.exports=function(e,t){if(!t&&!i)return!1;var r=!1;try{var o={};o[n]=function(){return{next:function(){return{done:r=!0}}}},e(o)}catch(e){}return r}},84326:(e,t,r)=>{var n=r(1702),i=n({}.toString),o=n("".slice);e.exports=function(e){return o(i(e),8,-1)}},70648:(e,t,r)=>{var n=r(17854),i=r(51694),o=r(60614),a=r(84326),s=r(5112)("toStringTag"),l=n.Object,u="Arguments"==a(function(){return arguments}());e.exports=i?a:function(e){var t,r,n;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(r=function(e,t){try{return e[t]}catch(e){}}(t=l(e),s))?r:u?a(t):"Object"==(n=a(t))&&o(t.callee)?"Arguments":n}},77741:(e,t,r)=>{var n=r(1702)("".replace),i=String(Error("zxcasd").stack),o=/\n\s*at [^:]*:[^\n]*/,a=o.test(i);e.exports=function(e,t){if(a&&"string"==typeof e)for(;t--;)e=n(e,o,"");return e}},31501:(e,t,r)=>{"use strict";var n=r(46916),i=r(19662),o=r(19670);e.exports=function(){for(var e=o(this),t=i(e.add),r=0,a=arguments.length;r<a;r++)n(t,e,arguments[r]);return e}},34092:(e,t,r)=>{"use strict";var n=r(46916),i=r(19662),o=r(19670);e.exports=function(){for(var e,t=o(this),r=i(t.delete),a=!0,s=0,l=arguments.length;s<l;s++)e=n(r,t,arguments[s]),a=a&&e;return!!a}},27296:(e,t,r)=>{"use strict";var n=r(49974),i=r(46916),o=r(19662),a=r(39483),s=r(20408),l=[].push;e.exports=function(e){var t,r,u,c,h=arguments.length,d=h>1?arguments[1]:void 0;return a(this),(t=void 0!==d)&&o(d),null==e?new this:(r=[],t?(u=0,c=n(d,h>2?arguments[2]:void 0),s(e,(function(e){i(l,r,c(e,u++))}))):s(e,l,{that:r}),new this(r))}},82044:(e,t,r)=>{"use strict";var n=r(50206);e.exports=function(){return new this(n(arguments))}},95631:(e,t,r)=>{"use strict";var n=r(3070).f,i=r(70030),o=r(12248),a=r(49974),s=r(25787),l=r(20408),u=r(70654),c=r(96340),h=r(19781),d=r(62423).fastKey,f=r(29909),p=f.set,m=f.getterFor;e.exports={getConstructor:function(e,t,r,u){var c=e((function(e,n){s(e,f),p(e,{type:t,index:i(null),first:void 0,last:void 0,size:0}),h||(e.size=0),null!=n&&l(n,e[u],{that:e,AS_ENTRIES:r})})),f=c.prototype,g=m(t),v=function(e,t,r){var n,i,o=g(e),a=y(e,t);return a?a.value=r:(o.last=a={index:i=d(t,!0),key:t,value:r,previous:n=o.last,next:void 0,removed:!1},o.first||(o.first=a),n&&(n.next=a),h?o.size++:e.size++,"F"!==i&&(o.index[i]=a)),e},y=function(e,t){var r,n=g(e),i=d(t);if("F"!==i)return n.index[i];for(r=n.first;r;r=r.next)if(r.key==t)return r};return o(f,{clear:function(){for(var e=g(this),t=e.index,r=e.first;r;)r.removed=!0,r.previous&&(r.previous=r.previous.next=void 0),delete t[r.index],r=r.next;e.first=e.last=void 0,h?e.size=0:this.size=0},delete:function(e){var t=this,r=g(t),n=y(t,e);if(n){var i=n.next,o=n.previous;delete r.index[n.index],n.removed=!0,o&&(o.next=i),i&&(i.previous=o),r.first==n&&(r.first=i),r.last==n&&(r.last=o),h?r.size--:t.size--}return!!n},forEach:function(e){for(var t,r=g(this),n=a(e,arguments.length>1?arguments[1]:void 0);t=t?t.next:r.first;)for(n(t.value,t.key,this);t&&t.removed;)t=t.previous},has:function(e){return!!y(this,e)}}),o(f,r?{get:function(e){var t=y(this,e);return t&&t.value},set:function(e,t){return v(this,0===e?0:e,t)}}:{add:function(e){return v(this,e=0===e?0:e,e)}}),h&&n(f,"size",{get:function(){return g(this).size}}),c},setStrong:function(e,t,r){var n=t+" Iterator",i=m(t),o=m(n);u(e,t,(function(e,t){p(this,{type:n,target:e,state:i(e),kind:t,last:void 0})}),(function(){for(var e=o(this),t=e.kind,r=e.last;r&&r.removed;)r=r.previous;return e.target&&(e.last=r=r?r.next:e.state.first)?"keys"==t?{value:r.key,done:!1}:"values"==t?{value:r.value,done:!1}:{value:[r.key,r.value],done:!1}:(e.target=void 0,{value:void 0,done:!0})}),r?"entries":"values",!r,!0),c(t)}}},29320:(e,t,r)=>{"use strict";var n=r(1702),i=r(12248),o=r(62423).getWeakData,a=r(19670),s=r(70111),l=r(25787),u=r(20408),c=r(42092),h=r(92597),d=r(29909),f=d.set,p=d.getterFor,m=c.find,g=c.findIndex,v=n([].splice),y=0,b=function(e){return e.frozen||(e.frozen=new x)},x=function(){this.entries=[]},_=function(e,t){return m(e.entries,(function(e){return e[0]===t}))};x.prototype={get:function(e){var t=_(this,e);if(t)return t[1]},has:function(e){return!!_(this,e)},set:function(e,t){var r=_(this,e);r?r[1]=t:this.entries.push([e,t])},delete:function(e){var t=g(this.entries,(function(t){return t[0]===e}));return~t&&v(this.entries,t,1),!!~t}},e.exports={getConstructor:function(e,t,r,n){var c=e((function(e,i){l(e,d),f(e,{type:t,id:y++,frozen:void 0}),null!=i&&u(i,e[n],{that:e,AS_ENTRIES:r})})),d=c.prototype,m=p(t),g=function(e,t,r){var n=m(e),i=o(a(t),!0);return!0===i?b(n).set(t,r):i[n.id]=r,e};return i(d,{delete:function(e){var t=m(this);if(!s(e))return!1;var r=o(e);return!0===r?b(t).delete(e):r&&h(r,t.id)&&delete r[t.id]},has:function(e){var t=m(this);if(!s(e))return!1;var r=o(e);return!0===r?b(t).has(e):r&&h(r,t.id)}}),i(d,r?{get:function(e){var t=m(this);if(s(e)){var r=o(e);return!0===r?b(t).get(e):r?r[t.id]:void 0}},set:function(e,t){return g(this,e,t)}}:{add:function(e){return g(this,e,!0)}}),c}}},77710:(e,t,r)=>{"use strict";var n=r(82109),i=r(17854),o=r(1702),a=r(54705),s=r(31320),l=r(62423),u=r(20408),c=r(25787),h=r(60614),d=r(70111),f=r(47293),p=r(17072),m=r(58003),g=r(79587);e.exports=function(e,t,r){var v=-1!==e.indexOf("Map"),y=-1!==e.indexOf("Weak"),b=v?"set":"add",x=i[e],_=x&&x.prototype,E=x,w={},A=function(e){var t=o(_[e]);s(_,e,"add"==e?function(e){return t(this,0===e?0:e),this}:"delete"==e?function(e){return!(y&&!d(e))&&t(this,0===e?0:e)}:"get"==e?function(e){return y&&!d(e)?void 0:t(this,0===e?0:e)}:"has"==e?function(e){return!(y&&!d(e))&&t(this,0===e?0:e)}:function(e,r){return t(this,0===e?0:e,r),this})};if(a(e,!h(x)||!(y||_.forEach&&!f((function(){(new x).entries().next()})))))E=r.getConstructor(t,e,v,b),l.enable();else if(a(e,!0)){var S=new E,M=S[b](y?{}:-0,1)!=S,T=f((function(){S.has(1)})),C=p((function(e){new x(e)})),P=!y&&f((function(){for(var e=new x,t=5;t--;)e[b](t,t);return!e.has(-0)}));C||((E=t((function(e,t){c(e,_);var r=g(new x,e,E);return null!=t&&u(t,r[b],{that:r,AS_ENTRIES:v}),r}))).prototype=_,_.constructor=E),(T||P)&&(A("delete"),A("has"),v&&A("get")),(P||M)&&A(b),y&&_.clear&&delete _.clear}return w[e]=E,n({global:!0,forced:E!=x},w),m(E,e),y||r.setStrong(E,e,v),E}},10313:(e,t,r)=>{r(51532),r(4129);var n=r(17854),i=r(35005),o=r(70030),a=r(70111),s=n.Object,l=n.TypeError,u=i("Map"),c=i("WeakMap"),h=function(){this.object=null,this.symbol=null,this.primitives=null,this.objectsByIndex=o(null)};h.prototype.get=function(e,t){return this[e]||(this[e]=t())},h.prototype.next=function(e,t,r){var n=r?this.objectsByIndex[e]||(this.objectsByIndex[e]=new c):this.primitives||(this.primitives=new u),i=n.get(t);return i||n.set(t,i=new h),i};var d=new h;e.exports=function(){var e,t,r=d,n=arguments.length;for(e=0;e<n;e++)a(t=arguments[e])&&(r=r.next(e,t,!0));if(this===s&&r===d)throw l("Composite keys must contain a non-primitive component");for(e=0;e<n;e++)a(t=arguments[e])||(r=r.next(e,t,!1));return r}},99920:(e,t,r)=>{var n=r(92597),i=r(53887),o=r(31236),a=r(3070);e.exports=function(e,t,r){for(var s=i(t),l=a.f,u=o.f,c=0;c<s.length;c++){var h=s[c];n(e,h)||r&&n(r,h)||l(e,h,u(t,h))}}},84964:(e,t,r)=>{var n=r(5112)("match");e.exports=function(e){var t=/./;try{"/./"[e](t)}catch(r){try{return t[n]=!1,"/./"[e](t)}catch(e){}}return!1}},49920:(e,t,r)=>{var n=r(47293);e.exports=!n((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}))},14230:(e,t,r)=>{var n=r(1702),i=r(84488),o=r(41340),a=/"/g,s=n("".replace);e.exports=function(e,t,r,n){var l=o(i(e)),u="<"+t;return""!==r&&(u+=" "+r+'="'+s(o(n),a,"&quot;")+'"'),u+">"+l+"</"+t+">"}},24994:(e,t,r)=>{"use strict";var n=r(13383).IteratorPrototype,i=r(70030),o=r(79114),a=r(58003),s=r(97497),l=function(){return this};e.exports=function(e,t,r,u){var c=t+" Iterator";return e.prototype=i(n,{next:o(+!u,r)}),a(e,c,!1,!0),s[c]=l,e}},68880:(e,t,r)=>{var n=r(19781),i=r(3070),o=r(79114);e.exports=n?function(e,t,r){return i.f(e,t,o(1,r))}:function(e,t,r){return e[t]=r,e}},79114:e=>{e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},86135:(e,t,r)=>{"use strict";var n=r(34948),i=r(3070),o=r(79114);e.exports=function(e,t,r){var a=n(t);a in e?i.f(e,a,o(0,r)):e[a]=r}},38709:(e,t,r)=>{"use strict";var n=r(17854),i=r(19670),o=r(92140),a=n.TypeError;e.exports=function(e){if(i(this),"string"===e||"default"===e)e="string";else if("number"!==e)throw a("Incorrect hint");return o(this,e)}},70654:(e,t,r)=>{"use strict";var n=r(82109),i=r(46916),o=r(31913),a=r(76530),s=r(60614),l=r(24994),u=r(79518),c=r(27674),h=r(58003),d=r(68880),f=r(31320),p=r(5112),m=r(97497),g=r(13383),v=a.PROPER,y=a.CONFIGURABLE,b=g.IteratorPrototype,x=g.BUGGY_SAFARI_ITERATORS,_=p("iterator"),E="keys",w="values",A="entries",S=function(){return this};e.exports=function(e,t,r,a,p,g,M){l(r,t,a);var T,C,P,D=function(e){if(e===p&&N)return N;if(!x&&e in I)return I[e];switch(e){case E:case w:case A:return function(){return new r(this,e)}}return function(){return new r(this)}},L=t+" Iterator",R=!1,I=e.prototype,O=I[_]||I["@@iterator"]||p&&I[p],N=!x&&O||D(p),k="Array"==t&&I.entries||O;if(k&&(T=u(k.call(new e)))!==Object.prototype&&T.next&&(o||u(T)===b||(c?c(T,b):s(T[_])||f(T,_,S)),h(T,L,!0,!0),o&&(m[L]=S)),v&&p==w&&O&&O.name!==w&&(!o&&y?d(I,"name",w):(R=!0,N=function(){return i(O,this)})),p)if(C={values:D(w),keys:g?N:D(E),entries:D(A)},M)for(P in C)(x||R||!(P in I))&&f(I,P,C[P]);else n({target:t,proto:!0,forced:x||R},C);return o&&!M||I[_]===N||f(I,_,N,{name:p}),m[t]=N,C}},97235:(e,t,r)=>{var n=r(40857),i=r(92597),o=r(6061),a=r(3070).f;e.exports=function(e){var t=n.Symbol||(n.Symbol={});i(t,e)||a(t,e,{value:o.f(e)})}},19781:(e,t,r)=>{var n=r(47293);e.exports=!n((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},80317:(e,t,r)=>{var n=r(17854),i=r(70111),o=n.document,a=i(o)&&i(o.createElement);e.exports=function(e){return a?o.createElement(e):{}}},48324:e=>{e.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},98509:(e,t,r)=>{var n=r(80317)("span").classList,i=n&&n.constructor&&n.constructor.prototype;e.exports=i===Object.prototype?void 0:i},68886:(e,t,r)=>{var n=r(88113).match(/firefox\/(\d+)/i);e.exports=!!n&&+n[1]},7871:e=>{e.exports="object"==typeof window},30256:(e,t,r)=>{var n=r(88113);e.exports=/MSIE|Trident/.test(n)},71528:(e,t,r)=>{var n=r(88113),i=r(17854);e.exports=/ipad|iphone|ipod/i.test(n)&&void 0!==i.Pebble},6833:(e,t,r)=>{var n=r(88113);e.exports=/(?:ipad|iphone|ipod).*applewebkit/i.test(n)},35268:(e,t,r)=>{var n=r(84326),i=r(17854);e.exports="process"==n(i.process)},71036:(e,t,r)=>{var n=r(88113);e.exports=/web0s(?!.*chrome)/i.test(n)},88113:(e,t,r)=>{var n=r(35005);e.exports=n("navigator","userAgent")||""},7392:(e,t,r)=>{var n,i,o=r(17854),a=r(88113),s=o.process,l=o.Deno,u=s&&s.versions||l&&l.version,c=u&&u.v8;c&&(i=(n=c.split("."))[0]>0&&n[0]<4?1:+(n[0]+n[1])),!i&&a&&(!(n=a.match(/Edge\/(\d+)/))||n[1]>=74)&&(n=a.match(/Chrome\/(\d+)/))&&(i=+n[1]),e.exports=i},98008:(e,t,r)=>{var n=r(88113).match(/AppleWebKit\/(\d+)\./);e.exports=!!n&&+n[1]},80748:e=>{e.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},22914:(e,t,r)=>{var n=r(47293),i=r(79114);e.exports=!n((function(){var e=Error("a");return!("stack"in e)||(Object.defineProperty(e,"stack",i(1,7)),7!==e.stack)}))},82109:(e,t,r)=>{var n=r(17854),i=r(31236).f,o=r(68880),a=r(31320),s=r(83505),l=r(99920),u=r(54705);e.exports=function(e,t){var r,c,h,d,f,p=e.target,m=e.global,g=e.stat;if(r=m?n:g?n[p]||s(p,{}):(n[p]||{}).prototype)for(c in t){if(d=t[c],h=e.noTargetGet?(f=i(r,c))&&f.value:r[c],!u(m?c:p+(g?".":"#")+c,e.forced)&&void 0!==h){if(typeof d==typeof h)continue;l(d,h)}(e.sham||h&&h.sham)&&o(d,"sham",!0),a(r,c,d,e)}}},47293:e=>{e.exports=function(e){try{return!!e()}catch(e){return!0}}},27007:(e,t,r)=>{"use strict";r(74916);var n=r(1702),i=r(31320),o=r(22261),a=r(47293),s=r(5112),l=r(68880),u=s("species"),c=RegExp.prototype;e.exports=function(e,t,r,h){var d=s(e),f=!a((function(){var t={};return t[d]=function(){return 7},7!=""[e](t)})),p=f&&!a((function(){var t=!1,r=/a/;return"split"===e&&((r={}).constructor={},r.constructor[u]=function(){return r},r.flags="",r[d]=/./[d]),r.exec=function(){return t=!0,null},r[d](""),!t}));if(!f||!p||r){var m=n(/./[d]),g=t(d,""[e],(function(e,t,r,i,a){var s=n(e),l=t.exec;return l===o||l===c.exec?f&&!a?{done:!0,value:m(t,r,i)}:{done:!0,value:s(r,t,i)}:{done:!1}}));i(String.prototype,e,g[0]),i(c,d,g[1])}h&&l(c[d],"sham",!0)}},6790:(e,t,r)=>{"use strict";var n=r(17854),i=r(43157),o=r(26244),a=r(49974),s=n.TypeError,l=function(e,t,r,n,u,c,h,d){for(var f,p,m=u,g=0,v=!!h&&a(h,d);g<n;){if(g in r){if(f=v?v(r[g],g,t):r[g],c>0&&i(f))p=o(f),m=l(e,t,f,p,m,c-1)-1;else{if(m>=9007199254740991)throw s("Exceed the acceptable array length");e[m]=f}m++}g++}return m};e.exports=l},76677:(e,t,r)=>{var n=r(47293);e.exports=!n((function(){return Object.isExtensible(Object.preventExtensions({}))}))},22104:(e,t,r)=>{var n=r(34374),i=Function.prototype,o=i.apply,a=i.call;e.exports="object"==typeof Reflect&&Reflect.apply||(n?a.bind(o):function(){return a.apply(o,arguments)})},49974:(e,t,r)=>{var n=r(1702),i=r(19662),o=r(34374),a=n(n.bind);e.exports=function(e,t){return i(e),void 0===t?e:o?a(e,t):function(){return e.apply(t,arguments)}}},34374:(e,t,r)=>{var n=r(47293);e.exports=!n((function(){var e=function(){}.bind();return"function"!=typeof e||e.hasOwnProperty("prototype")}))},27065:(e,t,r)=>{"use strict";var n=r(17854),i=r(1702),o=r(19662),a=r(70111),s=r(92597),l=r(50206),u=r(34374),c=n.Function,h=i([].concat),d=i([].join),f={},p=function(e,t,r){if(!s(f,t)){for(var n=[],i=0;i<t;i++)n[i]="a["+i+"]";f[t]=c("C,a","return new C("+d(n,",")+")")}return f[t](e,r)};e.exports=u?c.bind:function(e){var t=o(this),r=t.prototype,n=l(arguments,1),i=function(){var r=h(n,l(arguments));return this instanceof i?p(t,r.length,r):t.apply(e,r)};return a(r)&&(i.prototype=r),i}},46916:(e,t,r)=>{var n=r(34374),i=Function.prototype.call;e.exports=n?i.bind(i):function(){return i.apply(i,arguments)}},76530:(e,t,r)=>{var n=r(19781),i=r(92597),o=Function.prototype,a=n&&Object.getOwnPropertyDescriptor,s=i(o,"name"),l=s&&"something"===function(){}.name,u=s&&(!n||n&&a(o,"name").configurable);e.exports={EXISTS:s,PROPER:l,CONFIGURABLE:u}},1702:(e,t,r)=>{var n=r(34374),i=Function.prototype,o=i.bind,a=i.call,s=n&&o.bind(a,a);e.exports=n?function(e){return e&&s(e)}:function(e){return e&&function(){return a.apply(e,arguments)}}},35005:(e,t,r)=>{var n=r(17854),i=r(60614),o=function(e){return i(e)?e:void 0};e.exports=function(e,t){return arguments.length<2?o(n[e]):n[e]&&n[e][t]}},71246:(e,t,r)=>{var n=r(70648),i=r(58173),o=r(97497),a=r(5112)("iterator");e.exports=function(e){if(null!=e)return i(e,a)||i(e,"@@iterator")||o[n(e)]}},18554:(e,t,r)=>{var n=r(17854),i=r(46916),o=r(19662),a=r(19670),s=r(66330),l=r(71246),u=n.TypeError;e.exports=function(e,t){var r=arguments.length<2?l(e):t;if(o(r))return a(i(r,e));throw u(s(e)+" is not iterable")}},54647:(e,t,r)=>{var n=r(46916);e.exports=function(e){return n(Map.prototype.entries,e)}},58173:(e,t,r)=>{var n=r(19662);e.exports=function(e,t){var r=e[t];return null==r?void 0:n(r)}},96767:(e,t,r)=>{var n=r(46916);e.exports=function(e){return n(Set.prototype.values,e)}},10647:(e,t,r)=>{var n=r(1702),i=r(47908),o=Math.floor,a=n("".charAt),s=n("".replace),l=n("".slice),u=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,c=/\$([$&'`]|\d{1,2})/g;e.exports=function(e,t,r,n,h,d){var f=r+e.length,p=n.length,m=c;return void 0!==h&&(h=i(h),m=u),s(d,m,(function(i,s){var u;switch(a(s,0)){case"$":return"$";case"&":return e;case"`":return l(t,0,r);case"'":return l(t,f);case"<":u=h[l(s,1,-1)];break;default:var c=+s;if(0===c)return i;if(c>p){var d=o(c/10);return 0===d?i:d<=p?void 0===n[d-1]?a(s,1):n[d-1]+a(s,1):i}u=n[c-1]}return void 0===u?"":u}))}},17854:(e,t,r)=>{var n=function(e){return e&&e.Math==Math&&e};e.exports=n("object"==typeof globalThis&&globalThis)||n("object"==typeof window&&window)||n("object"==typeof self&&self)||n("object"==typeof r.g&&r.g)||function(){return this}()||Function("return this")()},92597:(e,t,r)=>{var n=r(1702),i=r(47908),o=n({}.hasOwnProperty);e.exports=Object.hasOwn||function(e,t){return o(i(e),t)}},3501:e=>{e.exports={}},842:(e,t,r)=>{var n=r(17854);e.exports=function(e,t){var r=n.console;r&&r.error&&(1==arguments.length?r.error(e):r.error(e,t))}},60490:(e,t,r)=>{var n=r(35005);e.exports=n("document","documentElement")},64664:(e,t,r)=>{var n=r(19781),i=r(47293),o=r(80317);e.exports=!n&&!i((function(){return 7!=Object.defineProperty(o("div"),"a",{get:function(){return 7}}).a}))},11179:(e,t,r)=>{var n=r(17854).Array,i=Math.abs,o=Math.pow,a=Math.floor,s=Math.log,l=Math.LN2;e.exports={pack:function(e,t,r){var u,c,h,d=n(r),f=8*r-t-1,p=(1<<f)-1,m=p>>1,g=23===t?o(2,-24)-o(2,-77):0,v=e<0||0===e&&1/e<0?1:0,y=0;for((e=i(e))!=e||e===1/0?(c=e!=e?1:0,u=p):(u=a(s(e)/l),e*(h=o(2,-u))<1&&(u--,h*=2),(e+=u+m>=1?g/h:g*o(2,1-m))*h>=2&&(u++,h/=2),u+m>=p?(c=0,u=p):u+m>=1?(c=(e*h-1)*o(2,t),u+=m):(c=e*o(2,m-1)*o(2,t),u=0));t>=8;)d[y++]=255&c,c/=256,t-=8;for(u=u<<t|c,f+=t;f>0;)d[y++]=255&u,u/=256,f-=8;return d[--y]|=128*v,d},unpack:function(e,t){var r,n=e.length,i=8*n-t-1,a=(1<<i)-1,s=a>>1,l=i-7,u=n-1,c=e[u--],h=127&c;for(c>>=7;l>0;)h=256*h+e[u--],l-=8;for(r=h&(1<<-l)-1,h>>=-l,l+=t;l>0;)r=256*r+e[u--],l-=8;if(0===h)h=1-s;else{if(h===a)return r?NaN:c?-1/0:1/0;r+=o(2,t),h-=s}return(c?-1:1)*r*o(2,h-t)}}},68361:(e,t,r)=>{var n=r(17854),i=r(1702),o=r(47293),a=r(84326),s=n.Object,l=i("".split);e.exports=o((function(){return!s("z").propertyIsEnumerable(0)}))?function(e){return"String"==a(e)?l(e,""):s(e)}:s},79587:(e,t,r)=>{var n=r(60614),i=r(70111),o=r(27674);e.exports=function(e,t,r){var a,s;return o&&n(a=t.constructor)&&a!==r&&i(s=a.prototype)&&s!==r.prototype&&o(e,s),e}},42788:(e,t,r)=>{var n=r(1702),i=r(60614),o=r(5465),a=n(Function.toString);i(o.inspectSource)||(o.inspectSource=function(e){return a(e)}),e.exports=o.inspectSource},58340:(e,t,r)=>{var n=r(70111),i=r(68880);e.exports=function(e,t){n(t)&&"cause"in t&&i(e,"cause",t.cause)}},62423:(e,t,r)=>{var n=r(82109),i=r(1702),o=r(3501),a=r(70111),s=r(92597),l=r(3070).f,u=r(8006),c=r(1156),h=r(52050),d=r(69711),f=r(76677),p=!1,m=d("meta"),g=0,v=function(e){l(e,m,{value:{objectID:"O"+g++,weakData:{}}})},y=e.exports={enable:function(){y.enable=function(){},p=!0;var e=u.f,t=i([].splice),r={};r[m]=1,e(r).length&&(u.f=function(r){for(var n=e(r),i=0,o=n.length;i<o;i++)if(n[i]===m){t(n,i,1);break}return n},n({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:c.f}))},fastKey:function(e,t){if(!a(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!s(e,m)){if(!h(e))return"F";if(!t)return"E";v(e)}return e[m].objectID},getWeakData:function(e,t){if(!s(e,m)){if(!h(e))return!0;if(!t)return!1;v(e)}return e[m].weakData},onFreeze:function(e){return f&&p&&h(e)&&!s(e,m)&&v(e),e}};o[m]=!0},29909:(e,t,r)=>{var n,i,o,a=r(68536),s=r(17854),l=r(1702),u=r(70111),c=r(68880),h=r(92597),d=r(5465),f=r(6200),p=r(3501),m="Object already initialized",g=s.TypeError,v=s.WeakMap;if(a||d.state){var y=d.state||(d.state=new v),b=l(y.get),x=l(y.has),_=l(y.set);n=function(e,t){if(x(y,e))throw new g(m);return t.facade=e,_(y,e,t),t},i=function(e){return b(y,e)||{}},o=function(e){return x(y,e)}}else{var E=f("state");p[E]=!0,n=function(e,t){if(h(e,E))throw new g(m);return t.facade=e,c(e,E,t),t},i=function(e){return h(e,E)?e[E]:{}},o=function(e){return h(e,E)}}e.exports={set:n,get:i,has:o,enforce:function(e){return o(e)?i(e):n(e,{})},getterFor:function(e){return function(t){var r;if(!u(t)||(r=i(t)).type!==e)throw g("Incompatible receiver, "+e+" required");return r}}}},97659:(e,t,r)=>{var n=r(5112),i=r(97497),o=n("iterator"),a=Array.prototype;e.exports=function(e){return void 0!==e&&(i.Array===e||a[o]===e)}},43157:(e,t,r)=>{var n=r(84326);e.exports=Array.isArray||function(e){return"Array"==n(e)}},60614:e=>{e.exports=function(e){return"function"==typeof e}},4411:(e,t,r)=>{var n=r(1702),i=r(47293),o=r(60614),a=r(70648),s=r(35005),l=r(42788),u=function(){},c=[],h=s("Reflect","construct"),d=/^\s*(?:class|function)\b/,f=n(d.exec),p=!d.exec(u),m=function(e){if(!o(e))return!1;try{return h(u,c,e),!0}catch(e){return!1}},g=function(e){if(!o(e))return!1;switch(a(e)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return p||!!f(d,l(e))}catch(e){return!0}};g.sham=!0,e.exports=!h||i((function(){var e;return m(m.call)||!m(Object)||!m((function(){e=!0}))||e}))?g:m},45032:(e,t,r)=>{var n=r(92597);e.exports=function(e){return void 0!==e&&(n(e,"value")||n(e,"writable"))}},54705:(e,t,r)=>{var n=r(47293),i=r(60614),o=/#|\.prototype\./,a=function(e,t){var r=l[s(e)];return r==c||r!=u&&(i(t)?n(t):!!t)},s=a.normalize=function(e){return String(e).replace(o,".").toLowerCase()},l=a.data={},u=a.NATIVE="N",c=a.POLYFILL="P";e.exports=a},55988:(e,t,r)=>{var n=r(70111),i=Math.floor;e.exports=Number.isInteger||function(e){return!n(e)&&isFinite(e)&&i(e)===e}},70111:(e,t,r)=>{var n=r(60614);e.exports=function(e){return"object"==typeof e?null!==e:n(e)}},31913:e=>{e.exports=!1},47850:(e,t,r)=>{var n=r(70111),i=r(84326),o=r(5112)("match");e.exports=function(e){var t;return n(e)&&(void 0!==(t=e[o])?!!t:"RegExp"==i(e))}},52190:(e,t,r)=>{var n=r(17854),i=r(35005),o=r(60614),a=r(47976),s=r(43307),l=n.Object;e.exports=s?function(e){return"symbol"==typeof e}:function(e){var t=i("Symbol");return o(t)&&a(t.prototype,l(e))}},20408:(e,t,r)=>{var n=r(17854),i=r(49974),o=r(46916),a=r(19670),s=r(66330),l=r(97659),u=r(26244),c=r(47976),h=r(18554),d=r(71246),f=r(99212),p=n.TypeError,m=function(e,t){this.stopped=e,this.result=t},g=m.prototype;e.exports=function(e,t,r){var n,v,y,b,x,_,E,w=r&&r.that,A=!(!r||!r.AS_ENTRIES),S=!(!r||!r.IS_ITERATOR),M=!(!r||!r.INTERRUPTED),T=i(t,w),C=function(e){return n&&f(n,"normal",e),new m(!0,e)},P=function(e){return A?(a(e),M?T(e[0],e[1],C):T(e[0],e[1])):M?T(e,C):T(e)};if(S)n=e;else{if(!(v=d(e)))throw p(s(e)+" is not iterable");if(l(v)){for(y=0,b=u(e);b>y;y++)if((x=P(e[y]))&&c(g,x))return x;return new m(!1)}n=h(e,v)}for(_=n.next;!(E=o(_,n)).done;){try{x=P(E.value)}catch(e){f(n,"throw",e)}if("object"==typeof x&&x&&c(g,x))return x}return new m(!1)}},99212:(e,t,r)=>{var n=r(46916),i=r(19670),o=r(58173);e.exports=function(e,t,r){var a,s;i(e);try{if(!(a=o(e,"return"))){if("throw"===t)throw r;return r}a=n(a,e)}catch(e){s=!0,a=e}if("throw"===t)throw r;if(s)throw a;return i(a),r}},13383:(e,t,r)=>{"use strict";var n,i,o,a=r(47293),s=r(60614),l=r(70030),u=r(79518),c=r(31320),h=r(5112),d=r(31913),f=h("iterator"),p=!1;[].keys&&("next"in(o=[].keys())?(i=u(u(o)))!==Object.prototype&&(n=i):p=!0),null==n||a((function(){var e={};return n[f].call(e)!==e}))?n={}:d&&(n=l(n)),s(n[f])||c(n,f,(function(){return this})),e.exports={IteratorPrototype:n,BUGGY_SAFARI_ITERATORS:p}},97497:e=>{e.exports={}},26244:(e,t,r)=>{var n=r(17466);e.exports=function(e){return n(e.length)}},66736:e=>{var t=Math.expm1,r=Math.exp;e.exports=!t||t(10)>22025.465794806718||t(10)<22025.465794806718||-2e-17!=t(-2e-17)?function(e){return 0==(e=+e)?e:e>-1e-6&&e<1e-6?e+e*e/2:r(e)-1}:t},26130:(e,t,r)=>{var n=r(64310),i=Math.abs,o=Math.pow,a=o(2,-52),s=o(2,-23),l=o(2,127)*(2-s),u=o(2,-126);e.exports=Math.fround||function(e){var t,r,o=i(e),c=n(e);return o<u?c*(o/u/s+1/a-1/a)*u*s:(r=(t=(1+s/a)*o)-(t-o))>l||r!=r?c*(1/0):c*r}},20403:e=>{var t=Math.log,r=Math.LOG10E;e.exports=Math.log10||function(e){return t(e)*r}},26513:e=>{var t=Math.log;e.exports=Math.log1p||function(e){return(e=+e)>-1e-8&&e<1e-8?e-e*e/2:t(1+e)}},47103:e=>{e.exports=Math.scale||function(e,t,r,n,i){var o=+e,a=+t,s=+r,l=+n,u=+i;return o!=o||a!=a||s!=s||l!=l||u!=u?NaN:o===1/0||o===-1/0?o:(o-a)*(u-l)/(s-a)+l}},64310:e=>{e.exports=Math.sign||function(e){return 0==(e=+e)||e!=e?e:e<0?-1:1}},95948:(e,t,r)=>{var n,i,o,a,s,l,u,c,h=r(17854),d=r(49974),f=r(31236).f,p=r(20261).set,m=r(6833),g=r(71528),v=r(71036),y=r(35268),b=h.MutationObserver||h.WebKitMutationObserver,x=h.document,_=h.process,E=h.Promise,w=f(h,"queueMicrotask"),A=w&&w.value;A||(n=function(){var e,t;for(y&&(e=_.domain)&&e.exit();i;){t=i.fn,i=i.next;try{t()}catch(e){throw i?a():o=void 0,e}}o=void 0,e&&e.enter()},m||y||v||!b||!x?!g&&E&&E.resolve?((u=E.resolve(void 0)).constructor=E,c=d(u.then,u),a=function(){c(n)}):y?a=function(){_.nextTick(n)}:(p=d(p,h),a=function(){p(n)}):(s=!0,l=x.createTextNode(""),new b(n).observe(l,{characterData:!0}),a=function(){l.data=s=!s})),e.exports=A||function(e){var t={fn:e,next:void 0};o&&(o.next=t),i||(i=t,a()),o=t}},13366:(e,t,r)=>{var n=r(17854);e.exports=n.Promise},30133:(e,t,r)=>{var n=r(7392),i=r(47293);e.exports=!!Object.getOwnPropertySymbols&&!i((function(){var e=Symbol();return!String(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&n&&n<41}))},590:(e,t,r)=>{var n=r(47293),i=r(5112),o=r(31913),a=i("iterator");e.exports=!n((function(){var e=new URL("b?a=1&b=2&c=3","http://a"),t=e.searchParams,r="";return e.pathname="c%20d",t.forEach((function(e,n){t.delete("b"),r+=n+e})),o&&!e.toJSON||!t.sort||"http://a/c%20d?a=1&c=3"!==e.href||"3"!==t.get("c")||"a=1"!==String(new URLSearchParams("?a=1"))||!t[a]||"a"!==new URL("https://a@b").username||"b"!==new URLSearchParams(new URLSearchParams("a=b")).get("a")||"xn--e1aybc"!==new URL("http://").host||"#%D0%B1"!==new URL("http://a#").hash||"a1c3"!==r||"x"!==new URL("http://x",void 0).host}))},68536:(e,t,r)=>{var n=r(17854),i=r(60614),o=r(42788),a=n.WeakMap;e.exports=i(a)&&/native code/.test(o(a))},78523:(e,t,r)=>{"use strict";var n=r(19662),i=function(e){var t,r;this.promise=new e((function(e,n){if(void 0!==t||void 0!==r)throw TypeError("Bad Promise constructor");t=e,r=n})),this.resolve=n(t),this.reject=n(r)};e.exports.f=function(e){return new i(e)}},56277:(e,t,r)=>{var n=r(41340);e.exports=function(e,t){return void 0===e?arguments.length<2?"":t:n(e)}},3929:(e,t,r)=>{var n=r(17854),i=r(47850),o=n.TypeError;e.exports=function(e){if(i(e))throw o("The method doesn't accept regular expressions");return e}},77023:(e,t,r)=>{var n=r(17854).isFinite;e.exports=Number.isFinite||function(e){return"number"==typeof e&&n(e)}},2814:(e,t,r)=>{var n=r(17854),i=r(47293),o=r(1702),a=r(41340),s=r(53111).trim,l=r(81361),u=o("".charAt),c=n.parseFloat,h=n.Symbol,d=h&&h.iterator,f=1/c(l+"-0")!=-1/0||d&&!i((function(){c(Object(d))}));e.exports=f?function(e){var t=s(a(e)),r=c(t);return 0===r&&"-"==u(t,0)?-0:r}:c},83009:(e,t,r)=>{var n=r(17854),i=r(47293),o=r(1702),a=r(41340),s=r(53111).trim,l=r(81361),u=n.parseInt,c=n.Symbol,h=c&&c.iterator,d=/^[+-]?0x/i,f=o(d.exec),p=8!==u(l+"08")||22!==u(l+"0x16")||h&&!i((function(){u(Object(h))}));e.exports=p?function(e,t){var r=s(a(e));return u(r,t>>>0||(f(d,r)?16:10))}:u},21574:(e,t,r)=>{"use strict";var n=r(19781),i=r(1702),o=r(46916),a=r(47293),s=r(81956),l=r(25181),u=r(55296),c=r(47908),h=r(68361),d=Object.assign,f=Object.defineProperty,p=i([].concat);e.exports=!d||a((function(){if(n&&1!==d({b:1},d(f({},"a",{enumerable:!0,get:function(){f(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var e={},t={},r=Symbol(),i="abcdefghijklmnopqrst";return e[r]=7,i.split("").forEach((function(e){t[e]=e})),7!=d({},e)[r]||s(d({},t)).join("")!=i}))?function(e,t){for(var r=c(e),i=arguments.length,a=1,d=l.f,f=u.f;i>a;)for(var m,g=h(arguments[a++]),v=d?p(s(g),d(g)):s(g),y=v.length,b=0;y>b;)m=v[b++],n&&!o(f,g,m)||(r[m]=g[m]);return r}:d},70030:(e,t,r)=>{var n,i=r(19670),o=r(36048),a=r(80748),s=r(3501),l=r(60490),u=r(80317),c=r(6200),h=c("IE_PROTO"),d=function(){},f=function(e){return"<script>"+e+"</"+"script>"},p=function(e){e.write(f("")),e.close();var t=e.parentWindow.Object;return e=null,t},m=function(){try{n=new ActiveXObject("htmlfile")}catch(e){}var e,t;m="undefined"!=typeof document?document.domain&&n?p(n):((t=u("iframe")).style.display="none",l.appendChild(t),t.src=String("javascript:"),(e=t.contentWindow.document).open(),e.write(f("document.F=Object")),e.close(),e.F):p(n);for(var r=a.length;r--;)delete m.prototype[a[r]];return m()};s[h]=!0,e.exports=Object.create||function(e,t){var r;return null!==e?(d.prototype=i(e),r=new d,d.prototype=null,r[h]=e):r=m(),void 0===t?r:o.f(r,t)}},36048:(e,t,r)=>{var n=r(19781),i=r(3353),o=r(3070),a=r(19670),s=r(45656),l=r(81956);t.f=n&&!i?Object.defineProperties:function(e,t){a(e);for(var r,n=s(t),i=l(t),u=i.length,c=0;u>c;)o.f(e,r=i[c++],n[r]);return e}},3070:(e,t,r)=>{var n=r(17854),i=r(19781),o=r(64664),a=r(3353),s=r(19670),l=r(34948),u=n.TypeError,c=Object.defineProperty,h=Object.getOwnPropertyDescriptor,d="enumerable",f="configurable",p="writable";t.f=i?a?function(e,t,r){if(s(e),t=l(t),s(r),"function"==typeof e&&"prototype"===t&&"value"in r&&p in r&&!r.writable){var n=h(e,t);n&&n.writable&&(e[t]=r.value,r={configurable:f in r?r.configurable:n.configurable,enumerable:d in r?r.enumerable:n.enumerable,writable:!1})}return c(e,t,r)}:c:function(e,t,r){if(s(e),t=l(t),s(r),o)try{return c(e,t,r)}catch(e){}if("get"in r||"set"in r)throw u("Accessors not supported");return"value"in r&&(e[t]=r.value),e}},31236:(e,t,r)=>{var n=r(19781),i=r(46916),o=r(55296),a=r(79114),s=r(45656),l=r(34948),u=r(92597),c=r(64664),h=Object.getOwnPropertyDescriptor;t.f=n?h:function(e,t){if(e=s(e),t=l(t),c)try{return h(e,t)}catch(e){}if(u(e,t))return a(!i(o.f,e,t),e[t])}},1156:(e,t,r)=>{var n=r(84326),i=r(45656),o=r(8006).f,a=r(41589),s="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];e.exports.f=function(e){return s&&"Window"==n(e)?function(e){try{return o(e)}catch(e){return a(s)}}(e):o(i(e))}},8006:(e,t,r)=>{var n=r(16324),i=r(80748).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return n(e,i)}},25181:(e,t)=>{t.f=Object.getOwnPropertySymbols},79518:(e,t,r)=>{var n=r(17854),i=r(92597),o=r(60614),a=r(47908),s=r(6200),l=r(49920),u=s("IE_PROTO"),c=n.Object,h=c.prototype;e.exports=l?c.getPrototypeOf:function(e){var t=a(e);if(i(t,u))return t[u];var r=t.constructor;return o(r)&&t instanceof r?r.prototype:t instanceof c?h:null}},52050:(e,t,r)=>{var n=r(47293),i=r(70111),o=r(84326),a=r(7556),s=Object.isExtensible,l=n((function(){s(1)}));e.exports=l||a?function(e){return!!i(e)&&((!a||"ArrayBuffer"!=o(e))&&(!s||s(e)))}:s},47976:(e,t,r)=>{var n=r(1702);e.exports=n({}.isPrototypeOf)},16324:(e,t,r)=>{var n=r(1702),i=r(92597),o=r(45656),a=r(41318).indexOf,s=r(3501),l=n([].push);e.exports=function(e,t){var r,n=o(e),u=0,c=[];for(r in n)!i(s,r)&&i(n,r)&&l(c,r);for(;t.length>u;)i(n,r=t[u++])&&(~a(c,r)||l(c,r));return c}},81956:(e,t,r)=>{var n=r(16324),i=r(80748);e.exports=Object.keys||function(e){return n(e,i)}},55296:(e,t)=>{"use strict";var r={}.propertyIsEnumerable,n=Object.getOwnPropertyDescriptor,i=n&&!r.call({1:2},1);t.f=i?function(e){var t=n(this,e);return!!t&&t.enumerable}:r},69026:(e,t,r)=>{"use strict";var n=r(31913),i=r(17854),o=r(47293),a=r(98008);e.exports=n||!o((function(){if(!(a&&a<535)){var e=Math.random();__defineSetter__.call(null,e,(function(){})),delete i[e]}}))},27674:(e,t,r)=>{var n=r(1702),i=r(19670),o=r(96077);e.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,r={};try{(e=n(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(r,[]),t=r instanceof Array}catch(e){}return function(r,n){return i(r),o(n),t?e(r,n):r.__proto__=n,r}}():void 0)},44699:(e,t,r)=>{var n=r(19781),i=r(1702),o=r(81956),a=r(45656),s=i(r(55296).f),l=i([].push),u=function(e){return function(t){for(var r,i=a(t),u=o(i),c=u.length,h=0,d=[];c>h;)r=u[h++],n&&!s(i,r)||l(d,e?[r,i[r]]:i[r]);return d}};e.exports={entries:u(!0),values:u(!1)}},90288:(e,t,r)=>{"use strict";var n=r(51694),i=r(70648);e.exports=n?{}.toString:function(){return"[object "+i(this)+"]"}},92140:(e,t,r)=>{var n=r(17854),i=r(46916),o=r(60614),a=r(70111),s=n.TypeError;e.exports=function(e,t){var r,n;if("string"===t&&o(r=e.toString)&&!a(n=i(r,e)))return n;if(o(r=e.valueOf)&&!a(n=i(r,e)))return n;if("string"!==t&&o(r=e.toString)&&!a(n=i(r,e)))return n;throw s("Can't convert object to primitive value")}},53887:(e,t,r)=>{var n=r(35005),i=r(1702),o=r(8006),a=r(25181),s=r(19670),l=i([].concat);e.exports=n("Reflect","ownKeys")||function(e){var t=o.f(s(e)),r=a.f;return r?l(t,r(e)):t}},40857:(e,t,r)=>{var n=r(17854);e.exports=n},12534:e=>{e.exports=function(e){try{return{error:!1,value:e()}}catch(e){return{error:!0,value:e}}}},69478:(e,t,r)=>{var n=r(19670),i=r(70111),o=r(78523);e.exports=function(e,t){if(n(e),i(t)&&t.constructor===e)return t;var r=o.f(e);return(0,r.resolve)(t),r.promise}},18572:e=>{var t=function(){this.head=null,this.tail=null};t.prototype={add:function(e){var t={item:e,next:null};this.head?this.tail.next=t:this.head=t,this.tail=t},get:function(){var e=this.head;if(e)return this.head=e.next,this.tail===e&&(this.tail=null),e.item}},e.exports=t},12248:(e,t,r)=>{var n=r(31320);e.exports=function(e,t,r){for(var i in t)n(e,i,t[i],r);return e}},31320:(e,t,r)=>{var n=r(17854),i=r(60614),o=r(92597),a=r(68880),s=r(83505),l=r(42788),u=r(29909),c=r(76530).CONFIGURABLE,h=u.get,d=u.enforce,f=String(String).split("String");(e.exports=function(e,t,r,l){var u,h=!!l&&!!l.unsafe,p=!!l&&!!l.enumerable,m=!!l&&!!l.noTargetGet,g=l&&void 0!==l.name?l.name:t;i(r)&&("Symbol("===String(g).slice(0,7)&&(g="["+String(g).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),(!o(r,"name")||c&&r.name!==g)&&a(r,"name",g),(u=d(r)).source||(u.source=f.join("string"==typeof g?g:""))),e!==n?(h?!m&&e[t]&&(p=!0):delete e[t],p?e[t]=r:a(e,t,r)):p?e[t]=r:s(t,r)})(Function.prototype,"toString",(function(){return i(this)&&h(this).source||l(this)}))},38845:(e,t,r)=>{r(51532),r(4129);var n=r(35005),i=r(1702),o=r(72309),a=n("Map"),s=n("WeakMap"),l=i([].push),u=o("metadata"),c=u.store||(u.store=new s),h=function(e,t,r){var n=c.get(e);if(!n){if(!r)return;c.set(e,n=new a)}var i=n.get(t);if(!i){if(!r)return;n.set(t,i=new a)}return i};e.exports={store:c,getMap:h,has:function(e,t,r){var n=h(t,r,!1);return void 0!==n&&n.has(e)},get:function(e,t,r){var n=h(t,r,!1);return void 0===n?void 0:n.get(e)},set:function(e,t,r,n){h(r,n,!0).set(e,t)},keys:function(e,t){var r=h(e,t,!1),n=[];return r&&r.forEach((function(e,t){l(n,t)})),n},toKey:function(e){return void 0===e||"symbol"==typeof e?e:String(e)}}},97651:(e,t,r)=>{var n=r(17854),i=r(46916),o=r(19670),a=r(60614),s=r(84326),l=r(22261),u=n.TypeError;e.exports=function(e,t){var r=e.exec;if(a(r)){var n=i(r,e,t);return null!==n&&o(n),n}if("RegExp"===s(e))return i(l,e,t);throw u("RegExp#exec called on incompatible receiver")}},22261:(e,t,r)=>{"use strict";var n,i,o=r(46916),a=r(1702),s=r(41340),l=r(67066),u=r(52999),c=r(72309),h=r(70030),d=r(29909).get,f=r(9441),p=r(38173),m=c("native-string-replace",String.prototype.replace),g=RegExp.prototype.exec,v=g,y=a("".charAt),b=a("".indexOf),x=a("".replace),_=a("".slice),E=(i=/b*/g,o(g,n=/a/,"a"),o(g,i,"a"),0!==n.lastIndex||0!==i.lastIndex),w=u.BROKEN_CARET,A=void 0!==/()??/.exec("")[1];(E||A||w||f||p)&&(v=function(e){var t,r,n,i,a,u,c,f=this,p=d(f),S=s(e),M=p.raw;if(M)return M.lastIndex=f.lastIndex,t=o(v,M,S),f.lastIndex=M.lastIndex,t;var T=p.groups,C=w&&f.sticky,P=o(l,f),D=f.source,L=0,R=S;if(C&&(P=x(P,"y",""),-1===b(P,"g")&&(P+="g"),R=_(S,f.lastIndex),f.lastIndex>0&&(!f.multiline||f.multiline&&"\n"!==y(S,f.lastIndex-1))&&(D="(?: "+D+")",R=" "+R,L++),r=new RegExp("^(?:"+D+")",P)),A&&(r=new RegExp("^"+D+"$(?!\\s)",P)),E&&(n=f.lastIndex),i=o(g,C?r:f,R),C?i?(i.input=_(i.input,L),i[0]=_(i[0],L),i.index=f.lastIndex,f.lastIndex+=i[0].length):f.lastIndex=0:E&&i&&(f.lastIndex=f.global?i.index+i[0].length:n),A&&i&&i.length>1&&o(m,i[0],r,(function(){for(a=1;a<arguments.length-2;a++)void 0===arguments[a]&&(i[a]=void 0)})),i&&T)for(i.groups=u=h(null),a=0;a<T.length;a++)u[(c=T[a])[0]]=i[c[1]];return i}),e.exports=v},67066:(e,t,r)=>{"use strict";var n=r(19670);e.exports=function(){var e=n(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t}},52999:(e,t,r)=>{var n=r(47293),i=r(17854).RegExp,o=n((function(){var e=i("a","y");return e.lastIndex=2,null!=e.exec("abcd")})),a=o||n((function(){return!i("a","y").sticky})),s=o||n((function(){var e=i("^r","gy");return e.lastIndex=2,null!=e.exec("str")}));e.exports={BROKEN_CARET:s,MISSED_STICKY:a,UNSUPPORTED_Y:o}},9441:(e,t,r)=>{var n=r(47293),i=r(17854).RegExp;e.exports=n((function(){var e=i(".","s");return!(e.dotAll&&e.exec("\n")&&"s"===e.flags)}))},38173:(e,t,r)=>{var n=r(47293),i=r(17854).RegExp;e.exports=n((function(){var e=i("(?<a>b)","g");return"b"!==e.exec("b").groups.a||"bc"!=="b".replace(e,"$<a>c")}))},84488:(e,t,r)=>{var n=r(17854).TypeError;e.exports=function(e){if(null==e)throw n("Can't call method on "+e);return e}},46465:e=>{e.exports=function(e,t){return e===t||e!=e&&t!=t}},81150:e=>{e.exports=Object.is||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}},83505:(e,t,r)=>{var n=r(17854),i=Object.defineProperty;e.exports=function(e,t){try{i(n,e,{value:t,configurable:!0,writable:!0})}catch(r){n[e]=t}return t}},96340:(e,t,r)=>{"use strict";var n=r(35005),i=r(3070),o=r(5112),a=r(19781),s=o("species");e.exports=function(e){var t=n(e),r=i.f;a&&t&&!t[s]&&r(t,s,{configurable:!0,get:function(){return this}})}},58003:(e,t,r)=>{var n=r(3070).f,i=r(92597),o=r(5112)("toStringTag");e.exports=function(e,t,r){e&&!r&&(e=e.prototype),e&&!i(e,o)&&n(e,o,{configurable:!0,value:t})}},6200:(e,t,r)=>{var n=r(72309),i=r(69711),o=n("keys");e.exports=function(e){return o[e]||(o[e]=i(e))}},5465:(e,t,r)=>{var n=r(17854),i=r(83505),o="__core-js_shared__",a=n[o]||i(o,{});e.exports=a},72309:(e,t,r)=>{var n=r(31913),i=r(5465);(e.exports=function(e,t){return i[e]||(i[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.21.1",mode:n?"pure":"global",copyright:" 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.21.1/LICENSE",source:"https://github.com/zloirock/core-js"})},36707:(e,t,r)=>{var n=r(19670),i=r(39483),o=r(5112)("species");e.exports=function(e,t){var r,a=n(e).constructor;return void 0===a||null==(r=n(a)[o])?t:i(r)}},43429:(e,t,r)=>{var n=r(47293);e.exports=function(e){return n((function(){var t=""[e]('"');return t!==t.toLowerCase()||t.split('"').length>3}))}},28710:(e,t,r)=>{var n=r(1702),i=r(19303),o=r(41340),a=r(84488),s=n("".charAt),l=n("".charCodeAt),u=n("".slice),c=function(e){return function(t,r){var n,c,h=o(a(t)),d=i(r),f=h.length;return d<0||d>=f?e?"":void 0:(n=l(h,d))<55296||n>56319||d+1===f||(c=l(h,d+1))<56320||c>57343?e?s(h,d):n:e?u(h,d,d+2):c-56320+(n-55296<<10)+65536}};e.exports={codeAt:c(!1),charAt:c(!0)}},54986:(e,t,r)=>{var n=r(88113);e.exports=/Version\/10(?:\.\d+){1,2}(?: [\w./]+)?(?: Mobile\/\w+)? Safari\//.test(n)},76650:(e,t,r)=>{var n=r(1702),i=r(17466),o=r(41340),a=r(38415),s=r(84488),l=n(a),u=n("".slice),c=Math.ceil,h=function(e){return function(t,r,n){var a,h,d=o(s(t)),f=i(r),p=d.length,m=void 0===n?" ":o(n);return f<=p||""==m?d:((h=l(m,c((a=f-p)/m.length))).length>a&&(h=u(h,0,a)),e?d+h:h+d)}};e.exports={start:h(!1),end:h(!0)}},33197:(e,t,r)=>{"use strict";var n=r(17854),i=r(1702),o=2147483647,a=/[^\0-\u007E]/,s=/[.\u3002\uFF0E\uFF61]/g,l="Overflow: input needs wider integers to process",u=n.RangeError,c=i(s.exec),h=Math.floor,d=String.fromCharCode,f=i("".charCodeAt),p=i([].join),m=i([].push),g=i("".replace),v=i("".split),y=i("".toLowerCase),b=function(e){return e+22+75*(e<26)},x=function(e,t,r){var n=0;for(e=r?h(e/700):e>>1,e+=h(e/t);e>455;)e=h(e/35),n+=36;return h(n+36*e/(e+38))},_=function(e){var t=[];e=function(e){for(var t=[],r=0,n=e.length;r<n;){var i=f(e,r++);if(i>=55296&&i<=56319&&r<n){var o=f(e,r++);56320==(64512&o)?m(t,((1023&i)<<10)+(1023&o)+65536):(m(t,i),r--)}else m(t,i)}return t}(e);var r,n,i=e.length,a=128,s=0,c=72;for(r=0;r<e.length;r++)(n=e[r])<128&&m(t,d(n));var g=t.length,v=g;for(g&&m(t,"-");v<i;){var y=o;for(r=0;r<e.length;r++)(n=e[r])>=a&&n<y&&(y=n);var _=v+1;if(y-a>h((o-s)/_))throw u(l);for(s+=(y-a)*_,a=y,r=0;r<e.length;r++){if((n=e[r])<a&&++s>o)throw u(l);if(n==a){for(var E=s,w=36;;){var A=w<=c?1:w>=c+26?26:w-c;if(E<A)break;var S=E-A,M=36-A;m(t,d(b(A+S%M))),E=h(S/M),w+=36}m(t,d(b(E))),c=x(s,_,v==g),s=0,v++}}s++,a++}return p(t,"")};e.exports=function(e){var t,r,n=[],i=v(g(y(e),s,"."),".");for(t=0;t<i.length;t++)r=i[t],m(n,c(a,r)?"xn--"+_(r):r);return p(n,".")}},38415:(e,t,r)=>{"use strict";var n=r(17854),i=r(19303),o=r(41340),a=r(84488),s=n.RangeError;e.exports=function(e){var t=o(a(this)),r="",n=i(e);if(n<0||n==1/0)throw s("Wrong number of repetitions");for(;n>0;(n>>>=1)&&(t+=t))1&n&&(r+=t);return r}},76091:(e,t,r)=>{var n=r(76530).PROPER,i=r(47293),o=r(81361);e.exports=function(e){return i((function(){return!!o[e]()||""!==""[e]()||n&&o[e].name!==e}))}},53111:(e,t,r)=>{var n=r(1702),i=r(84488),o=r(41340),a=r(81361),s=n("".replace),l="["+a+"]",u=RegExp("^"+l+l+"*"),c=RegExp(l+l+"*$"),h=function(e){return function(t){var r=o(i(t));return 1&e&&(r=s(r,u,"")),2&e&&(r=s(r,c,"")),r}};e.exports={start:h(1),end:h(2),trim:h(3)}},20261:(e,t,r)=>{var n,i,o,a,s=r(17854),l=r(22104),u=r(49974),c=r(60614),h=r(92597),d=r(47293),f=r(60490),p=r(50206),m=r(80317),g=r(48053),v=r(6833),y=r(35268),b=s.setImmediate,x=s.clearImmediate,_=s.process,E=s.Dispatch,w=s.Function,A=s.MessageChannel,S=s.String,M=0,T={},C="onreadystatechange";try{n=s.location}catch(e){}var P=function(e){if(h(T,e)){var t=T[e];delete T[e],t()}},D=function(e){return function(){P(e)}},L=function(e){P(e.data)},R=function(e){s.postMessage(S(e),n.protocol+"//"+n.host)};b&&x||(b=function(e){g(arguments.length,1);var t=c(e)?e:w(e),r=p(arguments,1);return T[++M]=function(){l(t,void 0,r)},i(M),M},x=function(e){delete T[e]},y?i=function(e){_.nextTick(D(e))}:E&&E.now?i=function(e){E.now(D(e))}:A&&!v?(a=(o=new A).port2,o.port1.onmessage=L,i=u(a.postMessage,a)):s.addEventListener&&c(s.postMessage)&&!s.importScripts&&n&&"file:"!==n.protocol&&!d(R)?(i=R,s.addEventListener("message",L,!1)):i=C in m("script")?function(e){f.appendChild(m("script")).onreadystatechange=function(){f.removeChild(this),P(e)}}:function(e){setTimeout(D(e),0)}),e.exports={set:b,clear:x}},50863:(e,t,r)=>{var n=r(1702);e.exports=n(1..valueOf)},51400:(e,t,r)=>{var n=r(19303),i=Math.max,o=Math.min;e.exports=function(e,t){var r=n(e);return r<0?i(r+t,0):o(r,t)}},57067:(e,t,r)=>{var n=r(17854),i=r(19303),o=r(17466),a=n.RangeError;e.exports=function(e){if(void 0===e)return 0;var t=i(e),r=o(t);if(t!==r)throw a("Wrong length or index");return r}},45656:(e,t,r)=>{var n=r(68361),i=r(84488);e.exports=function(e){return n(i(e))}},19303:e=>{var t=Math.ceil,r=Math.floor;e.exports=function(e){var n=+e;return n!=n||0===n?0:(n>0?r:t)(n)}},17466:(e,t,r)=>{var n=r(19303),i=Math.min;e.exports=function(e){return e>0?i(n(e),9007199254740991):0}},47908:(e,t,r)=>{var n=r(17854),i=r(84488),o=n.Object;e.exports=function(e){return o(i(e))}},84590:(e,t,r)=>{var n=r(17854),i=r(73002),o=n.RangeError;e.exports=function(e,t){var r=i(e);if(r%t)throw o("Wrong offset");return r}},73002:(e,t,r)=>{var n=r(17854),i=r(19303),o=n.RangeError;e.exports=function(e){var t=i(e);if(t<0)throw o("The argument can't be less than 0");return t}},57593:(e,t,r)=>{var n=r(17854),i=r(46916),o=r(70111),a=r(52190),s=r(58173),l=r(92140),u=r(5112),c=n.TypeError,h=u("toPrimitive");e.exports=function(e,t){if(!o(e)||a(e))return e;var r,n=s(e,h);if(n){if(void 0===t&&(t="default"),r=i(n,e,t),!o(r)||a(r))return r;throw c("Can't convert object to primitive value")}return void 0===t&&(t="number"),l(e,t)}},34948:(e,t,r)=>{var n=r(57593),i=r(52190);e.exports=function(e){var t=n(e,"string");return i(t)?t:t+""}},51694:(e,t,r)=>{var n={};n[r(5112)("toStringTag")]="z",e.exports="[object z]"===String(n)},41340:(e,t,r)=>{var n=r(17854),i=r(70648),o=n.String;e.exports=function(e){if("Symbol"===i(e))throw TypeError("Cannot convert a Symbol value to a string");return o(e)}},66330:(e,t,r)=>{var n=r(17854).String;e.exports=function(e){try{return n(e)}catch(e){return"Object"}}},19843:(e,t,r)=>{"use strict";var n=r(82109),i=r(17854),o=r(46916),a=r(19781),s=r(63832),l=r(90260),u=r(13331),c=r(25787),h=r(79114),d=r(68880),f=r(55988),p=r(17466),m=r(57067),g=r(84590),v=r(34948),y=r(92597),b=r(70648),x=r(70111),_=r(52190),E=r(70030),w=r(47976),A=r(27674),S=r(8006).f,M=r(97321),T=r(42092).forEach,C=r(96340),P=r(3070),D=r(31236),L=r(29909),R=r(79587),I=L.get,O=L.set,N=P.f,k=D.f,F=Math.round,V=i.RangeError,U=u.ArrayBuffer,B=U.prototype,z=u.DataView,G=l.NATIVE_ARRAY_BUFFER_VIEWS,H=l.TYPED_ARRAY_CONSTRUCTOR,W=l.TYPED_ARRAY_TAG,j=l.TypedArray,q=l.TypedArrayPrototype,X=l.aTypedArrayConstructor,Y=l.isTypedArray,K="BYTES_PER_ELEMENT",Z="Wrong length",Q=function(e,t){X(e);for(var r=0,n=t.length,i=new e(n);n>r;)i[r]=t[r++];return i},J=function(e,t){N(e,t,{get:function(){return I(this)[t]}})},$=function(e){var t;return w(B,e)||"ArrayBuffer"==(t=b(e))||"SharedArrayBuffer"==t},ee=function(e,t){return Y(e)&&!_(t)&&t in e&&f(+t)&&t>=0},te=function(e,t){return t=v(t),ee(e,t)?h(2,e[t]):k(e,t)},re=function(e,t,r){return t=v(t),!(ee(e,t)&&x(r)&&y(r,"value"))||y(r,"get")||y(r,"set")||r.configurable||y(r,"writable")&&!r.writable||y(r,"enumerable")&&!r.enumerable?N(e,t,r):(e[t]=r.value,e)};a?(G||(D.f=te,P.f=re,J(q,"buffer"),J(q,"byteOffset"),J(q,"byteLength"),J(q,"length")),n({target:"Object",stat:!0,forced:!G},{getOwnPropertyDescriptor:te,defineProperty:re}),e.exports=function(e,t,r){var a=e.match(/\d+$/)[0]/8,l=e+(r?"Clamped":"")+"Array",u="get"+e,h="set"+e,f=i[l],v=f,y=v&&v.prototype,b={},_=function(e,t){N(e,t,{get:function(){return function(e,t){var r=I(e);return r.view[u](t*a+r.byteOffset,!0)}(this,t)},set:function(e){return function(e,t,n){var i=I(e);r&&(n=(n=F(n))<0?0:n>255?255:255&n),i.view[h](t*a+i.byteOffset,n,!0)}(this,t,e)},enumerable:!0})};G?s&&(v=t((function(e,t,r,n){return c(e,y),R(x(t)?$(t)?void 0!==n?new f(t,g(r,a),n):void 0!==r?new f(t,g(r,a)):new f(t):Y(t)?Q(v,t):o(M,v,t):new f(m(t)),e,v)})),A&&A(v,j),T(S(f),(function(e){e in v||d(v,e,f[e])})),v.prototype=y):(v=t((function(e,t,r,n){c(e,y);var i,s,l,u=0,h=0;if(x(t)){if(!$(t))return Y(t)?Q(v,t):o(M,v,t);i=t,h=g(r,a);var d=t.byteLength;if(void 0===n){if(d%a)throw V(Z);if((s=d-h)<0)throw V(Z)}else if((s=p(n)*a)+h>d)throw V(Z);l=s/a}else l=m(t),i=new U(s=l*a);for(O(e,{buffer:i,byteOffset:h,byteLength:s,length:l,view:new z(i)});u<l;)_(e,u++)})),A&&A(v,j),y=v.prototype=E(q)),y.constructor!==v&&d(y,"constructor",v),d(y,H,v),W&&d(y,W,l),b[l]=v,n({global:!0,forced:v!=f,sham:!G},b),K in v||d(v,K,a),K in y||d(y,K,a),C(l)}):e.exports=function(){}},63832:(e,t,r)=>{var n=r(17854),i=r(47293),o=r(17072),a=r(90260).NATIVE_ARRAY_BUFFER_VIEWS,s=n.ArrayBuffer,l=n.Int8Array;e.exports=!a||!i((function(){l(1)}))||!i((function(){new l(-1)}))||!o((function(e){new l,new l(null),new l(1.5),new l(e)}),!0)||i((function(){return 1!==new l(new s(2),1,void 0).length}))},43074:(e,t,r)=>{var n=r(97745),i=r(66304);e.exports=function(e,t){return n(i(e),t)}},97321:(e,t,r)=>{var n=r(49974),i=r(46916),o=r(39483),a=r(47908),s=r(26244),l=r(18554),u=r(71246),c=r(97659),h=r(90260).aTypedArrayConstructor;e.exports=function(e){var t,r,d,f,p,m,g=o(this),v=a(e),y=arguments.length,b=y>1?arguments[1]:void 0,x=void 0!==b,_=u(v);if(_&&!c(_))for(m=(p=l(v,_)).next,v=[];!(f=i(m,p)).done;)v.push(f.value);for(x&&y>2&&(b=n(b,arguments[2])),r=s(v),d=new(h(g))(r),t=0;r>t;t++)d[t]=x?b(v[t],t):v[t];return d}},66304:(e,t,r)=>{var n=r(90260),i=r(36707),o=n.TYPED_ARRAY_CONSTRUCTOR,a=n.aTypedArrayConstructor;e.exports=function(e){return a(i(e,e[o]))}},69711:(e,t,r)=>{var n=r(1702),i=0,o=Math.random(),a=n(1..toString);e.exports=function(e){return"Symbol("+(void 0===e?"":e)+")_"+a(++i+o,36)}},43307:(e,t,r)=>{var n=r(30133);e.exports=n&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},3353:(e,t,r)=>{var n=r(19781),i=r(47293);e.exports=n&&i((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype}))},48053:(e,t,r)=>{var n=r(17854).TypeError;e.exports=function(e,t){if(e<t)throw n("Not enough arguments");return e}},6061:(e,t,r)=>{var n=r(5112);t.f=n},5112:(e,t,r)=>{var n=r(17854),i=r(72309),o=r(92597),a=r(69711),s=r(30133),l=r(43307),u=i("wks"),c=n.Symbol,h=c&&c.for,d=l?c:c&&c.withoutSetter||a;e.exports=function(e){if(!o(u,e)||!s&&"string"!=typeof u[e]){var t="Symbol."+e;s&&o(c,e)?u[e]=c[e]:u[e]=l&&h?h(t):d(t)}return u[e]}},81361:e=>{e.exports="\t\n\v\f\r \u2028\u2029\ufeff"},9170:(e,t,r)=>{"use strict";var n=r(82109),i=r(17854),o=r(47976),a=r(79518),s=r(27674),l=r(99920),u=r(70030),c=r(68880),h=r(79114),d=r(77741),f=r(58340),p=r(20408),m=r(56277),g=r(5112),v=r(22914),y=g("toStringTag"),b=i.Error,x=[].push,_=function(e,t){var r,n=arguments.length>2?arguments[2]:void 0,i=o(E,this);s?r=s(new b,i?a(this):E):(r=i?this:u(E),c(r,y,"Error")),void 0!==t&&c(r,"message",m(t)),v&&c(r,"stack",d(r.stack,1)),f(r,n);var l=[];return p(e,x,{that:l}),c(r,"errors",l),r};s?s(_,b):l(_,b,{name:!0});var E=_.prototype=u(b.prototype,{constructor:h(1,_),message:h(1,""),name:h(1,"AggregateError")});n({global:!0},{AggregateError:_})},18264:(e,t,r)=>{"use strict";var n=r(82109),i=r(17854),o=r(13331),a=r(96340),s="ArrayBuffer",l=o.ArrayBuffer;n({global:!0,forced:i.ArrayBuffer!==l},{ArrayBuffer:l}),a(s)},92222:(e,t,r)=>{"use strict";var n=r(82109),i=r(17854),o=r(47293),a=r(43157),s=r(70111),l=r(47908),u=r(26244),c=r(86135),h=r(65417),d=r(81194),f=r(5112),p=r(7392),m=f("isConcatSpreadable"),g=9007199254740991,v="Maximum allowed index exceeded",y=i.TypeError,b=p>=51||!o((function(){var e=[];return e[m]=!1,e.concat()[0]!==e})),x=d("concat"),_=function(e){if(!s(e))return!1;var t=e[m];return void 0!==t?!!t:a(e)};n({target:"Array",proto:!0,forced:!b||!x},{concat:function(e){var t,r,n,i,o,a=l(this),s=h(a,0),d=0;for(t=-1,n=arguments.length;t<n;t++)if(_(o=-1===t?a:arguments[t])){if(d+(i=u(o))>g)throw y(v);for(r=0;r<i;r++,d++)r in o&&c(s,d,o[r])}else{if(d>=g)throw y(v);c(s,d++,o)}return s.length=d,s}})},50545:(e,t,r)=>{var n=r(82109),i=r(1048),o=r(51223);n({target:"Array",proto:!0},{copyWithin:i}),o("copyWithin")},43290:(e,t,r)=>{var n=r(82109),i=r(21285),o=r(51223);n({target:"Array",proto:!0},{fill:i}),o("fill")},57327:(e,t,r)=>{"use strict";var n=r(82109),i=r(42092).filter;n({target:"Array",proto:!0,forced:!r(81194)("filter")},{filter:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}})},34553:(e,t,r)=>{"use strict";var n=r(82109),i=r(42092).findIndex,o=r(51223),a="findIndex",s=!0;a in[]&&Array(1).findIndex((function(){s=!1})),n({target:"Array",proto:!0,forced:s},{findIndex:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),o(a)},69826:(e,t,r)=>{"use strict";var n=r(82109),i=r(42092).find,o=r(51223),a="find",s=!0;a in[]&&Array(1).find((function(){s=!1})),n({target:"Array",proto:!0,forced:s},{find:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),o(a)},86535:(e,t,r)=>{"use strict";var n=r(82109),i=r(6790),o=r(19662),a=r(47908),s=r(26244),l=r(65417);n({target:"Array",proto:!0},{flatMap:function(e){var t,r=a(this),n=s(r);return o(e),(t=l(r,0)).length=i(t,r,r,n,0,1,e,arguments.length>1?arguments[1]:void 0),t}})},84944:(e,t,r)=>{"use strict";var n=r(82109),i=r(6790),o=r(47908),a=r(26244),s=r(19303),l=r(65417);n({target:"Array",proto:!0},{flat:function(){var e=arguments.length?arguments[0]:void 0,t=o(this),r=a(t),n=l(t,0);return n.length=i(n,t,t,r,0,void 0===e?1:s(e)),n}})},91038:(e,t,r)=>{var n=r(82109),i=r(48457);n({target:"Array",stat:!0,forced:!r(17072)((function(e){Array.from(e)}))},{from:i})},26699:(e,t,r)=>{"use strict";var n=r(82109),i=r(41318).includes,o=r(51223);n({target:"Array",proto:!0},{includes:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),o("includes")},66992:(e,t,r)=>{"use strict";var n=r(45656),i=r(51223),o=r(97497),a=r(29909),s=r(3070).f,l=r(70654),u=r(31913),c=r(19781),h="Array Iterator",d=a.set,f=a.getterFor(h);e.exports=l(Array,"Array",(function(e,t){d(this,{type:h,target:n(e),index:0,kind:t})}),(function(){var e=f(this),t=e.target,r=e.kind,n=e.index++;return!t||n>=t.length?(e.target=void 0,{value:void 0,done:!0}):"keys"==r?{value:n,done:!1}:"values"==r?{value:t[n],done:!1}:{value:[n,t[n]],done:!1}}),"values");var p=o.Arguments=o.Array;if(i("keys"),i("values"),i("entries"),!u&&c&&"values"!==p.name)try{s(p,"name",{value:"values"})}catch(e){}},69600:(e,t,r)=>{"use strict";var n=r(82109),i=r(1702),o=r(68361),a=r(45656),s=r(9341),l=i([].join),u=o!=Object,c=s("join",",");n({target:"Array",proto:!0,forced:u||!c},{join:function(e){return l(a(this),void 0===e?",":e)}})},21249:(e,t,r)=>{"use strict";var n=r(82109),i=r(42092).map;n({target:"Array",proto:!0,forced:!r(81194)("map")},{map:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}})},26572:(e,t,r)=>{"use strict";var n=r(82109),i=r(17854),o=r(47293),a=r(4411),s=r(86135),l=i.Array;n({target:"Array",stat:!0,forced:o((function(){function e(){}return!(l.of.call(e)instanceof e)}))},{of:function(){for(var e=0,t=arguments.length,r=new(a(this)?this:l)(t);t>e;)s(r,e,arguments[e++]);return r.length=t,r}})},47042:(e,t,r)=>{"use strict";var n=r(82109),i=r(17854),o=r(43157),a=r(4411),s=r(70111),l=r(51400),u=r(26244),c=r(45656),h=r(86135),d=r(5112),f=r(81194),p=r(50206),m=f("slice"),g=d("species"),v=i.Array,y=Math.max;n({target:"Array",proto:!0,forced:!m},{slice:function(e,t){var r,n,i,d=c(this),f=u(d),m=l(e,f),b=l(void 0===t?f:t,f);if(o(d)&&(r=d.constructor,(a(r)&&(r===v||o(r.prototype))||s(r)&&null===(r=r[g]))&&(r=void 0),r===v||void 0===r))return p(d,m,b);for(n=new(void 0===r?v:r)(y(b-m,0)),i=0;m<b;m++,i++)m in d&&h(n,i,d[m]);return n.length=i,n}})},2707:(e,t,r)=>{"use strict";var n=r(82109),i=r(1702),o=r(19662),a=r(47908),s=r(26244),l=r(41340),u=r(47293),c=r(94362),h=r(9341),d=r(68886),f=r(30256),p=r(7392),m=r(98008),g=[],v=i(g.sort),y=i(g.push),b=u((function(){g.sort(void 0)})),x=u((function(){g.sort(null)})),_=h("sort"),E=!u((function(){if(p)return p<70;if(!(d&&d>3)){if(f)return!0;if(m)return m<603;var e,t,r,n,i="";for(e=65;e<76;e++){switch(t=String.fromCharCode(e),e){case 66:case 69:case 70:case 72:r=3;break;case 68:case 71:r=4;break;default:r=2}for(n=0;n<47;n++)g.push({k:t+n,v:r})}for(g.sort((function(e,t){return t.v-e.v})),n=0;n<g.length;n++)t=g[n].k.charAt(0),i.charAt(i.length-1)!==t&&(i+=t);return"DGBEFHACIJK"!==i}}));n({target:"Array",proto:!0,forced:b||!x||!_||!E},{sort:function(e){void 0!==e&&o(e);var t=a(this);if(E)return void 0===e?v(t):v(t,e);var r,n,i=[],u=s(t);for(n=0;n<u;n++)n in t&&y(i,t[n]);for(c(i,function(e){return function(t,r){return void 0===r?-1:void 0===t?1:void 0!==e?+e(t,r)||0:l(t)>l(r)?1:-1}}(e)),r=i.length,n=0;n<r;)t[n]=i[n++];for(;n<u;)delete t[n++];return t}})},38706:(e,t,r)=>{r(96340)("Array")},40561:(e,t,r)=>{"use strict";var n=r(82109),i=r(17854),o=r(51400),a=r(19303),s=r(26244),l=r(47908),u=r(65417),c=r(86135),h=r(81194)("splice"),d=i.TypeError,f=Math.max,p=Math.min,m=9007199254740991,g="Maximum allowed length exceeded";n({target:"Array",proto:!0,forced:!h},{splice:function(e,t){var r,n,i,h,v,y,b=l(this),x=s(b),_=o(e,x),E=arguments.length;if(0===E?r=n=0:1===E?(r=0,n=x-_):(r=E-2,n=p(f(a(t),0),x-_)),x+r-n>m)throw d(g);for(i=u(b,n),h=0;h<n;h++)(v=_+h)in b&&c(i,h,b[v]);if(i.length=n,r<n){for(h=_;h<x-n;h++)y=h+r,(v=h+n)in b?b[y]=b[v]:delete b[y];for(h=x;h>x-n+r;h--)delete b[h-1]}else if(r>n)for(h=x-n;h>_;h--)y=h+r-1,(v=h+n-1)in b?b[y]=b[v]:delete b[y];for(h=0;h<r;h++)b[h+_]=arguments[h+2];return b.length=x-n+r,i}})},99244:(e,t,r)=>{r(51223)("flatMap")},33792:(e,t,r)=>{r(51223)("flat")},96078:(e,t,r)=>{var n=r(92597),i=r(31320),o=r(38709),a=r(5112)("toPrimitive"),s=Date.prototype;n(s,a)||i(s,a,o)},4855:(e,t,r)=>{"use strict";var n=r(60614),i=r(70111),o=r(3070),a=r(79518),s=r(5112)("hasInstance"),l=Function.prototype;s in l||o.f(l,s,{value:function(e){if(!n(this)||!i(e))return!1;var t=this.prototype;if(!i(t))return e instanceof this;for(;e=a(e);)if(t===e)return!0;return!1}})},68309:(e,t,r)=>{var n=r(19781),i=r(76530).EXISTS,o=r(1702),a=r(3070).f,s=Function.prototype,l=o(s.toString),u=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,c=o(u.exec);n&&!i&&a(s,"name",{configurable:!0,get:function(){try{return c(u,l(this))[1]}catch(e){return""}}})},35837:(e,t,r)=>{r(82109)({global:!0},{globalThis:r(17854)})},73706:(e,t,r)=>{var n=r(17854);r(58003)(n.JSON,"JSON",!0)},51532:(e,t,r)=>{"use strict";r(77710)("Map",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),r(95631))},99752:(e,t,r)=>{var n=r(82109),i=r(26513),o=Math.acosh,a=Math.log,s=Math.sqrt,l=Math.LN2;n({target:"Math",stat:!0,forced:!o||710!=Math.floor(o(Number.MAX_VALUE))||o(1/0)!=1/0},{acosh:function(e){return(e=+e)<1?NaN:e>94906265.62425156?a(e)+l:i(e-1+s(e-1)*s(e+1))}})},82376:(e,t,r)=>{var n=r(82109),i=Math.asinh,o=Math.log,a=Math.sqrt;n({target:"Math",stat:!0,forced:!(i&&1/i(0)>0)},{asinh:function e(t){return isFinite(t=+t)&&0!=t?t<0?-e(-t):o(t+a(t*t+1)):t}})},73181:(e,t,r)=>{var n=r(82109),i=Math.atanh,o=Math.log;n({target:"Math",stat:!0,forced:!(i&&1/i(-0)<0)},{atanh:function(e){return 0==(e=+e)?e:o((1+e)/(1-e))/2}})},23484:(e,t,r)=>{var n=r(82109),i=r(64310),o=Math.abs,a=Math.pow;n({target:"Math",stat:!0},{cbrt:function(e){return i(e=+e)*a(o(e),1/3)}})},2388:(e,t,r)=>{var n=r(82109),i=Math.floor,o=Math.log,a=Math.LOG2E;n({target:"Math",stat:!0},{clz32:function(e){return(e>>>=0)?31-i(o(e+.5)*a):32}})},88621:(e,t,r)=>{var n=r(82109),i=r(66736),o=Math.cosh,a=Math.abs,s=Math.E;n({target:"Math",stat:!0,forced:!o||o(710)===1/0},{cosh:function(e){var t=i(a(e)-1)+1;return(t+1/(t*s*s))*(s/2)}})},60403:(e,t,r)=>{var n=r(82109),i=r(66736);n({target:"Math",stat:!0,forced:i!=Math.expm1},{expm1:i})},84755:(e,t,r)=>{r(82109)({target:"Math",stat:!0},{fround:r(26130)})},25438:(e,t,r)=>{var n=r(82109),i=Math.hypot,o=Math.abs,a=Math.sqrt;n({target:"Math",stat:!0,forced:!!i&&i(1/0,NaN)!==1/0},{hypot:function(e,t){for(var r,n,i=0,s=0,l=arguments.length,u=0;s<l;)u<(r=o(arguments[s++]))?(i=i*(n=u/r)*n+1,u=r):i+=r>0?(n=r/u)*n:r;return u===1/0?1/0:u*a(i)}})},90332:(e,t,r)=>{var n=r(82109),i=r(47293),o=Math.imul;n({target:"Math",stat:!0,forced:i((function(){return-5!=o(4294967295,5)||2!=o.length}))},{imul:function(e,t){var r=65535,n=+e,i=+t,o=r&n,a=r&i;return 0|o*a+((r&n>>>16)*a+o*(r&i>>>16)<<16>>>0)}})},40658:(e,t,r)=>{r(82109)({target:"Math",stat:!0},{log10:r(20403)})},40197:(e,t,r)=>{r(82109)({target:"Math",stat:!0},{log1p:r(26513)})},44914:(e,t,r)=>{var n=r(82109),i=Math.log,o=Math.LN2;n({target:"Math",stat:!0},{log2:function(e){return i(e)/o}})},52420:(e,t,r)=>{r(82109)({target:"Math",stat:!0},{sign:r(64310)})},60160:(e,t,r)=>{var n=r(82109),i=r(47293),o=r(66736),a=Math.abs,s=Math.exp,l=Math.E;n({target:"Math",stat:!0,forced:i((function(){return-2e-17!=Math.sinh(-2e-17)}))},{sinh:function(e){return a(e=+e)<1?(o(e)-o(-e))/2:(s(e-1)-s(-e-1))*(l/2)}})},60970:(e,t,r)=>{var n=r(82109),i=r(66736),o=Math.exp;n({target:"Math",stat:!0},{tanh:function(e){var t=i(e=+e),r=i(-e);return t==1/0?1:r==1/0?-1:(t-r)/(o(e)+o(-e))}})},10408:(e,t,r)=>{r(58003)(Math,"Math",!0)},73689:(e,t,r)=>{var n=r(82109),i=Math.ceil,o=Math.floor;n({target:"Math",stat:!0},{trunc:function(e){return(e>0?o:i)(e)}})},9653:(e,t,r)=>{"use strict";var n=r(19781),i=r(17854),o=r(1702),a=r(54705),s=r(31320),l=r(92597),u=r(79587),c=r(47976),h=r(52190),d=r(57593),f=r(47293),p=r(8006).f,m=r(31236).f,g=r(3070).f,v=r(50863),y=r(53111).trim,b="Number",x=i.Number,_=x.prototype,E=i.TypeError,w=o("".slice),A=o("".charCodeAt),S=function(e){var t=d(e,"number");return"bigint"==typeof t?t:M(t)},M=function(e){var t,r,n,i,o,a,s,l,u=d(e,"number");if(h(u))throw E("Cannot convert a Symbol value to a number");if("string"==typeof u&&u.length>2)if(u=y(u),43===(t=A(u,0))||45===t){if(88===(r=A(u,2))||120===r)return NaN}else if(48===t){switch(A(u,1)){case 66:case 98:n=2,i=49;break;case 79:case 111:n=8,i=55;break;default:return+u}for(a=(o=w(u,2)).length,s=0;s<a;s++)if((l=A(o,s))<48||l>i)return NaN;return parseInt(o,n)}return+u};if(a(b,!x(" 0o1")||!x("0b1")||x("+0x1"))){for(var T,C=function(e){var t=arguments.length<1?0:x(S(e)),r=this;return c(_,r)&&f((function(){v(r)}))?u(Object(t),r,C):t},P=n?p(x):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),D=0;P.length>D;D++)l(x,T=P[D])&&!l(C,T)&&g(C,T,m(x,T));C.prototype=_,_.constructor=C,s(i,b,C)}},93299:(e,t,r)=>{r(82109)({target:"Number",stat:!0},{EPSILON:Math.pow(2,-52)})},35192:(e,t,r)=>{r(82109)({target:"Number",stat:!0},{isFinite:r(77023)})},33161:(e,t,r)=>{r(82109)({target:"Number",stat:!0},{isInteger:r(55988)})},44048:(e,t,r)=>{r(82109)({target:"Number",stat:!0},{isNaN:function(e){return e!=e}})},78285:(e,t,r)=>{var n=r(82109),i=r(55988),o=Math.abs;n({target:"Number",stat:!0},{isSafeInteger:function(e){return i(e)&&o(e)<=9007199254740991}})},44363:(e,t,r)=>{r(82109)({target:"Number",stat:!0},{MAX_SAFE_INTEGER:9007199254740991})},55994:(e,t,r)=>{r(82109)({target:"Number",stat:!0},{MIN_SAFE_INTEGER:-9007199254740991})},61874:(e,t,r)=>{var n=r(82109),i=r(2814);n({target:"Number",stat:!0,forced:Number.parseFloat!=i},{parseFloat:i})},9494:(e,t,r)=>{var n=r(82109),i=r(83009);n({target:"Number",stat:!0,forced:Number.parseInt!=i},{parseInt:i})},56977:(e,t,r)=>{"use strict";var n=r(82109),i=r(17854),o=r(1702),a=r(19303),s=r(50863),l=r(38415),u=r(47293),c=i.RangeError,h=i.String,d=Math.floor,f=o(l),p=o("".slice),m=o(1..toFixed),g=function(e,t,r){return 0===t?r:t%2==1?g(e,t-1,r*e):g(e*e,t/2,r)},v=function(e,t,r){for(var n=-1,i=r;++n<6;)i+=t*e[n],e[n]=i%1e7,i=d(i/1e7)},y=function(e,t){for(var r=6,n=0;--r>=0;)n+=e[r],e[r]=d(n/t),n=n%t*1e7},b=function(e){for(var t=6,r="";--t>=0;)if(""!==r||0===t||0!==e[t]){var n=h(e[t]);r=""===r?n:r+f("0",7-n.length)+n}return r};n({target:"Number",proto:!0,forced:u((function(){return"0.000"!==m(8e-5,3)||"1"!==m(.9,0)||"1.25"!==m(1.255,2)||"1000000000000000128"!==m(0xde0b6b3a7640080,0)}))||!u((function(){m({})}))},{toFixed:function(e){var t,r,n,i,o=s(this),l=a(e),u=[0,0,0,0,0,0],d="",m="0";if(l<0||l>20)throw c("Incorrect fraction digits");if(o!=o)return"NaN";if(o<=-1e21||o>=1e21)return h(o);if(o<0&&(d="-",o=-o),o>1e-21)if(r=(t=function(e){for(var t=0,r=e;r>=4096;)t+=12,r/=4096;for(;r>=2;)t+=1,r/=2;return t}(o*g(2,69,1))-69)<0?o*g(2,-t,1):o/g(2,t,1),r*=4503599627370496,(t=52-t)>0){for(v(u,0,r),n=l;n>=7;)v(u,1e7,0),n-=7;for(v(u,g(10,n,1),0),n=t-1;n>=23;)y(u,1<<23),n-=23;y(u,1<<n),v(u,1,1),y(u,2),m=b(u)}else v(u,0,r),v(u,1<<-t,0),m=b(u)+f("0",l);return m=l>0?d+((i=m.length)<=l?"0."+f("0",l-i)+m:p(m,0,i-l)+"."+p(m,i-l)):d+m}})},19601:(e,t,r)=>{var n=r(82109),i=r(21574);n({target:"Object",stat:!0,forced:Object.assign!==i},{assign:i})},59595:(e,t,r)=>{"use strict";var n=r(82109),i=r(19781),o=r(69026),a=r(19662),s=r(47908),l=r(3070);i&&n({target:"Object",proto:!0,forced:o},{__defineGetter__:function(e,t){l.f(s(this),e,{get:a(t),enumerable:!0,configurable:!0})}})},35500:(e,t,r)=>{"use strict";var n=r(82109),i=r(19781),o=r(69026),a=r(19662),s=r(47908),l=r(3070);i&&n({target:"Object",proto:!0,forced:o},{__defineSetter__:function(e,t){l.f(s(this),e,{set:a(t),enumerable:!0,configurable:!0})}})},69720:(e,t,r)=>{var n=r(82109),i=r(44699).entries;n({target:"Object",stat:!0},{entries:function(e){return i(e)}})},43371:(e,t,r)=>{var n=r(82109),i=r(76677),o=r(47293),a=r(70111),s=r(62423).onFreeze,l=Object.freeze;n({target:"Object",stat:!0,forced:o((function(){l(1)})),sham:!i},{freeze:function(e){return l&&a(e)?l(s(e)):e}})},38559:(e,t,r)=>{var n=r(82109),i=r(20408),o=r(86135);n({target:"Object",stat:!0},{fromEntries:function(e){var t={};return i(e,(function(e,r){o(t,e,r)}),{AS_ENTRIES:!0}),t}})},38880:(e,t,r)=>{var n=r(82109),i=r(47293),o=r(45656),a=r(31236).f,s=r(19781),l=i((function(){a(1)}));n({target:"Object",stat:!0,forced:!s||l,sham:!s},{getOwnPropertyDescriptor:function(e,t){return a(o(e),t)}})},49337:(e,t,r)=>{var n=r(82109),i=r(19781),o=r(53887),a=r(45656),s=r(31236),l=r(86135);n({target:"Object",stat:!0,sham:!i},{getOwnPropertyDescriptors:function(e){for(var t,r,n=a(e),i=s.f,u=o(n),c={},h=0;u.length>h;)void 0!==(r=i(n,t=u[h++]))&&l(c,t,r);return c}})},36210:(e,t,r)=>{var n=r(82109),i=r(47293),o=r(1156).f;n({target:"Object",stat:!0,forced:i((function(){return!Object.getOwnPropertyNames(1)}))},{getOwnPropertyNames:o})},30489:(e,t,r)=>{var n=r(82109),i=r(47293),o=r(47908),a=r(79518),s=r(49920);n({target:"Object",stat:!0,forced:i((function(){a(1)})),sham:!s},{getPrototypeOf:function(e){return a(o(e))}})},41825:(e,t,r)=>{var n=r(82109),i=r(52050);n({target:"Object",stat:!0,forced:Object.isExtensible!==i},{isExtensible:i})},98410:(e,t,r)=>{var n=r(82109),i=r(47293),o=r(70111),a=r(84326),s=r(7556),l=Object.isFrozen;n({target:"Object",stat:!0,forced:i((function(){l(1)}))||s},{isFrozen:function(e){return!o(e)||(!(!s||"ArrayBuffer"!=a(e))||!!l&&l(e))}})},72200:(e,t,r)=>{var n=r(82109),i=r(47293),o=r(70111),a=r(84326),s=r(7556),l=Object.isSealed;n({target:"Object",stat:!0,forced:i((function(){l(1)}))||s},{isSealed:function(e){return!o(e)||(!(!s||"ArrayBuffer"!=a(e))||!!l&&l(e))}})},43304:(e,t,r)=>{r(82109)({target:"Object",stat:!0},{is:r(81150)})},47941:(e,t,r)=>{var n=r(82109),i=r(47908),o=r(81956);n({target:"Object",stat:!0,forced:r(47293)((function(){o(1)}))},{keys:function(e){return o(i(e))}})},94869:(e,t,r)=>{"use strict";var n=r(82109),i=r(19781),o=r(69026),a=r(47908),s=r(34948),l=r(79518),u=r(31236).f;i&&n({target:"Object",proto:!0,forced:o},{__lookupGetter__:function(e){var t,r=a(this),n=s(e);do{if(t=u(r,n))return t.get}while(r=l(r))}})},33952:(e,t,r)=>{"use strict";var n=r(82109),i=r(19781),o=r(69026),a=r(47908),s=r(34948),l=r(79518),u=r(31236).f;i&&n({target:"Object",proto:!0,forced:o},{__lookupSetter__:function(e){var t,r=a(this),n=s(e);do{if(t=u(r,n))return t.set}while(r=l(r))}})},57227:(e,t,r)=>{var n=r(82109),i=r(70111),o=r(62423).onFreeze,a=r(76677),s=r(47293),l=Object.preventExtensions;n({target:"Object",stat:!0,forced:s((function(){l(1)})),sham:!a},{preventExtensions:function(e){return l&&i(e)?l(o(e)):e}})},60514:(e,t,r)=>{var n=r(82109),i=r(70111),o=r(62423).onFreeze,a=r(76677),s=r(47293),l=Object.seal;n({target:"Object",stat:!0,forced:s((function(){l(1)})),sham:!a},{seal:function(e){return l&&i(e)?l(o(e)):e}})},41539:(e,t,r)=>{var n=r(51694),i=r(31320),o=r(90288);n||i(Object.prototype,"toString",o,{unsafe:!0})},26833:(e,t,r)=>{var n=r(82109),i=r(44699).values;n({target:"Object",stat:!0},{values:function(e){return i(e)}})},17922:(e,t,r)=>{"use strict";var n=r(82109),i=r(46916),o=r(19662),a=r(78523),s=r(12534),l=r(20408);n({target:"Promise",stat:!0},{allSettled:function(e){var t=this,r=a.f(t),n=r.resolve,u=r.reject,c=s((function(){var r=o(t.resolve),a=[],s=0,u=1;l(e,(function(e){var o=s++,l=!1;u++,i(r,t,e).then((function(e){l||(l=!0,a[o]={status:"fulfilled",value:e},--u||n(a))}),(function(e){l||(l=!0,a[o]={status:"rejected",reason:e},--u||n(a))}))})),--u||n(a)}));return c.error&&u(c.value),r.promise}})},34668:(e,t,r)=>{"use strict";var n=r(82109),i=r(19662),o=r(35005),a=r(46916),s=r(78523),l=r(12534),u=r(20408),c="No one promise resolved";n({target:"Promise",stat:!0},{any:function(e){var t=this,r=o("AggregateError"),n=s.f(t),h=n.resolve,d=n.reject,f=l((function(){var n=i(t.resolve),o=[],s=0,l=1,f=!1;u(e,(function(e){var i=s++,u=!1;l++,a(n,t,e).then((function(e){u||f||(f=!0,h(e))}),(function(e){u||f||(u=!0,o[i]=e,--l||d(new r(o,c)))}))})),--l||d(new r(o,c))}));return f.error&&d(f.value),n.promise}})},17727:(e,t,r)=>{"use strict";var n=r(82109),i=r(31913),o=r(13366),a=r(47293),s=r(35005),l=r(60614),u=r(36707),c=r(69478),h=r(31320);if(n({target:"Promise",proto:!0,real:!0,forced:!!o&&a((function(){o.prototype.finally.call({then:function(){}},(function(){}))}))},{finally:function(e){var t=u(this,s("Promise")),r=l(e);return this.then(r?function(r){return c(t,e()).then((function(){return r}))}:e,r?function(r){return c(t,e()).then((function(){throw r}))}:e)}}),!i&&l(o)){var d=s("Promise").prototype.finally;o.prototype.finally!==d&&h(o.prototype,"finally",d,{unsafe:!0})}},88674:(e,t,r)=>{"use strict";var n,i,o,a,s=r(82109),l=r(31913),u=r(17854),c=r(35005),h=r(46916),d=r(13366),f=r(31320),p=r(12248),m=r(27674),g=r(58003),v=r(96340),y=r(19662),b=r(60614),x=r(70111),_=r(25787),E=r(42788),w=r(20408),A=r(17072),S=r(36707),M=r(20261).set,T=r(95948),C=r(69478),P=r(842),D=r(78523),L=r(12534),R=r(18572),I=r(29909),O=r(54705),N=r(5112),k=r(7871),F=r(35268),V=r(7392),U=N("species"),B="Promise",z=I.getterFor(B),G=I.set,H=I.getterFor(B),W=d&&d.prototype,j=d,q=W,X=u.TypeError,Y=u.document,K=u.process,Z=D.f,Q=Z,J=!!(Y&&Y.createEvent&&u.dispatchEvent),$=b(u.PromiseRejectionEvent),ee="unhandledrejection",te=!1,re=O(B,(function(){var e=E(j),t=e!==String(j);if(!t&&66===V)return!0;if(l&&!q.finally)return!0;if(V>=51&&/native code/.test(e))return!1;var r=new j((function(e){e(1)})),n=function(e){e((function(){}),(function(){}))};return(r.constructor={})[U]=n,!(te=r.then((function(){}))instanceof n)||!t&&k&&!$})),ne=re||!A((function(e){j.all(e).catch((function(){}))})),ie=function(e){var t;return!(!x(e)||!b(t=e.then))&&t},oe=function(e,t){var r,n,i,o=t.value,a=1==t.state,s=a?e.ok:e.fail,l=e.resolve,u=e.reject,c=e.domain;try{s?(a||(2===t.rejection&&ce(t),t.rejection=1),!0===s?r=o:(c&&c.enter(),r=s(o),c&&(c.exit(),i=!0)),r===e.promise?u(X("Promise-chain cycle")):(n=ie(r))?h(n,r,l,u):l(r)):u(o)}catch(e){c&&!i&&c.exit(),u(e)}},ae=function(e,t){e.notified||(e.notified=!0,T((function(){for(var r,n=e.reactions;r=n.get();)oe(r,e);e.notified=!1,t&&!e.rejection&&le(e)})))},se=function(e,t,r){var n,i;J?((n=Y.createEvent("Event")).promise=t,n.reason=r,n.initEvent(e,!1,!0),u.dispatchEvent(n)):n={promise:t,reason:r},!$&&(i=u["on"+e])?i(n):e===ee&&P("Unhandled promise rejection",r)},le=function(e){h(M,u,(function(){var t,r=e.facade,n=e.value;if(ue(e)&&(t=L((function(){F?K.emit("unhandledRejection",n,r):se(ee,r,n)})),e.rejection=F||ue(e)?2:1,t.error))throw t.value}))},ue=function(e){return 1!==e.rejection&&!e.parent},ce=function(e){h(M,u,(function(){var t=e.facade;F?K.emit("rejectionHandled",t):se("rejectionhandled",t,e.value)}))},he=function(e,t,r){return function(n){e(t,n,r)}},de=function(e,t,r){e.done||(e.done=!0,r&&(e=r),e.value=t,e.state=2,ae(e,!0))},fe=function(e,t,r){if(!e.done){e.done=!0,r&&(e=r);try{if(e.facade===t)throw X("Promise can't be resolved itself");var n=ie(t);n?T((function(){var r={done:!1};try{h(n,t,he(fe,r,e),he(de,r,e))}catch(t){de(r,t,e)}})):(e.value=t,e.state=1,ae(e,!1))}catch(t){de({done:!1},t,e)}}};if(re&&(q=(j=function(e){_(this,q),y(e),h(n,this);var t=z(this);try{e(he(fe,t),he(de,t))}catch(e){de(t,e)}}).prototype,(n=function(e){G(this,{type:B,done:!1,notified:!1,parent:!1,reactions:new R,rejection:!1,state:0,value:void 0})}).prototype=p(q,{then:function(e,t){var r=H(this),n=Z(S(this,j));return r.parent=!0,n.ok=!b(e)||e,n.fail=b(t)&&t,n.domain=F?K.domain:void 0,0==r.state?r.reactions.add(n):T((function(){oe(n,r)})),n.promise},catch:function(e){return this.then(void 0,e)}}),i=function(){var e=new n,t=z(e);this.promise=e,this.resolve=he(fe,t),this.reject=he(de,t)},D.f=Z=function(e){return e===j||e===o?new i(e):Q(e)},!l&&b(d)&&W!==Object.prototype)){a=W.then,te||(f(W,"then",(function(e,t){var r=this;return new j((function(e,t){h(a,r,e,t)})).then(e,t)}),{unsafe:!0}),f(W,"catch",q.catch,{unsafe:!0}));try{delete W.constructor}catch(e){}m&&m(W,q)}s({global:!0,wrap:!0,forced:re},{Promise:j}),g(j,B,!1,!0),v(B),o=c(B),s({target:B,stat:!0,forced:re},{reject:function(e){var t=Z(this);return h(t.reject,void 0,e),t.promise}}),s({target:B,stat:!0,forced:l||re},{resolve:function(e){return C(l&&this===o?j:this,e)}}),s({target:B,stat:!0,forced:ne},{all:function(e){var t=this,r=Z(t),n=r.resolve,i=r.reject,o=L((function(){var r=y(t.resolve),o=[],a=0,s=1;w(e,(function(e){var l=a++,u=!1;s++,h(r,t,e).then((function(e){u||(u=!0,o[l]=e,--s||n(o))}),i)})),--s||n(o)}));return o.error&&i(o.value),r.promise},race:function(e){var t=this,r=Z(t),n=r.reject,i=L((function(){var i=y(t.resolve);w(e,(function(e){h(i,t,e).then(r.resolve,n)}))}));return i.error&&n(i.value),r.promise}})},36535:(e,t,r)=>{var n=r(82109),i=r(22104),o=r(19662),a=r(19670);n({target:"Reflect",stat:!0,forced:!r(47293)((function(){Reflect.apply((function(){}))}))},{apply:function(e,t,r){return i(o(e),t,a(r))}})},12419:(e,t,r)=>{var n=r(82109),i=r(35005),o=r(22104),a=r(27065),s=r(39483),l=r(19670),u=r(70111),c=r(70030),h=r(47293),d=i("Reflect","construct"),f=Object.prototype,p=[].push,m=h((function(){function e(){}return!(d((function(){}),[],e)instanceof e)})),g=!h((function(){d((function(){}))})),v=m||g;n({target:"Reflect",stat:!0,forced:v,sham:v},{construct:function(e,t){s(e),l(t);var r=arguments.length<3?e:s(arguments[2]);if(g&&!m)return d(e,t,r);if(e==r){switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3])}var n=[null];return o(p,n,t),new(o(a,e,n))}var i=r.prototype,h=c(u(i)?i:f),v=o(e,h,t);return u(v)?v:h}})},69596:(e,t,r)=>{var n=r(82109),i=r(19781),o=r(19670),a=r(34948),s=r(3070);n({target:"Reflect",stat:!0,forced:r(47293)((function(){Reflect.defineProperty(s.f({},1,{value:1}),1,{value:2})})),sham:!i},{defineProperty:function(e,t,r){o(e);var n=a(t);o(r);try{return s.f(e,n,r),!0}catch(e){return!1}}})},52586:(e,t,r)=>{var n=r(82109),i=r(19670),o=r(31236).f;n({target:"Reflect",stat:!0},{deleteProperty:function(e,t){var r=o(i(e),t);return!(r&&!r.configurable)&&delete e[t]}})},95683:(e,t,r)=>{var n=r(82109),i=r(19781),o=r(19670),a=r(31236);n({target:"Reflect",stat:!0,sham:!i},{getOwnPropertyDescriptor:function(e,t){return a.f(o(e),t)}})},39361:(e,t,r)=>{var n=r(82109),i=r(19670),o=r(79518);n({target:"Reflect",stat:!0,sham:!r(49920)},{getPrototypeOf:function(e){return o(i(e))}})},74819:(e,t,r)=>{var n=r(82109),i=r(46916),o=r(70111),a=r(19670),s=r(45032),l=r(31236),u=r(79518);n({target:"Reflect",stat:!0},{get:function e(t,r){var n,c,h=arguments.length<3?t:arguments[2];return a(t)===h?t[r]:(n=l.f(t,r))?s(n)?n.value:void 0===n.get?void 0:i(n.get,h):o(c=u(t))?e(c,r,h):void 0}})},51037:(e,t,r)=>{r(82109)({target:"Reflect",stat:!0},{has:function(e,t){return t in e}})},5898:(e,t,r)=>{var n=r(82109),i=r(19670),o=r(52050);n({target:"Reflect",stat:!0},{isExtensible:function(e){return i(e),o(e)}})},67556:(e,t,r)=>{r(82109)({target:"Reflect",stat:!0},{ownKeys:r(53887)})},14361:(e,t,r)=>{var n=r(82109),i=r(35005),o=r(19670);n({target:"Reflect",stat:!0,sham:!r(76677)},{preventExtensions:function(e){o(e);try{var t=i("Object","preventExtensions");return t&&t(e),!0}catch(e){return!1}}})},39532:(e,t,r)=>{var n=r(82109),i=r(19670),o=r(96077),a=r(27674);a&&n({target:"Reflect",stat:!0},{setPrototypeOf:function(e,t){i(e),o(t);try{return a(e,t),!0}catch(e){return!1}}})},83593:(e,t,r)=>{var n=r(82109),i=r(46916),o=r(19670),a=r(70111),s=r(45032),l=r(47293),u=r(3070),c=r(31236),h=r(79518),d=r(79114);n({target:"Reflect",stat:!0,forced:l((function(){var e=function(){},t=u.f(new e,"a",{configurable:!0});return!1!==Reflect.set(e.prototype,"a",1,t)}))},{set:function e(t,r,n){var l,f,p,m=arguments.length<4?t:arguments[3],g=c.f(o(t),r);if(!g){if(a(f=h(t)))return e(f,r,n,m);g=d(0)}if(s(g)){if(!1===g.writable||!a(m))return!1;if(l=c.f(m,r)){if(l.get||l.set||!1===l.writable)return!1;l.value=n,u.f(m,r,l)}else u.f(m,r,d(0,n))}else{if(void 0===(p=g.set))return!1;i(p,m,n)}return!0}})},24603:(e,t,r)=>{var n=r(19781),i=r(17854),o=r(1702),a=r(54705),s=r(79587),l=r(68880),u=r(3070).f,c=r(8006).f,h=r(47976),d=r(47850),f=r(41340),p=r(67066),m=r(52999),g=r(31320),v=r(47293),y=r(92597),b=r(29909).enforce,x=r(96340),_=r(5112),E=r(9441),w=r(38173),A=_("match"),S=i.RegExp,M=S.prototype,T=i.SyntaxError,C=o(p),P=o(M.exec),D=o("".charAt),L=o("".replace),R=o("".indexOf),I=o("".slice),O=/^\?<[^\s\d!#%&*+<=>@^][^\s!#%&*+<=>@^]*>/,N=/a/g,k=/a/g,F=new S(N)!==N,V=m.MISSED_STICKY,U=m.UNSUPPORTED_Y,B=n&&(!F||V||E||w||v((function(){return k[A]=!1,S(N)!=N||S(k)==k||"/a/i"!=S(N,"i")})));if(a("RegExp",B)){for(var z=function(e,t){var r,n,i,o,a,u,c=h(M,this),p=d(e),m=void 0===t,g=[],v=e;if(!c&&p&&m&&e.constructor===z)return e;if((p||h(M,e))&&(e=e.source,m&&(t="flags"in v?v.flags:C(v))),e=void 0===e?"":f(e),t=void 0===t?"":f(t),v=e,E&&"dotAll"in N&&(n=!!t&&R(t,"s")>-1)&&(t=L(t,/s/g,"")),r=t,V&&"sticky"in N&&(i=!!t&&R(t,"y")>-1)&&U&&(t=L(t,/y/g,"")),w&&(o=function(e){for(var t,r=e.length,n=0,i="",o=[],a={},s=!1,l=!1,u=0,c="";n<=r;n++){if("\\"===(t=D(e,n)))t+=D(e,++n);else if("]"===t)s=!1;else if(!s)switch(!0){case"["===t:s=!0;break;case"("===t:P(O,I(e,n+1))&&(n+=2,l=!0),i+=t,u++;continue;case">"===t&&l:if(""===c||y(a,c))throw new T("Invalid capture group name");a[c]=!0,o[o.length]=[c,u],l=!1,c="";continue}l?c+=t:i+=t}return[i,o]}(e),e=o[0],g=o[1]),a=s(S(e,t),c?this:M,z),(n||i||g.length)&&(u=b(a),n&&(u.dotAll=!0,u.raw=z(function(e){for(var t,r=e.length,n=0,i="",o=!1;n<=r;n++)"\\"!==(t=D(e,n))?o||"."!==t?("["===t?o=!0:"]"===t&&(o=!1),i+=t):i+="[\\s\\S]":i+=t+D(e,++n);return i}(e),r)),i&&(u.sticky=!0),g.length&&(u.groups=g)),e!==v)try{l(a,"source",""===v?"(?:)":v)}catch(e){}return a},G=function(e){e in z||u(z,e,{configurable:!0,get:function(){return S[e]},set:function(t){S[e]=t}})},H=c(S),W=0;H.length>W;)G(H[W++]);M.constructor=z,z.prototype=M,g(i,"RegExp",z)}x("RegExp")},74916:(e,t,r)=>{"use strict";var n=r(82109),i=r(22261);n({target:"RegExp",proto:!0,forced:/./.exec!==i},{exec:i})},92087:(e,t,r)=>{var n=r(19781),i=r(3070),o=r(67066),a=r(47293),s=RegExp.prototype;n&&a((function(){return"sy"!==Object.getOwnPropertyDescriptor(s,"flags").get.call({dotAll:!0,sticky:!0})}))&&i.f(s,"flags",{configurable:!0,get:o})},39714:(e,t,r)=>{"use strict";var n=r(1702),i=r(76530).PROPER,o=r(31320),a=r(19670),s=r(47976),l=r(41340),u=r(47293),c=r(67066),h="toString",d=RegExp.prototype,f=d.toString,p=n(c),m=u((function(){return"/a/b"!=f.call({source:"a",flags:"b"})})),g=i&&f.name!=h;(m||g)&&o(RegExp.prototype,h,(function(){var e=a(this),t=l(e.source),r=e.flags;return"/"+t+"/"+l(void 0===r&&s(d,e)&&!("flags"in d)?p(e):r)}),{unsafe:!0})},70189:(e,t,r)=>{"use strict";r(77710)("Set",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),r(95631))},15218:(e,t,r)=>{"use strict";var n=r(82109),i=r(14230);n({target:"String",proto:!0,forced:r(43429)("anchor")},{anchor:function(e){return i(this,"a","name",e)}})},74475:(e,t,r)=>{"use strict";var n=r(82109),i=r(14230);n({target:"String",proto:!0,forced:r(43429)("big")},{big:function(){return i(this,"big","","")}})},57929:(e,t,r)=>{"use strict";var n=r(82109),i=r(14230);n({target:"String",proto:!0,forced:r(43429)("blink")},{blink:function(){return i(this,"blink","","")}})},50915:(e,t,r)=>{"use strict";var n=r(82109),i=r(14230);n({target:"String",proto:!0,forced:r(43429)("bold")},{bold:function(){return i(this,"b","","")}})},79841:(e,t,r)=>{"use strict";var n=r(82109),i=r(28710).codeAt;n({target:"String",proto:!0},{codePointAt:function(e){return i(this,e)}})},27852:(e,t,r)=>{"use strict";var n,i=r(82109),o=r(1702),a=r(31236).f,s=r(17466),l=r(41340),u=r(3929),c=r(84488),h=r(84964),d=r(31913),f=o("".endsWith),p=o("".slice),m=Math.min,g=h("endsWith");i({target:"String",proto:!0,forced:!!(d||g||(n=a(String.prototype,"endsWith"),!n||n.writable))&&!g},{endsWith:function(e){var t=l(c(this));u(e);var r=arguments.length>1?arguments[1]:void 0,n=t.length,i=void 0===r?n:m(s(r),n),o=l(e);return f?f(t,o,i):p(t,i-o.length,i)===o}})},29253:(e,t,r)=>{"use strict";var n=r(82109),i=r(14230);n({target:"String",proto:!0,forced:r(43429)("fixed")},{fixed:function(){return i(this,"tt","","")}})},42125:(e,t,r)=>{"use strict";var n=r(82109),i=r(14230);n({target:"String",proto:!0,forced:r(43429)("fontcolor")},{fontcolor:function(e){return i(this,"font","color",e)}})},78830:(e,t,r)=>{"use strict";var n=r(82109),i=r(14230);n({target:"String",proto:!0,forced:r(43429)("fontsize")},{fontsize:function(e){return i(this,"font","size",e)}})},94953:(e,t,r)=>{var n=r(82109),i=r(17854),o=r(1702),a=r(51400),s=i.RangeError,l=String.fromCharCode,u=String.fromCodePoint,c=o([].join);n({target:"String",stat:!0,forced:!!u&&1!=u.length},{fromCodePoint:function(e){for(var t,r=[],n=arguments.length,i=0;n>i;){if(t=+arguments[i++],a(t,1114111)!==t)throw s(t+" is not a valid code point");r[i]=t<65536?l(t):l(55296+((t-=65536)>>10),t%1024+56320)}return c(r,"")}})},32023:(e,t,r)=>{"use strict";var n=r(82109),i=r(1702),o=r(3929),a=r(84488),s=r(41340),l=r(84964),u=i("".indexOf);n({target:"String",proto:!0,forced:!l("includes")},{includes:function(e){return!!~u(s(a(this)),s(o(e)),arguments.length>1?arguments[1]:void 0)}})},58734:(e,t,r)=>{"use strict";var n=r(82109),i=r(14230);n({target:"String",proto:!0,forced:r(43429)("italics")},{italics:function(){return i(this,"i","","")}})},78783:(e,t,r)=>{"use strict";var n=r(28710).charAt,i=r(41340),o=r(29909),a=r(70654),s="String Iterator",l=o.set,u=o.getterFor(s);a(String,"String",(function(e){l(this,{type:s,string:i(e),index:0})}),(function(){var e,t=u(this),r=t.string,i=t.index;return i>=r.length?{value:void 0,done:!0}:(e=n(r,i),t.index+=e.length,{value:e,done:!1})}))},29254:(e,t,r)=>{"use strict";var n=r(82109),i=r(14230);n({target:"String",proto:!0,forced:r(43429)("link")},{link:function(e){return i(this,"a","href",e)}})},76373:(e,t,r)=>{"use strict";var n=r(82109),i=r(17854),o=r(46916),a=r(1702),s=r(24994),l=r(84488),u=r(17466),c=r(41340),h=r(19670),d=r(84326),f=r(47976),p=r(47850),m=r(67066),g=r(58173),v=r(31320),y=r(47293),b=r(5112),x=r(36707),_=r(31530),E=r(97651),w=r(29909),A=r(31913),S=b("matchAll"),M="RegExp String",T="RegExp String Iterator",C=w.set,P=w.getterFor(T),D=RegExp.prototype,L=i.TypeError,R=a(m),I=a("".indexOf),O=a("".matchAll),N=!!O&&!y((function(){O("a",/./)})),k=s((function(e,t,r,n){C(this,{type:T,regexp:e,string:t,global:r,unicode:n,done:!1})}),M,(function(){var e=P(this);if(e.done)return{value:void 0,done:!0};var t=e.regexp,r=e.string,n=E(t,r);return null===n?{value:void 0,done:e.done=!0}:e.global?(""===c(n[0])&&(t.lastIndex=_(r,u(t.lastIndex),e.unicode)),{value:n,done:!1}):(e.done=!0,{value:n,done:!1})})),F=function(e){var t,r,n,i,o,a,s=h(this),l=c(e);return t=x(s,RegExp),void 0===(r=s.flags)&&f(D,s)&&!("flags"in D)&&(r=R(s)),n=void 0===r?"":c(r),i=new t(t===RegExp?s.source:s,n),o=!!~I(n,"g"),a=!!~I(n,"u"),i.lastIndex=u(s.lastIndex),new k(i,l,o,a)};n({target:"String",proto:!0,forced:N},{matchAll:function(e){var t,r,n,i,a=l(this);if(null!=e){if(p(e)&&(t=c(l("flags"in D?e.flags:R(e))),!~I(t,"g")))throw L("`.matchAll` does not allow non-global regexes");if(N)return O(a,e);if(void 0===(n=g(e,S))&&A&&"RegExp"==d(e)&&(n=F),n)return o(n,e,a)}else if(N)return O(a,e);return r=c(a),i=new RegExp(e,"g"),A?o(F,i,r):i[S](r)}}),A||S in D||v(D,S,F)},4723:(e,t,r)=>{"use strict";var n=r(46916),i=r(27007),o=r(19670),a=r(17466),s=r(41340),l=r(84488),u=r(58173),c=r(31530),h=r(97651);i("match",(function(e,t,r){return[function(t){var r=l(this),i=null==t?void 0:u(t,e);return i?n(i,t,r):new RegExp(t)[e](s(r))},function(e){var n=o(this),i=s(e),l=r(t,n,i);if(l.done)return l.value;if(!n.global)return h(n,i);var u=n.unicode;n.lastIndex=0;for(var d,f=[],p=0;null!==(d=h(n,i));){var m=s(d[0]);f[p]=m,""===m&&(n.lastIndex=c(i,a(n.lastIndex),u)),p++}return 0===p?null:f}]}))},66528:(e,t,r)=>{"use strict";var n=r(82109),i=r(76650).end;n({target:"String",proto:!0,forced:r(54986)},{padEnd:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}})},83112:(e,t,r)=>{"use strict";var n=r(82109),i=r(76650).start;n({target:"String",proto:!0,forced:r(54986)},{padStart:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}})},38992:(e,t,r)=>{var n=r(82109),i=r(1702),o=r(45656),a=r(47908),s=r(41340),l=r(26244),u=i([].push),c=i([].join);n({target:"String",stat:!0},{raw:function(e){for(var t=o(a(e).raw),r=l(t),n=arguments.length,i=[],h=0;r>h;){if(u(i,s(t[h++])),h===r)return c(i,"");h<n&&u(i,s(arguments[h]))}}})},82481:(e,t,r)=>{r(82109)({target:"String",proto:!0},{repeat:r(38415)})},68757:(e,t,r)=>{"use strict";var n=r(82109),i=r(17854),o=r(46916),a=r(1702),s=r(84488),l=r(60614),u=r(47850),c=r(41340),h=r(58173),d=r(67066),f=r(10647),p=r(5112),m=r(31913),g=p("replace"),v=RegExp.prototype,y=i.TypeError,b=a(d),x=a("".indexOf),_=a("".replace),E=a("".slice),w=Math.max,A=function(e,t,r){return r>e.length?-1:""===t?r:x(e,t,r)};n({target:"String",proto:!0},{replaceAll:function(e,t){var r,n,i,a,d,p,S,M,T,C=s(this),P=0,D=0,L="";if(null!=e){if((r=u(e))&&(n=c(s("flags"in v?e.flags:b(e))),!~x(n,"g")))throw y("`.replaceAll` does not allow non-global regexes");if(i=h(e,g))return o(i,e,C,t);if(m&&r)return _(c(C),e,t)}for(a=c(C),d=c(e),(p=l(t))||(t=c(t)),S=d.length,M=w(1,S),P=A(a,d,0);-1!==P;)T=p?c(t(d,P,a)):f(d,a,P,[],void 0,t),L+=E(a,D,P)+T,D=P+S,P=A(a,d,P+M);return D<a.length&&(L+=E(a,D)),L}})},15306:(e,t,r)=>{"use strict";var n=r(22104),i=r(46916),o=r(1702),a=r(27007),s=r(47293),l=r(19670),u=r(60614),c=r(19303),h=r(17466),d=r(41340),f=r(84488),p=r(31530),m=r(58173),g=r(10647),v=r(97651),y=r(5112)("replace"),b=Math.max,x=Math.min,_=o([].concat),E=o([].push),w=o("".indexOf),A=o("".slice),S="$0"==="a".replace(/./,"$0"),M=!!/./[y]&&""===/./[y]("a","$0");a("replace",(function(e,t,r){var o=M?"$":"$0";return[function(e,r){var n=f(this),o=null==e?void 0:m(e,y);return o?i(o,e,n,r):i(t,d(n),e,r)},function(e,i){var a=l(this),s=d(e);if("string"==typeof i&&-1===w(i,o)&&-1===w(i,"$<")){var f=r(t,a,s,i);if(f.done)return f.value}var m=u(i);m||(i=d(i));var y=a.global;if(y){var S=a.unicode;a.lastIndex=0}for(var M=[];;){var T=v(a,s);if(null===T)break;if(E(M,T),!y)break;""===d(T[0])&&(a.lastIndex=p(s,h(a.lastIndex),S))}for(var C,P="",D=0,L=0;L<M.length;L++){for(var R=d((T=M[L])[0]),I=b(x(c(T.index),s.length),0),O=[],N=1;N<T.length;N++)E(O,void 0===(C=T[N])?C:String(C));var k=T.groups;if(m){var F=_([R],O,I,s);void 0!==k&&E(F,k);var V=d(n(i,void 0,F))}else V=g(R,s,I,O,k,i);I>=D&&(P+=A(s,D,I)+V,D=I+R.length)}return P+A(s,D)}]}),!!s((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")}))||!S||M)},64765:(e,t,r)=>{"use strict";var n=r(46916),i=r(27007),o=r(19670),a=r(84488),s=r(81150),l=r(41340),u=r(58173),c=r(97651);i("search",(function(e,t,r){return[function(t){var r=a(this),i=null==t?void 0:u(t,e);return i?n(i,t,r):new RegExp(t)[e](l(r))},function(e){var n=o(this),i=l(e),a=r(t,n,i);if(a.done)return a.value;var u=n.lastIndex;s(u,0)||(n.lastIndex=0);var h=c(n,i);return s(n.lastIndex,u)||(n.lastIndex=u),null===h?-1:h.index}]}))},37268:(e,t,r)=>{"use strict";var n=r(82109),i=r(14230);n({target:"String",proto:!0,forced:r(43429)("small")},{small:function(){return i(this,"small","","")}})},23123:(e,t,r)=>{"use strict";var n=r(22104),i=r(46916),o=r(1702),a=r(27007),s=r(47850),l=r(19670),u=r(84488),c=r(36707),h=r(31530),d=r(17466),f=r(41340),p=r(58173),m=r(41589),g=r(97651),v=r(22261),y=r(52999),b=r(47293),x=y.UNSUPPORTED_Y,_=4294967295,E=Math.min,w=[].push,A=o(/./.exec),S=o(w),M=o("".slice);a("split",(function(e,t,r){var o;return o="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(e,r){var o=f(u(this)),a=void 0===r?_:r>>>0;if(0===a)return[];if(void 0===e)return[o];if(!s(e))return i(t,o,e,a);for(var l,c,h,d=[],p=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),g=0,y=new RegExp(e.source,p+"g");(l=i(v,y,o))&&!((c=y.lastIndex)>g&&(S(d,M(o,g,l.index)),l.length>1&&l.index<o.length&&n(w,d,m(l,1)),h=l[0].length,g=c,d.length>=a));)y.lastIndex===l.index&&y.lastIndex++;return g===o.length?!h&&A(y,"")||S(d,""):S(d,M(o,g)),d.length>a?m(d,0,a):d}:"0".split(void 0,0).length?function(e,r){return void 0===e&&0===r?[]:i(t,this,e,r)}:t,[function(t,r){var n=u(this),a=null==t?void 0:p(t,e);return a?i(a,t,n,r):i(o,f(n),t,r)},function(e,n){var i=l(this),a=f(e),s=r(o,i,a,n,o!==t);if(s.done)return s.value;var u=c(i,RegExp),p=i.unicode,m=(i.ignoreCase?"i":"")+(i.multiline?"m":"")+(i.unicode?"u":"")+(x?"g":"y"),v=new u(x?"^(?:"+i.source+")":i,m),y=void 0===n?_:n>>>0;if(0===y)return[];if(0===a.length)return null===g(v,a)?[a]:[];for(var b=0,w=0,A=[];w<a.length;){v.lastIndex=x?0:w;var T,C=g(v,x?M(a,w):a);if(null===C||(T=E(d(v.lastIndex+(x?w:0)),a.length))===b)w=h(a,w,p);else{if(S(A,M(a,b,w)),A.length===y)return A;for(var P=1;P<=C.length-1;P++)if(S(A,C[P]),A.length===y)return A;w=b=T}}return S(A,M(a,b)),A}]}),!!b((function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var r="ab".split(e);return 2!==r.length||"a"!==r[0]||"b"!==r[1]})),x)},23157:(e,t,r)=>{"use strict";var n,i=r(82109),o=r(1702),a=r(31236).f,s=r(17466),l=r(41340),u=r(3929),c=r(84488),h=r(84964),d=r(31913),f=o("".startsWith),p=o("".slice),m=Math.min,g=h("startsWith");i({target:"String",proto:!0,forced:!!(d||g||(n=a(String.prototype,"startsWith"),!n||n.writable))&&!g},{startsWith:function(e){var t=l(c(this));u(e);var r=s(m(arguments.length>1?arguments[1]:void 0,t.length)),n=l(e);return f?f(t,n,r):p(t,r,r+n.length)===n}})},7397:(e,t,r)=>{"use strict";var n=r(82109),i=r(14230);n({target:"String",proto:!0,forced:r(43429)("strike")},{strike:function(){return i(this,"strike","","")}})},60086:(e,t,r)=>{"use strict";var n=r(82109),i=r(14230);n({target:"String",proto:!0,forced:r(43429)("sub")},{sub:function(){return i(this,"sub","","")}})},80623:(e,t,r)=>{"use strict";var n=r(82109),i=r(14230);n({target:"String",proto:!0,forced:r(43429)("sup")},{sup:function(){return i(this,"sup","","")}})},48702:(e,t,r)=>{"use strict";var n=r(82109),i=r(53111).end,o=r(76091)("trimEnd"),a=o?function(){return i(this)}:"".trimEnd;n({target:"String",proto:!0,name:"trimEnd",forced:o},{trimEnd:a,trimRight:a})},55674:(e,t,r)=>{"use strict";var n=r(82109),i=r(53111).start,o=r(76091)("trimStart"),a=o?function(){return i(this)}:"".trimStart;n({target:"String",proto:!0,name:"trimStart",forced:o},{trimStart:a,trimLeft:a})},73210:(e,t,r)=>{"use strict";var n=r(82109),i=r(53111).trim;n({target:"String",proto:!0,forced:r(76091)("trim")},{trim:function(){return i(this)}})},72443:(e,t,r)=>{r(97235)("asyncIterator")},41817:(e,t,r)=>{"use strict";var n=r(82109),i=r(19781),o=r(17854),a=r(1702),s=r(92597),l=r(60614),u=r(47976),c=r(41340),h=r(3070).f,d=r(99920),f=o.Symbol,p=f&&f.prototype;if(i&&l(f)&&(!("description"in p)||void 0!==f().description)){var m={},g=function(){var e=arguments.length<1||void 0===arguments[0]?void 0:c(arguments[0]),t=u(p,this)?new f(e):void 0===e?f():f(e);return""===e&&(m[t]=!0),t};d(g,f),g.prototype=p,p.constructor=g;var v="Symbol(test)"==String(f("test")),y=a(p.toString),b=a(p.valueOf),x=/^Symbol\((.*)\)[^)]+$/,_=a("".replace),E=a("".slice);h(p,"description",{configurable:!0,get:function(){var e=b(this),t=y(e);if(s(m,e))return"";var r=v?E(t,7,-1):_(t,x,"$1");return""===r?void 0:r}}),n({global:!0,forced:!0},{Symbol:g})}},92401:(e,t,r)=>{r(97235)("hasInstance")},8722:(e,t,r)=>{r(97235)("isConcatSpreadable")},32165:(e,t,r)=>{r(97235)("iterator")},82526:(e,t,r)=>{"use strict";var n=r(82109),i=r(17854),o=r(35005),a=r(22104),s=r(46916),l=r(1702),u=r(31913),c=r(19781),h=r(30133),d=r(47293),f=r(92597),p=r(43157),m=r(60614),g=r(70111),v=r(47976),y=r(52190),b=r(19670),x=r(47908),_=r(45656),E=r(34948),w=r(41340),A=r(79114),S=r(70030),M=r(81956),T=r(8006),C=r(1156),P=r(25181),D=r(31236),L=r(3070),R=r(36048),I=r(55296),O=r(50206),N=r(31320),k=r(72309),F=r(6200),V=r(3501),U=r(69711),B=r(5112),z=r(6061),G=r(97235),H=r(58003),W=r(29909),j=r(42092).forEach,q=F("hidden"),X="Symbol",Y=B("toPrimitive"),K=W.set,Z=W.getterFor(X),Q=Object.prototype,J=i.Symbol,$=J&&J.prototype,ee=i.TypeError,te=i.QObject,re=o("JSON","stringify"),ne=D.f,ie=L.f,oe=C.f,ae=I.f,se=l([].push),le=k("symbols"),ue=k("op-symbols"),ce=k("string-to-symbol-registry"),he=k("symbol-to-string-registry"),de=k("wks"),fe=!te||!te.prototype||!te.prototype.findChild,pe=c&&d((function(){return 7!=S(ie({},"a",{get:function(){return ie(this,"a",{value:7}).a}})).a}))?function(e,t,r){var n=ne(Q,t);n&&delete Q[t],ie(e,t,r),n&&e!==Q&&ie(Q,t,n)}:ie,me=function(e,t){var r=le[e]=S($);return K(r,{type:X,tag:e,description:t}),c||(r.description=t),r},ge=function(e,t,r){e===Q&&ge(ue,t,r),b(e);var n=E(t);return b(r),f(le,n)?(r.enumerable?(f(e,q)&&e[q][n]&&(e[q][n]=!1),r=S(r,{enumerable:A(0,!1)})):(f(e,q)||ie(e,q,A(1,{})),e[q][n]=!0),pe(e,n,r)):ie(e,n,r)},ve=function(e,t){b(e);var r=_(t),n=M(r).concat(_e(r));return j(n,(function(t){c&&!s(ye,r,t)||ge(e,t,r[t])})),e},ye=function(e){var t=E(e),r=s(ae,this,t);return!(this===Q&&f(le,t)&&!f(ue,t))&&(!(r||!f(this,t)||!f(le,t)||f(this,q)&&this[q][t])||r)},be=function(e,t){var r=_(e),n=E(t);if(r!==Q||!f(le,n)||f(ue,n)){var i=ne(r,n);return!i||!f(le,n)||f(r,q)&&r[q][n]||(i.enumerable=!0),i}},xe=function(e){var t=oe(_(e)),r=[];return j(t,(function(e){f(le,e)||f(V,e)||se(r,e)})),r},_e=function(e){var t=e===Q,r=oe(t?ue:_(e)),n=[];return j(r,(function(e){!f(le,e)||t&&!f(Q,e)||se(n,le[e])})),n};(h||(N($=(J=function(){if(v($,this))throw ee("Symbol is not a constructor");var e=arguments.length&&void 0!==arguments[0]?w(arguments[0]):void 0,t=U(e),r=function(e){this===Q&&s(r,ue,e),f(this,q)&&f(this[q],t)&&(this[q][t]=!1),pe(this,t,A(1,e))};return c&&fe&&pe(Q,t,{configurable:!0,set:r}),me(t,e)}).prototype,"toString",(function(){return Z(this).tag})),N(J,"withoutSetter",(function(e){return me(U(e),e)})),I.f=ye,L.f=ge,R.f=ve,D.f=be,T.f=C.f=xe,P.f=_e,z.f=function(e){return me(B(e),e)},c&&(ie($,"description",{configurable:!0,get:function(){return Z(this).description}}),u||N(Q,"propertyIsEnumerable",ye,{unsafe:!0}))),n({global:!0,wrap:!0,forced:!h,sham:!h},{Symbol:J}),j(M(de),(function(e){G(e)})),n({target:X,stat:!0,forced:!h},{for:function(e){var t=w(e);if(f(ce,t))return ce[t];var r=J(t);return ce[t]=r,he[r]=t,r},keyFor:function(e){if(!y(e))throw ee(e+" is not a symbol");if(f(he,e))return he[e]},useSetter:function(){fe=!0},useSimple:function(){fe=!1}}),n({target:"Object",stat:!0,forced:!h,sham:!c},{create:function(e,t){return void 0===t?S(e):ve(S(e),t)},defineProperty:ge,defineProperties:ve,getOwnPropertyDescriptor:be}),n({target:"Object",stat:!0,forced:!h},{getOwnPropertyNames:xe,getOwnPropertySymbols:_e}),n({target:"Object",stat:!0,forced:d((function(){P.f(1)}))},{getOwnPropertySymbols:function(e){return P.f(x(e))}}),re)&&n({target:"JSON",stat:!0,forced:!h||d((function(){var e=J();return"[null]"!=re([e])||"{}"!=re({a:e})||"{}"!=re(Object(e))}))},{stringify:function(e,t,r){var n=O(arguments),i=t;if((g(t)||void 0!==e)&&!y(e))return p(t)||(t=function(e,t){if(m(i)&&(t=s(i,this,e,t)),!y(t))return t}),n[1]=t,a(re,null,n)}});if(!$[Y]){var Ee=$.valueOf;N($,Y,(function(e){return s(Ee,this)}))}H(J,X),V[q]=!0},69007:(e,t,r)=>{r(97235)("match")},83510:(e,t,r)=>{r(97235)("replace")},41840:(e,t,r)=>{r(97235)("search")},6982:(e,t,r)=>{r(97235)("species")},32159:(e,t,r)=>{r(97235)("split")},96649:(e,t,r)=>{r(97235)("toPrimitive")},39341:(e,t,r)=>{r(97235)("toStringTag")},60543:(e,t,r)=>{r(97235)("unscopables")},92990:(e,t,r)=>{"use strict";var n=r(1702),i=r(90260),o=n(r(1048)),a=i.aTypedArray;(0,i.exportTypedArrayMethod)("copyWithin",(function(e,t){return o(a(this),e,t,arguments.length>2?arguments[2]:void 0)}))},18927:(e,t,r)=>{"use strict";var n=r(90260),i=r(42092).every,o=n.aTypedArray;(0,n.exportTypedArrayMethod)("every",(function(e){return i(o(this),e,arguments.length>1?arguments[1]:void 0)}))},33105:(e,t,r)=>{"use strict";var n=r(90260),i=r(46916),o=r(21285),a=n.aTypedArray;(0,n.exportTypedArrayMethod)("fill",(function(e){var t=arguments.length;return i(o,a(this),e,t>1?arguments[1]:void 0,t>2?arguments[2]:void 0)}))},35035:(e,t,r)=>{"use strict";var n=r(90260),i=r(42092).filter,o=r(43074),a=n.aTypedArray;(0,n.exportTypedArrayMethod)("filter",(function(e){var t=i(a(this),e,arguments.length>1?arguments[1]:void 0);return o(this,t)}))},7174:(e,t,r)=>{"use strict";var n=r(90260),i=r(42092).findIndex,o=n.aTypedArray;(0,n.exportTypedArrayMethod)("findIndex",(function(e){return i(o(this),e,arguments.length>1?arguments[1]:void 0)}))},74345:(e,t,r)=>{"use strict";var n=r(90260),i=r(42092).find,o=n.aTypedArray;(0,n.exportTypedArrayMethod)("find",(function(e){return i(o(this),e,arguments.length>1?arguments[1]:void 0)}))},44197:(e,t,r)=>{r(19843)("Float32",(function(e){return function(t,r,n){return e(this,t,r,n)}}))},76495:(e,t,r)=>{r(19843)("Float64",(function(e){return function(t,r,n){return e(this,t,r,n)}}))},32846:(e,t,r)=>{"use strict";var n=r(90260),i=r(42092).forEach,o=n.aTypedArray;(0,n.exportTypedArrayMethod)("forEach",(function(e){i(o(this),e,arguments.length>1?arguments[1]:void 0)}))},98145:(e,t,r)=>{"use strict";var n=r(63832);(0,r(90260).exportTypedArrayStaticMethod)("from",r(97321),n)},44731:(e,t,r)=>{"use strict";var n=r(90260),i=r(41318).includes,o=n.aTypedArray;(0,n.exportTypedArrayMethod)("includes",(function(e){return i(o(this),e,arguments.length>1?arguments[1]:void 0)}))},77209:(e,t,r)=>{"use strict";var n=r(90260),i=r(41318).indexOf,o=n.aTypedArray;(0,n.exportTypedArrayMethod)("indexOf",(function(e){return i(o(this),e,arguments.length>1?arguments[1]:void 0)}))},35109:(e,t,r)=>{r(19843)("Int16",(function(e){return function(t,r,n){return e(this,t,r,n)}}))},65125:(e,t,r)=>{r(19843)("Int32",(function(e){return function(t,r,n){return e(this,t,r,n)}}))},87145:(e,t,r)=>{r(19843)("Int8",(function(e){return function(t,r,n){return e(this,t,r,n)}}))},96319:(e,t,r)=>{"use strict";var n=r(17854),i=r(47293),o=r(1702),a=r(90260),s=r(66992),l=r(5112)("iterator"),u=n.Uint8Array,c=o(s.values),h=o(s.keys),d=o(s.entries),f=a.aTypedArray,p=a.exportTypedArrayMethod,m=u&&u.prototype,g=!i((function(){m[l].call([1])})),v=!!m&&m.values&&m[l]===m.values&&"values"===m.values.name,y=function(){return c(f(this))};p("entries",(function(){return d(f(this))}),g),p("keys",(function(){return h(f(this))}),g),p("values",y,g||!v,{name:"values"}),p(l,y,g||!v,{name:"values"})},58867:(e,t,r)=>{"use strict";var n=r(90260),i=r(1702),o=n.aTypedArray,a=n.exportTypedArrayMethod,s=i([].join);a("join",(function(e){return s(o(this),e)}))},37789:(e,t,r)=>{"use strict";var n=r(90260),i=r(22104),o=r(86583),a=n.aTypedArray;(0,n.exportTypedArrayMethod)("lastIndexOf",(function(e){var t=arguments.length;return i(o,a(this),t>1?[e,arguments[1]]:[e])}))},33739:(e,t,r)=>{"use strict";var n=r(90260),i=r(42092).map,o=r(66304),a=n.aTypedArray;(0,n.exportTypedArrayMethod)("map",(function(e){return i(a(this),e,arguments.length>1?arguments[1]:void 0,(function(e,t){return new(o(e))(t)}))}))},95206:(e,t,r)=>{"use strict";var n=r(90260),i=r(63832),o=n.aTypedArrayConstructor;(0,n.exportTypedArrayStaticMethod)("of",(function(){for(var e=0,t=arguments.length,r=new(o(this))(t);t>e;)r[e]=arguments[e++];return r}),i)},14483:(e,t,r)=>{"use strict";var n=r(90260),i=r(53671).right,o=n.aTypedArray;(0,n.exportTypedArrayMethod)("reduceRight",(function(e){var t=arguments.length;return i(o(this),e,t,t>1?arguments[1]:void 0)}))},29368:(e,t,r)=>{"use strict";var n=r(90260),i=r(53671).left,o=n.aTypedArray;(0,n.exportTypedArrayMethod)("reduce",(function(e){var t=arguments.length;return i(o(this),e,t,t>1?arguments[1]:void 0)}))},12056:(e,t,r)=>{"use strict";var n=r(90260),i=n.aTypedArray,o=n.exportTypedArrayMethod,a=Math.floor;o("reverse",(function(){for(var e,t=this,r=i(t).length,n=a(r/2),o=0;o<n;)e=t[o],t[o++]=t[--r],t[r]=e;return t}))},3462:(e,t,r)=>{"use strict";var n=r(17854),i=r(46916),o=r(90260),a=r(26244),s=r(84590),l=r(47908),u=r(47293),c=n.RangeError,h=n.Int8Array,d=h&&h.prototype,f=d&&d.set,p=o.aTypedArray,m=o.exportTypedArrayMethod,g=!u((function(){var e=new Uint8ClampedArray(2);return i(f,e,{length:1,0:3},1),3!==e[1]})),v=g&&o.NATIVE_ARRAY_BUFFER_VIEWS&&u((function(){var e=new h(2);return e.set(1),e.set("2",1),0!==e[0]||2!==e[1]}));m("set",(function(e){p(this);var t=s(arguments.length>1?arguments[1]:void 0,1),r=l(e);if(g)return i(f,this,r,t);var n=this.length,o=a(r),u=0;if(o+t>n)throw c("Wrong length");for(;u<o;)this[t+u]=r[u++]}),!g||v)},30678:(e,t,r)=>{"use strict";var n=r(90260),i=r(66304),o=r(47293),a=r(50206),s=n.aTypedArray;(0,n.exportTypedArrayMethod)("slice",(function(e,t){for(var r=a(s(this),e,t),n=i(this),o=0,l=r.length,u=new n(l);l>o;)u[o]=r[o++];return u}),o((function(){new Int8Array(1).slice()})))},27462:(e,t,r)=>{"use strict";var n=r(90260),i=r(42092).some,o=n.aTypedArray;(0,n.exportTypedArrayMethod)("some",(function(e){return i(o(this),e,arguments.length>1?arguments[1]:void 0)}))},33824:(e,t,r)=>{"use strict";var n=r(17854),i=r(1702),o=r(47293),a=r(19662),s=r(94362),l=r(90260),u=r(68886),c=r(30256),h=r(7392),d=r(98008),f=n.Array,p=l.aTypedArray,m=l.exportTypedArrayMethod,g=n.Uint16Array,v=g&&i(g.prototype.sort),y=!(!v||o((function(){v(new g(2),null)}))&&o((function(){v(new g(2),{})}))),b=!!v&&!o((function(){if(h)return h<74;if(u)return u<67;if(c)return!0;if(d)return d<602;var e,t,r=new g(516),n=f(516);for(e=0;e<516;e++)t=e%4,r[e]=515-e,n[e]=e-2*t+3;for(v(r,(function(e,t){return(e/4|0)-(t/4|0)})),e=0;e<516;e++)if(r[e]!==n[e])return!0}));m("sort",(function(e){return void 0!==e&&a(e),b?v(this,e):s(p(this),function(e){return function(t,r){return void 0!==e?+e(t,r)||0:r!=r?-1:t!=t?1:0===t&&0===r?1/t>0&&1/r<0?1:-1:t>r}}(e))}),!b||y)},55021:(e,t,r)=>{"use strict";var n=r(90260),i=r(17466),o=r(51400),a=r(66304),s=n.aTypedArray;(0,n.exportTypedArrayMethod)("subarray",(function(e,t){var r=s(this),n=r.length,l=o(e,n);return new(a(r))(r.buffer,r.byteOffset+l*r.BYTES_PER_ELEMENT,i((void 0===t?n:o(t,n))-l))}))},12974:(e,t,r)=>{"use strict";var n=r(17854),i=r(22104),o=r(90260),a=r(47293),s=r(50206),l=n.Int8Array,u=o.aTypedArray,c=o.exportTypedArrayMethod,h=[].toLocaleString,d=!!l&&a((function(){h.call(new l(1))}));c("toLocaleString",(function(){return i(h,d?s(u(this)):u(this),s(arguments))}),a((function(){return[1,2].toLocaleString()!=new l([1,2]).toLocaleString()}))||!a((function(){l.prototype.toLocaleString.call([1,2])})))},15016:(e,t,r)=>{"use strict";var n=r(90260).exportTypedArrayMethod,i=r(47293),o=r(17854),a=r(1702),s=o.Uint8Array,l=s&&s.prototype||{},u=[].toString,c=a([].join);i((function(){u.call({})}))&&(u=function(){return c(this)});var h=l.toString!=u;n("toString",u,h)},8255:(e,t,r)=>{r(19843)("Uint16",(function(e){return function(t,r,n){return e(this,t,r,n)}}))},29135:(e,t,r)=>{r(19843)("Uint32",(function(e){return function(t,r,n){return e(this,t,r,n)}}))},82472:(e,t,r)=>{r(19843)("Uint8",(function(e){return function(t,r,n){return e(this,t,r,n)}}))},49743:(e,t,r)=>{r(19843)("Uint8",(function(e){return function(t,r,n){return e(this,t,r,n)}}),!0)},4129:(e,t,r)=>{"use strict";var n,i=r(17854),o=r(1702),a=r(12248),s=r(62423),l=r(77710),u=r(29320),c=r(70111),h=r(52050),d=r(29909).enforce,f=r(68536),p=!i.ActiveXObject&&"ActiveXObject"in i,m=function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},g=l("WeakMap",m,u);if(f&&p){n=u.getConstructor(m,"WeakMap",!0),s.enable();var v=g.prototype,y=o(v.delete),b=o(v.has),x=o(v.get),_=o(v.set);a(v,{delete:function(e){if(c(e)&&!h(e)){var t=d(this);return t.frozen||(t.frozen=new n),y(this,e)||t.frozen.delete(e)}return y(this,e)},has:function(e){if(c(e)&&!h(e)){var t=d(this);return t.frozen||(t.frozen=new n),b(this,e)||t.frozen.has(e)}return b(this,e)},get:function(e){if(c(e)&&!h(e)){var t=d(this);return t.frozen||(t.frozen=new n),b(this,e)?x(this,e):t.frozen.get(e)}return x(this,e)},set:function(e,t){if(c(e)&&!h(e)){var r=d(this);r.frozen||(r.frozen=new n),b(this,e)?_(this,e,t):r.frozen.set(e,t)}else _(this,e,t);return this}})}},38478:(e,t,r)=>{"use strict";r(77710)("WeakSet",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),r(29320))},8628:(e,t,r)=>{r(9170)},83475:(e,t,r)=>{"use strict";var n=r(19781),i=r(51223),o=r(47908),a=r(26244),s=r(3070).f;n&&(s(Array.prototype,"lastIndex",{configurable:!0,get:function(){var e=o(this),t=a(e);return 0==t?0:t-1}}),i("lastIndex"))},46273:(e,t,r)=>{"use strict";var n=r(19781),i=r(51223),o=r(47908),a=r(26244),s=r(3070).f;n&&(s(Array.prototype,"lastItem",{configurable:!0,get:function(){var e=o(this),t=a(e);return 0==t?void 0:e[t-1]},set:function(e){var t=o(this),r=a(t);return t[0==r?0:r-1]=e}}),i("lastItem"))},51568:(e,t,r)=>{var n=r(82109),i=r(17854),o=r(22104),a=r(10313),s=r(35005),l=r(70030),u=i.Object,c=function(){var e=s("Object","freeze");return e?e(l(null)):l(null)};n({global:!0,forced:!0},{compositeKey:function(){return o(a,u,arguments).get("object",c)}})},26349:(e,t,r)=>{var n=r(82109),i=r(10313),o=r(35005),a=r(22104);n({global:!0,forced:!0},{compositeSymbol:function(){return 1==arguments.length&&"string"==typeof arguments[0]?o("Symbol").for(arguments[0]):a(i,null,arguments).get("symbol",o("Symbol"))}})},65743:(e,t,r)=>{r(35837)},10072:(e,t,r)=>{"use strict";r(82109)({target:"Map",proto:!0,real:!0,forced:!0},{deleteAll:r(34092)})},99137:(e,t,r)=>{"use strict";var n=r(82109),i=r(19670),o=r(49974),a=r(54647),s=r(20408);n({target:"Map",proto:!0,real:!0,forced:!0},{every:function(e){var t=i(this),r=a(t),n=o(e,arguments.length>1?arguments[1]:void 0);return!s(r,(function(e,r,i){if(!n(r,e,t))return i()}),{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}})},71957:(e,t,r)=>{"use strict";var n=r(82109),i=r(35005),o=r(49974),a=r(46916),s=r(19662),l=r(19670),u=r(36707),c=r(54647),h=r(20408);n({target:"Map",proto:!0,real:!0,forced:!0},{filter:function(e){var t=l(this),r=c(t),n=o(e,arguments.length>1?arguments[1]:void 0),d=new(u(t,i("Map"))),f=s(d.set);return h(r,(function(e,r){n(r,e,t)&&a(f,d,e,r)}),{AS_ENTRIES:!0,IS_ITERATOR:!0}),d}})},103:(e,t,r)=>{"use strict";var n=r(82109),i=r(19670),o=r(49974),a=r(54647),s=r(20408);n({target:"Map",proto:!0,real:!0,forced:!0},{findKey:function(e){var t=i(this),r=a(t),n=o(e,arguments.length>1?arguments[1]:void 0);return s(r,(function(e,r,i){if(n(r,e,t))return i(e)}),{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).result}})},96306:(e,t,r)=>{"use strict";var n=r(82109),i=r(19670),o=r(49974),a=r(54647),s=r(20408);n({target:"Map",proto:!0,real:!0,forced:!0},{find:function(e){var t=i(this),r=a(t),n=o(e,arguments.length>1?arguments[1]:void 0);return s(r,(function(e,r,i){if(n(r,e,t))return i(r)}),{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).result}})},8582:(e,t,r)=>{r(82109)({target:"Map",stat:!0,forced:!0},{from:r(27296)})},90618:(e,t,r)=>{"use strict";var n=r(82109),i=r(46916),o=r(1702),a=r(19662),s=r(18554),l=r(20408),u=o([].push);n({target:"Map",stat:!0,forced:!0},{groupBy:function(e,t){a(t);var r=s(e),n=new this,o=a(n.has),c=a(n.get),h=a(n.set);return l(r,(function(e){var r=t(e);i(o,n,r)?u(i(c,n,r),e):i(h,n,r,[e])}),{IS_ITERATOR:!0}),n}})},74592:(e,t,r)=>{"use strict";var n=r(82109),i=r(19670),o=r(54647),a=r(46465),s=r(20408);n({target:"Map",proto:!0,real:!0,forced:!0},{includes:function(e){return s(o(i(this)),(function(t,r,n){if(a(r,e))return n()}),{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}})},88440:(e,t,r)=>{"use strict";var n=r(82109),i=r(46916),o=r(20408),a=r(19662);n({target:"Map",stat:!0,forced:!0},{keyBy:function(e,t){var r=new this;a(t);var n=a(r.set);return o(e,(function(e){i(n,r,t(e),e)})),r}})},58276:(e,t,r)=>{"use strict";var n=r(82109),i=r(19670),o=r(54647),a=r(20408);n({target:"Map",proto:!0,real:!0,forced:!0},{keyOf:function(e){return a(o(i(this)),(function(t,r,n){if(r===e)return n(t)}),{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).result}})},35082:(e,t,r)=>{"use strict";var n=r(82109),i=r(35005),o=r(49974),a=r(46916),s=r(19662),l=r(19670),u=r(36707),c=r(54647),h=r(20408);n({target:"Map",proto:!0,real:!0,forced:!0},{mapKeys:function(e){var t=l(this),r=c(t),n=o(e,arguments.length>1?arguments[1]:void 0),d=new(u(t,i("Map"))),f=s(d.set);return h(r,(function(e,r){a(f,d,n(r,e,t),r)}),{AS_ENTRIES:!0,IS_ITERATOR:!0}),d}})},12813:(e,t,r)=>{"use strict";var n=r(82109),i=r(35005),o=r(49974),a=r(46916),s=r(19662),l=r(19670),u=r(36707),c=r(54647),h=r(20408);n({target:"Map",proto:!0,real:!0,forced:!0},{mapValues:function(e){var t=l(this),r=c(t),n=o(e,arguments.length>1?arguments[1]:void 0),d=new(u(t,i("Map"))),f=s(d.set);return h(r,(function(e,r){a(f,d,e,n(r,e,t))}),{AS_ENTRIES:!0,IS_ITERATOR:!0}),d}})},18222:(e,t,r)=>{"use strict";var n=r(82109),i=r(19662),o=r(19670),a=r(20408);n({target:"Map",proto:!0,real:!0,forced:!0},{merge:function(e){for(var t=o(this),r=i(t.set),n=arguments.length,s=0;s<n;)a(arguments[s++],r,{that:t,AS_ENTRIES:!0});return t}})},24838:(e,t,r)=>{r(82109)({target:"Map",stat:!0,forced:!0},{of:r(82044)})},38563:(e,t,r)=>{"use strict";var n=r(82109),i=r(17854),o=r(19670),a=r(19662),s=r(54647),l=r(20408),u=i.TypeError;n({target:"Map",proto:!0,real:!0,forced:!0},{reduce:function(e){var t=o(this),r=s(t),n=arguments.length<2,i=n?void 0:arguments[1];if(a(e),l(r,(function(r,o){n?(n=!1,i=o):i=e(i,o,r,t)}),{AS_ENTRIES:!0,IS_ITERATOR:!0}),n)throw u("Reduce of empty map with no initial value");return i}})},50336:(e,t,r)=>{"use strict";var n=r(82109),i=r(19670),o=r(49974),a=r(54647),s=r(20408);n({target:"Map",proto:!0,real:!0,forced:!0},{some:function(e){var t=i(this),r=a(t),n=o(e,arguments.length>1?arguments[1]:void 0);return s(r,(function(e,r,i){if(n(r,e,t))return i()}),{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}})},7512:(e,t,r)=>{"use strict";var n=r(82109),i=r(17854),o=r(46916),a=r(19670),s=r(19662),l=i.TypeError;n({target:"Map",proto:!0,real:!0,forced:!0},{update:function(e,t){var r=a(this),n=s(r.get),i=s(r.has),u=s(r.set),c=arguments.length;s(t);var h=o(i,r,e);if(!h&&c<3)throw l("Updating absent value");var d=h?o(n,r,e):s(c>2?arguments[2]:void 0)(e,r);return o(u,r,e,t(d,e,r)),r}})},46603:(e,t,r)=>{var n=r(82109),i=Math.min,o=Math.max;n({target:"Math",stat:!0,forced:!0},{clamp:function(e,t,r){return i(r,o(t,e))}})},70100:(e,t,r)=>{r(82109)({target:"Math",stat:!0,forced:!0},{DEG_PER_RAD:Math.PI/180})},10490:(e,t,r)=>{var n=r(82109),i=180/Math.PI;n({target:"Math",stat:!0,forced:!0},{degrees:function(e){return e*i}})},13187:(e,t,r)=>{var n=r(82109),i=r(47103),o=r(26130);n({target:"Math",stat:!0,forced:!0},{fscale:function(e,t,r,n,a){return o(i(e,t,r,n,a))}})},60092:(e,t,r)=>{r(82109)({target:"Math",stat:!0,forced:!0},{iaddh:function(e,t,r,n){var i=e>>>0,o=r>>>0;return(t>>>0)+(n>>>0)+((i&o|(i|o)&~(i+o>>>0))>>>31)|0}})},19041:(e,t,r)=>{r(82109)({target:"Math",stat:!0,forced:!0},{imulh:function(e,t){var r=65535,n=+e,i=+t,o=n&r,a=i&r,s=n>>16,l=i>>16,u=(s*a>>>0)+(o*a>>>16);return s*l+(u>>16)+((o*l>>>0)+(u&r)>>16)}})},30666:(e,t,r)=>{r(82109)({target:"Math",stat:!0,forced:!0},{isubh:function(e,t,r,n){var i=e>>>0,o=r>>>0;return(t>>>0)-(n>>>0)-((~i&o|~(i^o)&i-o>>>0)>>>31)|0}})},51638:(e,t,r)=>{r(82109)({target:"Math",stat:!0,forced:!0},{RAD_PER_DEG:180/Math.PI})},62975:(e,t,r)=>{var n=r(82109),i=Math.PI/180;n({target:"Math",stat:!0,forced:!0},{radians:function(e){return e*i}})},15728:(e,t,r)=>{r(82109)({target:"Math",stat:!0,forced:!0},{scale:r(47103)})},46056:(e,t,r)=>{var n=r(82109),i=r(17854),o=r(19670),a=r(77023),s=r(24994),l=r(29909),u="Seeded Random",c="Seeded Random Generator",h=l.set,d=l.getterFor(c),f=i.TypeError,p=s((function(e){h(this,{type:c,seed:e%2147483647})}),u,(function(){var e=d(this);return{value:(1073741823&(e.seed=(1103515245*e.seed+12345)%2147483647))/1073741823,done:!1}}));n({target:"Math",stat:!0,forced:!0},{seededPRNG:function(e){var t=o(e).seed;if(!a(t))throw f('Math.seededPRNG() argument should have a "seed" field with a finite value.');return new p(t)}})},44299:(e,t,r)=>{r(82109)({target:"Math",stat:!0,forced:!0},{signbit:function(e){return(e=+e)==e&&0==e?1/e==-1/0:e<0}})},5162:(e,t,r)=>{r(82109)({target:"Math",stat:!0,forced:!0},{umulh:function(e,t){var r=65535,n=+e,i=+t,o=n&r,a=i&r,s=n>>>16,l=i>>>16,u=(s*a>>>0)+(o*a>>>16);return s*l+(u>>>16)+((o*l>>>0)+(u&r)>>>16)}})},50292:(e,t,r)=>{"use strict";var n=r(82109),i=r(17854),o=r(1702),a=r(19303),s=r(83009),l="Invalid number representation",u=i.RangeError,c=i.SyntaxError,h=i.TypeError,d=/^[\da-z]+$/,f=o("".charAt),p=o(d.exec),m=o(1..toString),g=o("".slice);n({target:"Number",stat:!0,forced:!0},{fromString:function(e,t){var r,n,i=1;if("string"!=typeof e)throw h(l);if(!e.length)throw c(l);if("-"==f(e,0)&&(i=-1,!(e=g(e,1)).length))throw c(l);if((r=void 0===t?10:a(t))<2||r>36)throw u("Invalid radix");if(!p(d,e)||m(n=s(e,r),r)!==e)throw c(l);return i*n}})},1025:(e,t,r)=>{"use strict";var n=r(82109),i=r(17854),o=r(46916),a=r(19781),s=r(96340),l=r(19662),u=r(60614),c=r(4411),h=r(19670),d=r(70111),f=r(25787),p=r(3070).f,m=r(31320),g=r(12248),v=r(18554),y=r(58173),b=r(20408),x=r(842),_=r(5112),E=r(29909),w=_("observable"),A="Observable",S="Subscription",M="SubscriptionObserver",T=E.getterFor,C=E.set,P=T(A),D=T(S),L=T(M),R=i.Array,I=i.Observable,O=I&&I.prototype,N=!(u(I)&&u(I.from)&&u(I.of)&&u(O.subscribe)&&u(O[w])),k=function(e){this.observer=h(e),this.cleanup=void 0,this.subscriptionObserver=void 0};k.prototype={type:S,clean:function(){var e=this.cleanup;if(e){this.cleanup=void 0;try{e()}catch(e){x(e)}}},close:function(){if(!a){var e=this.facade,t=this.subscriptionObserver;e.closed=!0,t&&(t.closed=!0)}this.observer=void 0},isClosed:function(){return void 0===this.observer}};var F=function(e,t){var r,n=C(this,new k(e));a||(this.closed=!1);try{(r=y(e,"start"))&&o(r,e,this)}catch(e){x(e)}if(!n.isClosed()){var i=n.subscriptionObserver=new V(n);try{var s=t(i),c=s;null!=s&&(n.cleanup=u(s.unsubscribe)?function(){c.unsubscribe()}:l(s))}catch(e){return void i.error(e)}n.isClosed()&&n.clean()}};F.prototype=g({},{unsubscribe:function(){var e=D(this);e.isClosed()||(e.close(),e.clean())}}),a&&p(F.prototype,"closed",{configurable:!0,get:function(){return D(this).isClosed()}});var V=function(e){C(this,{type:M,subscriptionState:e}),a||(this.closed=!1)};V.prototype=g({},{next:function(e){var t=L(this).subscriptionState;if(!t.isClosed()){var r=t.observer;try{var n=y(r,"next");n&&o(n,r,e)}catch(e){x(e)}}},error:function(e){var t=L(this).subscriptionState;if(!t.isClosed()){var r=t.observer;t.close();try{var n=y(r,"error");n?o(n,r,e):x(e)}catch(e){x(e)}t.clean()}},complete:function(){var e=L(this).subscriptionState;if(!e.isClosed()){var t=e.observer;e.close();try{var r=y(t,"complete");r&&o(r,t)}catch(e){x(e)}e.clean()}}}),a&&p(V.prototype,"closed",{configurable:!0,get:function(){return L(this).subscriptionState.isClosed()}});var U=function(e){f(this,B),C(this,{type:A,subscriber:l(e)})},B=U.prototype;g(B,{subscribe:function(e){var t=arguments.length;return new F(u(e)?{next:e,error:t>1?arguments[1]:void 0,complete:t>2?arguments[2]:void 0}:d(e)?e:{},P(this).subscriber)}}),g(U,{from:function(e){var t=c(this)?this:U,r=y(h(e),w);if(r){var n=h(o(r,e));return n.constructor===t?n:new t((function(e){return n.subscribe(e)}))}var i=v(e);return new t((function(e){b(i,(function(t,r){if(e.next(t),e.closed)return r()}),{IS_ITERATOR:!0,INTERRUPTED:!0}),e.complete()}))},of:function(){for(var e=c(this)?this:U,t=arguments.length,r=R(t),n=0;n<t;)r[n]=arguments[n++];return new e((function(e){for(var n=0;n<t;n++)if(e.next(r[n]),e.closed)return;e.complete()}))}}),m(B,w,(function(){return this})),n({global:!0,forced:N},{Observable:U}),s(A)},97314:(e,t,r)=>{r(17922)},96290:(e,t,r)=>{r(34668)},77479:(e,t,r)=>{"use strict";var n=r(82109),i=r(78523),o=r(12534);n({target:"Promise",stat:!0,forced:!0},{try:function(e){var t=i.f(this),r=o(e);return(r.error?t.reject:t.resolve)(r.value),t.promise}})},34582:(e,t,r)=>{var n=r(82109),i=r(38845),o=r(19670),a=i.toKey,s=i.set;n({target:"Reflect",stat:!0},{defineMetadata:function(e,t,r){var n=arguments.length<4?void 0:a(arguments[3]);s(e,t,o(r),n)}})},47896:(e,t,r)=>{var n=r(82109),i=r(38845),o=r(19670),a=i.toKey,s=i.getMap,l=i.store;n({target:"Reflect",stat:!0},{deleteMetadata:function(e,t){var r=arguments.length<3?void 0:a(arguments[2]),n=s(o(t),r,!1);if(void 0===n||!n.delete(e))return!1;if(n.size)return!0;var i=l.get(t);return i.delete(r),!!i.size||l.delete(t)}})},98558:(e,t,r)=>{var n=r(82109),i=r(1702),o=r(38845),a=r(19670),s=r(79518),l=i(r(60956)),u=i([].concat),c=o.keys,h=o.toKey,d=function(e,t){var r=c(e,t),n=s(e);if(null===n)return r;var i=d(n,t);return i.length?r.length?l(u(r,i)):i:r};n({target:"Reflect",stat:!0},{getMetadataKeys:function(e){var t=arguments.length<2?void 0:h(arguments[1]);return d(a(e),t)}})},12647:(e,t,r)=>{var n=r(82109),i=r(38845),o=r(19670),a=r(79518),s=i.has,l=i.get,u=i.toKey,c=function(e,t,r){if(s(e,t,r))return l(e,t,r);var n=a(t);return null!==n?c(e,n,r):void 0};n({target:"Reflect",stat:!0},{getMetadata:function(e,t){var r=arguments.length<3?void 0:u(arguments[2]);return c(e,o(t),r)}})},97507:(e,t,r)=>{var n=r(82109),i=r(38845),o=r(19670),a=i.keys,s=i.toKey;n({target:"Reflect",stat:!0},{getOwnMetadataKeys:function(e){var t=arguments.length<2?void 0:s(arguments[1]);return a(o(e),t)}})},84018:(e,t,r)=>{var n=r(82109),i=r(38845),o=r(19670),a=i.get,s=i.toKey;n({target:"Reflect",stat:!0},{getOwnMetadata:function(e,t){var r=arguments.length<3?void 0:s(arguments[2]);return a(e,o(t),r)}})},61605:(e,t,r)=>{var n=r(82109),i=r(38845),o=r(19670),a=r(79518),s=i.has,l=i.toKey,u=function(e,t,r){if(s(e,t,r))return!0;var n=a(t);return null!==n&&u(e,n,r)};n({target:"Reflect",stat:!0},{hasMetadata:function(e,t){var r=arguments.length<3?void 0:l(arguments[2]);return u(e,o(t),r)}})},49076:(e,t,r)=>{var n=r(82109),i=r(38845),o=r(19670),a=i.has,s=i.toKey;n({target:"Reflect",stat:!0},{hasOwnMetadata:function(e,t){var r=arguments.length<3?void 0:s(arguments[2]);return a(e,o(t),r)}})},34999:(e,t,r)=>{var n=r(82109),i=r(38845),o=r(19670),a=i.toKey,s=i.set;n({target:"Reflect",stat:!0},{metadata:function(e,t){return function(r,n){s(e,t,o(r),a(n))}}})},88921:(e,t,r)=>{"use strict";r(82109)({target:"Set",proto:!0,real:!0,forced:!0},{addAll:r(31501)})},96248:(e,t,r)=>{"use strict";r(82109)({target:"Set",proto:!0,real:!0,forced:!0},{deleteAll:r(34092)})},13599:(e,t,r)=>{"use strict";var n=r(82109),i=r(35005),o=r(46916),a=r(19662),s=r(19670),l=r(36707),u=r(20408);n({target:"Set",proto:!0,real:!0,forced:!0},{difference:function(e){var t=s(this),r=new(l(t,i("Set")))(t),n=a(r.delete);return u(e,(function(e){o(n,r,e)})),r}})},11477:(e,t,r)=>{"use strict";var n=r(82109),i=r(19670),o=r(49974),a=r(96767),s=r(20408);n({target:"Set",proto:!0,real:!0,forced:!0},{every:function(e){var t=i(this),r=a(t),n=o(e,arguments.length>1?arguments[1]:void 0);return!s(r,(function(e,r){if(!n(e,e,t))return r()}),{IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}})},64362:(e,t,r)=>{"use strict";var n=r(82109),i=r(35005),o=r(46916),a=r(19662),s=r(19670),l=r(49974),u=r(36707),c=r(96767),h=r(20408);n({target:"Set",proto:!0,real:!0,forced:!0},{filter:function(e){var t=s(this),r=c(t),n=l(e,arguments.length>1?arguments[1]:void 0),d=new(u(t,i("Set"))),f=a(d.add);return h(r,(function(e){n(e,e,t)&&o(f,d,e)}),{IS_ITERATOR:!0}),d}})},15389:(e,t,r)=>{"use strict";var n=r(82109),i=r(19670),o=r(49974),a=r(96767),s=r(20408);n({target:"Set",proto:!0,real:!0,forced:!0},{find:function(e){var t=i(this),r=a(t),n=o(e,arguments.length>1?arguments[1]:void 0);return s(r,(function(e,r){if(n(e,e,t))return r(e)}),{IS_ITERATOR:!0,INTERRUPTED:!0}).result}})},46006:(e,t,r)=>{r(82109)({target:"Set",stat:!0,forced:!0},{from:r(27296)})},90401:(e,t,r)=>{"use strict";var n=r(82109),i=r(35005),o=r(46916),a=r(19662),s=r(19670),l=r(36707),u=r(20408);n({target:"Set",proto:!0,real:!0,forced:!0},{intersection:function(e){var t=s(this),r=new(l(t,i("Set"))),n=a(t.has),c=a(r.add);return u(e,(function(e){o(n,t,e)&&o(c,r,e)})),r}})},45164:(e,t,r)=>{"use strict";var n=r(82109),i=r(46916),o=r(19662),a=r(19670),s=r(20408);n({target:"Set",proto:!0,real:!0,forced:!0},{isDisjointFrom:function(e){var t=a(this),r=o(t.has);return!s(e,(function(e,n){if(!0===i(r,t,e))return n()}),{INTERRUPTED:!0}).stopped}})},91238:(e,t,r)=>{"use strict";var n=r(82109),i=r(35005),o=r(46916),a=r(19662),s=r(60614),l=r(19670),u=r(18554),c=r(20408);n({target:"Set",proto:!0,real:!0,forced:!0},{isSubsetOf:function(e){var t=u(this),r=l(e),n=r.has;return s(n)||(r=new(i("Set"))(e),n=a(r.has)),!c(t,(function(e,t){if(!1===o(n,r,e))return t()}),{IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}})},54837:(e,t,r)=>{"use strict";var n=r(82109),i=r(46916),o=r(19662),a=r(19670),s=r(20408);n({target:"Set",proto:!0,real:!0,forced:!0},{isSupersetOf:function(e){var t=a(this),r=o(t.has);return!s(e,(function(e,n){if(!1===i(r,t,e))return n()}),{INTERRUPTED:!0}).stopped}})},87485:(e,t,r)=>{"use strict";var n=r(82109),i=r(1702),o=r(19670),a=r(41340),s=r(96767),l=r(20408),u=i([].join),c=[].push;n({target:"Set",proto:!0,real:!0,forced:!0},{join:function(e){var t=o(this),r=s(t),n=void 0===e?",":a(e),i=[];return l(r,c,{that:i,IS_ITERATOR:!0}),u(i,n)}})},56767:(e,t,r)=>{"use strict";var n=r(82109),i=r(35005),o=r(49974),a=r(46916),s=r(19662),l=r(19670),u=r(36707),c=r(96767),h=r(20408);n({target:"Set",proto:!0,real:!0,forced:!0},{map:function(e){var t=l(this),r=c(t),n=o(e,arguments.length>1?arguments[1]:void 0),d=new(u(t,i("Set"))),f=s(d.add);return h(r,(function(e){a(f,d,n(e,e,t))}),{IS_ITERATOR:!0}),d}})},69916:(e,t,r)=>{r(82109)({target:"Set",stat:!0,forced:!0},{of:r(82044)})},76651:(e,t,r)=>{"use strict";var n=r(82109),i=r(17854),o=r(19662),a=r(19670),s=r(96767),l=r(20408),u=i.TypeError;n({target:"Set",proto:!0,real:!0,forced:!0},{reduce:function(e){var t=a(this),r=s(t),n=arguments.length<2,i=n?void 0:arguments[1];if(o(e),l(r,(function(r){n?(n=!1,i=r):i=e(i,r,r,t)}),{IS_ITERATOR:!0}),n)throw u("Reduce of empty set with no initial value");return i}})},61437:(e,t,r)=>{"use strict";var n=r(82109),i=r(19670),o=r(49974),a=r(96767),s=r(20408);n({target:"Set",proto:!0,real:!0,forced:!0},{some:function(e){var t=i(this),r=a(t),n=o(e,arguments.length>1?arguments[1]:void 0);return s(r,(function(e,r){if(n(e,e,t))return r()}),{IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}})},35285:(e,t,r)=>{"use strict";var n=r(82109),i=r(35005),o=r(46916),a=r(19662),s=r(19670),l=r(36707),u=r(20408);n({target:"Set",proto:!0,real:!0,forced:!0},{symmetricDifference:function(e){var t=s(this),r=new(l(t,i("Set")))(t),n=a(r.delete),c=a(r.add);return u(e,(function(e){o(n,r,e)||o(c,r,e)})),r}})},39865:(e,t,r)=>{"use strict";var n=r(82109),i=r(35005),o=r(19662),a=r(19670),s=r(36707),l=r(20408);n({target:"Set",proto:!0,real:!0,forced:!0},{union:function(e){var t=a(this),r=new(s(t,i("Set")))(t);return l(e,o(r.add),{that:r}),r}})},86035:(e,t,r)=>{"use strict";var n=r(82109),i=r(28710).charAt,o=r(84488),a=r(19303),s=r(41340);n({target:"String",proto:!0,forced:!0},{at:function(e){var t=s(o(this)),r=t.length,n=a(e),l=n>=0?n:r+n;return l<0||l>=r?void 0:i(t,l)}})},67501:(e,t,r)=>{"use strict";var n=r(82109),i=r(24994),o=r(84488),a=r(41340),s=r(29909),l=r(28710),u=l.codeAt,c=l.charAt,h="String Iterator",d=s.set,f=s.getterFor(h),p=i((function(e){d(this,{type:h,string:e,index:0})}),"String",(function(){var e,t=f(this),r=t.string,n=t.index;return n>=r.length?{value:void 0,done:!0}:(e=c(r,n),t.index+=e.length,{value:{codePoint:u(e,0),position:n},done:!1})}));n({target:"String",proto:!0,forced:!0},{codePoints:function(){return new p(a(o(this)))}})},13728:(e,t,r)=>{r(76373)},27207:(e,t,r)=>{r(68757)},21568:(e,t,r)=>{r(97235)("dispose")},48824:(e,t,r)=>{r(97235)("observable")},44130:(e,t,r)=>{r(97235)("patternMatch")},78206:(e,t,r)=>{"use strict";r(82109)({target:"WeakMap",proto:!0,real:!0,forced:!0},{deleteAll:r(34092)})},76478:(e,t,r)=>{r(82109)({target:"WeakMap",stat:!0,forced:!0},{from:r(27296)})},79715:(e,t,r)=>{r(82109)({target:"WeakMap",stat:!0,forced:!0},{of:r(82044)})},43561:(e,t,r)=>{"use strict";r(82109)({target:"WeakSet",proto:!0,real:!0,forced:!0},{addAll:r(31501)})},32049:(e,t,r)=>{"use strict";r(82109)({target:"WeakSet",proto:!0,real:!0,forced:!0},{deleteAll:r(34092)})},86020:(e,t,r)=>{r(82109)({target:"WeakSet",stat:!0,forced:!0},{from:r(27296)})},56585:(e,t,r)=>{r(82109)({target:"WeakSet",stat:!0,forced:!0},{of:r(82044)})},54747:(e,t,r)=>{var n=r(17854),i=r(48324),o=r(98509),a=r(18533),s=r(68880),l=function(e){if(e&&e.forEach!==a)try{s(e,"forEach",a)}catch(t){e.forEach=a}};for(var u in i)i[u]&&l(n[u]&&n[u].prototype);l(o)},33948:(e,t,r)=>{var n=r(17854),i=r(48324),o=r(98509),a=r(66992),s=r(68880),l=r(5112),u=l("iterator"),c=l("toStringTag"),h=a.values,d=function(e,t){if(e){if(e[u]!==h)try{s(e,u,h)}catch(t){e[u]=h}if(e[c]||s(e,c,t),i[t])for(var r in a)if(e[r]!==a[r])try{s(e,r,a[r])}catch(t){e[r]=a[r]}}};for(var f in i)d(n[f]&&n[f].prototype,f);d(o,"DOMTokenList")},84633:(e,t,r)=>{var n=r(82109),i=r(17854),o=r(20261);n({global:!0,bind:!0,enumerable:!0,forced:!i.setImmediate||!i.clearImmediate},{setImmediate:o.set,clearImmediate:o.clear})},85844:(e,t,r)=>{var n=r(82109),i=r(17854),o=r(95948),a=r(19662),s=r(48053),l=r(35268),u=i.process;n({global:!0,enumerable:!0,noTargetGet:!0},{queueMicrotask:function(e){s(arguments.length,1),a(e);var t=l&&u.domain;o(t?t.bind(e):e)}})},41637:(e,t,r)=>{"use strict";r(66992);var n=r(82109),i=r(17854),o=r(35005),a=r(46916),s=r(1702),l=r(590),u=r(31320),c=r(12248),h=r(58003),d=r(24994),f=r(29909),p=r(25787),m=r(60614),g=r(92597),v=r(49974),y=r(70648),b=r(19670),x=r(70111),_=r(41340),E=r(70030),w=r(79114),A=r(18554),S=r(71246),M=r(48053),T=r(5112),C=r(94362),P=T("iterator"),D="URLSearchParams",L="URLSearchParamsIterator",R=f.set,I=f.getterFor(D),O=f.getterFor(L),N=o("fetch"),k=o("Request"),F=o("Headers"),V=k&&k.prototype,U=F&&F.prototype,B=i.RegExp,z=i.TypeError,G=i.decodeURIComponent,H=i.encodeURIComponent,W=s("".charAt),j=s([].join),q=s([].push),X=s("".replace),Y=s([].shift),K=s([].splice),Z=s("".split),Q=s("".slice),J=/\+/g,$=Array(4),ee=function(e){return $[e-1]||($[e-1]=B("((?:%[\\da-f]{2}){"+e+"})","gi"))},te=function(e){try{return G(e)}catch(t){return e}},re=function(e){var t=X(e,J," "),r=4;try{return G(t)}catch(e){for(;r;)t=X(t,ee(r--),te);return t}},ne=/[!'()~]|%20/g,ie={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},oe=function(e){return ie[e]},ae=function(e){return X(H(e),ne,oe)},se=d((function(e,t){R(this,{type:L,iterator:A(I(e).entries),kind:t})}),"Iterator",(function(){var e=O(this),t=e.kind,r=e.iterator.next(),n=r.value;return r.done||(r.value="keys"===t?n.key:"values"===t?n.value:[n.key,n.value]),r}),!0),le=function(e){this.entries=[],this.url=null,void 0!==e&&(x(e)?this.parseObject(e):this.parseQuery("string"==typeof e?"?"===W(e,0)?Q(e,1):e:_(e)))};le.prototype={type:D,bindURL:function(e){this.url=e,this.update()},parseObject:function(e){var t,r,n,i,o,s,l,u=S(e);if(u)for(r=(t=A(e,u)).next;!(n=a(r,t)).done;){if(o=(i=A(b(n.value))).next,(s=a(o,i)).done||(l=a(o,i)).done||!a(o,i).done)throw z("Expected sequence with length 2");q(this.entries,{key:_(s.value),value:_(l.value)})}else for(var c in e)g(e,c)&&q(this.entries,{key:c,value:_(e[c])})},parseQuery:function(e){if(e)for(var t,r,n=Z(e,"&"),i=0;i<n.length;)(t=n[i++]).length&&(r=Z(t,"="),q(this.entries,{key:re(Y(r)),value:re(j(r,"="))}))},serialize:function(){for(var e,t=this.entries,r=[],n=0;n<t.length;)e=t[n++],q(r,ae(e.key)+"="+ae(e.value));return j(r,"&")},update:function(){this.entries.length=0,this.parseQuery(this.url.query)},updateURL:function(){this.url&&this.url.update()}};var ue=function(){p(this,ce);var e=arguments.length>0?arguments[0]:void 0;R(this,new le(e))},ce=ue.prototype;if(c(ce,{append:function(e,t){M(arguments.length,2);var r=I(this);q(r.entries,{key:_(e),value:_(t)}),r.updateURL()},delete:function(e){M(arguments.length,1);for(var t=I(this),r=t.entries,n=_(e),i=0;i<r.length;)r[i].key===n?K(r,i,1):i++;t.updateURL()},get:function(e){M(arguments.length,1);for(var t=I(this).entries,r=_(e),n=0;n<t.length;n++)if(t[n].key===r)return t[n].value;return null},getAll:function(e){M(arguments.length,1);for(var t=I(this).entries,r=_(e),n=[],i=0;i<t.length;i++)t[i].key===r&&q(n,t[i].value);return n},has:function(e){M(arguments.length,1);for(var t=I(this).entries,r=_(e),n=0;n<t.length;)if(t[n++].key===r)return!0;return!1},set:function(e,t){M(arguments.length,1);for(var r,n=I(this),i=n.entries,o=!1,a=_(e),s=_(t),l=0;l<i.length;l++)(r=i[l]).key===a&&(o?K(i,l--,1):(o=!0,r.value=s));o||q(i,{key:a,value:s}),n.updateURL()},sort:function(){var e=I(this);C(e.entries,(function(e,t){return e.key>t.key?1:-1})),e.updateURL()},forEach:function(e){for(var t,r=I(this).entries,n=v(e,arguments.length>1?arguments[1]:void 0),i=0;i<r.length;)n((t=r[i++]).value,t.key,this)},keys:function(){return new se(this,"keys")},values:function(){return new se(this,"values")},entries:function(){return new se(this,"entries")}},{enumerable:!0}),u(ce,P,ce.entries,{name:"entries"}),u(ce,"toString",(function(){return I(this).serialize()}),{enumerable:!0}),h(ue,D),n({global:!0,forced:!l},{URLSearchParams:ue}),!l&&m(F)){var he=s(U.has),de=s(U.set),fe=function(e){if(x(e)){var t,r=e.body;if(y(r)===D)return t=e.headers?new F(e.headers):new F,he(t,"content-type")||de(t,"content-type","application/x-www-form-urlencoded;charset=UTF-8"),E(e,{body:w(0,_(r)),headers:w(0,t)})}return e};if(m(N)&&n({global:!0,enumerable:!0,forced:!0},{fetch:function(e){return N(e,arguments.length>1?fe(arguments[1]):{})}}),m(k)){var pe=function(e){return p(this,V),new k(e,arguments.length>1?fe(arguments[1]):{})};V.constructor=pe,pe.prototype=V,n({global:!0,forced:!0},{Request:pe})}}e.exports={URLSearchParams:ue,getState:I}},60285:(e,t,r)=>{"use strict";r(78783);var n,i=r(82109),o=r(19781),a=r(590),s=r(17854),l=r(49974),u=r(1702),c=r(36048).f,h=r(31320),d=r(25787),f=r(92597),p=r(21574),m=r(48457),g=r(41589),v=r(28710).codeAt,y=r(33197),b=r(41340),x=r(58003),_=r(48053),E=r(41637),w=r(29909),A=w.set,S=w.getterFor("URL"),M=E.URLSearchParams,T=E.getState,C=s.URL,P=s.TypeError,D=s.parseInt,L=Math.floor,R=Math.pow,I=u("".charAt),O=u(/./.exec),N=u([].join),k=u(1..toString),F=u([].pop),V=u([].push),U=u("".replace),B=u([].shift),z=u("".split),G=u("".slice),H=u("".toLowerCase),W=u([].unshift),j="Invalid scheme",q="Invalid host",X="Invalid port",Y=/[a-z]/i,K=/[\d+-.a-z]/i,Z=/\d/,Q=/^0x/i,J=/^[0-7]+$/,$=/^\d+$/,ee=/^[\da-f]+$/i,te=/[\0\t\n\r #%/:<>?@[\\\]^|]/,re=/[\0\t\n\r #/:<>?@[\\\]^|]/,ne=/^[\u0000-\u0020]+|[\u0000-\u0020]+$/g,ie=/[\t\n\r]/g,oe=function(e){var t,r,n,i;if("number"==typeof e){for(t=[],r=0;r<4;r++)W(t,e%256),e=L(e/256);return N(t,".")}if("object"==typeof e){for(t="",n=function(e){for(var t=null,r=1,n=null,i=0,o=0;o<8;o++)0!==e[o]?(i>r&&(t=n,r=i),n=null,i=0):(null===n&&(n=o),++i);return i>r&&(t=n,r=i),t}(e),r=0;r<8;r++)i&&0===e[r]||(i&&(i=!1),n===r?(t+=r?":":"::",i=!0):(t+=k(e[r],16),r<7&&(t+=":")));return"["+t+"]"}return e},ae={},se=p({},ae,{" ":1,'"':1,"<":1,">":1,"`":1}),le=p({},se,{"#":1,"?":1,"{":1,"}":1}),ue=p({},le,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),ce=function(e,t){var r=v(e,0);return r>32&&r<127&&!f(t,e)?e:encodeURIComponent(e)},he={ftp:21,file:null,http:80,https:443,ws:80,wss:443},de=function(e,t){var r;return 2==e.length&&O(Y,I(e,0))&&(":"==(r=I(e,1))||!t&&"|"==r)},fe=function(e){var t;return e.length>1&&de(G(e,0,2))&&(2==e.length||"/"===(t=I(e,2))||"\\"===t||"?"===t||"#"===t)},pe=function(e){return"."===e||"%2e"===H(e)},me={},ge={},ve={},ye={},be={},xe={},_e={},Ee={},we={},Ae={},Se={},Me={},Te={},Ce={},Pe={},De={},Le={},Re={},Ie={},Oe={},Ne={},ke=function(e,t,r){var n,i,o,a=b(e);if(t){if(i=this.parse(a))throw P(i);this.searchParams=null}else{if(void 0!==r&&(n=new ke(r,!0)),i=this.parse(a,null,n))throw P(i);(o=T(new M)).bindURL(this),this.searchParams=o}};ke.prototype={type:"URL",parse:function(e,t,r){var i,o,a,s,l,u=this,c=t||me,h=0,d="",p=!1,v=!1,y=!1;for(e=b(e),t||(u.scheme="",u.username="",u.password="",u.host=null,u.port=null,u.path=[],u.query=null,u.fragment=null,u.cannotBeABaseURL=!1,e=U(e,ne,"")),e=U(e,ie,""),i=m(e);h<=i.length;){switch(o=i[h],c){case me:if(!o||!O(Y,o)){if(t)return j;c=ve;continue}d+=H(o),c=ge;break;case ge:if(o&&(O(K,o)||"+"==o||"-"==o||"."==o))d+=H(o);else{if(":"!=o){if(t)return j;d="",c=ve,h=0;continue}if(t&&(u.isSpecial()!=f(he,d)||"file"==d&&(u.includesCredentials()||null!==u.port)||"file"==u.scheme&&!u.host))return;if(u.scheme=d,t)return void(u.isSpecial()&&he[u.scheme]==u.port&&(u.port=null));d="","file"==u.scheme?c=Ce:u.isSpecial()&&r&&r.scheme==u.scheme?c=ye:u.isSpecial()?c=Ee:"/"==i[h+1]?(c=be,h++):(u.cannotBeABaseURL=!0,V(u.path,""),c=Ie)}break;case ve:if(!r||r.cannotBeABaseURL&&"#"!=o)return j;if(r.cannotBeABaseURL&&"#"==o){u.scheme=r.scheme,u.path=g(r.path),u.query=r.query,u.fragment="",u.cannotBeABaseURL=!0,c=Ne;break}c="file"==r.scheme?Ce:xe;continue;case ye:if("/"!=o||"/"!=i[h+1]){c=xe;continue}c=we,h++;break;case be:if("/"==o){c=Ae;break}c=Re;continue;case xe:if(u.scheme=r.scheme,o==n)u.username=r.username,u.password=r.password,u.host=r.host,u.port=r.port,u.path=g(r.path),u.query=r.query;else if("/"==o||"\\"==o&&u.isSpecial())c=_e;else if("?"==o)u.username=r.username,u.password=r.password,u.host=r.host,u.port=r.port,u.path=g(r.path),u.query="",c=Oe;else{if("#"!=o){u.username=r.username,u.password=r.password,u.host=r.host,u.port=r.port,u.path=g(r.path),u.path.length--,c=Re;continue}u.username=r.username,u.password=r.password,u.host=r.host,u.port=r.port,u.path=g(r.path),u.query=r.query,u.fragment="",c=Ne}break;case _e:if(!u.isSpecial()||"/"!=o&&"\\"!=o){if("/"!=o){u.username=r.username,u.password=r.password,u.host=r.host,u.port=r.port,c=Re;continue}c=Ae}else c=we;break;case Ee:if(c=we,"/"!=o||"/"!=I(d,h+1))continue;h++;break;case we:if("/"!=o&&"\\"!=o){c=Ae;continue}break;case Ae:if("@"==o){p&&(d="%40"+d),p=!0,a=m(d);for(var x=0;x<a.length;x++){var _=a[x];if(":"!=_||y){var E=ce(_,ue);y?u.password+=E:u.username+=E}else y=!0}d=""}else if(o==n||"/"==o||"?"==o||"#"==o||"\\"==o&&u.isSpecial()){if(p&&""==d)return"Invalid authority";h-=m(d).length+1,d="",c=Se}else d+=o;break;case Se:case Me:if(t&&"file"==u.scheme){c=De;continue}if(":"!=o||v){if(o==n||"/"==o||"?"==o||"#"==o||"\\"==o&&u.isSpecial()){if(u.isSpecial()&&""==d)return q;if(t&&""==d&&(u.includesCredentials()||null!==u.port))return;if(s=u.parseHost(d))return s;if(d="",c=Le,t)return;continue}"["==o?v=!0:"]"==o&&(v=!1),d+=o}else{if(""==d)return q;if(s=u.parseHost(d))return s;if(d="",c=Te,t==Me)return}break;case Te:if(!O(Z,o)){if(o==n||"/"==o||"?"==o||"#"==o||"\\"==o&&u.isSpecial()||t){if(""!=d){var w=D(d,10);if(w>65535)return X;u.port=u.isSpecial()&&w===he[u.scheme]?null:w,d=""}if(t)return;c=Le;continue}return X}d+=o;break;case Ce:if(u.scheme="file","/"==o||"\\"==o)c=Pe;else{if(!r||"file"!=r.scheme){c=Re;continue}if(o==n)u.host=r.host,u.path=g(r.path),u.query=r.query;else if("?"==o)u.host=r.host,u.path=g(r.path),u.query="",c=Oe;else{if("#"!=o){fe(N(g(i,h),""))||(u.host=r.host,u.path=g(r.path),u.shortenPath()),c=Re;continue}u.host=r.host,u.path=g(r.path),u.query=r.query,u.fragment="",c=Ne}}break;case Pe:if("/"==o||"\\"==o){c=De;break}r&&"file"==r.scheme&&!fe(N(g(i,h),""))&&(de(r.path[0],!0)?V(u.path,r.path[0]):u.host=r.host),c=Re;continue;case De:if(o==n||"/"==o||"\\"==o||"?"==o||"#"==o){if(!t&&de(d))c=Re;else if(""==d){if(u.host="",t)return;c=Le}else{if(s=u.parseHost(d))return s;if("localhost"==u.host&&(u.host=""),t)return;d="",c=Le}continue}d+=o;break;case Le:if(u.isSpecial()){if(c=Re,"/"!=o&&"\\"!=o)continue}else if(t||"?"!=o)if(t||"#"!=o){if(o!=n&&(c=Re,"/"!=o))continue}else u.fragment="",c=Ne;else u.query="",c=Oe;break;case Re:if(o==n||"/"==o||"\\"==o&&u.isSpecial()||!t&&("?"==o||"#"==o)){if(".."===(l=H(l=d))||"%2e."===l||".%2e"===l||"%2e%2e"===l?(u.shortenPath(),"/"==o||"\\"==o&&u.isSpecial()||V(u.path,"")):pe(d)?"/"==o||"\\"==o&&u.isSpecial()||V(u.path,""):("file"==u.scheme&&!u.path.length&&de(d)&&(u.host&&(u.host=""),d=I(d,0)+":"),V(u.path,d)),d="","file"==u.scheme&&(o==n||"?"==o||"#"==o))for(;u.path.length>1&&""===u.path[0];)B(u.path);"?"==o?(u.query="",c=Oe):"#"==o&&(u.fragment="",c=Ne)}else d+=ce(o,le);break;case Ie:"?"==o?(u.query="",c=Oe):"#"==o?(u.fragment="",c=Ne):o!=n&&(u.path[0]+=ce(o,ae));break;case Oe:t||"#"!=o?o!=n&&("'"==o&&u.isSpecial()?u.query+="%27":u.query+="#"==o?"%23":ce(o,ae)):(u.fragment="",c=Ne);break;case Ne:o!=n&&(u.fragment+=ce(o,se))}h++}},parseHost:function(e){var t,r,n;if("["==I(e,0)){if("]"!=I(e,e.length-1))return q;if(t=function(e){var t,r,n,i,o,a,s,l=[0,0,0,0,0,0,0,0],u=0,c=null,h=0,d=function(){return I(e,h)};if(":"==d()){if(":"!=I(e,1))return;h+=2,c=++u}for(;d();){if(8==u)return;if(":"!=d()){for(t=r=0;r<4&&O(ee,d());)t=16*t+D(d(),16),h++,r++;if("."==d()){if(0==r)return;if(h-=r,u>6)return;for(n=0;d();){if(i=null,n>0){if(!("."==d()&&n<4))return;h++}if(!O(Z,d()))return;for(;O(Z,d());){if(o=D(d(),10),null===i)i=o;else{if(0==i)return;i=10*i+o}if(i>255)return;h++}l[u]=256*l[u]+i,2!=++n&&4!=n||u++}if(4!=n)return;break}if(":"==d()){if(h++,!d())return}else if(d())return;l[u++]=t}else{if(null!==c)return;h++,c=++u}}if(null!==c)for(a=u-c,u=7;0!=u&&a>0;)s=l[u],l[u--]=l[c+a-1],l[c+--a]=s;else if(8!=u)return;return l}(G(e,1,-1)),!t)return q;this.host=t}else if(this.isSpecial()){if(e=y(e),O(te,e))return q;if(t=function(e){var t,r,n,i,o,a,s,l=z(e,".");if(l.length&&""==l[l.length-1]&&l.length--,(t=l.length)>4)return e;for(r=[],n=0;n<t;n++){if(""==(i=l[n]))return e;if(o=10,i.length>1&&"0"==I(i,0)&&(o=O(Q,i)?16:8,i=G(i,8==o?1:2)),""===i)a=0;else{if(!O(10==o?$:8==o?J:ee,i))return e;a=D(i,o)}V(r,a)}for(n=0;n<t;n++)if(a=r[n],n==t-1){if(a>=R(256,5-t))return null}else if(a>255)return null;for(s=F(r),n=0;n<r.length;n++)s+=r[n]*R(256,3-n);return s}(e),null===t)return q;this.host=t}else{if(O(re,e))return q;for(t="",r=m(e),n=0;n<r.length;n++)t+=ce(r[n],ae);this.host=t}},cannotHaveUsernamePasswordPort:function(){return!this.host||this.cannotBeABaseURL||"file"==this.scheme},includesCredentials:function(){return""!=this.username||""!=this.password},isSpecial:function(){return f(he,this.scheme)},shortenPath:function(){var e=this.path,t=e.length;!t||"file"==this.scheme&&1==t&&de(e[0],!0)||e.length--},serialize:function(){var e=this,t=e.scheme,r=e.username,n=e.password,i=e.host,o=e.port,a=e.path,s=e.query,l=e.fragment,u=t+":";return null!==i?(u+="//",e.includesCredentials()&&(u+=r+(n?":"+n:"")+"@"),u+=oe(i),null!==o&&(u+=":"+o)):"file"==t&&(u+="//"),u+=e.cannotBeABaseURL?a[0]:a.length?"/"+N(a,"/"):"",null!==s&&(u+="?"+s),null!==l&&(u+="#"+l),u},setHref:function(e){var t=this.parse(e);if(t)throw P(t);this.searchParams.update()},getOrigin:function(){var e=this.scheme,t=this.port;if("blob"==e)try{return new Fe(e.path[0]).origin}catch(e){return"null"}return"file"!=e&&this.isSpecial()?e+"://"+oe(this.host)+(null!==t?":"+t:""):"null"},getProtocol:function(){return this.scheme+":"},setProtocol:function(e){this.parse(b(e)+":",me)},getUsername:function(){return this.username},setUsername:function(e){var t=m(b(e));if(!this.cannotHaveUsernamePasswordPort()){this.username="";for(var r=0;r<t.length;r++)this.username+=ce(t[r],ue)}},getPassword:function(){return this.password},setPassword:function(e){var t=m(b(e));if(!this.cannotHaveUsernamePasswordPort()){this.password="";for(var r=0;r<t.length;r++)this.password+=ce(t[r],ue)}},getHost:function(){var e=this.host,t=this.port;return null===e?"":null===t?oe(e):oe(e)+":"+t},setHost:function(e){this.cannotBeABaseURL||this.parse(e,Se)},getHostname:function(){var e=this.host;return null===e?"":oe(e)},setHostname:function(e){this.cannotBeABaseURL||this.parse(e,Me)},getPort:function(){var e=this.port;return null===e?"":b(e)},setPort:function(e){this.cannotHaveUsernamePasswordPort()||(""==(e=b(e))?this.port=null:this.parse(e,Te))},getPathname:function(){var e=this.path;return this.cannotBeABaseURL?e[0]:e.length?"/"+N(e,"/"):""},setPathname:function(e){this.cannotBeABaseURL||(this.path=[],this.parse(e,Le))},getSearch:function(){var e=this.query;return e?"?"+e:""},setSearch:function(e){""==(e=b(e))?this.query=null:("?"==I(e,0)&&(e=G(e,1)),this.query="",this.parse(e,Oe)),this.searchParams.update()},getSearchParams:function(){return this.searchParams.facade},getHash:function(){var e=this.fragment;return e?"#"+e:""},setHash:function(e){""!=(e=b(e))?("#"==I(e,0)&&(e=G(e,1)),this.fragment="",this.parse(e,Ne)):this.fragment=null},update:function(){this.query=this.searchParams.serialize()||null}};var Fe=function(e){var t=d(this,Ve),r=_(arguments.length,1)>1?arguments[1]:void 0,n=A(t,new ke(e,!1,r));o||(t.href=n.serialize(),t.origin=n.getOrigin(),t.protocol=n.getProtocol(),t.username=n.getUsername(),t.password=n.getPassword(),t.host=n.getHost(),t.hostname=n.getHostname(),t.port=n.getPort(),t.pathname=n.getPathname(),t.search=n.getSearch(),t.searchParams=n.getSearchParams(),t.hash=n.getHash())},Ve=Fe.prototype,Ue=function(e,t){return{get:function(){return S(this)[e]()},set:t&&function(e){return S(this)[t](e)},configurable:!0,enumerable:!0}};if(o&&c(Ve,{href:Ue("serialize","setHref"),origin:Ue("getOrigin"),protocol:Ue("getProtocol","setProtocol"),username:Ue("getUsername","setUsername"),password:Ue("getPassword","setPassword"),host:Ue("getHost","setHost"),hostname:Ue("getHostname","setHostname"),port:Ue("getPort","setPort"),pathname:Ue("getPathname","setPathname"),search:Ue("getSearch","setSearch"),searchParams:Ue("getSearchParams"),hash:Ue("getHash","setHash")}),h(Ve,"toJSON",(function(){return S(this).serialize()}),{enumerable:!0}),h(Ve,"toString",(function(){return S(this).serialize()}),{enumerable:!0}),C){var Be=C.createObjectURL,ze=C.revokeObjectURL;Be&&h(Fe,"createObjectURL",l(Be,C)),ze&&h(Fe,"revokeObjectURL",l(ze,C))}x(Fe,"URL"),i({global:!0,forced:!a,sham:!o},{URL:Fe})},83753:(e,t,r)=>{"use strict";var n=r(82109),i=r(46916);n({target:"URL",proto:!0,enumerable:!0},{toJSON:function(){return i(URL.prototype.toString,this)}})},54098:function(e,t){var r="undefined"!=typeof self?self:this,n=function(){function e(){this.fetch=!1,this.DOMException=r.DOMException}return e.prototype=r,new e}();!function(e){!function(t){var r="URLSearchParams"in e,n="Symbol"in e&&"iterator"in Symbol,i="FileReader"in e&&"Blob"in e&&function(){try{return new Blob,!0}catch(e){return!1}}(),o="FormData"in e,a="ArrayBuffer"in e;if(a)var s=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],l=ArrayBuffer.isView||function(e){return e&&s.indexOf(Object.prototype.toString.call(e))>-1};function u(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function c(e){return"string"!=typeof e&&(e=String(e)),e}function h(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return n&&(t[Symbol.iterator]=function(){return t}),t}function d(e){this.map={},e instanceof d?e.forEach((function(e,t){this.append(t,e)}),this):Array.isArray(e)?e.forEach((function(e){this.append(e[0],e[1])}),this):e&&Object.getOwnPropertyNames(e).forEach((function(t){this.append(t,e[t])}),this)}function f(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function p(e){return new Promise((function(t,r){e.onload=function(){t(e.result)},e.onerror=function(){r(e.error)}}))}function m(e){var t=new FileReader,r=p(t);return t.readAsArrayBuffer(e),r}function g(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function v(){return this.bodyUsed=!1,this._initBody=function(e){var t;this._bodyInit=e,e?"string"==typeof e?this._bodyText=e:i&&Blob.prototype.isPrototypeOf(e)?this._bodyBlob=e:o&&FormData.prototype.isPrototypeOf(e)?this._bodyFormData=e:r&&URLSearchParams.prototype.isPrototypeOf(e)?this._bodyText=e.toString():a&&i&&((t=e)&&DataView.prototype.isPrototypeOf(t))?(this._bodyArrayBuffer=g(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):a&&(ArrayBuffer.prototype.isPrototypeOf(e)||l(e))?this._bodyArrayBuffer=g(e):this._bodyText=e=Object.prototype.toString.call(e):this._bodyText="",this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):r&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},i&&(this.blob=function(){var e=f(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?f(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(m)}),this.text=function(){var e,t,r,n=f(this);if(n)return n;if(this._bodyBlob)return e=this._bodyBlob,t=new FileReader,r=p(t),t.readAsText(e),r;if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),r=new Array(t.length),n=0;n<t.length;n++)r[n]=String.fromCharCode(t[n]);return r.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},o&&(this.formData=function(){return this.text().then(x)}),this.json=function(){return this.text().then(JSON.parse)},this}d.prototype.append=function(e,t){e=u(e),t=c(t);var r=this.map[e];this.map[e]=r?r+", "+t:t},d.prototype.delete=function(e){delete this.map[u(e)]},d.prototype.get=function(e){return e=u(e),this.has(e)?this.map[e]:null},d.prototype.has=function(e){return this.map.hasOwnProperty(u(e))},d.prototype.set=function(e,t){this.map[u(e)]=c(t)},d.prototype.forEach=function(e,t){for(var r in this.map)this.map.hasOwnProperty(r)&&e.call(t,this.map[r],r,this)},d.prototype.keys=function(){var e=[];return this.forEach((function(t,r){e.push(r)})),h(e)},d.prototype.values=function(){var e=[];return this.forEach((function(t){e.push(t)})),h(e)},d.prototype.entries=function(){var e=[];return this.forEach((function(t,r){e.push([r,t])})),h(e)},n&&(d.prototype[Symbol.iterator]=d.prototype.entries);var y=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function b(e,t){var r,n,i=(t=t||{}).body;if(e instanceof b){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new d(e.headers)),this.method=e.method,this.mode=e.mode,this.signal=e.signal,i||null==e._bodyInit||(i=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"same-origin",!t.headers&&this.headers||(this.headers=new d(t.headers)),this.method=(r=t.method||this.method||"GET",n=r.toUpperCase(),y.indexOf(n)>-1?n:r),this.mode=t.mode||this.mode||null,this.signal=t.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&i)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(i)}function x(e){var t=new FormData;return e.trim().split("&").forEach((function(e){if(e){var r=e.split("="),n=r.shift().replace(/\+/g," "),i=r.join("=").replace(/\+/g," ");t.append(decodeURIComponent(n),decodeURIComponent(i))}})),t}function _(e,t){t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new d(t.headers),this.url=t.url||"",this._initBody(e)}b.prototype.clone=function(){return new b(this,{body:this._bodyInit})},v.call(b.prototype),v.call(_.prototype),_.prototype.clone=function(){return new _(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new d(this.headers),url:this.url})},_.error=function(){var e=new _(null,{status:0,statusText:""});return e.type="error",e};var E=[301,302,303,307,308];_.redirect=function(e,t){if(-1===E.indexOf(t))throw new RangeError("Invalid status code");return new _(null,{status:t,headers:{location:e}})},t.DOMException=e.DOMException;try{new t.DOMException}catch(e){t.DOMException=function(e,t){this.message=e,this.name=t;var r=Error(e);this.stack=r.stack},t.DOMException.prototype=Object.create(Error.prototype),t.DOMException.prototype.constructor=t.DOMException}function w(e,r){return new Promise((function(n,o){var a=new b(e,r);if(a.signal&&a.signal.aborted)return o(new t.DOMException("Aborted","AbortError"));var s=new XMLHttpRequest;function l(){s.abort()}s.onload=function(){var e,t,r={status:s.status,statusText:s.statusText,headers:(e=s.getAllResponseHeaders()||"",t=new d,e.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach((function(e){var r=e.split(":"),n=r.shift().trim();if(n){var i=r.join(":").trim();t.append(n,i)}})),t)};r.url="responseURL"in s?s.responseURL:r.headers.get("X-Request-URL");var i="response"in s?s.response:s.responseText;n(new _(i,r))},s.onerror=function(){o(new TypeError("Network request failed"))},s.ontimeout=function(){o(new TypeError("Network request failed"))},s.onabort=function(){o(new t.DOMException("Aborted","AbortError"))},s.open(a.method,a.url,!0),"include"===a.credentials?s.withCredentials=!0:"omit"===a.credentials&&(s.withCredentials=!1),"responseType"in s&&i&&(s.responseType="blob"),a.headers.forEach((function(e,t){s.setRequestHeader(t,e)})),a.signal&&(a.signal.addEventListener("abort",l),s.onreadystatechange=function(){4===s.readyState&&a.signal.removeEventListener("abort",l)}),s.send(void 0===a._bodyInit?null:a._bodyInit)}))}w.polyfill=!0,e.fetch||(e.fetch=w,e.Headers=d,e.Request=b,e.Response=_),t.Headers=d,t.Request=b,t.Response=_,t.fetch=w,Object.defineProperty(t,"__esModule",{value:!0})}({})}(n),n.fetch.ponyfill=!0,delete n.fetch.polyfill;var i=n;(t=i.fetch).default=i.fetch,t.fetch=i.fetch,t.Headers=i.Headers,t.Request=i.Request,t.Response=i.Response,e.exports=t},24414:function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{l(n.next(e))}catch(e){o(e)}}function s(e){try{l(n.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}l((n=n.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};Object.defineProperty(t,"__esModule",{value:!0});var o=r(33242),a=r(5076);t.backOff=function(e,t){return void 0===t&&(t={}),n(this,void 0,void 0,(function(){var r;return i(this,(function(n){switch(n.label){case 0:return r=o.getSanitizedOptions(t),[4,new s(e,r).execute()];case 1:return[2,n.sent()]}}))}))};var s=function(){function e(e,t){this.request=e,this.options=t,this.attemptNumber=0}return e.prototype.execute=function(){return n(this,void 0,void 0,(function(){var e;return i(this,(function(t){switch(t.label){case 0:if(this.attemptLimitReached)return[3,7];t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.applyDelay()];case 2:return t.sent(),[4,this.request()];case 3:return[2,t.sent()];case 4:return e=t.sent(),this.attemptNumber++,[4,this.options.retry(e,this.attemptNumber)];case 5:if(!t.sent()||this.attemptLimitReached)throw e;return[3,6];case 6:return[3,0];case 7:throw new Error("Something went wrong.")}}))}))},Object.defineProperty(e.prototype,"attemptLimitReached",{get:function(){return this.attemptNumber>=this.options.numOfAttempts},enumerable:!0,configurable:!0}),e.prototype.applyDelay=function(){return n(this,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return[4,a.DelayFactory(this.options,this.attemptNumber).apply()];case 1:return e.sent(),[2]}}))}))},e}()},79966:function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},n(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t}(r(21617).Delay);t.AlwaysDelay=o},21617:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(16755),i=function(){function e(e){this.options=e,this.attempt=0}return e.prototype.apply=function(){var e=this;return new Promise((function(t){return setTimeout(t,e.jitteredDelay)}))},e.prototype.setAttemptNumber=function(e){this.attempt=e},Object.defineProperty(e.prototype,"jitteredDelay",{get:function(){return n.JitterFactory(this.options)(this.delay)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"delay",{get:function(){var e=this.options.startingDelay,t=this.options.timeMultiple,r=this.numOfDelayedAttempts,n=e*Math.pow(t,r);return Math.min(n,this.options.maxDelay)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"numOfDelayedAttempts",{get:function(){return this.attempt},enumerable:!0,configurable:!0}),e}();t.Delay=i},5076:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(21954),i=r(79966);t.DelayFactory=function(e,t){var r=function(e){if(!e.delayFirstAttempt)return new n.SkipFirstDelay(e);return new i.AlwaysDelay(e)}(e);return r.setAttemptNumber(t),r}},21954:function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},n(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),o=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{l(n.next(e))}catch(e){o(e)}}function s(e){try{l(n.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}l((n=n.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.apply=function(){return o(this,void 0,void 0,(function(){return a(this,(function(t){return[2,!!this.isFirstAttempt||e.prototype.apply.call(this)]}))}))},Object.defineProperty(t.prototype,"isFirstAttempt",{get:function(){return 0===this.attempt},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"numOfDelayedAttempts",{get:function(){return this.attempt-1},enumerable:!0,configurable:!0}),t}(r(21617).Delay);t.SkipFirstDelay=s},59813:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fullJitter=function(e){var t=Math.random()*e;return Math.round(t)}},16755:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(59813),i=r(20478);t.JitterFactory=function(e){return"full"===e.jitter?n.fullJitter:i.noJitter}},20478:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.noJitter=function(e){return e}},33242:function(e,t){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},r.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var n={delayFirstAttempt:!1,jitter:"none",maxDelay:1/0,numOfAttempts:10,retry:function(){return!0},startingDelay:100,timeMultiple:2};t.getSanitizedOptions=function(e){var t=r(r({},n),e);return t.numOfAttempts<1&&(t.numOfAttempts=1),t}},71224:(e,t,r)=>{"use strict";function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?Object(arguments[t]):{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){i(e,t,r[t])}))}return e}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function l(e,t,r){return t&&s(e.prototype,t),r&&s(e,r),e}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function c(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?u(e):t}function h(e){return h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},h(e)}function d(e,t){return d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},d(e,t)}function f(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}r.d(t,{Z:()=>j});var p={type:"logger",log:function(e){this.output("log",e)},warn:function(e){this.output("warn",e)},error:function(e){this.output("error",e)},output:function(e,t){console&&console[e]&&console[e].apply(console,t)}},m=new(function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};a(this,e),this.init(t,r)}return l(e,[{key:"init",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.prefix=t.prefix||"i18next:",this.logger=e||p,this.options=t,this.debug=t.debug}},{key:"setDebug",value:function(e){this.debug=e}},{key:"log",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this.forward(t,"log","",!0)}},{key:"warn",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this.forward(t,"warn","",!0)}},{key:"error",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this.forward(t,"error","")}},{key:"deprecate",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this.forward(t,"warn","WARNING DEPRECATED: ",!0)}},{key:"forward",value:function(e,t,r,n){return n&&!this.debug?null:("string"==typeof e[0]&&(e[0]="".concat(r).concat(this.prefix," ").concat(e[0])),this.logger[t](e))}},{key:"create",value:function(t){return new e(this.logger,o({},{prefix:"".concat(this.prefix,":").concat(t,":")},this.options))}}]),e}()),g=function(){function e(){a(this,e),this.observers={}}return l(e,[{key:"on",value:function(e,t){var r=this;return e.split(" ").forEach((function(e){r.observers[e]=r.observers[e]||[],r.observers[e].push(t)})),this}},{key:"off",value:function(e,t){this.observers[e]&&(t?this.observers[e]=this.observers[e].filter((function(e){return e!==t})):delete this.observers[e])}},{key:"emit",value:function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];if(this.observers[e]){var i=[].concat(this.observers[e]);i.forEach((function(e){e.apply(void 0,r)}))}if(this.observers["*"]){var o=[].concat(this.observers["*"]);o.forEach((function(t){t.apply(t,[e].concat(r))}))}}}]),e}();function v(){var e,t,r=new Promise((function(r,n){e=r,t=n}));return r.resolve=e,r.reject=t,r}function y(e){return null==e?"":""+e}function b(e,t,r){e.forEach((function(e){t[e]&&(r[e]=t[e])}))}function x(e,t,r){function n(e){return e&&e.indexOf("###")>-1?e.replace(/###/g,"."):e}function i(){return!e||"string"==typeof e}for(var o="string"!=typeof t?[].concat(t):t.split(".");o.length>1;){if(i())return{};var a=n(o.shift());!e[a]&&r&&(e[a]=new r),e=Object.prototype.hasOwnProperty.call(e,a)?e[a]:{}}return i()?{}:{obj:e,k:n(o.shift())}}function _(e,t,r){var n=x(e,t,Object);n.obj[n.k]=r}function E(e,t){var r=x(e,t),n=r.obj,i=r.k;if(n)return n[i]}function w(e,t,r){var n=E(e,r);return void 0!==n?n:E(t,r)}function A(e,t,r){for(var n in t)"__proto__"!==n&&"constructor"!==n&&(n in e?"string"==typeof e[n]||e[n]instanceof String||"string"==typeof t[n]||t[n]instanceof String?r&&(e[n]=t[n]):A(e[n],t[n],r):e[n]=t[n]);return e}function S(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}var M={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};function T(e){return"string"==typeof e?e.replace(/[&<>"'\/]/g,(function(e){return M[e]})):e}var C="undefined"!=typeof window&&window.navigator&&window.navigator.userAgent&&window.navigator.userAgent.indexOf("MSIE")>-1;function P(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:".";if(e){if(e[t])return e[t];for(var n=t.split(r),i=e,o=0;o<n.length;++o){if("string"==typeof i[n[o]]&&o+1<n.length)return;if(void 0===i[n[o]]){for(var a=2,s=n.slice(o,o+a).join(r),l=i[s];void 0===l&&n.length>o+a;)a++,l=i[s=n.slice(o,o+a).join(r)];if(void 0===l)return;if("string"==typeof l)return l;if(s&&"string"==typeof l[s])return l[s];var u=n.slice(o+a).join(r);return u?P(l,u,r):void 0}i=i[n[o]]}return i}}var D=function(e){function t(e){var r,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{ns:["translation"],defaultNS:"translation"};return a(this,t),r=c(this,h(t).call(this)),C&&g.call(u(r)),r.data=e||{},r.options=n,void 0===r.options.keySeparator&&(r.options.keySeparator="."),void 0===r.options.ignoreJSONStructure&&(r.options.ignoreJSONStructure=!0),r}return f(t,e),l(t,[{key:"addNamespaces",value:function(e){this.options.ns.indexOf(e)<0&&this.options.ns.push(e)}},{key:"removeNamespaces",value:function(e){var t=this.options.ns.indexOf(e);t>-1&&this.options.ns.splice(t,1)}},{key:"getResource",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=void 0!==n.keySeparator?n.keySeparator:this.options.keySeparator,o=void 0!==n.ignoreJSONStructure?n.ignoreJSONStructure:this.options.ignoreJSONStructure,a=[e,t];r&&"string"!=typeof r&&(a=a.concat(r)),r&&"string"==typeof r&&(a=a.concat(i?r.split(i):r)),e.indexOf(".")>-1&&(a=e.split("."));var s=E(this.data,a);return s||!o||"string"!=typeof r?s:P(this.data&&this.data[e]&&this.data[e][t],r,i)}},{key:"addResource",value:function(e,t,r,n){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{silent:!1},o=this.options.keySeparator;void 0===o&&(o=".");var a=[e,t];r&&(a=a.concat(o?r.split(o):r)),e.indexOf(".")>-1&&(n=t,t=(a=e.split("."))[1]),this.addNamespaces(t),_(this.data,a,n),i.silent||this.emit("added",e,t,r,n)}},{key:"addResources",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{silent:!1};for(var i in r)"string"!=typeof r[i]&&"[object Array]"!==Object.prototype.toString.apply(r[i])||this.addResource(e,t,i,r[i],{silent:!0});n.silent||this.emit("added",e,t,r)}},{key:"addResourceBundle",value:function(e,t,r,n,i){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{silent:!1},s=[e,t];e.indexOf(".")>-1&&(n=r,r=t,t=(s=e.split("."))[1]),this.addNamespaces(t);var l=E(this.data,s)||{};n?A(l,r,i):l=o({},l,r),_(this.data,s,l),a.silent||this.emit("added",e,t,r)}},{key:"removeResourceBundle",value:function(e,t){this.hasResourceBundle(e,t)&&delete this.data[e][t],this.removeNamespaces(t),this.emit("removed",e,t)}},{key:"hasResourceBundle",value:function(e,t){return void 0!==this.getResource(e,t)}},{key:"getResourceBundle",value:function(e,t){return t||(t=this.options.defaultNS),"v1"===this.options.compatibilityAPI?o({},{},this.getResource(e,t)):this.getResource(e,t)}},{key:"getDataByLanguage",value:function(e){return this.data[e]}},{key:"toJSON",value:function(){return this.data}}]),t}(g),L={processors:{},addPostProcessor:function(e){this.processors[e.name]=e},handle:function(e,t,r,n,i){var o=this;return e.forEach((function(e){o.processors[e]&&(t=o.processors[e].process(t,r,n,i))})),t}},R={},I=function(e){function t(e){var r,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return a(this,t),r=c(this,h(t).call(this)),C&&g.call(u(r)),b(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],e,u(r)),r.options=n,void 0===r.options.keySeparator&&(r.options.keySeparator="."),r.logger=m.create("translator"),r}return f(t,e),l(t,[{key:"changeLanguage",value:function(e){e&&(this.language=e)}},{key:"exists",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{interpolation:{}};if(null==e)return!1;var r=this.resolve(e,t);return r&&void 0!==r.res}},{key:"extractFromKey",value:function(e,t){var r=void 0!==t.nsSeparator?t.nsSeparator:this.options.nsSeparator;void 0===r&&(r=":");var n=void 0!==t.keySeparator?t.keySeparator:this.options.keySeparator,i=t.ns||this.options.defaultNS;if(r&&e.indexOf(r)>-1){var o=e.match(this.interpolator.nestingRegexp);if(o&&o.length>0)return{key:e,namespaces:i};var a=e.split(r);(r!==n||r===n&&this.options.ns.indexOf(a[0])>-1)&&(i=a.shift()),e=a.join(n)}return"string"==typeof i&&(i=[i]),{key:e,namespaces:i}}},{key:"translate",value:function(e,r,i){var a=this;if("object"!==n(r)&&this.options.overloadTranslationOptionHandler&&(r=this.options.overloadTranslationOptionHandler(arguments)),r||(r={}),null==e)return"";Array.isArray(e)||(e=[String(e)]);var s=void 0!==r.keySeparator?r.keySeparator:this.options.keySeparator,l=this.extractFromKey(e[e.length-1],r),u=l.key,c=l.namespaces,h=c[c.length-1],d=r.lng||this.language,f=r.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if(d&&"cimode"===d.toLowerCase()){if(f){var p=r.nsSeparator||this.options.nsSeparator;return h+p+u}return u}var m=this.resolve(e,r),g=m&&m.res,v=m&&m.usedKey||u,y=m&&m.exactUsedKey||u,b=Object.prototype.toString.apply(g),x=["[object Number]","[object Function]","[object RegExp]"],_=void 0!==r.joinArrays?r.joinArrays:this.options.joinArrays,E=!this.i18nFormat||this.i18nFormat.handleAsObject,w="string"!=typeof g&&"boolean"!=typeof g&&"number"!=typeof g;if(E&&g&&w&&x.indexOf(b)<0&&("string"!=typeof _||"[object Array]"!==b)){if(!r.returnObjects&&!this.options.returnObjects)return this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!"),this.options.returnedObjectHandler?this.options.returnedObjectHandler(v,g,o({},r,{ns:c})):"key '".concat(u," (").concat(this.language,")' returned an object instead of string.");if(s){var A="[object Array]"===b,S=A?[]:{},M=A?y:v;for(var T in g)if(Object.prototype.hasOwnProperty.call(g,T)){var C="".concat(M).concat(s).concat(T);S[T]=this.translate(C,o({},r,{joinArrays:!1,ns:c})),S[T]===C&&(S[T]=g[T])}g=S}}else if(E&&"string"==typeof _&&"[object Array]"===b)(g=g.join(_))&&(g=this.extendTranslation(g,e,r,i));else{var P=!1,D=!1,L=void 0!==r.count&&"string"!=typeof r.count,R=t.hasDefaultValue(r),I=L?this.pluralResolver.getSuffix(d,r.count):"",O=r["defaultValue".concat(I)]||r.defaultValue;!this.isValidLookup(g)&&R&&(P=!0,g=O),this.isValidLookup(g)||(D=!0,g=u);var N=r.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey,k=N&&D?void 0:g,F=R&&O!==g&&this.options.updateMissing;if(D||P||F){if(this.logger.log(F?"updateKey":"missingKey",d,h,u,F?O:g),s){var V=this.resolve(u,o({},r,{keySeparator:!1}));V&&V.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}var U=[],B=this.languageUtils.getFallbackCodes(this.options.fallbackLng,r.lng||this.language);if("fallback"===this.options.saveMissingTo&&B&&B[0])for(var z=0;z<B.length;z++)U.push(B[z]);else"all"===this.options.saveMissingTo?U=this.languageUtils.toResolveHierarchy(r.lng||this.language):U.push(r.lng||this.language);var G=function(e,t,n){a.options.missingKeyHandler?a.options.missingKeyHandler(e,h,t,F?n:k,F,r):a.backendConnector&&a.backendConnector.saveMissing&&a.backendConnector.saveMissing(e,h,t,F?n:k,F,r),a.emit("missingKey",e,h,t,g)};this.options.saveMissing&&(this.options.saveMissingPlurals&&L?U.forEach((function(e){a.pluralResolver.getSuffixes(e).forEach((function(t){G([e],u+t,r["defaultValue".concat(t)]||O)}))})):G(U,u,O))}g=this.extendTranslation(g,e,r,m,i),D&&g===u&&this.options.appendNamespaceToMissingKey&&(g="".concat(h,":").concat(u)),(D||P)&&this.options.parseMissingKeyHandler&&(g=this.options.parseMissingKeyHandler(g))}return g}},{key:"extendTranslation",value:function(e,t,r,n,i){var a=this;if(this.i18nFormat&&this.i18nFormat.parse)e=this.i18nFormat.parse(e,r,n.usedLng,n.usedNS,n.usedKey,{resolved:n});else if(!r.skipInterpolation){r.interpolation&&this.interpolator.init(o({},r,{interpolation:o({},this.options.interpolation,r.interpolation)}));var s,l=r.interpolation&&r.interpolation.skipOnVariables||this.options.interpolation.skipOnVariables;if(l){var u=e.match(this.interpolator.nestingRegexp);s=u&&u.length}var c=r.replace&&"string"!=typeof r.replace?r.replace:r;if(this.options.interpolation.defaultVariables&&(c=o({},this.options.interpolation.defaultVariables,c)),e=this.interpolator.interpolate(e,c,r.lng||this.language,r),l){var h=e.match(this.interpolator.nestingRegexp);s<(h&&h.length)&&(r.nest=!1)}!1!==r.nest&&(e=this.interpolator.nest(e,(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return i&&i[0]===n[0]&&!r.context?(a.logger.warn("It seems you are nesting recursively key: ".concat(n[0]," in key: ").concat(t[0])),null):a.translate.apply(a,n.concat([t]))}),r)),r.interpolation&&this.interpolator.reset()}var d=r.postProcess||this.options.postProcess,f="string"==typeof d?[d]:d;return null!=e&&f&&f.length&&!1!==r.applyPostProcessor&&(e=L.handle(f,e,t,this.options&&this.options.postProcessPassResolved?o({i18nResolved:n},r):r,this)),e}},{key:"resolve",value:function(e){var t,r,n,i,o,a=this,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"string"==typeof e&&(e=[e]),e.forEach((function(e){if(!a.isValidLookup(t)){var l=a.extractFromKey(e,s),u=l.key;r=u;var c=l.namespaces;a.options.fallbackNS&&(c=c.concat(a.options.fallbackNS));var h=void 0!==s.count&&"string"!=typeof s.count,d=void 0!==s.context&&("string"==typeof s.context||"number"==typeof s.context)&&""!==s.context,f=s.lngs?s.lngs:a.languageUtils.toResolveHierarchy(s.lng||a.language,s.fallbackLng);c.forEach((function(e){a.isValidLookup(t)||(o=e,!R["".concat(f[0],"-").concat(e)]&&a.utils&&a.utils.hasLoadedNamespace&&!a.utils.hasLoadedNamespace(o)&&(R["".concat(f[0],"-").concat(e)]=!0,a.logger.warn('key "'.concat(r,'" for languages "').concat(f.join(", "),'" won\'t get resolved as namespace "').concat(o,'" was not yet loaded'),"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),f.forEach((function(r){if(!a.isValidLookup(t)){i=r;var o,l,c=u,f=[c];if(a.i18nFormat&&a.i18nFormat.addLookupKeys)a.i18nFormat.addLookupKeys(f,u,r,e,s);else h&&(o=a.pluralResolver.getSuffix(r,s.count)),h&&d&&f.push(c+o),d&&f.push(c+="".concat(a.options.contextSeparator).concat(s.context)),h&&f.push(c+=o);for(;l=f.pop();)a.isValidLookup(t)||(n=l,t=a.getResource(r,e,l,s))}})))}))}})),{res:t,usedKey:r,exactUsedKey:n,usedLng:i,usedNS:o}}},{key:"isValidLookup",value:function(e){return!(void 0===e||!this.options.returnNull&&null===e||!this.options.returnEmptyString&&""===e)}},{key:"getResource",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return this.i18nFormat&&this.i18nFormat.getResource?this.i18nFormat.getResource(e,t,r,n):this.resourceStore.getResource(e,t,r,n)}}],[{key:"hasDefaultValue",value:function(e){var t="defaultValue";for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t===r.substring(0,t.length)&&void 0!==e[r])return!0;return!1}}]),t}(g);function O(e){return e.charAt(0).toUpperCase()+e.slice(1)}var N=function(){function e(t){a(this,e),this.options=t,this.whitelist=this.options.supportedLngs||!1,this.supportedLngs=this.options.supportedLngs||!1,this.logger=m.create("languageUtils")}return l(e,[{key:"getScriptPartFromCode",value:function(e){if(!e||e.indexOf("-")<0)return null;var t=e.split("-");return 2===t.length?null:(t.pop(),"x"===t[t.length-1].toLowerCase()?null:this.formatLanguageCode(t.join("-")))}},{key:"getLanguagePartFromCode",value:function(e){if(!e||e.indexOf("-")<0)return e;var t=e.split("-");return this.formatLanguageCode(t[0])}},{key:"formatLanguageCode",value:function(e){if("string"==typeof e&&e.indexOf("-")>-1){var t=["hans","hant","latn","cyrl","cans","mong","arab"],r=e.split("-");return this.options.lowerCaseLng?r=r.map((function(e){return e.toLowerCase()})):2===r.length?(r[0]=r[0].toLowerCase(),r[1]=r[1].toUpperCase(),t.indexOf(r[1].toLowerCase())>-1&&(r[1]=O(r[1].toLowerCase()))):3===r.length&&(r[0]=r[0].toLowerCase(),2===r[1].length&&(r[1]=r[1].toUpperCase()),"sgn"!==r[0]&&2===r[2].length&&(r[2]=r[2].toUpperCase()),t.indexOf(r[1].toLowerCase())>-1&&(r[1]=O(r[1].toLowerCase())),t.indexOf(r[2].toLowerCase())>-1&&(r[2]=O(r[2].toLowerCase()))),r.join("-")}return this.options.cleanCode||this.options.lowerCaseLng?e.toLowerCase():e}},{key:"isWhitelisted",value:function(e){return this.logger.deprecate("languageUtils.isWhitelisted",'function "isWhitelisted" will be renamed to "isSupportedCode" in the next major - please make sure to rename it\'s usage asap.'),this.isSupportedCode(e)}},{key:"isSupportedCode",value:function(e){return("languageOnly"===this.options.load||this.options.nonExplicitSupportedLngs)&&(e=this.getLanguagePartFromCode(e)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(e)>-1}},{key:"getBestMatchFromCodes",value:function(e){var t,r=this;return e?(e.forEach((function(e){if(!t){var n=r.formatLanguageCode(e);r.options.supportedLngs&&!r.isSupportedCode(n)||(t=n)}})),!t&&this.options.supportedLngs&&e.forEach((function(e){if(!t){var n=r.getLanguagePartFromCode(e);if(r.isSupportedCode(n))return t=n;t=r.options.supportedLngs.find((function(e){if(0===e.indexOf(n))return e}))}})),t||(t=this.getFallbackCodes(this.options.fallbackLng)[0]),t):null}},{key:"getFallbackCodes",value:function(e,t){if(!e)return[];if("function"==typeof e&&(e=e(t)),"string"==typeof e&&(e=[e]),"[object Array]"===Object.prototype.toString.apply(e))return e;if(!t)return e.default||[];var r=e[t];return r||(r=e[this.getScriptPartFromCode(t)]),r||(r=e[this.formatLanguageCode(t)]),r||(r=e[this.getLanguagePartFromCode(t)]),r||(r=e.default),r||[]}},{key:"toResolveHierarchy",value:function(e,t){var r=this,n=this.getFallbackCodes(t||this.options.fallbackLng||[],e),i=[],o=function(e){e&&(r.isSupportedCode(e)?i.push(e):r.logger.warn("rejecting language code not found in supportedLngs: ".concat(e)))};return"string"==typeof e&&e.indexOf("-")>-1?("languageOnly"!==this.options.load&&o(this.formatLanguageCode(e)),"languageOnly"!==this.options.load&&"currentOnly"!==this.options.load&&o(this.getScriptPartFromCode(e)),"currentOnly"!==this.options.load&&o(this.getLanguagePartFromCode(e))):"string"==typeof e&&o(this.formatLanguageCode(e)),n.forEach((function(e){i.indexOf(e)<0&&o(r.formatLanguageCode(e))})),i}}]),e}(),k=[{lngs:["ach","ak","am","arn","br","fil","gun","ln","mfe","mg","mi","oc","pt","pt-BR","tg","tl","ti","tr","uz","wa"],nr:[1,2],fc:1},{lngs:["af","an","ast","az","bg","bn","ca","da","de","dev","el","en","eo","es","et","eu","fi","fo","fur","fy","gl","gu","ha","hi","hu","hy","ia","it","kk","kn","ku","lb","mai","ml","mn","mr","nah","nap","nb","ne","nl","nn","no","nso","pa","pap","pms","ps","pt-PT","rm","sco","se","si","so","son","sq","sv","sw","ta","te","tk","ur","yo"],nr:[1,2],fc:2},{lngs:["ay","bo","cgg","fa","ht","id","ja","jbo","ka","km","ko","ky","lo","ms","sah","su","th","tt","ug","vi","wo","zh"],nr:[1],fc:3},{lngs:["be","bs","cnr","dz","hr","ru","sr","uk"],nr:[1,2,5],fc:4},{lngs:["ar"],nr:[0,1,2,3,11,100],fc:5},{lngs:["cs","sk"],nr:[1,2,5],fc:6},{lngs:["csb","pl"],nr:[1,2,5],fc:7},{lngs:["cy"],nr:[1,2,3,8],fc:8},{lngs:["fr"],nr:[1,2],fc:9},{lngs:["ga"],nr:[1,2,3,7,11],fc:10},{lngs:["gd"],nr:[1,2,3,20],fc:11},{lngs:["is"],nr:[1,2],fc:12},{lngs:["jv"],nr:[0,1],fc:13},{lngs:["kw"],nr:[1,2,3,4],fc:14},{lngs:["lt"],nr:[1,2,10],fc:15},{lngs:["lv"],nr:[1,2,0],fc:16},{lngs:["mk"],nr:[1,2],fc:17},{lngs:["mnk"],nr:[0,1,2],fc:18},{lngs:["mt"],nr:[1,2,11,20],fc:19},{lngs:["or"],nr:[2,1],fc:2},{lngs:["ro"],nr:[1,2,20],fc:20},{lngs:["sl"],nr:[5,1,2,3],fc:21},{lngs:["he","iw"],nr:[1,2,20,21],fc:22}],F={1:function(e){return Number(e>1)},2:function(e){return Number(1!=e)},3:function(e){return 0},4:function(e){return Number(e%10==1&&e%100!=11?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2)},5:function(e){return Number(0==e?0:1==e?1:2==e?2:e%100>=3&&e%100<=10?3:e%100>=11?4:5)},6:function(e){return Number(1==e?0:e>=2&&e<=4?1:2)},7:function(e){return Number(1==e?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2)},8:function(e){return Number(1==e?0:2==e?1:8!=e&&11!=e?2:3)},9:function(e){return Number(e>=2)},10:function(e){return Number(1==e?0:2==e?1:e<7?2:e<11?3:4)},11:function(e){return Number(1==e||11==e?0:2==e||12==e?1:e>2&&e<20?2:3)},12:function(e){return Number(e%10!=1||e%100==11)},13:function(e){return Number(0!==e)},14:function(e){return Number(1==e?0:2==e?1:3==e?2:3)},15:function(e){return Number(e%10==1&&e%100!=11?0:e%10>=2&&(e%100<10||e%100>=20)?1:2)},16:function(e){return Number(e%10==1&&e%100!=11?0:0!==e?1:2)},17:function(e){return Number(1==e||e%10==1&&e%100!=11?0:1)},18:function(e){return Number(0==e?0:1==e?1:2)},19:function(e){return Number(1==e?0:0==e||e%100>1&&e%100<11?1:e%100>10&&e%100<20?2:3)},20:function(e){return Number(1==e?0:0==e||e%100>0&&e%100<20?1:2)},21:function(e){return Number(e%100==1?1:e%100==2?2:e%100==3||e%100==4?3:0)},22:function(e){return Number(1==e?0:2==e?1:(e<0||e>10)&&e%10==0?2:3)}};function V(){var e={};return k.forEach((function(t){t.lngs.forEach((function(r){e[r]={numbers:t.nr,plurals:F[t.fc]}}))})),e}var U=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};a(this,e),this.languageUtils=t,this.options=r,this.logger=m.create("pluralResolver"),this.rules=V()}return l(e,[{key:"addRule",value:function(e,t){this.rules[e]=t}},{key:"getRule",value:function(e){return this.rules[e]||this.rules[this.languageUtils.getLanguagePartFromCode(e)]}},{key:"needsPlural",value:function(e){var t=this.getRule(e);return t&&t.numbers.length>1}},{key:"getPluralFormsOfKey",value:function(e,t){return this.getSuffixes(e).map((function(e){return t+e}))}},{key:"getSuffixes",value:function(e){var t=this,r=this.getRule(e);return r?r.numbers.map((function(r){return t.getSuffix(e,r)})):[]}},{key:"getSuffix",value:function(e,t){var r=this,n=this.getRule(e);if(n){var i=n.noAbs?n.plurals(t):n.plurals(Math.abs(t)),o=n.numbers[i];this.options.simplifyPluralSuffix&&2===n.numbers.length&&1===n.numbers[0]&&(2===o?o="plural":1===o&&(o=""));var a=function(){return r.options.prepend&&o.toString()?r.options.prepend+o.toString():o.toString()};return"v1"===this.options.compatibilityJSON?1===o?"":"number"==typeof o?"_plural_".concat(o.toString()):a():"v2"===this.options.compatibilityJSON||this.options.simplifyPluralSuffix&&2===n.numbers.length&&1===n.numbers[0]?a():this.options.prepend&&i.toString()?this.options.prepend+i.toString():i.toString()}return this.logger.warn("no plural rule found for: ".concat(e)),""}}]),e}(),B=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};a(this,e),this.logger=m.create("interpolator"),this.options=t,this.format=t.interpolation&&t.interpolation.format||function(e){return e},this.init(t)}return l(e,[{key:"init",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.interpolation||(e.interpolation={escapeValue:!0});var t=e.interpolation;this.escape=void 0!==t.escape?t.escape:T,this.escapeValue=void 0===t.escapeValue||t.escapeValue,this.useRawValueToEscape=void 0!==t.useRawValueToEscape&&t.useRawValueToEscape,this.prefix=t.prefix?S(t.prefix):t.prefixEscaped||"{{",this.suffix=t.suffix?S(t.suffix):t.suffixEscaped||"}}",this.formatSeparator=t.formatSeparator?t.formatSeparator:t.formatSeparator||",",this.unescapePrefix=t.unescapeSuffix?"":t.unescapePrefix||"-",this.unescapeSuffix=this.unescapePrefix?"":t.unescapeSuffix||"",this.nestingPrefix=t.nestingPrefix?S(t.nestingPrefix):t.nestingPrefixEscaped||S("$t("),this.nestingSuffix=t.nestingSuffix?S(t.nestingSuffix):t.nestingSuffixEscaped||S(")"),this.nestingOptionsSeparator=t.nestingOptionsSeparator?t.nestingOptionsSeparator:t.nestingOptionsSeparator||",",this.maxReplaces=t.maxReplaces?t.maxReplaces:1e3,this.alwaysFormat=void 0!==t.alwaysFormat&&t.alwaysFormat,this.resetRegExp()}},{key:"reset",value:function(){this.options&&this.init(this.options)}},{key:"resetRegExp",value:function(){var e="".concat(this.prefix,"(.+?)").concat(this.suffix);this.regexp=new RegExp(e,"g");var t="".concat(this.prefix).concat(this.unescapePrefix,"(.+?)").concat(this.unescapeSuffix).concat(this.suffix);this.regexpUnescape=new RegExp(t,"g");var r="".concat(this.nestingPrefix,"(.+?)").concat(this.nestingSuffix);this.nestingRegexp=new RegExp(r,"g")}},{key:"interpolate",value:function(e,t,r,n){var i,a,s,l=this,u=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{};function c(e){return e.replace(/\$/g,"$$$$")}var h=function(e){if(e.indexOf(l.formatSeparator)<0){var i=w(t,u,e);return l.alwaysFormat?l.format(i,void 0,r,o({},n,t,{interpolationkey:e})):i}var a=e.split(l.formatSeparator),s=a.shift().trim(),c=a.join(l.formatSeparator).trim();return l.format(w(t,u,s),c,r,o({},n,t,{interpolationkey:s}))};this.resetRegExp();var d=n&&n.missingInterpolationHandler||this.options.missingInterpolationHandler,f=n&&n.interpolation&&n.interpolation.skipOnVariables||this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:function(e){return c(e)}},{regex:this.regexp,safeValue:function(e){return l.escapeValue?c(l.escape(e)):c(e)}}].forEach((function(t){for(s=0;i=t.regex.exec(e);){if(void 0===(a=h(i[1].trim())))if("function"==typeof d){var r=d(e,i,n);a="string"==typeof r?r:""}else{if(f){a=i[0];continue}l.logger.warn("missed to pass in variable ".concat(i[1]," for interpolating ").concat(e)),a=""}else"string"==typeof a||l.useRawValueToEscape||(a=y(a));var o=t.safeValue(a);if(e=e.replace(i[0],o),f?(t.regex.lastIndex+=o.length,t.regex.lastIndex-=i[0].length):t.regex.lastIndex=0,++s>=l.maxReplaces)break}})),e}},{key:"nest",value:function(e,t){var r,n,i=this,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=o({},a);function l(e,t){var r=this.nestingOptionsSeparator;if(e.indexOf(r)<0)return e;var n=e.split(new RegExp("".concat(r,"[ ]*{"))),i="{".concat(n[1]);e=n[0],i=(i=this.interpolate(i,s)).replace(/'/g,'"');try{s=JSON.parse(i),t&&(s=o({},t,s))}catch(t){return this.logger.warn("failed parsing options string in nesting for key ".concat(e),t),"".concat(e).concat(r).concat(i)}return delete s.defaultValue,e}for(s.applyPostProcessor=!1,delete s.defaultValue;r=this.nestingRegexp.exec(e);){var u=[],c=!1;if(-1!==r[0].indexOf(this.formatSeparator)&&!/{.*}/.test(r[1])){var h=r[1].split(this.formatSeparator).map((function(e){return e.trim()}));r[1]=h.shift(),u=h,c=!0}if((n=t(l.call(this,r[1].trim(),s),s))&&r[0]===e&&"string"!=typeof n)return n;"string"!=typeof n&&(n=y(n)),n||(this.logger.warn("missed to resolve ".concat(r[1]," for nesting ").concat(e)),n=""),c&&(n=u.reduce((function(e,t){return i.format(e,t,a.lng,o({},a,{interpolationkey:r[1].trim()}))}),n.trim())),e=e.replace(r[0],n),this.regexp.lastIndex=0}return e}}]),e}();var z=function(e){function t(e,r,n){var i,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return a(this,t),i=c(this,h(t).call(this)),C&&g.call(u(i)),i.backend=e,i.store=r,i.services=n,i.languageUtils=n.languageUtils,i.options=o,i.logger=m.create("backendConnector"),i.state={},i.queue=[],i.backend&&i.backend.init&&i.backend.init(n,o.backend,o),i}return f(t,e),l(t,[{key:"queueLoad",value:function(e,t,r,n){var i=this,o=[],a=[],s=[],l=[];return e.forEach((function(e){var n=!0;t.forEach((function(t){var s="".concat(e,"|").concat(t);!r.reload&&i.store.hasResourceBundle(e,t)?i.state[s]=2:i.state[s]<0||(1===i.state[s]?a.indexOf(s)<0&&a.push(s):(i.state[s]=1,n=!1,a.indexOf(s)<0&&a.push(s),o.indexOf(s)<0&&o.push(s),l.indexOf(t)<0&&l.push(t)))})),n||s.push(e)})),(o.length||a.length)&&this.queue.push({pending:a,loaded:{},errors:[],callback:n}),{toLoad:o,pending:a,toLoadLanguages:s,toLoadNamespaces:l}}},{key:"loaded",value:function(e,t,r){var n=e.split("|"),i=n[0],o=n[1];t&&this.emit("failedLoading",i,o,t),r&&this.store.addResourceBundle(i,o,r),this.state[e]=t?-1:2;var a={};this.queue.forEach((function(r){var n,s,l,u,c,h;n=r.loaded,s=o,u=x(n,[i],Object),c=u.obj,h=u.k,c[h]=c[h]||[],l&&(c[h]=c[h].concat(s)),l||c[h].push(s),function(e,t){for(var r=e.indexOf(t);-1!==r;)e.splice(r,1),r=e.indexOf(t)}(r.pending,e),t&&r.errors.push(t),0!==r.pending.length||r.done||(Object.keys(r.loaded).forEach((function(e){a[e]||(a[e]=[]),r.loaded[e].length&&r.loaded[e].forEach((function(t){a[e].indexOf(t)<0&&a[e].push(t)}))})),r.done=!0,r.errors.length?r.callback(r.errors):r.callback())})),this.emit("loaded",a),this.queue=this.queue.filter((function(e){return!e.done}))}},{key:"read",value:function(e,t,r){var n=this,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:350,a=arguments.length>5?arguments[5]:void 0;return e.length?this.backend[r](e,t,(function(s,l){s&&l&&i<5?setTimeout((function(){n.read.call(n,e,t,r,i+1,2*o,a)}),o):a(s,l)})):a(null,{})}},{key:"prepareLoading",value:function(e,t){var r=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3?arguments[3]:void 0;if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),i&&i();"string"==typeof e&&(e=this.languageUtils.toResolveHierarchy(e)),"string"==typeof t&&(t=[t]);var o=this.queueLoad(e,t,n,i);if(!o.toLoad.length)return o.pending.length||i(),null;o.toLoad.forEach((function(e){r.loadOne(e)}))}},{key:"load",value:function(e,t,r){this.prepareLoading(e,t,{},r)}},{key:"reload",value:function(e,t,r){this.prepareLoading(e,t,{reload:!0},r)}},{key:"loadOne",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=e.split("|"),i=n[0],o=n[1];this.read(i,o,"read",void 0,void 0,(function(n,a){n&&t.logger.warn("".concat(r,"loading namespace ").concat(o," for language ").concat(i," failed"),n),!n&&a&&t.logger.log("".concat(r,"loaded namespace ").concat(o," for language ").concat(i),a),t.loaded(e,n,a)}))}},{key:"saveMissing",value:function(e,t,r,n,i){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};this.services.utils&&this.services.utils.hasLoadedNamespace&&!this.services.utils.hasLoadedNamespace(t)?this.logger.warn('did not save key "'.concat(r,'" as the namespace "').concat(t,'" was not yet loaded'),"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!"):null!=r&&""!==r&&(this.backend&&this.backend.create&&this.backend.create(e,t,r,n,null,o({},a,{isUpdate:i})),e&&e[0]&&this.store.addResource(e[0],t,r,n))}}]),t}(g);function G(){return{debug:!1,initImmediate:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,whitelist:!1,nonExplicitWhitelist:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!0,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:function(e){var t={};if("object"===n(e[1])&&(t=e[1]),"string"==typeof e[1]&&(t.defaultValue=e[1]),"string"==typeof e[2]&&(t.tDescription=e[2]),"object"===n(e[2])||"object"===n(e[3])){var r=e[3]||e[2];Object.keys(r).forEach((function(e){t[e]=r[e]}))}return t},interpolation:{escapeValue:!0,format:function(e,t,r,n){return e},prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!1}}}function H(e){return"string"==typeof e.ns&&(e.ns=[e.ns]),"string"==typeof e.fallbackLng&&(e.fallbackLng=[e.fallbackLng]),"string"==typeof e.fallbackNS&&(e.fallbackNS=[e.fallbackNS]),e.whitelist&&(e.whitelist&&e.whitelist.indexOf("cimode")<0&&(e.whitelist=e.whitelist.concat(["cimode"])),e.supportedLngs=e.whitelist),e.nonExplicitWhitelist&&(e.nonExplicitSupportedLngs=e.nonExplicitWhitelist),e.supportedLngs&&e.supportedLngs.indexOf("cimode")<0&&(e.supportedLngs=e.supportedLngs.concat(["cimode"])),e}function W(){}const j=new(function(e){function t(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;if(a(this,t),e=c(this,h(t).call(this)),C&&g.call(u(e)),e.options=H(r),e.services={},e.logger=m,e.modules={external:[]},n&&!e.isInitialized&&!r.isClone){if(!e.options.initImmediate)return e.init(r,n),c(e,u(e));setTimeout((function(){e.init(r,n)}),0)}return e}return f(t,e),l(t,[{key:"init",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1?arguments[1]:void 0;function n(e){return e?"function"==typeof e?new e:e:null}if("function"==typeof t&&(r=t,t={}),t.whitelist&&!t.supportedLngs&&this.logger.deprecate("whitelist",'option "whitelist" will be renamed to "supportedLngs" in the next major - please make sure to rename this option asap.'),t.nonExplicitWhitelist&&!t.nonExplicitSupportedLngs&&this.logger.deprecate("whitelist",'options "nonExplicitWhitelist" will be renamed to "nonExplicitSupportedLngs" in the next major - please make sure to rename this option asap.'),this.options=o({},G(),this.options,H(t)),this.format=this.options.interpolation.format,r||(r=W),!this.options.isClone){this.modules.logger?m.init(n(this.modules.logger),this.options):m.init(null,this.options);var i=new N(this.options);this.store=new D(this.options.resources,this.options);var a=this.services;a.logger=m,a.resourceStore=this.store,a.languageUtils=i,a.pluralResolver=new U(i,{prepend:this.options.pluralSeparator,compatibilityJSON:this.options.compatibilityJSON,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),a.interpolator=new B(this.options),a.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},a.backendConnector=new z(n(this.modules.backend),a.resourceStore,a,this.options),a.backendConnector.on("*",(function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];e.emit.apply(e,[t].concat(n))})),this.modules.languageDetector&&(a.languageDetector=n(this.modules.languageDetector),a.languageDetector.init(a,this.options.detection,this.options)),this.modules.i18nFormat&&(a.i18nFormat=n(this.modules.i18nFormat),a.i18nFormat.init&&a.i18nFormat.init(this)),this.translator=new I(this.services,this.options),this.translator.on("*",(function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];e.emit.apply(e,[t].concat(n))})),this.modules.external.forEach((function(t){t.init&&t.init(e)}))}if(this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){var s=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);s.length>0&&"dev"!==s[0]&&(this.options.lng=s[0])}this.services.languageDetector||this.options.lng||this.logger.warn("init: no languageDetector is used and no lng is defined");var l=["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"];l.forEach((function(t){e[t]=function(){var r;return(r=e.store)[t].apply(r,arguments)}}));var u=["addResource","addResources","addResourceBundle","removeResourceBundle"];u.forEach((function(t){e[t]=function(){var r;return(r=e.store)[t].apply(r,arguments),e}}));var c=v(),h=function(){var t=function(t,n){e.isInitialized&&!e.initializedStoreOnce&&e.logger.warn("init: i18next is already initialized. You should call init just once!"),e.isInitialized=!0,e.options.isClone||e.logger.log("initialized",e.options),e.emit("initialized",e.options),c.resolve(n),r(t,n)};if(e.languages&&"v1"!==e.options.compatibilityAPI&&!e.isInitialized)return t(null,e.t.bind(e));e.changeLanguage(e.options.lng,t)};return this.options.resources||!this.options.initImmediate?h():setTimeout(h,0),c}},{key:"loadResources",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:W,n=r,i="string"==typeof e?e:this.language;if("function"==typeof e&&(n=e),!this.options.resources||this.options.partialBundledLanguages){if(i&&"cimode"===i.toLowerCase())return n();var o=[],a=function(e){e&&t.services.languageUtils.toResolveHierarchy(e).forEach((function(e){o.indexOf(e)<0&&o.push(e)}))};if(i)a(i);else{var s=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);s.forEach((function(e){return a(e)}))}this.options.preload&&this.options.preload.forEach((function(e){return a(e)})),this.services.backendConnector.load(o,this.options.ns,n)}else n(null)}},{key:"reloadResources",value:function(e,t,r){var n=v();return e||(e=this.languages),t||(t=this.options.ns),r||(r=W),this.services.backendConnector.reload(e,t,(function(e){n.resolve(),r(e)})),n}},{key:"use",value:function(e){if(!e)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!e.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return"backend"===e.type&&(this.modules.backend=e),("logger"===e.type||e.log&&e.warn&&e.error)&&(this.modules.logger=e),"languageDetector"===e.type&&(this.modules.languageDetector=e),"i18nFormat"===e.type&&(this.modules.i18nFormat=e),"postProcessor"===e.type&&L.addPostProcessor(e),"3rdParty"===e.type&&this.modules.external.push(e),this}},{key:"changeLanguage",value:function(e,t){var r=this;this.isLanguageChangingTo=e;var n=v();this.emit("languageChanging",e);var i=function(i){e||i||!r.services.languageDetector||(i=[]);var o="string"==typeof i?i:r.services.languageUtils.getBestMatchFromCodes(i);o&&(r.language||(r.language=o,r.languages=r.services.languageUtils.toResolveHierarchy(o)),r.translator.language||r.translator.changeLanguage(o),r.services.languageDetector&&r.services.languageDetector.cacheUserLanguage(o)),r.loadResources(o,(function(e){!function(e,i){i?(r.language=i,r.languages=r.services.languageUtils.toResolveHierarchy(i),r.translator.changeLanguage(i),r.isLanguageChangingTo=void 0,r.emit("languageChanged",i),r.logger.log("languageChanged",i)):r.isLanguageChangingTo=void 0,n.resolve((function(){return r.t.apply(r,arguments)})),t&&t(e,(function(){return r.t.apply(r,arguments)}))}(e,o)}))};return e||!this.services.languageDetector||this.services.languageDetector.async?!e&&this.services.languageDetector&&this.services.languageDetector.async?this.services.languageDetector.detect(i):i(e):i(this.services.languageDetector.detect()),n}},{key:"getFixedT",value:function(e,t,r){var i=this,a=function e(t,a){var s;if("object"!==n(a)){for(var l=arguments.length,u=new Array(l>2?l-2:0),c=2;c<l;c++)u[c-2]=arguments[c];s=i.options.overloadTranslationOptionHandler([t,a].concat(u))}else s=o({},a);s.lng=s.lng||e.lng,s.lngs=s.lngs||e.lngs,s.ns=s.ns||e.ns;var h=i.options.keySeparator||".",d=r?"".concat(r).concat(h).concat(t):t;return i.t(d,s)};return"string"==typeof e?a.lng=e:a.lngs=e,a.ns=t,a.keyPrefix=r,a}},{key:"t",value:function(){var e;return this.translator&&(e=this.translator).translate.apply(e,arguments)}},{key:"exists",value:function(){var e;return this.translator&&(e=this.translator).exists.apply(e,arguments)}},{key:"setDefaultNamespace",value:function(e){this.options.defaultNS=e}},{key:"hasLoadedNamespace",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;var n=this.languages[0],i=!!this.options&&this.options.fallbackLng,o=this.languages[this.languages.length-1];if("cimode"===n.toLowerCase())return!0;var a=function(e,r){var n=t.services.backendConnector.state["".concat(e,"|").concat(r)];return-1===n||2===n};if(r.precheck){var s=r.precheck(this,a);if(void 0!==s)return s}return!!this.hasResourceBundle(n,e)||(!this.services.backendConnector.backend||!(!a(n,e)||i&&!a(o,e)))}},{key:"loadNamespaces",value:function(e,t){var r=this,n=v();return this.options.ns?("string"==typeof e&&(e=[e]),e.forEach((function(e){r.options.ns.indexOf(e)<0&&r.options.ns.push(e)})),this.loadResources((function(e){n.resolve(),t&&t(e)})),n):(t&&t(),Promise.resolve())}},{key:"loadLanguages",value:function(e,t){var r=v();"string"==typeof e&&(e=[e]);var n=this.options.preload||[],i=e.filter((function(e){return n.indexOf(e)<0}));return i.length?(this.options.preload=n.concat(i),this.loadResources((function(e){r.resolve(),t&&t(e)})),r):(t&&t(),Promise.resolve())}},{key:"dir",value:function(e){if(e||(e=this.languages&&this.languages.length>0?this.languages[0]:this.language),!e)return"rtl";return["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam"].indexOf(this.services.languageUtils.getLanguagePartFromCode(e))>=0?"rtl":"ltr"}},{key:"createInstance",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1?arguments[1]:void 0;return new t(e,r)}},{key:"cloneInstance",value:function(){var e=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:W,i=o({},this.options,r,{isClone:!0}),a=new t(i),s=["store","services","language"];return s.forEach((function(t){a[t]=e[t]})),a.services=o({},this.services),a.services.utils={hasLoadedNamespace:a.hasLoadedNamespace.bind(a)},a.translator=new I(a.services,a.options),a.translator.on("*",(function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];a.emit.apply(a,[e].concat(r))})),a.init(i,n),a.translator.options=a.options,a.translator.backendConnector.services.utils={hasLoadedNamespace:a.hasLoadedNamespace.bind(a)},a}},{key:"toJSON",value:function(){return{options:this.options,store:this.store,language:this.language,languages:this.languages}}}]),t}(g))},83522:(e,t,r)=>{"use strict";r.r(t);var n=r(61445),i=r(25282),o=r(53974),a=r(32757),s=r(42106),l=r(37169),u=r(55412);function c(e,t){i.Extension.call(this,e,t),this.name="propertiesmanager",this._panel=null,this._onIsolateEvent=this._onIsolateEvent.bind(this),this._onSelectionChangeEvent=this._onSelectionChangeEvent.bind(this),this._onPrefChange=this._onPrefChange.bind(this),this._onContextMenu=this._onContextMenu.bind(this)}c.prototype=Object.create(i.Extension.prototype),c.prototype.constructor=c;var h=c.prototype,d=Autodesk.Viewing.Private;h.load=function(){return this.viewer.addEventListener(l.ISOLATE_EVENT,this._onIsolateEvent),this.viewer.addEventListener(l.AGGREGATE_SELECTION_CHANGED_EVENT,this._onSelectionChangeEvent),this.viewer.prefs.addListeners(u.Prefs.OPEN_PROPERTIES_ON_SELECT,this._onPrefChange),this.viewer.registerContextMenuCallback(this.name,this._onContextMenu),!0},h.unload=function(){this.viewer.removeEventListener(l.ISOLATE_EVENT,this._onIsolateEvent),this.viewer.removeEventListener(l.AGGREGATE_SELECTION_CHANGED_EVENT,this._onSelectionChangeEvent),this.viewer.prefs.removeListeners(u.Prefs.OPEN_PROPERTIES_ON_SELECT,this._onPrefChange),this.viewer.unregisterContextMenuCallback(this.name),this.deactivate(),this.setPanel(null),this._toolbarButton&&(this.viewer.settingsTools.removeControl(this._toolbarButton),this.viewer.settingsTools.propertiesbutton=null,this._toolbarButton=null)},h.onToolbarCreated=function(){this.setDefaultPanel(),this._addToolbarButton()},h.activate=function(){return!!this._panel&&(this._panel.setVisible(!0),!0)},h.deactivate=function(){return this._panel&&this._panel.setVisible(!1),!0},h.isActive=function(){return!!this._panel&&this._panel.isVisible()},h.setPanel=function(e){var t=this;return(e instanceof o.PropertyPanel||!e)&&(this._panel&&(this._panel.setVisible(!1),this.viewer.removePanel(this._panel),this._panel.uninitialize()),this._panel=e,e&&(this.viewer.addPanel(e),e.addVisibilityListener((function(e){e&&t.viewer.onPanelVisible(t._panel),t._toolbarButton.setState(e?s.Button.State.ACTIVE:s.Button.State.INACTIVE)}))),!0)},h.setDefaultPanel=function(){this.setPanel(new a.ViewerPropertyPanel(this.viewer))},h.getPanel=function(){return this._panel},h.getToolbarButton=function(){return this._toolbarButton},h._addToolbarButton=function(){var e=this;if(!this._toolbarButton){var t=this._toolbarButton=new s.Button("toolbar-propertiesTool");t.setToolTip("Properties"),t.setIcon("adsk-icon-properties"),t.onClick=function(){e._panel.setVisible(!e._panel.isVisible()),e._panel.isVisible()&&d.analytics.track("viewer.properties",{action:"View List",from:"Toolbar"})},t.setVisible(!this.viewer.prefs.get("openPropertiesOnSelect")),this.viewer.settingsTools.addControl(t,{index:1}),this.viewer.settingsTools.propertiesbutton=t}},h._onIsolateEvent=function(e){this._panel&&(this.viewer.prefs.get("openPropertiesOnSelect")||e.nodeIdArray[0]===e.model.getRootId())&&this._panel.setVisible(e.nodeIdArray.length>0||this.viewer.impl.selector.hasSelection())},h._onSelectionChangeEvent=function(e){if(this.viewer.prefs.get("openPropertiesOnSelect")){for(var t=!1,r=0;r<e.selections.length;++r)if(e.selections[r].dbIdArray.length>0){t=!0;break}t?this.activate():this.deactivate()}},h._onPrefChange=function(e){this._toolbarButton&&this._toolbarButton.setVisible(!e)},h._onContextMenu=function(e,t){var r=this;if(!this.isActive()&&t.hasSelected){var n={title:"Show Properties",target:function(){r.activate(),d.analytics.track("viewer.properties",{action:"View List",from:"Contextual"})}};e.unshift(n)}};var f=r(49710);function p(e,t){i.Extension.call(this,e,t),this.viewer=e,this.options=t,this.name="viewersettings"}p.prototype=Object.create(i.Extension.prototype),p.prototype.constructor=p;var m=p.prototype;m.activate=function(){this.activeStatus||(this.viewer.showViewer3dOptions(!0),this.viewer.getSettingsPanel(!0).selectTab(f.ViewerSettingTab.Performance),this.activeStatus=!0);return!0},m.deactivate=function(){return this.activeStatus&&(this.viewer.showViewer3dOptions(!1),this.activeStatus=!1),!0};var g=r(75977),v=r(84998);function y(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function b(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?y(Object(r),!0).forEach((function(t){x(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):y(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function x(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var _=Autodesk.Viewing.Private;function E(e,t){i.Extension.call(this,e,t),this.viewer=e,this.options=t,this.name="modelstructure",this._modelstructure=null,this._onLoadModel=this._onLoadModel.bind(this),this._onUnloadModel=this._onUnloadModel.bind(this)}E.prototype=Object.create(i.Extension.prototype),E.prototype.constructor=E;var w=E.prototype;w.load=function(){return this.viewer.addEventListener(l.MODEL_ADDED_EVENT,this._onLoadModel),this.viewer.addEventListener(l.MODEL_ROOT_LOADED_EVENT,this._onLoadModel),this.viewer.addEventListener(l.MODEL_UNLOADED_EVENT,this._onUnloadModel),this.viewer.addEventListener(l.MODEL_REMOVED_EVENT,this._onUnloadModel),!0},w.unload=function(){return this.deactivate(),this.setModelStructurePanel(null),this._structureButton&&(this.viewer.settingsTools.removeControl(this._structureButton),this.viewer.settingsTools.structurebutton=null,this._structureButton=null),this.viewer.removeEventListener(l.MODEL_ADDED_EVENT,this._onLoadModel),this.viewer.removeEventListener(l.MODEL_ROOT_LOADED_EVENT,this._onLoadModel),this.viewer.removeEventListener(l.MODEL_UNLOADED_EVENT,this._onUnloadModel),this.viewer.removeEventListener(l.MODEL_REMOVED_EVENT,this._onUnloadModel),!0},w.onToolbarCreated=function(){var e=this,t=new s.Button("toolbar-modelStructureTool");t.setToolTip("Model browser"),t.setIcon("adsk-icon-structure"),t.onClick=function(){!e._modelstructure.isVisible()?e.activate():e.deactivate()};var r=this.viewer.settingsTools;r.addControl(t,{index:0}),r.structurebutton=t,this._structureButton=t,this.restoreDefaultPanel()},w.activate=function(){return!!this._modelstructure&&(this._modelstructure.setVisible(!0),_.analytics.track("viewer.model_browser",{action:"View List"}),!0)},w.deactivate=function(){return this._modelstructure&&this._modelstructure.setVisible(!1),!0},w.isActive=function(){return!!this._modelstructure&&this._modelstructure.isVisible()},w.setModelStructurePanel=function(e){var t=this;if(e===this._modelstructure)return!1;if(this._modelstructure&&(this._modelstructure.setVisible(!1),this.viewer.removePanel(this._modelstructure),this._modelstructure.uninitialize()),this._modelstructure=e,this.viewer.modelstructure=e,!e)return!0;this.viewer.addPanel(this._modelstructure);for(var r=this.viewer.impl.modelQueue().getModels(),n=0;n<r.length;++n)this._modelstructure.addModel(r[n]);return this._modelstructure.addVisibilityListener((function(e){e&&t.viewer.onPanelVisible(t._modelstructure),t._structureButton.setState(e?s.Button.State.ACTIVE:s.Button.State.INACTIVE)})),!0},w.restoreDefaultPanel=function(){var e=this.viewer.config,t={docStructureConfig:e.docStructureConfig,hideSearch:(0,v.isMobileDevice)(),excludeRoot:e.modelBrowserExcludeRoot,startCollapsed:e.modelBrowserStartCollapsed},r=e.defaultModelStructureTitle||"Browser",n=new g.ViewerModelStructurePanel(b(b({},t),(0,g.generateDefaultViewerHandlerOptions)(this.viewer)),r);this.setModelStructurePanel(n)},w._onLoadModel=function(e){this._modelstructure&&this._modelstructure.addModel(e.model)},w._onUnloadModel=function(e){this._modelstructure&&this._modelstructure.unloadModel(e.model)};var A=r(6355),S=r(35010),M=r(49991),T=r(82803),C=r(71224),P=r(51676),D=r(56441),L="dolly",R="freeorbit",I="orbit",O="worldup",N="fittoview";function k(e,t){i.Extension.call(this,e,t),this.name="navtools",this.modes=["pan",L,R,I,"fov",O,N],this.onToolChanged=this.onToolChanged.bind(this),this.onNavigationModeChanged=this.onNavigationModeChanged.bind(this),this.navToolsConfig=t.navToolsConfig||{}}k.prototype=Object.create(i.Extension.prototype),k.prototype.constructor=k;var F=k.prototype;function V(e,t,r){return function(){e.isActive(r)?e.deactivate():e.activate(r)}}F.load=function(){var e=this.viewer,t=new M.FovTool(e);if(e.toolController.registerTool(t),!this.navToolsConfig.isAECCameraControls){var r=new T.WorldUpTool(e.impl,e);e.toolController.registerTool(r)}return this.initFocalLengthOverlay(),e.addEventListener(l.TOOL_CHANGE_EVENT,this.onToolChanged),e.addEventListener(l.NAVIGATION_MODE_CHANGED_EVENT,this.onNavigationModeChanged),!0},F.updateUI=function(e){e!==this.is3d&&(this._destroyUI(),this._createUI(e))},F.onToolbarCreated=function(){var e=!this.viewer.impl.is2d;this._createUI(e)},F.navActionDisplayMode=function(e){return this.viewer.navigation.isActionEnabled(e)?"block":"none"},F._createUI=function(e){var t=this.viewer.getToolbar().getControl(A.TOOLBAR.NAVTOOLSID);if(e){var r=new S.ComboButton("toolbar-orbitTools");r.setToolTip("Orbit"),r.setIcon("adsk-icon-orbit-constrained"),r.setDisplay(this.navActionDisplayMode("orbit")),this.createOrbitSubmenu(r),t.addControl(r),t.orbittoolsbutton=r,r.setState(s.Button.State.ACTIVE),t.returnToDefault=function(){r.setState(s.Button.State.ACTIVE)}}var n=new s.Button("toolbar-panTool");n.setToolTip("Pan"),n.setIcon("adsk-icon-pan"),n.onClick=V(this,0,"pan"),n.setDisplay(this.navActionDisplayMode("pan")),t.addControl(n),t.panbutton=n,e||(t.returnToDefault=function(){n.setState(s.Button.State.ACTIVE)},t.returnToDefault());var i=new s.Button("toolbar-zoomTool");if(i.setToolTip("Zoom"),i.setIcon("adsk-icon-zoom"),i.onClick=V(this,0,L),i.setDisplay(this.navActionDisplayMode("zoom")),t.addControl(i),t.dollybutton=i,this.navToolsConfig.isAECCameraControls)t.addControl(this.createFitViewButton(t));else{var o=new S.ComboButton("toolbar-cameraSubmenuTool");o.setToolTip("Camera interactions"),o.setIcon("adsk-icon-camera"),o.saveAsDefault(),this.createCameraSubmenu(o,e),t.addControl(o),t.camerabutton=o}this.is3d=e},F.createOrbitSubmenu=function(e){var t=this.viewer.getToolbar().getControl(A.TOOLBAR.NAVTOOLSID),r=new s.Button("toolbar-freeOrbitTool");r.setToolTip("Free orbit"),r.setIcon("adsk-icon-orbit-free"),r.onClick=V(this,0,R),e.addControl(r),t.freeorbitbutton=r;var n=new s.Button("toolbar-orbitTool");n.setToolTip("Orbit"),n.setIcon("adsk-icon-orbit-constrained"),n.onClick=V(this,0,I),e.addControl(n),t.orbitbutton=n,e.onClick=n.onClick},F.createFitViewButton=function(e,t){var r=this.viewer,n=new s.Button("toolbar-fitToViewTool");return n.setToolTip("Fit to view"),n.setIcon("adsk-icon-fit-to-view"),n.onClick=function(){r.impl.fitToView(r.impl.selector.getAggregateSelection()),Autodesk.Viewing.Private.analytics.track("viewer.fit_to_view",{from:"UI"});var e=r.getDefaultNavigationToolName();r.setActiveNavigationTool(e),t&&t.restoreDefault()},n.setDisplay(this.navActionDisplayMode("gotoview")),e.fittoviewbutton=n,n},F.createCameraSubmenu=function(e,t){var r=this,n=this.viewer,i=n.getToolbar().getControl(A.TOOLBAR.NAVTOOLSID);if((0,v.isTouchDevice)()){var o=new s.Button("toolbar-homeTool");o.setToolTip("Home"),o.setIcon("adsk-icon-home"),o.onClick=function(){n.navigation.setRequestHomeView(!0);var t=n.getDefaultNavigationToolName();r.activate(t),e.restoreDefault()},o.setDisplay(this.navActionDisplayMode("gotoview")),e.addControl(o),i.homebutton=o}if(e.addControl(this.createFitViewButton(i,e)),t){var a=new s.Button("toolbar-focalLengthTool");a.setToolTip("Focal length"),a.setIcon("adsk-icon-fov"),a.onClick=V(this,0,"fov"),a.setDisplay(this.navActionDisplayMode("fov")),e.addControl(a),i.fovbutton=a}var l=new s.Button("toolbar-rollTool");l.setToolTip("Roll"),l.setIcon("adsk-icon-roll"),l.onClick=V(this,0,O),l.setDisplay(this.navActionDisplayMode("roll")),e.addControl(l),i.rollbutton=l},F.onToolChanged=function(e){if("fov"===e.toolName&&this.showFocalLengthOverlay(e.active),e.active)switch(e.toolName){case"dolly":this.handleAltRelease("dollybutton");break;case"pan":this.handleAltRelease("panbutton");break;case"worldup":this.handleAltRelease("rollbutton");break;case"fov":this.handleAltRelease("fovbutton")}},F.onNavigationModeChanged=function(e){if(this.viewer.getDefaultNavigationToolName()===e.id){var t=this.viewer.getToolbar();if(!t)return;var r=t.getControl(A.TOOLBAR.NAVTOOLSID);if(!r)return;r.returnToDefault&&r.returnToDefault()}},F.handleAltRelease=function(e){var t=this.viewer.getToolbar();if(t){var r=t.getControl(A.TOOLBAR.NAVTOOLSID),n=r&&r[e];n&&n.setState(s.Button.State.ACTIVE)}},F.initFocalLengthOverlay=function(){var e=this.getDocument(),t=this.focallength=e.createElement("div");t.classList.add("message-panel"),t.classList.add("docking-panel"),t.classList.add("focal-length"),t.classList.add("docking-panel-container-solid-color-b");var r=e.createElement("table"),n=e.createElement("tbody");r.appendChild(n),t.appendChild(r),this.viewer.container.appendChild(t);var i=n.insertRow(-1),o=i.insertCell(0);o.classList.add("name"),o.setAttribute("data-i18n","Focal Length"),o.textContent=C.Z.t("Focal Length"),(o=i.insertCell(1)).classList.add("value"),o.textContent="",this.fovCell=o,t.style.visibility="hidden"},F.showFocalLengthOverlay=function(e){var t=this,r=this.viewer,n=0;function i(e){if(e){D.HudMessage.displayMessage(r.container,{msgTitleKey:"Orthographic View Set",messageKey:"The view is set to Orthographic",messageDefaultValue:"The view is set to Orthographic. Changing the focal length will switch to Perspective."})}else D.HudMessage.dismiss()}function o(e){e&&a(),t.focallength&&(t.focallength.style.visibility=e?"visible":"hidden")}function a(){var e=r.getFocalLength();n!==e&&(n=e,t.fovCell.textContent=e.toString()+" mm")}function s(){if(a(),"fov"===r.toolController.getActiveToolName()){var e=r.navigation.getCamera(),t=e&&!e.isPerspective;o(!t),i(t)}}var u=r.navigation.getCamera(),c=u&&!u.isPerspective;o(e&&!c),i(e&&c),e?r.addEventListener(l.CAMERA_CHANGE_EVENT,s):r.removeEventListener(l.CAMERA_CHANGE_EVENT,s)},F.unload=function(){return this._destroyUI(),!0},F._destroyUI=function(){var e=this.viewer,t=e.getToolbar();if(!t)return!0;var r=t.getControl(A.TOOLBAR.NAVTOOLSID);if(!r)return!0;function n(e){e&&(e.subMenu.removeEventListener(P.RadioButtonGroup.Event.ACTIVE_BUTTON_CHANGED,e.subMenuActiveButtonChangedHandler(r)),r.removeControl(e.getId()),e.onClick=null)}function i(e){e&&(r.removeControl(e.getId()),e.onClick=null)}return this.is3d&&(n(r.orbittoolsbutton),r.orbittoolsbutton=null,i(r.orbitbutton),r.orbitbutton=null,i(r.freeorbitbutton),r.freeorbitbutton=null,i(r.fovbutton),r.fovbutton=null),i(r.panbutton),r.panbutton=null,i(r.dollybutton),r.dollybutton=null,n(r.camerabutton),r.camerabutton=null,i(r.rollbutton),r.rollbutton=null,i(r.fittoviewbutton),r.fittoviewbutton=null,this.focallength&&(e.container.removeChild(this.focallength),this.focallength=null),e.removeEventListener(l.TOOL_CHANGE_EVENT,this.onToolChanged),this.onToolChanged=null,e.removeEventListener(l.NAVIGATION_MODE_CHANGED_EVENT,this.onNavigationModeChanged),this.onNavigationModeChanged=null,!0},F.activate=function(e){if(this.isActive(e))return!1;if(e===N)return this.viewer.impl.fitToView(this.viewer.impl.selector.getAggregateSelection()),!0;if(-1!=this.modes.indexOf(e)){var t=this.viewer.getDefaultNavigationToolName();return-1===this.modes.indexOf(t)&&this.viewer.activateDefaultNavigationTools(this.viewer.model.is2d()),this.viewer.setActiveNavigationTool(e),!0}return!1},F.deactivate=function(){return this.viewer.setActiveNavigationTool(),!0},F.isActive=function(e){return this.viewer.getActiveNavigationTool()===e};var U=r(77702);function B(e){return B="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},B(e)}function z(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function G(e,t){return G=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},G(e,t)}function H(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=j(e);if(t){var i=j(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return W(this,r)}}function W(e,t){if(t&&("object"===B(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function j(e){return j=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},j(e)}var q=Autodesk.Viewing.GlobalManagerMixin,X=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&G(e,t)}(o,e);var t,r,n,i=H(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=i.call(this)).names=["explode"],t.viewer=e,t.setGlobalManager(t.viewer.globalManager),t.active=!1,t.activate=function(){t.active=!0},t.deactivate=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];e&&t.setScale(0),t.active=!1},t.isActive=function(){return t.active},t}return t=o,(r=[{key:"setScale",value:function(e){return this.viewer.explode(e)}},{key:"getScale",value:function(){return this.viewer.getExplodeScale()}}])&&z(t.prototype,r),n&&z(t,n),Object.defineProperty(t,"prototype",{writable:!1}),o}(U.ToolInterface);q.call(X.prototype);var Y=r(17167),K=r(98926);function Z(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Q=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.ext=t;var r=t.viewer,n=new s.Button("toolbar-explodeTool");n.setIcon("adsk-icon-explode"),n.setToolTip("Explode model"),r.modelTools.addControl(n);var i,o=(0,Y.stringToDOM)('<div class="docking-panel docking-panel-container-solid-color-b explode-submenu" style="display:none"><input class="explode-slider" type="range" min="0" max="1" step="0.01" value="0"/></div>'),a=this.ext.getDocument();(0,v.isIOSDevice)()?(i=a.querySelector("#toolbar-explodeTool").parentNode,o.classList.add("ios")):(0,v.isAndroidDevice)()?(i=a.querySelector("#toolbar-explodeTool").parentNode,o.classList.add("android")):i=n.container,i.appendChild(o);var l=o.querySelector(".explode-slider");l.addEventListener(v.isIE11?"change":"input",(function(){t.setScale(l.value)})),v.isIE11&&(l.style["padding-top"]="0",l.style["padding-bottom"]="0",l.style["margin-top"]="10px"),o.onclick=function(e){e.stopPropagation()};var u=n.container.querySelector(".adsk-control-tooltip");n.onClick=function(){t.isActive()?t.deactivate():(t.activate(),K.logger.track({category:"tool_changed",name:"explode"}))},this._slider=l,this._explodeButton=n,this._explodeSubmenu=o,this._tooltip=u,r.explodeSlider=l,r.explodeSubmenu=o,this._onExplode=this._onExplode.bind(this)}var t,r,n;return t=e,(r=[{key:"activate",value:function(){this._explodeSubmenu.style.display="",this._explodeButton.setState(s.Button.State.ACTIVE),this._tooltip.style.display="none";var e=this.ext.getScale();this._slider.value=e,this.ext.viewer.addEventListener(l.EXPLODE_CHANGE_EVENT,this._onExplode)}},{key:"deactivate",value:function(){this._explodeButton.setState(s.Button.State.INACTIVE),this._hideSlider(this),this.ext.viewer.removeEventListener(l.EXPLODE_CHANGE_EVENT,this._onExplode)}},{key:"destroy",value:function(){var e=this.ext.viewer;this._slider&&(this._explodeButton&&this._explodeButton.removeFromParent(),this._slider=null,this._explodeButton=null,this._explodeSubmenu=null,this._tooltip=null,e.explodeSlider=null,e.explodeSubmenu=null)}},{key:"setUIEnabled",value:function(e){this._explodeButton&&(e?(this._explodeButton.setState(Autodesk.Viewing.UI.Button.State.INACTIVE),this._wasActive&&this.ext.activate()):(this._wasActive=this.ext.isActive(),this._hideSlider(this),this._explodeButton.setState(Autodesk.Viewing.UI.Button.State.DISABLED)))}},{key:"_hideSlider",value:function(){this._slider.parentNode.style.display="none",this._tooltip.style.display=""}},{key:"_onExplode",value:function(e){this._slider.value=e.scale}}])&&Z(t.prototype,r),n&&Z(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function J(e){return J="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},J(e)}function $(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ee(e,t){return ee=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},ee(e,t)}function te(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=ne(e);if(t){var i=ne(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return re(this,r)}}function re(e,t){if(t&&("object"===J(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function ne(e){return ne=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},ne(e)}var ie=Autodesk.Viewing.Private,oe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ee(e,t)}(o,e);var t,r,n,i=te(o);function o(e,t){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(r=i.call(this,e,t)).viewer=e,r.options=t,r.name="explode",r.tool=null,r.explodeUI=null,r}return t=o,(r=[{key:"load",value:function(){return this.tool=new X(this.viewer),this.viewer.toolController.registerTool(this.tool,this.setActive.bind(this)),!0}},{key:"unload",value:function(){return this.deactivate(),this.explodeUI&&(this.explodeUI.destroy(),this.explodeUI=null),this.viewer.toolController.deregisterTool(this.tool),this.tool=null,!0}},{key:"onToolbarCreated",value:function(e){this.explodeUI=new Q(this,e)}},{key:"activate",value:function(){return!!this.isActive()||!!this.explodeUI&&(this.explodeUI.activate(),this.viewer.toolController.activateTool("explode"),!0)}},{key:"deactivate",value:function(){return!this.isActive()||!this.explodeUI||(this.explodeUI.deactivate(),this.viewer.toolController.deactivateTool("explode"),!0)}},{key:"isActive",value:function(){return this.tool.isActive()}},{key:"getScale",value:function(){return this.tool.getScale()}},{key:"setScale",value:function(e){return this.tool.setScale(e)}},{key:"setStrategy",value:function(e){e!==this.getStrategy()&&this.viewer.prefs.set(ie.Prefs3D.EXPLODE_STRATEGY,e)}},{key:"getStrategy",value:function(){return this.viewer.prefs.get(ie.Prefs3D.EXPLODE_STRATEGY)}},{key:"setUIEnabled",value:function(e){this.explodeUI.setUIEnabled(e),e||this.tool.deactivate(!1)}}])&&$(t.prototype,r),n&&$(t,n),Object.defineProperty(t,"prototype",{writable:!1}),o}(i.Extension);function ae(e,t){i.Extension.call(this,e,t),this.viewer=e,this.options=t,this.name="fullscreen"}ae.prototype=Object.create(i.Extension.prototype),ae.prototype.constructor=ae;var se=ae.prototype;function le(e,t){i.Extension.call(this,e,t),this.viewer=e,this.options=t,this.name="gohome"}se.activate=function(){return this.activeStatus||(this.viewer.nextScreenMode(),this.activeStatus=!0),!0},se.deactivate=function(){return this.activeStatus&&(this.viewer.escapeScreenMode(),this.activeStatus=!1),!0},le.prototype=Object.create(i.Extension.prototype),le.prototype.constructor=le;var ue=le.prototype;ue.activate=function(){return this.viewer.navigation.setRequestHomeView(!0),!0},ue.deactivate=function(){return!1};var ce=r(10831),he=Autodesk.Viewing,de=['<div class="orbit-gizmo noselect">','<div class="outside"></div>','<div class="ring"></div>','<div class="layout-hor">','<div class="edgemark-area"><div class="edgemark"></div></div>',"</div>",'<div class="layout-mid">','<div class="layout-ver">','<div class="edgemark-area"><div class="edgemark"></div></div>',"</div>",'<div class="circle">','<div class="crosshair-area">','<div class="crosshair-v"></div>','<div class="crosshair-h"></div>',"</div>","</div>",'<div class="layout-ver">','<div class="edgemark-area"><div class="edgemark"></div></div>',"</div>","</div>",'<div class="layout-hor">','<div class="edgemark-area"><div class="edgemark"></div></div>',"</div>","</div>"].join("\n");function fe(){var e,t,r,n,i,o=["fusion orbit","fusion orbit constrained"],a=0,s=1,l=2,u=.005,c=.005,h=1,d={},f=(0,v.isTouchDevice)(),p=!1,m={buttons:[],src:void 0,x:0,y:0,dx:0,dy:0,firstMove:!0,mode:void 0},g=this;this.setViewer=function(e){this.viewer=e,this.navapi=e?e.navigation:null,e&&this.setGlobalManager(e.globalManager)};var y=function(e){m.buttons[e.touches?0:e.button]=!0,m.src=e.target.className,m.x=0,m.y=0,m.dx=0,m.dy=0,m.firstMove=!0,m.mode=void 0,"ring"===m.src?m.mode=l:"edgemark-area"===m.src&&("layout-ver"===e.target.parentNode.className?m.mode=a:"layout-hor"===e.target.parentNode.className&&(m.mode=s)),A(),e.stopPropagation()},b=function(e){m.buttons[e.touches?0:e.button]=!1,m.src=void 0},x=function(e){m.buttons[0]&&(_(e),E(),m.firstMove=!1)},_=function(e){var t=e.touches?e.touches[0].pageX:e.pageX,r=e.touches?e.touches[0].pageY:e.pageY;m.firstMove||(m.dx=t-m.x,m.dy=r-m.y),m.x=t,m.y=r},E=function(){switch(m.mode){case l:if(!g.navapi.isActionEnabled("roll"))return;break;case a:case s:if(!g.navapi.isActionEnabled("orbit"))return}var e=i.target.clone().sub(i.position).normalize(),t=e.clone().cross(i.up).normalize(),r=t.clone().cross(e).normalize();if(i.up.copy(r),m.mode===l){var o=new THREE.Vector3(m.x-d.center.x,m.y-d.center.y,0),f=new THREE.Vector3(m.dx,m.dy,0).add(o);o.normalize(),f.normalize();var p=o.clone().cross(f),v=Math.asin(p.z);i.up.applyAxisAngle(e,-v*h)}else{var y,b;m.mode===a?(b=-m.dx*u,n&&(i.up=ce.Navigation.snapToAxis(i.up.clone())),y=i.up):m.mode===s&&(b=-m.dy*c,n?(m.firstMove&&(i.up=ce.Navigation.snapToAxis(i.up.clone())),y=e.clone().cross(i.up).normalize()):y=t,i.up.applyAxisAngle(y,b));var x=g.navapi.getPivotPoint(),_=i.position.clone().sub(x);_.applyAxisAngle(y,b),i.position.addVectors(x,_);var E=i.target.clone().sub(x);E.applyAxisAngle(y,b),i.target.addVectors(x,E)}i.dirty=!0},w=function(e,t){var r=t||e.clone().sub(i.position).normalize();return new THREE.Plane(r,-r.x*e.x-r.y*e.y-r.z*e.z)},A=function(){var e=i.target.clone().sub(i.position).normalize(),t=w(i.position,e).distanceToPoint(i.pivot);i.pivot.copy(e).multiplyScalar(t).add(i.position)},S=function(e){e.touches||0!==e.button||A()},M=function(){p&&g.viewer.setActiveNavigationTool()},T=function(e,t){var r,n=g.viewer.impl.hitTest(e,t);if(n&&n.intersectPoint)r=n.intersectPoint;else{var o=g.viewer.impl.viewportToRay(g.viewer.impl.clientToViewport(e,t));r=new THREE.Vector3,o.intersectPlane(w(i.target),r)}var a=i.position.clone().sub(function(){var e=i.target.clone().sub(i.position).normalize(),t=g.viewer.impl.rayIntersect(new THREE.Ray(i.position,e));return t&&t.intersectPoint?t.intersectPoint:i.target}()).add(r);g.navapi.setRequestTransition(!0,a,r,i.fov)};this.register=function(){(e=(0,Y.stringToDOM)(de)).style.display="none",this.viewer.canvasWrap.insertBefore(e,this.viewer.canvasWrap.firstChild),(t=e.querySelector(".ring")).addEventListener("mousedown",y),Array.prototype.forEach.call(e.querySelectorAll(".edgemark-area"),(function(e){e.addEventListener("mousedown",y),f&&e.addEventListener("touchstart",y)})),this.addWindowEventListener("mouseup",b),this.addWindowEventListener("mousemove",x),(r=e.querySelector(".outside")).addEventListener("mousedown",M);var n=e.querySelector(".circle");n.addEventListener("mousedown",S),f&&(t.addEventListener("touchstart",y),this.addWindowEventListener("touchend",b),this.addWindowEventListener("touchmove",x),r.addEventListener("touchstart",M),n.addEventListener("touchstart",S)),i=this.viewer.impl.camera},this.deregister=function(){this.removeWindowEventListener("mouseup",b),this.removeWindowEventListener("mousemove",x),r.removeEventListener("mousedown",M),f&&(this.removeWindowEventListener("touchend",b),this.removeWindowEventListener("touchmove",x),r.removeEventListener("touchstart",M)),this.viewer.canvasWrap.removeChild(e),e=void 0,t=void 0,r=void 0},this.activate=function(t){e.style.display="",this.handleResize(),n="fusion orbit constrained"===t;var r=this.viewer.toolController.isToolActivated("hyperlink");r&&this.viewer.toolController.deactivateTool("hyperlink"),n?(this.viewer.setDefaultNavigationTool("orbit"),this.viewer.prefs.set("fusionOrbitConstrained",!0)):(this.viewer.setDefaultNavigationTool("freeorbit"),this.viewer.prefs.set("fusionOrbitConstrained",!1)),r&&this.viewer.toolController.activateTool("hyperlink"),this.viewer.navigation.setZoomTowardsPivot(!0)},this.deactivate=function(){e.style.display="none",this.viewer.navigation.setZoomTowardsPivot(this.viewer.prefs.get("zoomTowardsPivot"))},this.getNames=function(){return o},this.getName=function(){return o[0]},this.update=function(){return!1},this.handleSingleClick=function(e){return T(e.canvasX,e.canvasY),!0},this.handleDoubleClick=function(){return!0},this.handleSingleTap=function(e){return T(e.canvasX,e.canvasY),!0},this.handleDoubleTap=function(){return!1},this.handleKeyDown=function(){return!1},this.handleKeyUp=function(){return!1},this.handleWheelInput=function(){return!1},this.handleButtonDown=function(){return!1},this.handleButtonUp=function(){return!1},this.handleMouseMove=function(e){var t=this.viewer.impl.getCanvasBoundingClientRect(),n=(t.width>t.height?new THREE.Vector2(((e.canvasX+.5)/t.width*2-1)*t.width/t.height,-(e.canvasY+.5)/t.height*2+1):new THREE.Vector2((e.canvasX+.5)/t.width*2-1,(-(e.canvasY+.5)/t.height*2+1)*t.height/t.width)).length()>1.2;return p!==n&&(r.style.cursor=n?"":"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAMAAADXqc3KAAAAt1BMVEUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///8AAAAzMzP6+vri4uISEhKKioqtra2dnZ2EhIR9fX10dHRkZGQdHR3t7e3Hx8e5ubm1tbWoqKhWVlZKSko4ODgICAjv7+/o6OjMzMyxsbFOTk4pKSkXFxcEBAT29vbW1tZ6enpISEgLCwvhzeX+AAAAGXRSTlMANRO0nHRJHfnskIxQRKh89syDVwTWZjEJxPFEswAAAOFJREFUKM+1j+lygkAQhIflEAJe0Rw9u4CCeKKoSTTX+z9XoMJWWeX+ssrvZ3f19DQ5zOw/0DUMQPlmQ72bE2adBp8/Rp3CQUi3ILx+bxj4fjDs9T1Bmo6bbPPN8aDU4bjJt4nb+de789kSFyxn826jW3ICLNZZKU8nWWbrBTCRVm04U8TpjquRFf1Go0d7l8aYOrUR7FGEFr1S9LGymwthgX2gE/Kl0cHPOtF2xOWZ5QpIC93RflW4InkDoPRXesd5LJIMQPzV7tCMa7f6BvhJL79AVDmYTNQ1NhnxbI/uwB8H5Bjd4zQPBAAAAABJRU5ErkJggg==), auto",p=n),!1},this.handleGesture=function(){return A(),!1},this.handleBlur=function(){return!1},this.handleResize=function(){var r=e.getBoundingClientRect(),n=this.getWindow();d.left=r.left+n.pageXOffset,d.top=r.top+n.pageYOffset,d.width=r.width,d.height=r.height,d.center={},d.center.x=d.left+d.width/2,d.center.y=d.top+d.height/2;var i=.8*(n.innerWidth>n.innerHeight?n.innerHeight:n.innerWidth);e.style.width=e.style.height=i+"px",e.style.top=e.style.left="calc(50% - "+i/2+"px)",t.style.borderWidth=.1*i+"px"}}function pe(e,t,r,n,i,o,a){try{var s=e[o](a),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,i)}he.GlobalManagerMixin.call(fe.prototype);var me="fusionfreeorbit",ge="fusionorbit";function ve(e,t){i.Extension.call(this,e,t),this.name=ge,this.modes=[ge,me]}ve.prototype=Object.create(i.Extension.prototype),ve.prototype.constructor=ve;var ye=ve.prototype;ye.load=function(){var e=this.viewer;return this.tool=new fe,this.tool.setViewer(e),e.toolController.registerTool(this.tool),this._onToolChanged=this._onToolChanged.bind(this),!0},ye._updateActiveState=function(e,t){this.activeStatus=e,this.mode=t},ye._onToolChanged=function(e){if("fusion orbit constrained"===e.toolName||"fusion orbit"===e.toolName){var t=this._toolbar.getControl(A.TOOLBAR.NAVTOOLSID),r="fusion orbit"===e.toolName?t.freeorbitbutton:t.orbitbutton,n=e.active?s.Button.State.ACTIVE:s.Button.State.INACTIVE;r.setState(n),this._updateActiveState(!n)}},ye.onToolbarCreated=function(){var e,t=(e=regeneratorRuntime.mark((function e(t){var r,n,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this,n=this.viewer,(i=t.getControl(A.TOOLBAR.NAVTOOLSID))&&i.orbitbutton){e.next=6;break}return e.next=6,n.loadExtension("Autodesk.DefaultTools.NavTools",n.config);case 6:this._toolbar=t,this.viewer.addEventListener(Autodesk.Viewing.TOOL_CHANGE_EVENT,this._onToolChanged),this.classicBehavior={},this.classicBehavior.orbitOnClick=i.orbitbutton.onClick,this.classicBehavior.freeorbitOnClick=i.freeorbitbutton.onClick,this.classicBehavior.returnToDefault=i.returnToDefault,i.freeorbitbutton.onClick=function(){var e=i.freeorbitbutton.getState();e===s.Button.State.INACTIVE?r.activate(me):e===s.Button.State.ACTIVE&&r.deactivate()},i.orbitbutton.onClick=function(){var e=i.orbitbutton.getState();e===s.Button.State.INACTIVE?r.activate(ge):e===s.Button.State.ACTIVE&&r.deactivate()},i.returnToDefault=function(){i.orbittoolsbutton&&i.orbittoolsbutton.setState(s.Button.State.ACTIVE)},i.orbittoolsbutton.setState(s.Button.State.INACTIVE),n.prefs.get("fusionOrbitConstrained")?(i.orbittoolsbutton.onClick=i.orbitbutton.onClick,i.orbittoolsbutton.setIcon(i.orbitbutton.iconClass),n.setDefaultNavigationTool("orbit")):(i.orbittoolsbutton.onClick=i.freeorbitbutton.onClick,i.orbittoolsbutton.setIcon(i.freeorbitbutton.iconClass),n.setDefaultNavigationTool("freeorbit")),n.setActiveNavigationTool(),i.returnToDefault&&i.returnToDefault();case 19:case"end":return e.stop()}}),e,this)})),function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function a(e){pe(o,n,i,a,s,"next",e)}function s(e){pe(o,n,i,a,s,"throw",e)}a(void 0)}))});return function(e){return t.apply(this,arguments)}}(),ye.unload=function(){var e=this.viewer;if(e.removeEventListener(Autodesk.Viewing.TOOL_CHANGE_EVENT,this._onToolChanged),this.classicBehavior){var t=e.getToolbar().getControl(A.TOOLBAR.NAVTOOLSID);t&&(t.orbitbutton&&(t.orbitbutton.onClick=this.classicBehavior.orbitOnClick),t.freeorbitbutton&&(t.freeorbitbutton.onClick=this.classicBehavior.freeorbitOnClick),t.returnToDefault=this.classicBehavior.returnToDefault,t.orbittoolsbutton&&(t.orbitbutton?t.orbittoolsbutton.onClick=t.orbitbutton.onClick:t.orbittoolsbutton.onClick=null,t.orbittoolsbutton.setIcon("adsk-icon-orbit-constrained"),t.orbittoolsbutton.setState(s.Button.State.ACTIVE))),this.classicBehavior=null}return e.setActiveNavigationTool("orbit"),e.setDefaultNavigationTool("orbit"),e.toolController.deregisterTool(this.tool),this.tool.setViewer(null),this.tool=null,this._toolbar=null,!0},ye.activate=function(e){if(!this.isActive(e)){if(e===me)this.viewer.setActiveNavigationTool("fusion orbit"),this.mode=me;else this.viewer.setActiveNavigationTool("fusion orbit constrained"),this.mode=ge;return this.activeStatus=!0,!0}},ye.deactivate=function(){return this.activeStatus&&(this.viewer.setActiveNavigationTool(),this.activeStatus=!1),!0},n.theExtensionManager.registerExtension("Autodesk.PropertiesManager",c),n.theExtensionManager.registerExtension("Autodesk.ViewerSettings",p),n.theExtensionManager.registerExtension("Autodesk.ModelStructure",E),n.theExtensionManager.registerExtension("Autodesk.DefaultTools.NavTools",k),n.theExtensionManager.registerExtension("Autodesk.Explode",oe),n.theExtensionManager.registerExtension("Autodesk.FullScreen",ae),n.theExtensionManager.registerExtension("Autodesk.GoHome",le),n.theExtensionManager.registerExtension("Autodesk.Viewing.FusionOrbit",ve)},65692:e=>{e.exports={externalExtensions:[{src:"./extensions/Wireframes/Wireframes.js",ids:["Autodesk.Viewing.Wireframes"]},{src:"./extensions/ZoomWindow/ZoomWindow.js",ids:["Autodesk.Viewing.ZoomWindow"]},{src:"./extensions/AEC/LibraryExports.js",ids:["Autodesk.AEC.LevelsExtension","Autodesk.AEC.HyperlinkExtension","Autodesk.AEC.DropMeExtension","Autodesk.AEC.CanvasBookmarkExtension","Autodesk.AEC.Minimap3DExtension","Autodesk.AEC.LocationsExtension","Autodesk.AEC.Hypermodeling","Autodesk.AEC.ViewportsExtension","Autodesk.AEC.DisciplinesExtension"]},{src:"./extensions/Pushpins/PushPinExtension.js",ids:["Autodesk.BIM360.Extension.PushPin"]},{src:"./extensions/Hyperlink/Hyperlink.js",ids:["Autodesk.Hyperlink"]},{src:"./extensions/Debug/Debug.js",ids:["Autodesk.Debug"]},{src:"./extensions/BimWalk/BimWalk.js",ids:["Autodesk.BimWalk"]},{src:"./extensions/Section/Section.js",ids:["Autodesk.Section"]},{src:"./extensions/CompGeom/index.js",ids:["Autodesk.CompGeom"]},{src:"./extensions/Snapping/index.js",ids:["Autodesk.Snapping"]},{src:"./extensions/Beeline/Beeline.js",ids:["Autodesk.Beeline"]},{src:"./extensions/FirstPerson/FirstPerson.js",ids:["Autodesk.FirstPerson"]},{src:"./extensions/webVR/webVR.js",ids:["Autodesk.Viewing.WebVR"]},{src:"./extensions/WebXR/index.js",ids:["Autodesk.WebXR.Core","Autodesk.WebXR.VR","Autodesk.WebXR.AR"]},{src:"./extensions/CAM360/CAM360.js",ids:["Autodesk.CAM360"]},{src:"./extensions/Collaboration/Collaboration.js",ids:["Autodesk.Viewing.Collaboration"]},{src:"./extensions/FusionSim/FusionSim.js",ids:["Autodesk.Fusion360.Simulation"]},{src:"./extensions/OMV/OMV.js",ids:["Autodesk.OMV"]},{src:"./extensions/SplitScreen/SplitScreen.js",ids:["Autodesk.SplitScreen"]},{src:"./extensions/CrossFadeEffects/CrossFadeEffects.js",ids:["Autodesk.CrossFadeEffects"]},{src:"./extensions/Edit2D/Edit2D.js",ids:["Autodesk.Edit2D"]},{src:"./extensions/Edit3D/Edit3D.js",ids:["Autodesk.Edit3D"]},{src:"./extensions/VisualClusters/VisualClusters.js",ids:["Autodesk.VisualClusters"]},{src:"./extensions/Moldflow/Moldflow.js",ids:["Autodesk.Moldflow"]},{src:"./extensions/PixelCompare/PixelCompare.js",ids:["Autodesk.Viewing.PixelCompare"]},{src:"./extensions/ScalarisSimulation/ScalarisSimulation.js",ids:["Autodesk.Viewing.ScalarisSimulation"]},{src:"./extensions/Measure/Measure.js",ids:["Autodesk.Measure"]},{src:"./extensions/Markup/Markup.js",ids:["Autodesk.Viewing.MarkupsCore","Autodesk.Viewing.MarkupsGui"]},{src:"./extensions/PDF/index.js",ids:["Autodesk.PDF"]},{src:"./extensions/ReCap/index.js",ids:["Autodesk.ReCap"]},{src:"./extensions/Scalaris/index.js",ids:["Autodesk.Scalaris"]},{src:"./extensions/DocumentBrowser/index.js",ids:["Autodesk.DocumentBrowser"]},{src:"./extensions/Geolocation/index.js",ids:["Autodesk.Geolocation"]},{src:"./extensions/Fusion360/AnimationExtension.js",ids:["Autodesk.Fusion360.Animation"]},{src:"./extensions/NPR/index.js",ids:["Autodesk.NPR"]},{src:"./extensions/DOF/DOFExtension.js",ids:["Autodesk.DOF"]},{src:"./extensions/MSDF/index.js",ids:["Autodesk.MSDF"]},{src:"./extensions/MemoryLimited/MemoryLimited.js",ids:["Autodesk.MemoryLimited"]},{src:"./extensions/ViewCubeUi/ViewCubeUi.js",ids:["Autodesk.ViewCubeUi"]},{src:"./extensions/MemoryLimitedDebug/MemoryManager.js",ids:["Autodesk.Viewing.MemoryLimitedDebug"]},{src:"./extensions/BimMarkups/BimMarkups.js",ids:["Autodesk.BIM360.Markups"]},{src:"./extensions/Minimap2D/Minimap2D.js",ids:["Autodesk.BIM360.Minimap"]},{src:"./extensions/GestureDocumentNavigation/GestureDocumentNavigation.js",ids:["Autodesk.BIM360.GestureDocumentNavigation"]},{src:"./extensions/RollCamera/RollCamera.js",ids:["Autodesk.BIM360.RollCamera"]},{src:"./extensions/LayerManager/LayerManager.js",ids:["Autodesk.LayerManager"]},{src:"./extensions/SceneBuilder/sceneBuilder.js",ids:["Autodesk.Viewing.SceneBuilder"]},{src:"./extensions/Popout/index.js",ids:["Autodesk.Viewing.Popout"]},{src:"./extensions/ProfileUi/index.js",ids:["Autodesk.ProfileUi"]},{src:"./extensions/PropertySearch/PropertySearch.js",ids:["Autodesk.PropertySearch"]},{src:"./extensions/StandardSurface/index.js",ids:["Autodesk.StandardSurface"]},{src:"./extensions/MaterialConverterPrism/index.js",ids:["Autodesk.Viewing.MaterialConverterPrism"]},{src:"./extensions/DWF/index.js",ids:["Autodesk.DWF"]},{src:"./extensions/ModelsPanel/index.js",ids:["Autodesk.ModelsPanel"]},{src:"./extensions/ModelAlignment/index.js",ids:["Autodesk.ModelAlignment","Autodesk.SheetAlignment"],dependencies:["Autodesk.Edit3D"]},{src:"./extensions/ModelAlignmentService/ModelAlignmentService.js",ids:["Autodesk.ModelAlignmentService"]},{src:"./extensions/MixpanelProvider/index.js",ids:["Autodesk.Viewing.MixpanelExtension"]},{src:"./extensions/Crop/Crop.js",ids:["Autodesk.Crop"]},{src:"./extensions/DataVisualization/index.js",ids:["Autodesk.DataVisualization"]},{src:"./extensions/ExtensionsPanel/index.js",ids:["Autodesk.ExtensionsPanel"]},{src:"./extensions/StringExtractor/StringExtractor.js",ids:["Autodesk.StringExtractor"]},{src:"./extensions/ModelSheetTransition/ModelSheetTransition.js",ids:["Autodesk.ModelSheetTransition"]},{src:"./extensions/BoxSelection/BoxSelectionExtension.js",ids:["Autodesk.BoxSelection"]},{src:"./extensions/glTF/index.js",ids:["Autodesk.glTF"]},{src:"./extensions/PropertyQuery/index.js",ids:["Autodesk.PropertyQuery"]},{src:"./extensions/VaultPrintUI/index.js",ids:["Autodesk.Vault.Print"]},{src:"./extensions/VaultMarkupsUI/index.js",ids:["Autodesk.Vault.Markups"],dependencies:["Autodesk.BIM360.Markups"]},{src:"./extensions/ThreeJSOverlays/index.js",ids:["Autodesk.ThreeJSOverlays"]},{src:"./extensions/DataExchange/DataExchange.js",ids:["Autodesk.DataExchange"]},{src:"./extensions/Multipage/Multipage.js",ids:["Autodesk.Multipage"]},{src:"./extensions/DynamicDimensions/DynamicDimensions.js",ids:["Autodesk.DynamicDimensions"]},{src:"./extensions/Filter/index.js",ids:["Autodesk.Filter"],buildConfig:"./extensions/Filter/webpack.config.js"}],getExtensionEntryKey:function(e){return e.src.split("/")[2]}}},85101:(e,t,r)=>{"use strict";r.r(t);var n=r(61445),i=r(65692),o="min.js";i.externalExtensions.forEach((function(e){var t=(0,i.getExtensionEntryKey)(e),r="extensions/".concat(t,"/").concat(t,".").concat(o),a=e.dependencies;e.ids.forEach((function(e){n.theExtensionManager.registerExternalExtension(e,r,a)}))})),n.theExtensionManager.registerExternalExtension("Autodesk.DiffTool","extensions/DiffTool/DiffTool.".concat(o))},21319:(e,t,r)=>{"use strict";r.r(t),r.d(t,{analytics:()=>u});var n=r(98926),i=r(76967);function o(e){return function(e){if(Array.isArray(e))return a(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return a(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return a(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var l=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.providerMap={},this.instances=[],this.superProps={},this.shouldTrack=!0,this.trackCache=[],this.oneTimers={}}var t,r,a;return t=e,r=[{key:"registerProvider",value:function(e){var t=this;if(e)if(e.name){var r=e.name.toLowerCase();r in this.providerMap?n.logger.warn("Provider with name ".concat(e.name," already registered")):this.providerMap[r]=e;var i=this.createInstance(e.name,e.defaultOptions);this.instances.push(i),this.shouldTrack&&this.init(i),this.trackCache.length>0&&(this.trackCache.forEach((function(e){var r=e.event,n=e.properties;t.track(r,n)})),this.trackCache=[])}else n.logger.error("missing provider name");else n.logger.error("Undefined provider")}},{key:"init",value:function(e){e.initialized||(e.init(),e.register(this.superProps))}},{key:"createInstance",value:function(e,t){var r=e&&e.toLowerCase();if(r in this.providerMap){var o=this.providerMap[r],a=new o(t);if(!(a instanceof i.AnalyticsProviderInterface))throw new Error("not an analytics provider");return o.instanceCount=o.instanceCount||0,a.name="".concat(r,"-").concat(o.instanceCount),o.instanceCount++,a}n.logger.error("Unknown ".concat(e))}},{key:"optIn",value:function(e){var t=this;this.instances.forEach((function(e){return t.init(e)})),this._callMethod("optIn",e),this.shouldTrack=!0}},{key:"optOut",value:function(e){this._callMethod("optOut",e),this.shouldTrack=!1}},{key:"hasOptedOut",value:function(){return this._callMethod("hasOptedOut")}},{key:"getDistinctId",value:function(){return this._callMethod("getDistinctId")}},{key:"track",value:function(e,t,r){if(this.shouldTrack){if(r){var n={event:e,properties:t};try{var i=JSON.stringify(n);if(this.oneTimers[i])return;this.oneTimers[i]=!0}catch(e){}}0===this.instances.length?this.trackCache.push({event:e,properties:t}):this._callMethod("track",e,t)}}},{key:"identify",value:function(e){this._callMethod("identify",e)}},{key:"_callMethod",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=t[0],i=t.slice(1,t.length);return this.instances.map((function(e){return{name:e.name,value:e[n].apply(e,o(i))}}))}}],r&&s(t.prototype,r),a&&s(t,a),Object.defineProperty(t,"prototype",{writable:!1}),e}(),u=new l},76967:(e,t,r)=>{"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}r.r(t),r.d(t,{AnalyticsProviderInterface:()=>o});var o=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};n(this,e),this.options=t}var t,r,o;return t=e,o=[{key:"name",get:function(){return null}},{key:"defaultOptions",get:function(){return{}}}],(r=[{key:"init",value:function(){}},{key:"register",value:function(){}},{key:"optIn",value:function(e){}},{key:"optOut",value:function(e){}},{key:"hasOptedOut",value:function(){}},{key:"getDistinctId",value:function(){}},{key:"track",value:function(e,t){}},{key:"identify",value:function(e){}}])&&i(t.prototype,r),o&&i(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}()},80382:(e,t,r)=>{"use strict";r.r(t),r.d(t,{Animation:()=>i,interpolateCatmullRom:()=>o});var n=r(80738);function i(e,t,r){this.root=e,this.handler=r.animationHandler,this.data=this.handler.init(t),this.hierarchy=this.handler.parse(e),this.viewer=r.viewer,this.animator=r,this.currentTime=0,this.timeScale=1,this.isPlaying=!1,this.isPaused=!0,this.loop=!1,this.delta=.5,this.interpolationType=n.u.LINEAR,this.setStartAndEndKeyTime()}function o(e,t){function r(e,t,r,n,i,o,a){var s=.5*(r-e),l=.5*(n-t);return(2*(t-r)+s+l)*a+(-3*(t-r)-2*s-l)*o+s*i+t}var n,i,o,a,s,l,u,c,h,d=[],f=[];return o=(n=(e.length-1)*t)-(i=Math.floor(n)),d[0]=0===i?i:i-1,d[1]=i,d[2]=i>e.length-2?i:i+1,d[3]=i>e.length-3?i:i+2,l=e[d[0]],u=e[d[1]],c=e[d[2]],h=e[d[3]],s=o*(a=o*o),f[0]=r(l[0],u[0],c[0],h[0],o,a,s),f[1]=r(l[1],u[1],c[1],h[1],o,a,s),f[2]=r(l[2],u[2],c[2],h[2],o,a,s),f}r(35449).GlobalManagerMixin.call(i.prototype),i.prototype.setStartAndEndKeyTime=function(){if(this.data.hierarchy.length>0){var e=this.data.hierarchy[0].keys;this.startKeyTime=e[0].time,this.endKeyTime=e[e.length-1].time}else this.startKeyTime=this.endKeyTime=0},i.prototype.keyTypes=[],i.prototype.defaultKey={},i.prototype.play=function(e){this.currentTime=void 0!==e?e:0,this.isPlaying=!0,this.isPaused=!1,this.reset(),this.handler.play(this)},i.prototype.pause=function(){!0===this.isPaused?this.handler.play(this):this.handler.stop(this),this.isPaused=!this.isPaused},i.prototype.stop=function(){this.isPlaying=!1,this.isPaused=!1,this.handler.stop(this)},i.prototype.goto=function(e){this.isPlaying||this.play(),this.isPaused||this.pause();var t=e-this.currentTime;this.update(t)},i.prototype.reset=function(){for(var e=0,t=this.hierarchy.length;e<t;e++){var r=this.hierarchy[e];void 0===r.animationCache&&(r.animationCache={}),void 0===r.animationCache[this.data.name]&&(r.animationCache[this.data.name]={prevKey:this.defaultKey,nextKey:this.defaultKey,originalMatrix:r.matrix});for(var n=r.animationCache[this.data.name],i=0;i<this.keyTypes.length;i++){for(var o=this.keyTypes[i],a=this.data.hierarchy[e].keys[0],s=this.getNextKeyWith(o,e,1);s.time<this.currentTime&&s.index>a.index;)a=s,s=this.getNextKeyWith(o,e,s.index+1);n.prevKey[o]=a,n.nextKey[o]=s}}this.setStartAndEndKeyTime()},i.prototype.getNextKeyWith=function(e,t,r){var i=this.data.hierarchy[t].keys;for(this.interpolationType===n.u.CATMULLROM||this.interpolationType===n.u.CATMULLROM_FORWARD?r=r<i.length-1?r:i.length-1:r%=i.length;r<i.length;r++)if(void 0!==i[r][e])return i[r];return this.data.hierarchy[t].keys[0]},i.prototype.getPrevKeyWith=function(e,t,r){var i=this.data.hierarchy[t].keys;for(r=this.interpolationType===n.u.CATMULLROM||this.interpolationType===n.u.CATMULLROM_FORWARD?r>0?r:0:r>=0?r:r+i.length;r>=0;r--)if(void 0!==i[r][e])return i[r];return this.data.hierarchy[t].keys[i.length-1]},i.prototype.isPlayingOutOfRange=function(){return!1===this.isPaused&&(this.currentTime<this.startKeyTime-this.delta||this.currentTime>this.endKeyTime+this.delta)},i.prototype.resetIfLooped=function(){!0===this.loop&&this.currentTime>this.endKeyTime&&(this.currentTime%=this.endKeyTime,this.reset())}},80738:(e,t,r)=>{"use strict";r.d(t,{u:()=>n});var n={LINEAR:0,CATMULLROM:1,CATMULLROM_FORWARD:2}},21550:(e,t,r)=>{"use strict";function n(){this.animations=[]}r.r(t),r.d(t,{KeyFrameAnimator:()=>g}),n.prototype.init=function(e){if(!0===e.initialized)return e;for(var t=0;t<e.hierarchy.length;t++){for(var r=0;r<e.hierarchy[t].keys.length;r++)if(e.hierarchy[t].keys[r].time<0&&(e.hierarchy[t].keys[r].time=0),void 0!==e.hierarchy[t].keys[r].rot&&!(e.hierarchy[t].keys[r].rot instanceof THREE.Quaternion)){var n=e.hierarchy[t].keys[r].rot;Array.isArray(n)||(n=[n._x,n._y,n._z,n._w]),e.hierarchy[t].keys[r].rot=(new THREE.Quaternion).fromArray(n)}for(var i=1;i<e.hierarchy[t].keys.length;i++)e.hierarchy[t].keys[i].time===e.hierarchy[t].keys[i-1].time&&(e.hierarchy[t].keys.splice(i,1),i--);for(var o=0;o<e.hierarchy[t].keys.length;o++)e.hierarchy[t].keys[o].index=o}return e.initialized=!0,e},n.prototype.parse=function(e){var t=[];return function e(t,r){if(r.push(t),t.children&&!(t instanceof THREE.Camera))for(var n=0;n<t.children.length;n++)e(t.children[n],r)}(e,t),t},n.prototype.play=function(e){-1===this.animations.indexOf(e)&&this.animations.push(e)},n.prototype.stop=function(e){var t=this.animations.indexOf(e);-1!==t&&this.animations.splice(t,1)},n.prototype.update=function(e){for(var t=0;t<this.animations.length;t++)this.animations[t].update(e)};var i,o,a,s=r(94981),l=r(23909),u=r(80738),c=r(80382);function h(e,t,r){c.Animation.call(this,e,t,r),this.followCam=!0}function d(e,t,r){var n,i=this;c.Animation.call(this,{},e,r),this.fragPointers=[],this.nodeChildren=[],this.nodeFragments=[];var o=this.viewer.model.getData().instanceTree;o.enumNodeChildren(t,(function(e){i.nodeChildren.push(e)}),!0),o.enumNodeFragments(e.id,(function(e){i.nodeFragments.push(e),(n=i.viewer.getFragmentProxy(i.viewer.model,e))&&(i.fragPointers.push(n),n.setMaterial(i.viewer.matman().cloneMaterial(n.getMaterial(),i.viewer.model)))}),!0),this.nodeId=t,this.epsilon=.1}h.prototype=Object.create(c.Animation.prototype),h.prototype.constructor=h,h.prototype.keyTypes=["pos","up","target","fov","perspective"],h.prototype.defaultKey={pos:0,up:0,target:0,fov:0,perspective:0},h.prototype.setFollowCamera=function(e){this.followCam=e},h.prototype.update=(i=[],o=new l.Vector3,a=new l.Vector3,function(e){if(!1!==this.isPlaying&&(this.currentTime+=e*this.timeScale,this.resetIfLooped(),this.followCam&&!this.isPlayingOutOfRange())){for(var t=0,r=this.hierarchy.length;t<r;t++){for(var n=this.hierarchy[t],s=n.animationCache[this.data.name],l=0;l<this.keyTypes.length;l++){var h=this.keyTypes[l],d=s.prevKey[h],f=s.nextKey[h];if(f.time<=this.currentTime||d.time>=this.currentTime){for(d=this.data.hierarchy[t].keys[0],f=this.getNextKeyWith(h,t,1);f.time<this.currentTime&&f.index>d.index;)d=f,f=this.getNextKeyWith(h,t,f.index+1);s.prevKey[h]=d,s.nextKey[h]=f}var p=d[h],m=f[h];if(f.time!==d.time&&void 0!==p&&void 0!==m){var g,v=(this.currentTime-d.time)/(f.time-d.time);if(v<0&&(v=0),v>1&&(v=1),"pos"===h)g=n.position;else if("up"===h)g=n.up;else if("target"===h)g=n.target;else{if("fov"===h){n.setFov(p+(m-p)*v);continue}if("perspective"===h){(v>.5?m:p)?n.toPerspective():n.toOrthographic();continue}}if(this.interpolationType===u.u.LINEAR)a.x=p[0]+(m[0]-p[0])*v,a.y=p[1]+(m[1]-p[1])*v,a.z=p[2]+(m[2]-p[2])*v,g.copy(a);else{i[0]=this.getPrevKeyWith(h,t,d.index-1)[h],i[1]=p,i[2]=m,i[3]=this.getNextKeyWith(h,t,f.index+1)[h],v=.33*v+.33;var y=(0,c.interpolateCatmullRom)(i,v);if(a.x=y[0],a.y=y[1],a.z=y[2],g.copy(a),this.interpolationType===u.u.CATMULLROM_FORWARD){var b=(0,c.interpolateCatmullRom)(i,1.01*v);o.set(b[0],b[1],b[2]),o.sub(g),o.y=0,o.normalize();var x=Math.atan2(o.x,o.z);n.rotation.set(0,x,0)}}}}n.matrixAutoUpdate=!0,n.matrixWorldNeedsUpdate=!0}n.lookAt(n.target),this.animator.updateFlag|=this.animator.UPDATE_CAMERA}}),d.prototype=Object.create(c.Animation.prototype),d.prototype.constructor=d,d.prototype.keyTypes=["vis","opa"],d.prototype.defaultKey={viz:1,opa:1},d.prototype.getPrevAndNextKeys=function(e,t){for(var r=this.data.hierarchy[e].keys[0],n=this.getNextKeyWith(t,e,1);n.time<this.currentTime&&n.index>r.index;)r=n,n=this.getNextKeyWith(t,e,n.index+1);return{prevKey:r,nextKey:n}},d.prototype.update=function(e){if(!1!==this.isPlaying&&(this.currentTime+=e*this.timeScale,this.resetIfLooped(),!this.isPlayingOutOfRange()))for(var t=0,r=this.hierarchy.length;t<r;t++){var n=this.hierarchy[t].animationCache[this.data.name],i=n.prevKey.vis,o=n.prevKey.vis,a=n.prevKey.opa,s=n.prevKey.opa;if(o.time<=this.currentTime||i.time>=this.currentTime){var l=this.getPrevAndNextKeys(t,"vis");i=l.prevKey,o=l.nextKey,n.prevKey.vis=i,n.nextKey.vis=o}if(s.time<=this.currentTime||a.time>=this.currentTime){var u=this.getPrevAndNextKeys(t,"opa");a=u.prevKey,s=u.nextKey,n.prevKey.opa=a,n.nextKey.opa=s}var c=i.vis,h=o.vis;if(void 0!==c&&void 0!==h&&i.time!==o.time){var d=Math.abs(this.currentTime-o.time)<this.epsilon?h:c;this.viewer.visibilityManager.setNodeOff(this.nodeId,!d,this.viewer.model,this.nodeChildren,this.nodeFragments)}if(c=a.opa,h=s.opa,void 0===c&&1===i.vis&&(c=1),void 0!==c&&void 0!==h&&a.time!==s.time){var f=(this.currentTime-a.time)/(s.time-a.time);f<0&&(f=0),f>1&&(f=1);for(var p=c+(h-c)*f,m=0;m<this.fragPointers.length;++m){var g=this.fragPointers[m].getMaterial();g.transparent=1!==p,g.opacity=p}p>0&&this.viewer.visibilityManager.setNodeOff(this.nodeId,!1,this.viewer.model,this.nodeChildren,this.nodeFragments)}}};var f=r(94370);function p(e,t,r){var n=this;null===e&&(e=function(e,t,r){var i=this.getDocument(),o=n.container=i.createElement("div"),a=e.name;o.id=a,o.style.cursor="pointer",o.style.visibility=r;var s=i.createElement("div");s.id=a+"-txt",s.style.cssText="display: none;position: absolute;z-index: 1;",o.appendChild(s);var u=i.createElement("img"),c=e.custom&&e.custom.att&&1===e.custom.att;u.src=c?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAABv1BMVEUAAAAAAAAAAAAAAAABAwEAAAAAAAAjSRkAAAAFDASJqnZhg1IqTyAjSRkpTx8hRxggRRcAAAAhRRcKFwgAAACau4R9mnFmiFUhSBgbOhMZNhIAAAAECQMgQxcAAAAAAAAAAAAHDwXB2q2jw4yfvoivyJ6fuI6mv5eSr4KAoWu2trZpiV3Nzc0wVSUhRxhNT01vb28AAAAgRBcAAAAAAAAAAAAhRxgeQBYAAAAAAAAAAAAfQRbP5MC0zqCqyJKpyJJBYje3z6WxyKOFpXF9nmkrTiG+wb5xkGVcf0xYfEg1WSpNTU0hRhgfQhYfQhZVVVVAQEAXMREcOhQcHBwSJw0AAAAAAAAWLxAVLQ8AAAAAAAAfQhYIEgYAAACbvn+DsGCGsmSUunaItGXc6dStypelxY2ZvX2Ntm2JtGnS48fB17G40aWNuWucxH6ny4mUvnPF27aPuHCEsGHV5czI3Lq52KGvzJqz1JmqyJOqzY6ew4OYwHiGs2OEsWHb29vL4LvM5bnD3q2+3KWkyoaLtWuKtmfOzs7IyMi21pyawXqPuG/g4ODX68fI4rTG4LCu0ZKszJKlx4qZwHuBnXR2iXENcZskAAAAXnRSTlMAEAIBCAsF6BUn+vPu7erjsZyBEwP99/TRk3JgRUQ1IxwO/v79/Pv6+fn09PPq08q7sqWDe2xrY01AMBj+/v7+/v37+fn59fXz8u/c1cbFxLWonZiIcm1lYVdSQT8de/EoFwAAAgVJREFUOMutklVz21AQRiNFlswYs+M6DTdN0kCDZWZmuAKDZFtgiO2YYm6TlOEHV53ptGs5j93Xc+a7e3d36P/W9prdZ/PZ17aPxphz3mR0x91G07wTG8TDo5R3HLGH3S6fGPdSo8Na/to6W2HZBEqwPCNULlu1BkFdQSyKx4qxOMoyDDJSRB/HnTcqWbSbTmVS6V3E57hvXicOBZd1gmfj6Z1kPrmTjrMMfRizumDA+k3UTcRSyWg0mkzFEgLNlU3rIIJcns0KqJjJq0I+U0SqUJlZJv8JugU3J/QnHEwu6MCMqPN1pq+H3sFxCgOC7RyT48Ev6qLUL/gmeJrJ/p0DzSnyxTtAGLMbv9dohv8zSbomSqUpOxB0AdNXsUbnGEEQmJzKq3JrLgCaJAzms5LI1enfVefEamc/YzYQYFB6/1xBUsQex3E9UZHkUvO6X48PwQjLTKEjVRVFqUqd8v6naQsMUCNcL8xTrVJZluXyl1K7OW1+7sL71x15cvVH43O7UGi3mmc8lkCE0ByMbvXazwueycbHxiXPrUdv3hLDGiF8au/d4sO7Novtnj9k0BO45uRGTp98f2JlK/RqYzN8TK8bGTjZLTXgfvDp6rMNA0ZADAOWHI6VTYwE4WAZjz/s3V5yvIxADosIPlh0BNXHSdA8LFIfDgE8WDg5hmmx9h/40fgXth2SDk3yjP4AAAAASUVORK5CYII=":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAABvFBMVEUAAAAAAAADAAAAAAAAAAACAAAAAAAAAAC5PznHVE8BAAAAAADbc27NXVeUDQaZDQaRBwAAAAAAAACHBgDuhoHVa2W9RD2QCAKYCAGPBgB0BQAAAAAAAACMBgAAAAADAAD2jonWb2n2jYjYbWfmeXPNzc3RYFqzODKfFA1RUVGKBgCVBwBvb2+WBwCBBgCFBgCWBwCLBgAAAAAAAACMBgCTBwByBQCTBwBbBACEBgAAAAAAAAAoAgBSBADgeHOoOzXmfnnofnjieHPGvr63t7e0tLTidW/ebmnba2XWZWDAT0qRHBfBSkRNTU2aFxGOBgBYTEsAAACNBgBAQEAAAABbBQAcHBxyBQBKBAAAAABfBAAAAAAAAAAsAgAkAgCJBgDZRT3MOTHQPDTVQjrlUkrjUEjRPjbOOjP/bGTvXFTqV0/fTETNOjL5Zl7eS0PzYFjxXlbiT0fUQTn0e3T7aGDWXFXbSEDTRj/PQTrOPjbb29vgamTxY1zoVE3STETTQjvSPzfOzs7IyMj5g3zzaWLXY13XYVrsXlbbU0zg4OD8lZD4gXq0eHXqd3HscWv2b2jrZmDQZWDdWVLkV1C5y9+5AAAAYHRSTlMAAgUBDggMEeDsIBj+8NHJxpxAEP754tDDtIFsYDkvI/78+/j08/DfycfHxbuvr5mTjYN0bWxkWVZTTDUjEfz8+/n59fT08vHw8PDw5NzV0Mq5uLWrm5iLfX1hV0g/ODZEwKduAAACAklEQVQ4y62SVXPbQBzEa1mWZYaY49ihBhtmKjMzw92JLLBsyxxT2mCZvnCVmU59VpO37Ms97G929nb+p05WXUvTE5GJ6aWuY+yFEdoVdAZd9MjCEYi5J0L3FZutSqVZdIYiPWaj/85j2yszAACGVyq7Lo+RIMZtxRaQOZaTwZZSLbrGLR2+aX54twVykpgVpRzgYbVGz5twYMPTV2ZkKZMupDOSzAiwfNazgQesDO9VASemU6lUWuQAgnyNXsEiiBlbEwE2W9CBQpbVAfRraIZoA5ZosII6EpB6MYrVpLxOQejowKsBL9UGSK+zCnnsF4omB7wkBkQHylDZ+rcDROD3hYcYQE0NHQhQ4f8uCQVG/XF9isJKLtI1TYBQQAgdPlqJzYcWMYBYd58/YJACD6UgpsTVA+51AhvKGgt9zQGN1xN4Dajs/vbtmBXf2mIP3/jGqiW9Q0nlGtn8tXBSnwGPWHYP5PcbLMs2JHFn+6p7WQ/ARTie3/rZm9+pZ+rfP/fawi8dhOFgqLlLX87dHOz/1D9ou/vsrcNiNgBrZzbf338yOXZvbDL2xm4ljCdn6j794cpswr/62p+wWy2m/042oQeMxudedK8mSdzGAy4/9vlm/STRtjGRTz9u3nnge2U3+O2h4o9GfXG7lcLKGWZY8ycduG3sQJCk0Tb+w3S0/Qemc4+eJchuZgAAAABJRU5ErkJggg==",u.id=a+"-img",u.style.cssText="display: block;position: absolute;z-index: 1;",o.appendChild(u),t.api.container.appendChild(o),o.addEventListener("click",(function(){s.style.display="none"===s.style.display?"block":"none"}));var h=new l.SphereGeometry(.01),d=new l.MeshPhongMaterial({color:32512,opacity:.6,transparent:!0}),f=new l.Mesh(h,d);return f.visible=!1,void 0===t.overlayScenes.annotation&&t.createOverlayScene("annotation"),t.addOverlay("annotation",f),f}.call(this,t,r.viewer,"hidden")),c.Animation.call(this,e,t,r),this.id=t.name,this.text="",this.state="hidden",this.epsilon=.1,this.viewer.api.addEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,(function(t){n.updateText(e.position,n.text)}))}function m(e,t,r){this.viewer=r.viewer,null===e&&(e=this.createPolyline([])),c.Animation.call(this,e,t,r),this.epsilon=.1}function g(e,t){this.animations=[],this.viewer=e,this.setGlobalManager(e.globalManager),this.keys=[],this.isPlaying=!1,this.isPaused=!0,this.updateFlag=0,this.duration=t,this.currentTime=0,this.onPlayCallback=null,this.animationHandler=new n,this.areCameraAnimationsPaused=!1,this.UPDATE_SCENE=1,this.UPDATE_CAMERA=2,this.followCam=!0,this._speedMod=1,this._loops=!1}p.prototype=Object.create(c.Animation.prototype),p.prototype.constructor=p,p.prototype.keyTypes=["pos","text","vis"],p.prototype.defaultKey={pos:0,text:"",vis:1},p.prototype.stop=function(){c.Animation.prototype.stop.call(this),this.container.parentNode.removeChild(this.container),this.viewer.removeOverlay("annotation",this.root),this.root=null},p.prototype.updateText=function(e,t){var r=function(e,t,r){var n=e.clone(),i=new l.Matrix4;return t.updateMatrixWorld(),i.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),{x:((n=(0,f.r)(n,i)).x+1)*r.width/2+r.offsetLeft-12,y:(1-n.y)*r.height/2+r.offsetTop+12}}(e,this.viewer.camera,this.viewer.canvas),n=this.getDocument(),i=n.getElementById(this.id+"-txt");i&&(i.innerHTML=t,i.style.left=r.x+"px",i.style.top=r.y+"px",this.text=t),(i=n.getElementById(this.id+"-img"))&&(i.style.left=r.x+"px",i.style.top=r.y-24+"px")},p.prototype.update=function(){var e=[],t=new l.Vector3,r=new l.Vector3;return function(n){if(!1!==this.isPlaying&&(this.currentTime+=n*this.timeScale,this.resetIfLooped(),!this.isPlayingOutOfRange())){var i=this.getDocument();if(this.isPaused&&this.currentTime<this.startKeyTime)(E=i.getElementById(this.id))&&(E.style.visibility=this.state);else for(var o=0,a=this.hierarchy.length;o<a;o++){for(var s=this.hierarchy[o],l=s.animationCache[this.data.name],h=0;h<this.keyTypes.length;h++){var d=this.keyTypes[h],f=l.prevKey[d],p=l.nextKey[d];if(p.time<=this.currentTime||f.time>=this.currentTime){for(f=this.data.hierarchy[o].keys[0],p=this.getNextKeyWith(d,o,1);p.time<this.currentTime&&p.index>f.index;)f=p,p=this.getNextKeyWith(d,o,p.index+1);l.prevKey[d]=f,l.nextKey[d]=p}var m=f[d],g=p[d];if(p.time!==f.time&&void 0!==m&&void 0!==g){var v=(this.currentTime-f.time)/(p.time-f.time);if(v<0&&(v=0),v>1&&(v=1),"pos"===d){if(this.interpolationType===u.u.LINEAR)r.x=m[0]+(g[0]-m[0])*v,r.y=m[1]+(g[1]-m[1])*v,r.z=m[2]+(g[2]-m[2])*v,s.position.copy(r);else if(this.interpolationType===u.u.CATMULLROM||this.interpolationType===u.u.CATMULLROM_FORWARD){e[0]=this.getPrevKeyWith("pos",o,f.index-1).pos,e[1]=m,e[2]=g,e[3]=this.getNextKeyWith("pos",o,p.index+1).pos,v=.33*v+.33;var y=(0,c.interpolateCatmullRom)(e,v);if(r.x=y[0],r.y=y[1],r.z=y[2],s.position.copy(r),this.interpolationType===u.u.CATMULLROM_FORWARD){var b=(0,c.interpolateCatmullRom)(e,1.01*v);t.set(b[0],b[1],b[2]),t.sub(vector),t.y=0,t.normalize();var x=Math.atan2(t.x,t.z);s.rotation.set(0,x,0)}}}else if("text"===d){var _=Math.abs(this.currentTime-p.time)<this.epsilon?g:m;this.updateText(s.position,_)}else if("vis"===d){var E;if(E=i.getElementById(this.id)){var w=Math.abs(this.currentTime-p.time)<this.epsilon?g:m;E.style.visibility=w?"visible":"hidden"}}}}s.matrixAutoUpdate=!0,s.matrixWorldNeedsUpdate=!0}}}}(),m.prototype=Object.create(c.Animation.prototype),m.prototype.constructor=m,m.prototype.keyTypes=["points","vis"],m.prototype.defaultKey={points:[],vis:1},m.prototype.stop=function(){c.Animation.prototype.stop.call(this),this.viewer.removeOverlay("polyline",this.root),this.root=null},m.prototype.update=function(){function e(e){e.root&&(e.viewer.removeOverlay("polyline",e.root),e.root=null)}return function(t){if(!1!==this.isPlaying&&(this.currentTime+=t*this.timeScale,this.resetIfLooped(),!this.isPlayingOutOfRange()))if(this.isPaused&&this.currentTime<this.startKeyTime)e(this);else for(var r=0,n=this.hierarchy.length;r<n;r++)for(var i=this.hierarchy[r].animationCache[this.data.name],o=0;o<this.keyTypes.length;o++){var a=this.keyTypes[o],s=i.prevKey[a],u=i.nextKey[a];if(u.time<=this.currentTime||s.time>=this.currentTime){for(s=this.data.hierarchy[r].keys[0],u=this.getNextKeyWith(a,r,1);u.time<this.currentTime&&u.index>s.index;)s=u,u=this.getNextKeyWith(a,r,u.index+1);i.prevKey[a]=s,i.nextKey[a]=u}var c=s[a],h=u[a];if(u.time!==s.time&&void 0!==c&&void 0!==h){var d=(this.currentTime-s.time)/(u.time-s.time);if(d<0&&(d=0),d>1&&(d=1),"points"===a){var f=d<.5?c:h;this.viewer.removeOverlay("polyline",this.root),this.root=null;for(var p=[],m=0;m<f.length;m++){var g=f[m].slice();if(0===m)g[0]=c[m][0]+(h[m][0]-c[m][0])*d,g[1]=c[m][1]+(h[m][1]-c[m][1])*d,g[2]=c[m][2]+(h[m][2]-c[m][2])*d;else if(m===f.length-1){var v=c.length-1,y=h.length-1;g[0]=c[v][0]+(h[y][0]-c[v][0])*d,g[1]=c[v][1]+(h[y][1]-c[v][1])*d,g[2]=c[v][2]+(h[y][2]-c[v][2])*d}var b=new l.Vector3(g[0],g[1],g[2]);p.push(b)}this.root=this.createPolyline(p)}else if("vis"===a){var x=Math.abs(this.currentTime-u.time)<this.epsilon?h:c;this.root.visible=x,x||e(this)}}}}}(),m.prototype.createPolyline=function(e){for(var t=new l.Geometry,r=0;r<e.length;r++)t.vertices.push(e[r]);t.computeLineDistances();var n=new l.LineDashedMaterial({color:0,dashSize:1,gapSize:.5,linewidth:1}),i=new l.Line(t,n,l.LineStrip);return void 0===this.viewer.overlayScenes.polyline&&this.viewer.createOverlayScene("polyline"),this.viewer.addOverlay("polyline",i),i},r(35449).GlobalManagerMixin.call(g.prototype),g.prototype.destroy=function(){this.stop(),this.viewer=null,this.keys=null,this.animations=null,this.isPlaying=!1,this.isPaused=!1,this.animationHandler=null},g.prototype.add=function(e){var t=this;if(!(!e.hierarchy||e.hierarchy.length<1||!e.hierarchy[0].keys||e.hierarchy[0].keys.length<2)){var r=null,n=this;if("camera"===e.type?(r=new h(n.viewer.camera,e,n),n.animations.push(r)):"annotation"===e.type?(r=new p(null,e,n),n.animations.push(r)):"polyline"===e.type?(r=new m(null,e,n),n.animations.push(r)):"mesh"===e.type?n.viewer.model.getData().instanceTree.enumNodeFragments(e.id,(function(t){var i=n.viewer.getFragmentProxy(n.viewer.model,t);i&&(r=new s.MeshAnimation(i,e,n),n.animations.push(r))}),!0):"visibility"===e.type&&(r=new d(e,e.id,n),n.animations.push(r)),n.animations.forEach((function(e){return e.setGlobalManager(t.globalManager)})),r){for(var i=0,o=e.hierarchy.length;i<o;i++)for(var a=e.hierarchy[i].keys,l=0;l<a.length;l++)void 0===a[l].xk&&n.keys.push(a[l].time);!function(e){e.sort((function(e,t){return e-t})),function(e,t,r){for(t=e.length;r=--t;)for(;r--;)e[t]!==e[r]||e.splice(r,1)}(e)}(n.keys)}this.updateFlag|=this.UPDATE_SCENE}},g.prototype.update=function(e){e*=this._speedMod,this.animationHandler.update(e);var t=this.updateFlag;return this.isPlaying&&!this.isPaused&&(this.currentTime+=e,this.currentTime=Math.min(this.currentTime,this.duration),this.onPlayCallback&&this.onPlayCallback(this.duration>0?this.currentTime/this.duration*100:0),this.currentTime>=this.duration&&(this._loops?this.play(0,this.onPlayCallback):this.pause()),t|=this.UPDATE_SCENE),this.updateFlag=0,t},g.prototype.play=function(e,t){if(this.onPlayCallback=t,this.currentTime>=this.duration&&this.goto(0),this.isPlaying)this.pause();else{for(var r=0;r<this.animations.length;r++){this.animations[r].play(e)}this.isPlaying=!0,this.isPaused=!1}},g.prototype.setFollowCamera=function(e){this.followCam=e;for(var t=0;t<this.animations.length;t++){var r=this.animations[t];r.setFollowCamera&&r.setFollowCamera(e)}},g.prototype.isFollowingCamera=function(){return this.followCam},g.prototype.setSpeedModifier=function(e){this._speedMod=e},g.prototype.getSpeedModifier=function(){return this._speedMod},g.prototype.setLooping=function(e){this._loops=e},g.prototype.isLooping=function(){return this._loops},g.prototype.pause=function(){for(var e=0;e<this.animations.length;e++){var t=this.animations[e];t.isPaused===this.isPaused&&t.pause()}this.isPaused=!this.isPaused,this.areCameraAnimationsPaused=this.isPaused},g.prototype.pauseCameraAnimations=function(){for(var e=0;e<this.animations.length;e++){var t=this.animations[e];t instanceof h&&t.pause()}this.areCameraAnimationsPaused=!this.areCameraAnimationsPaused},g.prototype.stop=function(){for(var e=0;e<this.animations.length;e++){this.animations[e].stop()}this.isPlaying=!1,this.isPaused=!1},g.prototype.goto=function(e){if(void 0!==e){for(var t=0;t<this.animations.length;t++){this.animations[t].goto(e)}this.isPlaying=!1,this.isPaused=!0,this.currentTime=e,this.updateFlag|=this.UPDATE_SCENE}},g.prototype.next=function(){var e=function(e,t){for(var r=-1,n=0;n<t.length;n++)if(t[n]>e){r=t[n];break}return r<0?t[t.length-1]:r}(this.currentTime,this.keys);this.goto(e)},g.prototype.prev=function(){var e=function(e,t){for(var r=-1,n=t.length-1;n>-1;n--)if(t[n]<e){r=t[n];break}return r<0?t[0]:r}(this.currentTime,this.keys);this.goto(e)}},94981:(e,t,r)=>{"use strict";r.r(t),r.d(t,{MeshAnimation:()=>d});var n,i,o,a,s,l,u=r(23909),c=r(80738),h=r(80382);function d(e,t,r){h.Animation.call(this,e,t,r),this.localMatrix=new u.Matrix4,this.root.getAnimTransform(),this.relativeTransform=!t.custom||!t.custom.transform||"abs"!==t.custom.transform}d.prototype=Object.create(h.Animation.prototype),d.prototype.constructor=d,d.prototype.keyTypes=["pos","rot","scl"],d.prototype.defaultKey={pos:0,rot:0,scl:0},d.prototype.update=(n=[],i=new u.Vector3,o=new u.Vector3,a=new u.Quaternion,s=new u.Matrix4,l=new u.Matrix4,function(e){if(!1!==this.isPlaying&&(this.currentTime+=e*this.timeScale,this.resetIfLooped(),!this.isPlayingOutOfRange()))for(var t=0,r=this.hierarchy.length;t<r;t++){for(var d=this.hierarchy[t],f=d.animationCache[this.data.name],p=0;p<this.keyTypes.length;p++){var m=this.keyTypes[p],g=f.prevKey[m],v=f.nextKey[m];if(v.time<=this.currentTime||g.time>=this.currentTime){for(g=this.data.hierarchy[t].keys[0],v=this.getNextKeyWith(m,t,1);v.time<this.currentTime&&v.index>g.index;)g=v,v=this.getNextKeyWith(m,t,v.index+1);f.prevKey[m]=g,f.nextKey[m]=v}var y=g[m],b=v[m];if(v.time!==g.time&&void 0!==y&&void 0!==b){var x=(this.currentTime-g.time)/(v.time-g.time);if(x<0&&(x=0),x>1&&(x=1),"pos"===m)if(this.interpolationType===c.u.LINEAR)o.x=y[0]+(b[0]-y[0])*x,o.y=y[1]+(b[1]-y[1])*x,o.z=y[2]+(b[2]-y[2])*x,d.position.copy(o);else{n[0]=this.getPrevKeyWith("pos",t,g.index-1).pos,n[1]=y,n[2]=b,n[3]=this.getNextKeyWith("pos",t,v.index+1).pos,x=.33*x+.33;var _=(0,h.interpolateCatmullRom)(n,x);if(o.x=_[0],o.y=_[1],o.z=_[2],d.position.copy(o),this.interpolationType===c.u.CATMULLROM_FORWARD){var E=(0,h.interpolateCatmullRom)(n,1.01*x);i.set(E[0],E[1],E[2]),i.sub(vector),i.y=0,i.normalize();var w=Math.atan2(i.x,i.z);d.rotation.set(0,w,0)}}else"rot"===m?(u.Quaternion.slerp(y,b,a,x),d.quaternion.copy(a)):"scl"===m&&(o.x=y[0]+(b[0]-y[0])*x,o.y=y[1]+(b[1]-y[1])*x,o.z=y[2]+(b[2]-y[2])*x,d.scale.copy(o))}}if(!this.relativeTransform){var A=s.compose(d.position,d.quaternion,d.scale),S=l;d.getOriginalWorldMatrix(S),S.invert(),s.multiplyMatrices(A,S).decompose(d.position,d.quaternion,d.scale)}d.updateAnimTransform()}})},70520:(e,t,r)=>{"use strict";r.r(t),r.d(t,{AggregatedView:()=>I});var n=r(17167),i=r(84998),o=r(7724),a=r(71224);function s(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==r)return;var n,i,o=[],a=!0,s=!1;try{for(r=r.call(e);!(a=(n=r.next()).done)&&(o.push(n.value),!t||o.length!==t);a=!0);}catch(e){s=!0,i=e}finally{try{a||null==r.return||r.return()}finally{if(s)throw i}}return o}(e,t)||l(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e,t){if(e){if("string"==typeof e)return u(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?u(e,t):void 0}}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function c(e,t,r,n,i,o,a){try{var s=e[o](a),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,i)}function h(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function a(e){c(o,n,i,a,s,"next",e)}function s(e){c(o,n,i,a,s,"throw",e)}a(void 0)}))}}function d(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function f(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function m(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function g(e,t,r){return t&&m(e.prototype,t),r&&m(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var v=Autodesk.Viewing,y=v.Private,b=function(){var e;return(e=y.analytics).track.apply(e,arguments)},x={BimWalk:"Autodesk.BimWalk",Bookmarks:"Autodesk.AEC.CanvasBookmarkExtension",Levels:"Autodesk.AEC.LevelsExtension",CrossFade:"Autodesk.CrossFadeEffects",Hyperlinks:"Autodesk.AEC.HyperlinkExtension",Minimap:"Autodesk.AEC.Minimap3DExtension",DropMe:"Autodesk.AEC.DropMeExtension",ZoomWindow:"Autodesk.Viewing.ZoomWindow",FusionOrbit:"Autodesk.Viewing.FusionOrbit",Disciplines:"Autodesk.AEC.DisciplinesExtension",DiffTool:"Autodesk.DiffTool",ModelStructure:"Autodesk.ModelStructure",ModelAlignment:"Autodesk.ModelAlignment",SheetAlignment:"Autodesk.SheetAlignment",ModelSheetTransition:"Autodesk.ModelSheetTransition"},_={ALIGNMENT_SERVICE_FAILED:"alignmentServiceFailure",ENVIRONMENT_CHANGED:"environmentChanged"},E={LocalStorage:function(){return new Autodesk.ModelAlignmentService.AlignmentServiceLS}},w=[x.ModelAlignment,x.SheetAlignment],A=function(e){return e instanceof v.BubbleNode?e.getModelKey():e instanceof v.Model?null===(t=e.getDocumentNode())||void 0===t?void 0:t.getModelKey():"string"==typeof e?e:void console.error("makeKey: Input must be key, model, or BubbleNode");var t},S=function(e){return{model:null,node:e,visible:!1,url:null,loadingPromise:null,error:!1}},M=function(e){return isFinite(e.x)&&isFinite(e.y)&&isFinite(e.z)},T=function(e){var t=e.getUpVector();return t&&(new THREE.Vector3).fromArray(t)},C=function(e){return M(e.position)&&M(e.target)&&M(e.up)&&isFinite(e.orthoScale)},P=function(e,t,r){for(var n=0,i=new THREE.Vector3,o=0;o<e.length;o++){var a=e[o].getBoundingBox();if(r.intersectsBox(a)!==Autodesk.Viewing.Private.FrustumIntersector.OUTSIDE){var s=a.getSize(i).length;a.distanceToPoint(t)>50*s||n++}}return n},D={enabled:!1,diffBubbles:void 0,primaryBubbles:void 0,diffBubbleLabel:void 0,primaryBubbleLabel:void 0,progressCallback:void 0,supportBubbles:void 0,refNames:void 0,customCompute:void 0},L=function(e,t){var r=e.getVisibleModels();r=r.filter((function(e){return t=e.getBoundingBox(),M(t.min)&&M(t.max);var t}));for(var n=e.impl.camera.clone(),i=new Autodesk.Viewing.Private.FrustumIntersector,o=void 0,a=void 0,s=void 0,l=void 0,u=new THREE.Vector3,c=0;c<r.length;c++){var h=r[c];o||(o=T(h));var d=h.getDefaultCamera();if(d&&C(d)){var f=h.getBoundingBox();n.position.copy(d.position),n.target.copy(d.target),n.up.copy(d.up),n.isPerspective=d.isPerspective,n.near=f.distanceToPoint(n.position),n.far=n.near+f.getSize(u).length,n.updateMatrixWorld(),n.updateProjectionMatrix(),i.reset(n);var p=P(r,d.position,i);(!a||p>=s)&&(a=d,s=p,l=h)}}a&&(a.pivot=a.target,a.worldup=o,a.fov=45,t&&t(a,l),e.autocam.setHomeViewFrom(a))},R=function(){function e(t){p(this,e),this.color=t,this.enabled=!0,this.active=!1}return g(e,[{key:"setEnabled",value:function(e,t){t!==this.enabled&&(this.enabled=t,this.active&&!t?(e.clearThemingColors(),this.active=!1):this.update(e))}},{key:"update",value:function(e){if(!this.active&&this.enabled){for(var t=e.myData.fragments.fragId2dbId,r=0;r<t.length;r++){var n=t[r];e.setThemingColor(n,this.color)}this.active=!0}}}]),e}(),I=function(){function e(){p(this,e),this.globalOffset=void 0,this.refPoint=void 0,this.modelItems={},this.resetOnNextModelAdd=!0,this.resetTriggeringBubble=null,this.memTracker=null,this.cameraInitialized=!1,this.is3D=void 0,this.pendingCamera=null,this.extensionLoaded={},this.loadersInProgress={},this.diff=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?d(Object(r),!0).forEach((function(t){f(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},D),this.modelIsGhosted={},this.diffCache=[],this.onDiffDone=void 0,this.waitForFirstModel=!1,this.loadPendingPromises={},this.onLoad=[],this.onUnload=[],this.modelThemingStates={},window.LMV_MAIN_VIEW=this,this.pendingAlignmentFetches=[],Autodesk.Viewing.EventDispatcher.prototype.apply(this)}var t,r,u,c,m,E,M,C;return g(e,[{key:"init",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.useConsolidation=void 0===t.useConsolidation||t.useConsolidation,this.initViewerInstance(e,t),this.memTracker=new v.ModelMemoryTracker(this.viewer,t.memoryLimit),this.viewer.impl.showTransparencyWhenMoving(),t.useDynamicGlobalOffset&&(this.dynamicGlobalOffset=new o.DynamicGlobalOffset(this.viewer)),this.options=t,this._registerLmvEventListeners(),this._loadExtensions()}},{key:"initViewerInstance",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.viewerClass||(t.headlessViewer?v.Viewer3D:v.GuiViewer3D),n=t.viewerConfig||{};n.disabledExtensions=n.disabledExtensions||{},n.disabledExtensions.hyperlink=!0,t.multiViewerFactory?this.viewer=t.multiViewerFactory.createViewer(e,t.viewerConfig,r):this.viewer=new r(e,t.viewerConfig),this.viewer.start(void 0,void 0,void 0,void 0,t.viewerStartOptions),t.propagateInputEventTypes&&(this.viewer.toolController.propagateInputEventTypes=t.propagateInputEventTypes,this.viewer.canvas.style.outline="none")}},{key:"destroy",value:function(){var e;this.dynamicGlobalOffset=null,this.memTracker=null,this.modelItems=null,null===(e=this.viewer)||void 0===e||e.finish(),this.viewer=null,window.LMV_MAIN_VIEW=null}},{key:"_onError",value:function(){var e;(e=console).error.apply(e,arguments)}},{key:"reset",value:function(){this.hideAll(),this.pendingCamera=null,this.cameraInitialized=!1,this.resetOnNextModelAdd=!0,this._stopActiveTools(),this._unloadDiffTool(!0),this.refPoint=void 0,this.loadersInProgress={}}},{key:"getModel",value:function(e){var t=this._getItem(e);return t&&t.model}},{key:"getModelAndWait",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return new Promise((function(n){var i=function r(){var i=t.getModel(e);if(i)return t.viewer.removeEventListener(Autodesk.Viewing.MODEL_ADDED_EVENT,r),t.onLoad.splice(t.onLoad.indexOf(r),1),n(i)};if(!(r&&!t.isVisible(e))){var o=t.getModel(e);if(o)return n(o)}t.viewer.addEventListener(Autodesk.Viewing.MODEL_ADDED_EVENT,i),t.onLoad.push(i)}))}},{key:"isEmpty",value:function(){return!this.getVisibleNodes().length}},{key:"_initForEnvironmentChange",value:function(e,t){if(this.areAllNodes2D()&&e.is3D()){var r;if(this.is3D=t,!t){e=(r=Object.values(this.modelItems).filter((function(e){return e.visible&&e.node&&e.node.is2D()}))[0]).node}this._updateExtensions(e),this._updateRefPoint(e),t?(this.resetOnNextModelAdd=!0,this.resetTriggeringBubble=e):r.model&&(this._resetOnModeSwitch(r.model),this.viewer.impl.setUp2DMode(r.model,!1),this.viewer.getExtension("Autodesk.ViewCubeUi",(function(e){return e.displayViewCube(!1,!1)}))),this.fireEvent({type:_.ENVIRONMENT_CHANGED,is3D:this.is3D})}}},{key:"_needsReset",value:function(e){return!!this.resetOnNextModelAdd&&(!this.resetTriggeringBubble||this.resetTriggeringBubble===e)}},{key:"show",value:function(e,t){this.isEmpty()?this._initForFirstViewable(e):this._initForEnvironmentChange(e,!0);var r,n,i=e.getModelKey(),o=this.getModel(i);o?(this.modelItems[i].visible=!0,this._showModel(o),r=Promise.resolve(o)):((r=null===(n=this.modelItems[i])||void 0===n?void 0:n.loadingPromise)||(r=this.load(e,t)),this.modelItems[i].visible=!0);return this._updateModelTimestamps(),this._consolidateVisibleModels(),r}},{key:"hide",value:function(e){var t=this._getItem(e);t&&(!this.options.unloadUnfinishedModels||t.model&&t.model.isLoadDone()?t.model&&this.viewer.hideModel(t.model.id):this.unload(t.node),t.visible=!1,L(this.viewer,this.options.cameraValidator),this._updateUpVector(),this._cleanupModels(),this._initForEnvironmentChange(t.node,!1))}},{key:"isVisible",value:function(e){var t=this._getItem(e);return t&&t.visible}},{key:"hideAll",value:function(){for(var e in this.modelItems)this.hide(e)}},{key:"getVisibleNodes",value:function(){var e=[];for(var t in this.modelItems){var r=this.modelItems[t];r.visible&&e.push(r.node)}return e}},{key:"areAllNodes2D",value:function(){var e=this.getVisibleNodes();return!!e.length&&e.every((function(e){return!(e instanceof Autodesk.Viewing.BubbleNode)||e.is2D()}))}},{key:"isOtgManifestMissing",value:function(e){if(e.is2D())return!1;var t=e.getOtgGraphicsNode();if(t&&!t.error)return!1;if(t?this._onError("Otg translation failed for viewable '".concat(e.name(),"'. Error:"),t.error):this._onError("Otg node missing for viewable '".concat(e.name(),"'.")),this.onViewerNotification){var r=v.i18n.t("Model translation failed for view '%(viewableName)'",{viewableName:e.name()});this.onViewerNotification("error",r)}return!0}},{key:"load",value:function(e){var t,r,n=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=A(e),a=this.modelItems[o];if(a||(a=S(e),this.modelItems[o]=a),a.model)return Promise.resolve(a.model);if(this.options.disableSvf&&this.isOtgManifestMissing(e))return a.error=!0,Promise.reject("OTG manifest missing");if(a.loadingPromise||a.error)return Promise.reject("Model load was already triggered");if(e.is3D()){if(this.waitForFirstModel)return new Promise((function(e,t){n.loadPendingPromises[o]={resolve:e,reject:t}}));this.options.ignoreGlobalOffset||this.globalOffset||(this.waitForFirstModel=!0)}var s=e.getRootNode(),l=s.getDocument(),u={globalOffset:this.globalOffset,applyRefPoint:!0,applyScaling:this.options.viewerUnits,isAEC:!0,bvhOptions:y.Consolidation.getDefaultBVHOptions(),useConsolidation:!1,loadAsHidden:!0,bubbleNode:e,disablePrecomputedNodeBoxes:!0,preserveView:!0,onFragmentListLoadProgress:function(){return n._updateDiffLoadProgress()},disable3DModelLayers:!0,keepCurrentModels:!0,headlessViewer:this.options.headlessViewer,leafletOptions:{fitPaperSize:!0}},c=this._onModelLoaded.bind(this),h=function(t){return n._onModelLoadFailed(e,t)},d=null===(t=(r=this.options).getCustomLoadOptions)||void 0===t?void 0:t.call(r,e);return d&&Object.assign(u,d),i&&Object.assign(u,i),a.loadingPromise=new Promise((function(t,r){n._applyAlignmentService(e,u).then((function(){return n.viewer.loadDocumentNode(l,e,u)})).then((function(e){c(e),t(e)})).catch((function(e){h(e),r(e)}))})),a.loadingPromise}},{key:"unloadUnderlayRaster",value:function(e){var t=this.viewer.getUnderlayRaster(e);t&&this.viewer.unloadModel(t)}},{key:"unload",value:function(e){this.unloadUnderlayRaster(e),this.viewer.unloadDocumentNode(e);var t=this._getItem(e);t&&(t.loading&&this._onModelLoadEnded(t),t.model&&delete this.loadersInProgress[t.model.id]);var r=A(e);delete this.modelItems[r];var n=this.modelThemingStates[r];n&&(n.active=!1),this.onUnload.forEach((function(t){return t(e)}))}},{key:"unloadAll",value:function(e){for(var t=Object.keys(this.modelItems).slice(),r=0;r<t.length;r++){var n=t[r],i=this.modelItems[n];e&&!e(i)||this.unload(i.node)}}},{key:"setCameraGlobal",value:function(e){this.pendingCamera={position:e.position&&(new THREE.Vector3).copy(e.position),target:e.target&&(new THREE.Vector3).copy(e.target),up:e.up&&(new THREE.Vector3).copy(e.up),fov:e.fov,isPerspective:e.isPerspective,ignoreGlobalOffset:e.ignoreGlobalOffset},this._applyPendingCameraWhenReady()}},{key:"setCamera",value:function(e){this.viewer.impl.setViewFromCamera(e,!0),this.cameraInitialized=!0}},{key:"startBimWalk",value:function(){this.bimWalkStartPending=!0,this._startBimWalkWhenReady()}},{key:"stopBimWalk",value:function(){var e=this.viewer.getExtension(x.BimWalk);e&&e.isActive()&&e.deactivate(),this.bimWalkStartPending=!1}},{key:"isBimWalkActive",value:function(){var e=this.viewer.getExtension("Autodesk.BimWalk");return e&&e.activeStatus||this.bimWalkStartPending}},{key:"switchView",value:function(e,t){return this.reset(),this.setNodes(e,t)}},{key:"setNodes",value:function(e,t){var r=this;e=(e=e||[])instanceof v.BubbleNode?[e]:e,this.fetchAlignmentsForNodes(e);var n=e.filter((function(e){return!r.isVisible(e)})),i={};e.forEach((function(e){i[e.getModelKey()]=!0}));this.getVisibleNodes().filter((function(e){return void 0===i[e.getModelKey()]})).forEach((function(e){r.hide(e)}));var o=n.map((function(e){return r.show(e)}));return this._setDiff(t),Promise.all(o)}},{key:"getFloorSelector",value:function(){return this.levelsExtension&&this.levelsExtension.floorSelector}},{key:"setBookmarks",value:function(e){this.bookmarks=e,this._updateBookmarks()}},{key:"isLoadDone",value:function(){for(var e in this.modelItems){var t=this.modelItems[e],r=t&&t.model,n=!r&&!t.error,i=r&&!r.isLoadDone(),o=r&&r.getPropertyDb()&&!r.getPropertyDb().isLoadDone(),a=y.TextureLoader.requestsInProgress()>0;if(n||i||o||a)return!1}return!0}},{key:"waitForLoadDone",value:function(){var e=this;return new Promise((function(t){e.isLoadDone()&&t();var r=function r(){e.isLoadDone()&&(e.viewer.removeEventListener(v.GEOMETRY_LOADED_EVENT,r),e.viewer.removeEventListener(v.OBJECT_TREE_CREATED_EVENT,r),e.viewer.removeEventListener(v.TEXTURES_LOADED_EVENT,r),e.onUnload.splice(e.onUnload.indexOf(r),1),t())};e.viewer.addEventListener(v.GEOMETRY_LOADED_EVENT,r),e.viewer.addEventListener(v.OBJECT_TREE_CREATED_EVENT,r),e.viewer.addEventListener(v.TEXTURES_LOADED_EVENT,r),e.onUnload.push(r)}))}},{key:"setAlignmentService",value:function(e){var t=this;this.alignmentService=e,w.forEach((function(e){return t._connectModelAlignment(e)}))}},{key:"fetchAlignments",value:(C=h(regeneratorRuntime.mark((function e(t){var r,n,i=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isUsingAlignmentService()){e.next=2;break}return e.abrupt("return");case 2:return r=function(){var e=h(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.getAlignmentService();case 2:return r=e.sent,e.next=5,r.fetchItems(t);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),n=r(),this.pendingAlignmentFetches.push(n),e.next=7,n;case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e,this)}))),function(e){return C.apply(this,arguments)})},{key:"fetchAlignmentsForNodes",value:function(e){var t=null==e?void 0:e.filter((function(e){return e.is3D()})),r=null==t?void 0:t.map((function(e){return e.getRootNode().urn()}));this.fetchAlignments(r)}},{key:"updateHomeCamera",value:function(){L(this.viewer,this.options.cameraValidator)}},{key:"_setDiff",value:function(t){if(t){Object.assign(this.diff,t,{enabled:!0});var r=t.supportBubbles;if(r)if(r.autoDetect&&e.findDiffSupportModels(t),r.diff&&r.primary)this.load(r.primary),this.load(r.diff);else{var n=t.diffBubbles&&t.diffBubbles[0];n&&n.is2D()&&console.warn("Could not find support models for 2D diff."),this.diff.supportBubbles=null}!t.empty&&t.progressCallback&&this._signalDiffLoadProgress(0,!0),this.diffStartTime=performance.now()}else Object.assign(this.diff,D);this.diffNeedsUpdate=!0,this._updateDiff()}},{key:"_updateUpVector",value:function(){var e;if(this.areAllNodes2D())e=new THREE.Vector3(0,1,0);else{var t=Object.values(this.modelItems).filter((function(e){return e.visible&&e.node&&e.node.is3D()}))[0];e=t&&t.model?T(t.model):new THREE.Vector3(0,0,1)}this.viewer.navigation.setWorldUpVector(e,!1,!0)}},{key:"_showModel",value:function(e){if(!e.is3d()||e.hasGeometry()){this.viewer.showModel(e.id,!0),L(this.viewer,this.options.cameraValidator),this._updateUpVector()}else{var t=e.getDocumentNode().getRootNode().children[0].name();console.warn("Ignored model with empty geometry: ",t)}}},{key:"_resetOnModeSwitch",value:function(e){var t=this;this.viewer.getExtension(x.ZoomWindow)&&this.viewer.unloadExtension(x.ZoomWindow),this.options.headlessViewer||this.viewer.createUI(e,!0);var r=this.viewer.setNavigationLock(!1);this.viewer.activateDefaultNavigationTools(!this.is3D),this.viewer.setNavigationLock(r),this.viewer.navigation.setIs2D(!this.is3D),this._loadExtension(x.ZoomWindow).catch((function(e){return t._onError(e)})),this._startBimWalkWhenReady()}},{key:"_onModelAdded",value:function(e){var t=e.model;if(this.cameraInitialized||this._initCamera(t),!t.getData().underlayRaster){t.is3d()&&this.options.useDynamicGlobalOffset&&(t.setGlobalOffset(this.viewer.impl.camera.globalOffset),this.viewer.impl.onModelTransformChanged(t));var r=e.model.getDocumentNode();if(this._needsReset(r)&&(this.resetTriggeringBubble=null,this.resetOnNextModelAdd=!1,this._resetOnModeSwitch(t)),function(e){var t=e.getData(),r=t.loadOptions.bubbleNode;if(e.is3d()&&t.metadata.stats&&!t.metadata.stats.num_fragments){var n=r.name(),i=r.getRootNode().children[0].name();console.warn('Empty View "'.concat(n,'" in model "').concat(i,'".'))}}(t),r){var n=r.getModelKey();delete this.modelIsGhosted[n],this._updateGhosting()}}}},{key:"_onGeometryLoaded",value:function(e){this._consolidateVisibleModels(),this._updateDiff(),this.loadersInProgress[e.model.id]=100}},{key:"_onExtensionLoaded",value:function(e){var t=e.extensionId;this._startBimWalkWhenReady(),t===x.Levels&&(this.levelsExtension=this.viewer.getExtension(x.Levels)),t===x.Bookmarks&&this._updateBookmarks(),w.includes(t)&&this.alignmentService&&this._connectModelAlignment(t)}},{key:"_registerLmvEventListeners",value:function(){this.viewer.addEventListener(v.GEOMETRY_LOADED_EVENT,this._onGeometryLoaded.bind(this)),this.viewer.addEventListener(v.MODEL_ADDED_EVENT,this._onModelAdded.bind(this)),this.viewer.addEventListener(v.EXTENSION_LOADED_EVENT,this._onExtensionLoaded.bind(this)),this.viewer.addEventListener(v.PROGRESS_UPDATE_EVENT,this._onProgressUpdate.bind(this)),this.viewer.addEventListener(v.MODEL_ROOT_LOADED_EVENT,this._updateDiff.bind(this))}},{key:"_consolidateVisibleModels",value:function(){if(this._cleanupModels(),!(0,i.isMobileDevice)()){var e=(0,n.getParameterByName)("useConsolidation");if("false"!==e&&(!1!==this.options.useConsolidation||"true"===e))for(var t=this.viewer.getVisibleModels(),r=0;r<t.length;r++){var o=t[r];if(this.memTracker.memoryExceeded())return;if(!(o&&o.isLoadDone()))return;if(o.is2d())return;o.isConsolidated()||(this.viewer.impl.consolidateModel(o),this._cleanupModels())}}}},{key:"_cleanupModels",value:function(){var e=this;this._updateModelTimestamps();this.memTracker.cleanup((function(t){var r=t.getDocumentNode(),n=e._getItem(r);n&&n.visible||e.unload(r)}))}},{key:"_updateModelTimestamps",value:function(){var e=this.viewer.getVisibleModels().slice(),t=this._getDiffSupportModels();this.diff.enabled&&t&&(t.diff&&e.push(t.diff),t.primary&&e.push(t.primary)),this.memTracker.updateModelTimestamps(e)}},{key:"_stopActiveTools",value:function(){var e=this.viewer.getExtension("Autodesk.Section");e&&e.isActive()&&e.enableSectionTool(!1),this.stopBimWalk();var t=!this.options.headlessViewer&&this.viewer.getPropertyPanel(!1);t&&t.isVisible()&&t.setVisible(!1)}},{key:"_onModelLoaded",value:function(e){var t=this._getItem(e);t&&(e.is3d()&&(this.options.useDynamicGlobalOffset?e.setGlobalOffset(this.viewer.impl.camera.globalOffset):this.waitForFirstModel&&!this.options.ignoreGlobalOffset&&(this.globalOffset=(new THREE.Vector3).copy(e.myData.globalOffset),this._onGlobalOffsetChanged())),t.model=e,t.visible&&this._showModel(t.model),this._updateModelTimestamps(),this._updateDiffLoadProgress(),this._updateModelTheming(e),this._onModelLoadEnded(t))}},{key:"_onModelLoadFailed",value:function(e,t){this._onError("Failed to load model: ".concat(e.name(),". Error code: ").concat(t));var r=this._getItem(e);r&&(r.error=!0,this._onModelLoadEnded(r))}},{key:"_onModelLoadEnded",value:function(e){var t=this;e.loadingPromise=null;var r=e.node;r.is3D()&&this.waitForFirstModel&&(this.waitForFirstModel=!1,Object.keys(this.loadPendingPromises).forEach((function(e){var r,n=null===(r=t.modelItems[e])||void 0===r?void 0:r.node;if(n){var i=t.loadPendingPromises[e],o=i.resolve,a=i.reject;t.load(n).then((function(e){o(e)})).catch((function(e){a(e)}))}})),this.loadPendingPromises={}),this.onLoad.forEach((function(e){return e(r)}))}},{key:"_initCamera",value:function(e,t){this.viewer.impl.setViewFromFile(e,!t),this.options.cameraValidator&&this.options.cameraValidator(this.viewer.impl.camera,e),this.viewer.impl.controls.recordHomeView(),this.cameraInitialized=!0,this.pendingCamera&&this._applyPendingCameraWhenReady()}},{key:"_getItem",value:function(e){var t=A(e);return this.modelItems[t]}},{key:"_updateRefPoint",value:function(e){if(!this.options.useDynamicGlobalOffset&&((this.isEmpty()||this.areAllNodes2D())&&e.is3D()&&!this.options.ignoreGlobalOffset)){var t=e.getAecModelData();if(t){var r=t&&t.refPointTransformation,n=r?{x:r[9],y:r[10],z:0}:{x:0,y:0,z:0};if(this.isUsingAlignmentService()){var i,o=e.getRootNode().urn(),a=null===(i=this.alignmentService)||void 0===i?void 0:i.getTransform(o);if(void 0===a)return;a&&(n.x=a.elements[12],n.y=a.elements[13])}if(this.refPoint=n,this.options.viewerUnits){var s=Autodesk.Viewing.Private.convertUnits("ft",this.options.viewerUnits,1,1);this.refPoint.x*=s,this.refPoint.y*=s,this.refPoint.z*=s}var l=this.globalOffset&&THREE.Vector3.prototype.distanceToSquared.call(this.refPoint,this.globalOffset);(!this.globalOffset||l>4e6)&&(this.globalOffset=(new THREE.Vector3).copy(this.refPoint),this.unloadAll((function(e){return e.model&&e.model.is3d()})),this._onGlobalOffsetChanged())}}}},{key:"_onGlobalOffsetChanged",value:function(){var e=this.viewer.getExtension(x.Bookmarks);e&&e.resetGlobalOffset(this.globalOffset)}},{key:"_getDefaultExtensions",value:function(){var e=this;return[{name:x.CrossFade,getLoadingCondition:function(){return!v.isMobileDevice()}},{name:x.Levels,getOptions:function(){return e.viewer.config}},{name:x.ModelStructure,getOptions:function(){return e.viewer.config}},{name:x.Hyperlinks,getOptions:function(){return{loadViewableCb:function(t,r){e.onHyperlink?e.onHyperlink(t,r):e.switchView([t])}}}},{name:x.Minimap,getLoadingCondition:function(){return!e.options.disableMinimap},getOptions:function(){return{trackUsage:e._trackMinimapUsage?e._trackMinimapUsage.bind(e):void 0}}},{name:x.Bookmarks,getLoadingCondition:function(){return e.is3D},getOptions:function(){return{globalOffset:e.globalOffset,onBookmark:function(t,r){e.onBookmark?e.onBookmark(t,r):e.switchView([t]),r.isPerspective&&e.startBimWalk()},clusterfck:e.options.clusterfck,clusteringThreshold:110}}},{name:x.DropMe,getLoadingCondition:function(){return!1===e.is3D},getOptions:function(){return{enableGuidance:!0,onDrop:e._handleDropMe.bind(e),getTransformForNode:e._getTransformForNode.bind(e),getMain3DView:e._findMain3DView.bind(e),onHandleViewIn3D:e._handleViewIn3D.bind(e)}}}]}},{key:"_loadExtensions",value:(M=h(regeneratorRuntime.mark((function e(){var t,r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.extensions=this.options.extensions||this._getDefaultExtensions(),t=[],this.extensions.forEach((function(e){e.getLoadingCondition&&!e.getLoadingCondition(r)||(t.push(r._loadExtension(e.name,e.getOptions&&e.getOptions(r),e.onLoadedCB)),r.extensionLoaded[e.name]=!0)})),e.abrupt("return",Promise.all(t));case 4:case"end":return e.stop()}}),e,this)}))),function(){return M.apply(this,arguments)})},{key:"_loadExtension",value:(E=h(regeneratorRuntime.mark((function e(t,r,n){var i,o,a,s,l=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=this.options.extensionOptions,o=i&&i[t],a=Object.assign({},r,o),s=this.viewer.loadExtension(t,a),n&&s.then((function(e){n(l,e)})).catch((function(e){n(l,null,e)})),e.abrupt("return",s);case 6:case"end":return e.stop()}}),e,this)}))),function(e,t,r){return E.apply(this,arguments)})},{key:"_updateExtensions",value:function(e){var t=this;this.extensions.forEach((function(r){var n,i,o,a,s,l;r.getLoadingCondition&&(n=r.name,i=r.getOptions&&r.getOptions(t),o=r.getLoadingCondition(t,e),a=r.onLoadedCB,s=r.onBeforeUnloadCB,!(l=t.extensionLoaded[n])&&o?t._loadExtension(n,i,a).catch((function(e){return t._onError(e)})):l&&!o&&(s&&s(t),t.viewer.unloadExtension(n)),t.extensionLoaded[n]=o)}))}},{key:"_initForFirstViewable",value:function(e){this.is3D!==e.is3D()&&(this.resetOnNextModelAdd||(this.reset(),this.resetTriggeringBubble=e),this.is3D=e.is3D()),this._updateExtensions(e),this._updateRefPoint(e)}},{key:"_updateBookmarks",value:function(){var e=this.viewer.getExtension(x.Bookmarks);e&&e.resetBookmarks(this.bookmarks)}},{key:"_applyPendingCameraWhenReady",value:function(){if(this.cameraInitialized){var e=this.pendingCamera;this.pendingCamera=null;var t=this.viewer.impl.camera;e.position&&t.position.copy(e.position),e.target&&t.target.copy(e.target),e.up&&t.up.copy(e.up),e.fov&&(t.fov=e.fov),void 0!==e.isPerspective&&(t.isPerspective=e.isPerspective);var r=this.globalOffset||this.viewer.model.getData().globalOffset;!this.is3D||this.options.ignoreGlobalOffset||e.ignoreGlobalOffset||(t.position.sub(r),t.target.sub(r)),this.viewer.impl.syncCamera()}}},{key:"_findMain3DView",value:function(e){var t=e.getMasterViews();if(t[0])return t[0];var r=null==e?void 0:e.getRootNode();if(r){var n=null==r?void 0:r.search(v.BubbleNode.MODEL_NODE),i=n.filter((function(e){return e.name().toLowerCase().startsWith("{3d")}))[0];return i||n[0]}}},{key:"_handleDropMe",value:function(e,t,r,n,i){if(this.onDrop)this.onDrop(e,t,r,n);else if(n){if(this.switchView(n),e&&t){var o={position:e,target:e.clone().add(t),isPerspective:!0,ignoreGlobalOffset:i};this.setCameraGlobal(o)}}else console.warn("DropMe handler: Document does not contain a 3D view to switch to")}},{key:"_handleViewIn3D",value:(m=h(regeneratorRuntime.mark((function e(t,r,n,i){var o,a,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n&&!this.options.ignoreGlobalOffset&&(o=this.globalOffset||this.viewer.model.getData().globalOffset,t=t.clone().add(o),r=r.clone().add(o)),a={position:t,target:r,isPerspective:!0},this.setCameraGlobal(a),e.next=5,this.viewer.getExtensionAsync(x.BimWalk);case 5:(s=e.sent).activate(),s.disableGravityUntilNextMove(),i&&i();case 9:case"end":return e.stop()}}),e,this)}))),function(e,t,r,n){return m.apply(this,arguments)})},{key:"_startBimWalkWhenReady",value:function(){if(this.bimWalkStartPending){var e=!this.resetOnNextModelAdd,t=this.viewer.getExtension(x.BimWalk),r=this.viewer.getExtension(x.FusionOrbit);e&&t&&r&&(t.activate(),this.bimWalkStartPending=!1)}}},{key:"_unloadDiffTool",value:function(e){this.viewer.getExtension(x.DiffTool)&&(e&&(this.diffCache.length=0),this.viewer.unloadExtension(x.DiffTool))}},{key:"_onProgressUpdate",value:function(e){e.model&&e.state===v.ProgressState.LOADING&&(this.loadersInProgress[e.model.id]=e.percent,this._updateDiffLoadProgress())}},{key:"_getDiffSupportModels",value:function(){if(this.diff.supportBubbles)return{diff:this.getModel(this.diff.supportBubbles.diff),primary:this.getModel(this.diff.supportBubbles.primary)}}},{key:"_diffSupportModelsReady",value:function(){var e=this._getDiffSupportModels(),t=e.diff&&e.diff.isLoadDone(),r=e.primary&&e.primary.isLoadDone();return t&&r}},{key:"_updateGhosting",value:function(){var e={};for(var t in this.diff.enabled&&this.diffBubbles&&(e=this.diffBubbles.forEach((function(t){return e[t.getModelKey()]}))),this.modelItems){var r=this.getModel(t);if(r){var n=this.diff.enabled&&!e[t];n!=!!this.modelIsGhosted[t]&&(r.setAllVisibility(!n),n?this.modelIsGhosted[t]=!0:delete this.modelIsGhosted[t])}}}},{key:"getModels",value:function(e){var t=this;return e.map((function(e){return t.getModel(e)}))}},{key:"setModelTheming",value:function(e){e=e||{};var t=this.modelThemingStates;for(var r in this.modelThemingStates={},e){var n=t[r],i=e[r],o=this.getModel(r);if(n)!n.color.equals(i)&&(n.color.copy(i),n.active=!1);else n=new R(i);this.modelThemingStates[r]=n,o&&this._updateModelTheming(o)}for(var a in t){var s=t[a],l=!e[a],u=this.getModel(a);l&&s.active&&u&&this.viewer.clearThemingColors(u)}}},{key:"_signalDiffLoadProgress",value:function(e,t){if(t||e!==this._lastDiffLoadPercent){var r=v.i18n.t("Loading Model for Change Visualization");this.diff.progressCallback(e,r),this._lastDiffLoadPercent=e}}},{key:"_updateDiffLoadProgress",value:function(){var e=this;if(this.diffNeedsUpdate&&this.diff.enabled&&!this.diff.empty&&this.diff.progressCallback){var t=this.getModels(this.diff.diffBubbles),r=this.getModels(this.diff.primaryBubbles),n=t.concat(r),i=this._getDiffSupportModels();i&&n.push(i.diff,i.primary);var o=n.filter(Boolean).length;if(o<n.length){var a=Math.floor(10*o/n.length);this._signalDiffLoadProgress(a)}else if(this.is3D){var s=n.reduce((function(e,t){return e+t.getData().fragsLoadedNoGeom}),0),l=n.reduce((function(e,t){return e+t.getData().metadata.stats.num_fragments}),0),u=10+Math.floor(90*s/l);this._signalDiffLoadProgress(u)}else{var c=n.reduce((function(t,r){return t+(0|e.loadersInProgress[r.id])}),0),h=100*n.length,d=10+Math.floor(90*c/h);this._signalDiffLoadProgress(d)}}}},{key:"_updateDiff",value:function(){if(this.diffNeedsUpdate){if(this._updateGhosting(),this._updateDiffLoadProgress(),!this.diff.enabled)return this._unloadDiffTool(),void this._updateAllModelTheming();var e=this.getModels(this.diff.diffBubbles),t=this.getModels(this.diff.primaryBubbles);if(this.diff.customCompute){var r,n=t,i=e,o=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=l(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}([this.diff.customCompute].flat());try{for(o.s();!(r=o.n()).done;){var a=s(r.value.init(n,i),2);n=a[0],i=a[1]}}catch(e){o.e(e)}finally{o.f()}}for(var u=0;u<e.length;u++){var c=e[u],h=t[u],d=c instanceof v.Model&&(c.isOTG()||c.isLoadDone()),f=h instanceof v.Model&&(h.isOTG()||h.isLoadDone());if(!d||!f)return;if(!c.getPropertyDb()||!h.getPropertyDb())return}var p=void 0;if(!!this.diff.supportBubbles){if(!this._diffSupportModelsReady())return;p=this._getDiffSupportModels()}var m=performance.now()-this.diffStartTime;console.log("Time for loading diff models: ",m),this._updateAllModelTheming(),this._setDiffModels(e,t,p)}}},{key:"_setDiffModels",value:function(e,t,r){var n=this;if(this.diffNeedsUpdate=!1,t.length){var i=this.viewer.getExtension(x.DiffTool);if(i)i.replaceModels(e,t,r);else{var o={diffModels:e,primaryModels:t,supportModels:r,diffadp:!1,availableDiffModes:["overlay","sidebyside"],diffMode:"overlay",customCompute:this.diff.customCompute,versionA:this.diff.primaryBubbleLabel,versionB:this.diff.diffBubbleLabel,refNames:this.diff.refNames,mimeType:"application/vnd.autodesk.revit",hotReload:!0,diffCache:this.diffCache,useSplitScreenExtension:!0,showDetailsSection:!0,progress:function(e,t){n.diff.progressCallback&&(t!==Autodesk.DiffTool.DIFFTOOL_PROGRESS_STATES.LoadingPropDb?(100===e&&n.onDiffDone&&n.onDiffDone(),n.diff.progressCallback(e,v.i18n.t("Computing change visualization"))):n.diff.progressCallback(e,v.i18n.t("Loading element properties")))},excludeFromDiff:function(e,t){return n.levelsExtension&&!n.levelsExtension.floorSelector.isVisible(e,t)},setNodesOff:function(e){var t=n.levelsExtension;t&&t.floorSelector._floorSelectorFilter.reApplyFilter(e)},hideModeSwitchButton:!0,externalUi:this.diff.externalUi,attachDetachViewerEventHandlers:this.diff.attachDetachViewerEventHandlers,onDiffModeChanged:this.diff.onDiffModeChanged,onInitialized:this.diff.onInitialized};this._loadExtension(x.DiffTool,o).catch((function(e){return n._onError(e)}))}}else this._unloadDiffTool()}},{key:"_updateModelTheming",value:function(e){var t=A(e),r=this.modelThemingStates[t];if(r){var n=!this.viewer.getExtension(x.DiffTool);r.setEnabled(e,n),r.update(e),this.viewer.impl.invalidate(!0)}}},{key:"_updateAllModelTheming",value:function(){for(var e in this.modelItems){var t=this.getModel(e);t&&this._updateModelTheming(t)}}},{key:"getAlignmentService",value:(c=h(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.alignmentService){e.next=2;break}return e.abrupt("return",this.alignmentService);case 2:if(!this._alignmentServicePromise){e.next=7;break}return e.next=5,this._alignmentServicePromise;case 5:e.next=11;break;case 7:return this._alignmentServicePromise=this._initAlignmentService(),e.next=10,this._alignmentServicePromise;case 10:this._alignmentServicePromise=null;case 11:return e.abrupt("return",this.alignmentService);case 12:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"isUsingAlignmentService",value:function(){return this.options.createModelAlignmentService||this.alignmentService}},{key:"_initAlignmentService",value:(u=h(regeneratorRuntime.mark((function e(){var t,r,n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.options.createModelAlignmentService){e.next=3;break}return e.abrupt("return");case 3:return r=function(){var e=h(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t();case 2:r=e.sent,n.setAlignmentService(r);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),e.next=6,this.viewer.loadExtension("Autodesk.ModelAlignmentService").then(r);case 6:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"_getTransformForNode",value:(r=h(regeneratorRuntime.mark((function e(t){var r,n,i,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getAlignmentService();case 2:if(r=e.sent){e.next=5;break}return e.abrupt("return");case 5:return e.next=7,Promise.all(this.pendingAlignmentFetches);case 7:return n=t.getRootNode().urn(),i=t.is2D()?t.name():void 0,e.next=11,r.loadTransform(n,i);case 11:return o=e.sent,e.abrupt("return",o);case 13:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"_applyAlignmentService",value:(t=h(regeneratorRuntime.mark((function e(t,r){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.is2D()){e.next=2;break}return e.abrupt("return");case 2:if(!this.alignmentServiceFailed){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,this._getTransformForNode(t);case 6:if(n=e.sent,this._checkAlignmentService()){e.next=9;break}return e.abrupt("return");case 9:b("viewer.modelalignment.alignment_loaded",{hasAlignmentTransform:Boolean(n)}),n&&(r.applyRefPoint=!1,r.placementTransform=n,r.applyPlacementInModelUnits=!0);case 11:case"end":return e.stop()}}),e,this)}))),function(e,r){return t.apply(this,arguments)})},{key:"_checkAlignmentService",value:function(){if(this.alignmentServiceFailed||!this.alignmentService)return!1;if(this.alignmentService.isWorking())return!0;var e=a.Z.t("Failed to connect to alignment service: Model alignment support is temporarily unavaible. Models with alignment transforms may not appear correctly and alignment editing is disabled.");this.fireEvent({type:_.ALIGNMENT_SERVICE_FAILED,message:e}),y.logger.error("AggregatedView: Disabled alignment due to alignment service connection error."),this.alignmentServiceFailed=!0}},{key:"_connectModelAlignment",value:function(e){var t=this.viewer.getExtension(e);t&&t.setAlignmentService(this.alignmentService)}}],[{key:"findDiffSupportModel",value:function(e){if(!e.is2D())return null;var t=e.data.phaseNames,r=Array.isArray(t)?t[0]:t;return r?e.getMasterView(r):(console.warn("A sheet node must have a phase name. Missing for sheet: ".concat(e.name)),null)}},{key:"findDiffSupportModels",value:function(t){t.supportBubbles.diff=e.findDiffSupportModel(t.diffBubbles[0]),t.supportBubbles.primary=e.findDiffSupportModel(t.primaryBubbles[0])}}]),e}();I.ExtNames=x,I.AlignmentServices=E,I.Events=_},20974:(e,t,r)=>{"use strict";r.r(t),r.d(t,{CameraLS:()=>c});var n=r(35449);function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function a(e,t,r){return t&&o(e.prototype,t),r&&o(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var s=function(e){return isFinite(e.x)&&isFinite(e.y)&&isFinite(e.z)},l=function(e){var t=e.isPerspective||isFinite(e.orthoScale);return s(e.position)&&s(e.target)&&s(e.up)&&t},u=function(){function e(){i(this,e),this.cacheObj={}}return a(e,[{key:"setItem",value:function(e,t){this.cacheObj[e]=t}},{key:"getItem",value:function(e){return this.cacheObj[e]}}]),e}(),c=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{useLocalStorage:!0};i(this,e),this.aggregatedView=t,this.options=r,this.key=void 0,this.options.useLocalStorage?this.cache=Autodesk.Viewing.Private.LocalStorage:this.cache=new u,this.unloadCb=this.saveCamera.bind(this),this.addWindowEventListener("beforeunload",this.unloadCb)}return a(e,[{key:"destroy",value:function(){this.unsetKey(),this.removeWindowEventListener("beforeunload",this.unloadCb)}},{key:"setKey",value:function(e){this.key=e}},{key:"unsetKey",value:function(){this.key=void 0}},{key:"saveCamera",value:function(){if(this.aggregatedView.cameraInitialized&&this.key){var e=this.aggregatedView.viewer.impl.camera;if(l(e)){var t=this.aggregatedView.isBimWalkActive(),r=this.aggregatedView.is3D?this.aggregatedView.globalOffset:void 0;this.saveStartCamera(this.key,this.aggregatedView.viewer.impl.camera,t,r)}}}},{key:"saveStartCamera",value:function(e,t,r,n,i){var o=JSON.stringify({offset:n,position:t.position,target:t.target,up:t.up,orthoScale:t.orthoScale,isPerspective:t.isPerspective,fov:t.fov,startBimWalk:r,ignoreGlobalOffset:i});this.cache.setItem(e,o)}},{key:"clearItem",value:function(e){this.cache.setItem(e)}},{key:"loadCamera",value:function(){if(!this.key)return!1;var e=void 0;try{var t=this.cache.getItem(this.key);e=JSON.parse(t)}catch(e){}if(!(e&&e.position&&e.target&&e.up))return!1;var r=function(e){return new THREE.Vector3(parseFloat(e.x),parseFloat(e.y),parseFloat(e.z))},n={position:r(e.position),target:r(e.target),up:r(e.up),isPerspective:Boolean(e.isPerspective),fov:parseFloat(e.fov),ignoreGlobalOffset:Boolean(e.ignoreGlobalOffset)};if(e.orthoScale&&(n.orthoScale=parseFloat(e.orthoScale)),!l(n))return!1;var i=e.offset?r(e.offset):void 0;if(i){if(!s(i))return;n.position.add(i),n.target.add(i)}this.aggregatedView.setCameraGlobal(n),e.startBimWalk&&this.aggregatedView.startBimWalk()}}]),e}();n.GlobalManagerMixin.call(c.prototype)},38202:(e,t,r)=>{"use strict";r.r(t),r.d(t,{Document:()=>f});var n=r(77368),i=r(79659),o=r(58964),a=r(57601),s=r(84998),l=r(98926),u=r(26261),c=r(17167),h=(0,s.getGlobal)(),d=h;function f(e,t,r){this.myPath=t,this.myData=e,e&&(this.docRoot=new n.BubbleNode(e),this.docRoot.setDocument(this)),this.myNumViews={},this.acmSessionId=r;var i=this;this.docRoot.traverse((function(e){if(e.isViewPreset()){var t=e.findParentGeom2Dor3D();if(t){var r=i.myNumViews[t.guid()]||0;i.myNumViews[t.guid()]=r+1}}})),0===this.docRoot.findAllViewables().length&&l.logger.error("Document contains no viewables.")}f.load=function(e,t,r,n){var s,l,d=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},p=f.getDocumentPath(e);function m(t){var r=e.split(":");r=r[1];for(var n=(0,c.fromUrlSafeBase64)(r),i=0;i<t.length;i++)if(n.indexOf(t[i])>-1)return!0;return!1}var g=["urn:adsk.wipemea","urn:adsk.wipbimemea"];if(e.startsWith("urn")&&m(g)){var v=o.endpoint.getApiFlavor(),y=(0,o.getEnv)(),b=v===o.endpoint.ENDPOINT_API_DERIVATIVE_SERVICE_V2&&!y.endsWith("EU"),x=y.endsWith("US")&&v===o.endpoint.ENDPOINT_API_D3S,_=v===o.endpoint.ENDPOINT_API_DERIVATIVE_STREAMING&&!v.endsWith("_EU");if(v+="_EU",b)o.endpoint.setEndpointAndApi(null,v);else if(x){y=y.replace("US","EU"),(0,o.setEnv)(y);var E=u.EnvironmentConfigurations[y];o.endpoint.setEndpointAndApi(E.ROOT,v)}else _&&o.endpoint.setEndpointAndApi(null,v)}function w(e){(o.endpoint.isSVF2Backend()||o.endpoint.isOtgBackend())&&(s=s?e.urn+","+s:e.urn);var n=new f(e,p,s);if(n.getRoot().search({type:"geometry"}).length>0)l=n.getGlobalMessages(),t&&t(n,l);else if(r){l=n.getGlobalMessages();var a=i.ErrorCodes.BAD_DATA_NO_VIEWABLE_CONTENT;r(a,"No viewable content",l)}}function A(e,t,n){if(401===e&&void 0===h.LMV_THIRD_PARTY_COOKIE)h.LMV_THIRD_PARTY_COOKIE=!1,(0,u.refreshRequestHeader)(u.token.accessToken),S();else if(r){var o="Error: "+e+" ("+t+")",a=(0,i.getErrorCode)(e);r(a,o,e,t,n)}}function S(){var e=!n||(o.endpoint.isSVF2Backend()||o.endpoint.isOtgBackend())&&!n["x-ads-acm-scopes"];s||e?a.ViewingService.getManifest(o.endpoint.initLoadContext(d),p,w,A):(n.oauth2AccessToken||(n.oauth2AccessToken=u.token.accessToken),a.ViewingService.getACMSession(o.endpoint.getApiEndpoint(),n,(function(e){s=e,d.queryParams=s?"acmsession="+s:"",o.endpoint.setAcmSession(s),a.ViewingService.getManifest(o.endpoint.initLoadContext(d),p,w,A)}),r))}S()},f.getDocumentPath=function(e){if(-1===e.indexOf("urn:")){if(-1!==e.indexOf("://"))return e;var t=e;return"undefined"!=typeof window?(0!==t.indexOf("/")&&(t="/"+t),d.location.protocol+"//"+d.location.host+t):t}return e},f.requestThumbnailWithSecurity=function(e,t){var r={responseType:"blob",skipAssetCallback:!0,size:e.width,guid:e.guid,acmsession:e.acmsession},n="urn:"+e.urn,i=void 0;if(!(0,s.getGlobal)().USE_OTG_DS_PROXY){var l=(0,o.getEnv)();i=u.EnvironmentConfigurations[l].UPSTREAM;var c=(0,u.getUpstreamApiData)(l,o.endpoint.getApiFlavor());r.apiData=c}a.ViewingService.getThumbnail(o.endpoint.initLoadContext({endpoint:i}),n,(function(e){t(null,e)}),(function(){t("error",null)}),r)},f.prototype.getAcmSessionId=function(e){return f.getAcmSessionId(e,this.acmSessionId)},f.getAcmSessionId=function(e,t){if(!e)return"";var r=e.indexOf("urn:adsk.fluent")>=0;return(0,s.getGlobal)().USE_OTG_DS_PROXY||r||!o.endpoint.isSVF2Backend()&&!o.endpoint.isOtgBackend()?t:t.split(",")[1]||""},f.prototype.getFullPath=function(e){if(!e)return e;var t=e;if((0,o.isOffline)())-1==t.indexOf((0,o.getOfflineResourcePrefix)())&&(t=decodeURIComponent((0,o.getOfflineResourcePrefix)())+t.substr(t.indexOf("/")));else if(0===e.indexOf("urn")){if(0===e.indexOf("urn:adsk.fluent")||!o.endpoint.isSVF2Backend()&&!o.endpoint.isOtgBackend())t=o.endpoint.getItemApi(null,e),o.endpoint.ENDPOINT_API_MODEL_DERIVATIVE_V2===o.endpoint.getApiFlavor()&&(t=decodeURIComponent(t));else{var r=(0,o.getEnv)(),n=u.EnvironmentConfigurations[r],i=(0,s.getGlobal)().USE_OTG_DS_PROXY?null:n.UPSTREAM,a=(0,u.getUpstreamApiData)(r,o.endpoint.getApiFlavor());t=o.endpoint.getItemApi(i,e,a)}}else 0===e.indexOf("$file$")&&(t=this.myPath.replace("/bubble.json",e.replace("$file$","")));return t},f.prototype.getThumbnailOptions=function(e,t,r){var n=t||200,i=r||200,o=e.urn||this.myData.urn;return{urn:o,width:n,height:i,guid:e.guid,acmsession:this.getAcmSessionId(o)}},f.prototype.getThumbnailPath=function(e,t,r){var n=this.getThumbnailOptions(e,t,r),i=o.endpoint.getThumbnailApi(null,n.urn)+"?width="+n.width+"&height="+n.height;n.guid&&(i+="&guid="+n.guid),n.acmsession&&(i+="&acmsession="+n.acmsession);var a=o.endpoint.getQueryParams();return a&&(i+="&"+a),i},f.prototype.getLeafletZipParams=function(e,t){for(var r,n,i=t.search({role:"leaflet-zip"},!1),o=0;o<i.length;o++){n={};var a=(r=i[o]._raw()).urn;n.urnZip=this.getFullPath(a),n.centralDirOffset=r.central_dir_offset,n.centralDirLength=r.central_dir_length,n.centralDirEntries=r.central_dir_entries,n.zipMaxLevel=r.max_level-e.levelOffset,n.loadFromZip=!!(n.urnZip&&n.centralDirOffset&&n.centralDirLength&&n.centralDirEntries),n.fileTable={},e.zips||(e.zips=[]),e.zips.push(n)}e.zips.sort((function(e,t){return e.zipMaxLevel-t.zipMaxLevel}))},f.prototype.getLeafletParams=function(e,t,r){e.tileSize=r.tileSize?r.tileSize:512,e.texWidth=r.resolution[0],e.texHeight=r.resolution[1],e.paperWidth=r.paperWidth,e.paperHeight=r.paperHeight,e.paperUnits=r.paperUnits,e.urlPattern=r.urn,e.mime=r.mime,e.isLeaflet=!0,e.levelOffset=function(e){for(var t=1,r=0,n=0;n<20;n++){if((t*=2)>e)return r;r++}return l.logger.log("unexpected leaflet tileSize"),0}(e.tileSize),this.getLeafletZipParams(e,t),e.loadFromZip=e.zips&&e.zips[0].loadFromZip,e.zips&&(0,o.isOffline)()&&(0,s.isMobileDevice)()&&(e.zips=e.zips.slice(0,1),e.maxLevel=e.zips[0].zipMaxLevel)},f.prototype.derivePdfUrnHack=function(e,t){var r=e.parent.children.slice();r.sort((function(e,t){return e._raw().order-t._raw().order}));var i=(r.length<=75?r[r.length-1]:r[74]).search(n.BubbleNode.GEOMETRY_F2D_NODE)[0];if(i){var o=i.urn().indexOf("/"),a=i.urn().slice(0,o),s=e._raw().order,l=0|s%75,u=1+(0|s/75),c=a+"/output/".concat(l,"/").concat(l,".pdf");return t.page=u,t.isPdf=!0,console.log("pdf path",c),c}return null},f.prototype.getViewableUrn=function(e,t){var r,i=this;if(e instanceof n.BubbleNode)r=e;else{var o=this.docRoot.search(e);r=o.length>0?o[0]:new n.BubbleNode(e)}var a=function(){var e=r.search(n.BubbleNode.GEOMETRY_F2D_NODE);if(e.length)return e[0].urn()};if(r.isGeometry()){if(r.is3D())return r.getViewableRootPath();if(r.is2D()){var l=function(){if(r.isRevitPdf()){var e=a();if(e)return e}var o=r.data.totalRasterPixels;"number"!=typeof o&&(o=1/0);var l=o<1<<21,u="true"===(0,c.getParameterByName)("vectorPdf")||(0,s.getGlobal)().LMV_VECTOR_PDF||i.myData&&i.myData.isVectorPDF||!!r.data.isVectorPDF,h="false"===(0,c.getParameterByName)("vectorPdf")||(0,s.getGlobal)().LMV_RASTER_PDF;u?l=!0:h&&(l=!1);var d=r.search(n.BubbleNode.PDF_PAGE_NODE),f=r.search(n.BubbleNode.LEAFLET_NODE);if(l&&f.length>0&&t&&(i.getLeafletParams(t,r,f[0]._raw()),t.tempRasterPath=f[0].urn()),l&&d.length)return t&&(t.isPdf=!0,t.page=d[0].data.page||1),d[0].urn();if(f.length>0&&t){if(u){var p=i.derivePdfUrnHack(r,t);if(p)return p}return i.getLeafletParams(t,r,f[0]._raw()),f[0].urn()}}()||function(){var e=r.search(n.BubbleNode.IMAGE_NODE);if(e.length)return e[0].urn()}()||a();if(l)return l}}else if(r.isViewPreset()){var u=this.getViewGeometry(r,!0);if(u)return this.getViewableUrn(u,t)}return""},f.prototype.getViewablePath=function(e,t){var r=this.getViewableUrn(e,t);return r?this.getFullPath(r):""},f.prototype.downloadAecModelData=function(e){var t=this,r=e?function(t){try{e(t)}catch(e){console.error("Document.downloadAecModelData() onFinished handler crashed",e)}return t}:function(e){return e};if(this.downloadAecModelDataPromise)return this.downloadAecModelDataPromise.then(r),this.downloadAecModelDataPromise;var n=this.docRoot.findViewableParent(),i=n&&n.data.aec_model_data;if(i)return r(i),Promise.resolve(i);var s=this.docRoot.search({role:"Autodesk.AEC.ModelData"})[0];if(!s)return r(),Promise.resolve(null);var l=s.getViewableRootPath(),c=this.getFullPath(l),h={headers:{}},d=this.getAcmSessionId(c);return-1!==c.indexOf(".api.autodesk.com")&&u.token.accessToken&&(h.headers.Authorization="Bearer "+u.token.accessToken),d&&(h.queryParams="acmsession="+d),this.downloadAecModelDataPromise=new Promise((function(e){var t=function(t){s.findViewableParent().data.aec_model_data=t,e(t)};a.ViewingService.getItem(o.endpoint.initLoadContext(h),c,(function(e){return t(e)}),(function(){return t()}),{responseType:"json"})})).then((function(e){return delete t.downloadAecModelDataPromise,e})).then(r),this.downloadAecModelDataPromise},f.getAecModelData=function(e){if(Array.isArray(e)){var t=new Map,r=e.map((function(e){var r=e.getDocument(),n=t.get(r);if(n)return n;var i=r.downloadAecModelData();return t[r]=i,i}));return Promise.all(r)}return e.getDocument().downloadAecModelData()},f.prototype.getRoot=function(){return this.docRoot},f.prototype.getPath=function(){return this.myPath},f.prototype.getViewGeometry=function(e){return e.findParentGeom2Dor3D()},f.prototype.getNumViews=function(e){var t=e.guid;return e instanceof n.BubbleNode&&(t=e.guid()),this.myNumViews[t]||0},f.prototype.getMessages=function(e,t){var r=[];if(!e)return r;for(var n=e;n&&(!t||n.parent);)n._raw().messages&&(r=r.concat(n._raw().messages)),n=n.parent;return r},f.prototype.getGlobalMessages=function(){var e=[],t=0,r=0;this.getRoot().traverse((function(n){var i=n._raw().messages||[];i.filter((function(e){return"error"===e.type})).length>0&&(t+=1),"inprogress"===n._raw().status&&(r+=1),e=e.concat(i)}));var n="translated";n=t>0?"failed":n,n=r>0?"processing":n;for(var i=e.length;i--;e[i].$translation=n);return e}},7724:(e,t,r)=>{"use strict";function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}r.r(t),r.d(t,{DynamicGlobalOffset:()=>l});var i=Autodesk.Viewing.Private,o=null,a=null,s=null,l=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.viewer=t,this.enabled=!1,this.onCameraChanged=this.onCameraChanged.bind(this);this.maxDistSq=1e8,this.setActive(!0)}var t,r,l;return t=e,l=[{key:"updateModelMatrix",value:function(e,t,r){o=o||new i.LmvMatrix4(!0),a=a||new i.LmvMatrix4(!0),s=s||new i.LmvMatrix4(!0);var n=e.myData.placementWithOffset?o.copy(e.myData.placementWithOffset).invert():o.identity(),l=t?a.copy(t):a.identity();r&&(l.elements[12]-=r.x,l.elements[13]-=r.y,l.elements[14]-=r.z);var u=s.multiplyMatrices(l,n);e.setModelTransform(u)}}],(r=[{key:"setActive",value:function(e){e!=this.enabled&&(this.enabled=e,e?this.viewer.addEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,this.onCameraChanged):this.viewer.removeEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,this.onCameraChanged))}},{key:"onCameraChanged",value:function(){if(!this.viewer.impl.is2d&&!this.blockEvents){var e=this.viewer.toolController.getTool("orbit");if(!(null!=e&&e.isDragging||this.viewer.impl.camera.position.lengthSq()<this.maxDistSq)){this.blockEvents=!0;var t=this.viewer.impl.camera.getGlobalPosition();this.resetGlobalOffset(t),this.blockEvents=!1}}}},{key:"resetGlobalOffset",value:function(e){var t=this;this.viewer.getVisibleModels().forEach((function(r){r.setGlobalOffset(e),t.viewer.impl.onModelTransformChanged(r)})),this.viewer.impl.camera.setGlobalOffset(e),this.viewer.impl.syncCamera(),this.viewer.autocam&&this.viewer.autocam.onGlobalOffsetChanged(e),this.viewer.autocam.sync(this.viewer.impl.camera)}}])&&n(t.prototype,r),l&&n(t,l),Object.defineProperty(t,"prototype",{writable:!1}),e}()},62546:(e,t,r)=>{"use strict";r.r(t),r.d(t,{EventDispatcher:()=>n});var n=function(){};n.prototype={constructor:n,apply:function(e){e.addEventListener=n.prototype.addEventListener,e.hasEventListener=n.prototype.hasEventListener,e.removeEventListener=n.prototype.removeEventListener,e.clearListeners=n.prototype.clearListeners,e.fireEvent=n.prototype.fireEvent,e.dispatchEvent=n.prototype.fireEvent,e.debugEvents=n.prototype.debugEvents},addEventListener:function(e,t,r){if(e){void 0===this.listeners&&(this.listeners={}),void 0===this.listeners[e]&&(this.listeners[e]=[]);for(var n=r&&r.priority||0,i=this.listeners[e].length,o=this.listeners[e].length-1;o>=0&&n>this.listeners[e][o].priority;o--)i--;this.listeners[e].splice(i,0,{callbackFn:t,once:!!r&&!!r.once,priority:n})}},hasEventListener:function(e,t){if(!e)return!1;if(void 0===this.listeners)return!1;var r=this.listeners[e];if(!r||0===r.length)return!1;for(var n=0,i=r.length;n<i;++n)if(r[n].callbackFn===t)return!0;return!1},removeEventListener:function(e,t){if(e)if(void 0!==this.listeners){var r=this.listeners[e];if(r)for(var n=0,i=r.length;n<i;++n)if(r[n].callbackFn===t){r.splice(n,1);break}}else this.listeners={}},clearListeners:function(){this.listeners=void 0},dispatchEvent:function(e){if(void 0!==this.listeners){if("string"==typeof e&&(e={type:e}),!e.target)try{e.target=this}catch(e){}if(!e.type)throw new Error("event type unknown.");if(this._doDebug&&console.log("Event: "+e.type),Array.isArray(this.listeners[e.type])){for(var t=this.listeners[e.type].slice(),r=[],n=0,i=t.length;n<i;++n)t[n].callbackFn.call(this,e),t[n].once&&r.push(t[n].callbackFn);for(var o=0;o<r.length;++o)this.removeEventListener(e.type,r[o])}}else this.listeners={}},debugEvents:function(e){this._doDebug=e}},n.prototype.fireEvent=n.prototype.dispatchEvent,"undefined"!=typeof Autodesk&&(Autodesk.Viewing.EventDispatcher=n)},37169:e=>{"use strict";var t=e.exports;t.ESCAPE_EVENT="escape",t.PROGRESS_UPDATE_EVENT="progress",t.FULLSCREEN_MODE_EVENT="fullScreenMode",t.NAVIGATION_MODE_CHANGED_EVENT="navmode",t.VIEWER_STATE_RESTORED_EVENT="viewerStateRestored",t.VIEWER_RESIZE_EVENT="viewerResize",t.VIEWER_INITIALIZED="viewerInitialized",t.VIEWER_UNINITIALIZED="viewerUninitialized",t.LOADER_LOAD_FILE_EVENT="loaderLoadFile",t.LOADER_LOAD_ERROR_EVENT="loaderLoadError",t.MODEL_ROOT_LOADED_EVENT="svfLoaded",t.GEOMETRY_LOADED_EVENT="geometryLoaded",t.TEXTURES_LOADED_EVENT="texturesLoaded",t.OBJECT_TREE_CREATED_EVENT="propertyDbLoaded",t.OBJECT_TREE_UNAVAILABLE_EVENT="propertyDbUnavailable",t.OBJECT_TREE_LOAD_PROGRESS_EVENT="propertyDbLoadProgress",t.MODEL_UNLOADED_EVENT="modelUnloaded",t.BEFORE_MODEL_UNLOAD_EVENT="beforeModelUnload",t.MODEL_ADDED_EVENT="modelAdded",t.MODEL_REMOVED_EVENT="modelRemoved",t.MODEL_LAYERS_LOADED_EVENT="modelLayersLoaded",t.MODEL_TRANSFORM_CHANGED_EVENT="modelTransformChanged",t.MODEL_PLACEMENT_CHANGED_EVENT="placementTransformChanged",t.MODEL_VIEWPORT_BOUNDS_CHANGED_EVENT="viewportBoundsChanged",t.EXTENSION_PRE_LOADED_EVENT="extensionPreLoaded",t.EXTENSION_LOADED_EVENT="extensionLoaded",t.EXTENSION_PRE_UNLOADED_EVENT="extensionPreUnloaded",t.EXTENSION_UNLOADED_EVENT="extensionUnloaded",t.EXTENSION_PRE_ACTIVATED_EVENT="extensionPreActivated",t.EXTENSION_ACTIVATED_EVENT="extensionActivated",t.EXTENSION_PRE_DEACTIVATED_EVENT="extensionPreDeactivated",t.EXTENSION_DEACTIVATED_EVENT="extensionDeactivated",t.SELECTION_CHANGED_EVENT="selection",t.AGGREGATE_SELECTION_CHANGED_EVENT="aggregateSelection",t.ISOLATE_EVENT="isolate",t.AGGREGATE_ISOLATION_CHANGED_EVENT="aggregateIsolation",t.HIDE_EVENT="hide",t.AGGREGATE_HIDDEN_CHANGED_EVENT="aggregateHidden",t.SHOW_EVENT="show",t.SHOW_PROPERTIES_EVENT="showProperties",t.SHOW_ALL_EVENT="showAll",t.HIDE_ALL_EVENT="hideAll",t.CAMERA_CHANGE_EVENT="cameraChanged",t.EXPLODE_CHANGE_EVENT="explodeChanged",t.FIT_TO_VIEW_EVENT="fitToView",t.AGGREGATE_FIT_TO_VIEW_EVENT="aggregateFitToView",t.CUTPLANES_CHANGE_EVENT="cutplanesChanged",t.TOOL_CHANGE_EVENT="toolChanged",t.RENDER_OPTION_CHANGED_EVENT="renderOptionChanged",t.FINAL_FRAME_RENDERED_CHANGED_EVENT="finalFrameRenderedChanged",t.RENDER_PRESENTED_EVENT="renderPresented",t.LAYER_VISIBILITY_CHANGED_EVENT="layerVisibility",t.PREF_CHANGED_EVENT="PrefChanged",t.PREF_RESET_EVENT="PrefReset",t.RESTORE_DEFAULT_SETTINGS_EVENT="restoreDefaultSettings",t.ANIMATION_READY_EVENT="animationReady",t.CAMERA_TRANSITION_COMPLETED="cameraTransitionCompleted",t.HYPERLINK_EVENT="hyperlink",t.HYPERLINK_NAVIGATE="hyperlink_navigate",t.LOAD_GEOMETRY_EVENT="load_geometry",t.LOAD_MISSING_GEOMETRY="loadMissingGeometry",t.WEBGL_CONTEXT_LOST_EVENT="webglcontextlost",t.WEBGL_CONTEXT_RESTORED_EVENT="webglcontextrestored",t.CANCEL_LEAFLET_SCREENSHOT="cancelLeafletScreenshot",t.SET_VIEW_EVENT="setView",t.RENDER_FIRST_PIXEL="renderFirstPixel",t.PROFILE_CHANGE_EVENT="profileChanged",t.RENDER_SCENE_PART="renderScenePart",t.OBJECT_UNDER_MOUSE_CHANGED="hoverObjectChanged",t.ANIM_ENDED="animEnded",t.TRANSITION_STARTED="transitionStarted",t.TRANSITION_ENDED="transitionEnded"},11294:(e,t,r)=>{"use strict";r.r(t),r.d(t,{EventUtils:()=>u});var n=r(84998);function i(e,t,r,n,i,o,a){try{var s=e[o](a),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,i)}function o(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var a=e.apply(t,r);function s(e){i(a,n,o,s,l,"next",e)}function l(e){i(a,n,o,s,l,"throw",e)}s(void 0)}))}}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var s=!1,l=!1,u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,n,i,u,h;return t=e,r=null,n=[{key:"isRightClick",value:function(e){if(!(e instanceof c(e).MouseEvent))return!1;var t=e.button;return"buttons"in e&&(!l||1&e.buttons?2===t&&1&e.buttons&&(t=0,l=!0):(l=!1,t=0)),t===(s?0:2)}},{key:"isMiddleClick",value:function(e){return e instanceof c(e).MouseEvent&&1===e.button}},{key:"setUseLeftHandedInput",value:function(e){s=e}},{key:"waitUntilTransitionEnded",value:(h=o(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.navigation.getRequestTransition()||t.navigation.getTransitionActive()){e.next=2;break}return e.abrupt("return");case 2:return e.abrupt("return",new Promise((function(e){setTimeout((function(){t.navigation.getRequestTransition()||t.navigation.getTransitionActive()?t.addEventListener(Autodesk.Viewing.CAMERA_TRANSITION_COMPLETED,e,{once:!0}):e()}))})));case 3:case"end":return e.stop()}}),e)}))),function(e){return h.apply(this,arguments)})},{key:"waitUntilGeometryLoaded",value:(u=o(regeneratorRuntime.mark((function e(t){var r,n=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=n.length>1&&void 0!==n[1]?n[1]:t.model)||!r.isLoadDone()){e.next=3;break}return e.abrupt("return");case 3:return e.abrupt("return",new Promise((function(e){t.addEventListener(Autodesk.Viewing.GEOMETRY_LOADED_EVENT,(function n(i){r&&r!==i.model||(e(),t.removeEventListener(Autodesk.Viewing.GEOMETRY_LOADED_EVENT,n))}))})));case 4:case"end":return e.stop()}}),e)}))),function(e){return u.apply(this,arguments)})},{key:"waitUntilModelAdded",value:(i=o(regeneratorRuntime.mark((function e(t){var r,n=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=n.length>1&&void 0!==n[1]?n[1]:t.model)){e.next=3;break}return e.abrupt("return");case 3:return e.abrupt("return",new Promise((function(e){t.addEventListener(Autodesk.Viewing.MODEL_ADDED_EVENT,(function n(i){r&&r!==i.model||(e(),t.removeEventListener(Autodesk.Viewing.MODEL_ADDED_EVENT,n))}))})));case 4:case"end":return e.stop()}}),e)}))),function(e){return i.apply(this,arguments)})}],r&&a(t.prototype,r),n&&a(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function c(e){var t=e.target&&e.target.ownerDocument;return t?t.defaultView||t.parentWindow:(0,n.getGlobal)()}Autodesk.Viewing.isRightClick=u.isRightClick,Autodesk.Viewing.isMiddleClick=u.isMiddleClick},25282:(e,t,r)=>{"use strict";r.r(t),r.d(t,{Extension:()=>o});var n=r(41471),i=r(35449),o=function(e,t){this.viewer=e,i.GlobalManagerMixin.call(this),this.setGlobalManager(e.globalManager),this.options=t||{},this.id="",this.modes=[],this.mode="",this.name="",this.activeStatus=!1};o.prototype.load=function(){return!0},o.prototype.unload=function(){return!0},o.prototype.activate=function(e){return!0},o.prototype.deactivate=function(){return!0},o.prototype.setActive=function(e,t){e?this.activate(t):this.deactivate()},o.prototype.getName=function(){return this.name},o.prototype.getModes=function(){return this.modes},o.prototype.isActive=function(e){return e?this.activeStatus&&this.mode===e:this.activeStatus},o.prototype.getState=function(e){},o.prototype.restoreState=function(e,t){return!0},o.prototype.extendLocalization=function(e){return(0,n.extendLocalization)(e)},o.prototype.getCache=function(){this.viewer.extensionCache||(this.viewer.extensionCache={});var e=this.viewer.extensionCache[this.id];return e||(e=this.viewer.extensionCache[this.id]={}),e},o.prototype.onToolbarCreated=function(e){},"undefined"!=typeof Autodesk&&(Autodesk.Viewing.Extension=o)},61445:(e,t,r)=>{"use strict";r.r(t),r.d(t,{ExtensionMixin:()=>d,theExtensionManager:()=>h});var n=r(98926),i=r(34500),o=r(37169),a=r(21319),s=Autodesk.Viewing;function l(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==r)return;var n,i,o=[],a=!0,s=!1;try{for(r=r.call(e);!(a=(n=r.next()).done)&&(o.push(n.value),!t||o.length!==t);a=!0);}catch(e){s=!0,i=e}finally{try{a||null==r.return||r.return()}finally{if(s)throw i}}return o}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return u(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return u(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var h=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.registeredExtensions=new Map}var t,r,n;return t=e,(r=[{key:"registerExtension",value:function(e,t){if(this.registeredExtensions.has(e)){var r=this.registeredExtensions.get(e);if(r.EXTENSION_CLASS)return!1;r.EXTENSION_CLASS=t}else this.registeredExtensions.set(e,{EXTENSION_CLASS:t});return!0}},{key:"getExtensionClass",value:function(e){return this.registeredExtensions.has(e)?this.registeredExtensions.get(e).EXTENSION_CLASS:null}},{key:"unregisterExtension",value:function(e){return!!this.registeredExtensions.has(e)&&(this.registeredExtensions.delete(e),!0)}},{key:"registerExternalExtension",value:function(e,t,r){return!this.registeredExtensions.has(e)&&(this.registeredExtensions.set(e,{EXTENSION_CLASS:null,externalPathOrCallback:t,dependencies:r}),!0)}},{key:"getExternalPath",value:function(e){return this.registeredExtensions.has(e)?this.registeredExtensions.get(e).externalPathOrCallback:null}},{key:"getRegisteredExtensions",value:function(){return Array.from(this.registeredExtensions).map((function(e){var t=l(e,2),r=t[0],n=t[1];return{id:r,inMemory:!!n.EXTENSION_CLASS,isAsync:!!n.externalPathOrCallback}}))}},{key:"downloadExtension",value:function(e){var t=this;if(!this.registeredExtensions.has(e))return Promise.reject("Extension not found: "+e+". Has it been registered(1)?");var r=this.registeredExtensions.get(e);if(!r.externalPathOrCallback)return Promise.reject("Extension not found: "+e+". Has it been registered(2)?");if(r.downloadPromise)return r.downloadPromise;var n=(r.dependencies||[]).map((function(e){return t.downloadExtension(e)})),o=Promise.all(n);return r.downloadPromise=o.then((function(){return"string"==typeof r.externalPathOrCallback?i.theResourceLoader.loadScript(r.externalPathOrCallback,e):r.externalPathOrCallback()})).then((function(){if(delete r.downloadPromise,!r.EXTENSION_CLASS)throw new Error("Extension not found: "+e+". Has it been registered(3)?");return r.EXTENSION_CLASS})),r.downloadPromise}},{key:"popuplateOptions",value:function(e){this.registeredExtensions.forEach((function(t){t.EXTENSION_CLASS.populateDefaultOptions(e)}))}},{key:"isDownloading",value:function(e){return!!this.registeredExtensions.has(e)&&!!this.registeredExtensions.get(e).downloadPromise}},{key:"isAvailable",value:function(e){return!!this.getExtensionClass(e)}}])&&c(t.prototype,r),n&&c(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}()),d=function(){};d.prototype={loadExtension:function(e,t){var r=this;return this.loadedExtensions=this.loadedExtensions||{},h.isAvailable(e)?this.loadExtensionLocal(e,t):(this.loadExtensionPromises=this.loadExtensionPromises||{},e in this.loadExtensionPromises||(this.loadExtensionPromises[e]=h.downloadExtension(e).then((function(){if(delete r.loadExtensionPromises[e],r.loadedExtensions){if(r.cancelledExtensions&&e in r.cancelledExtensions)throw delete r.cancelledExtensions[e],new Error("Abort loadExtension('".concat(e,"') - extension has been unloaded"));return r.loadExtensionLocal(e,t)}n.logger.info("Abort loadExtension('".concat(e,"') - teardown in progress"))}))),this.loadExtensionPromises[e])},getExtension:function(e,t){var r=this.loadedExtensions&&e in this.loadedExtensions?this.loadedExtensions[e]:null;return r&&t&&t(r),r},getExtensionAsync:function(e){var t=this,r=this.getExtension(e);return r?Promise.resolve(r):new Promise((function(n){t.addEventListener(o.EXTENSION_LOADED_EVENT,(function t(i){i.extensionId===e&&(this.removeEventListener(o.EXTENSION_LOADED_EVENT,t),r=this.getExtension(e),n(r))}))}))},unloadExtension:function(e){if(this.cancelledExtensions=this.cancelledExtensions||{},h.isDownloading(e))return this.cancelledExtensions[e]=!0,!1;var t=!1,r=this.getExtension(e);return r?(t=r.unload(),n.logger.info("Extension unloaded: "+e),delete this.loadedExtensions[e],a.analytics.track("viewer.extensionManager.extensionUnloaded",{extensionId:e}),this.dispatchEvent({type:o.EXTENSION_UNLOADED_EVENT,extensionId:e})):n.logger.warn("Extension not found: "+e),t},loadExtensionLocal:function(e,t){var r=this,i=h.getExtensionClass(e);if(!i)return Promise.reject("Extension not found : "+e);var l=this.getExtension(e);if(l)return Promise.resolve(l);if(this.loadingExtensions&&e in this.loadingExtensions)return this.loadingExtensions[e];l=function(e){function t(t,r,n){var i=e[t];i?e[t]=function(){r&&r.call.apply(r,[e].concat(Array.prototype.slice.call(arguments)));var t=i.call.apply(i,[e].concat(Array.prototype.slice.call(arguments)));return n&&n.call.apply(n,[e].concat(Array.prototype.slice.call(arguments))),t}:console.warn(t," not implemented in ",e)}return t("load",(function(){this.viewer.dispatchEvent({type:s.EXTENSION_PRE_LOADED_EVENT,extensionId:this.id})})),t("unload",(function(){this.viewer.dispatchEvent({type:s.EXTENSION_PRE_UNLOADED_EVENT,extensionId:this.id})})),t("activate",(function(e){this.viewer.dispatchEvent({type:s.EXTENSION_PRE_ACTIVATED_EVENT,extensionId:this.id,mode:e})}),(function(e){this.viewer.dispatchEvent({type:s.EXTENSION_ACTIVATED_EVENT,extensionId:this.id,mode:e}),a.analytics.track("viewer.extension.activate",{extensionId:this.id,mode:e})})),t("deactivate",(function(){this.viewer.dispatchEvent({type:s.EXTENSION_PRE_DEACTIVATED_EVENT,extensionId:this.id})}),(function(){this.viewer.dispatchEvent({type:s.EXTENSION_DEACTIVATED_EVENT,extensionId:this.id}),a.analytics.track("viewer.extension.deactivate",{extensionId:this.id})})),e}(new i(this,t)),l.id=e;var u=function(){return Promise.reject("Extension failed to .load() : "+e)},c=l.load();if(!c)return u();var d=function(){return r.loadedExtensions[e]=l,r.onPostExtensionLoad(l),n.logger.info("Extension loaded: "+e),a.analytics.track("viewer.extensionManager.extensionLoaded",{extensionId:e}),setImmediate((function(){r.getExtension(e)&&r.dispatchEvent({type:o.EXTENSION_LOADED_EVENT,extensionId:e})})),Promise.resolve(l)};return c instanceof Promise?(this.loadingExtensions=this.loadingExtensions||{},this.loadingExtensions[e]=c.then((function(e){return e?d():u()})).finally((function(){delete r.loadingExtensions[e]})),this.loadingExtensions[e]):d()},onPostExtensionLoad:function(e){},forEachExtension:function(e){var t=this.loadedExtensions||{};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(t[r])},apply:function(e){var t=d.prototype;e.loadExtension=t.loadExtension,e.getExtension=t.getExtension,e.getExtensionAsync=t.getExtensionAsync,e.unloadExtension=t.unloadExtension,e.loadExtensionLocal=t.loadExtensionLocal,e.forEachExtension=t.forEachExtension,e.onPostExtensionLoad=t.onPostExtensionLoad}}},25637:(e,t,r)=>{"use strict";function n(e){this.viewer=e}r.r(t),r.d(t,{FileLoader:()=>n}),n.prototype.constructor=n,n.prototype.loadFile=function(e,t,r,n){return!1},n.prototype.is3d=function(){return!1}},50411:(e,t,r)=>{"use strict";r.r(t),r.d(t,{FileLoaderManager:()=>i});var n={};var i={registerFileLoader:function(e,t,r){return!n[e]&&(n[e]={loader:r,extensions:t},!0)},getFileLoader:function(e){return n[e]?n[e].loader:null},getFileLoaderForExtension:function(e){for(var t in e=e?e.toLowerCase():"",n){var r=n[t];if(r)for(var i=0;i<r.extensions.length;i++)if(r.extensions[i].toLowerCase()===e)return r.loader}return null},unregisterFileLoader:function(e){return!!n[e]&&(delete n[e],!0)}}},27800:(e,t,r)=>{"use strict";function n(e){return function(e){if(Array.isArray(e))return s(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||a(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==r)return;var n,i,o=[],a=!0,s=!1;try{for(r=r.call(e);!(a=(n=r.next()).done)&&(o.push(n.value),!t||o.length!==t);a=!0);}catch(e){s=!0,i=e}finally{try{a||null==r.return||r.return()}finally{if(s)throw i}}return o}(e,t)||a(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=a(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,l=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){l=!0,o=e},f:function(){try{s||null==r.return||r.return()}finally{if(l)throw o}}}}function a(e,t){if(e){if("string"==typeof e)return s(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?s(e,t):void 0}}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}r.r(t),r.d(t,{GlobalManager:()=>c});var u=Autodesk.Viewing,c=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._window={inner:null,registeredEventListeners:new Map},this._document={inner:null,registeredEventListeners:new Map},this._window.inner=u.getGlobal(),this._document.inner=this._window.inner.document,this.addWindowEventListener=d.bind(this._window),this.removeWindowEventListener=f.bind(this._window),this.addDocumentEventListener=d.bind(this._document),this.removeDocumentEventListener=f.bind(this._document)}var t,r,a;return t=e,(r=[{key:"getWindow",value:function(){return this._window.inner}},{key:"getDocument",value:function(){return this._document.inner}},{key:"setWindow",value:function(e){if(e&&e!==this._window.inner){var t,r=o(this._window.registeredEventListeners.entries());try{for(r.s();!(t=r.n()).done;){var a,s=i(t.value,2),l=s[0],u=o(s[1].entries());try{for(u.s();!(a=u.n()).done;){var c,h=i(a.value,2),d=h[0],f=h[1];e.addEventListener.apply(e,[l,d].concat(n(f))),(c=this._window.inner).removeEventListener.apply(c,[l,d].concat(n(f)))}}catch(e){u.e(e)}finally{u.f()}}}catch(e){r.e(e)}finally{r.f()}var p,m=o(this._document.registeredEventListeners.entries());try{for(m.s();!(p=m.n()).done;){var g,v=i(p.value,2),y=v[0],b=o(v[1].entries());try{for(b.s();!(g=b.n()).done;){var x,_,E=i(g.value,2),w=E[0],A=E[1];(x=e.document).addEventListener.apply(x,[y,w].concat(n(A))),(_=this._document.inner).removeEventListener.apply(_,[y,w].concat(n(A)))}}catch(e){b.e(e)}finally{b.f()}}}catch(e){m.e(e)}finally{m.f()}this._window.inner=e,this._document.inner=e.document}}}])&&l(t.prototype,r),a&&l(t,a),Object.defineProperty(t,"prototype",{writable:!1}),e}();function h(e){return!!e.opener}function d(e,t){for(var r,n=arguments.length,i=new Array(n>2?n-2:0),o=2;o<n;o++)i[o-2]=arguments[o];h(this.inner)||(this.registeredEventListeners.has(e)?this.registeredEventListeners.get(e).set(t,i):this.registeredEventListeners.set(e,new Map([[t,i]]))),(r=this.inner).addEventListener.apply(r,[e,t].concat(i))}function f(e,t){var r;h(this.inner)||this.registeredEventListeners.has(e)&&this.registeredEventListeners.get(e).has(t)&&this.registeredEventListeners.get(e).delete(t);for(var n=arguments.length,i=new Array(n>2?n-2:0),o=2;o<n;o++)i[o-2]=arguments[o];(r=this.inner).removeEventListener.apply(r,[e,t].concat(i))}},35449:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalManagerMixin:()=>o});var n=r(27800),i=new n.GlobalManager;function o(){this.globalManager=i,this.setGlobalManager=function(e){this.globalManager=e,this.onSetGlobalManager(this.globalManager)},this.onSetGlobalManager=function(e){},this.getWindow=function(){return this.globalManager.getWindow()},this.getDocument=function(){return this.globalManager.getDocument()},this.setWindow=function(e){return this.globalManager.setWindow(e)},this.addWindowEventListener=function(e,t){for(var r,n=arguments.length,i=new Array(n>2?n-2:0),o=2;o<n;o++)i[o-2]=arguments[o];(r=this.globalManager).addWindowEventListener.apply(r,[e,t].concat(i))},this.removeWindowEventListener=function(e,t){for(var r,n=arguments.length,i=new Array(n>2?n-2:0),o=2;o<n;o++)i[o-2]=arguments[o];(r=this.globalManager).removeWindowEventListener.apply(r,[e,t].concat(i))},this.addDocumentEventListener=function(e,t){for(var r,n=arguments.length,i=new Array(n>2?n-2:0),o=2;o<n;o++)i[o-2]=arguments[o];(r=this.globalManager).addDocumentEventListener.apply(r,[e,t].concat(i))},this.removeDocumentEventListener=function(e,t){for(var r,n=arguments.length,i=new Array(n>2?n-2:0),o=2;o<n;o++)i[o-2]=arguments[o];(r=this.globalManager).removeDocumentEventListener.apply(r,[e,t].concat(i))}}Autodesk.Viewing.GlobalManager=n.GlobalManager,Autodesk.Viewing.GlobalManagerMixin=o},95018:(e,t,r)=>{"use strict";r.r(t),r.d(t,{DefaultLightPreset:()=>i,DefaultLightPreset2d:()=>o,DefaultToneMapMethod:()=>a,BackgroundPresets:()=>s,LightPresets:()=>u,copyLightPreset:()=>h});var n=r(84998),i=1,o=0,a=1,s={"Fusion Grey":[230,230,230,150,150,150],"Sky Blue":[226,244,255,156,172,180],Snow:[181,186,199,181,186,199],Midnight:[41,76,120,1,2,3],White:[255,255,255,255,255,255],AutoCADModel:[30,40,48,30,40,48],"Dark Grey":[51,51,51,51,51,51],"Dark Sky":[51,51,51,51,51,51],"Infinity Pool":[255,255,255,255,255,255],Tranquility:[0,84,166,0,84,166],"Grey Room":[129,129,129,129,129,129],"Photo Booth":[237,237,237,237,237,237],"RaaS SBS":[1,1,1,90,90,90],Plaza:[79,102,130,79,102,130],Field:[202,226,252,202,201,190],Boardwalk:[216,230,248,230,228,220],Custom:[230,230,230,150,150,150]},l=s,u=[{name:"Simple Grey",path:null,tonemap:0,E_bias:0,directLightColor:[1,.84,.67],ambientColor:[.2,.225,.25],lightMultiplier:1,bgColorGradient:l["Fusion Grey"],darkerFade:!1,rotation:0},{name:"Sharp Highlights",path:"SharpHighlights",type:"logluv",tonemap:a,E_bias:-9,directLightColor:[.5,.5,.5],ambientColor:[.25/8,.25/8,.25/8],lightMultiplier:0,lightDirection:[.5,-.2,-.06],bgColorGradient:l["Photo Booth"],darkerFade:!0,rotation:0},{name:"Dark Sky",path:"DarkSky",type:"logluv",tonemap:a,E_bias:-1,directLightColor:[1,1,1],ambientColor:[.25/8,.25/8,.25/8],lightMultiplier:1,lightDirection:[.1,-.55,-1],bgColorGradient:l["Dark Sky"],darkerFade:!1,rotation:0},{name:"Grey Room",path:"GreyRoom",type:"logluv",tonemap:a,E_bias:-1,directLightColor:[1,1,1],ambientColor:[.25/8,.25/8,.25/8],lightMultiplier:.5,lightDirection:[.1,-.55,-1],bgColorGradient:l["Grey Room"],darkerFade:!0,rotation:0},{name:"Photo Booth",path:"PhotoBooth",type:"logluv",tonemap:a,E_bias:0,directLightColor:[1,1,1],ambientColor:[.25/8,.25/8,.25/8],lightMultiplier:.5,lightDirection:[.1,-.55,-1],bgColorGradient:l["Photo Booth"],darkerFade:!0,rotation:0},{name:"Tranquility",path:"TranquilityBlue",type:"logluv",tonemap:a,E_bias:-1,directLightColor:[1,1,1],ambientColor:[.25/8,.25/8,.25/8],lightMultiplier:.5,lightDirection:[.1,-.55,-1],bgColorGradient:l.Tranquility,darkerFade:!1,rotation:0},{name:"Infinity Pool",path:"InfinityPool",type:"logluv",tonemap:a,E_bias:-1,directLightColor:[1,.84,.67],ambientColor:[.25/8,.25/8,.25/8],lightMultiplier:.5,lightDirection:[.1,-.55,-1],bgColorGradient:l["Infinity Pool"],darkerFade:!1,rotation:0},{name:"Simple White",path:null,tonemap:0,E_bias:0,directLightColor:[1,1,1],ambientColor:[.25,.25,.25],lightMultiplier:1,bgColorGradient:l.White,saoRadius:.06,saoIntensity:.15,darkerFade:!0,rotation:0},{name:"Riverbank",path:"riverbank",type:"logluv",tonemap:a,E_bias:-5.7,directLightColor:[1,1,1],lightMultiplier:0,bgColorGradient:l["Sky Blue"],darkerFade:!1,rotation:0},{name:"Contrast",path:"IDViz",type:"logluv",tonemap:a,E_bias:0,directLightColor:[1,1,1],lightMultiplier:0,bgColorGradient:l.Midnight,darkerFade:!1,rotation:0},{name:"Rim Highlights",path:"RimHighlights",type:"logluv",tonemap:a,E_bias:-9,directLightColor:[.5,.5,.5],ambientColor:[.25/8,.25/8,.25/8],lightMultiplier:0,lightDirection:[.35,-.35,-.5],bgColorGradient:l["Photo Booth"],darkerFade:!0,rotation:0},{name:"Cool Light",path:"CoolLight",type:"logluv",tonemap:a,E_bias:-9,directLightColor:[1,1,1],ambientColor:[.25/8,.25/8,.25/8],lightMultiplier:0,lightDirection:[-0,-.15,-.5],bgColorGradient:l["Fusion Grey"],darkerFade:!0,rotation:0},{name:"Warm Light",path:"WarmLight",type:"logluv",tonemap:a,E_bias:-9,directLightColor:[1,1,1],ambientColor:[.25/8,.25/8,.25/8],lightMultiplier:0,lightDirection:[-0,-.15,-.5],bgColorGradient:l["Fusion Grey"],darkerFade:!0,rotation:0},{name:"Soft Light",path:"SoftLight",type:"logluv",tonemap:a,E_bias:-9,directLightColor:[1,1,1],ambientColor:[.25/8,.25/8,.25/8],lightMultiplier:0,lightDirection:[-.5,-.5,0],bgColorGradient:l["Fusion Grey"],darkerFade:!0,rotation:0},{name:"Grid Light",path:"GridLight",type:"logluv",tonemap:a,E_bias:-9,directLightColor:[1,1,1],ambientColor:[.25/8,.25/8,.25/8],lightMultiplier:0,lightDirection:[-.5,-.6,0],bgColorGradient:l["Fusion Grey"],darkerFade:!0,rotation:0},{name:"Plaza",path:"Plaza",type:"logluv",tonemap:a,E_bias:-14,directLightColor:[.9,.9,1],ambientColor:[.25/8,.25/8,.25/8],lightMultiplier:0,lightDirection:[-.2,-.18,.72],bgColorGradient:l.Plaza,darkerFade:!1,rotation:0},{name:"Snow Field",path:"SnowField",type:"logluv",tonemap:a,E_bias:-10.461343,directLightColor:[1,1,1],ambientColor:[.25/8,.25/8,.25/8],lightMultiplier:0,lightDirection:[0,-1,0],bgColorGradient:l.Snow,darkerFade:!1,rotation:0},{name:"Field",path:"field",type:"logluv",tonemap:a,E_bias:-2.9,directLightColor:[1,1,1],lightMultiplier:0,bgColorGradient:l.Field,useIrradianceAsBackground:!0,darkerFade:!0,rotation:0},{name:"Boardwalk",path:"boardwalk",type:"logluv",tonemap:a,E_bias:-7,directLightColor:[1,1,1],lightMultiplier:0,bgColorGradient:l.Boardwalk,useIrradianceAsBackground:!0,darkerFade:!1,rotation:0},{name:"Flat Shading",path:null,tonemap:0,E_bias:0,directLightColor:[0,0,0],ambientColor:[0,0,0],lightMultiplier:0,bgColorGradient:l["Fusion Grey"],darkerFade:!1,rotation:0}],c=[{name:"Harbor",path:"Harbor",type:"logluv",tonemap:a,E_bias:1.9,directLightColor:[1,1,1],lightMultiplier:0,bgColorGradient:l["Sky Blue"],useIrradianceAsBackground:!0,saoIntensity:.5,darkerFade:!1,rotation:0},{name:"Night",path:"Night",type:"logluv",tonemap:1,E_bias:4,directLightColor:[1,1,1],lightMultiplier:0,bgColorGradient:l.Midnight,useIrradianceAsBackground:!1,darkerFade:!1,rotation:0},{name:"Parking",path:"Parking",type:"logluv",tonemap:a,E_bias:2.8,directLightColor:[1,1,1],lightMultiplier:0,bgColorGradient:l["Sky Blue"],useIrradianceAsBackground:!1,saoIntensity:.5,darkerFade:!1,rotation:0},{name:"River Road",path:"RiverRoad",type:"logluv",tonemap:a,E_bias:0,directLightColor:[1,1,1],lightMultiplier:0,bgColorGradient:l["Fusion Grey"],useIrradianceAsBackground:!1,saoIntensity:.7,darkerFade:!1,rotation:0},{name:"Crossroads",path:"crossroads",type:"logluv",tonemap:a,E_bias:-5.5,directLightColor:[1,1,1],lightMultiplier:0,bgColorGradient:l["Sky Blue"],useIrradianceAsBackground:!0,darkerFade:!0,rotation:0},{name:"Seaport",path:"seaport",type:"logluv",tonemap:a,E_bias:-6.5,directLightColor:[1,1,1],lightMultiplier:0,bgColorGradient:l["Sky Blue"],useIrradianceAsBackground:!0,darkerFade:!1,rotation:0},{name:"Glacier",path:"glacier",type:"logluv",tonemap:a,E_bias:0,directLightColor:[1,1,1],lightMultiplier:0,bgColorGradient:l.Midnight,darkerFade:!1,rotation:0},{name:"RaaS Test Env",path:"Reflection",type:"logluv",tonemap:2,E_bias:-1.5,directLightColor:[1,1,1],lightMultiplier:0,bgColorGradient:l["RaaS SBS"],darkerFade:!1,rotation:0},{name:"City Night",path:"CityNight",type:"logluv",tonemap:a,E_bias:1.6,directLightColor:[1,1,1],lightMultiplier:.2,bgColorGradient:l.Midnight,useIrradianceAsBackground:!1,darkerFade:!1,rotation:0}];function h(e,t){(0,n.ObjectAssign)(t,e),t.name=e.name+" (copy)"}(0,n.getGlobal)().ENABLE_DEBUG&&Array.prototype.push.apply(u,c)},19255:(e,t,r)=>{"use strict";r.r(t),r.d(t,{LocalStorage:()=>s});var n,i=r(98926),o=(0,r(84998).getGlobal)();function a(){this.isSupported()||(this._data={})}a.prototype.getItem=function(e){return this.isSupported()?o.localStorage.getItem(e):Object.prototype.hasOwnProperty.call(this._data,e)?this._data[e]:null},a.prototype.setItem=function(e,t){if(this.isSupported())try{o.localStorage.setItem(e,t)}catch(e){i.logger.debug("avp.LocalStorage: Failed to setItem()")}else this._data[e]=String(t)},a.prototype.removeItem=function(e){this.isSupported()?o.localStorage.removeItem(e):delete this._data[e]},a.prototype.clear=function(){this.isSupported()?o.localStorage.clear():this._data={}},a.prototype.isSupported=function(){return void 0===n&&(n=function(){if("undefined"==typeof window)return!1;try{var e="lmv_viewer_test_localStorage",t=o.localStorage;return!!t&&(t.setItem(e,"1"),t.removeItem(e),!0)}catch(e){return!1}}()),n},a.prototype.getAllKeys=function(){return n?Object.keys(o.localStorage):Object.keys(this._data)};var s=new a},83161:(e,t,r)=>{"use strict";r.r(t),r.d(t,{Model:()=>d});var n=r(30190),i=r(62546),o=r(57601),a=r(43586),s=r(84998),l=r(282),u=r(93382),c=r(50638),h=r(65522);function d(e){var t;n.RenderModel.call(this),this.myData=e,this.topology=null,this.topologyPromise=null,this.svfUUID=null,this.defaultCameraHash=null,this.getInstanceTree=function(){return this.myData?this.myData.instanceTree:null},this.getBoundingBox=(t=new THREE.Box3,function(e,r){if(!this.myData)return null;if(t.copy(this.myData.modelSpaceBBox||this.myData.bbox),r&&t.copy(this.trimPageShadowGeometry(t)),e)return t;var n=this.getData().placementWithOffset;n&&this.myData.modelSpaceBBox&&t.applyMatrix4(n);var i=this.getModelTransform();return i&&t.applyMatrix4(i),t}),this.getFuzzyBox=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Boolean(e.ignoreTransforms),r=this.getFragmentList();if(!r||this.is2d())return this.getBoundingBox(t);var n=null;if(t){var i=new Array(6),o=this.getData().placementWithOffset,a=o?o.clone().invert():void 0;n=function(e,t){r.getOriginalWorldBounds(e,i),t.min.fromArray(i),t.max.fromArray(i,3),a&&t.applyMatrix4(a)}}else n=function(e,t){r.getWorldBounds(e,t)};function s(){var t=new THREE.Box3,i=new THREE.Vector3,o=new THREE.Vector3,a=new THREE.Vector3,s=0;function l(r){if(!e.allowlist||e.allowlist.includes(r)){n(r,t),t.getCenter(i);var l=t.getSize(o).length();a.add(i.multiplyScalar(l)),s+=l}}for(var u=0;u<r.getCount();u++)l(u);return a.multiplyScalar(1/s),a}for(var l=e.center||s(),u=e.quantil||.75,c=new THREE.Box3,h=[],d=new THREE.Vector3,f=0;f<r.getCount();f++)if((!e.allowlist||e.allowlist.includes(f))&&(n(f,c),!c.isEmpty())){var p=c.distanceToPoint(l);0===p&&(p=l.distanceTo(c.getCenter(d))),h.push({fragId:f,distance:p})}h.sort((function(e,t){return e.distance-t.distance}));for(var m=new THREE.Box3,g=0;g<h.length*u;g++){var v=h[g];n(v.fragId,c),m.union(c)}return m},this.is2d=function(){return!(!this.myData||!this.myData.is2d)},this.is3d=function(){return!this.is2d()},this.isOTG=function(){return this.myData&&!!this.myData.isOTG},this.isSVF2=function(){var e=this.getDocumentNode();return!!e&&e.isSVF2()},this.isPdf=function(e){return!(!this.myData||!this.myData.isPdf||e&&this.isRevitPdf())},this.isRevitPdf=function(){var e;return!(null===(e=this.getDocumentNode())||void 0===e||!e.isRevitPdf())},this.isLeaflet=function(){return!(!this.myData||!this.myData.isLeaflet)},this.isPageCoordinates=function(){var e;return this.is2d()&&(!this.isLeaflet()||(null===(e=this.loader)||void 0===e?void 0:e.isPageCoordinates()))},this.isSceneBuilder=function(){return!(!this.myData||!this.myData.isSceneBuilder)}}i.EventDispatcher.prototype.apply(d.prototype),d.prototype.constructor=d,d.prototype.getData=function(){return this.myData},d.prototype.setUUID=function(e){this.svfUUID=btoa(encodeURI((0,o.pathToURL)(e)))},d.prototype.getDocumentNode=function(){var e,t,r;return null!==(e=null===(t=this.getData())||void 0===t||null===(r=t.loadOptions)||void 0===r?void 0:r.bubbleNode)&&void 0!==e?e:null},d.prototype.getRoot=function(){var e=this.getData();return e&&e.instanceTree?e.instanceTree.root:null},d.prototype.getRootId=function(){var e=this.getData();return e&&e.instanceTree&&e.instanceTree.getRootId()||0},d.prototype.getUnitData=function(e){return console.warn("Model.getUnitData is deprecated and will be removed in a future release, use Autodesk.Viewing.Private.getUnitData() instead."),(0,c.getUnitData)(e)},d.prototype.getUnitScale=function(){return(0,c.convertUnits)(this.getUnitString(),c.ModelUnits.METER,1,1)},d.prototype.getUnitString=function(){var e;if(this.is2d())e=this.getMetadata("page_dimensions","model_units",null)||this.getMetadata("page_dimensions","page_units",null);else{var t=this.getData();e=t&&t.overriddenUnits?t.overriddenUnits:t&&t.scalingUnit?t.scalingUnit:this.getMetadata("distance unit","value",null)}return(0,c.fixUnitString)(e)},d.prototype.getDisplayUnit=function(){var e;if(this.is2d())e=this.getMetadata("page_dimensions","model_units",null)||this.getMetadata("page_dimensions","page_units",null);else{var t=this.getData();e=t&&t.scalingUnit?t.scalingUnit:this.getMetadata("default display unit","value",null)||this.getMetadata("distance unit","value",null)}return(0,c.fixUnitString)(e)},d.prototype.getSourceFileUnits=function(){var e=this.getDocumentNode();return null==e?void 0:e.getSourceFileUnits()},d.prototype.getMetadata=function(e,t,r){var n=this.getData();if(n){var i=n.metadata;if(i){var o=i[e];if(void 0!==o){if(!t)return o;var a=o[t];if(void 0!==a)return a}}}return r},d.prototype.getDefaultCamera=function(){var e=this.getData();if(!e)return null;var t=null,r=e.cameras?e.cameras.length:0;if(0<r){var n=this.getMetadata("default camera","index",null);if(null!==n&&e.cameras[n])t=e.cameras[n];else{for(var i=0;i<r;i++){var o=e.cameras[i];if(o.isPerspective){t=o;break}}t||(t=e.cameras[0])}}var a=this.getModelTransform();if(t&&a){var s=u.UnifiedCamera.copyViewParams(t);return u.UnifiedCamera.transformViewParams(s,a),u.UnifiedCamera.adjustOrthoCamera(s,this.getBoundingBox()),s}return t},d.prototype.isAEC=function(){return!!this.getData().loadOptions.isAEC},d.prototype.hasPageShadow=function(){return this.getData().hasPageShadow},d.prototype.getUpVector=function(){return this.getMetadata("world up vector","XYZ",null)},d.prototype.geomPolyCount=function(){var e=this.getGeometryList();return e?e.geomPolyCount:null},d.prototype.instancePolyCount=function(){var e=this.getGeometryList();return e?e.instancePolyCount:null},d.prototype.isLoadDone=function(e){var t=this.getData(),r=!e||!1!==t.texLoadDone;return!!(t&&t.loadDone&&r)},d.prototype.isObjectTreeCreated=function(){return!!this.getData().instanceTree},d.prototype.getPropertyDb=function(){var e=this.getData();return e&&e.propDbLoader},d.prototype.getProperties=function(e,t,r){var n=this.getPropertyDb();!n||e<=0?r&&r():n.getProperties(e,t,r)},d.prototype.getProperties2=function(e,t,r,n){var i=this.getPropertyDb();!i||e<=0?r&&r():i.getProperties2(e,t,r,n)},d.prototype.getBulkProperties=function(e,t,r,n){Array.isArray(t)&&(t={propFilter:t});var i=(t=t||{}).propFilter||null,o=t.ignoreHidden||!1,a=this.getPropertyDb();a?a.getBulkProperties(e,i,r,n,o):n&&n()},d.prototype.getBulkProperties2=function(e,t,r,n){var i=this.getPropertyDb();i?i.getBulkProperties2(e,t,r,n):n&&n()},d.prototype.getPropertySetAsync=function(e,t){var r=this;return new Promise((function(n,i){r.getPropertySet(e,n,i,t)}))},d.prototype.getPropertySet=function(e,t,r,n){var i=this.getPropertyDb();i||r&&r("Properties failed to load."),i.getPropertySet(e,n,(function(e){t(new h.PropertySet(e))}),r)},d.prototype.getExternalIdMapping=function(e,t){var r=this.getPropertyDb();r?r.getExternalIdMapping(e,t):t&&t()},d.prototype.getLayerToNodeIdMapping=function(e,t){var r=this.getPropertyDb();r?r.getLayerToNodeIdMapping(e,t):t&&t()},d.prototype.getObjectTree=function(e,t){var r=this.getData().instanceTree;if(r)e(r);else{var n=this.getPropertyDb();n?n.getObjectTree(e,t):t&&t()}},d.prototype.isObjectTreeLoaded=function(){var e=this.getPropertyDb();return!!e&&e.isObjectTreeLoaded()},d.prototype.search=function(e,t,r,n){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{searchHidden:!1},o=this.getPropertyDb();o?o.searchProperties(e,n,t,r,i):r&&r()},d.prototype.findProperty=function(e){var t=this.getPropertyDb();return t?t.findProperty(e):Promise.reject("Model doesn't have any properties.")};var f=function(e,t,r,n){var i,o,a,s,l,u,c=!1;a=n[r[r.length-1]].x,i=(s=n[r[r.length-1]].y)>=t;for(var h=0,d=r.length;h<d;++h)l=n[r[h]].x,i!=(o=(u=n[r[h]].y)>=t)&&(u-t)*(a-l)>=(l-e)*(s-u)==o&&(c=!c),i=o,a=l,s=u;return c};d.prototype.pointInPolygon=function(e,t,r,n){for(var i=!1,o=0;o<r.length;o++)f(e,t,r[o],n)&&(i=!i);return i},d.prototype.getPageToModelTransform=function(e){var t=this.getData();if(t.pageToModelTransform)return t.pageToModelTransform;var r=t,n=r.metadata.page_dimensions,i=r.viewports&&r.viewports[e];if(!i)return new THREE.Matrix4;r.viewportTransforms||(r.viewportTransforms=new Array(r.viewports.length));var o=r.viewportTransforms[e];if(o)return o;var s=new a.LmvMatrix4(!0).set(n.logical_width/n.page_width,0,0,n.logical_offset_x,0,n.logical_height/n.page_height,0,n.logical_offset_y,0,0,1,0,0,0,0,1),l=i.transform.slice();!function(e){var t=.001,r=e;if(Math.abs(r[0])<t)if(Math.abs(r[4])>t)for(var n=0;n<4;n++){var i=r[n];r[n]=r[n+4],r[n+4]=i}else for(var o=0;o<4;o++){var a=r[o];r[o]=r[o+8],r[o+8]=a}if(Math.abs(r[5])<t)for(var s=4;s<8;s++){var l=r[s];r[s]=r[s+4],r[s+4]=l}}(l);var u=new a.LmvMatrix4(!0);u.elements.set(l);var c=new a.LmvMatrix4(!0);return c.copy(u).invert(),c.multiply(s),r.viewportTransforms[e]=c,c},d.prototype.pageToModel=function(e,t,r,n){var i=this.getPageToModelTransform(r);function o(e){if(e){var t=(new THREE.Vector3).set(e.x,e.y,0).applyMatrix4(i);e.x=t.x,e.y=t.y,e.z=t.z}}n&&(i=i.clone().invert()),o(e),o(t)},d.prototype.pointInClip=function(e,t){for(var r=this.getData().clips,n=[],i=1;i<r.length;i++)if(i!==t){for(var o=[],a=[],s=r[i].contourCounts,l=r[i].points,u=0,c=[],h=0;h<s.length;h++){for(var d=0;d<s[h];d++)o.push(u),u++;a.push(o),o=[]}for(var f=0;f<l.length;f+=2){var p={x:l[f],y:l[f+1]};c.push(p)}this.pointInPolygon(e.x,e.y,a,c)&&n.push(i)}return n},d.prototype.getClip=function(e){for(var t=this.getData().clips,r=[],n=[],i=t[e].contourCounts,o=t[e].points,a=0,s=[],l=0;l<i.length;l++){for(var u=0;u<i[l];u++)r.push(a),a++;n.push(r),r=[]}for(var c=0;c<o.length;c+=2){var h={x:o[c],y:o[c+1]};s.push(h)}return{contours:n,points:s}},d.prototype.getTopoIndex=function(e){var t=this.getData();if(t&&t.fragments){var r=t.fragments.topoIndexes;if(r)return r[e]}},d.prototype.getTopology=function(e){return this.topology?this.topology[e]:null},d.prototype.hasTopology=function(){return!!this.topology},d.prototype.fetchTopology=function(e){if(this.topology)return Promise.resolve(this.topology);var t=this.getData();if(!t.topologyPath)return Promise.reject({error:"no-topology"});var r=e||((0,s.isMobileDevice)()?20:100);if(t.topologySizeMB>r)return Promise.reject({error:"topology-too-big",limitMB:r,topologyMB:t.topologySizeMB});if(!this.topologyPromise){var n=this;this.topologyPromise=new Promise((function(e,t){n.loader.fetchTopologyFile(n.getData().topologyPath,(function(r){r&&r.topology?(n.topology=r.topology,e(r.topology)):t(r)}))}))}return this.topologyPromise},d.prototype.hasGeometry=function(){var e=this.getData();return!!e&&(!!e.isLeaflet||(!!e.isSceneBuilder||e.fragments.length>0))},d.prototype.getFragmentPointer=function(e){return e?new l.FragmentPointer(this.getFragmentList(),e):null},d.prototype.clone=function(){var e=new d(this.myData);return e.topology=this.topology,e.topologyPromise=this.topologyPromise,e.svfUUID=this.svfUUID,e.defaultCameraHash=this.defaultCameraHash,e.loader=this.loader,e.setInnerAttributes(this.getInnerAttributes()),e},d.prototype.getSeedUrn=function(){var e;return(null===(e=this.loader)||void 0===e?void 0:e.svfUrn)||""},d.prototype.isNodeExists=function(e){var t,r,n=this.getInstanceTree();n?n.enumNodeChildren(e,(function(e){n.enumNodeFragments(e,(function(){t=!0}))}),!0):null!==(r=this.getFragmentList().fragments.dbId2fragId)&&void 0!==r&&r[e]&&(t=!0);return!!t},d.prototype.getModelKey=function(){var e=this.getDocumentNode();return e?e.getModelKey():this.getData().urn},d.prototype.dispose=function(){var e=this.getInstanceTree();null==e||e.dtor(),this.myData=null,this.topology=null,this.topologyPromise=null}},24032:(e,t,r)=>{"use strict";r.r(t),r.d(t,{ModelLayers:()=>a});var n=r(98926),i=r(37169),o={name:"root",id:"root",isLayer:!1,children:[],childCount:0};function a(e){this.viewer=e,this.matman=e.matman(),this.model=null,this.root=null,this.initialized=!1,this.layerToIndex={},this.indexToLayer=[null],this.nodeToLayer=[]}var s=a.prototype;function l(e){var t=e.getData(),r=o;return t&&t.layersRoot&&(r=t.layersRoot),Promise.resolve(r)}function u(e){if(e.getData().loadOptions.skipPropertyDb)return Promise.resolve(null);var t=e.getPropertyDb();return!t||e.getData().loadOptions.disable3DModelLayers?Promise.resolve(o):t.findLayers()}function c(e,t){var r=e.model,n=e.indexToLayer;if(r.is2d()){if(!r.getData().layerCount)return;var i=[];for(var o in e.layerToIndex)i.push(e.layerToIndex[o]);e.matman.setLayerVisible(i,t,r.id),e.viewer.invalidate(!0)}else{var a=[],s=t?e.viewer.visibilityManager.show:e.viewer.visibilityManager.hide;h(e,(function(e,i){n[i].visible!==t&&(a.push(e),1024===a.length&&(s(a,r),a.length=0))})),a.length>0&&s(a,r)}for(var l=n.length,u=1;u<l;++u){var c=n[u];c&&(c.visible=t)}}function h(e,t){var r=e.nodeToLayer;if(r&&r.length){var n=e.model.getData().instanceTree.nodeAccess;for(var i in n.dbIdToIndex){var o=r[n.dbIdToIndex[i]]||0;0!==o&&t(0|i,o)}}}function d(e,t){return"number"==typeof t?t:e.layerToIndex[t.name||t]||0}function f(e){return!e.layer.isLayer}function p(e){if(!e)return[];var t=[],r=0;m(e,(function(e){t.push(e),e.isLayer&&(r=Math.max(r,0|e.index))}));for(var n=0;n<t.length;++n)t[n].isLayer||(t[n].index=++r);return t}function m(e,t){for(var r=0;r<e.length;++r){var n=e[r];t(n),n.children&&m(n.children,t)}}s.addModel=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!this.initialized&&(e.is2d()||!t)){var r=function(t){if(t){var r=this.model.getData().instanceTree;t.children=t.children||[];var i=p(t.children);t.childCount=i.length,this.indexToLayer=new Array(t.childCount+1),this.indexToLayer[0]=null;for(var o=0;o<t.childCount;++o){var a=i[o],s=null==a.visible||a.visible;this.layerToIndex[a.name]=a.index,this.indexToLayer[a.index]={layer:a,visible:s}}if(!this.model.is2d()&&0!==t.childCount){this.nodeToLayer=t.childCount<=256?new Uint8Array(r.nodeAccess.getNumNodes()):new Uint16Array(r.nodeAccess.getNumNodes());var l=function(e){if(this.model){var t=this.model.getData().instanceTree;for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))for(var n=this.layerToIndex[r],i=e[r],o=0,a=i.length;o<a;++o){var s=t.nodeAccess.getIndex(i[o]);this.nodeToLayer[s]=n}}}.bind(this),u=function(){n.logger.warn("ModelLayers error: coudn't get layers from property database.")}.bind(this);e.getLayerToNodeIdMapping(l,u)}}}.bind(this),a=function(t){var r,n=this;this.root=t,this.initialized=!0,!this.activateLayerState("Initial")&&null!==(r=this.model)&&void 0!==r&&r.is2d()&&this.indexToLayer.forEach((function(e){e&&!e.visible&&n.setLayerVisible(e.layer,!1)})),this.viewer.api.dispatchEvent({type:i.MODEL_LAYERS_LOADED_EVENT,model:e,root:t})}.bind(this);this.model=e,(e.is2d()?l(e):u(e)).then((function(e){r(e),a(e)})).catch((function(e){n.logger.warn(e),a(o)}))}},s.removeModel=function(e){this.model===e&&(this.model=null,this.root=null,this.initialized=!1,this.layerToIndex={},this.indexToLayer=[null],this.nodeToLayer=[])},s.getRoot=function(){return this.initialized||n.logger.warn("Autodesk.Viewing.ModelLayers.getRoot couldn't peform action, layers are still being loaded"),this.root},s.showAllLayers=function(){this.initialized?c(this,!0):n.logger.warn("Autodesk.Viewing.ModelLayers.showAllLayers couldn't peform action, layers are still being loaded")},s.hideAllLayers=function(){this.initialized?c(this,!1):n.logger.warn("Autodesk.Viewing.ModelLayers.hideAllLayers couldn't peform action, layers are still being loaded")},s.isLayerVisible=function(e){if(!this.initialized)return n.logger.warn("Autodesk.Viewing.ModelLayers.isLayerVisible couldn't peform action, layers are still being loaded"),!1;var t=d(this,e),r=this.indexToLayer[t];if(f(r)){for(var i=r.layer.children,o=0;o<i.length;++o){var a=i[o].index;if(this.indexToLayer[a].visible)return!0}return!1}return r.visible},s.setLayerVisible=function(e,t){if(this.initialized){for(var r=(e=Array.isArray(e)?e:[e]).map(function(e){return d(this,e)}.bind(this)),i=r.length,o=0;o<i;++o){var a=r[o],s=this.indexToLayer[a];if(f(s))s.layer.children.forEach((function(e){r.push(e.index)}))}var l=this.model,u=this.indexToLayer;if(l.is2d())this.matman.setLayerVisible(r,t,l.id),this.viewer.invalidate(!0);else{var c=u.map((function(e){return!(null!==e&&-1!==r.indexOf(e.layer.index)&&e.visible!==t)})),p=[],m=t?this.viewer.visibilityManager.show:this.viewer.visibilityManager.hide;h(this,(function(e,t){c[t]||(p.push(e),1024===p.length&&(m(p,l),p.length=0))})),p.length>0&&m(p,l)}for(var g=r.length,v=0;v<g;++v){var y=this.indexToLayer[r[v]];y&&(y.visible=t)}}else n.logger.warn("Autodesk.Viewing.ModelLayers.setLayersVisible couldn't peform action, layers are still being loaded")},s.getVisibleLayerIndices=function(){if(!this.initialized)return n.logger.warn("Autodesk.Viewing.ModelLayers.getVisibleLayerIndices couldn't peform action, layers are still being loaded"),[];for(var e=[],t=this.indexToLayer,r=t.length,i=1;i<r;++i){var o=t[i];o&&o.visible&&!f(o)&&e.push(o.layer.index)}return e},s.allLayersVisible=function(){if(!this.initialized)return!0;for(var e=this.indexToLayer,t=e.length,r=1;r<t;++r){var n=e[r];if(n&&!n.visible)return!1}return!0},s.activateLayerState=function(e){if(!this.initialized)return n.logger.warn("Autodesk.Viewing.ModelLayers.activateLayerState couldn't peform action, layers are still being loaded"),!1;if(!this.model||this.model.is3d()||!e)return!1;var t,r=this.model.getData().metadata,i=null==r?void 0:r.layer_states;if(!i)return!1;for(t=0;t<i.length&&i[t].name!==e;t++);if(t>=i.length)return!1;var o=i[t].visible_layers,a={};if(o&&0<o.length)for(var s=0;s<o.length;s++)a[o[s]]=1;var l=[],u=[];for(var c in r.layers){var h=r.layers[c].name;c|=0,1===a[h]?l.push(c):u.push(c)}return this.setLayerVisible(l,!0),this.setLayerVisible(u,!1),!0},s.getLayerStates=function(){function e(e,t){var r=Object.getOwnPropertyNames(e),n=Object.getOwnPropertyNames(t);if(r.length!==n.length)return!1;for(var i=0;i<r.length;++i){var o=r[i];if(e[o]!==t[o])return!1}return!0}if(!this.initialized)return n.logger.warn("Autodesk.Viewing.ModelLayers.getLayerStates couldn't peform action, layers are still being loaded"),null;var t,r=this.model,i=r?r.getData().metadata:null,o=i?i.layers:null,a=i?i.layer_states:null;if(this.model.is3d()||!o||!a)return null;var s={},l={};for(var u in o)if(Object.prototype.hasOwnProperty.call(o,u)){var c=parseInt(u),h=o[u];s[t="string"==typeof h?h:h.name]=!0,this.isLayerVisible(c)&&(l[t]=!0)}for(var d=[],f=0;f<a.length;++f){var p=a[f],m=p.visible_layers,g={};if(!p.hidden){if(m&&0<m.length)for(var v=0;v<m.length;++v)t=m[v],Object.prototype.hasOwnProperty.call(s,t)&&(g[t]=!0);d.push({name:p.name,description:p.description,active:e(l,g)})}}return 0<d.length?d:null}},99248:(e,t,r)=>{"use strict";r.r(t),r.d(t,{estimateMemUsage:()=>u,ModelMemoryTracker:()=>c});function n(e){return e&&e.byteLength||0}function i(e){return n(e.boxes)+n(e.transforms)+n(e.fragId2dbId)+n(e.geomDataIndexes)+n(e.materials)}function o(e){return n(e.geomids)+n(e.materialids)+n(e.vizflags)+(e.boxes!==e.fragments.boxes?n(e.boxes):0)+(e.transforms!==e.fragments.transforms?n(e.transforms):0)}function a(e){return n(e.nodes.nodesRaw?e.nodes.nodesRaw:e.nodes)+n(e.primitives)}var s=!1;function l(e){for(var t,r=Autodesk.Viewing.Private,l=0,u=0;u<e.length;u++){var c=e[u],h=c.getData();if(h){var d=c.getConsolidation();if(d&&(l+=d.byteSize),c.isLeaflet())s||(console.warn("Memory tracking not implemented for leaflets."),s=!0);else{if(!h.isOTG)l+=c.getGeometryList().geomMemory;var f=h.fragments;f&&(l+=i(f));var p=c.getFragmentList();p&&(l+=o(p));var m=h.bvh;m&&(l+=a(m));var g=h.instanceTree;g&&(l+=(t=void 0,n((t=g.nodeAccess).children)+n(t.nameSuffixes)+n(t.names)+n(t.nodeBoxes)+n(t.nodes)))}}}return isFinite(l)||r.logger.warn("Memory estimate result was not a number"),l}function u(e){var t=e.impl.geomCache(),r=t?t.byteSize:0,n=e.impl.modelQueue(),i=n.getModels(),o=n.getHiddenModels();return r+l(i)+l(o)}function c(e,t){var r=e,n=0,i=t||1048576e3;function o(e){var t;return e.lruTimestamp===n||(null===(t=e.getData())||void 0===t?void 0:t.loadOptions.keepHiddenModel)}this.updateModelTimestamps=function(e){n++;for(var t=0;t<e.length;t++){e[t].lruTimestamp=n}},this.memoryExceeded=function(){return u(r)>=i},this.getMemLimit=function(){return i},this.cleanup=function(e){var t=e||r.impl.unloadModel.bind(r.impl);if(this.memoryExceeded()){for(var n=function(){for(var e=r.impl.modelQueue().getHiddenModels(),t=[],n=0;n<e.length;n++){var i=e[n];o(i)||t.push(i)}return t.sort((function(e,t){return e.lurTimestamp-t.lruTimestamp})),t}(),i=0;i<n.length;i++){var a=n[i];if(a.isConsolidated&&(a.unconsolidate(),!this.memoryExceeded()))return}var s=r.impl.geomCache();for(i=0;i<n.length;i++)if(t(a=n[i]),s&&s.cleanup(),!this.memoryExceeded())return}}}},12032:(e,t,r)=>{"use strict";function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}r.r(t),r.d(t,{OverlayManager:()=>i});var i=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.impl=t}var t,r,i;return t=e,(r=[{key:"dtor",value:function(){this.impl=null}},{key:"addScene",value:function(e){return!!e&&(Object.prototype.hasOwnProperty.call(this.impl.overlayScenes,e)||this.impl.createOverlayScene(e),!0)}},{key:"removeScene",value:function(e){return!!e&&(this.impl.removeOverlayScene(e),!0)}},{key:"clearScene",value:function(e){this.impl.clearOverlay(e)}},{key:"hasScene",value:function(e){return!!e&&Object.prototype.hasOwnProperty.call(this.impl.overlayScenes,e)}},{key:"addMesh",value:function(e,t){return!!(e&&t&&Object.prototype.hasOwnProperty.call(this.impl.overlayScenes,t))&&(e=Array.isArray(e)?e:[e],this.impl.addMultipleOverlays(t,e),!0)}},{key:"removeMesh",value:function(e,t){return!!(e&&t&&Object.prototype.hasOwnProperty.call(this.impl.overlayScenes,t))&&(e=Array.isArray(e)?e:[e],this.impl.removeMultipleOverlays(t,e),!0)}},{key:"hasMesh",value:function(e,t){var r=this.impl.overlayScenes[t];if(!r)return!1;for(var n=r.scene.children,i=0,o=n.length;i<o;++i)if(n[i]===e)return!0;return!1}}])&&n(t.prototype,r),i&&n(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}()},55412:(e,t,r)=>{"use strict";r.r(t),r.d(t,{Prefs3D:()=>n,Prefs2D:()=>i,Prefs:()=>o,VIEW_TYPES:()=>a});var n={VIEW_CUBE:"viewCube",VIEW_CUBE_COMPASS:"viewCubeCompass",VIEW_TYPE:"viewType",ALWAYS_USE_PIVOT:"alwaysUsePivot",ZOOM_TOWARDS_PIVOT:"zoomTowardsPivot",SELECTION_SETS_PIVOT:"selectionSetsPivot",REVERSE_HORIZONTAL_LOOK_DIRECTION:"reverseHorizontalLookDirection",REVERSE_VERTICAL_LOOK_DIRECTION:"reverseVerticalLookDirection",ORBIT_PAST_WORLD_POLES:"orbitPastWorldPoles",CLICK_TO_SET_COI:"clickToSetCOI",GHOSTING:"ghosting",OPTIMIZE_NAVIGATION:"optimizeNavigation",AMBIENT_SHADOWS:"ambientShadows",ANTIALIASING:"antialiasing",GROUND_SHADOW:"groundShadow",GROUND_REFLECTION:"groundReflection",LINE_RENDERING:"lineRendering",EDGE_RENDERING:"edgeRendering",LIGHT_PRESET:"lightPreset",ENV_MAP_BACKGROUND:"envMapBackground",FIRST_PERSON_TOOL_POPUP:"firstPersonToolPopup",BIM_WALK_TOOL_POPUP:"bimWalkToolPopup",BIM_WALK_NAVIGATOR_TYPE:"bimWalkNavigatorType",BIM_WALK_GRAVITY:"bimWalkGravity",DEFAULT_NAVIGATION_TOOL_3D:"defaultNavigationTool3D",SELECTION_MODE:"selectionMode",ENABLE_CUSTOM_ORBIT_TOOL_CURSOR:"enableCustomOrbitToolCursor",EXPLODE_STRATEGY:"explodeStrategy",FORCE_DOUBLE_SIDED:"forceDoubleSided",DISPLAY_SECTION_HATCHES:"displaySectionHatches"},i={GRAYSCALE:"grayscale",SWAP_BLACK_AND_WHITE:"swapBlackAndWhite",LOADING_ANIMATION:"loadingAnimation",FORCE_PDF_CALIBRATION:"forcePDFCalibration",FORCE_LEAFLET_CALIBRATION:"forceLeafletCalibration",DISABLE_PDF_HIGHLIGHT:"disablePdfHighlight"},o={PROGRESSIVE_RENDERING:"progressiveRendering",OPEN_PROPERTIES_ON_SELECT:"openPropertiesOnSelect",POINT_RENDERING:"pointRendering",BACKGROUND_COLOR_PRESET:"backgroundColorPreset",REVERSE_MOUSE_ZOOM_DIR:"reverseMouseZoomDir",LEFT_HANDED_MOUSE_SETUP:"leftHandedMouseSetup",FUSION_ORBIT:"fusionOrbit",FUSION_ORBIT_CONSTRAINED:"fusionOrbitConstrained",WHEEL_SETS_PIVOT:"wheelSetsPivot",RESTORE_SESSION_MEASUREMENTS:"restoreMeasurements",DISPLAY_UNITS:"displayUnits",DISPLAY_UNITS_PRECISION:"displayUnitsPrecision",KEY_MAP_CMD:"keyMapCmd",ZOOM_DRAG_SPEED:"zoomDragSpeed",ZOOM_SCROLL_SPEED:"zoomScrollSpeed"},a={DEFAULT:0,ORTHOGRAPHIC:1,PERSPECTIVE:2,PERSPECTIVE_ORTHO_FACES:3}},91217:(e,t,r)=>{"use strict";r.r(t),r.d(t,{Preferences:()=>p});var n=r(37169),i=r(98926),o=r(35449),a=r(50041),s=r(19255);function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}function u(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return c(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return c(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function h(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function d(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function f(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var p=function(){function e(t,r){var i=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.viewer=t;this.options={},this.storageCache={},this.setGlobalManager(t.globalManager),this.setWebStorageKey("Default"),"string"==typeof r&&(this.options={prefix:r}),this.options=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?h(Object(r),!0).forEach((function(t){d(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):h(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},r),this.options.prefix||(this.options.prefix="Autodesk.Viewing.Preferences."),Object.prototype.hasOwnProperty.call(this.options,"localStorage")||(this.options.localStorage=!0),this.defaults={},this.callbacks={},this.tags={},this.useLocalStorage=this.options.localStorage&&s.LocalStorage.isSupported(),t.addEventListener(n.PREF_CHANGED_EVENT,(function(e){var t=i.callbacks[e.name];t&&t.forEach((function(t){var r=t.changed;r&&"function"==typeof r&&r(e.value)}))})),t.addEventListener(n.PREF_RESET_EVENT,(function(e){var t=i.callbacks[e.name];t&&t.forEach((function(t){var r=t.reset;r&&"function"==typeof r&&r(e.value)}))}));return new Proxy(this,{get:function(e,t){return t in e?e[t]:e.storageCache[t]}})}var t,r,o;return t=e,(r=[{key:"setWebStorageKey",value:function(e){this.storageKey=e}},{key:"webStorage",value:function(e,t){if(this.useLocalStorage){if(this.hasTag(e,"no-storage"))return;var r=this.getLocalStoragePrefix()+this.storageKey,n=s.LocalStorage.getItem(r);if(n=JSON.parse(n||"{}"),void 0!==t)t instanceof a.EnumType&&(t=t.toString()),n[e]=t,s.LocalStorage.setItem(r,JSON.stringify(n));else if(void 0!==(t=n[e]))try{"__enum"===(t=JSON.parse(t)).type&&(t=a.EnumType.deSerialize(t))}catch(e){i.logger.log("Preferences: Cannot deserialize value ="+t),t=void 0}return t}}},{key:"getPrefFromLocalStorage",value:function(e){return this.webStorage(e)}},{key:"setPrefInLocalStorage",value:function(e,t){return this.webStorage(e,t)}},{key:"addPref",value:function(e,t){if("string"==typeof e&&"function"!=typeof this.storageCache[e]){t instanceof a.EnumType&&(t=t.clone());var r=this.webStorage(e);this.storageCache[e]=r||t,this.tags[e]={}}else i.logger.log("Preferences: invalid name="+e)}},{key:"load",value:function(e){for(var t in this.defaults=e,this.defaults)Object.prototype.hasOwnProperty.call(this.defaults,t)&&this.addPref(t,this.defaults[t])}},{key:"addTags",value:function(e,t){if(!t||!e)return!1;t=Array.isArray(t)?t:[t];for(var r=0;r<t.length;++r)this.tag(t[r],e);return!0}},{key:"tag",value:function(e,t){if(e){t?Array.isArray(t)||(t=[t]):t=Object.keys(this.defaults);for(var r=0;r<t.length;++r)this.tags[t[r]]&&(this.tags[t[r]][e]=!0)}}},{key:"untag",value:function(e,t){if(e){t?Array.isArray(t)||(t=[t]):t=Object.keys(this.defaults);for(var r=0;r<t.length;++r)this.tags[t[r]]&&(this.tags[t[r]][e]=!1)}}},{key:"hasTag",value:function(e,t){var r=this.tags[e];return!!r&&!0===r[t]}},{key:"add",value:function(e,t,r,o){return!Object.prototype.hasOwnProperty.call(this.defaults,e)||o?(this.setDefault(e,t),this.addPref(e,t),this.addTags(e,r),o&&this.viewer.dispatchEvent({type:n.PREF_CHANGED_EVENT,name:e,value:this.get(e)}),!0):(i.logger.log("Preferences: "+e+" already exists"),!1)}},{key:"setDefault",value:function(e,t){e&&null!=t&&(t instanceof a.EnumType?this.defaults[e]=t.clone():this.defaults[e]=t)}},{key:"remove",value:function(e,t){return!!Object.prototype.hasOwnProperty.call(this.defaults,e)&&(delete this.defaults[e],delete this.tags[e],this.storageCache&&delete this.storageCache[e],t&&this.deleteFromWebStorage(e),!0)}},{key:"deleteFromWebStorage",value:function(e){if(this.useLocalStorage){var t=this.getLocalStoragePrefix()+this.storageKey,r=s.LocalStorage.getItem(t);delete(r=JSON.parse(r||"{}"))[e],s.LocalStorage.setItem(t,JSON.stringify(r))}}},{key:"clearWebStorage",value:function(){var e=this.getLocalStoragePrefix();if(this.useLocalStorage){var t,r=u(s.LocalStorage.getAllKeys());try{for(r.s();!(t=r.n()).done;){var n=t.value;-1!==n.indexOf(e)&&s.LocalStorage.removeItem(n)}}catch(e){r.e(e)}finally{r.f()}}}},{key:"reset",value:function(e,t){for(var r in e&&void 0===t&&(t=!0),this.defaults)if(Object.prototype.hasOwnProperty.call(this.defaults,r)){if(e){var i=!!this.tags[r][e];if(t&&!i||!t&&i)continue}this.set(r,this.defaults[r],!1)&&this.viewer.dispatchEvent({type:n.PREF_RESET_EVENT,name:r,value:this.get(r)}),this.deleteFromWebStorage(r)}}},{key:"getLocalStoragePrefix",value:function(){return this.options.prefix}},{key:"get",value:function(e){return this.storageCache[e]instanceof a.EnumType?this.storageCache[e].value:this.storageCache[e]}},{key:"set",value:function(e,t,r){var i,o,s,u=t instanceof a.EnumType?t.value:t;return i=this.get(e),o=u,(s=function(e){return"object"===l(e)?JSON.stringify(e):e})(i)!==s(o)&&(this.storageCache[e]instanceof a.EnumType?this.storageCache[e].value=u:t instanceof a.EnumType?this.storageCache[e]=t.clone():this.storageCache[e]=u,this.webStorage(e,this.storageCache[e]),(void 0===r||r)&&this.viewer.dispatchEvent({type:n.PREF_CHANGED_EVENT,name:e,value:this.get(e)}),!0)}},{key:"dispatchEvent",value:function(e){var t=this.get(e),r=n.PREF_CHANGED_EVENT;this.viewer.dispatchEvent({type:r,name:e,value:t})}},{key:"addListeners",value:function(e,t,r){this.callbacks[e]||(this.callbacks[e]=[]),r||(r=t),this.callbacks[e].push({changed:t,reset:r})}},{key:"removeListeners",value:function(e,t,r){if(void 0!==this.callbacks[e])if(t||r){r||(r=t);for(var n=0;n<this.callbacks[e].length;++n)if(this.callbacks[e][n].changed===t&&this.callbacks[e][n].reset===r){this.callbacks[e].splice(n,1);break}}else delete this.callbacks[e]}},{key:"clearListeners",value:function(){this.callbacks={}}},{key:"setUseLocalStorage",value:function(e){this.useLocalStorage=!!e}}])&&f(t.prototype,r),o&&f(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}();o.GlobalManagerMixin.call(p.prototype)},41772:(e,t,r)=>{"use strict";r.r(t),r.d(t,{Profile:()=>s});var n=r(55412),i=r(19255);function o(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return a(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return a(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,l=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){l=!0,o=e},f:function(){try{s||null==r.return||r.return()}finally{if(l)throw o}}}}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function s(e){if(e){var t=Autodesk.Viewing,r=t.ProfileSettings.Default,a=[];if(this.name=Object.prototype.hasOwnProperty.call(e,"name")?e.name:"Custom",this.label=e.label,this.description=e.description,this.storageVersion="2.0",this.persistent=Array.isArray(e.persistent)?e.persistent:r.persistent,this.settings=Object.assign({},r.settings),Object.prototype.hasOwnProperty.call(e,"settings")){var s=e.settings;a=Object.keys(s),this.settings=Object.assign(this.settings,s)}var l=[],u=[];if(Object.prototype.hasOwnProperty.call(e,"extensions")){var c=e.extensions.load,h=e.extensions.unload;l=c?c.slice():l,u=h?h.slice():u}this.extensions={load:l,unload:u},this.apply=function(e){var r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!e)return!1;var s=e.getLocalStoragePrefix()+"StorageVersion",l="Autodesk.Viewing.ProfileName",u=function(){return!!e.useLocalStorage&&(!i.LocalStorage.getItem(s)&&!!i.LocalStorage.getItem(l))},c=function(){var t,r={},n=i.LocalStorage.getItem(l),a=e.getLocalStoragePrefix(),s=o(i.LocalStorage.getAllKeys());try{for(s.s();!(t=s.n()).done;){var u=t.value;if(-1!==u.indexOf(a))try{r[u.split(".").pop()]=JSON.parse(i.LocalStorage.getItem(u)),i.LocalStorage.removeItem(u)}catch(e){console.log("Cound't convert preference to new format: ".concat(u))}}}catch(e){s.e(e)}finally{s.f()}i.LocalStorage.setItem(a+n,JSON.stringify(r)),i.LocalStorage.removeItem(l)};u()&&c();var h=e.getLocalStoragePrefix()+"StorageVersion";i.LocalStorage.setItem(h,this.storageVersion);var d=e.getLocalStoragePrefix()+"CurrentProfile";i.LocalStorage.setItem(d,this.name),e.setWebStorageKey(this.name);var f=this.settings,p=[t.ProfileSettings.Default.name,t.ProfileSettings.AEC.name],m=Object.values(n.Prefs3D),g=Object.values(n.Prefs2D);for(var v in f)if(Object.prototype.hasOwnProperty.call(f,v)){var y=f[v],b=-1!==a.indexOf(v)&&-1===p.indexOf(this.name)?["ignore-producer"]:[];-1!==m.indexOf(v)?b.push("3d"):-1!==g.indexOf(v)?b.push("2d"):(b.push("2d"),b.push("3d")),-1===this.persistent.indexOf(v)&&b.push("no-storage");var x=e.webStorage(v),_=e.get(v);if(void 0!==x){x!=_&&(e.add(v,x,b,!0),e.setDefault(v,y));continue}if(void 0!==_){e.addTags(v,b),_!==y&&r&&e.set(v,y);continue}e.add(v,y,b,!0)}return!0}}}},9322:(e,t,r)=>{"use strict";r.r(t),r.d(t,{ProfileManager:()=>a});var n=r(98926),i=r(41772);function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.registered={};var t=Autodesk.Viewing.ProfileSettings;this.PROFILE_DEFAULT=new i.Profile(t.Default),this.registerProfile("default",this.PROFILE_DEFAULT),this.PROFILE_AEC=new i.Profile(t.AEC),this.registerProfile("rvt",this.PROFILE_AEC),this.registerProfile("ifc",this.PROFILE_AEC),this.PROFILE_NAVIS=new i.Profile(t.Navis),this.registerProfile("nwc",this.PROFILE_NAVIS),this.registerProfile("nwd",this.PROFILE_NAVIS),this.PROFILE_FLUENT=new i.Profile(t.Fluent),this.registerProfile("fluent",this.PROFILE_FLUENT)}var t,r,a;return t=e,(r=[{key:"registerProfile",value:function(e,t){t?(e=e||"default",this.registered[e]=t instanceof i.Profile?t:new i.Profile(t)):n.logger.log("ProfileManager: missing profileSettings when registering a profile.")}},{key:"unregisterProfile",value:function(e){e?delete this.registered[e]:n.logger.log("ProfileManager: missing fileExt when unregistering a profile.")}},{key:"getProfiles",value:function(){return Object.assign({},this.registered)}},{key:"getProfileOrDefault",value:function(e){if(!e)return n.logger.log("ProfileManager: missing fileExt for getProfile. Returning the default Profile."),this.registered.default;var t=this.registered[e];return t||(n.logger.log("ProfileManager: No profile registered for ".concat(e,". Returning the default Profile.")),this.registered.default)}}])&&o(t.prototype,r),a&&o(t,a),Object.defineProperty(t,"prototype",{writable:!1}),e}()},50041:(e,t,r)=>{"use strict";r.r(t),r.d(t,{EnumType:()=>c,DefaultSettings:()=>d,ProfileSettings:()=>y});var n=r(55412),i=r(98926),o=r(82197),a=r(84998),s=r(95018),l=r(5130);function u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var c=function(){function e(t,r){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),!Array.isArray(t)||0===t.length)throw new Error("Invalid ".concat(t));this.values=new Set(t),this.current=t.includes(r)?r:t[0]}var t,r,n;return t=e,n=[{key:"deSerialize",value:function(t){if("__enum"===t.type)return new e(t.values,t.current)}}],(r=[{key:"value",get:function(){return this.current},set:function(e){this.values.has(e)&&(this.current=e)}},{key:"clone",value:function(){return e.deSerialize(JSON.parse(this.toString()))}},{key:"toString",value:function(){return JSON.stringify({type:"__enum",values:Array.from(this.values),current:this.current})}}])&&u(t.prototype,r),n&&u(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}(),h={};h[n.Prefs3D.AMBIENT_SHADOWS]=!0,h[n.Prefs3D.ANTIALIASING]=!(0,a.isMobileDevice)(),h[n.Prefs3D.GROUND_SHADOW]=!0,h[n.Prefs3D.GROUND_REFLECTION]=!1,h[n.Prefs3D.GHOSTING]=!0,h[n.Prefs3D.VIEW_CUBE]=!(0,a.isMobileDevice)(),h[n.Prefs3D.VIEW_CUBE_COMPASS]=!1,h[n.Prefs3D.VIEW_TYPE]=n.VIEW_TYPES.DEFAULT,h[n.Prefs3D.LINE_RENDERING]=!0,h[n.Prefs3D.LIGHT_PRESET]=s.DefaultLightPreset,h[n.Prefs3D.EDGE_RENDERING]=!1,h[n.Prefs3D.REVERSE_HORIZONTAL_LOOK_DIRECTION]=!1,h[n.Prefs3D.REVERSE_VERTICAL_LOOK_DIRECTION]=!1,h[n.Prefs3D.ALWAYS_USE_PIVOT]=!1,h[n.Prefs3D.ZOOM_TOWARDS_PIVOT]=!1,h[n.Prefs3D.ORBIT_PAST_WORLD_POLES]=!0,h[n.Prefs3D.CLICK_TO_SET_COI]=!1,h[n.Prefs3D.OPTIMIZE_NAVIGATION]=(0,a.isMobileDevice)(),h[n.Prefs3D.ENV_MAP_BACKGROUND]=!1,h[n.Prefs3D.FIRST_PERSON_TOOL_POPUP]=!0,h[n.Prefs3D.BIM_WALK_TOOL_POPUP]=!0,h[n.Prefs3D.BIM_WALK_NAVIGATOR_TYPE]="default",h[n.Prefs3D.BIM_WALK_GRAVITY]=!0,h[n.Prefs3D.DEFAULT_NAVIGATION_TOOL_3D]="default",h[n.Prefs3D.SELECTION_MODE]=o.SelectionMode.LEAF_OBJECT,h[n.Prefs3D.ENABLE_CUSTOM_ORBIT_TOOL_CURSOR]=!0,h[n.Prefs3D.EXPLODE_STRATEGY]="hierarchy",h[n.Prefs3D.SELECTION_SETS_PIVOT]=!1,h[n.Prefs3D.FORCE_DOUBLE_SIDED]=!1,h[n.Prefs3D.DISPLAY_SECTION_HATCHES]=!0,h[n.Prefs2D.GRAYSCALE]=!1,h[n.Prefs2D.SWAP_BLACK_AND_WHITE]=!1,h[n.Prefs2D.LOADING_ANIMATION]=!1,h[n.Prefs2D.FORCE_PDF_CALIBRATION]=!1,h[n.Prefs2D.FORCE_LEAFLET_CALIBRATION]=!0,h[n.Prefs2D.DISABLE_PDF_HIGHLIGHT]=!1,h[n.Prefs.PROGRESSIVE_RENDERING]=!0,h[n.Prefs.OPEN_PROPERTIES_ON_SELECT]=!1,h[n.Prefs.POINT_RENDERING]=!0,h[n.Prefs.BACKGROUND_COLOR_PRESET]=null,h[n.Prefs.REVERSE_MOUSE_ZOOM_DIR]=!1,h[n.Prefs.LEFT_HANDED_MOUSE_SETUP]=!1,h[n.Prefs.FUSION_ORBIT]=!0,h[n.Prefs.FUSION_ORBIT_CONSTRAINED]=!0,h[n.Prefs.WHEEL_SETS_PIVOT]=!1,h[n.Prefs.RESTORE_SESSION_MEASUREMENTS]=!0,h[n.Prefs.DISPLAY_UNITS]=new c(l.displayUnitsEnum),h[n.Prefs.DISPLAY_UNITS_PRECISION]=new c(l.displayUnitsPrecisionEnum),h[n.Prefs.KEY_MAP_CMD]=!0;var d=h,f={name:"Default",label:"Manufacturing (Default)",description:"Default Viewer settings"};f.settings=h,f.persistent=[n.Prefs3D.ALWAYS_USE_PIVOT,n.Prefs3D.ZOOM_TOWARDS_PIVOT,n.Prefs3D.REVERSE_HORIZONTAL_LOOK_DIRECTION,n.Prefs3D.REVERSE_VERTICAL_LOOK_DIRECTION,n.Prefs3D.ORBIT_PAST_WORLD_POLES,n.Prefs3D.CLICK_TO_SET_COI,n.Prefs3D.GHOSTING,n.Prefs3D.OPTIMIZE_NAVIGATION,n.Prefs3D.AMBIENT_SHADOWS,n.Prefs3D.ANTIALIASING,n.Prefs3D.GROUND_SHADOW,n.Prefs3D.GROUND_REFLECTION,n.Prefs3D.FIRST_PERSON_TOOL_POPUP,n.Prefs3D.BIM_WALK_TOOL_POPUP,n.Prefs3D.BIM_WALK_GRAVITY,n.Prefs3D.VIEW_TYPE,n.Prefs3D.SELECTION_MODE,n.Prefs2D.SWAP_BLACK_AND_WHITE,n.Prefs2D.LOADING_ANIMATION,n.Prefs.OPEN_PROPERTIES_ON_SELECT,n.Prefs.REVERSE_MOUSE_ZOOM_DIR,n.Prefs.LEFT_HANDED_MOUSE_SETUP,n.Prefs.WHEEL_SETS_PIVOT,n.Prefs.KEY_MAP_CMD,n.Prefs.DISPLAY_UNITS,n.Prefs.DISPLAY_UNITS_PRECISION],f.extensions={load:[],unload:[]};var p=v(f);p.name="AEC",p.label="Construction (AEC)",p.description="A common set of preferences designed for the Construction industry",p.settings[n.Prefs.REVERSE_MOUSE_ZOOM_DIR]=!0,p.settings[n.Prefs3D.EDGE_RENDERING]=!(0,a.isMobileDevice)(),p.settings[n.Prefs3D.LIGHT_PRESET]=(0,a.getGlobal)().DefaultLightPresetAec||"Boardwalk",p.settings[n.Prefs3D.ENV_MAP_BACKGROUND]=!0,p.settings[n.Prefs3D.VIEW_CUBE_COMPASS]=!0,p.settings[n.Prefs3D.SELECTION_SETS_PIVOT]=!0,p.extensions={load:[],unload:[]};var m=v(p);m.name="Fluent",m.label="Design Collaboration",m.description="User experience that matches Design Collaboration",m.settings[n.Prefs.WHEEL_SETS_PIVOT]=!0,m.settings[n.Prefs.RESTORE_SESSION_MEASUREMENTS]=!1,m.settings[n.Prefs2D.FORCE_PDF_CALIBRATION]=!0,m.settings[n.Prefs3D.ALWAYS_USE_PIVOT]=!0,m.settings[n.Prefs3D.ENABLE_CUSTOM_ORBIT_TOOL_CURSOR]=!1,m.extensions={load:[],unload:[]},m.persistent.splice(m.persistent.indexOf(n.Prefs3D.VIEW_TYPE),1);var g=v(p);function v(e){e||(i.logger.log("ProfileSettings.clone: missing profileSettings, using DefaultProfileSettings..."),e=f);var t={};return t.settings=Object.assign({},e.settings),t.extensions={},Object.prototype.hasOwnProperty.call(e,"extensions")?(t.extensions.load=Object.prototype.hasOwnProperty.call(e.extensions,"load")?e.extensions.load.slice():[],t.extensions.unload=Object.prototype.hasOwnProperty.call(e.extensions,"unload")?e.extensions.unload.slice():[]):t.extensions={load:[],unload:[]},t.persistent=e.persistent.slice(),t}g.name="Navis",g.label="Navisworks",g.description="Provides a user experience similar to Autodesk Navisworks desktop application",g.settings[n.Prefs3D.BIM_WALK_TOOL_POPUP]=!1,g.settings[n.Prefs3D.BIM_WALK_NAVIGATOR_TYPE]="aec",g.settings[n.Prefs3D.DEFAULT_NAVIGATION_TOOL_3D]="extractor_defined";var y={Default:f,AEC:p,Fluent:m,Navis:g,clone:v}},18588:(e,t,r)=>{"use strict";r.r(t),r.d(t,{ProgressState:()=>n});var n={ROOT_LOADED:0,LOADING:1,RENDERING:2}},65522:(e,t,r)=>{"use strict";r.r(t),r.d(t,{PropertySet:()=>s});var n=r(51137);function i(e){return function(e){if(Array.isArray(e))return o(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return o(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return o(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var s=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.map=t}var t,r,o;return t=e,(r=[{key:"forEach",value:function(e){if(e)for(var t in this.map)"__selected_dbIds__"!==t&&e(t,this.map[t])}},{key:"getAggregation",value:function(e){if(!e)return null;if("string"==typeof e&&(e=this.map[e]),0===e.length)return null;var t=e[0].type;if(!(0,n.OY)(t))return null;var r={average:0,count:0,max:0,median:0,min:0,mode:[],range:0,sum:0},i=e.map((function(e){return Number(e.displayValue)}));i.sort((function(e,t){return e-t}));var o={},a=0,s=0;i.forEach((function(e){s+=e,Object.prototype.hasOwnProperty.call(o,e)?o[e]++:o[e]=1,a=Math.max(a,o[e]),r.sum+=e})),r.count=i.length,r.average=s/r.count,r.max=i[r.count-1],r.min=i[0];var l=Math.ceil(r.count/2);for(var u in r.median=r.count%2&&r.count>1?(i[l]+i[l-1])/2:i[l-1],o)o[u]===a&&r.mode.push(Number(u));return r.range=r.max-r.min,r.sum=function(e,t){var r=t.displayValue.toString().split(".");if(1===r.length)return e;var n=e.toString().split(".");if(1===n.length)return e;var i=n[1],o=r[1];if(i===o)return e;var a=(o=o.match(/\d+/))&&o[0]&&o[0].length||t.precision||0;return Number(e.toFixed(a))}(r.sum,e[0]),r}},{key:"getValue2PropertiesMap",value:function(e){if(!e)return null;if("string"==typeof e&&(e=this.map[e]),!e||0===e.length)return null;var t={};return e.forEach((function(e){Object.prototype.hasOwnProperty.call(t,e.displayValue)||(t[e.displayValue]=[]),t[e.displayValue].push(e.parentName)})),t}},{key:"getValidIds",value:function(e,t){for(var r=Object.keys(this.map),n=[],i=0;i<r.length;i++){var o=r[i];if(e&&-1!==o.indexOf(e))n.push(o);else if(t){var a=o.split("/");if(a.length>=2&&a[0]===t){n.push(o);continue}}}return n}},{key:"getDbIds",value:function(){return this.map.__selected_dbIds__}},{key:"getVisibleKeys",value:function(){var e=[];return this.forEach((function(t,r){r[0].hidden||e.push(t)})),e}},{key:"getKeysWithCategories",value:function(){var e=[];return this.forEach((function(t,r){var n=!!r[0].hidden;r[0].displayCategory&&!n&&e.push(t)})),e}},{key:"merge",value:function(t){if(!(t instanceof e))return this;var r=t.map;for(var n in r){var o=r[n];if(Object.prototype.hasOwnProperty.call(this.map,n)){var a=this.map[n];if("__selected_dbIds__"!==n)for(var s=0;s<o.length;s++){for(var l=o[s],u=!0,c=0;c<a.length;c++){var h=a[c];l.displayValue!==h.displayValue||l.dbId!==h.dbId||(u=!1)}u&&a.push(l)}else this.map[n]=[].concat(i(a),i(o))}else this.map[n]=o}return this}}])&&a(t.prototype,r),o&&a(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}()},65663:(e,t,r)=>{"use strict";r.r(t),r.d(t,{ScreenMode:()=>u,ScreenModeDelegate:()=>c,AppScreenModeDelegate:()=>h,ApplicationScreenModeDelegate:()=>d,NullScreenModeDelegate:()=>f,ScreenModeMixin:()=>p});var n=r(84998),i=r(37169),o=r(98926),a=["fullscreenchange","mozfullscreenchange","webkitfullscreenchange","MSFullscreenChange"];function s(e,t){for(var r=0;r<a.length;++r)t.addDocumentEventListener(a[r],e,!1)}function l(e,t){for(var r=0;r<a.length;++r)t.removeDocumentEventListener(a[r],e,!1)}var u={kNormal:0,kFullBrowser:1,kFullScreen:2};function c(e){this.viewer=e,this.bindFullscreenEventListener=this.fullscreenEventListener.bind(this),this.getMode()===u.kFullScreen&&s(this.bindFullscreenEventListener,this.viewer.globalManager)}function h(e){c.call(this,e)}c.prototype.uninitialize=function(){l(this.bindFullscreenEventListener,this.viewer.globalManager),this.viewer=null},c.prototype.isModeSupported=function(e){return!0},c.prototype.setMode=function(e){var t=this.getMode();return!(e===t||!this.isModeSupported(e))&&(this.doScreenModeChange(t,e),this.onScreenModeChanged(t,e),!0)},c.prototype.getMode=function(){throw"Implement getMode() in derived class"},c.prototype.getNextMode=function(){var e,t=this.getMode(),r=u;return t===r.kNormal&&this.isModeSupported(r.kFullBrowser)?e=r.kFullBrowser:t===r.kNormal&&this.isModeSupported(r.kFullScreen)||t===r.kFullBrowser&&this.isModeSupported(r.kFullScreen)?e=r.kFullScreen:t===r.kFullBrowser&&this.isModeSupported(r.kNormal)||t===r.kFullScreen&&this.isModeSupported(r.kNormal)?e=r.kNormal:t===r.kFullScreen&&this.isModeSupported(r.kFullBrowser)&&(e=r.kFullBrowser),e},c.prototype.getEscapeMode=function(){return this.getMode()!==u.kNormal?u.kNormal:void 0},c.prototype.fullscreenEventListener=function(){var e=this.viewer.globalManager.getDocument();(0,n.inFullscreen)(e)?this.viewer.resize():(this.doScreenModeChange(u.kFullScreen,u.kNormal),this.onScreenModeChanged(u.kFullScreen,u.kNormal))},c.prototype.doScreenModeChange=function(e,t){throw"Implement doScreenModeChange() in derived class"},c.prototype.onScreenModeChanged=function(e,t){e===u.kFullScreen?l(this.bindFullscreenEventListener,this.viewer.globalManager):t===u.kFullScreen&&s(this.bindFullscreenEventListener,this.viewer.globalManager),this.viewer.resize(),this.viewer.dispatchEvent({type:i.FULLSCREEN_MODE_EVENT,mode:t})},h.prototype=Object.create(c.prototype),h.prototype.constructor=h,h.prototype.isModeSupported=function(e){return e!==u.kFullBrowser},h.prototype.getMode=function(){var e=this.viewer.globalManager.getDocument();return(0,n.inFullscreen)(e)?u.kFullScreen:u.kNormal},h.prototype.doScreenModeChange=function(e,t){var r=this.viewer.container;if(t===u.kNormal){r.classList.remove("viewer-fill-browser");var i=this.viewer.globalManager.getDocument();(0,n.exitFullscreen)(i)}else t===u.kFullScreen&&(r.classList.add("viewer-fill-browser"),(0,n.launchFullscreen)(r))};var d=h;function f(e){c.call(this,e)}function p(){}f.prototype=Object.create(c.prototype),f.prototype.constructor=c,f.prototype.isModeSupported=function(){return!1},f.prototype.getMode=function(){return u.kNormal},p.prototype={setScreenModeDelegate:function(e){this.screenModeDelegate&&(this.screenModeDelegate.uninitialize(),this.screenModeDelegate=null),this.screenModeDelegateClass=e||(null===e?f:h)},getScreenModeDelegate:function(){return this.screenModeDelegate||(this.screenModeDelegate=new this.screenModeDelegateClass(this)),this.screenModeDelegate},isScreenModeSupported:function(e){return this.getScreenModeDelegate().isModeSupported(e)},canChangeScreenMode:function(){return this.isScreenModeSupported(Autodesk.Viewing.ScreenMode.kNormal)},setScreenMode:function(e){var t={category:"screen_mode",value:e};return o.logger.track(t),this.getScreenModeDelegate().setMode(e)},getScreenMode:function(){return this.getScreenModeDelegate().getMode()},nextScreenMode:function(){var e=this.getScreenModeDelegate().getNextMode();return void 0!==e&&this.setScreenMode(e)},escapeScreenMode:function(){var e=this.getScreenModeDelegate().getEscapeMode();return void 0!==e&&this.setScreenMode(e)},apply:function(e){var t=p.prototype;e.setScreenModeDelegate=t.setScreenModeDelegate,e.getScreenModeDelegate=t.getScreenModeDelegate,e.isScreenModeSupported=t.isScreenModeSupported,e.canChangeScreenMode=t.canChangeScreenMode,e.setScreenMode=t.setScreenMode,e.getScreenMode=t.getScreenMode,e.nextScreenMode=t.nextScreenMode,e.escapeScreenMode=t.escapeScreenMode}}},66904:(e,t,r)=>{"use strict";r.r(t),r.d(t,{ScreenShot:()=>x});var n=r(92445),i=r(29747),o=r(26842),a=r(84998),s=r(44971),l=r(46759),u=r(27820),c=r(2727),h=r(23909),d=r(37169),f=r(98603);var p=function(e,t,r,d,p){for(var m=p.getMaterials(),g=p.glrenderer(),v=p.renderer(),y=p.modelQueue(),b=[],x=(d=d||{}).models||y.getModels(),_=0;_<x.length;_++){var E=x[_].getIterator();if(E&&E.getGeomScenes)for(var w=E.getGeomScenes(),A=0;A<w.length;A++){var S=w[A];S&&b.push(S)}}var M=d.camera||p.camera;M===p.camera&&(M=M.clone()),M.isUnifiedCamera&&M.updateCameraMatrices(),M.clientWidth=e,M.clientHeight=t;var T,C,P=new i.FrustumIntersector,D=d.excludeCutPlanes?[]:m.getCutPlanes();P.reset(M,D),P.areaCullThreshold=n.PIXEL_CULLING_THRESHOLD,g.pushViewport(),g.setPixelRatio(1),d.renderContext?T=d.renderContext:(T=new o.RenderContext).init(g,e,t,{offscreen:!0}),p.isSheetRendererNeeded()&&(C=d.sheetRenderer?d.sheetRenderer:new f.Z(p,T,g,m)),m.addOverrideMaterial("normalsMaterial_screenshot",T.getDepthMaterial()),m.addOverrideMaterial("edgeMaterial_screenshot",T.getEdgeMaterial());var L=d.renderConfig||v.getConfig();T.applyConfig(L),T.beginScene(p.scene,M,p.noLights,!0),g.popViewport(),g.setPixelRatio();for(var R=0,I=void 0,O={stop:function(){I&&((0,a.getGlobal)().clearTimeout(I),B())},finished:function(){return!!I}},N=-1,k=[],F=0;F<x.length;F++){var V=x[F];if(V.isLeaflet()){var U=V.getIterator();k.push({iter:U,viewId:U.registerView(),ready:!1})}}var B=function(){k.forEach((function(e){return e.iter.unregisterView(e.viewId)})),k.length=0},z=d.fragOptions,G=z?[]:void 0,H=function(){var e=void 0;if(d.models){e=new h.Box3;for(var t=0;t<x.length;t++){var r=x[t];e.union(r.getBoundingBox())}}else e=p.getVisibleBounds();var n=Object.prototype.hasOwnProperty.call(d,"is2d")?d.is2d:p.is2d,i=T.settings.deviceHeight,o=d.excludeCutPlanes?void 0:m.getCutPlanesRaw(),a=o&&o[0],s=x[0]&&x[0].getBoundingBox();return u.SceneMath.getPixelsPerUnit(M,n,e,i,a,s)}(),W=[],j=null,q=new h.Vector4(0,0,-1,-1e20),X=[],Y=null;return function n(){if(!function(){for(var e=!0,t=0;t<k.length;t++){var r=k[t];r.ready||(r.ready=r.iter.reset(P,M,r.viewId)),e=e&&r.ready}if(e=e||d.dontWaitForLeafletTiles)for(var n=0;n<k.length;n++){var i=k[n],o=i.iter.getScene(i.viewId);b.push(o)}return e}())I=(0,a.getGlobal)().setTimeout(n,0);else{var i=performance.now();g.pushViewport(),g.setPixelRatio(1),g.setViewport(0,0,e,t);var o,h,f=p.getPixelsPerUnit(p.camera,p.getVisibleBounds());if(m.updatePixelScale(H,e,t,M),d.excludeCutPlanes)!function(){var e=(Y=m.getCutPlanes()).length;if(X.length!==e){X.length=e;for(var t=0;t<e;t++)X[t]=q}v.toggleTwoSided(m.setCutPlanes(X))}();else null===(o=(h=p.api).syncCutPlanes)||void 0===o||o.call(h);d.beforeRender&&d.beforeRender();for(var y=function(){var e=b[R],t=x.find((function(t){var r;return t.id===(null===(r=e.frags)||void 0===r?void 0:r.modelId)}));if(null!=t&&t.is2d()){var r=t.getModelToViewerTransform(),n=r?r.getMaxScaleOnAxis():1;if(!p.is2d||1!==n){var o=t.getVisibleBounds(),a=T.settings.deviceWidth,h=T.settings.deviceHeight,f=u.SceneMath.getPixelsPerUnit(M,!0,o,h,null,o);m.updatePixelScaleForModel(t,f,a,h,n,M)}}if(function(e){if(z&&e instanceof s.RenderBatch){var t=e.frags;e.forEachNoMesh((function(e,r){G[r]=t.vizflags[e];var n=z.isFragOff&&z.isFragOff(e);void 0!==n&&t.setFlagFragment(e,l.MeshFlags.MESH_HIDE,n);var i=z.isFragVisible&&z.isFragVisible(e);void 0!==i&&t.setFlagFragment(e,l.MeshFlags.MESH_VISIBLE,i)}))}}(e),function(e){d.excludeThemingColors&&e instanceof s.RenderBatch&&(e.frags.is2d||(j=e.frags.db2ThemingColor,e.frags.db2ThemingColor=W))}(e),e instanceof s.RenderBatch&&e.applyVisibility(c.RenderFlags.RENDER_NORMAL,P),C&&e.frags.is2d?C.renderScenePart(e,!0,!0,!1,T):(T.renderScenePart(e,!0,!0,!1,!1),(e.frags&&!e.frags.areAllVisible()&&p.showGhosting||z)&&(e instanceof s.RenderBatch&&e.applyVisibility(c.RenderFlags.RENDER_HIDDEN,P),v.setEdgeColor(p.edgeColorGhosted),e.overrideMaterial=p.fadeMaterial,T.renderScenePart(e,!0,!0,!1,!1),v.setEdgeColor(p.edgeColorMain),e.overrideMaterial=null)),function(e){j&&(e.frags.db2ThemingColor=j,j=null)}(e),function(e){if(z&&e instanceof s.RenderBatch){var t=e.frags;e.forEachNoMesh((function(e,r){var n=G[r],i=!!(n&l.MeshFlags.MESH_HIDE),o=!!(n&l.MeshFlags.MESH_VISIBLE);t.setFlagFragment(e,l.MeshFlags.MESH_HIDE,i),t.setFlagFragment(e,l.MeshFlags.MESH_VISIBLE,o)}))}}(e),R++,performance.now()-i>20)return"break"};R<b.length;){if("break"===y())break}if(g.popViewport(),g.setPixelRatio(),m.updatePixelScale(f,v.settings.deviceWidth,v.settings.deviceHeight,M),d.excludeCutPlanes&&v.toggleTwoSided(m.setCutPlanes(Y)),d.afterRender&&d.afterRender(),R===b.length?function(){B();var e=T.getColorTarget();if((L.aoEnabled||L.antialias)&&(L.aoEnabled&&T.computeSSAO(),e=T.getNamedTarget("overlay"),T.getBlendPass().uniforms.tOverlay.value=null,T.setOffscreenTarget(e),T.presentBuffer()),d.returnAsTarget)r(T,e,M,C);else{var t;d.sheetRenderer||(null===(t=C)||void 0===t||t.destroy(),C=null),T.targetToCanvas(e).canvas.toBlob((function(e){var t=(0,a.getGlobal)().URL.createObjectURL(e);r&&r(t)}))}}():I=(0,a.getGlobal)().setTimeout(n,0),d.onProgress){var _=Math.floor(100*R/b.length);_!==N&&(N=_,d.onProgress(_))}}}(),O},m=function(e,t,r,n,i){var o=i.fullPage,s=i.bounds,l=i.getCropBounds,u=i.margin,c=i.overlayRenderer,d=i.overlayRendererExtraOptions;o&&(s=e.impl.getVisibleBounds());var f=e.impl.getCanvasBoundingClientRect().width,m=e.navigation.getCamera();s&&(m=b(e,s,u));var y=g(e,m);try{if(o){var x=y.getSize(new h.Vector3),_=f/Math.max(x.x,x.y);t=Math.floor(t*_),r=Math.floor(r*_)}var E=function(i){if(o){var u=t/f;y.min.x*=u,y.min.y*=u,y.max.x*=u,y.max.y*=u,v(i,y,n)}else if(l){var c=l(e,m,s);v(i,c,n)}else i.toBlob((function(e){var i=(0,a.getGlobal)().URL.createObjectURL(e);n(i,t,r)}))},w=e.impl.selector.getSelection();return e.clearSelection(),p(t,r,(function(n,i,o){if(e.impl.selector.setSelection(w),c){c(e,{width:t,height:r,ctx:n,target:i,screenshotCamera:o,onRenderDone:E},d)}else{var a=n.targetToCanvas(i).canvas;E(a)}}),{returnAsTarget:!0,camera:m},e.impl)}catch(e){console.error("getScreenShot error: "+e),n(null)}},g=function(e,t){var r=e.impl.getVisibleBounds(void 0,void 0,void 0,!0),n=e.worldToClient(r.min,t),i=e.worldToClient(r.max,t);return(new h.Box3).setFromPoints([n,i])},v=function(e,t,r){var n=(0,a.getGlobal)().document.createElement("canvas"),i=n.getContext("2d"),o=t.getSize(new h.Vector3),s=Math.min(Math.floor(o.x),e.width),l=Math.min(Math.floor(o.y),e.height);n.width=s,n.height=l;var u=Math.max(Math.floor(t.min.x),0),c=Math.max(Math.floor(t.min.y),0),d=s,f=l;i.drawImage(e,u,c,d,f,0,0,s,l),n.toBlob((function(e){var t=(0,a.getGlobal)().URL.createObjectURL(e);r(t,s,l)}),"image/png")},y=function(e,t,r,n){var i=(0,a.getGlobal)().document.createElement("canvas"),o=i.getContext("2d"),s=new Image;i.width=t,i.height=r,s.src=e,s.onload=function(){o.drawImage(s,0,0,t,r);var e=i.toDataURL("image/png");n(e)}},b=function(e,t,r){r=r||e.navigation.FIT_TO_VIEW_HORIZONTAL_MARGIN;var n={horizontal:e.navigation.FIT_TO_VIEW_HORIZONTAL_MARGIN,vertical:e.navigation.FIT_TO_VIEW_VERTICAL_MARGIN};e.navigation.FIT_TO_VIEW_HORIZONTAL_MARGIN=r,e.navigation.FIT_TO_VIEW_VERTICAL_MARGIN=r;var i=e.getState({viewport:!0});e.navigation.fitBounds(!0,t,!1,!0);var o=e.navigation.getCamera().clone();return e.restoreState(i,void 0,!0),e.navigation.FIT_TO_VIEW_HORIZONTAL_MARGIN=n.horizontal,e.navigation.FIT_TO_VIEW_VERTICAL_MARGIN=n.vertical,e.impl.updateNearFarValues(o,t),o},x={getScreenShotLegacy:function(e,t,r,n,i){var o=e.impl,s=o.renderer(),l=s.settings.logicalWidth,u=s.settings.logicalHeight,c=o.progressiveRender,f=o.glrenderer().getPixelRatio();t&&r||(t=l,r=u),o.progressiveRender=!1,o.resize(t/f,r/f,!0),o.tick(performance.now());var p=h.RGBAFormat;p=h.RGBFormat;var m=new h.WebGLRenderTarget(t,r,{minFilter:h.LinearFilter,magFilter:h.LinearFilter,format:p,type:h.UnsignedByteType}),g=s.getOffscreenTarget();function v(){var e=s.targetToCanvas(m||s.getColorTarget());function t(){o.progressiveRender=c,o.resize(l,u,!0),e.canvas.toBlob((function(e){var t=(0,a.getGlobal)().URL.createObjectURL(e);n?n(t):(0,a.getGlobal)().open(t)}),"image/png")}m&&(m.dispose(),m=void 0,o.glrenderer().setRenderTarget(null)),i?i(e.ctx,t):t()}if(s.setOffscreenTarget(m),s.presentBuffer(),s.setOffscreenTarget(g),e.model.isLeaflet()){var y=!1,b=function(){y=!0,o.progressiveRender=c,o.resize(l,u,!0),m&&m.dispose()};e.addEventListener(d.CANCEL_LEAFLET_SCREENSHOT,b,{once:!0}),o.invalidate(!0),e.model.getIterator().callWhenRefined((function(){y||(e.removeEventListener(d.CANCEL_LEAFLET_SCREENSHOT,b),v())}))}else v()},getScreenShot:p,getScreenShotWithBounds:m,getScreenShotAtScreenSize:function(e,t,r){var n=e.impl.getCanvasBoundingClientRect(),i=Math.floor(n.width),o=Math.floor(n.height);m(e,i,o,(function(e,r,n){e?y(e,r,n,(function(e){t(e,r,n)})):t(null)}),r)},getSceneClientBounds:g,cropImage:v,blobToImage:y,makeBoundsSquare:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=e.getSize(new h.Vector3),n=Math.max(r.x,r.y,t);e.expandByVector(new h.Vector3((n-r.x)/2,(n-r.y)/2,0))},getCameraWithFitBounds:b}},76079:(e,t,r)=>{"use strict";r.r(t),r.d(t,{Thumbnails:()=>l});var n=r(19255),i=r(58964),o=r(57601),a=r(84998),s=r(26261);var l={getUrlForBubbleNode:function(e,t){if(!e)return Promise.reject(new Error("Missing instance of BubbleNode"));var r=e.findParentGeom2Dor3D();if(!r)return Promise.reject(new Error("No thumbnail available."));var l=(t=t||{}).size||200,u=e.getRootNode();return(u.data.isVectorPDF||r.data.isVectorPDF)&&u.data.getPDF?new Promise((function(t){var r=e.data,i=u.data.getPDF(),o=l,s=l,c="".concat(r.guid,"/thumbnail/").concat(o,"x").concat(s);!function(e,t,r,i,o,s){var l=n.LocalStorage.getItem(o);l?s(l):e.getPage(t).then((function(e){var t=(0,a.getGlobal)().document.createElement("canvas");t.width=r,t.height=i;var l=t.getContext("2d"),u={scale:1},c=e.getViewport(u),h=Math.min(t.width/c.width,t.height/c.height);e.render({canvasContext:l,viewport:e.getViewport({scale:h})}).promise.then((function(){e.cleanup(),t.toBlob((function(e){var t=new FileReader;t.readAsDataURL(e),t.onloadend=function(){n.LocalStorage.setItem(o,t.result),s(t.result)}}),"image/png")}))}))}(i,r.page,o,s,c,t)})):new Promise((function(t,r){var n={urn:u.urn(),width:l,height:l,guid:encodeURIComponent(e.guid()),acmsession:i.endpoint.getAcmSession()},c={responseType:"blob",skipAssetCallback:!0,size:l,guid:n.guid,acmsession:n.acmSession},h="urn:"+n.urn;e.data.thumbnailUrn&&(h=u.getDocument().getFullPath(e.data.thumbnailUrn));var d=void 0;if(!(0,a.getGlobal)().USE_OTG_DS_PROXY){var f=(0,i.getEnv)();d=s.EnvironmentConfigurations[f].UPSTREAM;var p=(0,s.getUpstreamApiData)(f,i.endpoint.getApiFlavor());c.apiData=p}o.ViewingService.getThumbnail((0,i.initLoadContext)({endpoint:d}),h,(function(e){var r=new FileReader;r.onload=function(e){var r=e.target.result;t(r)},r.readAsDataURL(e)}),(function(){r(new Error("Thumbnail is unavailable."))}),c)}))}}},24327:(e,t,r)=>{"use strict";r.r(t),r.d(t,{Viewer3D:()=>de,waitForCompleteLoad:()=>fe});var n=r(23909),i=r(84998),o=r(98926),a=r(41772),s=r(55412),l=r(50041),u=r(5130),c=r(9322),h=r(17167),d=r(79659),f=r(62546),p=r(11294),m=r(65663),g=r(61445),v=r(3260),y=r(10831),b=r(49083),x=r(25406),_=r(26099),E=r(33317),w=r(71224),A=r(37169),S=r(50411),M=r(8283),T=r(59823),C=r(80401),P=r(79757),D=r(44245),L=r(77368),R=r(87289),I=r(9487),O=r(35449);function N(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return k(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return k(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function k(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function F(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var V=416,U=1e3,B=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.viewer=t,this.setGlobalManager(this.viewer.globalManager),this.domElement=null,this._step=this._step.bind(this)}var t,r,n;return t=e,r=[{key:"createDom",value:function(e){var t=this,r=this.getDocument();this.domElement=r.createElement("div"),this.domElement.className="forge-spinner",this._initTransform="translate(-50%, -50%) scale(".concat(.5,")"),this.domElement.style.transform=this._initTransform.slice();var n=this._createSvgElement("svg");n.setAttribute("width","242"),n.setAttribute("height","242"),n.setAttribute("viewBox","0 0 ".concat(72," ").concat(72)),n.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink"),this.domElement.appendChild(n);var i=this._createWheelPointData(10,72,6.75);this._createMask(i);var o=this._createSvgElement("polygon");o.setAttribute("mask","url(#mask)"),n.appendChild(o),this._addPoints(i.outerPoints,o),this._createSegments(i);var a=r.createElement("img");return a.src=Autodesk.Viewing.Private.getResourceUrl("res/ui/forge-logo.png"),this._onResize=this._onResize.bind(this),a.onload=function(){t._onResize(),t._initResize=!0,t.viewer.addEventListener(Autodesk.Viewing.VIEWER_RESIZE_EVENT,t._onResize)},this.domElement.appendChild(a),e&&e.appendChild(this.domElement),this.domElement.style.display="none",this.domElement}},{key:"_createSvgElement",value:function(e){return this.getDocument().createElementNS("http://www.w3.org/2000/svg",e)}},{key:"_getSvg",value:function(){return null==this?void 0:this.domElement.getElementsByTagNameNS("http://www.w3.org/2000/svg","svg")[0]}},{key:"_createMask",value:function(e){var t=this._getSvg(),r=this._createSvgElement("defs"),n=this._createSvgElement("mask");n.id="mask",r.appendChild(n),t.appendChild(r);var i=this._createSvgElement("polygon");i.style.opacity=.15,i.style.fill="#FFF",n.appendChild(i),this._addPoints(e.outerPoints,i);var o=this._createSvgElement("polygon");n.appendChild(o),this._addPoints(e.innerPoints,o)}},{key:"_step",value:function(e){this.startTime||(this.startTime=e);var t=(e-this.startTime)%U;this._setSegmentOpacities(t);var r=this.getWindow();this._animId=r.requestAnimationFrame(this._step)}},{key:"_stop",value:function(){this._animId&&(this.getWindow().cancelAnimationFrame(this._animId),this._animId=null)}},{key:"_setSegmentOpacities",value:function(e){var t=this;this.segments.forEach((function(r,n){var i=Math.abs(n-t.segments.length)-1;r.style.opacity=t._getSegmentOpacity(i,e)}))}},{key:"_getSegmentOpacity",value:function(e,t){var r=e*(U/this.segments.length);return r+V>U&&t<V?-1*((t+U-r)/V-1):t<r||t>r+V?0:Math.abs((t-r)/V-1)}},{key:"_getSegments",value:function(){return Array.from(this.domElement.querySelectorAll(".segment"))}},{key:"_addPoints",value:function(e,t){var r,n=N(e);try{for(n.s();!(r=n.n()).done;){var i=r.value,o=this._getSvg().createSVGPoint();o.x=i[0],o.y=i[1],t.points.appendItem(o)}}catch(e){n.e(e)}finally{n.f()}}},{key:"_createWheelPointData",value:function(e,t){for(var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5,n=t/2,i=t/2,o=t/2,a={outerPoints:[],innerPoints:[]},s=1;s<=e;s++)a.outerPoints.push([i+n*Math.cos(2*s*Math.PI/e),o+n*Math.sin(2*s*Math.PI/e)]),a.innerPoints.push([i+(n-r)*Math.cos(2*s*Math.PI/e),o+(n-r)*Math.sin(2*s*Math.PI/e)]);return a}},{key:"_createSegments",value:function(e){for(var t=this,r=e.outerPoints,n=e.innerPoints,i=this._getSvg(),o=function(e,r){var n=t._createSvgElement("polygon");z(n,"segment"),z(n,r),t._addPoints(e,n),i.appendChild(n)},a=r.length-1;a>=0;--a){var s=r[a],l=r[a-1],u=n[a],c=n[a-1];0===a&&(l=r[r.length-1],c=n[r.length-1]),o([s,l,u],"light-blue"),o([u,c,l],"dark-blue")}}},{key:"_fadeOut",value:function(){var e=this,t=1,r=setInterval((function(){var n;null!==(n=e.domElement)&&void 0!==n&&n.style?(t<=.1&&(clearInterval(r),e.domElement.style.display="none"),e.domElement.style.opacity=t,t-=.1*t):clearInterval(r)}),1)}},{key:"show",value:function(){this.domElement&&(this.domElement.style.display="block",this.domElement.style.opacity=1,this.segments=this._getSegments(),this._step(1))}},{key:"hide",value:function(){var e=this;if(this.domElement){this._hide=function(t){e._stop(),t.model.is3d()?e._fadeOut():(e.domElement.style.opacity=0,e.domElement.style.display="none")};var t=this.viewer.impl.modelQueue().getModels();0===t.length?this.viewer.addEventListener(Autodesk.Viewing.MODEL_ADDED_EVENT,this._hide,{once:!0}):this._hide({model:t[0]})}}},{key:"destroy",value:function(){var e;this._stop(),null!==(e=this.domElement)&&void 0!==e&&e.parentElement&&this.domElement.parentElement.removeChild(this.domElement),this.domElement=null,this.viewer.removeEventListener(Autodesk.Viewing.VIEWER_RESIZE_EVENT,this._onResize)}},{key:"_onResize",value:function(){var e,t;if(this._initResize)this._initResize=!1;else{var r=this.domElement;if(r&&"none"!=r.style.display){var n=r.parentElement;if(n){var i=n.getBoundingClientRect(),o=r.getBoundingClientRect(),a=Math.max(o.width/i.width,(o.height+350)/i.height),s=null===(e=this.domElement)||void 0===e||null===(t=e.style)||void 0===t?void 0:t.transform;if(s)if(a>.8){var l=/[-+]?scale\(\d*\.\d+|\d+\)/,u=l.exec(s);if(u.length>0){var c=u[0].split("scale(")[1],h=Number((c/a).toFixed(4)),d=s.replace(l,"scale(".concat(h));d!=this.domElement.style.transform&&h<=.5&&h>.2&&(this.domElement.style.transform=d)}}else this.domElement.style.transform!=this._initTransform&&(this.domElement.style.transform=this._initTransform)}}}}}],r&&F(t.prototype,r),n&&F(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function z(e,t){if(e.classList)e.classList.add(t);else{var r=e.getAttribute("class")||"";r=r.split(" ").includes(t)?r:"".concat(r," ").concat(t),e.setAttribute("class",r)}}function G(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}O.GlobalManagerMixin.call(B.prototype);var H=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.domElement=null}var t,r,n;return t=e,(r=[{key:"createDom",value:function(e){var t=this.getDocument(),r=t.createElement("div");r.className="spinner",e&&e.appendChild(r);for(var n=1;n<=3;n++){var i=t.createElement("div");i.className="bounce"+n,r.appendChild(i)}return this.domElement=r,this.hide(),r}},{key:"show",value:function(){this.domElement&&(this.domElement.style.display="block")}},{key:"hide",value:function(){this.domElement&&(this.domElement.style.display="None")}},{key:"destroy",value:function(){this.domElement=null}}])&&G(t.prototype,r),n&&G(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();O.GlobalManagerMixin.call(H.prototype);var W=r(27820),j=r(66904);const q=Object.freeze({pdf:"Autodesk.PDF",scalaris:"Autodesk.Scalaris",dwf:"Autodesk.DWF",dwfx:"Autodesk.DWF",rcp:"Autodesk.ReCap",gltf:"Autodesk.glTF",glb:"Autodesk.glTF"});var X=r(12032),Y=r(27800),K=r(95018),Z=r(44669),Q=r(21319),J=r(58964);function $(e,t,r,n){var i={url:e,lmvFileExtension:t,returnValue:r};if(n){i.isOtg=n.isOtg()&&J.endpoint.isOtgBackend(),i.isSVF2=n.isSVF2()&&J.endpoint.isSVF2Backend(),i.geometrySize=n.data.size||0,i.viewable_type=n.is2D()?"2d":"3d";var o=n.findViewableParent();try{var a=o&&o.name(),s=a&&a.lastIndexOf("."),l=s>=0&&a.substring(s+1);l&&(i.seedFileExt=l.toLowerCase())}catch(e){}}return i}function ee(e){return ee="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ee(e)}function te(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function re(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ne(e,t){return ne=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},ne(e,t)}function ie(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=ae(e);if(t){var i=ae(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return oe(this,r)}}function oe(e,t){if(t&&("object"===ee(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function ae(e){return ae=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},ae(e)}var se=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ne(e,t)}(o,e);var t,r,n,i=ie(o);function o(e,t){var r,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),n=i.call(this,e,t);var a=(te(r={},s.Prefs3D.VIEW_CUBE,(function(t){e.getExtension("Autodesk.ViewCubeUi",(function(e){e.displayViewCube(t)}))})),te(r,s.Prefs3D.ALWAYS_USE_PIVOT,e.setUsePivotAlways.bind(e)),te(r,s.Prefs3D.ORBIT_PAST_WORLD_POLES,e.setOrbitPastWorldPoles.bind(e)),te(r,s.Prefs3D.ZOOM_TOWARDS_PIVOT,e.setZoomTowardsPivot.bind(e)),te(r,s.Prefs.REVERSE_MOUSE_ZOOM_DIR,e.setReverseZoomDirection.bind(e)),te(r,s.Prefs.LEFT_HANDED_MOUSE_SETUP,e.setUseLeftHandedInput.bind(e)),te(r,s.Prefs3D.CLICK_TO_SET_COI,e.setClickToSetCOI.bind(e)),te(r,s.Prefs.ZOOM_DRAG_SPEED,(function(t){var r,n=e.toolController.getTool("dolly");null==n||null===(r=n.setDollyDragScale)||void 0===r||r.call(n,t)})),te(r,s.Prefs.ZOOM_SCROLL_SPEED,(function(t){var r,n=e.toolController.getTool("dolly");null==n||null===(r=n.setDollyScrollScale)||void 0===r||r.call(n,t)})),te(r,s.Prefs3D.ANTIALIASING,(function(t){return e.setQualityLevel(n.get("ambientShadows"),t)})),te(r,s.Prefs3D.AMBIENT_SHADOWS,(function(t){return e.setQualityLevel(t,e.prefs.get("antialiasing"))})),te(r,s.Prefs3D.GROUND_SHADOW,e.setGroundShadow.bind(e)),te(r,s.Prefs3D.GROUND_REFLECTION,e.setGroundReflection.bind(e)),te(r,s.Prefs2D.SWAP_BLACK_AND_WHITE,e.setSwapBlackAndWhite.bind(e)),te(r,s.Prefs3D.OPTIMIZE_NAVIGATION,e.setOptimizeNavigation.bind(e)),te(r,s.Prefs.PROGRESSIVE_RENDERING,e.setProgressiveRendering.bind(e)),te(r,s.Prefs.GHOSTING,e.setGhosting.bind(e)),te(r,s.Prefs3D.LINE_RENDERING,(function(t){return e.hideLines(!t)})),te(r,s.Prefs.POINT_RENDERING,(function(t){return e.hidePoints(!t)})),te(r,s.Prefs3D.EDGE_RENDERING,e.setDisplayEdges.bind(e)),te(r,s.Prefs3D.ENV_MAP_BACKGROUND,e.setEnvMapBackground.bind(e)),te(r,s.Prefs3D.LIGHT_PRESET,e.setLightPreset.bind(e)),r);return Object.keys(a).forEach((function(e){n.addListeners(e,a[e])})),n}return t=o,r&&re(t.prototype,r),n&&re(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(r(91217).Preferences);function le(e,t,r,n,i,o,a){try{var s=e[o](a),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,i)}var ue=Autodesk.Viewing;var ce=0,he=["markups-svg","pushpin-container"];function de(e,t){if(this.setGlobalManager(new Y.GlobalManager),e){if(this.clientContainer=e,this.container=this.getDocument().createElement("div"),this.container.classList.add("adsk-viewing-viewer"),this.container.style.height="100%",this.container.style.width="100%",this.container.style.overflow="hidden",this.container.classList.add((0,i.isTouchDevice)()?"touch":"notouch"),this.clientContainer.appendChild(this.container),this.config=t||{},this.contextMenu=null,this.contextMenuCallbacks={},this.started=!1,this.theme=this.config.theme||"dark-theme",this.container.classList.add(this.theme),this.containerLayerOrder=this.config.containerLayerOrder||he,(0,i.isChrome)()&&this.container.classList.add("quality-text"),"CANVAS"===this.container.nodeName)throw"Viewer must be initialized on a div [temporary]";if(this.canvasWrap=this.getDocument().createElement("div"),this.canvasWrap.classList.add("canvas-wrap"),this.canvas=this.getDocument().createElement("canvas"),this.canvas.tabIndex=0,this.canvas.setAttribute("data-viewer-canvas","true"),this.canvasWrap.appendChild(this.canvas),this.container.appendChild(this.canvasWrap),!(0,i.isPhoneFormFactor)()&&!ue.Private.DISABLE_FORGE_LOGO&&!ue.Private.DISABLE_FORGE_CANVAS_LOGO){var r=this.getDocument();this._forgeLogo=r.createElement("div"),this._forgeLogo.classList.add("forge-logo-canvas");var n=r.createElement("img");n.src=Autodesk.Viewing.Private.getResourceUrl("res/ui/forge-logo-canvas.png"),this._forgeLogo.appendChild(n),this._forgeLogo.style.display="none",this.container.appendChild(this._forgeLogo)}this.canvas.viewer=this}var o=t&&t.localStoragePrefix||"Autodesk.Viewing.Private.GuiViewer3D.SavedSettings.";o.endsWith(".")||(o+=".");var a={prefix:o,localStorage:!(0,i.isNodeJS)()};this._displayEdges=null,this._setDoubleSided=null,this.prefs=new se(this,a),this.profile=null,this.profileManager=new c.ProfileManager,this._hotkeyManager=new v.HotkeyManager,this.extensionCache=null,this.running=!1,this._pushedTool="",this._defaultNavigationTool="",this.id=ce++,this.impl=new D.Viewer3DImpl(this.canvas,this),this.overlays=new X.OverlayManager(this.impl),this._loadingSpinner=ue.Private.DISABLE_FORGE_LOGO?new H:new B(this),this._loadingSpinner.setGlobalManager(this.globalManager),this.trackADPTimer=[]}function fe(e,t){return new Promise((function(r,n){var i=0;function o(t){2===i&&r({viewer:e,model:t})}e.addEventListener(A.GEOMETRY_LOADED_EVENT,(function r(a){a.model.getData().loadOptions.bubbleNode===t.bubbleNode&&(e.removeEventListener(A.GEOMETRY_LOADED_EVENT,r),i++,t.skipPropertyDb?o(a.model):a.model.getProperties(1,(function(){return o(a.model)}),(function(e){return n(e)})))})),e.addEventListener(A.TEXTURES_LOADED_EVENT,(function r(n){n.model.getData().loadOptions.bubbleNode===t.bubbleNode&&(e.removeEventListener(A.TEXTURES_LOADED_EVENT,r),i++,o(n.model))}))}))}f.EventDispatcher.prototype.apply(de.prototype),m.ScreenModeMixin.prototype.apply(de.prototype),g.ExtensionMixin.prototype.apply(de.prototype),O.GlobalManagerMixin.call(de.prototype),de.prototype.constructor=de,Object.defineProperty(de.prototype,"model",{get:function(){var e;return null===(e=this.impl)||void 0===e?void 0:e.model},set:function(){throw"Do not set viewer.model"}}),de.ViewerCount=0,de.kDefaultCanvasConfig={click:{onObject:["selectOnly"],offObject:["deselectAll"]},clickAlt:{onObject:["setCOI"],offObject:["setCOI"]},clickCtrl:{onObject:["selectToggle"]},clickShift:{onObject:["selectToggle"]},disableSpinner:!1,disableMouseWheel:!1,disableTwoFingerSwipe:!1},Object.defineProperty(de.prototype,"scene",{get:function(){return this.impl.scene},set:function(){throw"Do not set viewer.scene"}}),Object.defineProperty(de.prototype,"sceneAfter",{get:function(){return this.impl.sceneAfter},set:function(){throw"Do not set viewer.sceneAfter"}}),de.createHeadlessViewer=function(){var e=new de;return e.impl.initialize(),e.impl.setLightPreset(0),e},de.prototype.start=function(e,t,r,n,i){if(this.started)return 0;this.started=!0;var o=this,a=o.initialize(i);return 0!==a?(n&&setTimeout((function(){n(a)}),1),a):(setTimeout((function(){o.setUp(o.config)}),1),e&&this.loadModel(e,t,r,n),0)},de.prototype.startWithDocumentNode=function(e,t,r){var n=this;return new Promise((function(i,o){if(n.started)return 0;n.started=!0;var a=n.initialize();0===a?(setTimeout((function(){n.setUp(n.config)}),1),n.loadDocumentNode(e,t,r).then(i).catch(o)):setTimeout((function(){o(a)}),1)}))},de.prototype.registerUniversalHotkeys=function(){var e,t,r,n=this;e=function(){return n.navigation.setRequestFitToView(!0),Q.analytics.track("viewer.fit_to_view",{from:"Keyboard"}),!0},n._hotkeyManager.pushHotkeys("Autodesk.FitToView",[{keycodes:[I.KeyCode.f],onPress:e}]),e=function(){return n.navigation.setRequestHomeView(!0),!0},n._hotkeyManager.pushHotkeys("Autodesk.Home",[{keycodes:[I.KeyCode.h],onPress:e},{keycodes:[I.KeyCode.HOME],onPress:e}]),t=function(){return n.objectContextMenu&&n.objectContextMenu.hide()||n.dispatchEvent({type:A.ESCAPE_EVENT}),!0},n._hotkeyManager.pushHotkeys("Autodesk.Escape",[{keycodes:[I.KeyCode.ESCAPE],onRelease:t}]),e=function(){return r=n.getActiveNavigationTool(),n.setActiveNavigationTool("pan")},t=function(){return n.setActiveNavigationTool(r)};var i=[{keycodes:[I.KeyCode.SHIFT],onPress:e,onRelease:t},{keycodes:[I.KeyCode.SPACE],onPress:e,onRelease:t}];n._hotkeyManager.pushHotkeys("Autodesk.Pan",i,{tryUntilSuccess:!0})},de.prototype.createControls=function(){var e=this,t=this,r=t.impl;return t.navigation=new y.Navigation(r.camera),t.__initAutoCam(r),t.utilities=new x.ViewingUtilities(r,t.autocam,t.navigation),t.clickHandler=new _.DefaultHandler(r,t.navigation,t.utilities),t.toolController=new b.ToolController(r,t,t.autocam,t.utilities,t.clickHandler),t.toolController.registerTool(new E.GestureHandler(t)),t.toolController.registerTool(t._hotkeyManager),t.toolController.activateTool(t._hotkeyManager.getName()),t.registerUniversalHotkeys(),t.toolController.registerTool(new C.OrbitDollyPanTool(r,t,this.config.navToolsConfig),(function(t){t||e.setActiveNavigationTool()})),t.toolController.setModalityMap({section:{explode:!1,pan:!1,dolly:!1},explode:{section:!1,pan:!1,dolly:!1},measure:{"box-selection":!1},calibration:{"box-selection":!1},orbit:{},dolly:{},pan:{},fov:{},bimwalk:{},"box-selection":{measure:!1,calibration:!1}}),t.toolController},de.prototype.initialize=function(e){this.setScreenModeDelegate(this.config?this.config.screenModeDelegate:void 0);var t=this.getDimensions();if(this.canvas.width=t.width,this.canvas.height=t.height,(0,i.isIOSDevice)()&&this.getWindow().devicePixelRatio&&(this.canvas.width/=this.getWindow().devicePixelRatio,this.canvas.height/=this.getWindow().devicePixelRatio),this.impl.initialize(e),!this.impl.glrenderer()){var r=function(){if(ue.getGlobal().WebGLRenderingContext){for(var e=ue.getGlobal().document.createElement("canvas"),t=["webgl","experimental-webgl","moz-webgl","webkit-3d"],r=!1,n=0;n<4;n++)try{if((r=e.getContext(t[n]))&&"function"==typeof r.getParameter)return 1}catch(e){}return 0}return-1}();if(r<=0)return-1===r?d.ErrorCodes.BROWSER_WEBGL_NOT_SUPPORTED:d.ErrorCodes.BROWSER_WEBGL_DISABLED}var n,o=this;(0,i.isIOSDevice)()?this.onResizeCallback=function(){clearTimeout(n),n=setTimeout(o.resize.bind(o),500)}:this.onResizeCallback=function(){var e=o.impl.camera.clientWidth,t=o.impl.camera.clientHeight,r=o.container.clientWidth,n=o.container.clientHeight;e===r&&t===n||o.resize()};this.addWindowEventListener("resize",this.onResizeCallback,!1),this.onScrollCallback=function(){o.impl.canvasBoundingclientRectDirty=!0},this.addWindowEventListener("scroll",this.onScrollCallback),this.initContextMenu(),this.localize(),this.impl.controls=this.createControls(),this.initializePrefListeners(),this.setDefaultNavigationTool("orbit"),this.impl.controls&&this.impl.controls.setAutocam(this.autocam);var a=this.config&&this.config.canvasConfig?this.config.canvasConfig:de.kDefaultCanvasConfig;this.setCanvasClickBehavior(a),a.disableSpinner||(this.loadSpinner=this._loadingSpinner.createDom(this.container)),this.viewerState=new T.ViewerState(this),this.config&&Object.prototype.hasOwnProperty.call(this.config,"startOnInitialize")&&!this.config.startOnInitialize||this.run();var s=ue.getGlobal();return s.NOP_VIEWER||(s.NOP_VIEWER=this),s.NOP_VIEWERS=s.NOP_VIEWERS||[],s.NOP_VIEWERS.push(this),this.addEventListener(A.MODEL_ADDED_EVENT,(function(e){o.onModelAdded(e.model,e.preserveTools)})),this.addEventListener(A.GEOMETRY_LOADED_EVENT,(function(e){var t,r,n;e.model.is2d()&&!e.model.isLeaflet()&&o.navigation.setMinimumLineWidth(null===(r=e.model.loader)||void 0===r||null===(n=r.svf)||void 0===n?void 0:n.minLineWidth);var i=(null===(t=e.model.getGeometryList())||void 0===t?void 0:t.geoms)||[];e.model.hasEdges=!1;for(var a=0;a<i.length;a++){var s=i[a];if(s&&(s.isLines||s.iblines)){e.model.hasEdges=!0;break}}})),this.dispatchEvent(A.VIEWER_INITIALIZED),this.trackADPSettingsOptions(),this.trackADPExtensionsLoaded(),de.ViewerCount++,0},de.prototype.setUp=function(e){if(this.config=e||{},this.config.extensions=this.config.extensions||[],Array.isArray(this.config.extensions))for(var t=this.config.extensions,r=0;r<t.length;++r)this.loadExtension(t[r],this.config);this.loadExtension("Autodesk.Viewing.MixpanelExtension"),"true"===(0,h.getParameterByName)("lmv_viewer_debug")&&this.loadExtension("Autodesk.Debug",this.config);var n=this.config.canvasConfig||de.kDefaultCanvasConfig;this.setCanvasClickBehavior(n),this._onAggregatedSelectionChanged=this._onAggregatedSelectionChanged.bind(this),this.addEventListener(A.AGGREGATE_SELECTION_CHANGED_EVENT,this._onAggregatedSelectionChanged)},de.prototype.tearDown=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(this.clearSelection(),this.removeEventListener(A.AGGREGATE_SELECTION_CHANGED_EVENT,this._onAggregatedSelectionChanged),this.loadedExtensions){for(var t in this.loadedExtensions)try{this.unloadExtension(t)}catch(e){o.logger.error("Failed to unload extension: "+t,e,(0,d.errorCodeString)(d.ErrorCodes.VIEWER_INTERNAL_ERROR)),o.logger.track({category:"error_unload_extension",extensionId:t,error_message:e.message,call_stack:e.stack})}this.loadedExtensions=null}for(this.toolController&&(this.toolController.enableMouseButtons(!1),this.toolController.deactivateTool("gestures")),o.logger.reportRuntimeStats(!0),this._loadingSpinner.show(),this.liveReviewClient&&(this.liveReviewClient.destroy(),this.liveReviewClient=null);this.trackADPTimer.length>0;)clearTimeout(this.trackADPTimer.pop());e&&this.impl.unloadCurrentModel(),this.impl.setCutPlaneSet("__set_view",void 0)},de.prototype._onAggregatedSelectionChanged=function(){if(this.navigation.getSelectionSetsPivot()){var e=this.impl.selector.getAggregateSelection();if(e.length){var t=this.impl.get3DBounds(e);this.utilities.setPivotPoint(t.getCenter(new n.Vector3),!0,!0),this.utilities.pivotActive(this.navigation.getPivotSetFlag(),!0)}}},de.prototype.run=function(){this.running||(this.resize(),this.running=!0,this.impl.run())},de.prototype.localize=function(){w.Z.localize()},de.prototype.__initAutoCam=function(e){var t=this,r=e.camera;r.pivot||(r.pivot=new n.Vector3(0,0,0)),r.target||(r.target=new n.Vector3(0,0,0)),r.worldup||(r.worldup=r.up.clone()),t.autocamCamera=r.clone(),t.autocamCamera.target=r.target.clone(),t.autocamCamera.pivot=r.pivot.clone(),t.autocamCamera.worldup=r.worldup.clone(),t.autocam=new P.Autocam(t.autocamCamera,t.navigation,t.canvas),t.autocam.setGlobalManager(this.globalManager),t.autocam.registerCallbackCameraChanged((function(e){t.autocamCamera.isPerspective!==r.isPerspective&&(t.autocamCamera.isPerspective?t.navigation.toPerspective():t.navigation.toOrthographic()),t.navigation.setVerticalFov(t.autocamCamera.fov,!1),t.navigation.setView(t.autocamCamera.position,t.autocamCamera.target),t.navigation.setPivotPoint(t.autocamCamera.pivot),t.navigation.setCameraUpVector(t.autocamCamera.up),e&&t.navigation.setWorldUpVector(t.autocamCamera.worldup),t.impl.syncCamera(e)})),t.autocam.registerCallbackPivotDisplay((function(e){t.utilities?t.utilities.pivotActive(e,!1):t.impl.controls.pivotActive(e,!1)})),t.autocam.registerCallbackTransitionCompleted((function(){t.fireEvent({type:A.CAMERA_TRANSITION_COMPLETED})})),t.addEventListener("cameraChanged",(function(e){var r=e.camera;t.autocam.sync(r)})),t.autocam.sync(r)},de.prototype.uninitialize=function(){var e;this.removeWindowEventListener("resize",this.onResizeCallback,!1),this.onResizeCallback=null,this.removeWindowEventListener("scroll",this.onScrollCallback),this.onScrollCallback=null,this.canvas?this.canvas.removeEventListener("mousedown",this.onMouseDown):this.container&&this.container.removeEventListener("mousedown",this.onMouseDown),this.onMouseDown=null,this.canvas?this.canvas.removeEventListener("mouseup",this.onMouseUp):this.container&&this.container.removeEventListener("mouseup",this.onMouseUp),this.onMouseUp=null,this.canvas.parentNode.removeChild(this.canvas),this.canvas.viewer=null,D.InitParametersSetting.canvas===this.canvas&&(D.InitParametersSetting.canvas=null),this.canvas=null,this.canvasWrap=null,this.viewerState=null,o.logger.reportRuntimeStats(),o.logger.track({category:"viewer_destroy"},!0),this.toolController&&(this.toolController.uninitialize(),this.toolController=null,this.clickHandler=null,this.utilities=null),this.navigation&&(this.navigation.uninitialize(),this.navigation=null),this.impl&&(this.impl.dtor(),this.impl=null),this.overlays&&(this.overlays.dtor(),this.overlays=null),this.loadSpinner=null,this._loadingSpinner.destroy(),this._loadingSpinner=null,this.prefs&&this.prefs.clearListeners(),this.prefs=null,this.profile=null,this.profileManager=null,this.autocam.dtor(),this.autocam=null,this.autocamCamera=null,this._hotkeyManager.popHotkeys("Autodesk.FitToView"),this._hotkeyManager.popHotkeys("Autodesk.Home"),this._hotkeyManager.popHotkeys("Autodesk.Escape"),this._hotkeyManager.popHotkeys("Autodesk.Pan"),this._hotkeyManager.popHotkeys("Autodesk.Orbit"),this._hotkeyManager=null,de.ViewerCount--,0===de.ViewerCount&&(0,M.clearPropertyWorkerCache)(),this.onDefaultContextMenu&&(this.container.removeEventListener("contextmenu",this.onDefaultContextMenu,!1),this.onDefaultContextMenu=null),this.screenModeDelegate&&(this.screenModeDelegate.uninitialize(),this.screenModeDelegate=null),this._displayEdges&&(this.removeEventListener(A.GEOMETRY_LOADED_EVENT,this._displayEdges),this._displayEdges=null),this._setDoubleSided&&(this.removeEventListener(A.MODEL_ADDED_EVENT,this._setDoubleSided),this._setDoubleSided=null),this.extensionCache=null,this.clientContainer=null,this.config=null,this.contextMenu=null,this.contextMenuCallbacks=null,this.container&&this.container.parentNode&&this.container.parentNode.removeChild(this.container),this.container=null,this._forgeLogo=null,this.dispatchEvent(A.VIEWER_UNINITIALIZED),this.listeners={};var t=ue.getGlobal();t.NOP_VIEWER===this&&(t.NOP_VIEWER=null);var r=null===(e=t.NOP_VIEWERS)||void 0===e?void 0:e.indexOf(this);-1!==r&&(t.NOP_VIEWERS.splice(r,1),0===t.NOP_VIEWERS.length&&(t.NOP_VIEWERS=null)),o.logger.log("viewer destroy")},de.prototype.finish=function(){this.tearDown(),this.uninitialize()},de.prototype.setLoadHeuristics=function(e){var t=e.bubbleNode;if(t){var r=t.findViewableParent();if(r){var n=r.name();e.fileExt=n.slice(n.length-3).toLowerCase();void 0===e.isAEC&&-1!==["rvt","nwd","nwc","ifc"].indexOf(e.fileExt)&&(e.isAEC=!0)}}if(e.isAEC){if(void 0===e.useConsolidation){var o=(0,h.getParameterByName)("useConsolidation")||"";e.useConsolidation="true"===o||"false"!==o&&void 0}void 0===e.useConsolidation&&(e.useConsolidation=!(0,i.isMobileDevice)()&&!(0,i.isNodeJS)()),void 0===e.createWireframe&&(e.createWireframe=!(0,i.isMobileDevice)()),void 0===e.disablePrecomputedNodeBoxes&&(e.disablePrecomputedNodeBoxes=!0)}else void 0===e.createWireframe&&(e.createWireframe=!(0,i.isMobileDevice)()&&this.prefs.get("edgeRendering"));e.useConsolidation&&!e.bvhOptions&&(e.bvhOptions={},R.Consolidation.applyBVHDefaults(e.bvhOptions))},de.prototype.trackADPSettingsOptions=function(){var e=this;this.trackADPTimer.push(setTimeout((function(){if(e.prefs){var t={category:"settingOptionsStatus",switchSheetColorWhiteToBlack:e.prefs.get("swapBlackAndWhite"),leftHandedMouseSetup:e.prefs.get("leftHandedMouseSetup"),openPropertiesOnSelect:e.prefs.get("openPropertiesOnSelect"),orbitPastWorldPoles:e.prefs.get("orbitPastWorldPoles"),reverseMouseZoomDirection:e.prefs.get("reverseMouseZoomDir"),fusionStyleOrbit:e.prefs.get("fusionOrbit"),setPivotWithLeftMouseButton:e.prefs.get("clickToSetCOI"),zoomTowardPivot:e.prefs.get("zoomTowardsPivot"),viewCubeActsOnPivot:e.prefs.get("alwaysUsePivot"),showViewCube:e.prefs.get("viewCube"),environmentImageVisible:e.prefs.get("envMapBackground"),displayEdges:e.prefs.get("edgeRendering"),displayPoints:e.prefs.get("pointRendering"),displayLines:e.prefs.get("lineRendering"),ghostHiddenObjects:e.prefs.get("ghosting"),groundReflection:e.prefs.get("groundReflection"),groundShadow:e.prefs.get("groundShadow"),ambientShadows:e.prefs.get("ambientShadows"),antiAliasing:e.prefs.get("antialiasing"),progressiveModelDisplay:e.prefs.get("progressiveRendering"),smoothNavigation:e.prefs.get("optimizeNavigation")};o.logger.track(t)}}),3e4))},de.prototype.trackADPExtensionsLoaded=function(){var e=this,t={category:"loaded_extensions"};this.trackADPTimer.push(setTimeout((function(){if(e.loadedExtensions)for(var r in e.loadedExtensions)t[r]=r;o.logger.track(t)}),3e4))},de.prototype.activateDefaultNavigationTools=function(e){if(!(0,i.isNodeJS)()){var t=e?"pan":"orbit";this.setDefaultNavigationTool(t),this.setActiveNavigationTool(t),this.toolController&&(this.toolController.enableMouseButtons(!0),this.toolController.activateTool("gestures"))}},de.prototype.registerDimensionSpecificHotkeys=function(e){if(this._hotkeyManager)if(e)this._hotkeyManager.popHotkeys("Autodesk.Orbit");else{var t,r=this,n=[{keycodes:[I.KeyCode.ALT],onPress:function(){return t=r.getActiveNavigationTool(),r.setActiveNavigationTool("orbit")},onRelease:function(){return r.setActiveNavigationTool(t)}}];this._hotkeyManager.pushHotkeys("Autodesk.Orbit",n,{tryUntilSuccess:!0})}},de.prototype.onModelAdded=function(e,t){var r,n;e.is2d()&&!e.isLeaflet()&&this.navigation.setMinimumLineWidth(null===(r=e.loader)||void 0===r||null===(n=r.svf)||void 0===n?void 0:n.minLineWidth);1===this.impl.modelQueue().getModels().length&&this.initializeFirstModelPresets(e,t)},de.prototype.initializeFirstModelPresets=function(e,t,r){if(e.is2d()&&this.activateLayerState("Initial"),r||e.getData().loadOptions.preserveView||(this.setActiveNavigationTool(),this.impl.setViewFromFile(e,!0),this.toolController.recordHomeView()),this.registerDimensionSpecificHotkeys(e.is2d()),t||this.activateDefaultNavigationTools(e.is2d()),this.navigation.setIs2D(this.impl.modelQueue().areAll2D()),e.isLeaflet()){var n=e.getData();this.navigation.setConstraints2D(n.bbox,n.maxPixelPerUnit)}else this.navigation.setConstraints2D()},de.prototype.loadModel=function(){var e,t=(e=regeneratorRuntime.mark((function e(t,r,n,a,c){var f,p,m,g,v,y,b,x,_,E,w,M,T;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(y=function(e,t,r){f._loadingSpinner.hide(),a&&a(e,t,r)},v=function(e,t){if(f.impl){if(f.impl._removeLoadingFile(g),e)return f.dispatchEvent({type:A.LOADER_LOAD_ERROR_EVENT,error:e,loader:g}),void y(e.code,e.msg,e.args);t.getData().underlayRaster=r.underlayRaster&&t.getLeaflet(),r.loadAsHidden?f.impl.modelQueue().addHiddenModel(t):f.impl.addModel(t),t.loader&&t.loader.notifiesFirstPixel&&f._loadingSpinner instanceof H?f.addEventListener(A.RENDER_FIRST_PIXEL,(function(){f._loadingSpinner.hide()}),{once:!0}):f._loadingSpinner.hide(),!(0,i.isNodeJS)()&&f._forgeLogo&&(f._forgeLogo.style.display="block"),n&&n(t)}},p=(f=this).impl._reserveLoadingFile(),void 0===(r=r||{}).skipPropertyDb&&(m=(0,h.getParameterByName)("skipPropertyDb")||"",r.skipPropertyDb="true"===m||"false"!==m&&void 0),b=t.toLowerCase().match(/\.([a-z0-9]+)(\?|$)/),x=b?b[1]:null,!(_=this.config&&this.config.loaderExtensions&&this.config.loaderExtensions[x]||x in q&&q[x])||this.isExtensionLoaded(_)){e.next=19;break}return e.prev=9,e.next=12,this.loadExtension(_,this.config);case 12:e.next=19;break;case 14:return e.prev=14,e.t0=e.catch(9),f.impl._removeLoadingFile(p),a&&a(d.ErrorCodes.VIEWER_INTERNAL_ERROR,e.t0.toString()),e.abrupt("return",!1);case 19:if(E=r&&r.fileLoader?r.fileLoader:S.FileLoaderManager.getFileLoaderForExtension(x)){e.next=25;break}return f.impl._removeLoadingFile(p),o.logger.error("File extension not supported:"+x,(0,d.errorCodeString)(d.ErrorCodes.UNSUPORTED_FILE_EXTENSION)),y(d.ErrorCodes.UNSUPORTED_FILE_EXTENSION,"File extension not supported",0,x),e.abrupt("return",!1);case 25:return this.setLoadHeuristics(r),this.impl.hasModels()||this._loadingSpinner.show(),"function"==typeof E.getExistingInstance&&(g=E.getExistingInstance(t,r,this.config)),g||(g=new E(this.impl,this.config)),f.impl._addLoadingFile(p,g),(w=g.loadFile(t,r,v,c))||f.impl._removeLoadingFile(g),this.fireEvent({type:A.LOADER_LOAD_FILE_EVENT,loader:g}),r.skipPrefs?(void 0===this.prefs.get(s.Prefs.DISPLAY_UNITS)&&this.prefs.set(s.Prefs.DISPLAY_UNITS,new l.EnumType(u.displayUnitsEnum)),void 0===this.prefs.get(s.Prefs.DISPLAY_UNITS_PRECISION)&&this.prefs.set(s.Prefs.DISPLAY_UNITS_PRECISION,new l.EnumType(u.displayUnitsPrecisionEnum))):(0,i.isNodeJS)()||this.profile||(M=this.chooseProfile(r),this.setProfile(M,!1)),T=$(t,x,w,r.bubbleNode),Q.analytics.track("viewer.model.load",T),e.abrupt("return",w);case 37:case"end":return e.stop()}}),e,this,[[9,14]])})),function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function a(e){le(o,n,i,a,s,"next",e)}function s(e){le(o,n,i,a,s,"throw",e)}a(void 0)}))});return function(e,r,n,i,o){return t.apply(this,arguments)}}(),de.prototype.isLoadDone=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.geometry,r=void 0===t||t,n=e.propDb,i=void 0===n||n,o=e.textures,a=void 0===o||o,s=e.hidden,l=void 0!==s&&s,u=e.onlyModels,c=void 0===u?void 0:u;if(!c){if(!this.started)return!0;if(this.impl._hasLoadingFile())return!1}if(a&&Autodesk.Viewing.Private.TextureLoader.requestsInProgress()>0)return!1;r=r||a;var h=function(e){return!e||(r?e.isLoadDone():e.modelRootLoaded)&&(!i||!e.getPropertyDb()||e.getPropertyDb().isLoadDone())};if(c)return Array.isArray(c)?c.every(h):h(c);var d=this.impl.modelQueue();return d.getModels().every(h)&&(!l||d.getHiddenModels().every(h))},de.prototype.waitForLoadDone=function(e){var t=this;return new Promise((function(r,n){var i=e||{},o=i.geometry,a=void 0===o||o,s=i.propDb,l=void 0===s||s,u=i.textures,c=void 0===u||u,h=i.hidden,d=void 0!==h&&h,f=i.onlyModels,p=void 0===f?void 0:f,m={geometry:a=a||c,propDb:l,textures:c,hidden:d,onlyModels:p},g=function(){return t.started&&(t.impl._hasLoadingFile()||t.impl.modelQueue().getModels().length>0||t.impl.modelQueue().getHiddenModels().length>0)},v=!p&&g();if(v&&t.isLoadDone(m))r();else{var y,b=function(){(v=v||g())&&t.isLoadDone(m)&&(y(),r())},x=function(e){y();var t=new Error("Error loading model");t.loader=e.loader,t.error=e.error,n(t)};y=function(){a&&t.removeEventListener(A.GEOMETRY_LOADED_EVENT,b),l&&(t.removeEventListener(A.OBJECT_TREE_CREATED_EVENT,b),t.removeEventListener(A.OBJECT_TREE_UNAVAILABLE_EVENT,b)),c&&t.removeEventListener(A.TEXTURES_LOADED_EVENT,b),t.removeEventListener(A.LOADER_LOAD_FILE_EVENT,b),t.removeEventListener(A.MODEL_ADDED_EVENT,b),t.removeEventListener(A.MODEL_REMOVED_EVENT,b),t.removeEventListener(A.LOADER_LOAD_ERROR_EVENT,x),t.removeEventListener(A.MODEL_ROOT_LOADED_EVENT,b),t.removeEventListener(A.VIEWER_UNINITIALIZED,r)},a&&t.addEventListener(A.GEOMETRY_LOADED_EVENT,b),l&&(t.addEventListener(A.OBJECT_TREE_CREATED_EVENT,b),t.addEventListener(A.OBJECT_TREE_UNAVAILABLE_EVENT,b)),c&&t.addEventListener(A.TEXTURES_LOADED_EVENT,b),t.addEventListener(A.LOADER_LOAD_FILE_EVENT,b),t.addEventListener(A.MODEL_ADDED_EVENT,b),t.addEventListener(A.MODEL_REMOVED_EVENT,b),t.addEventListener(A.LOADER_LOAD_ERROR_EVENT,x),t.addEventListener(A.MODEL_ROOT_LOADED_EVENT,b,{priority:-1e6}),t.addEventListener(A.VIEWER_UNINITIALIZED,(function(){return n(new Error("Promise reject because viewer finished"))}))}}))},de.prototype.unloadModel=function(e){e||(e=this.model),this.impl.unloadModel(e)},de.prototype.loadDocumentNode=function(e,t){var r=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=t,o=n.leafletOptions||{},a=e.getViewableUrn(i,o),s=i.findPropertyDbPath();a=e.getFullPath(a);var l={sharedPropertyDbPath:s=e.getFullPath(s),acmSessionId:e.getAcmSessionId(a),bubbleNode:i,applyRefPoint:!1,loadOptions:o,page:o.page||1};for(var u in l)Object.prototype.hasOwnProperty.call(n,u)||(n[u]=l[u]);if(!n.keepCurrentModels&&this.impl.hasModels()){var c=this.config;this.tearDown(),this.setUp(c)}var h=i.findParentGeom2Dor3D(),d=h.extensions();Array.isArray(d)&&d.forEach((function(e){r.loadExtension(e,r.config)}));var f=o.isPdf?this.loadExtension("Autodesk.PDF",this.config):Promise.resolve(),p=!n.disableUnderlayRaster&&o.tempRasterPath,m=p?this._loadTempRasterModel(e,n,i):Promise.resolve();return f.then((function(){return m})).then((function(e){return new Promise((function(t,o){p&&e&&e!==r.getUnderlayRaster(i)?o("load canceled"):r.loadModel(a,n,(function(e){n.loadAsHidden||n.preserveView||"view"!==i.type()||r.setView(i,{skipTransition:!0}),t(e)}),(function(e){o(e)}))}))}))},de.prototype.unloadDocumentNode=function(e){var t=this.impl.findModel(e,!0);if(t)return this.impl.unloadModel(t),!0;if(!this.impl.loaders)return!1;for(var r=0;r<this.impl.loaders.length;r++){var n=this.impl.loaders[r];if((n.options&&n.options.bubbleNode)===e)return n.dtor(),this.impl.loaders.splice(r,1),!0}return!1},de.prototype._loadTempRasterModel=function(e,t,r){var n=this;return new Promise((function(i,o){if(t.loadAsHidden)return i();t.underlayRaster=!0,t.loadOptions.fitPaperSize=!0;var a=function(e){var t,n,i=e.getDocumentNode();return i&&(null===(t=i.getDocument())||void 0===t?void 0:t.getPath())===(null===(n=r.getDocument())||void 0===n?void 0:n.getPath())&&i.guid()===r.guid()&&!e.isLeaflet()},s=function e(t){var r=t.model;a(r)&&(2===n.getVisibleModels().length&&n.initializeFirstModelPresets(r,!1,!0),n.removeEventListener(A.MODEL_ADDED_EVENT,e))};n.addEventListener(A.MODEL_ADDED_EVENT,s);var l,u=function e(t){var r=t.model;a(r)&&(r.changePaperVisibility(!0),n.removeEventListener(A.MODEL_REMOVED_EVENT,e),n.removeEventListener(A.MODEL_ADDED_EVENT,s),n.removeEventListener(A.GEOMETRY_LOADED_EVENT,c))};n.addEventListener(A.MODEL_REMOVED_EVENT,u);var c=function e(t){var r=t.model;a(r)&&(r.changePaperVisibility(!0),n.removeEventListener(A.MODEL_REMOVED_EVENT,u),l&&(n.unloadModel(l),l=null),n.removeEventListener(A.GEOMETRY_LOADED_EVENT,e))};n.addEventListener(A.GEOMETRY_LOADED_EVENT,c);var h=e.getFullPath(t.loadOptions.tempRasterPath);n.loadModel(h,t,(function(e){t.loadOptions.fitPaperSize=void 0,t.underlayRaster=void 0,t.hideBackground=!0,l=e,i(e)}),(function(e){if(t.loadOptions.fitPaperSize=void 0,t.underlayRaster=void 0,e===d.ErrorCodes.LOAD_CANCELED)return o("load canceled");i()}))}))},de.prototype.getDimensions=function(){if(this.container){var e={};return this.getScreenMode()===m.ScreenMode.kFullScreen?(e.width=screen.width,e.height=screen.height):e=this.container.getBoundingClientRect(),{width:e.width,height:e.height}}return null},de.prototype.resize=function(){this.container.clientWidth>0&&this.container.clientHeight>0&&this.impl.resize(this.container.clientWidth,this.container.clientHeight)},de.prototype.getHotkeyManager=function(){return this._hotkeyManager},de.prototype.getCamera=function(){return this.impl.camera},de.prototype.getState=function(e){return this.viewerState.getState(e)},de.prototype.restoreState=function(e,t,r){var n=this.viewerState.restoreState(e,t,r);return n&&this.dispatchEvent({type:A.VIEWER_STATE_RESTORED_EVENT,value:n}),n},de.prototype.setView=function(e,t){if(!(e&&e instanceof L.BubbleNode))return!1;var r=e.findParentGeom2Dor3D(),i=r&&this.impl.findModel(r,!0)||this.model;if(!i)return!1;var o=!!t&&t.skipTransition,a=!t||t.useExactCamera;if(e.getViewBox())return this.setViewFromViewBox(e.getViewBox(),e.name(),o),this.dispatchEvent({type:A.SET_VIEW_EVENT,view:e}),!0;var s=this.getCameraFromViewArray(e.data.camera,i);if(!s)return!1;this.impl.setViewFromCamera(s,o,a);var l=e.data.sectionPlane,u=e.data.sectionBox,c=e.data.sectionBoxTransform,h=i.getModelToViewerTransform();if(l){for(var d=[],f=0;f<l.length;f+=4){var p=new n.Plane(new n.Vector3(l[f+0],l[f+1],l[f+2]),l[f+3]);h&&p.applyMatrix4(h),d.push(new n.Vector4(p.normal.x,p.normal.y,p.normal.z,p.constant))}this.impl.setCutPlaneSet("__set_view",d)}else if(u&&c){var m=(new n.Matrix4).fromArray([c[0],c[1],c[2],c[3],c[4],c[5],c[6],c[7],c[8],c[9],c[10],c[11],c[12],c[13],c[14],c[15]]),g=new n.Vector3(u[0],u[1],u[2]),v=new n.Vector3(u[3],u[4],u[5]),y=new n.Box3(g,v),b=new n.Matrix4;b.copy(h),b.multiply(m);var x=W.SceneMath.box2CutPlanes(y,b);this.impl.setCutPlaneSet("__set_view",x)}else this.impl.setCutPlaneSet("__set_view",void 0);return this.dispatchEvent({type:A.SET_VIEW_EVENT,view:e}),!0},de.prototype.setViewType=function(e){this.model&&this.model.is2d()?o.logger.warn("Viewer3D.setViewType is not applicable to 2D"):this.prefs.set(s.Prefs3D.VIEW_TYPE,e)},de.prototype.setViewFromArray=function(e){var t=this.getCameraFromViewArray(e);this.impl.setViewFromCamera(t,!1,!0)},de.prototype.getCameraFromViewArray=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.model,r=null==t?void 0:t.getModelToViewerTransform();return L.BubbleNode.readCameraFromArray(e,r)},de.prototype.getViewArrayFromCamera=function(){var e=this.model?this.model.getData().globalOffset:{x:0,y:0,z:0};return this.impl.getViewArrayFromCamera(e)},de.prototype.setViewFromViewBox=function(e,t,r){var n=this.model;if(!n||n.is2d()){if(t&&t.length){var i,a=n.getData().metadata.views;for(i=0;i<a.length&&a[i].name!=t;i++);if(i<a.length){var s=a[i].layer_state;s&&this.activateLayerState(s)}}this.impl.setViewFromViewBox(this.model,e,t,r)}else o.logger.warn("Viewer3D.setViewFromViewBox is not applicable to 3D")},de.prototype.activateLayerState=function(e){this.impl.layers.activateLayerState(e),this.dispatchEvent({type:A.LAYER_VISIBILITY_CHANGED_EVENT})},de.prototype.getLayerStates=function(){return this.impl.layers.getLayerStates()},de.prototype.setViewFromFile=function(e){this.setActiveNavigationTool(),this.impl.setViewFromFile(e||this.model)},de.prototype.getProperties=function(e,t,r){this.model?this.model.getProperties(e,t,r):r&&r(d.ErrorCodes.BAD_DATA,"Properties failed to load since model does not exist")},de.prototype.getObjectTree=function(e,t){this.model?this.model.getObjectTree(e,t):t&&t(d.ErrorCodes.BAD_DATA,"ObjectTree failed to load since model does not exist")},de.prototype.setCanvasClickBehavior=function(e){if(Object.prototype.hasOwnProperty.call(this.impl.controls,"setClickBehavior")&&this.impl.controls.setClickBehavior(e),this.clickHandler&&this.clickHandler.setClickBehavior(e),e&&e.disableMouseWheel&&this.toolController.setMouseWheelInputEnabled(!1),e&&e.disableTwoFingerSwipe){var t=this.toolController.getTool("gestures");t&&t.disableTwoFingerSwipe()}},de.prototype.search=function(e,t,r,n){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{searchHidden:!1};this.searchText=e,this.model?this.model.search(e,t,r,n,i):r&&r(d.ErrorCodes.BAD_DATA,"Search failed since model does not exist")},de.prototype.getHiddenNodes=function(e){return e=e||this.model,this.impl.visibilityManager.getHiddenNodes(e)},de.prototype.getIsolatedNodes=function(e){return(e=e||this.model)&&e.is2d()?(o.logger.warn("Viewer3D.getIsolatedNodes is not yet implemented for 2D"),[]):this.impl.visibilityManager.getIsolatedNodes(e)},de.prototype.isolate=function(e,t){(t=t||this.model)&&this.impl.visibilityManager.isolate(e,t)},de.prototype.setBackgroundColor=function(e,t,r,n,i,o){this.impl.setClearColors(e,t,r,n,i,o)},de.prototype.setBackgroundOpacity=function(e){this.impl.setClearAlpha(e)},de.prototype.toggleSelect=function(e,t,r){(t=t||this.model)&&t.is2d()?o.logger.warn("Viewer3D.toggleSelect is not yet implemented for 2D"):this.impl.selector.toggleSelection(e,t,r)},de.prototype.select=function(e,t,r){"number"==typeof e&&(e=[e]),t=t||this.model,this.impl.selector.setSelection(e,t,r)},de.prototype.clearSelection=function(){this.impl.selector.clearSelection()},de.prototype.getSelectionVisibility=function(){return this.impl.selector.getSelectionVisibility()},de.prototype.getSelectionCount=function(){return this.impl.selector.getSelectionLength()},de.prototype.setSelectionMode=function(e){this.prefs.set(s.Prefs3D.SELECTION_MODE,e)},de.prototype.getSelection=function(){return this.impl.selector.getSelection()},de.prototype.lockSelection=function(e,t,r){r=r||this.model,this.impl.selector.lockSelection(e,t,r)},de.prototype.unlockSelection=function(e,t){this.impl.selector.unlockSelection(e,t)},de.prototype.isSelectionLocked=function(e,t){return this.impl.selector.isNodeSelectionLocked(e,t)},de.prototype.getAggregateSelection=function(e){var t=this.impl.selector.getAggregateSelection();if(e)for(var r=0;r<t.length;r++)for(var n=0;n<t[r].selection.length;n++)e(t[r].model,t[r].selection[n]);return t},de.prototype.setAggregateSelection=function(e){this.impl.selector.setAggregateSelection(e)},de.prototype.getAggregateIsolation=function(){return this.impl.visibilityManager.getAggregateIsolatedNodes()},de.prototype.getAggregateHiddenNodes=function(){return this.impl.visibilityManager.getAggregateHiddenNodes()},de.prototype.hide=function(e,t){t=t||this.model,this.impl.visibilityManager.hide(e,t)},de.prototype.show=function(e,t){t=t||this.model,this.impl.visibilityManager.show(e,t)},de.prototype.showAll=function(){this.impl.visibilityManager.aggregateIsolate([]),this.impl.layers.showAllLayers(),this.fireEvent({type:A.SHOW_ALL_EVENT})},de.prototype.hideAll=function(){var e=this;this.getVisibleModels().forEach((function(t){e.hide(t.getRootId(),t)})),this.fireEvent({type:A.HIDE_ALL_EVENT})},de.prototype.toggleVisibility=function(e,t){this.impl.visibilityManager.toggleVisibility(e,t)},de.prototype.areAllVisible=function(){return this.impl.isWholeModelVisible(this.model)},de.prototype.isNodeVisible=function(e,t){return t=t||this.model,this.impl.isNodeVisible(e,t)},de.prototype.lockVisible=function(e,t,r){r=r||this.model,this.impl.visibilityManager.lockNodeVisible(e,t,r)},de.prototype.toggleLockVisible=function(e,t){this.impl.visibilityManager.toggleVisibleLocked(e,t)},de.prototype.isVisibleLocked=function(e,t){return this.impl.visibilityManager.isNodeVisibleLocked(e,t)},de.prototype.explode=function(e){this.model&&(this.model.is2d()?o.logger.warn("Viewer3D.explode is not applicable to 2D"):this.impl.explode(e)&&o.logger.track({name:"explode_count",aggregate:"count"}))},de.prototype.getExplodeScale=function(){return this.model&&this.model.is2d()?(o.logger.warn("Viewer3D.getExplodeScale is not applicable to 2D"),0):this.impl.getExplodeScale()},de.prototype.lockExplode=function(e,t,r){return(r=r||this.model)&&r.is2d()?(o.logger.warn("Viewer3D.lockExplode is not applicable to 2D"),0):this.impl.lockExplode(e,t,r)},de.prototype.isExplodeLocked=function(e,t){return(t=t||this.model)&&t.is2d()?(o.logger.warn("Viewer3D.isExplodeLocked is not applicable to 2D"),0):this.impl.isExplodeLocked(e,t)},de.prototype.toggleLockExplode=function(e,t){return(t=t||this.model)&&t.is2d()?(o.logger.warn("Viewer3D.toggleLockExplode is not applicable to 2D"),0):this.impl.lockExplode(e,!this.isExplodeLocked(e,t),t)},de.prototype.setQualityLevel=function(e,t){this.model&&this.model.is2d()?o.logger.warn("Viewer3D.setQualityLevel is not applicable to 2D"):(this.prefs.set(s.Prefs3D.AMBIENT_SHADOWS,e),this.prefs.set(s.Prefs3D.ANTIALIASING,t))},de.prototype.setGhosting=function(e){this.model&&this.model.is2d()?o.logger.warn("Viewer3D.setGhosting is not applicable to 2D"):this.prefs.set(s.Prefs3D.GHOSTING,e)},de.prototype.setGroundShadow=function(e){this.model&&this.model.is2d()?o.logger.warn("Viewer3D.setGroundShadow is not applicable to 2D"):this.prefs.set(s.Prefs3D.GROUND_SHADOW,e)},de.prototype.setGroundReflection=function(e){this.model&&this.model.is2d()?o.logger.warn("Viewer3D.setGroundReflection is not applicable to 2D"):this.prefs.set(s.Prefs3D.GROUND_REFLECTION,e)},de.prototype.setEnvMapBackground=function(e){this.model&&this.model.is2d()?o.logger.warn("Viewer3D.setEnvMapBackground is not applicable to 2D"):this.prefs.set(s.Prefs3D.ENV_MAP_BACKGROUND,e)},de.prototype.setFirstPersonToolPopup=function(e){this.model&&this.model.is2d()?o.logger.warn("Viewer3D.setFirstPersonToolPopup is not applicable to 2D"):this.prefs.set(s.Prefs3D.FIRST_PERSON_TOOL_POPUP,e)},de.prototype.getFirstPersonToolPopup=function(){if(!this.model||!this.model.is2d())return this.prefs.get("firstPersonToolPopup");o.logger.warn("Viewer3D.getFirstPersonToolPopup is not applicable to 2D")},de.prototype.setBimWalkToolPopup=function(e){this.model&&this.model.is2d()?o.logger.warn("Viewer3D.setBimWalkToolPopup is not applicable to 2D"):this.prefs.set(s.Prefs3D.BIM_WALK_TOOL_POPUP,e)},de.prototype.getBimWalkToolPopup=function(){if(!this.model||!this.model.is2d())return this.prefs.get("bimWalkToolPopup");o.logger.warn("Viewer3D.getBimWalkToolPopup is not applicable to 2D")},de.prototype.setProgressiveRendering=function(e){this.prefs.set(s.Prefs.PROGRESSIVE_RENDERING,e)},de.prototype.setGrayscale=function(e){this.model&&this.model.is3d()?o.logger.warn("Viewer3D.setGrayscale is not applicable to 3D"):this.prefs.set(s.Prefs2D.GRAYSCALE,e)},de.prototype.setSwapBlackAndWhite=function(e){this.model&&this.model.is3d()?o.logger.warn("Viewer3D.setSwapBlackAndWhite is not applicable to 3D"):this.prefs.set(s.Prefs2D.SWAP_BLACK_AND_WHITE,e)},de.prototype.setOptimizeNavigation=function(e){this.model&&this.model.is2d()?o.logger.warn("Viewer3D.setOptimizeNaviation is not applicable to 2D"):this.prefs.set(s.Prefs3D.OPTIMIZE_NAVIGATION,e)},de.prototype.initializePrefListeners=function(){var e=this;this.prefs.addListeners(s.Prefs.KEY_MAP_CMD,(function(t){e.impl.toggleCmdMapping(t,e.toolController)})),this.prefs.addListeners(s.Prefs3D.ANTIALIASING,(function(t){var r=e.prefs.get(s.Prefs3D.AMBIENT_SHADOWS);e.impl.togglePostProcess(r,t)})),this.prefs.addListeners(s.Prefs3D.AMBIENT_SHADOWS,(function(t){var r=e.prefs.get(s.Prefs3D.ANTIALIASING);e.impl.togglePostProcess(t,r)})),this.prefs.addListeners(s.Prefs3D.GROUND_SHADOW,(function(t){e.impl.toggleGroundShadow(t)})),this.prefs.addListeners(s.Prefs3D.GROUND_REFLECTION,(function(t){e.impl.toggleGroundReflection(t)})),this.prefs.addListeners(s.Prefs3D.ENV_MAP_BACKGROUND,(function(t){e.impl.toggleEnvMapBackground(t)})),this.prefs.addListeners(s.Prefs.PROGRESSIVE_RENDERING,(function(t){e.impl.toggleProgressive(t)})),this.prefs.addListeners(s.Prefs3D.VIEW_TYPE,(function(t){var r=e.prefs.get(s.Prefs3D.VIEW_TYPE),n=e.impl.getModelCamera(e.model);if(n){var i=n.isPerspective;if(!isNaN(i)){var o=i?s.VIEW_TYPES.PERSPECTIVE:s.VIEW_TYPES.ORTHOGRAPHIC;e.prefs.setDefault(s.Prefs3D.VIEW_TYPE,o),r===s.VIEW_TYPES.DEFAULT&&(e.prefs[s.Prefs3D.VIEW_TYPE]=o)}}e.autocam.setViewType(t)})),this.prefs.addListeners(s.Prefs2D.GRAYSCALE,(function(t){e.impl.toggleGrayscale(t)})),this.prefs.addListeners(s.Prefs2D.SWAP_BLACK_AND_WHITE,(function(t){e.impl.toggleSwapBlackAndWhite(t)})),this.prefs.addListeners(s.Prefs3D.OPTIMIZE_NAVIGATION,(function(t){e.impl.setOptimizeNavigation(t)})),this.prefs.addListeners(s.Prefs3D.GHOSTING,(function(t){e.impl.toggleGhosting(t)})),this.prefs.addListeners(s.Prefs3D.LINE_RENDERING,(function(t){e.impl.hideLines(!t)})),this.prefs.addListeners(s.Prefs.POINT_RENDERING,(function(t){e.impl.hidePoints(!t)})),this.prefs.addListeners(s.Prefs3D.EDGE_RENDERING,(function(t){e._displayEdges=function(){e.impl.setDisplayEdges(t)},t||e.model&&e.model.isLoadDone()?e._displayEdges():e.addEventListener(A.GEOMETRY_LOADED_EVENT,e._displayEdges)})),this.prefs.addListeners(s.Prefs3D.LIGHT_PRESET,(function(t){var r=!1;if("string"==typeof t){for(var n=t,i=-1,a=0;a<K.LightPresets.length;a++)if(K.LightPresets[a].name===n){i=a;break}-1===i&&(o.logger.warn("Invalid Prefs3D.LIGHT_PRESET: "+t),o.logger.warn("Setting to default light preset."),r=!0),t=i}e.impl.setLightPreset(t,r)})),this.prefs.addListeners(s.Prefs3D.ALWAYS_USE_PIVOT,(function(t){e.navigation.setUsePivotAlways(t)})),this.prefs.addListeners(s.Prefs.REVERSE_MOUSE_ZOOM_DIR,(function(t){e.navigation.setReverseZoomDirection(t)})),this.prefs.addListeners(s.Prefs3D.REVERSE_HORIZONTAL_LOOK_DIRECTION,(function(t){e.navigation.setReverseHorizontalLookDirection(t)})),this.prefs.addListeners(s.Prefs3D.REVERSE_VERTICAL_LOOK_DIRECTION,(function(t){e.navigation.setReverseVerticalLookDirection(t)})),this.prefs.addListeners(s.Prefs3D.ZOOM_TOWARDS_PIVOT,(function(t){e.navigation.setZoomTowardsPivot(t)})),this.prefs.addListeners(s.Prefs3D.SELECTION_SETS_PIVOT,(function(t){e.navigation.setSelectionSetsPivot(t)})),this.prefs.addListeners(s.Prefs3D.ORBIT_PAST_WORLD_POLES,(function(t){e.navigation.setOrbitPastWorldPoles(t)})),this.prefs.addListeners(s.Prefs.LEFT_HANDED_MOUSE_SETUP,(function(t){e.navigation.setUseLeftHandedInput(t),p.EventUtils.setUseLeftHandedInput(t)})),this.prefs.addListeners(s.Prefs.WHEEL_SETS_PIVOT,(function(t){e.navigation.setWheelSetsPivot(t)})),this.prefs.addListeners(s.Prefs3D.SELECTION_MODE,(function(t){e.impl.selector.setSelectionMode(t)})),this.prefs.addListeners(s.Prefs.BACKGROUND_COLOR_PRESET,(function(t){if(t)try{var r=JSON.parse(t);e.impl.setClearColors(r[0],r[1],r[2],r[3],r[4],r[5])}catch(e){o.logger.warn("Invalid Prefs.BACKGROUND_COLOR_PRESET: "+r)}})),this.prefs.addListeners(s.Prefs3D.EXPLODE_STRATEGY,(function(t){Z.i.setStrategy(t)&&e.impl.refreshExplode()})),this.prefs.addListeners(s.Prefs2D.LOADING_ANIMATION,(function(t){e.impl.onLoadingAnimationChanged(t)}));var t={};this.prefs.addListeners(s.Prefs3D.FORCE_DOUBLE_SIDED,(function(r){function n(e){return"boolean"==typeof r?r:!!r[e.id]}e._setDoubleSided=function(r){var i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=r.model,a=n(o),s=o.getData();Object.prototype.hasOwnProperty.call(t,o.id)||(t[o.id]=!!s.doubleSided);var l=a||!!s.doubleSided;l!==t[o.id]&&(e.impl.setDoubleSided(l,o,i),t[o.id]=l)};var i=e.impl.modelQueue().getModels();0===i.length?e.addEventListener(A.MODEL_ADDED_EVENT,e._setDoubleSided):(i.forEach((function(t){e._setDoubleSided({model:t},!1)})),e.impl.sceneUpdated())}))},de.prototype.setNavigationLock=function(e){var t=this.navigation.getIsLocked();return t!==e&&(this.navigation.setIsLocked(e),this.dispatchEvent({type:A.NAVIGATION_MODE_CHANGED_EVENT,id:this.getActiveNavigationTool()})),t},de.prototype.getNavigationLock=function(){return this.navigation.getIsLocked()},de.prototype.setNavigationLockSettings=function(e){this.navigation.setLockSettings(e),this.dispatchEvent({type:A.NAVIGATION_MODE_CHANGED_EVENT,id:this.getActiveNavigationTool()})},de.prototype.getNavigationLockSettings=function(){return this.navigation.getLockSettings()},de.prototype.setActiveNavigationTool=function(e){if(e===this._pushedTool||!e&&!this._pushedTool)return!0;if(this._pushedTool){if(!this.impl.controls.deactivateTool(this._pushedTool))return!1;this.impl.controls.setToolActiveName(this.getDefaultNavigationToolName()),this._pushedTool=null}return(!e||e===this.getDefaultNavigationToolName())&&null===this._pushedTool?(this.dispatchEvent({type:A.NAVIGATION_MODE_CHANGED_EVENT,id:this.getDefaultNavigationToolName()}),!0):!!this.impl.controls.activateTool(e)&&(this._pushedTool=e,this.dispatchEvent({type:A.NAVIGATION_MODE_CHANGED_EVENT,id:this._pushedTool}),!0)},de.prototype.getActiveNavigationTool=function(){return this._pushedTool?this._pushedTool:this._defaultNavigationTool},de.prototype.setDefaultNavigationTool=function(e){this._defaultNavigationTool&&this.impl.controls.deactivateTool(this._defaultNavigationTool);var t=this._pushedTool;this._pushedTool=null,t&&this.impl.controls.deactivateTool(t),this.impl.controls.activateTool(e),this._defaultNavigationTool=e,t&&(this.impl.controls.activateTool(t),this._pushedTool=t)},de.prototype.getDefaultNavigationToolName=function(){return this._defaultNavigationTool},de.prototype.getFOV=function(){return this.navigation.getVerticalFov()},de.prototype.setFOV=function(e){this.navigation.setVerticalFov(e,!0)},de.prototype.getFocalLength=function(){return this.navigation.getFocalLength()},de.prototype.setFocalLength=function(e){this.navigation.setFocalLength(e,!0)},de.prototype.hideLines=function(e){this.model&&this.model.is2d()?o.logger.warn("Viewer3D.hideLines is not applicable to 2D"):this.prefs.set(s.Prefs3D.LINE_RENDERING,!e)},de.prototype.hidePoints=function(e){this.prefs.set(s.Prefs.POINT_RENDERING,!e)},de.prototype.setDisplayEdges=function(e){this.model&&this.model.is2d()?o.logger.warn("Viewer3D.setDisplayEdges is not applicable to 2D"):this.prefs.set(s.Prefs3D.EDGE_RENDERING,e)},de.prototype.applyCamera=function(e,t){this.impl.setViewFromCamera(e,!0),t&&this.fitToView()},de.prototype.fitToView=function(e,t,r){var n=[];e&&(e.length>0&&e[0].model?n=e:e.length>0&&n.push({model:t||this.model,selection:e})),this.impl.fitToView(n,r)},de.prototype.setClickConfig=function(e,t,r){var n=this.clickHandler?this.clickHandler.getClickBehavior():this.impl.controls.getClickBehavior();if(e in n){var i=n[e];if(t in i)return i[t]=r,!0}return!1},de.prototype.getClickConfig=function(e,t){var r=this.clickHandler?this.clickHandler.getClickBehavior():this.impl.controls.getClickBehavior();if(e in r){var n=r[e];if(t in n)return n[t]}return null},de.prototype.setClickToSetCOI=function(e,t){!1!==t&&this.prefs.set(s.Prefs3D.CLICK_TO_SET_COI,e);var r=this.getClickConfig("click","onObject");e?-1===r.indexOf("setCOI")&&this.setClickConfig("click","onObject",["setCOI"]):r.indexOf("setCOI")>=0&&this.setClickConfig("click","onObject",["selectOnly"])},de.prototype.setProfile=function(e,t){var r=this;if(!e)return!1;this.profile=e,this.profile.apply(this.prefs,t);var n=this.profile.extensions&&this.profile.extensions.unload||[],i=this.profile.extensions&&this.profile.extensions.load||[];n.forEach((function(e){r.isExtensionLoaded(e)&&r.unloadExtension(e)})),i.forEach((function(e){r.isExtensionLoaded(e)||r.loadExtension(e,r.config)})),this.dispatchEvent({type:Autodesk.Viewing.PROFILE_CHANGE_EVENT,profile:e})},de.prototype.initSettings=function(e){if(!this.profile){var t=new a.Profile(e);this.setProfile(t)}},de.prototype.setLightPreset=function(e){this.model&&this.model.is2d()?o.logger.warn("Viewer3D.setLightPreset is not applicable to 2D"):this.prefs.set(s.Prefs3D.LIGHT_PRESET,e)},de.prototype.setUsePivotAlways=function(e){this.model&&this.model.is2d()?o.logger.warn("Viewer3D.setUsePivotAlways is not applicable to 2D"):this.prefs.set(s.Prefs3D.ALWAYS_USE_PIVOT,e)},de.prototype.setReverseZoomDirection=function(e){this.prefs.set(s.Prefs.REVERSE_MOUSE_ZOOM_DIR,e)},de.prototype.setReverseHorizontalLookDirection=function(e){this.model&&this.model.is2d()?o.logger.warn("Viewer3D.setReverseHorizontalLookDirection is not applicable to 2D"):this.prefs.set(s.Prefs3D.REVERSE_HORIZONTAL_LOOK_DIRECTION,e)},de.prototype.setReverseVerticalLookDirection=function(e){this.model&&this.model.is2d()?o.logger.warn("Viewer3D.setReverseVerticalLookDirection is not applicable to 2D"):this.prefs.set(s.Prefs3D.REVERSE_VERTICAL_LOOK_DIRECTION,e)},de.prototype.setZoomTowardsPivot=function(e){this.model&&this.model.is2d()?o.logger.warn("Viewer3D.setZoomTowardsPivot is not applicable to 2D"):this.prefs.set(s.Prefs3D.ZOOM_TOWARDS_PIVOT,e)},de.prototype.setOrbitPastWorldPoles=function(e){this.model&&this.model.is2d()?o.logger.warn("Viewer3D.setOrbitPastWorldPoles is not applicable to 2D"):this.prefs.set(s.Prefs3D.ORBIT_PAST_WORLD_POLES,e)},de.prototype.setUseLeftHandedInput=function(e){this.prefs.set(s.Prefs.LEFT_HANDED_MOUSE_SETUP,e)},de.prototype.setDisplayUnits=function(e){this.prefs.set(s.Prefs.DISPLAY_UNITS,e)},de.prototype.setDisplayUnitsPrecision=function(e){null==e&&(e=""),this.prefs.set(s.Prefs.DISPLAY_UNITS_PRECISION,e)},de.prototype.setLayerVisible=function(e,t,r){var n=this.impl.layers;null===e?t?n.showAllLayers():n.hideAllLayers():(Array.isArray(e)||(e=[e]),r&&n.hideAllLayers(),this.impl.setLayerVisible(e,t)),this.dispatchEvent({type:A.LAYER_VISIBILITY_CHANGED_EVENT})},de.prototype.isLayerVisible=function(e){return!!(e&&e.isLayer&&this.impl.isLayerVisible(e))},de.prototype.anyLayerHidden=function(){for(var e=this.impl.getLayersRoot(),t=e&&e.children,r=t?t.length:0,n=0;n<r;++n)if(!this.impl.layers.isLayerVisible(t[n]))return!0;return!1},de.prototype.allLayersHidden=function(){for(var e=this.impl.getLayersRoot(),t=e&&e.children,r=t?t.length:0,n=0;n<r;++n)if(this.impl.layers.isLayerVisible(t[n]))return!1;return!0},de.prototype.setGroundShadowColor=function(e){this.model&&this.model.is2d()?o.logger.warn("Viewer3D.setGroundShadowColor is not applicable to 2D"):this.impl.setGroundShadowColor(e)},de.prototype.setGroundShadowAlpha=function(e){this.model&&this.model.is2d()?o.logger.warn("Viewer3D.setGroundShadowAlpha is not applicable to 2D"):this.impl.setGroundShadowAlpha(e)},de.prototype.setGroundReflectionColor=function(e){this.model&&this.model.is2d()?o.logger.warn("Viewer3D.setGroundReflectionColor is not applicable to 2D"):this.impl.setGroundReflectionColor(e)},de.prototype.setGroundReflectionAlpha=function(e){this.model&&this.model.is2d()?o.logger.warn("Viewer3D.setGroundReflectionAlpha is not applicable to 2D"):this.impl.setGroundReflectionAlpha(e)},de.prototype.getCutPlanes=function(){return this.model&&this.model.is2d()?(o.logger.warn("Viewer3D.getCutPlanes is not applicable to 2D"),[]):this.impl.getCutPlanes()},de.prototype.setCutPlanes=function(e){this.model&&this.model.is2d()?o.logger.warn("Viewer3D.getCutPlanes is not applicable to 2D"):this.impl.setCutPlaneSet("__set_view",e)},de.prototype.getScreenShot=function(e,t,r,n){return j.ScreenShot.getScreenShotLegacy(this,e,t,r,n)},de.prototype.setContextMenu=function(e){this.contextMenu&&this.contextMenu.hide(),this.contextMenu=e||null},de.prototype.setDefaultContextMenu=function(){var e=Autodesk.Viewing.Extensions;return!(!e||!e.ViewerObjectContextMenu)&&(this.setContextMenu(new e.ViewerObjectContextMenu(this)),!0)},de.prototype.triggerContextMenu=function(e){return this.config&&this.config.onTriggerContextMenuCallback&&this.config.onTriggerContextMenuCallback(e),!!this.contextMenu&&(this.contextMenu.show(e),!0)},de.prototype.triggerSelectionChanged=function(e){this.config&&this.config.onTriggerSelectionChangedCallback&&this.config.onTriggerSelectionChangedCallback(e)},de.prototype.triggerDoubleTapCallback=function(e){this.config&&this.config.onTriggerDoubleTapCallback&&this.config.onTriggerDoubleTapCallback(e)},de.prototype.triggerSingleTapCallback=function(e){this.config&&this.config.onTriggerSingleTapCallback&&this.config.onTriggerSingleTapCallback(e)},de.prototype.triggerSwipeCallback=function(e){this.config&&this.config.onTriggerSwipeCallback&&this.config.onTriggerSwipeCallback(e)},de.prototype.initContextMenu=function(){(!this.config||!Object.prototype.hasOwnProperty.call(this.config,"disableBrowserContextMenu")||this.config.disableBrowserContextMenu)&&(this.onDefaultContextMenu=function(e){e.preventDefault()},this.container.addEventListener("contextmenu",this.onDefaultContextMenu,!1));var e=this,t=this.canvas||this.container;this.onMouseDown=function(t){p.EventUtils.isRightClick(t)&&(e.startX=t.clientX,e.startY=t.clientY)},t.addEventListener("mousedown",this.onMouseDown),this.onMouseUp=function(t){return p.EventUtils.isRightClick(t)&&t.clientX===e.startX&&t.clientY===e.startY&&e.triggerContextMenu(t),!0},t.addEventListener("mouseup",this.onMouseUp,!1)},de.prototype.registerContextMenuCallback=function(e,t){this.contextMenuCallbacks[e]=t},de.prototype.unregisterContextMenuCallback=function(e){return e in this.contextMenuCallbacks&&(delete this.contextMenuCallbacks[e],!0)},de.prototype.runContextMenuCallbacks=function(e,t){for(var r in this.contextMenuCallbacks)Object.prototype.hasOwnProperty.call(this.contextMenuCallbacks,r)&&this.contextMenuCallbacks[r](e,t)},de.prototype.joinLiveReview=function(e){var t=this;this.loadExtension("Autodesk.Viewing.Collaboration").then((function(r){r.joinLiveReview.call(t,e)}))},de.prototype.leaveLiveReview=function(){var e=this;this.loadExtension("Autodesk.Viewing.Collaboration").then((function(t){t.leaveLiveReview.call(e)}))},de.prototype.setModelUnits=function(e){this.model&&(this.model.getData().overriddenUnits=e)},de.prototype.worldToClient=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.impl.camera;return this.impl.worldToClient(e,t)},de.prototype.clientToWorld=function(e,t,r,n){return this.impl.clientToWorld(e,t,r,n)},de.prototype.modelHasTopology=function(){return!(!this.model||!this.model.hasTopology())},de.prototype.setSelectionColor=function(e,t){this.impl.setSelectionColor(e,t)},de.prototype.set2dSelectionColor=function(e,t){this.impl.set2dSelectionColor(e,t)},de.prototype.setTheme=function(e){for(var t=this.container.classList,r=0;r<t.length;++r){-1!==t[r].indexOf("-theme")&&t.remove(t[r--])}t.add(e)},de.prototype.setThemingColor=function(e,t,r,n){(r=r||this.model).setThemingColor(e,t,n),this.impl.invalidate(!0)},de.prototype.clearThemingColors=function(e){(e=e||this.model).clearThemingColors(),this.impl.invalidate(!0)},de.prototype.transferModel=function(e,t){var r,n=this.impl.findModel(e);if(n){var i=[];this.getAggregateSelection((function(t,r){t.id==e&&i.push(r)}));var o=this.impl.visibilityManager.getIsolatedNodes(n),a=this.impl.visibilityManager.getHiddenNodes(n),s=this.impl.matman().exportModelMaterials(n);this.impl.unloadModel(n,!0),null===(r=n.getFragmentList())||void 0===r||r.dispose(this.impl.glrenderer()),n.isAEC()&&n.is3d()&&t.impl.setLightPresetForAec(),t.impl.setRenderingPrefsFor2D(n.is2d()),t.impl.addModel(n),t.impl.matman().importModelMaterials(s,e),t._loadingSpinner.hide(),n.loader&&n.loader.viewer3DImpl===this.impl&&(n.loader.viewer3DImpl=t.impl),n.getData().loadDone&&t.impl.onLoadComplete(n),t.impl.selector.setSelection(i,n),0!=o.length?t.impl.visibilityManager.isolate(o,n):0!=a.length&&t.impl.visibilityManager.hide(a,n)}},de.prototype.hideModel=function(e){var t=this.impl.modelQueue();return!!(e="number"==typeof e?t.findModel(e):e)&&(this.impl.removeModel(e),t.addHiddenModel(e),!0)},de.prototype.showModel=function(e,t){var r=this.impl.modelQueue();return!!(e="number"==typeof e?r.findHiddenModel(e):e)&&(r.removeHiddenModel(e),this.impl.addModel(e,t),!0)},de.prototype.getVisibleModels=function(){return this.impl.modelQueue().getModels().slice()},de.prototype.getHiddenModels=function(){return this.impl.modelQueue().getHiddenModels().slice()},de.prototype.getAllModels=function(){return this.impl.modelQueue().getAllModels().slice()},de.prototype.getUnderlayRaster=function(e){return this.getAllModels().find((function(t){var r,n,i=t.getDocumentNode();return i&&(null===(r=i.getDocument())||void 0===r?void 0:r.getPath())===(null===(n=e.getDocument())||void 0===n?void 0:n.getPath())&&i.guid()===e.guid()&&t.getData().underlayRaster}))},de.prototype.restoreDefaultSettings=function(){var e=this.model,t=e.is2d()?"2d":"3d";this.prefs.reset(t),this.impl.setupLighting(e),e.isAEC()&&e.is3d()&&this.impl.setLightPresetForAec(),this.impl.setRenderingPrefsFor2D(!e.is3d()),this.fireEvent({type:A.RESTORE_DEFAULT_SETTINGS_EVENT})},de.prototype.disableHighlight=function(e){this.impl.disableHighlight(e)},de.prototype.disableSelection=function(e){e&&this.clearSelection(),this.impl.disableSelection(e)},de.prototype.isHighlightDisabled=function(){return this.impl.selector.highlightDisabled},de.prototype.isHighlightPaused=function(){return this.impl.selector.highlightPaused},de.prototype.isHighlightActive=function(){return!(this.impl.selector.highlightDisabled||this.impl.selector.highlightPaused)},de.prototype.isSelectionDisabled=function(){return this.impl.selector.selectionDisabled},de.prototype.activateExtension=function(e,t){return this.loadedExtensions&&e in this.loadedExtensions?this.loadedExtensions[e].activate(t):(o.logger.warn("Extension is not loaded or doesn't exist"),!1)},de.prototype.deactivateExtension=function(e){return this.loadedExtensions&&e in this.loadedExtensions?this.loadedExtensions[e].deactivate():(o.logger.warn("Extension is not loaded or doesn't exist"),!1)},de.prototype.isExtensionActive=function(e,t){return this.loadedExtensions&&e in this.loadedExtensions?this.loadedExtensions[e].isActive(t):(o.logger.warn("Extension is not loaded or doesn't exist"),!1)},de.prototype.isExtensionLoaded=function(e){return this.loadedExtensions&&e in this.loadedExtensions},de.prototype.getLoadedExtensions=function(){return this.loadedExtensions||[]},de.prototype.getExtensionModes=function(e){return this.loadedExtensions&&e in this.loadedExtensions?this.loadedExtensions[e].getModes():(console.warn("Extension is not loaded or doesn't exist"),[])},de.prototype.reorderElements=function(e){var t=e.getAttribute("layer-order-id"),r=this.containerLayerOrder.indexOf(t),n=null;if(-1!==r)for(var i=r+1;i<this.containerLayerOrder.length&&!n;i++)n=this.container.querySelector('[layer-order-id="'+this.containerLayerOrder[i]+'"]');n?this.container.insertBefore(e,n):this.container.appendChild(e)},de.prototype.appendOrderedElementToViewer=function(e){var t=this.container.querySelector('[layer-order-id="'+e+'"]');if(t)return t;var r=this.getDocument().createElement("div");return r.setAttribute("layer-order-id",e),this.reorderElements(r),r},de.prototype.hitTest=function(e,t,r){return this.impl.hitTest(e,t,r)},de.prototype.refresh=function(e){this.impl.invalidate(e,!1,!e)},de.prototype.chooseProfile=function(e){var t=this.profileManager.PROFILE_DEFAULT;return this.config&&this.config.profileSettings?t=new a.Profile(this.config.profileSettings):e&&e.useFileProfile?t=this.profileManager.getProfileOrDefault(e.fileExt):e.isAEC&&(t=this.profileManager.PROFILE_AEC),t}},44245:(e,t,r)=>{"use strict";r.r(t),r.d(t,{InitParametersSetting:()=>ge,Viewer3DImpl:()=>ye,createRenderer:()=>ve});var n=r(84998),i=r(66904),o=r(18588),a=r(23305),s=r(26842),l=r(49514),u=r(2799),c=r(30093),h=r(95018),d=r(83359),f=r(19115),p=r(98926),m=r(50005),g=r(31102),v=r(2727),y=r(57658),b=r(5106),x=r(25119),_=r(77416),E=r(24032),w=r(282),A=r(4388),S=r(17167),M=r(97339),T=r(48862),C=r(89812),P=r(23909),D=r(93382),L=r(37169),R=r(10831),I=r(26074),O=r(77368),N=r(27820),k=r(35449),F=r(55412),V=r(98603),U=r(62546),B=r(46759),z=r(42713);function G(e){return G="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},G(e)}function H(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return W(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return W(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function W(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function j(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function q(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function X(e,t){return X=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},X(e,t)}function Y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Q(e);if(t){var i=Q(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return K(this,r)}}function K(e,t){if(t&&("object"===G(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Z(e)}function Z(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Q(e){return Q=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Q(e)}function J(e,t,r){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,r)}function $(e,t){return function(e,t){if(t.get)return t.get.call(e);return t.value}(e,te(e,t,"get"))}function ee(e,t,r){return function(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}(e,te(e,t,"set"),r),r}function te(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}var re,ne={WEBGL_CONTEXT_LOST:"webglcontextlost",WEBGL_CONTEXT_RESTORED:"webglcontextrestored"};re=z.WebGLRenderer;var ie=new WeakMap,oe=new WeakMap,ae=new WeakMap,se=new WeakMap,le=new WeakMap,ue=new WeakMap,ce=new WeakMap,he=new WeakMap,de=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&X(e,t)}(o,e);var t,r,n,i=Y(o);function o(){var e,t,r,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return j(this,o),J(Z(r=i.call(this,n)),ie,{writable:!0,value:void 0}),J(Z(r),oe,{writable:!0,value:void 0}),J(Z(r),ae,{writable:!0,value:void 0}),J(Z(r),se,{writable:!0,value:void 0}),J(Z(r),le,{writable:!0,value:void 0}),J(Z(r),ue,{writable:!0,value:void 0}),J(Z(r),ce,{writable:!0,value:void 0}),J(Z(r),he,{writable:!0,value:void 0}),null===(e=n.canvas)||void 0===e||e.addEventListener("webglcontextlost",(function(){r.fireEvent({type:ne.WEBGL_CONTEXT_LOST})})),null===(t=n.canvas)||void 0===t||t.addEventListener("webglcontextrestored",(function(){r.fireEvent({type:ne.WEBGL_CONTEXT_RESTORED})})),r.refCount=0,ee(Z(r),ie,[]),ee(Z(r),oe,-1),r.highResTimeStamp=-1,ee(Z(r),ae,r.render),ee(Z(r),se,r.setRenderTarget),r.render=o.prototype.render.bind(Z(r)),r.setRenderTarget=o.prototype.setRenderTarget.bind(Z(r)),r}return t=o,(r=[{key:"supportsMRT",value:function(){return this.capabilities.isWebGL2||this.extensions.get("WEBGL_draw_buffers")}},{key:"verifyMRTWorks",value:function(e){var t=!1;return this.supportsMRT()&&(t=this.initFrameBufferMRT(e,!0)),t}},{key:"updateTimestamp",value:function(e){return this.highResTimeStamp=e}},{key:"getLoadingAnimationDuration",value:function(){return $(this,oe)}},{key:"setLoadingAnimationDuration",value:function(e){return ee(this,oe,e)}},{key:"addAnimationLoop",value:function(e){var t=this;$(this,ie).push(e),this.setAnimationLoop((function(e){var r,n=H($(t,ie));try{for(n.s();!(r=n.n()).done;)(0,r.value)(e)}catch(e){n.e(e)}finally{n.f()}}))}},{key:"removeAnimationLoop",value:function(e){for(var t=0;t<$(this,ie).length;++t)if($(this,ie)[t]===e){$(this,ie).splice(t,1);break}0===$(this,ie).length&&this.setAnimationLoop(null)}},{key:"clearBlend",value:function(){this.state.setBlending(P.NoBlending)}},{key:"isWebGL2",value:function(){return console.warn("LMVRenderer: .isWebGL2() has been deprecated. Use .capabilities.isWebGL2 instead."),this.capabilities.isWebGL2}},{key:"_renderLMVRenderable",value:function(e,t){var r=this;e.isScene?$(this,ae).call(this,e,t):e.forEach((function(n){var i=n.material;e.overrideMaterial&&(n.material=e.overrideMaterial),$(r,ae).call(r,n,t),n.material=i}),e.renderImmediate?e.forceVisible?B.MeshFlags.MESH_VISIBLE:B.MeshFlags.MESH_RENDERFLAG:void 0)}},{key:"render",value:function(e,t,r){$(this,ae).call(this,e,t,!1,r)}},{key:"setRenderTarget",value:function(e){$(this,se).call(this,e)}}])&&q(t.prototype,r),n&&q(t,n),Object.defineProperty(t,"prototype",{writable:!1}),o}(re);U.EventDispatcher.prototype.apply(de.prototype),de.Events=ne;var fe=null,pe=(0,n.getGlobal)().ENABLE_DEBUG,me=(0,n.getGlobal)().ENABLE_DEBUG_RCS,ge={canvas:null,antialias:!1,alpha:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!0,stencil:!1,depth:!1};function ve(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!(0,n.isNodeJS)()){var r,i=Object.assign({},ge,t);i.canvas=e;try{r=new de(i)}catch(e){return null}return r.name="MainRenderer",!r.getContext||r.getContext&&!r.getContext()?null:(r.autoClear=!1,r.sortObjects=!1,r)}}function ye(e,t){var r=this,k=this;this.setGlobalManager(t.globalManager);var U,B,z,G,H,W,j,q,X,Y,K,Z,Q,J,$=1e3/15,ee=1e3/30,te=1,re=-1,ne=-1,ie=-1,oe=null,ae="y",se=null,le=null,ue=null,ce=!1,he=!1,ge=!1,ye={type:L.PROGRESS_UPDATE_EVENT,state:o.ProgressState.LOADING,percent:0},be=!1,xe=!1,_e=!1,Ee=0,we=0,Ae=1e3/60,Se=0,Me=!0,Te=!1,Ce=!1,Pe=null,De=null;this.edgeColorMain=new P.Vector4(0,0,0,.3),this.edgeColorGhosted=new P.Vector4(0,0,0,.1);var Le,Re,Ie,Oe=(0,n.getGlobal)(),Ne=function(e){var t=e.model;r.canvas&&t&&t.getData()&&t.getData().stdSurfMats&&t.getData().stdSurfMats.materials&&r.api.loadExtension("Autodesk.StandardSurface").then((function(e){e&&e.processModel(t)}))},ke=function(e){return e.model.modelRootLoaded=!0},Fe={},Ve="",Ue=!0;function Be(e){var t,r=null===(t=e.frags)||void 0===t?void 0:t.is2d,n=Le.phase,i=!0,o=n==v.RenderFlags.RENDER_NORMAL,a=q.settings.idbuffer&&n!=v.RenderFlags.RENDER_HIDDEN,s=n==v.RenderFlags.RENDER_HIDDEN?k.edgeColorGhosted:k.edgeColorMain;q.setEdgeColor(s),n!=v.RenderFlags.RENDER_HIDDEN||e.ignoreFadeMaterial?n==v.RenderFlags.RENDER_HIGHLIGHTED&&(e.overrideMaterial=k.highlightMaterial):e.overrideMaterial=k.fadeMaterial;var l={type:L.RENDER_SCENE_PART,scene:e,wantColor:i,wantSAO:o,wantID:a,context:q};k.api.dispatchEvent(l),!k.is2d&&r?k.getSheetRenderer().renderScenePart(e,i,o,a):q.renderScenePart(e,i,o,a),e.overrideMaterial=null}function ze(e){z&&(k.canvasBoundingclientRectDirty=!0,k.camera.aspect=G/H,k.camera.clientWidth=G,k.camera.clientHeight=H,q.setSize(G,H),k.controls.handleResize(),Q&&Q.setSize(G,H),X&&X.setSize(),k.invalidate(!0,!0,!0),z=!1,e||k.api.dispatchEvent({type:L.VIEWER_RESIZE_EVENT,width:G,height:H}))}function Ge(){var e;if((Z.enabled||Q)&&!k.is2d&&(e=k.model&&!k.model.isLoadDone()?k.model.getData().bbox:k.getVisibleBounds(!0,!1))){var t=k.camera,r=e.clone(),n=new P.Vector3(1,0,0),i=le.clone();t.worldUpTransform&&(r.applyMatrix4(t.worldUpTransform),n.applyMatrix4(t.worldUpTransform),i.applyMatrix4(t.worldUpTransform)),r.min.y-=.005*(r.max.y-r.min.y),Y&&Y.expandByGroundShadow(r,i);var o=r.getSize(new P.Vector3),a=r.getCenter(new P.Vector3);if(Y||(o.x*=1.25,o.z*=1.25,o.x=o.z=Math.max(o.x,o.z)),t.worldUpTransform){var s=t.worldUpTransform.clone().invert();a.applyMatrix4(s)}if(Z.setTransform(a,o,t.worldup,n),Q){var l=(new P.Vector3).subVectors(a,t.worldup.clone().multiplyScalar(o.y/2));Q.setTransform(l,t.worldup,o)}Y&&Y.setGroundShadowTransform(a,o,t.worldup,n)}}function He(){Y&&(Y.state=y.SHADOWMAP_NEEDS_UPDATE)}e&&(this.interval=setInterval((function(){Me||Se<60||k.track({name:"fps",value:Number(k.fps().toFixed(2)),aggregate:"last"})}),3e4)),this.api=t,this.canvas=e,this.loader=null,this.canvasBoundingclientRectDirty=!0,this.nearRadius=0,this.defaultLoadingAnimationDuration=300,this.lastTime2dGeometryCreated=0,this.maxModelDistance=0,this.initialize=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(U=new P.Vector3(0,1,0),J=new a.RenderScene,(j=t.glrenderer||ve(e,t.webglInitParams))||(0,n.isNodeJS)()){j&&(this.onWebGLcontextLost=this.onWebGLcontextLost.bind(this),this.onWebGLcontextRestored=this.onWebGLcontextRestored.bind(this),j.addEventListener(de.Events.WEBGL_CONTEXT_LOST,this.onWebGLcontextLost),j.refCount++,t.enableContextRestore&&(j.enableContextRestore=!0,j.addEventListener(de.Events.WEBGL_CONTEXT_RESTORED,this.onWebGLcontextRestored))),(q=t.renderer||new s.RenderContext).init(j,e?e.clientWidth:0,e?e.clientHeight:0,t),(W=t.materialManager||new l.MaterialManager(j)).refCount++,this.camera=new D.UnifiedCamera(e?e.clientWidth:512,e?e.clientHeight:512),this.lightsOn=!1,this.lights=[],this.no_lights=[],Pe=(new P.Color).setRGB(1,1,1),De=(new P.Color).setRGB(1,1,1),this.cameraChangedEvent={type:L.CAMERA_CHANGE_EVENT,camera:this.camera},se=new P.Vector3(1,1,1),le=(new P.Vector3).copy(se),ue=new P.Vector3(-1,0,1),this.scene=new P.Scene,this.sceneAfter=new P.Scene,this.sceneAfter.sortObjects=!1,this.overlayScenes={},xt(),this.createOverlayScene("selection_points",null,null),this.selectionMeshes={},this.fadeMaterial=new P.MeshPhongMaterial({color:16777215,opacity:.1,reflectivity:0,transparent:!0,depthWrite:!1}),this.fadeMaterial.packedNormals=!0,W.addInstancingSupport(this.fadeMaterial),W.addMaterial("__fadeMaterial__",this.fadeMaterial,!0),this.setSelectionColor(6724095),W.togglePolygonOffset(!0),q.setDepthMaterialOffset(W.getPolygonOffsetOn(),W.getPolygonOffsetFactor(),W.getPolygonOffsetUnits()),this.progressiveRender=!0,this.swapBlackAndWhite=!1,this.targetFrameBudget=ee,this.frameDisplayRate=5,(0,n.isMobileDevice)()&&($*=2,ee*=2,this.targetFrameBudget/=2,this.frameDisplayRate/=2),this.interruptBudget=1e10,this.controls={update:function(){this.camera.lookAt(this.camera.target),this.camera.updateProjectionMatrix(),this.camera.dirty=!1},handleResize:function(){},recordHomeView:function(){},uninitialize:function(){},isToolActivated:function(){return!1}},this.selector=new u.MultiModelSelector(this),this.visibilityManager=new c.MultiModelVisibilityManager(this),this.showGhosting=!0,this.showOverlaysWhileMoving=!0,this.skipAOWhenMoving=!1,this.keyFrameAnimator=null,this.zoomBoundsChanged=!0;var r=h.LightPresets[h.DefaultLightPreset].bgColorGradient;this.setClearColors(r[0],r[1],r[2],r[3],r[4],r[5]),(Z=new d.GroundShadow(j)).enabled=!0,Le=new $e,W.addMaterialNonHDR("groundShadowDepthMaterial",Z.getDepthMaterial()),W.addOverrideMaterial("normalsMaterial",q.getDepthMaterial()),W.addOverrideMaterial("edgeMaterial",q.getEdgeMaterial()),q.beginScene(this.scene,this.camera,this.noLights,!0),q.composeFinalFrame(!0,n.isIE11),this.api.addEventListener(L.MODEL_ROOT_LOADED_EVENT,Ne),this.api.addEventListener(L.MODEL_ROOT_LOADED_EVENT,ke)}},this.getSheetRenderer=function(){return X||(X=new V.Z(k,q,j,W)),X},this.isSheetRendererNeeded=function(){return!k.is2d&&this.get2DModels().length>0},this.get2DModels=function(){return J.getModels().filter((function(e){return e.is2d()}))},this.get3DModels=function(){return J.getModels().filter((function(e){return e.is3d()}))},this.renderGroundShadow=function(e){Y?Y.state==y.SHADOWMAP_VALID&&Y.renderGroundShadow(k.camera,e||q.getColorTarget()):(Z.renderShadow(k.camera,e||q.getColorTarget()),Z.rendered=!0)};var We,je,qe,Xe=0,Ye=1,Ke=2,Ze=4,Qe=8,Je=15;function $e(){this.highResTimeStamp=-1,this.screenDrawn=Xe,this.screenHasChanged=!1,this.frameBudget=0,this.frameRemaining=0,this.phase=v.RenderFlags.RENDER_NORMAL,this.signalProgressByRendering=!1,this.tickCount=0,this.beginFrameAvg=0,this.lastBeginFrameTimeStamp=0,this.RENDERMODE_FULL=0,this.RENDERMODE_PROGRESSIVE=1,this.RENDERMODE_SILENT=2,this.renderType=this.RENDERMODE_FULL,this.INITIAL_GROUND_SHADOW=.2,this.cmdListActive=!1,this.cmdIndex=0,this.continueExecution=!0,this.encounteredAlwaysDo=!1,this.finishedFullRender=!0,this.groundShadowInPost=!1,this.drawOverlay=!1,this.cmdIsOpen=!1,this.allocArraySize=0,this.cmdListLength=0,this.cmdList=[],this.paramList=[],this.CMD_NORMAL_SEQUENCE=0,this.CMD_DO_AFTER=1,this.CMD_ALWAYS_DO=2,this.isActive=function(){return this.cmdListActive},this.setFrame=function(e){this.frameBudget=e},this.beginCommandSet=function(){this.cmdListActive=!0,this.cmdIndex=0,this.cmdListLength=0,this.encounteredAlwaysDo=!1,this.tickCount=0,this.screenDrawn=Xe,this.screenHasChanged=!1},this.endCommandSet=function(){this.cmdIsOpen&&(this.cmdIsOpen=!1,this.cmdListLength++)},this._internalSetParam=function(e,t){this.paramList[this.cmdIndex][e]=t},this.addCommand=function(e,t){for(this.cmdIsOpen&&this.cmdListLength++,this.cmdIsOpen=!0;this.allocArraySize<=this.cmdListLength;)this.cmdList[this.cmdListLength]={},this.paramList[this.cmdListLength]={},this.allocArraySize++;return this.cmdList[this.cmdListLength]=e,this.paramList[this.cmdListLength].executionLevel=t||this.CMD_NORMAL_SEQUENCE,this.encounteredAlwaysDo=this.encounteredAlwaysDo||t===this.CMD_ALWAYS_DO,this.cmdListLength},this.setParam=function(e,t){this.cmdIsOpen?this.paramList[this.cmdListLength][e]=t:pe&&p.logger.error("ERROR: cannot set param when no command is open!")},this.getParam=function(e){return pe&&void 0===this.paramList[this.cmdIndex][e]&&p.logger.error("ERROR: parameter "+e+" was never set for this command! Go fix it."),this.paramList[this.cmdIndex][e]},this.executeCommandList=function(){if(Le.cmdListActive){var e;if(this.tickCount>0&&(Le.lastBeginFrameTimeStamp=0),this.frameRemaining=this.frameBudget,pe&&this.cmdIsOpen&&p.logger.error("ERROR: should call endCommandSet before executing"),this.continueExecution=!0,me&&(0===this.tickCount&&console.log("==================="),console.log("Running commands for "+(Le.renderType===Le.RENDERMODE_PROGRESSIVE?"progressive":Le.renderType===Le.RENDERMODE_FULL?"full":"silent")+" render, for tick count "+this.tickCount)),this.encounteredAlwaysDo)for(var t=0;t<this.cmdIndex;)this.paramList[t].executionLevel>=Le.CMD_ALWAYS_DO&&(me&&console.log("  ALWAYS DO command "+t+": "+this.cmdList[t].name),this.cmdList[t]()),t++;for(;this.cmdIndex<this.cmdListLength;)(this.continueExecution||this.paramList[this.cmdIndex].executionLevel>=Le.CMD_DO_AFTER)&&(me&&console.log("  command "+this.cmdIndex+": "+this.cmdList[this.cmdIndex].name+" and "+Le.frameRemaining+" frame budget remaining"),this.cmdList[this.cmdIndex]()&&(me&&console.log("  >>> out of tick time with "+Le.frameRemaining),e=this.cmdIndex,this.continueExecution=!1)),this.cmdIndex++;return this.continueExecution?this.cmdListActive=!1:this.cmdIndex=e,this.tickCount++,!this.continueExecution}return Le.lastBeginFrameTimeStamp=0,!0}}function et(){if(Le.renderType===Le.RENDERMODE_PROGRESSIVE)if(Le.getParam("GenerateGroundShadow.afterBeauty")){if(Le.frameRemaining=Z.prepareGroundShadow(k.modelQueue(),0,Le.frameRemaining),Z.getStatus()==b.GroundFlags.GROUND_RENDERED){if(Le.getParam("GenerateGroundShadow.signalRedraw"))return k.requestSilentRender(),me&&console.log(" $$$$ SIGNAL FULL GROUND SHADOW REDRAW"),!0;Le.groundShadowInPost=!0}}else 0===Le.tickCount&&Z.prepareGroundShadow(k.modelQueue(),10);else Le.frameRemaining=Z.prepareGroundShadow(k.modelQueue(),0,Le.frameRemaining);return Le.frameRemaining<0&&Z.getStatus()===b.GroundFlags.GROUND_UNFINISHED}function tt(){return Z.getStatus()!==b.GroundFlags.GROUND_UNFINISHED&&k.renderGroundShadow(),!1}function rt(){return Le.renderType===Le.RENDERMODE_PROGRESSIVE?Le.getParam("GenerateGroundReflection.afterBeauty")?(Le.frameRemaining=Q.prepareGroundReflection(Z,k,!1,0,Le.frameRemaining),Q.getStatus()==b.GroundFlags.GROUND_RENDERED&&(Le.screenDrawn|=Qe,Le.groundShadowInPost&&W.hasTransparentMaterial()&&k.requestDeferredSilentRender())):0===Le.tickCount&&Q.prepareGroundReflection(Z,k,!0,10):Le.frameRemaining=Q.prepareGroundReflection(Z,k,!1,0,Le.frameRemaining),Le.frameRemaining<0&&Q.getStatus()===b.GroundFlags.GROUND_UNFINISHED}function nt(){if(Y.state===y.SHADOWMAP_NEEDS_UPDATE)Le.frameRemaining=Y.startUpdate(J,Le.frameRemaining,k.camera,le,W);else if(Y.state==y.SHADOWMAP_INCOMPLETE&&(Le.frameRemaining=Y.continueUpdate(J,Le.frameRemaining,W),Y.state==y.SHADOWMAP_VALID))return k.requestSilentRender(),me&&console.log(" $$$$ SIGNAL FULL SHADOW MAP REDRAW"),!0;return Le.frameRemaining<0&&Y.state!==y.SHADOWMAP_VALID}function it(){Y.state=y.SHADOWMAP_NEEDS_UPDATE}function ot(){if(Le.signalProgressByRendering&&k.signalProgress(0,o.ProgressState.RENDERING),Le.renderType===Le.RENDERMODE_PROGRESSIVE){if(Le.lastBeginFrameTimeStamp>0){var e=Le.highResTimeStamp-Le.lastBeginFrameTimeStamp;Le.beginFrameAvg=.75*Le.beginFrameAvg+.25*e}Le.lastBeginFrameTimeStamp=Le.highResTimeStamp,Le.beginFrameAvg<ee&&Le.frameBudget<$?(k.targetFrameBudget+=1,k.targetFrameBudget>$&&(k.targetFrameBudget=$)):Le.beginFrameAvg>ee&&Le.frameBudget>te&&(k.targetFrameBudget*=.75+.25*ee/Le.beginFrameAvg,k.targetFrameBudget<te&&(k.targetFrameBudget=te))}var t=Le.getParam("BeginScene.clear");return q.beginScene(k.scene,k.camera,k.lightsOn?k.lights:k.no_lights,t),t&&(Le.screenDrawn|=Ke),Le.getParam("BeginScene.signalCameraChanged")&&k.api.dispatchEvent(k.cameraChangedEvent),!1}function at(){var e;if(Le.phase=Le.getParam("BeginPhase.phase"),me&&console.log("     render phase is now "+Le.phase),null!==(e=k.glrenderer().xr)&&void 0!==e&&e.isPresenting){var t=k.glrenderer().xr.getCamera(k.camera);k.camera.projectionMatrix.copy(t.projectionMatrix),t.matrixWorld.decompose(t.position,t.quaternion,t.scale),k.camera.position.copy(t.position),k.camera.quaternion.copy(t.quaternion),k.camera.scale.copy(t.scale),k.camera.matrix.copy(t.matrix),k.camera.matrixWorld.copy(t.matrixWorld)}return J.reset(k.camera,Le.phase,Le.getParam("BeginPhase.moved"),W.getCutPlanes()),!1}function st(){return J.isEmpty()||J.isDone()||(Le.screenDrawn|=Ye,Le.frameRemaining=J.renderSome(Be,Le.frameRemaining),Le.signalProgressByRendering&&(k.signalProgress(100*J.getRenderProgress(),o.ProgressState.RENDERING),me&&console.log("  %%% percent done "+100*J.getRenderProgress()))),!J.isDone()}function lt(){return Le.phase=v.RenderFlags.RENDER_FINISHED,q.renderScenePart(k.sceneAfter,!0,!0,!0),!1}function ut(){return Le.phase=v.RenderFlags.RENDER_FINISHED,!1}function ct(){k.signalProgress(100,o.ProgressState.RENDERING)}function ht(){return k.isOverlayDirty()&&(k.clearOverlayDirtyFlag(),Le.drawOverlay=!0),Le.drawOverlay&&(!J.isEmpty()&&J.isDone()||k.showOverlaysWhileMoving?(k.renderOverlays(),Le.screenDrawn|=Ze):(q.clearAllOverlays(),Le.drawOverlay=!1)),!1}function dt(){Le.screenDrawn|=Je}function ft(){if(Le.screenDrawn&&(Le.phase===v.RenderFlags.RENDER_FINISHED||Le.tickCount%k.frameDisplayRate==0)){var e=!Le.getParam("PostAndPresent.performAO")||(Le.screenDrawn&(Ke|Ye))==Ke;q.composeFinalFrame(e),Le.screenHasChanged=!0,Le.screenDrawn=Xe,t=Le.highResTimeStamp,Se++,we<=t&&we>0&&(Ae=.8*Ae+.2*(t-we)),k.fpsCallback&&k.fpsCallback(k.fps()),k.api.dispatchEvent({type:L.RENDER_PRESENTED_EVENT})}var t;return!1}function pt(){return pe&&!1===q.getAOEnabled()&&p.logger.error("AO should be on at this point!"),q.setAOEnabled(!1),!1}function mt(){return pe&&!0===q.getAOEnabled()&&p.logger.error("AO should be off at this point!"),q.setAOEnabled(!0),!1}function gt(){return k.requestSilentRender(),!1}function vt(){return Le.finishedFullRender=!0,!1}this.tick=function(e){Le.highResTimeStamp=e=e||0,j.updateTimestamp(e);var t=W.updateMaterials();k.invalidate(t.needsClear,t.needsRender,t.overlayDirty);var r=function(e){if(k.keyFrameAnimator){var t=we>0?(e-we)/1e3:0,r=k.keyFrameAnimator.update(t);if(r&&(k.sceneUpdated(!0),r&k.keyFrameAnimator.UPDATE_CAMERA))return!0}return!1}(e),n=k.controls.update(e),i=J&&J.update(e),o=n||r||K||i;K=!1;var a=z;ze(),ce=ce||o,ge=ge||o;var s=!1,l=q.overlayUpdate();ge?function(){for(var e in k.selectionMeshes){var t=k.selectionMeshes[e];if(t.model){var r=t.model.getFragmentList();t.geometry===(null==r?void 0:r.getGeometry(t.fragId))&&r.getWorldMatrix(t.fragId,t.matrix)}}}():l&&!ge&&(ge=s=!0),this.isLoadingAnimationEnabled()&&we-k.lastTime2dGeometryCreated<=j.getLoadingAnimationDuration()&&(he=!0);var u=k.model&&k.model.loader&&k.model.loader.pagingProxy&&k.model.loader.pagingProxy.getMemoryInfo();Le.signalProgressByRendering=k.model&&k.model.isLoadDone()&&!k.model.isLeaflet()&&!u,be&&(Ge(),Z.setDirty(),be=!1,1)&&(ce=!0);var c=ce,h=J.frameResumePossible();if(ce=ce||!h,_e=_e||xe&&!Le.cmdListActive,ce||he||ge||_e)if(Le.drawOverlay=ge||ce||he,ce||he||_e){var d,f=c?x.ResetFlags.RESET_RELOAD:x.ResetFlags.RESET_NORMAL;ce||he?(k.progressiveRender?(Le.renderType=Le.RENDERMODE_PROGRESSIVE,d=k.targetFrameBudget):(Le.renderType=Le.RENDERMODE_FULL,d=k.interruptBudget),ce&&(xe=_e=!1)):(Le.renderType=Le.RENDERMODE_SILENT,d=k.targetFrameBudget,ce=!0,f=x.ResetFlags.RESET_REDRAW,xe=_e=!1),k.skipCameraUpdate||k.updateCameraMatrices(),Le.setFrame(d),Le.finishedFullRender=!1,Le.beginCommandSet();var p=Z.enabled&&!k.is2d&&!Me,m=!!Q&&!k.is2d&&!Me,g=o||a,b=o&&k.skipAOWhenMoving&&q.getAOEnabled();Le.addCommand(ot),Le.setParam("BeginScene.signalCameraChanged",g),Le.setParam("BeginScene.clear",ce),b&&Le.addCommand(pt,Le.CMD_ALWAYS_DO),J&&(Y&&Y.state!==y.SHADOWMAP_VALID&&Le.addCommand(nt),p&&(Le.addCommand(et),Le.setParam("GenerateGroundShadow.afterBeauty",!1),Le.setParam("GenerateGroundShadow.signalRedraw",!1)),m?(Q.setDirty(),Le.addCommand(rt),Le.setParam("GenerateGroundReflection.afterBeauty",!1)):p&&ce&&Le.addCommand(tt),J.hasHighlighted()&&(Le.addCommand(at),Le.setParam("BeginPhase.phase",v.RenderFlags.RENDER_HIGHLIGHTED),Le.setParam("BeginPhase.moved",f),f=!1,Le.addCommand(st)),Le.addCommand(at),Le.setParam("BeginPhase.phase",v.RenderFlags.RENDER_NORMAL),Le.setParam("BeginPhase.moved",f),f=!1,Le.addCommand(st),!J.areAllVisible()&&k.showGhosting?(m&&Le.renderType===Le.RENDERMODE_PROGRESSIVE||(Le.addCommand(at),Le.setParam("BeginPhase.phase",v.RenderFlags.RENDER_HIDDEN),Le.setParam("BeginPhase.moved",f),Le.addCommand(st)),Le.addCommand(lt)):Le.addCommand(lt),Le.signalProgressByRendering&&Le.addCommand(ct)),Le.addCommand(ht,Le.renderType===Le.RENDERMODE_PROGRESSIVE?Le.CMD_DO_AFTER:Le.CMD_NORMAL_SEQUENCE),Le.addCommand(ft,Le.renderType===Le.RENDERMODE_PROGRESSIVE?Le.CMD_DO_AFTER:Le.CMD_NORMAL_SEQUENCE),Le.setParam("PostAndPresent.performAO",q.getAOEnabled()&&!b),Le.renderType===Le.RENDERMODE_PROGRESSIVE&&J&&(Y&&Y.state!==y.SHADOWMAP_VALID&&(Le.addCommand(it),Le.addCommand(nt)),p&&(Le.addCommand(et),Le.setParam("GenerateGroundShadow.afterBeauty",!0),Le.setParam("GenerateGroundShadow.signalRedraw",!m),Le.signalProgressByRendering&&Le.addCommand(ct)),m&&(Le.groundShadowInPost=!1,Le.addCommand(rt),Le.setParam("GenerateGroundReflection.afterBeauty",!0),!J.areAllVisible()&&k.showGhosting&&(Le.addCommand(at),Le.setParam("BeginPhase.phase",v.RenderFlags.RENDER_HIDDEN),Le.setParam("BeginPhase.moved",f),Le.addCommand(st)),Le.addCommand(ut),Le.addCommand(ft),Le.setParam("PostAndPresent.performAO",q.getAOEnabled()&&!b),Le.signalProgressByRendering&&Le.addCommand(ct))),b&&(Le.addCommand(mt,Le.CMD_ALWAYS_DO),Le.addCommand(gt)),Le.addCommand(vt),Le.endCommandSet(),ce=!1,he=!1,ge=!1}else Le.finishedFullRender&&(Le.beginCommandSet(),me&&console.log("=====\nOVERLAY DIRTY"),s?Le.addCommand(dt):Le.addCommand(ht,!0),Le.addCommand(ft,!0),Le.setParam("PostAndPresent.performAO",q.getAOEnabled()),Le.signalProgressByRendering&&Le.addCommand(ct),Le.endCommandSet(),ge=!1);Ie=Le.cmdListActive,k.onBeforeRender&&k.onBeforeRender(Ie),Le.executeCommandList(),Ie!==Ue&&(k.api.dispatchEvent({type:L.FINAL_FRAME_RENDERED_CHANGED_EVENT,value:{finalFrame:!Ie}}),Ue=Ie),we=Le.highResTimeStamp},this.setLmvDisplay=function(e){Oe=e},this.run=function(){B=0,setTimeout((function(){!function e(t){B=Oe.requestAnimationFrame(e),k.tick(t)}()}),1)},this.stop=function(){k.getWindow().cancelAnimationFrame(B)},this.toggleProgressive=function(e){this.progressiveRender=e,ce=!0},this.updateClearColors=function(){var e=this.clearColorTop;if(this.is2d&&this.swapBlackAndWhite){var t=1===e.x&&1===e.y&&1===e.z,r=0===e.x&&0===e.y&&0===e.z;t?e=new P.Color(0,0,0):r&&(e=new P.Color(1,1,1))}q.setClearColors(e,this.clearColorBottom)},this.toggleSwapBlackAndWhite=function(e){this.swapBlackAndWhite=e,this.updateClearColors(),ce=!0},this.toggleGrayscale=function(e){W.setGrayscale(e),ce=!0},this.toggleGhosting=function(e){this.showGhosting=e,ce=!0},this.toggleOverlaysWhileMoving=function(e){this.showOverlaysWhileMoving=e},this.togglePostProcess=function(e,t){q.initPostPipeline(e,t),this.fireRenderOptionChanged(),ce=!0},this.toggleCmdMapping=function(e,t){t.keyMapCmd=e},this.toggleGroundShadow=function(e){Z.enabled!==e&&(Z.enabled=e,Z.clear(),e&&Z.setDirty(),Ge(),this.fireRenderOptionChanged(),this.invalidate(!0,!1,!1))},this.isGroundShadowEnabled=function(){return Z&&Z.enabled},this.setGroundShadowColor=function(e){Z.enabled&&(Z.setColor(e),this.invalidate(!0,!1,!1))},this.setGroundShadowAlpha=function(e){Z.enabled&&(Z.setAlpha(e),this.invalidate(!0,!1,!1))},this.toggleGroundReflection=function(e){e&&Q||!e&&!Q||(e?((Q=new _.GroundReflection(j,this.canvas.clientWidth,this.canvas.clientHeight,{clearPass:q.getClearPass()})).setClearColors(this.clearColorTop,this.clearColorBottom,(0,n.isMobileDevice)()),Q.toggleEnvMapBackground(Te),Q.setEnvRotation(q.getEnvRotation()),Ge()):(Q.cleanup(),Q=void 0),this.fireRenderOptionChanged(),this.invalidate(!0,!1,!1))},this.setGroundReflectionColor=function(e){Q&&(Q.setColor(e),this.invalidate(!0,!1,!1))},this.setGroundReflectionAlpha=function(e){Q&&(Q.setAlpha(e),this.invalidate(!0,!1,!1))},this.toggleEnvMapBackground=function(e){Te=e,q.toggleEnvMapBackground(e),Q&&Q.toggleEnvMapBackground(e),this.invalidate(!0,!0,!1)},this.isEnvMapBackground=function(){return Te},this.setOptimizeNavigation=function(e){this.skipAOWhenMoving=e},this.renderOverlays=function(){!function(){for(var e in k.selectionMeshes){var t=k.selectionMeshes[e];t.model&&t.model.isConsolidated()&&t.model.updateRenderProxy(t,t.fragId)}}();var e,t=this.lightsOn;t||this.toggleLights(!0,!0),this.dir_light1&&(e=this.dir_light1.intensity,this.dir_light1.intensity=1),q.renderOverlays(this.overlayScenes,this.lightsOn?this.lights:this.no_lights),t||this.toggleLights(!1,!0),this.dir_light1&&(this.dir_light1.intensity=e)},this.setLayerVisible=function(e,t){this.layers.setLayerVisible(e,t)},this.isLayerVisible=function(e){return this.layers.isLayerVisible(e)},this.getVisibleLayerIndices=function(){return this.layers.getVisibleLayerIndices()},this.setNearRadius=function(e,t){this.nearRadius!==e&&(this.nearRadius=e,t&&this.invalidate(!0))},this.getNearRadius=function(){return this.nearRadius},this.updateNearFarValues=function(e,t){if(t.isEmpty())p.logger.warn("Calculating near-far values based on empty worldBox (infinity) will result in incorrect values - Better to keep previous values instead.");else{if(qe||(We=new P.Matrix4,je=new P.Matrix4,qe=new P.Box3),We.compose(e.position,e.quaternion,e.scale),je.copy(We).invert(),qe.copy(t),Q){var r=new P.Vector3;r.multiplyVectors(qe.max,e.worldup);var n=new P.Vector3;n.multiplyVectors(qe.min,e.worldup),r.sub(n),r.x>=0?qe.min.x-=r.x:qe.max.x-=r.x,r.y>=0?qe.min.y-=r.y:qe.max.y-=r.y,r.z>=0?qe.min.z-=r.z:qe.max.z-=r.z}Y&&Y.groundShapeBox&&qe.union(Y.groundShapeBox),qe.applyMatrix4(je);var i=1e-5*(qe.max.z-qe.min.z),o=.5*(qe.max.y-qe.min.y),a=-(qe.max.z+i)-o,s=-(qe.min.z-i)+o;if(e.isPerspective){this.nearRadius>0?(a=Math.max(a,Math.min(this.nearRadius,1e-4*Math.abs(s-a))),s=Math.min(s,1e4*a)):(a=Math.max(a,Math.min(1,1e-4*Math.abs(s-a))),s<0&&(s=1e-4),a=Math.max(a,1e-5*s));var l=Math.sqrt(N.SceneMath.pointToBoxDistance2(e.position,t)),u=Math.max(1,l);a=Math.min(a,u)}if(s=Math.max(s,a),Autodesk.Viewing.isSafari()&&!this.glrenderer().capabilities.isWebGL2){var c=s/a;e.isPerspective&&c>2e3&&(a=Math.max(a,1))}e.near=a,e.far=s,e.updateCameraMatrices()}},this.getPixelsPerUnit=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.model,n=q.settings.deviceHeight,i=W.getCutPlanesRaw(),o=i[0],a=r?r.getBoundingBox():t;return N.SceneMath.getPixelsPerUnit(e,this.is2d,t,n,o,a)},this.updateCameraMatrices=function(){var e=this,t=this.camera;t.worldup&&this.setWorldUp(t.worldup);var r=this.getVisibleBounds(!0,ge);this.updateNearFarValues(t,r),this.maxModelDistance&&this._applyMaxModelDistanceToNearFar();var n=this.getPixelsPerUnit(t,r),i=q.settings.deviceWidth,o=q.settings.deviceHeight;this.is2d?(W.updatePixelScale(n,i,o,t),W.updateSwapBlackAndWhite(this.swapBlackAndWhite)):W.updatePixelScale(n,i,o,t),this.get2DModels().forEach((function(r){var n=r.getModelToViewerTransform(),a=n?n.getMaxScaleOnAxis():1;if(!e.is2d||1!==a){var s=r.getVisibleBounds(),l=N.SceneMath.getPixelsPerUnit(t,!0,s,o,null,s);W.updatePixelScaleForModel(r,l,i,o,a,t)}}))},this.initLights=function(){Ce||(this.dir_light1=new P.DirectionalLight(Pe,1),this.dir_light1.position.copy(ue),this.amb_light=new P.AmbientLight(De),this.lights=[this.dir_light1,this.amb_light],this.camera.add(this.dir_light1),this.camera.add(this.dir_light1.target),Ce=!0)};function yt(e){return W._getMaterialHash(e,"selection2d")}function bt(){if(!(0,n.isMobileDevice)()){var e=J.getModels().length,t=q.mrtFlags();if(e>1&&t.mrtIdBuffer<2)q.setIdTargetCount(2)&&W.toggleMRTSetting(q.mrtFlags())}}this.toggleLights=function(e,t){this.amb_light&&(this.lightsOn=e,function(e,t,r,n){var i=h.LightPresets[re],o=i&&i.ambientColor,a=i&&i.directLightColor;o=o||De.toArray(),a=a||Pe.toArray(),r?(n&&e?e.color.setRGB(.5*a[0],.5*a[1],.5*a[2]):e&&e.color.setRGB(o[0],o[1],o[2]),t&&t.color.setRGB(a[0],a[1],a[2])):e&&n&&e.color.setRGB(o[0],o[1],o[2])}(this.amb_light,this.dir_light1,e,t))},this.syncCamera=function(e){this.camera.updateCameraMatrices(),e&&this.setWorldUp(this.api.navigation.getWorldUpVector()),K=!0},this.getModelCamera=function(e){if(e){var t=e.getDefaultCamera();return t||D.UnifiedCamera.getViewParamsFromBox(e.getBoundingBox(),e.is2d(),this.camera.aspect,this.camera.up,this.camera.fov)}},this.setViewFromFile=function(e,t){if(e){var r=this.getModelCamera(e),n=e.getMetadata("navigation hint","value",null),i=this.controls.isToolActivated("freeorbit")||t&&"Freeorbit"===n;this.setViewFromCamera(r,t,i)}},this.adjustOrthoCamera=function(e){var t=this.getVisibleBounds();D.UnifiedCamera.adjustOrthoCamera(e,t)},this.setViewFromCamera=function(e,t,r){this.adjustOrthoCamera(e);var n,i=this.model?this.model.getUpVector():null;n=i?(new P.Vector3).fromArray(i):r?e.up.clone():R.Navigation.snapToAxis(e.up.clone()),r?this.api.prefs&&this.api.prefs.set("fusionOrbitConstrained",n.equals(e.up)):e.up=n;var o=this.api.navigation;if(o){var a=this.camera;if(t)a.up.copy(e.up),a.position.copy(e.position),a.target.copy(e.target),e.isPerspective?a.fov=e.fov:(a.saveFov=e.fov,a.fov=D.UnifiedCamera.ORTHO_FOV),a.isPerspective=e.isPerspective,a.orthoScale=e.orthoScale,a.dirty=!0,o.setWorldUpVector(r?n:a.up),o.setView(a.position,a.target),o.setPivotPoint(a.target),this.syncCamera(!0);else if(a.isPerspective=e.isPerspective,e.isPerspective||(a.saveFov=e.fov,e.fov=D.UnifiedCamera.ORTHO_FOV),r)o.setRequestTransitionWithUp(!0,e.position,e.target,e.fov,e.up,n);else{var s=this.getVisibleBounds();if(!s.containsPoint(e.target)){var l=s.getCenter(new P.Vector3).distanceTo(e.position),u=e.target.clone().sub(e.position).normalize().multiplyScalar(l);e.target.copy(e.position.clone().add(u))}var c=o.computeOrthogonalUp(e.position,e.target);o.setRequestTransitionWithUp(!0,e.position,e.target,e.fov,c,n)}}K=!0},this.getViewArrayFromCamera=function(e){var t,r=e||{x:0,y:0,z:0},n=this.camera,i=this.model.getUpVector();t=i?(new P.Vector3).fromArray(i):R.Navigation.snapToAxis(n.up.clone());var o=this.api.navigation.getPivotPoint();return[n.position.x+r.x,n.position.y+r.y,n.position.z+r.z,o.x+r.x,o.y+r.y,o.z+r.z,t.x,t.y,t.z,n.aspect,P.Math.degToRad(n.fov),n.orthoScale,n.isPerspective?0:1]},this.setViewFromViewBox=function(e,t,r,n){if(e.is2d()){var i={},o=e.getBoundingBox(),a={width:t[2]-t[0],height:t[3]-t[1]};a.aspect=a.width/a.height,a.centerX=t[0]+a.width/2,a.centerY=t[1]+a.height/2;var s=this.camera.aspect;s>a.aspect?i.orthoScale=a.height:i.orthoScale=a.width/s;var l=o.getCenter(new P.Vector3);i.isPerspective=!1,i.position=new P.Vector3(a.centerX,a.centerY,l.z+i.orthoScale),i.target=new P.Vector3(a.centerX,a.centerY,l.z),i.target.y+=1e-6*a.height,i.up=new P.Vector3(0,0,1),this.setViewFromCamera(i,n,!1)}},this.setWorldUp=function(e){if(!U.equals(e)){U.copy(e);var t=Math.abs(e.x);ae="x",Math.abs(e.y)>t&&(ae="y",t=Math.abs(e.y)),Math.abs(e.z)>t&&(ae="z");var r,n,i,o,a=new P.Vector3(0,1,0);k.camera.worldUpTransform=(r=a,n=e,i=(new P.Vector3).crossVectors(n,r).normalize(),o=Math.acos(r.dot(n)),(new P.Matrix4).makeRotationAxis(i,o)),this.sceneUpdated(!1)}},this.setUp2DMode=function(e,t){var r=e.getData();r.layerCount&&W.initLayersTexture(r.layerCount,r.layersMap,e.id);var n=W.create2DMaterial(null,{},!0,!1,(function(){k.invalidate(!1,!0,!1)})),i=W.findMaterial(null,n);if(!t){this.is2d&&q.exit2DMode(),q.enter2DMode(i,this.matman().get2dSelectionColor()),this.is2d||this.saveLightPreset(),this.is2d=!0,this.setLightPreset(h.DefaultLightPreset2d),this.setRenderingPrefsFor2D(!0);var o=e.getData();if(o.hidePaper){var a=o.bgColor,s=a>>16&255,l=a>>8&255,u=255&a;this.setClearColors(s,l,u,s,l,u)}}},this.addModel=function(e,t){if(e){var r=!!this.model,n=e.is2d();this.model||e.getData().underlayRaster||(this.model=e,q.setUnitScale(e.getUnitScale())),this.layers||(this.layers=new E.ModelLayers(this)),e.getData().underlayRaster||this.layers.addModel(e,!0),J.addModel(e),this.selector.addModel(e),this.visibilityManager.addModel(e),this._setModelPreferences(e),n?this.setUp2DMode(e,r):this.is2d?(this.is2d=void 0,q.exit2DMode()):ie>=0&&(ne=ie),this.updateClearColors(),this.setupLighting(e),bt(),this.fireRenderOptionChanged(),this.invalidate(!0),this.api.fireEvent({type:L.MODEL_ADDED_EVENT,model:e,preserveTools:t,isOverlay:r})}},this._setModelPreferences=function(e){e.hideLines(!this.api.prefs.get("lineRendering")),e.hidePoints(!this.api.prefs.get("pointRendering")),e.selector.setSelectionMode(this.api.prefs.get(F.Prefs3D.SELECTION_MODE))},this.setupLighting=function(e){e=e||this.model,(0,n.isNodeJS)()||!e||e.is2d()||(this.setLightPresetFromFile(e)||(ne>=0?(this.setLightPreset(ne,!0,oe),ne=-1,oe=null):this.setLightPreset(re,!1)),this.setAOHeuristics(e))},this.getSvfMaterialId=function(e){return this.model.getFragmentList().getSvfMaterialId(e)},this.getMaterials=function(){return W},this.setupMesh=function(e,t,r,n){var i={geometry:t,matrix:n,isLine:t.isLines,isWideLine:t.isWideLines,isPoint:t.isPoints,is2d:t.is2d};return r&&(i.material=this.matman().setupMaterial(e,t,r)),e.is2d()&&(i.geometry.creationTime=we,this.lastTime2dGeometryCreated=we),i},this.init2dSelection=function(e){var t=yt(e);if(!this.overlayScenes[t]){var r,n=W.initSelectionTexture(e.getData().maxObjectNumber,e.id),i=e.getFragmentList(),o=e.getDoNotCut();if(null!=i&&i.viewBounds){var a=i.viewBounds;r=new P.Vector4(a.min.x,a.min.y,a.max.x,a.max.y)}var s=W.create2DMaterial(e,{doNotCut:o,viewportBounds:r},!1,n,(function(){k.invalidate(!1,!0,!1)})),l=W.findMaterial(e,s);this.createOverlayScene(t,l)}},this.onLoadComplete=function(e){Me=!1,this.signalProgress(100,o.ProgressState.LOADING),this.modelVisible(e.id)&&((Z&&Z.enabled||Q)&&this.sceneUpdated(!1,!0),this.invalidate(!!Q,!0,!1)),e.is2d()&&this.init2dSelection(e);var t=e.getGeometryList();t&&t.printStats(),e.hasGeometry()?W.hasTransparentMaterial()&&this.requestSilentRender():p.logger.warn("Loaded model has no geometry."),this.handleInitialVisibility(e),this.api.dispatchEvent({type:L.GEOMETRY_LOADED_EVENT,model:e})},this.onTextureLoadComplete=function(e){this.api.dispatchEvent({type:L.TEXTURES_LOADED_EVENT,model:e}),this.requestSilentRender()},this.signalProgress=function(e,t,r){ye.percent===e&&ye.state===t&&r&&ye.model&&ye.model.id===r.id||(ye.percent=e,ye.state=t,r&&(ye.model=r),this.api.dispatchEvent(ye))},this.resize=function(e,t,r){var n,i;null!==(n=this.glrenderer())&&void 0!==n&&null!==(i=n.xr)&&void 0!==i&&i.isPresenting?console.warn("Viewer3DImpl: Can't change size while XR device is presenting."):(z=!0,G=e,H=t,r&&ze(!0))},this.unloadModel=function(e,t){if(this.api.dispatchEvent({type:L.BEFORE_MODEL_UNLOAD_EVENT,model:e}),this.removeModel(e)||J.removeHiddenModel(e)){var r,n;if(!t)if(e.dtor(this.glrenderer()),W.cleanup(e),e.loader)null===(r=(n=e.loader).dtor)||void 0===r||r.call(n),e.loader=null;e.is2d()&&this.overlayScenes[e.id]&&this.removeOverlayScene(yt(e)),this.api.dispatchEvent({type:L.MODEL_UNLOADED_EVENT,model:e})}},this._reserveLoadingFile=function(){this.loaders||(this.loaders=[]);var e={dtor:function(){}};return this.loaders.push(e),e},this._hasLoadingFile=function(){return this.loaders&&this.loaders.length>0},this._addLoadingFile=function(e,t){if(this.loaders){var r=this.loaders.indexOf(e);r>=0&&(this.loaders[r]=t)}},this._removeLoadingFile=function(e){if(this.loaders){var t=this.loaders.indexOf(e);t>=0&&this.loaders.splice(t,1)}},this.removeModel=function(e){return!!J.removeModel(e)&&(this.keyFrameAnimator&&(this.keyFrameAnimator.destroy(),this.keyFrameAnimator=null),this.selector.removeModel(e),this.visibilityManager.removeModel(e),this.layers.removeModel(e),e===this.model&&(this.model=null,J.isEmpty()||(this.model=J.getModels()[0])),bt(),this.invalidate(!0,!0,!0),this.api.fireEvent({type:L.MODEL_REMOVED_EVENT,model:e}),!0)},this.cancelLoad=function(e){if(this.loaders)for(var t=0;t<this.loaders.length;t++){var r=this.loaders[t];if(r.currentLoadPath===e){r.dtor(),this.loaders.splice(t,1);break}}},this.unloadCurrentModel=function(){this.model&&(this.is2d?(this.is2d=void 0,this.removeOverlayScene(yt(this.model)),q.exit2DMode()):ne=re,this.model.is3d()&&(ie=re),q.beginScene(this.scene,this.camera,this.lightsOn?this.lights:this.no_lights,!0),q.composeFinalFrame(!0)),this.loaders&&(this.loaders.forEach((function(e){e.dtor()})),this.loaders=[]);for(var e=J.getAllModels(),t=e.length-1;t>=0;t--)this.unloadModel(e[t]);this.model=null};var xt=function(){var e,t,r;k.selectionMaterialBase=new P.MeshPhongMaterial({specular:526344,opacity:1,transparent:!1}),k.selectionMaterialTop=new P.MeshPhongMaterial({specular:526344,opacity:.15,transparent:!0}),k.selectionMaterialTop.packedNormals=!0,k.selectionMaterialBase.packedNormals=!0,e="selection",t=k.selectionMaterialBase,r=k.selectionMaterialTop,t.depthWrite=!1,t.depthTest=!0,t.side=P.DoubleSide,r.depthWrite=!1,r.depthTest=!0,r.side=P.DoubleSide,W.addInstancingSupport(t),W.addInstancingSupport(r),k.createOverlayScene(e,t,r),k.highlightMaterial=new P.MeshPhongMaterial({specular:526344,opacity:1,transparent:!1}),k.highlightMaterial.packedNormals=!0,W.addInstancingSupport(k.highlightMaterial),W.addMaterial("__highlightMaterial__",k.highlightMaterial,!0)};this.createOverlayScene=function(e,t,r,n){var i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=arguments.length>5&&void 0!==arguments[5]&&arguments[5];t&&W.addOverrideMaterial(e+"_pre",t),r&&W.addOverrideMaterial(e+"_post",r);var a=new P.Scene;return a.__lights=this.scene.__lights,this.overlayScenes[e]={scene:a,camera:n,materialName:e,materialPre:t,materialPost:r,needIdTarget:i,needSeparateDepth:o}},this.removeOverlayScene=function(e){if(this.overlayScenes[e]){var t=this.overlayScenes[e];t.materialPre&&W.removeMaterial(t.materialName+"_pre"),t.materialPost&&W.removeMaterial(t.materialName+"_post"),delete this.overlayScenes[e],this.invalidate(!1,!1,!0)}},this.addOverlay=function(e,t){this.overlayScenes[e]&&(this.overlayScenes[e].scene.add(t),this.invalidate(!1,!1,!0))},this.addMultipleOverlays=function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&this.addOverlay(e,t[r])},this.removeOverlay=function(e,t){this.overlayScenes[e]&&(this.overlayScenes[e].scene.remove(t),this.invalidate(!1,!1,!0))},this.removeMultipleOverlays=function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&this.removeOverlay(e,t[r])},this.clearOverlay=function(e){if(this.overlayScenes[e]){var t,r,n=this.overlayScenes[e].scene;for(r=n.children.length-1;r>=0;--r)(t=n.children[r])&&n.remove(t);this.invalidate(!1,!1,!0)}},this.setClearColors=function(e,t,r,i,o,a){this.clearColorTop=new P.Vector3(e/255,t/255,r/255),this.clearColorBottom=new P.Vector3(i/255,o/255,a/255),this.updateClearColors(),Q&&Q.setClearColors(this.clearColorTop,this.clearColorBottom,(0,n.isMobileDevice)()),ce=!0,this.fireRenderOptionChanged()},this.setClearAlpha=function(e){q.setClearAlpha(e)};var _t=new P.Box3;function Et(e,t,r){t.updateMatrixWorld(!0),t.traverse((function(t){var n=t.geometry,i=t.model&&"number"==typeof t.fragId;if(!i||n.boundingBox)void 0!==n&&t.visible&&(n.boundingBox||n.computeBoundingBox(),_t.copy(n.boundingBox),_t.applyMatrix4(t.matrixWorld),r&&!r(_t)||e.union(_t));else{var o=i&&t.model.getFragmentList();o&&(o.getWorldBounds(t.fragId,_t),r&&!r(_t)||e.union(_t))}}))}var wt,At=new P.Box3;this.getVisibleBounds=function(e,t,r,n){var i=new P.Box3;return J.isEmpty()||(Et(i,this.scene,r),i=J.getVisibleBounds(e,r,n).union(i),t&&(i=function(e){At.makeEmpty();var t=k.overlayScenes;for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&Et(At,t[r].scene,e);return Et(At,k.scene,e),Et(At,k.sceneAfter,e),At}(r).union(i))),i},this.getFitBounds=function(e){var t;return e||null===this.selector||(t=this.selector.getSelectionBounds()),t&&!t.isEmpty()||(t=this.getVisibleBounds()).isEmpty()&&this.model.is2d()&&(t=this.model.getBoundingBox()),t},this.getRenderProxy=function(e,t){var r;return null===(r=e.getFragmentList())||void 0===r?void 0:r.getVizmesh(t)},this.getLayersRoot=function(){return this.layers.getRoot()},this.getFragmentProxy=function(e,t){return new w.FragmentPointer(e.getFragmentList(),t)},this.getRenderProxyCount=function(e){return e.getFragmentList().getCount()},this.getRenderProxyDbIds=function(e,t){return e.getFragmentList().getDbIds(t)},this.isWholeModelVisible=function(){return!J||J.areAllVisible()},this.isNodeVisible=function(e,t){return this.visibilityManager.isNodeVisible(t,e)},this.highlightObjectNode=function(e,t,r,n){t=e.reverseMapDbIdFor2D(t),e.is2d()&&(W.highlightObject2D(t,r,e.id),this.invalidate(!1,!1,!0)),this.renderer().setDbIdForEdgeDetection(r&&!n?t:0,r?e.id:0);var i=this,o=e.getData().instanceTree;if(o&&!e.is2d())if(e.useIdBufferSelection){var a=e.getData().fragments.dbId2fragId[t];i.highlightFragment(e,a,r,n)}else o.enumNodeFragments(t,(function(t){i.highlightFragment(e,t,r,n)}),!1);else{var s=t;if(e.is2d()&&e.getData().fragments&&(s=e.getData().fragments.dbId2fragId[t]),Array.isArray(s))for(var l=0;l<s.length;l++)i.highlightFragment(e,s[l],r,n);else i.highlightFragment(e,s,r,n)}},this.highlightFragment=function(e,t,r,n){if(e.isLeaflet())return e.getIterator().highlightSelection(r,this.highlightMaterial.color),void this.invalidate(!0);var i=this.getRenderProxy(e,t);if(i){var o=!n||i.is2d||i.isPoint||i.themingColor,a=e.id+":"+t;if(o){var s="selection";if(e.is2d()&&(s=yt(e)),i.isPoint&&(s+="_points"),r)if(i.is2d&&Object.prototype.hasOwnProperty.call(this.selectionMeshes,a))++this.selectionMeshes[a]._lmv_highlightCount;else{var l;if(!i||!i.geometry)return;if(i.isPoint){var u=i.material.clone();u.color=this.selectionMaterialBase.color,u.needsUpdate=!0,u.defines&&i.geometry.attributes.pointScale&&(u.defines.PARTICLE_FLAGS=1),l=new P.Mesh(i.geometry,u)}else l=new P.Mesh(i.geometry,i.material);l.matrix.copy(i.matrixWorld),l.matrixAutoUpdate=!1,l.matrixWorldNeedsUpdate=!0,l.frustumCulled=!1,l.model=e,l.fragId=t,l._lmv_highlightCount=1,this.addOverlay(s,l),this.selectionMeshes[a]=l}else if(Object.prototype.hasOwnProperty.call(this.selectionMeshes,a)){var c=this.selectionMeshes[a];--c._lmv_highlightCount<=0&&(this.removeOverlay(s,c),delete this.selectionMeshes[a])}}o&&r||e.setHighlighted(t,r)&&this.invalidate(!0)}},this.explode=function(e){return(e=Number(e))!=Ee&&(Ee=e,this.refreshExplode(),this.api.dispatchEvent({type:L.EXPLODE_CHANGE_EVENT,scale:e}),!0)},this.refreshExplode=function(){J.explode(Ee),this.sceneUpdated(!0)},this.getExplodeScale=function(){return Ee},this.lockExplode=function(e,t,r){var n=(r=r||this.model).getData().instanceTree;if(!n)return!1;var i,o=function(e,r){return n.enumNodeChildren(r,(function(r){e=n.lockNodeExplode(r,t)||e}),!0),e};return(i=Array.isArray(e)?e.reduce(o,!1):o(!1,e))&&Ee>0&&(J.explode(Ee),this.sceneUpdated(!0)),i},this.isExplodeLocked=function(e,t){var r=(t=t||this.model).getData().instanceTree;return r&&r.isNodeExplodeLocked(e)},this.setGhostingBrightness=function(e){var t=new P.Color(e?1052688:16777215);function r(e){e.color=t}r(this.fadeMaterial),this.fadeMaterial.variants&&this.fadeMaterial.variants.forEach(r)},this.loadCubeMapFromColors=function(e,t){var r=(0,A.CreateCubeMapFromColors)(e,t);return r.isBgColor=!0,W.setReflectionMap(r),r},this.loadCubeMap=function(e,t){this._reflectionMapPath=e;return m.TextureLoader.loadCubeMap(e,t,(function(t){e===k._reflectionMapPath&&W&&(W.setReflectionMap(t),k.invalidate(!0),t?h.LightPresets[re].useIrradianceAsBackground||q.setCubeMap(t):k.loadCubeMapFromColors(k.clearColorTop,k.clearColorBottom))}))},this.loadIrradianceMap=function(e,t){this._irradianceMapPath=e;return m.TextureLoader.loadCubeMap(e,t,(function(t){e===k._irradianceMapPath&&W&&(W.setIrradianceMap(t),k.invalidate(!0),h.LightPresets[re].useIrradianceAsBackground&&q.setCubeMap(t))}))},this.setCurrentLightPreset=function(e){re=e},this.setLightPreset=function(e,t,r){var i;if((0,n.isNodeJS)()&&(e=0),this.initLights(),re!==e||t){if((e<0||h.LightPresets.length<=e)&&(e=h.DefaultLightPreset),re=e,J.isEmpty())return ne=re,void(oe=r);var o=h.LightPresets[e],a=o.bgColorGradient;if(a||(a=h.BackgroundPresets.Custom),this.setClearColors(a[0],a[1],a[2],a[3],a[4],a[5]),void 0!==o.useIrradianceAsBackground&&(this.api.prefs.hasTag("envMapBackground","ignore-producer")?p.logger.debug("setLightPreset(): envMapBackground is locked. No changes."):(this.api.prefs.tag("no-storage","envMapBackground"),this.api.setEnvMapBackground(o.useIrradianceAsBackground))),o.path){var s="res/environments/"+o.path,l=(0,S.getResourceUrl)(s+"_mipdrop."+(o.type||"")+".dds"),u=(0,S.getResourceUrl)(s+"_irr."+(o.type||"")+".dds");this.loadIrradianceMap(u,o.E_bias),this.loadCubeMap(l,o.E_bias),W.setEnvExposure(-o.E_bias),q.setEnvExposure(-o.E_bias),this.setTonemapExposureBias(o.E_bias),this.setTonemapMethod(o.tonemap),this.setGhostingBrightness(o.darkerFade)}else{var c=this.loadCubeMapFromColors(this.clearColorTop,this.clearColorBottom);q.setCubeMap(c),W.setIrradianceMap(null),W.setEnvExposure(-o.E_bias||0),q.setEnvExposure(-o.E_bias||0),this.setTonemapExposureBias(o.E_bias||0),this.setTonemapMethod(o.tonemap||0),this.setGhostingBrightness(o.darkerFade),q.toggleEnvMapBackground(Te),this.invalidate(!0)}var d=null===(i=J)||void 0===i?void 0:i.getModels().filter((function(e){var t,r,n=null==e?void 0:e.getDocumentNode(),i=(null==n?void 0:n.getInputFileType())||(null==n||null===(t=n.getRootNode())||void 0===t||null===(r=t.data)||void 0===r?void 0:r.name)||"";return["dwfx","dwf"].includes(i.toLowerCase())}));d.length>0&&d.forEach((function(e){W.forEachInModel(e,!1,(function(e){e.emissiveOrig||(e.emissiveOrig=e.emissive),e.emissive=e.emissiveOrig.clone().multiplyScalar(Math.pow(2,-o.E_bias))}))}));var f=M.SAOShader.uniforms.radius.value,m=M.SAOShader.uniforms.intensity.value;Object.prototype.hasOwnProperty.call(o,"saoRadius")&&(f=o.saoRadius),Object.prototype.hasOwnProperty.call(o,"saoIntensity")&&(m=o.saoIntensity),q.setAOOptions(f,m);var g=1;null!==o.lightMultiplier&&void 0!==o.lightMultiplier&&(g=o.lightMultiplier),le.copy(se),o.lightDirection&&le.fromArray(o.lightDirection).negate(),Y&&He(),this.dir_light1&&(this.dir_light1.intensity=g,o.lightDirection?this.dir_light1.position.set(-o.lightDirection[0],-o.lightDirection[1],-o.lightDirection[2]):this.dir_light1.position.copy(ue)),W.setEnvRotation(o.rotation||0),q.setEnvRotation(o.rotation||0),Q&&Q.setEnvRotation(o.rotation||0),this.toggleLights(0!==g),this.invalidate(!0,!1,!0),this.fireRenderOptionChanged(),r&&r()}else r&&r()},this.setLightPresetFromFile=function(e){if(!e||e.is2d())return!1;var t,r=e.getMetadata("renderEnvironmentGroundReflection","value",null);t=this.api.prefs.hasTag(F.Prefs3D.GROUND_REFLECTION,"ignore-producer"),null===r||t||(this.api.prefs.tag("no-storage",F.Prefs3D.GROUND_REFLECTION),this.api.setGroundReflection(r));var i=e.getMetadata("renderEnvironmentGroundShadow","value",null);t=this.api.prefs.hasTag(F.Prefs3D.GROUND_SHADOW,"ignore-producer"),null===i||t||(this.api.prefs.tag("no-storage",F.Prefs3D.GROUND_SHADOW),this.api.setGroundShadow(i));var o=e.getMetadata("renderEnvironmentAmbientShadows","value",null);t=this.api.prefs.hasTag(F.Prefs3D.AMBIENT_SHADOWS,"ignore-producer"),null===o||t||(this.api.prefs.tag("no-storage",F.Prefs3D.AMBIENT_SHADOWS),this.api.setQualityLevel(o,q.getAntialiasing()));var a=e.getMetadata("renderEnvironmentDisplayLines","value",null);t=this.api.prefs.hasTag(F.Prefs3D.LINE_RENDERING,"ignore-producer"),null===a||t||(this.api.prefs.tag("no-storage",F.Prefs3D.LINE_RENDERING),this.api.hideLines(!a));var s=e.getMetadata("renderEnvironmentDisplayPoints","value",null);t=this.api.prefs.hasTag(F.Prefs.POINT_RENDERING,"ignore-producer"),null===s||t||(this.api.prefs.tag("no-storage",F.Prefs.POINT_RENDERING),this.api.hidePoints(!s));var l=e.getMetadata("renderEnvironmentDisplayEdges","value",null);t=this.api.prefs.hasTag(F.Prefs3D.EDGE_RENDERING,"ignore-producer"),null===l||t||(this.api.prefs.tag("no-storage",F.Prefs3D.EDGE_RENDERING),this.api.setDisplayEdges(!(0,n.isMobileDevice)()&&!!l));var u=e.getMetadata("renderEnvironmentStyle","value",null),c=h.LightPresets.filter((function(e){return e.name===u}))[0];if(t=this.api.prefs.hasTag(F.Prefs3D.LIGHT_PRESET,"ignore-producer"),c&&!t){this.api.prefs.tag("no-storage",F.Prefs3D.LIGHT_PRESET);var d=fe;d||(d=fe={},h.LightPresets.push(d)),(0,h.copyLightPreset)(c,d),d.name="Custom Model defined";var f=e.getMetadata("renderEnvironmentExposureBias","value",null),p=e.getMetadata("renderEnvironmentExposureBase","value",null);null!==f&&null!==p&&(d.E_bias=f+p);var m=e.getMetadata("renderEnvironmentBackgroundColor","value",null);t=this.api.prefs.hasTag(F.Prefs.BACKGROUND_COLOR_PRESET,"ignore-producer"),m&&!t&&(d.bgColorGradient=[255*m[0],255*m[1],255*m[2],255*m[0],255*m[1],255*m[2]]);var g=e.getMetadata("renderEnvironmentRotation","value",null);null!==g&&(d.rotation=g);var v=h.LightPresets.indexOf(d);this.setLightPreset(v,!0)}var y=e.getMetadata("renderEnvironmentBackgroundFromEnvironment","value",null);return t=this.api.prefs.hasTag(F.Prefs3D.ENV_MAP_BACKGROUND,"ignore-producer"),null===y||t||(this.api.prefs.tag("no-storage",F.Prefs3D.ENV_MAP_BACKGROUND),this.api.setEnvMapBackground(y)),c},this.setLightPresetForAec=function(){for(var e=(0,n.getGlobal)().DefaultLightPresetAec||"Boardwalk",t=-1,r=0;r<h.LightPresets.length;r++)if(h.LightPresets[r].name===e){t=r;break}return t>=0&&(this.api.prefs.hasTag("lightPreset","ignore-producer")?p.logger.debug("setLightPresetForAec(): lightPreset is locked. No changes."):(this.api.prefs.tag("no-storage","lightPreset"),this.setLightPreset(t,!0,function(){this.api.prefs.tag("ignore-producer","envMapBackground")}.bind(this)),this.saveLightPreset())),this.api.prefs.hasTag("edgeRendering","ignore-producer")?p.logger.debug("setLightPresetForAec(): edgeRendering is locked. No changes."):(this.api.prefs.tag("no-storage","edgeRendering"),this.api.setDisplayEdges(!(0,n.isMobileDevice)())),!0},this.setAOHeuristics=function(e){var t=e.getUnitScale(),r=e.getMetadata("renderEnvironmentAmbientShadows","radius",void 0),n=e.getMetadata("renderEnvironmentAmbientShadows","intensity",void 0),i=e.getMetadata("renderEnvironmentAmbientShadows","opacity",void 0);if(void 0!==r||void 0!==n||void 0!==i)q.setAOOptions(r/t,n,i);else if(e.isAEC()){t>.3?q.setAOOptions(4/t,1,.625):q.setAOOptions(.25/t,1,.625)}else{var o=e.getData().bbox.getSize(new P.Vector3).length();q.setAOOptions(Math.min(10,.05*o))}},this.setTonemapMethod=function(e){e!=q.getToneMapMethod()&&(q.setTonemapMethod(e),W.setTonemapMethod(e),this.fireRenderOptionChanged(),this.invalidate(!0))},this.setTonemapExposureBias=function(e){e!=q.getExposureBias()&&(q.setTonemapExposureBias(e),W.setTonemapExposureBias(e),this.fireRenderOptionChanged(),this.invalidate(!0))},this.setRenderingPrefsFor2D=function(e){if(!(0,n.isNodeJS)()){var t=!e&&!!this.api.prefs.get("envMapBackground");this.toggleEnvMapBackground(t)}},this.dtor=function(){this.stop(),this.api.removeEventListener(L.MODEL_ROOT_LOADED_EVENT,Ne),this.api.removeEventListener(L.MODEL_ROOT_LOADED_EVENT,ke),this.unloadCurrentModel(),this.controls=null,this.canvas=null,clearInterval(this.interval),this.loader=null,this.selector.dtor(),this.selector=null,this.model=null,this.layers=null,this.visibilityManager=null,Re&&(Re.removeViewer(this.api),Re=null),J=null,q=null,W.refCount--,0===W.refCount&&W.dtor(),W=null,j&&(j.refCount--,0===j.refCount&&(j.domElement=null,j.context=null),j.removeEventListener(de.Events.WEBGL_CONTEXT_LOST,this.onWebGLcontextLost),j.removeEventListener(de.Events.WEBGL_CONTEXT_RESTORED,this.onWebGLcontextRestored),j=null)},this.hideLines=function(e){J&&!J.isEmpty()&&(J.hideLines(e),this.sceneUpdated(!0))},this.hidePoints=function(e){J&&!J.isEmpty()&&(J.hidePoints(e),this.sceneUpdated(!0))},this.setDisplayEdges=function(e){q.toggleEdges(e);var t=e;e||(t=!(!this.model||!this.model.getData().hasLines)),W.togglePolygonOffset(t),q.setDepthMaterialOffset(W.getPolygonOffsetOn(),W.getPolygonOffsetFactor(),W.getPolygonOffsetUnits()),this.invalidate(!0)},this.setDoubleSided=function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(!(t=t||this.model).is2d()){var n=t.getData();n&&(this.matman().setDoubleSided(e,t),r&&this.sceneUpdated())}},this.getAllCutPlanes=function(){var e=void 0;for(var t in Fe){var r=Fe[t];r&&r.length&&(e=e?t===Ve?r.concat(e):e.concat(r):r)}return e},this.updateCutPlanes=function(){var e=this.getAllCutPlanes();this.setCutPlanes(e)},this.setCutPlaneSet=function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(Fe[e]=t?t.slice():void 0,r)this.updateCutPlanes();else{var n=this.getAllCutPlanes();this.setCutPlanesInScene(n)}},this.setCutPlaneSetFor2DRendering=function(e){Ve=e,this.updateCutPlanes()},this.getCutPlaneSet=function(e){return Fe[e]||[]},this.getCutPlaneSets=function(){var e=[];for(var t in Fe){var r=Fe[t];r&&r.length&&e.push(t)}return e},this.getCutPlanes=function(){return W.getCutPlanes()},this.setCutPlanesInScene=function(e){q.toggleTwoSided(W.setCutPlanes(e)),this.sceneUpdated()},this.setCutPlanes=function(e){this.setCutPlanesInScene(e),this.api.dispatchEvent({type:L.CUTPLANES_CHANGE_EVENT,planes:e})},this.fireRenderOptionChanged=function(){W.toggleMRTSetting(q.mrtFlags()),this.api.dispatchEvent({type:L.RENDER_OPTION_CHANGED_EVENT})},this.viewportToRay=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.camera;return r.viewportToRay(e,t)},this.rayIntersect=function(e,t,r,n,i,o){for(var a=this,s=J.rayIntersect(e.origin,e.direction,t,r,n,i,(function(e){var t=(new P.Vector3).copy(e);t.project(a.camera);var r=[];return q.idAtPixel(t.x,t.y,r),r}),o),l=[this.scene,this.sceneAfter],u=new P.Vector3,c=0;c<l.length;c++){var h=l[c];if(h.children.length){var d=new P.Raycaster(e.origin,e.direction,this.camera.near,this.camera.far);Et(At,h),d.params.Line.threshold=Math.min(1,.5*At.getSize(u).length()*.001);var f=i||[];if(T.VBIntersector.intersectObject(h,d,f,!0),f.length){var p=f[0];(!s||p.distance<s.distance)&&(void 0!==p.modelId&&(p.model=this.findModel(p.modelId)),s=p)}}}return s?(void 0===s.dbId&&void 0!==s.fragId&&(s.dbId=s.model.getFragmentList().getDbIds(s.fragId),s.model.getData().instanceTree||(s.dbId=s.fragId)),s.intersectPoint=s.point,s):null},this.castRayViewport=function(e,t,r,n,i,o){return wt=wt||new P.Ray,J?(this.viewportToRay(e,wt),this.rayIntersect(wt,t,r,n,i,o)):{}},this.getCanvasBoundingClientRect=function(){return this.canvasBoundingclientRectDirty&&(this.canvasBoundingclientRectDirty=!1,this.boundingClientRect=this.canvas.getBoundingClientRect()),this.boundingClientRect},this.clientToViewport=function(e,t){var r=this.getCanvasBoundingClientRect();return new P.Vector3((e+.5)/r.width*2-1,-(t+.5)/r.height*2+1,1)},this.viewportToClient=function(e,t){var r=this.getCanvasBoundingClientRect();return new P.Vector3(.5*(e+1)*r.width-.5,-.5*(t-1)*r.height-.5,0)},this.castRay=function(e,t,r,n){return this.castRayViewport(this.clientToViewport(e,t),r,void 0,void 0,void 0,n)},this.intersectGroundViewport=function(e){var t="z";this.is2d||(t=ae);var r=this.model&&this.model.getBoundingBox();return N.SceneMath.intersectGroundViewport(e,this.camera,t,r)},this.intersectGround=function(e,t){return this.intersectGroundViewport(this.clientToViewport(e,t))},this._2dHitTestViewport=function(e,t,r){var n=[0,0],i=q.idAtPixels(e.x,e.y,t,n);if(i<r)return null;var o=J.findModel(n[1])||this.model;if(!o)return null;var a=this.intersectGroundViewport(e),s=o.getData().fragments,l=s?s.dbId2fragId[i]:-1;return{intersectPoint:a,dbId:o.remapDbIdFor2D(i),fragId:l,model:o}};var St=function(e){return function(t){if(!(t&&t.object&&t.object.isLine))return!0;var r=1/k.camera.pixelsPerUnitAtDistance(t.distance),n=e*r;return t.distanceToRay<n}};function Mt(e,t,r,n){var i=e.getFragmentList().getVizmesh(t);new C.VertexBufferReader(i.geometry).enumGeomsForVisibleLayer(r,n)}function Tt(e,t,r,n){var i=e.getFragmentList().getVizmesh(t);new C.VertexBufferReader(i.geometry).enumGeomsForObject(r,n)}this.hitTestViewport=function(e,t,r,i,o){var a;if(this.is2d){var s=(0,n.isMobileDevice)()?45:5;a=this._2dHitTestViewport(e,s,1)}else a=this.castRayViewport(e,t,r,i,o);return a},this.hitTest=function(e,t,r,n,i){return k.hitTestViewport(this.clientToViewport(e,t),r,n,i)},this.hitBoxTestViewport=function(e,t,r){var n=[],i=[];q.idsAtPixelsBox(e.x,e.y,t,r,i);for(var o=0;o<i.length;o++){var a=J.findModel(i[o][1])||this.model;if(a){var s=a.remapDbIdFor2D(i[o][0]);n.push({dbId:s,model:a})}}return n},this.snappingHitTestViewport=function(e,t){var r,i=(0,n.isMobileDevice)()?45:17;if(this.is2d){if(this.model&&this.model.isLeaflet())r={intersectPoint:this.intersectGroundViewport(e)};else r=this._2dHitTestViewport(e,i,0)}else{var o=[],a=q.idAtPixels(e.x,e.y,i,o);o[2]&&o[3]&&(e.setX(o[2]),e.setY(o[3]));var s={filter:St(i)};r=this.castRayViewport(e,t,a>0?[a]:null,void 0,void 0,s)}return r},this.snappingHitTest=function(e,t,r){return this.snappingHitTestViewport(this.clientToViewport(e,t),r)},this.clearHighlight=function(){q.rolloverObjectId(-1),this.invalidate(!1,!1,!0)},this.rollOverIdChanged=function(){this.api.fireEvent({type:L.OBJECT_UNDER_MOUSE_CHANGED,dbId:q.getRollOverDbId(),modelId:q.getRollOverModelId()}),this.invalidate(!1,!1,!0)},this.rolloverObjectViewport=function(e){if(this.model&&!(this.is2d&&this.model&&(this.model.isLeaflet()||this.model.isPdf(!0)&&this.api.prefs.get(F.Prefs2D.DISABLE_PDF_HIGHLIGHT)))){var t=[],r=q.idAtPixel(e.x,e.y,t);if(this.selector&&this.selector.isNodeSelectionLocked(r,this.model))this.clearHighlight();else{var n=t[1],i=this.findModel(n);null!=i&&i.isLeaflet()?q.rollOverModelId(n)&&this.rollOverIdChanged():q.rolloverObjectViewport(e.x,e.y)&&this.rollOverIdChanged()}}},this.rolloverObject=function(e,t){this.selector.highlightPaused||this.selector.highlightDisabled||this.rolloverObjectViewport(this.clientToViewport(e,t))},this.pauseHighlight=function(e){this.selector.highlightPaused=e,e&&this.clearHighlight()},this.disableHighlight=function(e){this.selector.highlightDisabled=e,e&&this.clearHighlight()},this.disableSelection=function(e){this.selector.selectionDisabled=e},this.cancelLeafletScreenshot=function(){k.api.dispatchEvent({type:L.CANCEL_LEAFLET_SCREENSHOT})},this.getScreenShotProgressive=function(e,t,r,n){return i.ScreenShot.getScreenShot(e,t,r,n,this)},this.modelQueue=function(){return J},this.glrenderer=function(){return j},this.renderer=function(){return q},this.setGeomCache=function(e){(Re=e).addViewer(k.api)},this.geomCache=function(){return Re||this.setGeomCache(new f.OtgResourceCache),Re},this.shadowMaps=function(){return Y},this.worldUp=function(){return U},this.worldUpName=function(){return ae},this.setUserRenderContext=function(e,t){q=e||new s.RenderContext,t||(q.init(j,this.canvas.clientWidth,this.canvas.clientHeight),q.setClearColors(this.clearColorTop,this.clearColorBottom)),this.invalidate(!0),this.sceneUpdated(!1)},this.setUserGroundShadow=function(e){var t=Z;return Z=e,t},this.invalidate=function(e,t,r){ce=e||ce,he=t||he,ge=r||ge},this.isOverlayDirty=function(){return ge},this.clearOverlayDirtyFlag=function(){ge=!1},this.sceneUpdated=function(e,t){this.invalidate(!t,!1,!t),J&&e&&(J.invalidateVisibleBounds(),this.zoomBoundsChanged=!0),be=!0,He()},this.requestSilentRender=function(){xe=_e=!0},this.requestDeferredSilentRender=function(){xe=!0},this.currentLightPreset=function(){return re},this.saveLightPreset=function(){ne=re},this.matman=function(){return W},this.fps=function(){return 1e3/Ae},this.setFPSTargets=function(e,t,r){$=1e3/r,te=1,ee=1e3/t,this.targetFrameBudget=(0,n.isMobileDevice)()?ee/4:ee},this.track=function(e){p.logger.track(e)},this.worldToClient=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.camera,r=new P.Vector4(e.x,e.y,e.z,1);return r.applyMatrix4(t.matrixWorldInverse),r.applyMatrix4(t.projectionMatrix),r.w>0&&(r.x/=r.w,r.y/=r.w,r.z/=r.w),this.viewportToClient(r.x,r.y)},this.clientToWorld=function(e,t,r,n){var i=null,o=this.model,a=o.getData();if(o.is2d()){var s=this.intersectGround(e,t);if(s){s.z=0;var l=a.bbox;(n||a.hidePaper||l.containsPoint(s))&&(i={point:s,model:o})}else n&&(i={point:this.camera.position.clone(),model:o})}else(i=this.hitTest(e,t,r))&&(i.point=i.intersectPoint);return i},this.set2dSelectionColor=function(e,t){this.matman().set2dSelectionColor(e,t),this.invalidate(!1,!1,!0)},this.setSelectionColor=function(e,t){t=t||I.SelectionType.MIXED;var r=new P.Color(e);r.multiplyScalar(.5);var n=function t(n){n.color.set(e),n.emissive.set(r),n.variants&&n.variants.forEach(t)};switch(t){default:case I.SelectionType.MIXED:n(this.selectionMaterialBase),n(this.selectionMaterialTop),q.setSelectionColor(e),n(this.highlightMaterial),this.invalidate(!0);break;case I.SelectionType.REGULAR:n(this.highlightMaterial),this.invalidate(!0);break;case I.SelectionType.OVERLAYED:n(this.selectionMaterialBase),n(this.selectionMaterialTop),q.setSelectionColor(e),this.invalidate(!1,!1,!0)}},this.updateViewportId=function(e){W.updateViewportId(e),this.invalidate(!0)},this.findModel=function(e,t){var r;if("number"==typeof e)r=function(t){return t.id==e};else if(e instanceof O.BubbleNode)r=function(t){return t.getDocumentNode()==e};else{if(!e)return null;r=e}var n=J.getModels().find(r);return t&&!n&&(n=J.getHiddenModels().find(r)),n},this.getFrameRate=function(){return this.frameDisplayRate},this.setFrameRate=function(e){this.frameDisplayRate=e<1?1:e},this.setShadowLightDirection=function(e){le.copy(e),He(),this.invalidate(!0,!1,!1),Ge()},this.getShadowLightDirection=function(e){var t=e||new P.Vector3;return t.copy(le),t},this.toggleShadows=function(e){!!Y!=!!e&&(e?Y=new y.ShadowMaps(j):(Y.cleanup(W),Y=null),Ge(),this.invalidate(!0,!0,!1))},this.showTransparencyWhenMoving=function(e){J.enableNonResumableFrames=e},this.fitToView=function(e,t){(t=!!t,0===e.length)&&(e=J.getModels().map((function(e){return{model:e,selection:[]}})));if(0===e.length)return!1;for(var r=0,n=0;n<e.length;++n){var i=e[n].model;if(!i)return!1;i.is2d()&&r++}return!!(r===e.length?this._fitToView2d(e,t):this._fitToView3d(e,t))&&(1===J.getModels().length&&this.api.dispatchEvent({type:L.FIT_TO_VIEW_EVENT,nodeIdArray:e[0].selection,immediate:t,model:e[0].model}),this.api.dispatchEvent({type:L.AGGREGATE_FIT_TO_VIEW_EVENT,selection:e,immediate:t}),!0)},this._fitToView2d=function(e,t){e.length>1&&p.logger.warn("fitToView() doesn't support multiple 2D models. Using the first one...");var r=e[0].model,n=e[0].selection,i=new P.Box3,o=new C.BoundsCallback(i);if(n&&0!==n.length)this.computeSelectionBounds(n,r,o);else if(this.api.anyLayerHidden())for(var a=r.getData().fragments,s=this.getVisibleLayerIndices(),l=0;l<a.length;l++)Mt(r,l,s,o);else i=this.getFitBounds(!0);return!i.isEmpty()&&(this.api.navigation.fitBounds(t,i),!0)},this.computeSelectionBounds=function(e,t,r){var n;r||(r=new C.BoundsCallback(new P.Box3));var i=null===(n=t.getData().fragments)||void 0===n?void 0:n.dbId2fragId;if(i){for(var o=0;o<e.length;o++){var a=t.reverseMapDbIdFor2D(e[o]),s=i[a];if(Array.isArray(s))for(var l=0;l<s.length;l++)Tt(t,s[l],a,r);else"number"==typeof s&&Tt(t,s,a,r)}r.bounds.applyMatrix4(t.getPlacementTransform())}else r.bounds.copy(t.getBoundingBox());return r.bounds},this.get3DBounds=function(e){for(var t=!1,r=0;r<e.length;++r)if(e[r].selection.length>0){t=!0;break}var n=new P.Box3,i=new P.Box3;if(t)for(var o=0;o<e.length;++o){var a=e[o].selection;if(0!==a.length){var s=e[o].model,l=s.getInstanceTree(),u=s.getFragmentList();if(l)for(var c=0;c<a.length;++c){var h=parseInt(a[c]);l.enumNodeFragments(h,(function(e){u.getWorldBounds(e,i),n.union(i)}),!0)}}}else n.union(this.getVisibleBounds(!1,!1));return n},this.onModelTransformChanged=function(e){if(this.sceneUpdated(),e.isConsolidated())for(var t in k.selectionMeshes){var r=k.selectionMeshes[t];r.model===e&&(r.needsUpdate=!0)}this.invalidate(!0,!0,!0),this.api.fireEvent({type:L.MODEL_TRANSFORM_CHANGED_EVENT,model:e,matrix:e.getModelTransform()})},this.setPlacementTransform=function(e,t){e.setPlacementTransform(t),this.api.fireEvent({type:L.MODEL_PLACEMENT_CHANGED_EVENT,model:e,matrix:e.getPlacementTransform()}),this.onModelTransformChanged(e)},this._fitToView3d=function(e,t){var r=this.get3DBounds(e);return!r.isEmpty()&&(this.api.navigation.fitBounds(t,r),!0)},this.onWebGLcontextLost=function(){j.enableContextRestore&&(this._reconsolidateOnRestore=(0,g.I5)(this.api)),this.stop(),this.api.fireEvent({type:L.WEBGL_CONTEXT_LOST_EVENT})},this.onWebGLcontextRestored=function(){(0,g.p1)(this.api,this._reconsolidateOnRestore),this._reconsolidateOnRestore=null,q.clearAllOverlays(),Z.setDirty(),Q&&Q.setDirty(),this.invalidate(!0,!0,!0),this.run(),this.api.fireEvent({type:L.WEBGL_CONTEXT_RESTORED_EVENT})},this.modelVisible=function(e){return!!J.findModel(e)},this.handleInitialVisibility=function(e){var t=this.api;e.visibilityManager&&e.getObjectTree((function(r){var n=e.getFragmentList();if(!n.areAllVisible()){var i=[];r&&(r.enumNodeChildren(e.getRootId(),(function(e){r.enumNodeFragments(e,(function(e){return n.isFragVisible(e)}),!0)||r.isNodeHidden(e)||r.isNodeOff(e)||i.push(e)}),!0),i.length&&t.hide(i,e))}}))},this.changePaperVisibility=function(e,t){var r=this,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;if(e.is3d())null==i||i();else{var a=e.getFragmentList();if(a){if(e.paperVisibilityAnim&&(e.paperVisibilityAnim.stop(),e.paperVisibilityAnim=null),!n||!o)return e.changePaperVisibility(t),this.invalidate(!0),void(null==i||i());var s=-1,l=void 0!==a.dbIdOpacity[s]?a.dbIdOpacity[s]:t?0:1,u=t?1:0,c=o,h=function(e){e=Autodesk.Viewing.Private.smootherStep(e),a.setObject2DOpacity(s,e),r.invalidate(!0)},d=function(){e.paperVisibilityAnim=null,null==i||i()};e.paperVisibilityAnim=Autodesk.Viewing.Private.fadeValue(l,u,c,h,d)}else null==i||i()}},this._signalNoMeshes=function(){J.isEmpty()&&(this._geometryAvailable=0)},this._signalMeshAvailable=function(){0===this._geometryAvailable&&(this._geometryAvailable=1,this.api.fireEvent({type:L.RENDER_FIRST_PIXEL}))},this.hasModels=function(){return!J.isEmpty()},this.onLoadingAnimationChanged=function(e){j.setLoadingAnimationDuration(e?this.defaultLoadingAnimationDuration:-1),this.invalidate(!1,!0,!1)},this.isLoadingAnimationEnabled=function(){return this.api.prefs.get(F.Prefs2D.LOADING_ANIMATION)&&(!this.model||this.model.is2d())},this.setMaxModelDistance=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e5;this.maxModelDistance=e},this._applyMaxModelDistanceToNearFar=function(){var e=this.camera;if(e.far<=e.near+this.maxModelDistance)return null;var t=e.near+this.maxModelDistance,r=this.getVisibleBounds(!0,ge,(function(r){return N.SceneMath.pointToBoxDistance2(e.position,r)<t*t}));this.updateNearFarValues(e,r)},this.consolidateModel=function(e,t){e.consolidate(W,t,j)},this.setDoNotCut=function(e,t){e.setDoNotCut(W,t)},this.setViewportBounds=function(e,t){e.setViewportBounds(W,t),this.invalidate(!0),this.api.fireEvent({type:L.MODEL_VIEWPORT_BOUNDS_CHANGED_EVENT,model:e,bounds:t})}}ye.prototype.constructor=ye,k.GlobalManagerMixin.call(ye.prototype)},59823:(e,t,r)=>{"use strict";r.r(t),r.d(t,{ViewerState:()=>s});var n=r(98926),i=r(95018),o=r(27820);function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}function s(e){this.getVisibleModel=function(t){for(var r=e.getVisibleModels(),n=0;n<r.length;++n){var i=r[n];if(this.getSeedUrn(i)===t)return i}},this.createObjectSets=function(t){var r=t.objectSet;Array.isArray(r)||(t.objectSet=r=[]);for(var n=e.getVisibleModels(),i=0;i<n.length;i++){var o=n[i],a=this.getSeedUrn(o),s=this.getSelectedNodes(o);r[i]={id:s,idType:"lmv"},n.length>1&&(r[i].seedUrn=a),o.is2d()?(r[i].isolated=this.getVisibleLayers2d(o),r[i].allLayers=this.areAllLayersVisible(o),r[i].hidden=[]):(r[i].isolated=e.getIsolatedNodes(o),r[i].hidden=e.getHiddenNodes(o),r[i].explodeScale=e.getExplodeScale())}},this.getState=function(t){var r=e.navigation,n={};n.seedURN=this.getSeedUrn(),this.createObjectSets(n);var i=n.viewport;i||(i=n.viewport={});var o=r.getCamera().isPerspective;i.name="",i.eye=r.getPosition().toArray(),i.target=r.getTarget().toArray(),i.up=r.getCameraUpVector().toArray(),i.worldUpVector=r.getWorldUpVector().toArray(),i.pivotPoint=r.getPivotPoint().toArray(),i.distanceToOrbit=r.getPivotPlaneDistance(),i.aspectRatio=this.getAspectRatio(),i.projection=o?"perspective":"orthographic",i.isOrthographic=!o,o?i.fieldOfView=r.getVerticalFov():i.orthographicHeight=this.getOrthographicHeight();var a=n.renderOptions;if(a||(a=n.renderOptions={}),a.environment=this.getEnvironmentName(),a.ambientOcclusion={enabled:e.impl.renderer().getAOEnabled(),radius:e.impl.renderer().getAORadius(),intensity:e.impl.renderer().getAOIntensity()},a.toneMap={method:e.impl.renderer().getToneMapMethod(),exposure:e.impl.renderer().getExposureBias(),lightMultiplier:this.getToneMapIntensity()},a.appearance={ghostHidden:e.impl.showGhosting,ambientShadow:e.prefs.get("ambientShadows"),antiAliasing:e.impl.renderer().settings.antialias,progressiveDisplay:e.prefs.get("progressiveRendering"),swapBlackAndWhite:e.prefs.get("swapBlackAndWhite"),displayLines:e.prefs.get("lineRendering"),displayPoints:e.prefs.get("pointRendering")},e.model&&!e.model.is2d())for(var s=n.cutplanes=[],l=e.impl.getCutPlaneSet("__set_view"),u=0;u<l.length;u++)s.push(l[u].toArray());for(var c in e.loadedExtensions){var h=e.loadedExtensions[c];h.getState&&h.getState(n)}return t&&true!==t&&this.applyFilter(n,t),n},this.restoreObjectSet=function(t){var r=t.objectSet;if(Array.isArray(r)&&0!==r.length){for(var n=[],i=[],o=[],a=e.model,s=0;s<r.length;++s){var l=r[s];if("lmv"===l.idType){var u=l.seedUrn;if(!u||(a=this.getVisibleModel(u))){var c=l.id;if(c&&(c=this.toIntArray(c),o.push({model:a,ids:c})),a.is2d()){var h=l.isolated;if(Array.isArray(h)&&h.length>0){e.setLayerVisible(null,!1);for(var d=0;d<h.length;++d)h[d]=parseInt(h[d]);e.impl.setLayerVisible(h,!0)}else l.allLayers||e.setLayerVisible(null,!1)}else{var f=l.isolated||[],p=l.hidden||[];f=this.toIntArray(f),n.push({model:a,ids:f}),0===f.length&&p.length>0&&(p=this.toIntArray(p),i.push({model:a,ids:p}))}if("explodeScale"in l){var m=parseFloat(l.explodeScale);e.explode&&e.explode(m)}}}}o.length>0&&e.impl.selector.setAggregateSelection(o),n.length>0&&e.impl.visibilityManager.aggregateIsolate(n,{hideLoadedModels:!1}),i.length>0&&e.impl.visibilityManager.aggregateHide(i)}},this.restoreState=function(t,r,i){if(!t)return n.logger.warn("restoreState has no viewer state to restore from."),!1;if(!e||!e.model)return n.logger.warn("restoreState has no viewer or model to restore."),!1;r&&true!==r&&(t=JSON.parse(JSON.stringify(t)),this.applyFilter(t,r));var o=e.navigation,a=!e.model.is2d();this.restoreObjectSet(t);var s=t.viewport;if(s){var l=this.getVector3FromArray(s.eye,o.getPosition()),u=this.getVector3FromArray(s.up,o.getCameraUpVector()),c=this.getVector3FromArray(s.target,o.getTarget()),h="fieldOfView"in s?parseFloat(s.fieldOfView):o.getVerticalFov(),d=this.getVector3FromArray(s.worldUpVector,null);if(!d){var f=e.model?e.model.getUpVector():null;d=f?(new THREE.Vector3).fromArray(f):new THREE.Vector3(0,1,0)}var p=this.getVector3FromArray(s.pivotPoint,o.getPivotPoint()),m=o.getCamera().isPerspective;"isOrthographic"in s&&(m=!s.isOrthographic);var g=this.getOrthographicHeight();"orthographicHeight"in s&&(g=Number(s.orthographicHeight));var v={position:l,target:c,up:u,worldup:d,aspect:e.impl.camera.aspect,fov:h,orthoScale:g,isPerspective:m,pivot:p};this.restoreCameraState(v,i)}var y=t.renderOptions;if(y){var b=e.impl.renderer(),x=e.prefs,_=x.get("ambientShadows"),E=x.get("antialiasing"),w=y.ambientOcclusion;if(w){"enabled"in w&&(_=w.enabled);var A="radius"in w?w.radius:null,S="intensity"in w?w.intensity:null;null!==A&&null!==S&&(A===b.getAORadius()&&S===b.getAOIntensity()||(b.setAOOptions(A,S),b.composeFinalFrame()))}if("environment"in y){var M=this.getLightPresetIndex(y.environment);-1!==M&&M!==x.get("lightPreset")&&a&&e.setLightPreset(M)}var T=y.toneMap;if(T){var C=!1,P="exposure"in T?T.exposure:null,D="lightMultiplier"in T?T.lightMultiplier:null;null!==P&&P!==b.getExposureBias()&&(b.setTonemapExposureBias(P),C=!0),null!==D&&e.impl.dir_light1&&D!==this.getToneMapIntensity()&&(e.impl.dir_light1.intensity=Math.pow(2,D),C=!0),C&&e.impl.invalidate(!0)}var L=y.appearance;L&&("antiAliasing"in L&&(E=L.antiAliasing),"progressiveDisplay"in L&&L.progressiveDisplay!==x.get("progressiveRendering")&&e.setProgressiveRendering(L.progressiveDisplay),"swapBlackAndWhite"in L&&L.swapBlackAndWhite!==x.get("swapBlackAndWhite")&&e.setSwapBlackAndWhite(L.swapBlackAndWhite),"ghostHidden"in L&&L.ghostHidden!==x.get("ghosting")&&a&&e.setGhosting(L.ghostHidden),"displayLines"in L&&L.displayLines!==x.get("lineRendering")&&e.hideLines(!L.displayLines),"displayPoints"in L&&L.displayPoints!==x.get("pointRendering")&&e.hidePoints(!L.displayPoints)),a&&_!==x.get("ambientShadows")&&E!==x.get("antialiasing")&&e.setQualityLevel(_,E)}if(Array.isArray(t.cutplanes)&&e.model&&a){for(var R=[],I=0;I<t.cutplanes.length;I++){var O=t.cutplanes[I];Array.isArray(O)&&O.length>=4&&R.push(new THREE.Vector4(O[0],O[1],O[2],O[3]))}!function(t,r){if(e.getExtension("Autodesk.AEC.LevelsExtension")&&void 0===t.floorGuid){var n=r.length;if(3===n||8===n){var i=r[n-2],o=r[n-1];0===i.x&&0===i.y&&-1===i.z&&0===o.x&&0===o.y&&1===o.z&&r.splice(-2,2)}}}(t,R),e.impl.setCutPlaneSet("__set_view",R)}for(var N in e.loadedExtensions){var k=e.loadedExtensions[N];k.restoreState&&k.restoreState(t,i)}return!0},this.getEnvironmentName=function(){var t=i.LightPresets[e.impl.currentLightPreset()];return t?t.name:"none"},this.restoreCameraState=function(t,r){e.impl.adjustOrthoCamera(t);var n=e.navigation;r?(t.isPerspective?n.toPerspective():n.toOrthographic(),n.setCameraUpVector(t.up),n.setWorldUpVector(t.worldup),n.setView(t.position,t.target),n.setPivotPoint(t.pivot),n.setVerticalFov(t.fov,!1),e.impl.syncCamera(!0)):(e.impl.camera.isPerspective=t.isPerspective,n.setRequestTransitionWithUp(!0,t.position,t.target,t.fov,t.up,t.worldup,t.pivot))},this.areEqual=function(e,t,r){function n(e,t){if(t=t||[],(e=e||[]).length!==t.length)return!1;for(var r=0;r<e.length;++r)if(e[r]!==t[r])return!1;return!0}function i(e,t,r){return t=t||[],(e=e||[]).length===t.length&&(0!==e.length&&(o(e[0],t[0],r)||o(e[1],t[1],r)||o(e[2],t[2],r)))}function o(e,t,r){var n=e?parseFloat(e):null,i=e?parseFloat(t):null,o=a(n),s=a(i);return"number"===o&&"number"===s?Math.abs(e-t)<r:(e=e||null)===(t=t||null)}var s=e,l=t,u=1e-9;if(r&&!0!==r&&(s=this.applyFilter(s,r),l=this.applyFilter(l,r)),s.seedURN!==l.seedURN)return!1;var c=s.objectSet||[],h=l.objectSet||[];if(c.length!==h.length)return!1;var d=c[0]||{},f=h[0]||{};if(!(d.idType===f.idType&&o(d.explodeScale,f.explodeScale,u)&&n(d.id,f.id)&&n(d.isolated,f.isolated)&&n(d.hidden,f.hidden)))return!1;var p=s.viewport||{},m=l.viewport||{};return!!(p.name===m.name&&p.projection===m.projection&&p.isOrthographic===m.isOrthographic&&o(p.distanceToOrbit,m.distanceToOrbit,u)&&o(p.fieldOfView,m.fieldOfView,u)&&o(p.orthographicHeight,m.orthographicHeight,u)&&i(p.eye,m.eye,u)&&i(p.target,m.target,u)&&i(p.up,m.up,u)&&i(p.worldUpVector,m.worldUpVector,u)&&i(p.pivotPoint,m.pivotPoint,u))},this.toIntArray=function(e){var t=[];if(Array.isArray(e))for(var r=0,n=e.length;r<n;++r)t.push(parseInt(e[r]));return t},this.getVector3FromArray=function(e,t){return e instanceof Array&&e.length>2?(e[0]=parseFloat(e[0]),e[1]=parseFloat(e[1]),e[2]=parseFloat(e[2]),(new THREE.Vector3).fromArray(e)):t},this.getSelectedNodes=function(t){return(t=t||e.model).selector?t.selector.getSelection():[]},this.getVisibleLayers2d=function(t){return t&&t!==e.model?(n.logger.warn("[getVisibleLayers2d] multiple models not yet supported."),[]):e.impl.getVisibleLayerIndices()},this.areAllLayersVisible=function(t){return t&&t!==e.model?(n.logger.warn("[areAllLayersVisible] multiple models not yet supported."),!0):e.impl.layers.allLayersVisible()},this.getAspectRatio=function(){var t=e.navigation.getScreenViewport();return t.width/t.height},this.getOrthographicHeight=function(){var t=e.navigation.getCamera();return t.isPerspective?0:Math.abs(2*t.orthographicCamera.top)},this.getSeedUrn=function(t){var r;return(null===(r=t=t||e.model)||void 0===r?void 0:r.getSeedUrn())||""},this.getToneMapIntensity=function(){var t=0;return e.impl.dir_light1&&(t=0!=e.impl.dir_light1.intensity?Math.log(e.impl.dir_light1.intensity)/Math.log(2):-1e-20),t},this.getLightPresetIndex=function(e){for(var t=0;t<i.LightPresets.length;t++)if(i.LightPresets[t].name===e)return t;return-1},this.applyFilter=function(e,t){if(!0!==t)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var i=t[r];void 0===i?delete e[r]:"boolean"==typeof i?!1===i&&delete e[r]:i instanceof Object?e[r]instanceof Object?this.applyFilter(e[r],t[r]):n.logger.warn("[applyFilter] A - Invalid filter Object for key ["+r+"]"):n.logger.warn("[applyFilter] B - Invalid filter value for key ["+r+"]")}},this.normalizeCoordinates=function(t){var r=t.viewport;if(r){if(r.normalized)return void n.logger.warn("invalid normalization of state.viewport. Ignoring command.");if(r.normalized=!0,l(r,o.SceneMath.getNormalizingMatrix(e.model)),"orthographicHeight"in r){var i=e.model.myData.bbox,a=i.max.y-i.min.y,s=r.orthographicHeight/a;r.orthographicHeight=s}}},this.denormalizeCoordinates=function(t){var r=t.viewport;if(r){if(!r.normalized)return void n.logger.warn("invalid denormalization of state.viewport. Ignoring command.");if(delete r.normalized,l(r,o.SceneMath.getNormalizingMatrix(e.model).clone().invert()),"orthographicHeight"in r){var i=e.model.myData.bbox,a=i.max.y-i.min.y,s=r.orthographicHeight*a;r.orthographicHeight=s}}}}function l(e,t){var r=new THREE.Vector3(e.eye[0],e.eye[1],e.eye[2]),n=new THREE.Vector3(e.pivotPoint[0],e.pivotPoint[1],e.pivotPoint[2]),i=new THREE.Vector3(e.target[0],e.target[1],e.target[2]);r.applyMatrix4(t),n.applyMatrix4(t),i.applyMatrix4(t),e.eye[0]=r.x,e.eye[1]=r.y,e.eye[2]=r.z,e.pivotPoint[0]=n.x,e.pivotPoint[1]=n.y,e.pivotPoint[2]=n.z,e.target[0]=i.x,e.target[1]=i.y,e.target[2]=i.z}s.prototype.constructor=s},77368:(e,t,r)=>{"use strict";r.r(t),r.d(t,{BubbleNode:()=>i});var n=1;var i=function e(t,r){if(this.parent=r,this.id=n++,this.data=t,this.isLeaf="geometry"===t.type&&("3d"===t.role||"2d"===t.role||"lod"===t.role),Array.isArray(t.children)||Array.isArray(t.derivatives)){this.children=[];for(var i=t.children||t.derivatives,o=i.length,a=0;a<o;a++)this.children[a]=new e(i[a],this);this.children.length>1&&this.children.sort((function(e,t){return Object.prototype.hasOwnProperty.call(e.data,"order")&&Object.prototype.hasOwnProperty.call(t.data,"order")?e.data.order-t.data.order:0}));for(var s=0;s<o;s++){var l="application/autodesk-db"==(u=i[s]).mime&&u.urn?0===u.urn.indexOf("urn:adsk.objects:os.object")?u.urn.substr(0,u.urn.lastIndexOf("%2F")+3):u.urn.substr(0,u.urn.lastIndexOf("/")+1):null;l&&(this.sharedPropertyDbPath=l),"lod"===i[s].role&&(this.lodNode=this.children[s])}}var u};i.prototype.constructor=i,i.prototype.setDocument=function(e){this.lmvDocument=e},i.prototype.getDocument=function(){for(var e=this;e.parent;)e=e.parent;return e.lmvDocument},i.prototype.isOtg=function(){return!!this._getOtgManifest()},i.prototype._getOtgManifest=function(){if("undefined"!=typeof DISABLE_OTG&&DISABLE_OTG)return null;var e=this.findViewableParent();return e?e.data.otg_manifest:null},i.prototype.isSVF2=function(){var e,t=this._getOtgManifest();return Boolean("cacheable"===(null==t||null===(e=t.paths)||void 0===e?void 0:e.pharos_type))},i.prototype.getOtgGraphicsNode=function(){if(this.isViewPreset())return this.findParentGeom2Dor3D().getOtgGraphicsNode();var e=this._getOtgManifest();return e&&e.views&&e.views[this.guid()]},i.prototype.getPropertyDbManifest=function(){var e,t=this._getOtgManifest();if(t&&t.pdb_manifest){var r=t.pdb_manifest;e={propertydb:{},isOtg:!0};for(var n=0;n<r.assets.length;n++){var i,o=r.assets[n];i=o.isShared?t.paths.shared_root+r.pdb_shared_rel_path:t.paths.version_root+r.pdb_version_rel_path,e.propertydb[o.tag]=[{path:i+o.uri,isShared:o.isShared}]}this.getOtgGraphicsNode()||(e.needsDbIdRemap=!0)}else{var a=this.findPropertyDbPath();null===a&&(console.warn("Missing property database entry in manifest."),a=""),0===a.indexOf("$file$")&&(console.warn("Bubble local path given for shared property DB files. Assuming that sharedPropertyDbPath is specified correctly by loadDocumentNode()."),a="");var s=this.getDocument();s&&0===a.indexOf("urn")&&(a=s.getFullPath(a)),e={propertydb:{attrs:[{path:a+"objects_attrs.json.gz"}],values:[{path:a+"objects_vals.json.gz"}],avs:[{path:a+"objects_avs.json.gz"}],offsets:[{path:a+"objects_offs.json.gz"}],ids:[{path:a+"objects_ids.json.gz"}]}}}return e},i.prototype.getRootNode=function(){return this.parent?this.parent.getRootNode():this},i.prototype.isForgeManifest=function(){return"manifest"===this.getRootNode().data.type},i.prototype.findPropertyDbPath=function(){var e=this._getOtgManifest(),t=e&&e.pdb_manifest;return t&&t.assets&&t.assets.length?e.paths.version_root+e.pdb_manifest.pdb_version_rel_path:(e&&console.warn("Unexpected: OTG manifest exists, but it has no property database manifest."),this.sharedPropertyDbPath?this.sharedPropertyDbPath:this.parent?this.parent.findPropertyDbPath():null)},i.prototype._raw=function(){return this.data},i.prototype.name=function(){return this.data.name||""},i.prototype.guid=function(){return this.data.guid},i.prototype.type=function(){return this.data.type},i.prototype.extensions=function(){if(this.data.extensions)return Array.isArray(this.data.extensions)?this.data.extensions:[this.data.extensions]},i.prototype.urn=function(e){var t=this.data.urn;if(!e)return t;for(var r=this.parent;!t&&r;)t=r.data.urn,r=r.parent;return t},i.prototype.lineageUrn=function(e){var t=this.getRootNode().urn(),r=i.parseLineageUrnFromEncodedUrn(t);return e&&(r=Autodesk.Viewing.toUrlSafeBase64(r)),r},i.parseLineageUrnFromEncodedUrn=function(e){if(!e)return null;for(var t=e.split("/"),r=null,n=t.length-1;n>=0;n--){var o;try{r=Autodesk.Viewing.fromUrlSafeBase64(t[n])}catch(e){}if(-1!=(null===(o=r)||void 0===o?void 0:o.indexOf("file:")))break;r=null}return i.parseLineageUrnFromDecodedUrn(r)},i.parseLineageUrnFromDecodedUrn=function(e){if(!e)return null;var t=(e=e.replace("fs.file:vf.","dm.lineage:")).indexOf("?version");return e.substring(0,t)},i.prototype.isGeomLeaf=function(){return this.isLeaf},i.prototype.isViewable=function(){return"viewable"===this.data.role||"svf"===this.data.outputType},i.prototype.getLodNode=function(){return this.lodNode},i.prototype.isGeometry=function(){return"geometry"===this.data.type},i.prototype.isViewPreset=function(){return"view"===this.data.type},i.prototype.is2D=function(){return"2d"===this.data.role},i.prototype.is3D=function(){return"3d"===this.data.role},i.prototype.is2DGeom=function(){return this.isGeometry()&&this.is2D()},i.prototype.is3DGeom=function(){return this.isGeometry()&&this.is3D()},i.prototype.useAsDefault=function(){return!0===this.data.useAsDefault},i.prototype.getDefaultGeometry=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=[];if(e){var n=this.search(i.MASTER_VIEW_NODE);n.length&&(r=n[0].search({type:"geometry"}))}0==r.length&&(r=this.search({type:"geometry"})),t&&r.sort((function(e,t){return t.data.size-e.data.size}));for(var o=0;o<r.length;++o)if(r[o].useAsDefault())return r[o];return r[0]},i.prototype.getPlacementTransform=function(){return console.warn("BubbleNode.getPlacementTransform is deprecated. Sheet placement information is stored in AECModelData.json"),null},i.prototype.getHash=function(){return console.warn("BubbleNode.getHash is deprecated and will be removed in a future release."),null},i.prototype.getViewBox=function(){return this.data.viewbox},i.prototype.isMetadata=function(){if(this.data.role){if(-1!==this.data.role.indexOf("Autodesk.CloudPlatform.DesignDescription"))return!0;if("Autodesk.CloudPlatform.PropertyDatabase"===this.data.role)return!0}return!1},i.prototype.findViewableParent=function(){for(var e=null,t=this;t;)t.isViewable()&&(e=t),t=t.parent;if(!e&&!this.parent&&this.children)for(var r=0;r<this.children.length;r++){var n=this.children[r];if(n.isViewable()){e=n;break}}return e},i.prototype.findParentGeom2Dor3D=function(e){for(var t=this;t&&!t.is2DGeom()&&!t.is3DGeom();)t=t.parent;!t&&this.isViewPreset()&&(t=this.findGeometryFromSiblings()[0],e&&e.fallbackParent&&(t=e.fallbackParent));return t},i.prototype.findGeometryFromSiblings=function(){var e=this.parent;if(!e)return[];for(var t=[],r=0,n=e.children.length;r<n;++r){var i,o=e.children[r];if(o!==this)o.traverse((function(e){if(e.isGeometry()&&(e.is2D()||e.is3D()))return i=e,!0})),i&&t.push(i)}return t},i.prototype.findAllViewables=function(){var e=[];this.isForgeManifest()&&(e=this.search({outputType:"svf"}));var t=this.search({role:"viewable"});return e.concat(t)},i.prototype.getViewableRootPath=function(e){var t=this.getOtgGraphicsNode();if(t&&t.urn&&!t.error)return this._getOtgManifest().paths.version_root+t.urn;if(!this.isGeomLeaf())return this.urn();if(this.is2D()){if(!e){var r=this.search({role:"leaflet"});if(r&&r.length)return r[0].urn()}var n=this.search(i.PDF_PAGE_NODE);if(null!=n&&n.length)return n[0].urn()}var o=this.is2D()?"application/autodesk-f2d":"application/autodesk-svf",a=this.search({mime:o});return a&&a.length?a[0].urn():null},i.prototype.getNamedViews=function(){var e=this.search({type:"view"});return e=e.filter((function(e){return!!e.data.name&&!!Array.isArray(e.data.camera)}))},i.prototype.findByGuid=function(e){var t=null;return this.traverse((function(r){if(r.data.guid===e)return t=r,!0})),t},i.prototype.search=function(e){var t=[];return this.traverse((function(r){var n=!0;for(var i in e)if(!Object.prototype.hasOwnProperty.call(r.data,i)||r.data[i]!==e[i]){n=!1;break}n&&t.push(r)})),t},i.prototype.traverse=function(e){if(e(this))return!0;if(this.children)for(var t=0;t<this.children.length;t++)if(this.children[t].traverse(e))return!0;return!1},i.prototype.getShallowCopySource=function(e){if(!this.isViewable())return console.error("getShallowCopySource must be called with a viewable node."),null;e||(e=this.parent.urn());var t=this.urn();return t!==e&&(t?(console.log("Redirecting shallow copied URN ".concat(e," to ").concat(t)),e=t):console.warn("Unexpected: manifest viewable node does not have a urn property.\n".concat(JSON.stringify(this._raw())))),e},i.prototype.getAecModelData=function(){var e=this.findViewableParent();if(!e)return null;if(!e.data.aec_model_data){var t=this.getRootNode().search({role:"Autodesk.AEC.ModelData"})[0];return Boolean(t)&&console.warn("Use Document.getAecModelData(bubbleNode) instead of BubbleNode.getAecModelData(), or make sure Document.downloadAecModelData is loaded before using this API"),null}return e.data.aec_model_data},i.prototype.extractRefPointTransform=function(){var e=this.getAecModelData();return e&&e.refPointTransformation&&i.readMatrixFromArray12(e.refPointTransformation)},i.prototype.extractCamera=function(){if(this.data.camera)return i.readCameraFromArray(this.data.camera);var e=this.isGeometry()&&this.search({type:"view"})[0];return e?e.extractCamera():null},i.prototype.getLevel=function(){var e=this.data.levelNumber;return Array.isArray(e)?e[0]:e},i.prototype.getLevelName=function(){return this.data.levelName||this.getLevel()},i.prototype.isSheet=function(){for(var e=this.parent;e;){if("Sheets"===e.name())return!0;e=e.parent}return!1},i.prototype.isMasterView=function(){for(var e=i.MASTER_VIEW_NODE.name,t=this;t;){if(t.name()===e)return!0;t=t.parent}return!1},i.prototype.getModelName=function(){var e=this.getRootNode().children[0];return null==e?void 0:e.name()},i.prototype.getInputFileType=function(){var e,t=null===(e=this.getRootNode().children)||void 0===e?void 0:e[0];return null==t?void 0:t.data.inputFileType},i.prototype.isRevitPdf=function(){return!(!this.data.isVectorPDF||"rvt"!==this.getInputFileType())},i.prototype.getModelKey=function(){var e="".concat(this.getViewableRootPath()).concat(this.originModel).concat(this.guid());return decodeURIComponent(e)},i.readCameraFromArray=function(e,t){if(!Array.isArray(e))return null;if(t&&!t.elements){t instanceof THREE.Vector3||(t=(new THREE.Vector3).copy(t));var r=new THREE.Matrix4;r.setPosition(t),t=r}var n={position:new THREE.Vector3(e[0],e[1],e[2]),target:new THREE.Vector3(e[3],e[4],e[5]),up:new THREE.Vector3(e[6],e[7],e[8]),aspect:e[9],fov:THREE.Math.radToDeg(e[10]),orthoScale:e[11],isPerspective:!e[12]};return t&&(n.position.applyMatrix4(t),n.target.applyMatrix4(t),n.up.transformDirection(t)),0===e[10]&&1===e[11]&&1===e[12]&&(n.orthoScale=n.position.distanceTo(n.target)),n},i.readMatrixFromArray12=function(e){return(new THREE.Matrix4).fromArray([e[0],e[1],e[2],0,e[3],e[4],e[5],0,e[6],e[7],e[8],0,e[9],e[10],e[11],1])},i.prototype.getSourceFileUnits=function(){return this.data.units};i.prototype.getMasterViews=function(){var e=this.getRootNode().search({name:"08f99ae5-b8be-4f8d-881b-128675723c10"});return e&&e.length>0&&e[0].children||[]},i.prototype.getMasterView=function(e){return this.getMasterViews().find((function(t){return t.data.phaseNames===e}))},i.prototype.get3DModelNodes=function(){return this.search(i.MODEL_NODE)},i.prototype.getSheetNodes=function(){return this.search(i.SHEET_NODE)},i.MODEL_NODE={role:"3d",type:"geometry"},i.GEOMETRY_SVF_NODE={role:"graphics",mime:"application/autodesk-svf"},i.SHEET_NODE={role:"2d",type:"geometry"},i.LEAFLET_NODE={role:"leaflet"},i.PDF_PAGE_NODE={role:"pdf-page"},i.IMAGE_NODE={role:"image"},i.GEOMETRY_F2D_NODE={role:"graphics",mime:"application/autodesk-f2d"},i.VIEWABLE_NODE={role:"viewable"},i.AEC_MODEL_DATA={role:"Autodesk.AEC.ModelData"},i.MASTER_VIEW_NODE={name:"08f99ae5-b8be-4f8d-881b-128675723c10"}},84998:(e,t,r)=>{"use strict";function n(){return"undefined"!=typeof window&&null!==window?window:"undefined"!=typeof self&&null!==self?self:r.g}r.r(t),r.d(t,{getGlobal:()=>n,isBrowser:()=>a,isNodeJS:()=>s,isIE11:()=>l,isIE11Only:()=>u,launchFullscreen:()=>c,exitFullscreen:()=>h,inFullscreen:()=>d,fullscreenElement:()=>f,isFullscreenAvailable:()=>p,isFullscreenEnabled:()=>m,getAndroidVersion:()=>g,isTouchDevice:()=>v,isIOSDevice:()=>b,isAndroidDevice:()=>_,isMobileDevice:()=>E,isPhoneFormFactor:()=>w,isSafari:()=>A,isFirefox:()=>S,isChrome:()=>M,isMac:()=>T,isWindows:()=>C,ObjectAssign:()=>P,disableDocumentTouchSafari:()=>L,enableDocumentTouchSafari:()=>R,touchStartToClick:()=>I});var i=n(),o=i&&i.document,a="undefined"!=typeof navigator,s=function(){return!a},l=a&&!!navigator.userAgent.match(/Edge|Trident\/7\./),u=a&&!!navigator.userAgent.match(/Trident\/7\./);function c(e,t){e.requestFullscreen?e.requestFullscreen(t):e.mozRequestFullScreen?e.mozRequestFullScreen(t):e.webkitRequestFullscreen?e.webkitRequestFullscreen(t):e.msRequestFullscreen&&e.msRequestFullscreen(t)}function h(e){d(e)&&(e.exitFullscreen?e.exitFullscreen():e.mozCancelFullScreen?e.mozCancelFullScreen():e.webkitExitFullscreen?e.webkitExitFullscreen():e.msExitFullscreen&&e.msExitFullscreen())}function d(e){return"webkitIsFullScreen"in e?!!e.webkitIsFullScreen:"fullscreenElement"in e?!!e.fullscreenElement:"mozFullScreenElement"in e?!!e.mozFullScreenElement:"msFullscreenElement"in e?!!e.msFullscreenElement:!!e.querySelector(".viewer-fill-browser")}function f(e){return e.fullscreenElement||e.mozFullScreenElement||e.webkitFullscreenElement||e.msFullscreenElement}function p(e){return e.requestFullscreen||e.mozRequestFullScreen||e.webkitRequestFullscreen||e.msRequestFullscreen}function m(e){return e.fullscreenEnabled||e.webkitFullscreenEnabled||e.mozFullScreenEnabled||e.msFullscreenEnabled}function g(e){var t=(e=e||navigator.userAgent).match(/Android\s([0-9\.]*)/);return!!t&&t[1]}function v(){return"undefined"!=typeof window&&("ontouchstart"in window||navigator.maxTouchPoints>0)}"undefined"!=typeof window&&l&&function(){function e(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var r=o.createEvent("CustomEvent");return r.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),r}e.prototype=i.CustomEvent.prototype,i.CustomEvent=e}(),ArrayBuffer.prototype.slice||(ArrayBuffer.prototype.slice=function(e,t){if(!t||t>this.byteLength?t=this.byteLength:t<0&&(t=this.byteLength+t)<0&&(t=0),e<0&&(e=this.byteLength+e)<0&&(e=0),t<=e)return new ArrayBuffer;for(var r=t-e,n=new Uint8Array(this,e,r),i=new Uint8Array(r),o=0;o<r;o++)i[o]=n[o];return i.buffer}),Math.log2=Math.log2||function(e){return Math.log(e)/Math.LN2},"undefined"!=typeof window&&(i.BlobBuilder=i.BlobBuilder||i.WebKitBlobBuilder||i.MozBlobBuilder||i.MSBlobBuilder);var y=a&&(/ip(ad|hone|od)/.test(navigator.userAgent.toLowerCase())||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1);function b(){return y}var x=a&&-1!==navigator.userAgent.toLowerCase().indexOf("android");function _(){return x}function E(){return!!a&&(b()||_())}function w(){return E()&&(i.matchMedia("(max-width: 750px)").matches||i.matchMedia("(max-height: 750px)").matches)}function A(){if(!a)return!1;var e=navigator.userAgent.toLowerCase();return-1!==e.indexOf("safari")&&-1===e.indexOf("chrome")}function S(){return!!a&&-1!==navigator.userAgent.toLowerCase().indexOf("firefox")}function M(){return!!a&&-1!==navigator.userAgent.toLowerCase().indexOf("chrome")}function T(){return!!a&&-1!==navigator.userAgent.toLowerCase().indexOf("mac os")}function C(){if(!a)return!1;var e=navigator.userAgent.toLowerCase();return-1!==e.indexOf("win32")||-1!==e.indexOf("windows")}function P(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);return e}function D(e){var t=i.hasOwnProperty("pageXOffset")?i.pageXOffset:o.documentElement.scrollLeft,r=i.hasOwnProperty("pageYOffset")?i.pageYOffset:o.documentElement.scrollTop,n=void 0===e.pageX?e.changedTouches[0].pageX:e.pageX,a=void 0===e.pageY?e.changedTouches[0].pageY:e.pageY,s=o.elementFromPoint(n-t,a-r);return!s||"CANVAS"!==s.nodeName||("true"!==s.getAttribute("data-viewer-canvas")||(e.preventDefault(),!1))}function L(){E()&&A()&&(o.documentElement.addEventListener("touchstart",D,!0),o.documentElement.addEventListener("touchmove",D,!0),o.documentElement.addEventListener("touchcanceled",D,!0),o.documentElement.addEventListener("touchend",D,!0))}function R(){E()&&A()&&(o.documentElement.removeEventListener("touchstart",D,!0),o.documentElement.removeEventListener("touchmove",D,!0),o.documentElement.removeEventListener("touchcanceled",D,!0),o.documentElement.removeEventListener("touchend",D,!0))}function I(e){e.target.className&&(e.target.className.indexOf("fullscreen")>-1||e.target.className.indexOf("webvr")>-1||e.target.className.indexOf("webxr")>-1)||(e.preventDefault(),e.stopPropagation(),e.target.click())}!function(){var e=n();e.performance||(e.performance=Date)}(),Number.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},String.prototype.repeat=String.prototype.repeat||function(e){if(e<1)return"";for(var t="",r=this.valueOf();e>1;)1&e&&(t+=r),e>>=1,r+=r;return t+r},Array.prototype.flat||Object.defineProperty(Array.prototype,"flat",{value:function e(){var t=isNaN(arguments[0])?1:Number(arguments[0]);return t?Array.prototype.reduce.call(this,(function(r,n){return Array.isArray(n)?r.push.apply(r,e.call(n,t-1)):r.push(n),r}),[]):Array.prototype.slice.call(this)}}),Array.prototype.fill||Object.defineProperty(Array.prototype,"fill",{enumerable:!1,value:function(e,t,r){t=void 0===t?0:t,r=void 0===r?this.length:r;for(var n=t;n<r;++n)this[n]=e}}),Int32Array.prototype.lastIndexOf=Int32Array.prototype.lastIndexOf||function(e,t){return Array.prototype.lastIndexOf.call(this,e,t)},Array.prototype.find||Object.defineProperty(Array.prototype,"find",{enumerable:!1,value:function(e,t){for(var r=this.length,n=0;n<r;++n){var i=this[n];if(e.call(t,i,n,this))return i}}}),"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(e,t){if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var r=Object(e),n=1;n<arguments.length;n++){var i=arguments[n];if(null!=i)for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])}return r},writable:!0,configurable:!0}),"undefined"==typeof window||!l&&!b()||HTMLCanvasElement.prototype.toBlob||Object.defineProperty(HTMLCanvasElement.prototype,"toBlob",{value:function(e,t,r){var n=this;setTimeout((function(){for(var i=atob(n.toDataURL(t,r).split(",")[1]),o=i.length,a=new Uint8Array(o),s=0;s<o;s++)a[s]=i.charCodeAt(s);e(new Blob([a],{type:t||"image/png"}))}))}}),Uint8Array.prototype.slice||(Uint8Array.prototype.slice=function(e,t){if(t=void 0!==t?t:this.length,"[object Array]"===Object.prototype.toString.call(this))return _slice.call(this,e,t);var r,n,i=[],o=this.length,a=e||0;a=a>=0?a:Math.max(0,o+a);var s="number"==typeof t?Math.min(t,o):o;if(t<0&&(s=o+t),(n=s-a)>0)if(i=new Array(n),this.charAt)for(r=0;r<n;r++)i[r]=this.charAt(a+r);else for(r=0;r<n;r++)i[r]=this[a+r];return i})},26261:(e,t,r)=>{"use strict";r.r(t),r.d(t,{token:()=>p,getWebGLHelpLink:()=>g,EnvironmentConfigurations:()=>z,getUpstreamApiData:()=>G,initializeEnvironmentVariable:()=>H,initializeResourceRoot:()=>W,initializeServiceEndPoints:()=>j,refreshCookie:()=>q,refreshRequestHeader:()=>X,refreshToken:()=>Y,initializeAuth:()=>K,initializeLogger:()=>Z,Initializer:()=>J,shutdown:()=>$});var n=r(17167),i=r(98926),o=r(58964),a=r(84998),s=r(58092),l=r(57601),u=r(41471),c=r(21319),h=(0,a.getGlobal)(),d=h,f={accessToken:null,getAccessToken:null,tokenRefreshInterval:null},p=f,m=null;function g(){return m}var v={local:{RTC:["https://rtc-dev.api.autodesk.com:443","https://lmv.autodesk.com:443"]},dev:{RTC:["https://rtc-dev.api.autodesk.com:443","https://lmv.autodesk.com:443"]},stg:{RTC:["https://rtc-stg.api.autodesk.com:443","https://lmv.autodesk.com:443"]},prod:{RTC:["https://rtc.api.autodesk.com:443","https://lmv.autodesk.com:443"]}},y="",b="";if((0,a.getGlobal)().location){var x=(0,a.getGlobal)().location;b=x.protocol+"//"+x.hostname,y=x.protocol+"//"+x.host}var _={local:"",dev:"https://developer-dev.api.autodesk.com",stg:"https://developer-stg.api.autodesk.com",prod:"https://developer.api.autodesk.com"},E="https://us.otgs-dev.autodesk.com",w="https://us.otgs-stg.autodesk.com",A="https://us.otgs.autodesk.com",S="https://eu.otgs-stg.autodesk.com",M="https://eu.otgs.autodesk.com",T="https://cdn-dev.derivative.autodesk.com",C="https://cdn-dev.derivative.autodesk.com/regions/eu",P="https://cdn-stg.derivative.autodesk.com",D="https://cdn-stg.derivative.autodesk.com/regions/eu",L="https://cdn.derivative.autodesk.com",R="https://cdn.derivative.autodesk.com/regions/eu",I="https://cdn-dev.derivative.autodesk.com",O="https://cdn-stg.derivative.autodesk.com",N="https://cdn.derivative.autodesk.com",k="https://cdn-stg-fips.derivative.autodesk.com",F="https://cdn-fips.derivative.autodesk.com",V="derivativeV2",U="derivativeV2_EU",B="derivativeV2_Fedramp",z=Object.freeze({Local:{ROOT:"",LMV:v.local},Development:{ROOT:_.dev,LMV:v.dev,bubbleManifest:!0},Staging:{ROOT:_.stg,LMV:v.stg,bubbleManifest:!0},Production:{ROOT:_.prod,LMV:v.prod,bubbleManifest:!0},AutodeskDevelopment:{ROOT:_.dev,LMV:v.dev},AutodeskStaging:{ROOT:_.stg,LMV:v.stg},AutodeskProduction:{ROOT:_.prod,LMV:v.prod},AutodeskDevelopment2:{ROOT:I,LMV:v.dev,UPSTREAM:_.dev,UPSTREAM_API_DATA:V},AutodeskStaging2:{ROOT:O,LMV:v.stg,UPSTREAM:_.stg,UPSTREAM_API_DATA:V},AutodeskProduction2:{ROOT:N,LMV:v.prod,UPSTREAM:_.prod,UPSTREAM_API_DATA:V},FluentLocal:{ROOT:y,LMV:y},FluentDev:{ROOT:E,LMV:v.dev,UPSTREAM:_.stg,UPSTREAM_API_DATA:V},FluentStaging:{ROOT:w,LMV:v.stg,UPSTREAM:_.stg,UPSTREAM_API_DATA:V},FluentProduction:{ROOT:A,LMV:v.prod,UPSTREAM:_.prod,UPSTREAM_API_DATA:V},FluentStagingEU:{ROOT:S,LMV:v.stg,UPSTREAM:_.stg,UPSTREAM_API_DATA:U},FluentProductionEU:{ROOT:M,LMV:v.prod,UPSTREAM:_.prod,UPSTREAM_API_DATA:U},MD20DevUS:{ROOT:T,LMV:v.dev,UPSTREAM:_.dev,UPSTREAM_API_DATA:V},MD20DevEU:{ROOT:C,LMV:v.dev,UPSTREAM:_.dev,UPSTREAM_API_DATA:U},MD20StgUS:{ROOT:P,LMV:v.stg,UPSTREAM:_.stg,UPSTREAM_API_DATA:V},MD20StgEU:{ROOT:D,LMV:v.stg,UPSTREAM:_.stg,UPSTREAM_API_DATA:U},MD20ProdUS:{ROOT:L,LMV:v.prod,UPSTREAM:_.prod,UPSTREAM_API_DATA:V},MD20ProdEU:{ROOT:R,LMV:v.prod,UPSTREAM:_.prod,UPSTREAM_API_DATA:U},D3SLocalUS:{ROOT:y,LMV:y,UPSTREAM:y,UPSTREAM_API_DATA:V},D3SLocalEU:{ROOT:y,LMV:y,UPSTREAM:y,UPSTREAM_API_DATA:U},Test:{ROOT:"".concat(b,":").concat(3e3),LMV:v.dev},FedrampStaging2:{ROOT:k,LMV:v.stg,UPSTREAM:_.stg,UPSTREAM_API_DATA:B},FedrampProduction2:{ROOT:F,LMV:v.prod,UPSTREAM:_.prod,UPSTREAM_API_DATA:B}});function G(e,t){return e.endsWith("EU")?z[e].UPSTREAM_API_DATA:t.endsWith("_EU")?z[e].UPSTREAM_API_DATA+"_EU":z[e].UPSTREAM_API_DATA}function H(e){var t;if(e&&e.env&&(t=e.env),t||(t=(0,n.getParameterByName)("env")),(0,o.setOfflineResourcePrefix)(e&&e.offlineResourcePrefix||""),(0,o.setOffline)(e&&"true"===e.offline),!t)switch(d.location.hostname){case"developer-dev.api.autodesk.com":t="AutodeskDevelopment";break;case"developer-stg.api.autodesk.com":t="AutodeskStaging";break;default:t="AutodeskProduction";break;case"localhost.autodesk.com":case"":case"127.0.0.1":t="Local"}(0,o.setEnv)(t),"undefined"!=typeof window&&i.logger.info("Host name : "+window.location.hostname),i.logger.info("Environment initialized as : "+t)}function W(e){var t,r,i=["viewer3D.js","viewer3D.min.js","viewerCE.js","viewerCE.min.js"];e&&Object.prototype.hasOwnProperty.call(e,"libraryName")&&i.push(e.libraryName);for(var o=!1,a=0;a<i.length;a++){var s=(0,n.getScript)(i[a]),l=(r=s?s.src:"").indexOf(i[a]);if(l>=0){t=r.substr(0,l),(r.indexOf("&v=",l)>0||r.indexOf("?v=",l)>0)&&(o=!0);break}}if(h.LMV_RESOURCE_ROOT=t||h.LMV_RESOURCE_ROOT,o){for(var u=!1,c=["dev","stg","prod"],d=0;d<c.length;++d){var f=_[c[d]];if(-1!==h.LMV_RESOURCE_ROOT.indexOf(f)){u=!0;break}}u&&(h.LMV_RESOURCE_ROOT+=h.LMV_VIEWER_VERSION+"/")}}function j(e){var t=e.endpoint;t||(t=z[(0,o.getEnv)()].ROOT);var r=e.api||t.ENDPOINT_API_DERIVATIVE_SERVICE_V2;if(o.endpoint.setEndpointAndApi(t,r),void 0!==e.escapeOssObjects&&o.endpoint.setEscapeOssObjects(e.escapeOssObjects),!(0,a.isNodeJS)())return W(e),Promise.resolve()}function q(e,t,r){t=t||function(){},l.ViewingService.rawGet(o.endpoint.getApiEndpoint(),null,"/auth/settoken",t,r,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},withCredentials:!0,postData:"access-token="+e})}function X(e){e?o.endpoint.HTTP_REQUEST_HEADERS.Authorization="Bearer "+e:delete o.endpoint.HTTP_REQUEST_HEADERS.Authorization}function Y(e,t,r){if(f.accessToken=e,o.endpoint.getUseCookie()){q(e,t,(function(t){i.logger.warn("Failed to set token in cookie. Will use header instead."),o.endpoint.setUseCookie(!1),X(e),r&&r(t)}))}else X(e),t&&t()}function K(e,t){var r,a=t?t.shouldInitializeAuth:void 0;void 0===a&&(a="false"!==(0,n.getParameterByName)("auth").toLowerCase());if(a||X(null),"Local"==(0,o.getEnv)()||!a)return setTimeout(e,0),void o.endpoint.setUseCredentials(void 0!==t.useCredentials&&t.useCredentials);o.endpoint.setUseCredentials(void 0===t.useCredentials||t.useCredentials),o.endpoint.setUseCookie(t.useCookie),f.tokenRefreshInterval&&(clearTimeout(f.tokenRefreshInterval),f.tokenRefreshInterval=null),t&&t.getAccessToken?(f.getAccessToken=t.getAccessToken,r=t.getAccessToken((function n(i){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3599;if(r=i,f.tokenRefreshInterval?Y(r):Y(r,e,e),"number"!=typeof o){var a=new Date(o);o=Boolean(+a)&&a.toISOString()===o?(a-Date.now())/1e3:3599}var s=(null==t?void 0:t.tokenExpirationBuffer)||5,l=o-s;l<=0&&(l=o),f.tokenRefreshInterval=setTimeout((function(){t.getAccessToken(n)}),1e3*l)})),"string"==typeof r&&r&&Y(r,e)):t&&t.accessToken?Y(r=t.accessToken,e):((r=(0,n.getParameterByName)("accessToken"))||i.logger.error("No access token is provided, but authorization requested. This is a problem."),Y(r,e))}function Z(e){i.logger.initialize(e);var t=(0,n.getParameterByName)("logLevel");t&&i.logger.setLevel(parseInt(t))}function Q(e){e&&"Local"===e.env||o.endpoint.getCdnRedirectUrl()&&l.ViewingService.rawGet(o.endpoint.getCdnRedirectUrl(),null,null,(function(e){e&&e.length&&(o.endpoint.setCdnUrl(e),i.logger.info("CDN_ROOT is: "+e))}),(function(){}),{withCredentials:!1,responseType:"text"})}function J(e,t){if((0,a.isNodeJS)())return H(e),j(e),Z(e),Q(e),void K(t,e);e.webGLHelpLink&&(m=e.webGLHelpLink),H(e);var r=j(e);Z(e),Q(e),(0,u.initializeLocalization)(e),(0,a.disableDocumentTouchSafari)(),function(e){var t=!(-1!==["Production","fluent"].indexOf("Production"));(e.optOutTrackingByDefault||t)&&(c.analytics.shouldTrack=!1);var r=e.productId?e.productId:"Local"===(0,o.getEnv)()?"Local":"NOT_SET";c.analytics.superProps={productId:r,lmvBuildType:h.LMV_BUILD_TYPE,lmvViewerVersion:h.LMV_VIEWER_VERSION}}(e),(0,s.initWorkerScript)();var n=function(e){return new Promise((function(t){K(t,e)}))}(e);Promise.all([r,n]).then(t)}function $(){i.logger.shutdown(),Autodesk.Viewing.Private.shutdownPropWorker()}},28400:(e,t,r)=>{"use strict";r.d(t,{A:()=>h});var n=r(7913),i=new ArrayBuffer(8),o=new Uint8Array(i),a=new Uint16Array(i),s=new Int32Array(i),l=new Uint32Array(i),u=new Float32Array(i),c=new Float64Array(i);function h(e){this.buffer=e,this.offset=0,this.byteLength=e.length}h.prototype.seek=function(e){this.offset=e},h.prototype.getBytes=function(e){var t=new Uint8Array(this.buffer.buffer,this.offset,e);return this.offset+=e,t},h.prototype.getVarints=function(){var e,t=0,r=0;do{t|=(127&(e=this.buffer[this.offset++]))<<r,r+=7}while(128&e);return t},h.prototype.getUint8=function(){return this.buffer[this.offset++]},h.prototype.getUint16=function(){return o[0]=this.buffer[this.offset++],o[1]=this.buffer[this.offset++],a[0]},h.prototype.getInt16=function(){var e=this.getUint16();return e>32767&&(e|=4294901760),e},h.prototype.getInt32=function(){var e=this.buffer,t=o,r=this.offset;return t[0]=e[r],t[1]=e[r+1],t[2]=e[r+2],t[3]=e[r+3],this.offset+=4,s[0]},h.prototype.getUint32=function(){var e=this.buffer,t=o,r=this.offset;return t[0]=e[r],t[1]=e[r+1],t[2]=e[r+2],t[3]=e[r+3],this.offset+=4,l[0]},h.prototype.getFloat32=function(){var e=this.buffer,t=o,r=this.offset;return t[0]=e[r],t[1]=e[r+1],t[2]=e[r+2],t[3]=e[r+3],this.offset+=4,u[0]},h.prototype.getIndicesArray=function(e,t,r){for(var n=this.buffer,i=new Uint8Array(e,t,2*r),o=this.offset,a=0,s=2*r;a<s;a+=2)i[a]=n[o],i[a+1]=n[o+1],o+=4;this.offset=o},h.prototype.getVector3Array=function(e,t,r,n){var i=this.buffer,o=this.offset,a=new Uint8Array(e.buffer,e.byteOffset,e.byteLength);if(3===n&&0===r){var s=12*t;a.set(i.subarray(o,o+s)),this.offset+=s}else{n*=4;for(var l=4*r,u=0;u<t;u++){for(var c=0;c<12;c++)a[l+c]=i[o++];l+=n}this.offset=o}},h.prototype.getVector2Array=function(e,t,r,n){var i=this.buffer,o=new Uint8Array(e.buffer,e.byteOffset,e.byteLength),a=this.offset;n*=4;for(var s=4*r,l=0;l<t;l++){for(var u=0;u<8;u++)o[s+u]=i[a++];s+=n}this.offset=a},h.prototype.getVector4=function(e,t){for(var r=this.buffer,n=o,i=this.offset,a=u,s=0;s<4;s++)n[0]=r[i],n[1]=r[i+1],n[2]=r[i+2],n[3]=r[i+3],e[t+s]=a[0],i+=4;this.offset=i},h.prototype.getFloat64=function(){for(var e=this.buffer,t=o,r=this.offset,n=0;n<8;n++)t[n]=e[r+n];return this.offset+=8,c[0]},h.prototype.getString=function(e){var t=(0,n.Pp)(this.buffer,this.offset,e);return this.offset+=e,t},h.prototype.reset=function(e){this.buffer=e,this.offset=0,this.byteLength=e.length}},74751:(e,t,r)=>{"use strict";r.r(t),r.d(t,{PropertyDatabase:()=>a});var n=r(7913);function i(e,t){for(var r,n=0,i=e.length-1;n<=i;){if(t===e[r=(n+i)/2|0])return r;t<e[r]?i=r-1:n=r+1}return-1}var o=r(51137);function a(e){var t,r,a,s,l,u,c,h,d,f,p,m,g,v,y,b,x,_=this,E=!1,w=!1,A={};for(var S in e.attrs){"pdb version 2"===(t=(0,n.Up)(e.attrs[S]))[0]&&(E=!0);for(var M=1;M<t.length;M++){if("Layer"===t[M][0])y=M;switch(t[M][1]){case"__parent__":d=M;break;case"__child__":h=M;break;case"__name__":f=M;break;case"__instanceof__":p=M;break;case"__viewable_in__":m=M;break;case"__externalref__":g=M;break;case"__node_flags__":v=M}E&&t[M][2]===o.GC.DbKey&&(t[M][6]=t[M][6]|o.zF.afDirectStorage)}break}for(var T in e.avs){var C=e.avs[T];C[0]==="[".charCodeAt(0)?a=(0,n.fN)(e.avs[T],0):(a=C,w=!0),delete e.avs;break}for(var P in e.offsets){var D=e.offsets[P];D[0]==="[".charCodeAt(0)?(r=(0,n.fN)(D,1))[r.length-1]=a.length/2:r=new Int32Array(D.buffer,D.byteOffset,D.byteLength/4),delete e.offsets;break}for(var L in e.values){s=e.values[L],l=(0,n.Zp)(s);break}for(var R in this.setIdsBlob=function(e){u=e,c=(0,n.Zp)(e)},e.ids){this.setIdsBlob(e.ids[R]);break}function I(e){for(var t={},r=0,n=e.length;r<n;r++){var i=e[r];Array.isArray(i)||(i=[i]);for(var o=0;o<i.length;o++){var a=i[o],s=t[a];void 0===s?t[a]=r:Array.isArray(s)?s.push(r):t[a]=[s,r]}}return t}this.getObjectCount=function(){return r.length-1},this.getValueAt=function(e){return(0,n.U8)(s,l[e])},this.getIntValueAt=function(e){return(0,n.ON)(s,l[e])},this.getIdAt=function(e){return(0,n.U8)(u,c[e])},this.externalIdsLoaded=function(){return Boolean(u)},this.getAttrValue=function(e,r,n){var i=t[e];return i[6]&o.zF.afDirectStorage&&i[2]===o.GC.DbKey?r:n?this.getIntValueAt(r):this.getValueAt(r)},this._getObjectProperty=function(e,r){var n=t[e],i=n[5]?n[5]:n[0],o=this.attributeHidden(e);return{displayName:i,displayValue:_.getAttrValue(e,r),displayCategory:n[1],attributeName:n[0],type:n[2],units:n[3],hidden:o,precision:n[7]||0}},this.getObjectProperties=function(e,r,n,i,o){var a={dbId:e,properties:[]},s=!1,l=r&&-1!==r.indexOf("externalId"),u=this.externalIdsLoaded();l&&!u&&console.error("Requesting externalID requires loading of the externalID table");var c=u&&(!r||l);if(c&&(a.externalId=this.getIdAt(e),r&&1===r.length))return a;var h=null;if(this.enumObjectProperties(e,(function(e,l){if(e!=p){var u=t[e];if(!(r&&-1===r.indexOf(u[0])&&-1===r.indexOf(u[5])||o&&-1===o.indexOf(u[1])||i&&(i.indexOf(u[0])>-1||i.indexOf(u[5])>-1)))if(e==f){var c=_.getAttrValue(e,l);s=!0,a.name=c}else{var d=_.attributeHidden(e);if(n&&d)return;var m=_._getObjectProperty(e,l);a.properties.push(m)}}else{var g=_.getObjectProperties(_.getAttrValue(e,l),r,!0,i,o);g&&g.properties&&(h=g)}})),h){for(var d={},m=a.properties,g=0;g<m.length;g++)d[m[g].displayName]=1;a.name||(a.name=h.name);for(var v=h.properties,y=0;y<v.length;y++)Object.prototype.hasOwnProperty.call(d,v[y].displayName)||m.push(v[y])}return o&&!a.properties.length?null:!r||a.properties.length||c||s?a:null},this.getExternalIdMapping=function(e){var t={};if(c&&"length"in c)for(var r=1,n=c.length;r<n;++r){var i=this.getIdAt(r);e&&!0!==e[i]||(t[i]=r)}return t},this.findRootNodes=function(){var e=[],t=[];return this.enumObjects((function(r){var n=!1,i=!1,o=!1;_.enumObjectProperties(r,(function(e,t){e==d?_.getAttrValue(e,t,!0)&&(i=!0):e==h?n=!0:e==f&&(o=!0)})),o&&!i&&(n?e.push(r):t.push(r))})),e.length>0?e:t},this.nodeHasChild=function(e){var t=!1;return this.enumObjectProperties(e,(function(e){if(e===h)return t=!0,!0})),t},this.getNodeNameAndChildren=function(e,t){var r,n,i=e.dbId;if(this.enumObjectProperties(i,(function(i,o){var a;if(i===d);else if(i!=h||t)i===f?e.name=_.getAttrValue(i,o):i===v?e.flags=_.getAttrValue(i,o,!0):i===p&&(n=o);else if((a=_.getAttrValue(i,o,!0))!==e.dbId){var s={dbId:a,parent:e.dbId};r?r.push(s):r=[s]}})),(!e.name||!e.flags)&&n){var o=_.getAttrValue(p,n,!0),a=A[o];a||(A[o]=a={dbId:o,name:null,flags:null},_.getNodeNameAndChildren(a,!0)),a.name&&!e.name&&(e.name=a.name),"number"!=typeof e.flags&&"number"==typeof a.flags&&(e.flags=a.flags)}return r},this.buildDbIdToFragMap=I;this.buildObjectTree=function(e,t,r,n){var i;t&&(i=I(t)),b={},x=0;var o=this.buildObjectTreeRec(e,0,i,0,r,n);return x>0&&console.warn("Property database integrity not guaranteed ("+x+")."),b=null,A={},o},this.buildObjectTreeRec=function(e,t,r,n,i,o){if(b[e])return x++,0;b[e]=t||e,n>i[0]&&(i[0]=n);var a,s={dbId:e},l=this.getNodeNameAndChildren(s),u=[];if(l)for(var c=0;c<l.length;c++){this.buildObjectTreeRec(l[c].dbId,e,r,n+1,i,o)&&u.push(l[c].dbId)}if(r){var h=r[e];void 0!==h&&(a=Array.isArray(h)?h:[h])}var d=s.flags||0;void 0===d&&(d=a&&a.length?6:(u.length,0));var f=u.length+(a?a.length:0);return f&&o.setNode(e,t,s.name,d,u,a),f},this.getSearchTerms=function(e){for(var t=(e=e.toLowerCase()).match(/"[^"]+"|[^\s]+/g)||[],r=t.length;r--;)t[r]=t[r].replace(/"/g,"");var n=[];for(r=0;r<t.length;r++)t[r].length>1&&n.push(t[r]);return n},this.bruteForceSearch=function(e,r,n){var o=this.getSearchTerms(e);if(0===o.length)return[];for(var a=[],s=null==n?void 0:n.searchHidden,u=null==n?void 0:n.includeInherited,c={},h=0;h<o.length;h++){for(var d=[],f=[],m=0,g=l.length;m<g;m++){var v=this.getValueAt(m);null!==v&&(-1!==v.toString().toLowerCase().indexOf(o[h])&&f.push(m))}0!==f.length?(f.sort((function(e,t){return e-t})),this.enumObjects((function(e){_.enumObjectProperties(e,(function(n,o){if(u&&n===p){var a=parseInt(_.getAttrValue(n,o));c[a]=c[a]||[],c[a].push(e)}if(!s&&_.attributeHidden(n))return;if(-1!==i(f,o)){if(r&&r.length&&-1===r.indexOf(t[n][0]))return;return d.push(e),!0}}))})),a.push(d)):a.push(d)}var y=function(e,t){for(var r=new Set(e),n=0;n<e.length;++n){var i=e[n];if(i in t)for(var o=t[i],a=0;a<o.length;++a){var s=o[a];r.has(s)||(e.push(s),r.add(s))}}};if(1===a.length)return u&&y(a[0],c),a[0];for(var b={},x=a[0],E=0;E<x.length;E++)b[x[E]]=1;for(var w=1;w<a.length;w++){x=a[w];for(var A={},S=0;S<x.length;S++)1===b[x[S]]&&(A[x[S]]=1);b=A}for(var M in d=[],b)d.push(parseInt(M));return u&&y(d,c),d},this.bruteForceFind=function(e){var r=[];return this.enumObjects((function(n){var i=!1;_.enumObjectProperties(n,(function(r){var n=t[r],o=n[0],a=n[5];if(o===e||a===e)return i=!0,!0})),i&&r.push(n)})),r},this.getLayerToNodeIdMapping=function(){var e={};return this.enumObjects((function(t){_.enumObjectProperties(t,(function(r,n){if(r==y){var i=_.getAttrValue(r,n);return Array.isArray(e[i])||(e[i]=[]),e[i].push(t),!0}}))})),e},this.getAttributeDef=function(e){var r=t[e];return{name:r[0],category:r[1],dataType:r[2],dataTypeContext:r[3],description:r[4],displayName:r[5],flags:r[6],precision:r.length>7?r[7]:0}},this.enumAttributes=function(e){for(var r=1;r<t.length&&!e(r,this.getAttributeDef(r),t[r]);r++);},this.enumObjectProperties=w?function(e,t){for(var n=r[e],i=r[e+1],o=a,s=0;n<i;){for(var l=o[n++],u=127&l,c=7;128&l;)u|=(127&(l=o[n++]))<<c,c+=7;for(s+=u,u=127&(l=o[n++]),c=7;128&l;)u|=(127&(l=o[n++]))<<c,c+=7;if(t(s,u))break}}:function(e,t){for(var n=2*r[e],i=2*r[e+1],o=n;o<i;o+=2){if(t(a[o],a[o+1]))break}};var O={};function N(e,t,n){var i=r[e],o=r[e+1],s=a,l=[],u=[];n=n||{};for(var c=0;i<o;){for(var h=s[i++],d=127&h,f=7;128&h;)d|=(127&(h=s[i++]))<<f,f+=7;for(c+=d,d=127&(h=s[i++]),f=7;128&h;)d|=(127&(h=s[i++]))<<f,f+=7;if(c===p){var m=_.getAttrValue(c,d);u.push(m)}else t&&!t[c]||(n[c]=d,l.push(c),l.push(d))}for(var g=0;g<u.length;g++){var v=u[g],y=O[v];y||(O[v]=y=N(v));for(var b=0;b<y.length;b+=2){var x=y[b],E=y[b+1];t&&!t[x]||(n[x]||_.attributeHidden(x)||(n[x]=E,l.push(x),l.push(E)))}}return l}this.getPropertiesSubsetWithInheritance=w?N:function(e,t,n){var i=2*r[e],o=2*r[e+1],s=[],l=[];n=n||{};for(var u=i;u<o;u+=2){var c=a[u],h=a[u+1];if(c===p){var d=_.getAttrValue(c,h);l.push(d)}else t&&!t[c]||(n[c]=h,s.push(c),s.push(h))}for(var f=0;f<l.length;f++){var m=l[f],g=O[m];g||(O[m]=g=N(m));for(var v=0;v<g.length;v+=2){var y=g[v],b=g[v+1];t&&!t[y]||(n[y]||_.attributeHidden(y)||(n[y]=b,s.push(y),s.push(b)))}}return s},this.findLayers=function(){var e={name:"root",id:1,index:1,children:[],isLayer:!1,childCount:0};if(void 0===y)return e;var t=[],r=this;return this.enumObjects((function(e){r.enumObjectProperties(e,(function(e,n){if(e===y){var i=r.getValueAt(n);return-1===t.indexOf(i)&&t.push(i),!0}}))})),t.sort((function(e,t){return e.localeCompare(t,void 0,{sensitivity:"base",numeric:!0})})),e.childCount=t.length,e.children=t.map((function(e,t){return{name:e,index:t+1,id:t+1,isLayer:!0}})),e},this.enumObjects=function(e,t,n){var i=r.length-1;t="number"==typeof t?Math.max(t,1):1,n="number"==typeof n?Math.min(i,n):i;for(var o=t;o<n&&!e(o);o++);},this.getAttrChild=function(){return h},this.getAttrParent=function(){return d},this.getAttrName=function(){return f},this.getAttrLayers=function(){return y},this.getAttrInstanceOf=function(){return p},this.getAttrViewableIn=function(){return m},this.getAttrXref=function(){return g},this.getAttrNodeFlags=function(){return v},this.attributeHidden=function(e){return 1&t[e][6]||e==d||e==h||e==m||e==g},this._attributeIsBlacklisted=function(e){var r=t[e],n=r[0];return"Dimensions"===r[1]&&-1!==o.Nj.indexOf(n)},this.findParent=function(e){var t=null;return _.enumObjectProperties(e,(function(e,r){e===d&&(t=_.getAttrValue(e,r,!0))})),t},this._getAttributeAndValueIds=function(e,t){for(var r=this.getPropertiesSubsetWithInheritance(e),n=0;n<r.length;n+=2){var i=r[n];this._attributeIsBlacklisted(i)||this.attributeHidden(i)||t.push({attrId:i,valId:r[n+1]})}t.sort((function(e,t){return e.attrId-t.attrId}))},this.findDifferences=function(e,t,r){var n={changedIds:[]},i=t&&t.dbIds,o=t&&t.listPropChanges;o&&(n.propChanges=[]);var a=this,s=e,l=[],u=[],c={result:[],dbId:-1},h={result:[],dbId:-1},d=function(e){var t=0,r=0;if(l.length=0,u.length=0,a._getAttributeAndValueIds(e,l,!0,c),s._getAttributeAndValueIds(e,u,!0,h),l.length&&u.length){for(var i=!1,d=void 0;t<l.length&&r<u.length;){var f=l[t],p=u[r],m=f&&f.attrId,g=f&&f.valId,v=p&&p.attrId,y=p&&p.valId;if(m!==v||g!==y){if(i=!0,!o)break;var b=void 0===v||v>m,x=void 0;void 0===m||m>v?((x=s._getObjectProperty(v,y)).displayValueB=x.displayValue,x.displayValue=void 0,r++):b?((x=a._getObjectProperty(m,g)).displayValueB=void 0,t++):((x=a._getObjectProperty(m,g)).displayValueB=_.getAttrValue(v,y),t++,r++),d||(d=[]),d.push(x)}else t++,r++}i&&(n.changedIds.push(e),o&&n.propChanges.push(d))}},f=-1,p=function(e,t){var n=Math.floor(100*e/t);n!=f&&(r&&r(n),f=n)};if(i)for(var m=0;m<i.length;m++){d(i[m]),p(m,i.length)}else for(var g=Math.min(a.getObjectCount(),this.getObjectCount()),v=1;v<g;v++)d(v),p(v,g);return n},this.dtor=function(){t=null,r=null,a=null,s=null,l=null,u=null,c=null,h=0,d=0,f=0,p=0,m=0,g=0,v=0}}},51137:(e,t,r)=>{"use strict";r.d(t,{GC:()=>n,zF:()=>i,Nj:()=>o,OY:()=>a});var n={Unknown:0,Boolean:1,Integer:2,Double:3,Float:4,BLOB:10,DbKey:11,String:20,LocalizableString:21,DateTime:22,GeoLocation:23,Position:24},i={afHidden:1,afDontIndex:2,afDirectStorage:4,afReadOnly:8},o=["Perimeter","Volume","Area","Length","Width","Height"],a=function(e){return[n.Integer,n.Double,n.Float].includes(e)}},7913:(e,t,r)=>{"use strict";function n(e,t,r){var n,i,o,a,s,l;for(n="",o=r,i=0;i<o;)switch((a=e[t+i++])>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:n+=String.fromCharCode(a);break;case 12:case 13:s=e[t+i++],n+=String.fromCharCode((31&a)<<6|63&s);break;case 14:s=e[t+i++],l=e[t+i++],n+=String.fromCharCode((15&a)<<12|(63&s)<<6|(63&l)<<0)}return n}function i(e,t,r){var n,i,o,a=r||0;if(i=e.length,t)for(n=0;n<i;n++)(o=e.charCodeAt(n))>=1&&o<=127?t[a++]=o:o>2047?(t[a++]=224|o>>12&15,t[a++]=128|o>>6&63,t[a++]=128|o>>0&63):(t[a++]=192|o>>6&31,t[a++]=128|o>>0&63);else for(n=0;n<i;n++)(o=e.charCodeAt(n))>=1&&o<=127?a++:a+=o>2047?3:2;return a-(r||0)}r.d(t,{MA:()=>n,Ss:()=>i,Pp:()=>o,Up:()=>a,U8:()=>s,ON:()=>l,fN:()=>u,Zp:()=>c});function o(e,t,r){return void 0===t&&(t=0),void 0===r&&(r=e.length),r>1048576?function(e,t,r){var n,i,o,a,s,l,u,c;for(n="",s=[],o=r,l=0,i=0;i<o;){switch((a=e[t+i++])>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:s.push(String.fromCharCode(a));break;case 12:case 13:u=e[t+i++],s.push(String.fromCharCode((31&a)<<6|63&u));break;case 14:u=e[t+i++],c=e[t+i++],s.push(String.fromCharCode((15&a)<<12|(63&u)<<6|(63&c)<<0))}(++l>=32768||i>=o)&&(n+=s.join(""),s.length=0,l=0)}return n}(e,t,r):n(e,t,r)}function a(e){var t=o(e,0,e.length);return t=t.replace(/\u000e/gi,""),JSON.parse(t)}function s(e,t){if(void 0===t)return"";for(var r=t;r<e.length-1;){var n=e[r];if(44==n&&(10==e[r+1]||13==e[r+1]))break;if(10==n||13==n)break;r++}var i=o(e,t,r-t);try{return JSON.parse(i)}catch(e){return console.error("Error parsing property blob to JSON : "+i),i}}function l(e,t){var r=0,n=t;for(34==e[n]&&n++;n<e.length-1;){var i=e[n];if(44==i&&(10==e[n+1]||13==e[n+1]))break;if(10==i||13==i||34==i)break;i>=48&&i<=57&&(r=10*r+(i-48)),n++}return r}function u(e,t){for(var r=0,n=0,i=e.length;n<i;n++)44==e[n]&&r++;r++;var o=new Uint32Array(r+(t?1:0));n=0;for(var a=e.length;91!=e[n]&&n<a;)n++;if(n==e.length)return null;n++;var s=!1;r=0;for(var l=0;n<a;){var u=e[n];u>=48&&u<=57?(l=10*l+(u-48),s=!0):44==u||93==u?s&&(o[r++]=l,s=!1,l=0):(s=!1,l=0),n++}return o}function c(e){for(var t=0,r=e.length-1,n=0;n<r;n++)44!=e[n]||10!=e[n+1]&&13!=e[n+1]||t++;if(!t)return null;t++;var i=new Uint32Array(t);for(n=0,t=0;91!=e[n]&&n<r;)n++;n++,i[t++]=n;for(var o=!1;n<r;)10==e[n]||13==e[n]?o=!0:o&&(o=!1,i[t++]=n),n++;return i}},42517:(e,t,r)=>{"use strict";r.r(t),r.d(t,{VertexBufferBuilder:()=>o});var n=2*Math.PI,i=[0,1,3,0,3,2];function o(e,t,r,n){var i=t||65536;this.FULL_COUNT=0|(r||32767),this.useInstancing=e,this.useCompactBuffers=n,this.stride=10,this.allocVcount=4*(this.useInstancing?i/4:i),this.vb=new ArrayBuffer(this.stride*this.allocVcount),this.vbf=new Float32Array(this.vb),this.vbi=new Int32Array(this.vb),this.ib=this.useInstancing?null:new Uint16Array(i),this.minLineWidth=Number.MAX_VALUE,this.reset(0)}o.prototype.reset=function(e){this.vcount=e,this.icount=0,this.minx=this.miny=1/0,this.maxx=this.maxy=-1/0,this.dbIds={},this.lastDbId=null,this.colors={},this.numEllipticals=0,this.numCirculars=0,this.numTriangleGeoms=0,this.hasLineStyles=!1,this.changeTracking={},this.stride=10},o.prototype.expandStride=function(){var e=this.stride;if(!(e>=12)){for(var t=this.stride+2,r=new ArrayBuffer(t*this.allocVcount),n=new Uint8Array(this.vb),i=new Uint8Array(r),o=0,a=this.vcount;o<a;o++)for(var s=o*e*4,l=o*t*4,u=0;u<4*e;u++)i[l+u]=n[s+u];this.vb=r,this.vbf=new Float32Array(r),this.vbi=new Int32Array(r),this.stride=t}},o.prototype.addToBounds=function(e,t){e<this.minx&&(this.minx=e),e>this.maxx&&(this.maxx=e),t<this.miny&&(this.miny=t),t>this.maxy&&(this.maxy=t)};var a=new Int32Array(1);function s(e){return a[0]=e,a[0]}o.prototype.trackChanges=function(e,t,r,n,i,o){if(r!==this.lastDbId&&(this.dbIds[s(r)]=1,this.lastDbId=r),o&&(this.hasLineStyles=!0),this.useCompactBuffers){var a=this.changeTracking;l("geomType",e),l("color",t),l("dbId",r),l("layerId",n),l("viewportId",i),l("linePattern",o),this.colors[s(t)]=1}function l(t,r){void 0===a[t]?a[t]=e:a[t]===r&&(a[t+"Varies"]=!0)}},o.prototype.setCommonVertexAttribs=function(e,t,r,n,i,o,a,s){this.trackChanges(r,n,i,o,a,s),t&=255,r&=255,s&=255,o&=65535,a&=65535,this.vbi[e+8]=t|r<<8|s<<16,this.vbi[e+6]=n,this.vbi[e+7]=i,this.vbi[e+9]=o|a<<16},o.prototype.addVertexTriangleGeom=function(e,t,r,n,i,o,a,s,l,u){for(var c=this.vcount,h=this.vbf,d=this.useInstancing?1:4,f=0;f<d;f++){var p=(c+f)*this.stride;h[p]=e,h[p+1]=t,h[p+2]=r,h[p+3]=n,h[p+4]=i,h[p+5]=o,this.setCommonVertexAttribs(p,0+f,5,a,s,l,u,0),this.vcount++}return c},o.prototype.addVertexLine=function(e,t,r,i,o,a,s,l,u,c,h,d,f){var p=this.vcount,m=this.vbf;l>=0&&a>0&&i>0&&(this.minLineWidth=Math.min(this.minLineWidth,a));var g=1;d&&f?g=8:d?g=9:f&&(g=10);for(var v=this.useInstancing?1:4,y=0;y<v;y++){var b=(p+y)*this.stride;m[b]=e,m[b+1]=t,m[b+2]=(r+Math.PI)/n,m[b+3]=i,m[b+4]=.5*a,m[b+5]=o,this.setCommonVertexAttribs(b,0+y,g,s,l,u,c,h),this.vcount++}return p},o.prototype.addVertexTexQuad=function(e,t,r,i,o,a,s,l,u){for(var c=this.vcount,h=this.vbf,d=this.useInstancing?1:4,f=0;f<d;f++){var p=(c+f)*this.stride;h[p]=e,h[p+1]=t,h[p+2]=o/n,h[p+3]=r,h[p+4]=i,this.setCommonVertexAttribs(p,0+f,4,a,s,l,u,0),this.vcount++}return c},o.prototype.addVertexArc=function(e,t,r,i,o,a,s,l,u,c,h,d){for(var f=this.vcount,p=this.vbf,m=o==a?2:3,g=this.useInstancing?1:4,v=0;v<g;v++){var y=(f+v)*this.stride;p[y]=e,p[y+1]=t,p[y+2]=r/n,p[y+3]=i/n,p[y+4]=.5*l,p[y+5]=o,3===m&&(p[y+10]=a,p[y+11]=s),this.setCommonVertexAttribs(y,0+v,m,u,c,h,d,0),this.vcount++}return f},o.prototype.addVertex=function(e,t,r,n,i,o){var a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0;if(!this.useInstancing){var s=this.vcount,l=this.stride*s,u=this.vbf;return u[l]=e,u[l+1]=t,this.setCommonVertexAttribs(l,0,a,r,n,i,o,0),this.vcount++,s}},o.prototype.addVertexPolytriangle=function(e,t,r,n,i,o){this.useInstancing||(this.addVertex(e,t,r,n,i,o),this.addToBounds(e,t))},o.prototype.addVertexMSDFPolytriangle=function(e,t,r,n,i,o,a,s){this.addVertexTexPolytriangle(e,t,r,n,i,o,a,s,6)},o.prototype.addIndices=function(e,t){if(!this.useInstancing){var r=this.ib,n=this.icount;if(n+e.length>=r.length){for(var i=new Uint16Array(2*Math.max(e.length,r.length)),o=0;o<n;++o)i[o]=r[o];this.ib=r=i}for(o=0;o<e.length;++o)r[n+o]=t+e[o];this.icount+=e.length}},o.prototype.finalizeQuad=function(e){this.useInstancing||this.addIndices(i,e)},o.prototype.addSegment=function(e,t,r,n,i,o,a,s,l,u,c,h,d){var f=r-e,p=n-t,m=f||p?Math.atan2(p,f):0,g=f||p?Math.sqrt(f*f+p*p):0,v=this.addVertexLine(e,t,m,g,i,o,a,s,l,u,c,h,d);this.finalizeQuad(v),this.addToBounds(e,t),this.addToBounds(r,n)},o.prototype.addTriangleGeom=function(e,t,r,n,i,o,a,s,l,u){this.numTriangleGeoms++;var c=this.addVertexTriangleGeom(e,t,r,n,i,o,a,s,l,u);this.finalizeQuad(c),this.addToBounds(e,t),this.addToBounds(r,n),this.addToBounds(i,o)},o.prototype.addArc=function(e,t,r,i,o,a,s,u,c,h,d,f){o==a?this.numCirculars++:(this.numEllipticals++,this.expandStride());var p=l(r,i);if(r=p.start,i=p.end,0==r&&0==i&&(i=n),(x=Math.abs(r-i))>1e-4&&Math.abs(x-n)>1e-4){var m=e+o*Math.cos(r),g=t+a*Math.sin(r);this.addSegment(m,g,m,g,0,u,c,h,d,f);var v=e+o*Math.cos(i),y=t+a*Math.sin(i);this.addSegment(v,y,v,y,0,u,c,h,d,f)}else this.addToBounds(e-o,t-a),this.addToBounds(e+o,t+a);var b=this.addVertexLine(e,t,0,1e-4,0,0,33554431,h,d,f);this.finalizeQuad(b);var x,_=this.addVertexArc(e,t,r,i,o,a,s,u,c,h,d,f);this.finalizeQuad(_)},o.prototype.addTexturedQuad=function(e,t,r,n,i,o,a,s,l){var u=this.addVertexTexQuad(e,t,r,n,i,o,a,s,l);this.finalizeQuad(u);var c=.5*Math.cos(i),h=.5*Math.sin(i),d=Math.abs(r*c)+Math.abs(n*h),f=Math.abs(r*h)+Math.abs(n*c);this.addToBounds(e-d,t-f),this.addToBounds(e+d,t+f)},o.prototype.addVertexImagePolytriangle=function(e,t,r,n,i,o,a,s){return this.addVertexTexPolytriangle(e,t,r,n,i,o,a,s,7)},o.prototype.addVertexTexPolytriangle=function(e,t,r,n,i,o,a,s,l){if(!this.useInstancing){var u=this.vcount,c=this.vbf;this.addVertex(e,t,i,o,a,s,l),c[u*this.stride+2]=r,c[u*this.stride+3]=n,this.addToBounds(e,t)}},o.prototype.isFull=function(e){e=e||3;var t=this.useInstancing?4:1;return this.vcount*t+e>this.FULL_COUNT},o.prototype.makeCompactVertexLayout=function(){var e=Object.keys(this.colors),t=Object.keys(this.dbIds);if(10!==this.stride)return null;var r=e.length+t.length;if(e.length+t.length>65536)return null;var n=new Int32Array(r+1);n[0]=0;for(var i=1,o=0;o<e.length;o++,i++)n[i]=parseInt(e[o]),this.colors[e[o]]=i;for(o=0;o<t.length;o++,i++)n[i]=parseInt(t[o]),this.dbIds[t[o]]=i;var a=new ArrayBuffer(24*this.vcount),s=new Int32Array(a),l=new Uint16Array(a),u=this.maxx-this.minx||1,c=this.maxy-this.miny||1,h=this.minx,d=this.miny,f=Math.max(u,c);function p(e){return 0|Math.round((e-h)/u*65535)}function m(e){return 0|Math.round((e-d)/c*65535)}function g(e){return 0|Math.round(e/f*65535)}function v(e){return 0|65535*e}function y(e){return e<0?32768+32767*Math.min(1,-e/1024):e?0|Math.round(e/f*32767)||1:e}for(o=0;o<this.vcount;o++){var b=this.stride*o,x=6*o,_=2*x;switch(this.vbi[b+8]>>8&255){case 0:l[_]=p(this.vbf[b]),l[_+1]=m(this.vbf[b+1]);break;case 1:case 8:case 9:case 10:l[_]=p(this.vbf[b]),l[_+1]=m(this.vbf[b+1]),l[_+2]=v(this.vbf[b+2]),l[_+3]=g(this.vbf[b+3]),l[_+4]=y(this.vbf[b+4]);break;case 2:l[_]=p(this.vbf[b]),l[_+1]=m(this.vbf[b+1]),l[_+2]=v(this.vbf[b+2]),l[_+3]=v(this.vbf[b+3]),l[_+4]=y(this.vbf[b+4]),l[_+5]=g(this.vbf[b+5]);break;case 3:break;case 4:l[_]=p(this.vbf[b]),l[_+1]=m(this.vbf[b+1]),l[_+2]=v(this.vbf[b+2]),l[_+3]=g(this.vbf[b+3]),l[_+4]=g(this.vbf[b+4]);break;case 5:l[_]=p(this.vbf[b]),l[_+1]=m(this.vbf[b+1]),l[_+2]=p(this.vbf[b+2]),l[_+3]=m(this.vbf[b+3]),l[_+4]=p(this.vbf[b+4]),l[_+5]=m(this.vbf[b+5]);break;default:console.error("Unknown geometry type")}l[_+6]=this.colors[this.vbi[b+6]]||0,l[_+7]=this.dbIds[this.vbi[b+7]]||0,s[x+4]=this.vbi[b+8],s[x+5]=this.vbi[b+9]}var E={};E.vb=new Float32Array(a),E.vbstride=6;var w=this.useInstancing?1:0;return E.vblayout={fields1:{offset:0,itemSize:2,bytesPerItem:2,divisor:w,normalized:!0},fields2:{offset:1,itemSize:4,bytesPerItem:2,divisor:w,normalized:!0},uvIdColor:{offset:3,itemSize:2,bytesPerItem:2,divisor:w,normalized:!1},flags4b:{offset:4,itemSize:4,bytesPerItem:1,divisor:w,normalized:!1},layerVp4b:{offset:5,itemSize:4,bytesPerItem:1,divisor:w,normalized:!1}},E.unpackXform={x:u,y:c,z:h,w:d},E.texData=n,E},o.prototype.makeWideVertexLayout=function(){var e={};e.vb=new Float32Array(this.vb.slice(0,this.vcount*this.stride*4)),e.vbstride=this.stride;var t=this.useInstancing?1:0;return e.vblayout={fields1:{offset:0,itemSize:2,bytesPerItem:4,divisor:t,normalized:!1},fields2:{offset:2,itemSize:4,bytesPerItem:4,divisor:t,normalized:!1},color4b:{offset:6,itemSize:4,bytesPerItem:1,divisor:t,normalized:!0},dbId4b:{offset:7,itemSize:4,bytesPerItem:1,divisor:t,normalized:!1},flags4b:{offset:8,itemSize:4,bytesPerItem:1,divisor:t,normalized:!1},layerVp4b:{offset:9,itemSize:4,bytesPerItem:1,divisor:t,normalized:!1}},e.vblayout.extraParams={offset:this.stride-2,itemSize:2,bytesPerItem:4,divisor:t,normalized:!1},e},o.prototype.toMesh=function(){var e=null;if(this.useCompactBuffers&&(e=this.makeCompactVertexLayout()),e||(e=this.makeWideVertexLayout()),this.useInstancing){e.numInstances=this.vcount;var t=new Int32Array([0,1,2,3]);e.vblayout.instFlags4b={offset:0,itemSize:4,bytesPerItem:1,divisor:0,normalized:!1},e.vblayout.instFlags4b.array=t.buffer;e.indices=new Uint16Array(i)}else e.indices=new Uint16Array(this.ib.buffer.slice(0,2*this.icount));e.dbIds=this.dbIds;var r=this.maxx-this.minx,n=this.maxy-this.miny,o=Math.max(r,n);e.boundingBox={min:{x:this.minx,y:this.miny,z:.001*-o},max:{x:this.maxx,y:this.maxy,z:.001*o}};e.boundingSphere={center:{x:.5*(this.minx+this.maxx),y:.5*(this.miny+this.maxy),z:0},radius:.5*Math.sqrt(r*r+n*n)};return e};var l=function(e,t){function r(){function r(e,t){return Math.abs(e-t)<.001}r(e,0)&&(e=0),r(t,0)&&(t=0),r(e,n)&&(e=n),r(t,n)&&(t=n)}if(r(),e>t)for(;e>n;)e-=n,t-=n;else for(;t>n;)e-=n,t-=n;return r(),e<0&&t>0&&(e+=n),{start:e,end:t}}},89371:(e,t,r)=>{"use strict";r.r(t),r.d(t,{F2D:()=>p,F2dDataType:()=>c,F2dSemanticType:()=>h,F2dShadowRatio:()=>d,restoreSignBitFromLSB:()=>f});var n=r(42517),i=r(22585),o=r(73075),a=function(e,t){t.min.x<e.min.x&&(e.min.x=t.min.x),t.min.y<e.min.y&&(e.min.y=t.min.y),t.min.z<e.min.z&&(e.min.z=t.min.z),t.max.x>e.max.x&&(e.max.x=t.max.x),t.max.y>e.max.y&&(e.max.y=t.max.y),t.max.z>e.max.z&&(e.max.z=t.max.z)},s=r(28400),l=r(98926),u=r(79659),c={dt_object:0,dt_void:1,dt_byte:2,dt_int:3,dt_float:4,dt_double:5,dt_varint:6,dt_point_varint:7,dt_byte_array:32,dt_int_array:33,dt_float_array:34,dt_double_array:35,dt_varint_array:36,dt_point_varint_array:37,dt_arc:38,dt_circle:39,dt_circular_arc:40,dt_string:63,dt_last_data_type:127},h={st_object_member:0,st_fill:1,st_fill_off:2,st_clip_off:3,st_layer:4,st_link:5,st_line_weight:6,st_miter_angle:7,st_miter_length:8,st_line_pattern_ref:9,st_back_color:10,st_color:11,st_markup:12,st_object_id:13,st_markup_id:14,st_reset_rel_offset:15,st_font_ref:16,st_begin_object:32,st_clip:33,st_line_caps:34,st_line_join:35,st_line_pattern_def:36,st_font_def:37,st_viewport:38,st_sheet:42,st_arc:43,st_polyline:44,st_raster:45,st_text:46,st_polytriangle:47,st_dot:48,st_end_object:63,st_last_semantic_type:127},d=.0075;function f(e){return 1&e?-(e>>>1):e>>>1}function p(e,t,r){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(this.metadata=e,this.scaleX=1,this.scaleY=1,this.bbox={min:{x:0,y:0,z:0},max:{x:0,y:0,z:0}},this.is2d=!0,this.layersMap={},this.fontDefs={},this.fontCount=0,this.fontId=0,this.manifestAvailable=!1,this.geomMetricsSum=0,this.objectMemberQueue=[],this.propertydb={attrs:[],avs:[],ids:[],values:[],offsets:[],viewables:[]},e){var a=e.page_dimensions;this.paperWidth=a.page_width,this.paperHeight=a.page_height,this.scaleX=this.paperWidth/a.plot_width,this.scaleY=this.paperHeight/a.plot_height,this.hidePaper=a.hide_paper;var s=this.paperWidth,l=this.paperHeight;this.bbox.max.x=s,this.bbox.max.y=l;var u=e.page_dimensions||{};if(isFinite(u.paper_rotation)&&0!==u.paper_rotation){var c=u.paper_rotation*Math.PI/180,h=Math.cos(c),d=Math.sin(c),f=s*h,p=s*d,m=-l*d,g=l*h;this.bbox.min.x=Math.min(0,f,m,f+m),this.bbox.max.x=Math.max(0,f,m,f+m),this.bbox.min.y=Math.min(0,p,g,p+g),this.bbox.max.y=Math.max(0,p,g,p+g)}isFinite(u.paper_offset_x)&&0!==u.paper_offset_x&&(this.bbox.min.x+=u.paper_offset_x,this.bbox.max.x+=u.paper_offset_x),isFinite(u.paper_offset_y)&&0!==u.paper_offset_y&&(this.bbox.min.y+=u.paper_offset_y,this.bbox.max.y+=u.paper_offset_y);var v=0;for(var y in this.layersMap[0]=v++,e.layers){var b=parseInt(y);this.layersMap[b]=v++}if(this.layerCount=v,this.createLayerGroups(e.layers),e.geom_metrics){var x=Object.keys(e.geom_metrics).map((function(t){return e.geom_metrics[t]}));this.geomMetricsSum=x.reduce((function(e,t){return e+t}))}}this.hidePaper=this.hidePaper||o.modelSpace,this.noShadow=!!o.noShadow,this.hasPageShadow=!1,this.opCount=0,this.excludeTextGeometry=o.excludeTextGeometry,this.extendStringsFetching=o.extendStringsFetching,this.fontFaces=[],this.fontFamilies=[],this.viewports=[{}],this.currentVpId=0,this.viewports[0].geom_metrics=this.currentGeomMetrics={arcs:0,circles:0,circ_arcs:0,viewports:0,clips:0,colors:0,db_ids:0,dots:0,fills:0,layers:0,line_caps:0,line_joins:0,line_patterns:0,line_pat_refs:0,plines:0,pline_points:0,line_weights:0,links:0,miters:0,ptris:0,ptri_indices:0,ptri_points:0,rasters:0,texts:0,strings:[]},this.clips=[0],this.strings=[],this.stringDbIds=[],this.stringBoxes=[],this.extendStringsFetching&&(this.stringCharWidths=[],this.stringAngles=[],this.stringPositions=[],this.stringHeights=[]),this.currentStringNumber=-1,this.currentStringBox=new i.LmvBox3,this.linkBoxes=[],this.currentLinkBox=new i.LmvBox3,this.objectNumber=0,this.currentFakeId=-2,this.imageNumber=0,this.linkNumber=0,this.maxObjectNumber=0,this.objectStack=[],this.objectNameStack=[],this.parseObjState={polyTriangle:{},viewport:{},clip:{},raster:{},text:{},fontDef:{},uknown:{}},this.layer=0,this.bgColor="number"==typeof o.bgColor?o.bgColor:4294967295,this.contrastColor=this.color=this.fillColor=4278190080,this.hidePaper&&(this.contrastColor=4294967040),this.isMobile=o&&!!o.isMobile;var _=o&&!!o.isWebGL2,E=this.isMobile&&(_||this.geomMetricsSum>1e7),w=E&&o&&!!o.supportsInstancing,A=E;if(this.max_vcount=this.isMobile?16383:void 0,this.currentVbb=new n.VertexBufferBuilder(w,void 0,this.max_vcount,A),this.meshes=[],this.numCircles=this.numEllipses=this.numPolylines=this.numLineSegs=0,this.numPolytriangles=this.numTriangles=0,this.error=!1,this.offsetX=0,this.offsetY=0,t){this.manifestAvailable=!0,this.imageId2URI={};for(var S=t.assets,M=0,T=S.length;M<T;++M){var C=S[M],P=C.mime;if(-1!==P.indexOf("image/")){var D=C.id;D=D.substr(0,D.indexOf(".")),this.imageId2URI[D]=r+C.URI}"Autodesk.CloudPlatform.PropertyAttributes"===C.type&&this.propertydb.attrs.push({path:C.URI}),"Autodesk.CloudPlatform.PropertyValues"===C.type&&this.propertydb.values.push({path:C.URI}),"Autodesk.CloudPlatform.PropertyIDs"===C.type&&this.propertydb.ids.push({path:C.URI}),"Autodesk.CloudPlatform.PropertyViewables"===C.type&&this.propertydb.viewables.push({path:C.URI}),"Autodesk.CloudPlatform.PropertyOffsets"===C.type&&-1===C.id.indexOf("rcv")&&this.propertydb.offsets.push({path:C.URI}),"Autodesk.CloudPlatform.PropertyAVs"===C.type&&this.propertydb.avs.push({path:C.URI})}}}p.prototype.load=function(e,t){if(t instanceof Uint8Array||(t=new Uint8Array(t)),this.data=t,this.parse(),this.stringBoxes.length){var r=new Float32Array(this.stringBoxes.length);r.set(this.stringBoxes),this.stringBoxes=r}e.loadDoneCB(!0)},p.prototype.loadFrames=function(e){this.loadContext=e;var t=e.data;if(t)t instanceof Uint8Array||(t=new Uint8Array(t)),this.data=t;else if(e.finalFrame&&(this.data=null,this.stringBoxes.length)){var r=new Float32Array(this.stringBoxes.length);r.set(this.stringBoxes),this.stringBoxes=r}this.parseFrames(e.finalFrame),e.loadDoneCB(!0)},p.prototype.pushMesh=function(e){this.meshes.push(e),e.material={skipEllipticals:!this.currentVbb.numEllipticals,skipCircles:!this.currentVbb.numCirculars,skipTriangleGeoms:!this.currentVbb.numTriangleGeoms,useInstancing:this.currentVbb.useInstancing,unpackPositions:!!e.unpackXform},this.currentImage&&(e.material.image=this.currentImage,e.material.image.name=this.imageNumber++,this.currentImage=null)},p.prototype.flushBuffer=function(e,t){if(this.currentVbb.vcount||t){var r=t;if(r=r||this.currentVbb.isFull(e)){if(this.currentVbb.vcount){var n=this.currentVbb.toMesh();a(this.bbox,n.boundingBox),this.pushMesh(n),this.currentVbb.reset(0)}this.loadContext&&this.loadContext.loadDoneCB(!0,t)}}},p.prototype.tx=function(e){return this.sx(e)},p.prototype.ty=function(e){return this.sy(e)},p.prototype.sx=function(e){return e*this.scaleX},p.prototype.sy=function(e){return e*this.scaleY},p.prototype.invertColor=function(e){var t=e>>16&255,r=e>>8&255,n=255&e;return(e>>24&255)<<24|(t=255-t)<<16|(r=255-r)<<8|(n=255-n)},p.prototype.mapColor=function(e,t){if(!this.hidePaper||0!==this.bgColor)return e;var r=255&e;return r<127||r===(65280&e)>>8&&r===(16711680&e)>>16&&t&&(e&=1442840575),e},p.prototype.parsePointPositions=function(){var e=this.stream.getVarints(),t=this.stream.getVarints();return e=f(e),t=f(t),e+=this.offsetX,t+=this.offsetY,this.offsetX=e,this.offsetY=t,[this.tx(e),this.ty(t)]},p.prototype.parserAssert=function(e,t,r){return e!=t&&(l.logger.warn("Expect "+t+"; actual type is "+e+"; in function "+r),this.error=!0,!0)},p.prototype.unhandledTypeWarning=function(e,t){l.logger.warn("Unhandled semantic type : "+t+" in function "+e)},p.prototype.parseObject=function(){var e=this.stream.getVarints();switch(this.objectStack.push(e),e){case h.st_sheet:this.objectNameStack.push("sheet"),this.objectMemberQueue.unshift("paperColor");break;case h.st_viewport:this.objectNameStack.push("viewport"),this.objectMemberQueue.unshift("units","transform");break;case h.st_clip:this.objectNameStack.push("clip"),this.objectMemberQueue.unshift("contourCounts","points","indices");break;case h.st_polytriangle:this.objectNameStack.push("polyTriangle"),this.objectMemberQueue.unshift("points","indices","colors");break;case h.st_raster:this.objectNameStack.push("raster"),this.objectMemberQueue.unshift("position","width","height","imageId");break;case h.st_text:this.currentStringNumber=this.strings.length,0===this.objectNumber&&(this.objectNumber=this.currentFakeId--),this.currentStringBox.makeEmpty(),this.objectNameStack.push("text"),this.objectMemberQueue.unshift("string","position","height","widthScale","rotation","oblique","charWidths");break;case h.st_font_def:this.objectNameStack.push("fontDef"),this.objectMemberQueue.unshift("name","fullName","flags","spacing","panose");break;case h.st_end_object:if(this.objectStack.pop(),this.objectStack.length){switch(this.objectStack.pop()){case h.st_polytriangle:this.actOnPolyTriangle();break;case h.st_viewport:this.actOnViewport();break;case h.st_clip:this.actOnClip();break;case h.st_raster:this.actOnRaster();break;case h.st_text:this.actOnText();break;case h.st_font_def:this.actOnFontDef()}var t=this.objectNameStack.pop(),r=this.parseObjState[t];for(var n in r)r[n]=null}else this.parserAssert(0,1,"parseEndObject (Stack Empty)");this.objectMemberQueue.length=0;break;default:this.objectNameStack.push("unknown"),this.error=!0,this.unhandledTypeWarning("parseObject",e)}},p.prototype.initSheet=function(e){if(!this.hidePaper&&(this.bgColor=e,this.metadata)){var t=this.paperWidth,r=this.paperHeight,n={x:0,y:0},i={x:t,y:0},o={x:0,y:r},a=this.metadata.page_dimensions||{};if(isFinite(a.paper_rotation)&&0!==a.paper_rotation){var s=a.paper_rotation*Math.PI/180,l=Math.cos(s),u=Math.sin(s);i.y=t*u,i.x=t*l,o.x=-r*u,o.y=r*l}isFinite(a.paper_offset_x)&&0!==a.paper_offset_x&&(n.x=a.paper_offset_x),isFinite(a.paper_offset_y)&&0!==a.paper_offset_y&&(n.y=a.paper_offset_y);var c=this.currentVbb,h=[n.x,n.y,n.x+i.x,n.y+i.y,n.x+i.x+o.x,n.y+i.y+o.y,n.x+o.x,n.y+o.y],f=[e,e,e,e],p=[0,1,2,0,2,3];if(!this.noShadow){var m=t*d,g={x:i.x*m/t,y:i.y*m/t},v={x:o.x*m/r,y:o.y*m/r},y={x:n.x+g.x,y:n.y+g.y},b={x:n.x+i.x,y:n.y+i.y},x=4283782485;h=h.concat([y.x-v.x,y.y-v.y,y.x-v.x+i.x,y.y-v.y+i.y,y.x+i.x,y.y+i.y,y.x,y.y,b.x,b.y,b.x+g.x,b.y+g.y,b.x+g.x-v.x+o.x,b.y+g.y-v.y+o.y,b.x-v.x+o.x,b.y-v.y+o.y]),f=f.concat([x,x,x,x,x,x,x,x]),p=p.concat([4,5,6,4,6,7,8,9,10,8,10,11]),this.hasPageShadow=!0}this.addPolyTriangle(h,f,p,4294967295,-1,0,!1),c.addSegment(n.x,n.y,n.x+i.x,n.y+i.y,0,1e-6,4278190080,-1,0,this.currentVpId),c.addSegment(n.x+i.x,n.y+i.y,n.x+i.x+o.x,n.y+i.y+o.y,0,1e-6,4278190080,-1,0,this.currentVpId),c.addSegment(n.x+i.x+o.x,n.y+i.y+o.y,n.x+o.x,n.y+o.y,0,1e-6,4278190080,-1,0,this.currentVpId),c.addSegment(n.x+o.x,n.y+o.y,n.x,n.y,0,1e-6,4278190080,-1,0,this.currentVpId)}},p.prototype.setObjectMember=function(e){if(!this.objectMemberQueue.length)return l.logger.warn("Unexpected object member. "+e+" on object "+this.objectNameStack[this.objectNameStack.length-1]),!1;var t=this.objectMemberQueue.shift(),r=this.objectNameStack[this.objectNameStack.length-1];return"sheet"==r&&"paperColor"==t?(this.initSheet(e),!0):!!r&&(this.parseObjState[r][t]=e,!0)},p.prototype.parseString=function(){var e=this.stream,t=e.getVarints(),r=e.getVarints(),n=e.getString(r);if(t===h.st_object_member){if(this.setObjectMember(n))return}else l.logger.info("Unexpected opcode semantic type for string.");return n},p.prototype.actOnFontDef=function(){var e=this.parseObjState.fontDef;this.fontDefs[++this.fontCount]=e,this.fontId=this.fontCount},p.prototype.parsePoint=function(){var e=this.stream.getVarints(),t=this.parsePointPositions();if(e===h.st_object_member){if(this.setObjectMember(t))return}else l.logger.info("Unexpected opcode semantic type for point.");return t},p.prototype.parsePointsArray=function(){var e=this.stream,t=e.getVarints(),r=e.getVarints();if(r){r/=2;for(var n,i=[],o=0;o<r;++o)n=this.parsePointPositions(),i.push(n[0]),i.push(n[1]);switch(t){case h.st_polyline:return void this.actOnPolylinePointsArray(i);case h.st_dot:return void this.actOnDot(i);case h.st_object_member:if(this.setObjectMember(i))return;break;default:l.logger.info("Unexpected opcode semantic type for points array.")}return i}},p.prototype.parseIntArray=function(){for(var e=this.stream,t=e.getVarints(),r=e.getVarints(),n=[],i=0;i<r;++i)n.push(e.getUint32());if(t===h.st_object_member){if(this.setObjectMember(n))return}else this.unhandledTypeWarning("parseIntArray",t);return n},p.prototype.parseDoubleArray=function(){for(var e=this.stream,t=e.getVarints(),r=e.getVarints(),n=[],i=0;i<r;++i)n.push(e.getFloat64());if(t===h.st_object_member){if(this.setObjectMember(n))return}else this.unhandledTypeWarning("parseDoubleArray",t);return n},p.prototype.parseByteArray=function(){for(var e=this.stream,t=e.getVarints(),r=e.getVarints(),n=[],i=0;i<r;++i)n.push(e.getUint8());if(t===h.st_object_member){if(this.setObjectMember(n))return}else this.unhandledTypeWarning("parseByteArray",t);return n},p.prototype.parseVarintArray=function(){for(var e=this.stream,t=e.getVarints(),r=[],n=e.getVarints(),i=0;i<n;++i)r.push(e.getVarints());if(t===h.st_object_member){if(this.setObjectMember(r))return}else this.unhandledTypeWarning("parseVarIntArray",t);return r},p.prototype.parseInt=function(){var e=this.stream,t=e.getVarints(),r=e.getUint32();switch(t){case h.st_color:this.color=this.mapColor(r,!1),this.currentGeomMetrics.colors++;break;case h.st_fill:this.fill=!0,this.fillColor=this.mapColor(r,!0),this.currentGeomMetrics.fills++;break;case h.st_object_member:if(this.setObjectMember(r))return;default:this.unhandledTypeWarning("parseInt",t)}return r},p.prototype.parseVoid=function(){var e=this.stream.getVarints();if(e===h.st_fill_off)this.fill=!1,this.currentGeomMetrics.fills++;else this.unhandledTypeWarning("parseVoid",e)},p.prototype.parseVarint=function(){var e=this.stream,t=e.getVarints(),r=e.getVarints();switch(t){case h.st_line_weight:this.lineWeight=this.tx(r),this.currentGeomMetrics.line_weights++;break;case h.st_line_caps:this.currentGeomMetrics.line_caps++;break;case h.st_line_join:this.currentGeomMetrics.line_joins++;break;case h.st_object_id:case h.st_markup_id:this.objectNumber=r,this.maxObjectNumber=Math.max(this.maxObjectNumber,r),this.currentGeomMetrics.db_ids++;break;case h.st_link:this.linkNumber&&(this.linkBoxes[this.linkNumber]=this.currentLinkBox.clone(),this.currentLinkBox.makeEmpty()),this.linkNumber=r;break;case h.st_layer:this.currentGeomMetrics.layers++,this.layer=this.layersMap[r];break;case h.st_font_ref:this.fontId=r;break;case h.st_object_member:if(this.setObjectMember(r))return}return r},p.prototype.parseFloat=function(){var e=this.stream,t=e.getVarints(),r=e.getFloat32();switch(t){case h.st_miter_angle:case h.st_miter_length:break;case h.st_object_member:if(this.setObjectMember(r))return}return r},p.prototype.parseCircularArc=function(){var e=this.stream,t=e.getVarints();if(!this.parserAssert(t,h.st_arc,"parseCircularArc")){var r=this.parsePointPositions(),n=e.getVarints(),i=e.getFloat32(),o=e.getFloat32();this.actOnCircularArc(r[0],r[1],i,o,this.sx(n))}},p.prototype.parseCircle=function(){var e=this.stream,t=e.getVarints();if(!this.parserAssert(t,h.st_arc,"parseCircle")){var r=this.parsePointPositions(),n=e.getVarints();this.actOnCompleteCircle(r[0],r[1],this.sx(n))}},p.prototype.parseArc=function(){var e=this.stream,t=e.getVarints();if(!this.parserAssert(t,h.st_arc,"parseArc")){var r=this.parsePointPositions(),n=e.getVarints(),i=e.getVarints(),o=e.getFloat32(),a=e.getFloat32(),s=e.getFloat32();this.actOnArc(r[0],r[1],a,s,this.sx(n),this.sy(i),o)}},p.prototype.parseDataType=function(){var e=this.stream.getVarints();switch(e){case c.dt_void:this.parseVoid();break;case c.dt_int:this.parseInt();break;case c.dt_object:this.parseObject();break;case c.dt_varint:this.parseVarint();break;case c.dt_point_varint:this.parsePoint();break;case c.dt_float:this.parseFloat();break;case c.dt_point_varint_array:this.parsePointsArray();break;case c.dt_circular_arc:this.parseCircularArc();break;case c.dt_circle:this.parseCircle();break;case c.dt_arc:this.parseArc();break;case c.dt_int_array:this.parseIntArray();break;case c.dt_varint_array:this.parseVarintArray();break;case c.dt_byte_array:this.parseByteArray();break;case c.dt_string:this.parseString();break;case c.dt_double_array:this.parseDoubleArray();break;default:this.error=!0,l.logger.info("Data type not supported yet: "+e)}},p.prototype.readHeader=function(){var e=this.stream=new s.A(this.data),t=e.getString(3);if("F2D"!==t)return l.logger.error("Invalid F2D header : "+t,(0,u.errorCodeString)(u.ErrorCodes.BAD_DATA)),!1;var r=e.getString(2);if("01"!==r)return l.logger.error("Only support f2d major version 1; actual version is : "+r,(0,u.errorCodeString)(u.ErrorCodes.BAD_DATA)),!1;if("."!==e.getString(1))return l.logger.error("Invalid version delimiter.",(0,u.errorCodeString)(u.ErrorCodes.BAD_DATA)),!1;e.getString(2);return!0},p.prototype.parse=function(){if(this.readHeader()){for(var e=this.stream;e.offset<e.byteLength&&(this.parseDataType(),!this.error);)this.opCount++;this.linkNumber&&(this.linkBoxes[this.linkNumber]=this.currentLinkBox.clone(),this.currentLinkBox.makeEmpty()),this.flushBuffer(0,!0),this.currentVbb=null,this.stream=null,this.data=null,l.logger.info("F2d parse: data types count : "+this.opCount)}},p.prototype.parseFrames=function(e){if(this.data)for(var t=this.stream=new s.A(this.data);t.offset<t.byteLength&&(this.parseDataType(),!this.error);)this.opCount++;else e||l.logger.warn("Unexpected F2D parse state: If there is no data, we only expect a flush command, but flush was false.");e&&this.flushBuffer(0,!0),this.stream=null,this.data=null},p.prototype.actOnPolylinePointsArray=function(e){this.flushBuffer();for(var t=e.length/2,r=0,n=e[0],i=e[1],o=1;o<t;++o){var a=e[2*o],s=e[2*o+1];this.currentVbb.addSegment(n,i,a,s,r,this.lineWeight,this.color,this.objectNumber,this.layer,this.currentVpId),r+=Math.sqrt((a-n)*(a-n)+(s-i)*(s-i)),n=a,i=s}this.numPolylines++,this.numLineSegs+=t-1,this.currentGeomMetrics.plines++,this.currentGeomMetrics.pline_points+=t-1},p.prototype.actOnDot=function(e){this.currentGeomMetrics.dots++;var t=e[0],r=e[1];this.actOnCompleteCircle(t,r,this.sx(1),!0)},p.prototype.actOnCompleteCircle=function(e,t,r,n){this.flushBuffer(),this.numCircles++,n||this.currentGeomMetrics.circles++,this.fill?this.currentVbb.addSegment(e,t,e,t,0,2*r,this.color,this.objectNumber,this.layer,this.currentVpId,!0,!1,!0):this.currentVbb.addArc(e,t,0,2*Math.PI,r,r,0,this.lineWeight,this.color,this.objectNumber,this.layer,this.currentVpId)},p.prototype.actOnCircularArc=function(e,t,r,n,i){this.numCircles++,this.currentGeomMetrics.circ_arcs++,this.flushBuffer(),this.currentVbb.addArc(e,t,r,n,i,i,0,this.lineWeight,this.color,this.objectNumber,this.layer,this.currentVpId)},p.prototype.actOnArc=function(e,t,r,n,i,o,a){this.numEllipses++,this.currentGeomMetrics.arcs++,this.flushBuffer(),this.currentVbb.addArc(e,t,r,n,i,o,a,this.lineWeight,this.color,this.objectNumber,this.layer,this.currentVpId)},p.prototype.actOnRaster=function(){if(this.manifestAvailable){this.flushBuffer(4,!0);var e=this.parseObjState.raster,t=e.position,r=e.imageId,n=this.imageId2URI[r],i=this.sx(e.width),o=this.sy(e.height),a=t[0]+.5*i,s=t[1]-.5*o;this.currentVbb.addTexturedQuad(a,s,i,o,0,4278255615,this.objectNumber,this.layer,this.currentVpId),this.currentImage={dataURI:n},this.flushBuffer(0,!0),this.currentGeomMetrics.rasters++}},p.prototype.actOnClip=function(){var e=this.parseObjState.clip;this.parseObjState.clip={},this.clips.push(e),this.currentGeomMetrics.clips++},p.prototype.actOnText=function(){this.strings[this.currentStringNumber]=this.parseObjState.text.string,this.currentGeomMetrics.texts++,this.currentGeomMetrics.strings.push(this.parseObjState.text.string),this.stringDbIds[this.currentStringNumber]=this.objectNumber,this.stringBoxes.push(this.currentStringBox.min.x,this.currentStringBox.min.y,this.currentStringBox.max.x,this.currentStringBox.max.y),this.extendStringsFetching&&(this.stringCharWidths.push(this.parseObjState.text.charWidths),this.stringAngles.push(this.parseObjState.text.rotation),this.stringPositions.push(this.parseObjState.text.position),this.stringHeights.push(this.parseObjState.text.height)),this.currentStringBox.makeEmpty(),this.currentStringNumber=-1,this.objectNumber<-1&&(this.objectNumber=0)};var m=new o.LmvVector3;p.prototype.addPolyTriangle=function(e,t,r,n,i,o,a){var s=this,u=null,c=-1;function d(e,t){if(e>t){var r=e;e=t,t=r}if(u[e]){var n=u[e],i=n.lastIndexOf(t);-1==i?n.push(t):n[i]=-1}else u[e]=[t]}function f(r,a){if(r>a){var h=r;r=a,a=h}var d=u[r];d&&(-1!=d.indexOf(a)&&(s.flushBuffer(4),s.currentVbb.addSegment(e[2*r],e[2*r+1],e[2*a],e[2*a+1],0,c,s.mapColor(t?t[r]:n,!0),i,o,s.currentVpId),t&&t[r]!=t[a]&&l.logger.warn("Gouraud triangle encountered. Will have incorrect antialiasing.")))}if(this.objectStack[this.objectStack.length-1]==h.st_text&&(c=-.5),a){u=new Array(e.length/2);for(var p=0,g=r.length;p<g;p+=3){var v=r[p],y=r[p+1],b=r[p+2];d(v,y),d(y,b),d(b,v)}}if(-1!==this.currentStringNumber||this.linkNumber){var x=e.length/2;for(p=0;p<x;++p)m.set(e[2*p],e[2*p+1],0),-1!==this.currentStringNumber&&this.currentStringBox.expandByPoint(m),this.linkNumber&&this.currentLinkBox.expandByPoint(m)}if(this.currentVbb.useInstancing)for(x=r.length,p=0;p<x;p+=3){v=r[p],y=r[p+1],b=r[p+2];this.flushBuffer(4),this.currentVbb.addTriangleGeom(e[2*v],e[2*v+1],e[2*y],e[2*y+1],e[2*b],e[2*b+1],this.mapColor(t?t[v]:n,!0),i,o,this.currentVpId),a&&(f(v,y),f(y,b),f(b,v))}else{x=e.length/2;this.flushBuffer(x);var _=this.currentVbb,E=_.vcount;for(p=0;p<x;++p){var w=e[2*p],A=e[2*p+1];_.addVertexPolytriangle(w,A,this.mapColor(t?t[p]:n,!0),i,o,this.currentVpId)}_.addIndices(r,E),a&&function(){for(var r=0,a=u.length;r<a;r++){var h=u[r];if(h)for(var d=0;d<h.length;d++){var f=h[d];-1!=f&&(s.flushBuffer(4),s.currentVbb.addSegment(e[2*r],e[2*r+1],e[2*f],e[2*f+1],0,c,s.mapColor(t?t[r]:n,!0),i,o,s.currentVpId),t&&t[r]!=t[f]&&l.logger.warn("Gouraud triangle encountered. Will have incorrect antialiasing."))}}}()}},p.prototype.actOnPolyTriangle=function(){var e=this.parseObjState.polyTriangle;this.parseObjState.polyTriangle={};var t=e.points,r=e.indices,n=e.colors;if(t&&r){if(this.objectStack[this.objectStack.length-1]==h.st_text){if(this.excludeTextGeometry)return}else this.currentGeomMetrics.ptris++,this.currentGeomMetrics.ptri_points+=t.length/2,this.currentGeomMetrics.ptri_indices+=r.length;this.numPolytriangles++,this.numTriangles+=r.length/3,this.addPolyTriangle(t,n,r,this.color,this.objectNumber,this.layer,!0)}else l.logger.warn("Malformed polytriangle.")},p.prototype.actOnViewport=function(){var e=this.parseObjState.viewport;this.parseObjState.viewport={},e.geom_metrics=this.currentGeomMetrics={arcs:0,circles:0,circ_arcs:0,viewports:0,clips:0,colors:0,db_ids:0,dots:0,fills:0,layers:0,line_caps:0,line_joins:0,line_patterns:0,line_pat_refs:0,plines:0,pline_points:0,line_weights:0,links:0,miters:0,ptris:0,ptri_indices:0,ptri_points:0,rasters:0,texts:0,strings:[]},this.viewports.push(e),this.currentVpId=this.viewports.length-1},p.prototype.createLayerGroups=function(e){var t=this.layersRoot={name:"root",id:"root",childrenByName:{},isLayer:!1},r=0,n=0;for(var i in e){var o=parseInt(i),a=e[i],s="string"==typeof a?a:a.name;s||(s=i);var l=s.split("|"),u=t;if(l.length>1)for(var c=0;c<l.length-1;++c){var h=l[c],d=u.childrenByName[h];d||(d={name:h,id:"group-"+r++,childrenByName:{},isLayer:!1},u.childrenByName[h]=d),u=d}u.childrenByName[s]={name:s,index:o,id:n++,childrenByName:{},isLayer:!0}}!function e(t){var r=Object.keys(t.childrenByName).map((function(e){return t.childrenByName[e]}));if(delete t.childrenByName,r.length){t.children=r,t.childCount=0;for(var n=0;n<r.length;++n)t.childCount+=e(r[n]);r.sort((function(e,t){return e.isLayer&&!t.isLayer?-1:!e.isLayer&&t.isLayer?1:e.name.localeCompare(t.name,void 0,{sensitivity:"base",numeric:!0})}))}return t.isLayer?1:t.childCount}(this.layersRoot)}},4100:e=>{for(var t=new Array(256),r=0;r<256;r++){var n=r.toString(16);1===n.length&&(n="0"+n),t[r]=n}var i=new Array(20);var o=new Array(10);function a(e){return e>=48&&e<=57?e-48:e>=65&&e<=70?e-55:e>=97&&e<=102?e-87:0}e.exports={getHexStringPacked:function(e,t,r){for(var n=20===r?o:[],i=0;i<r;i+=2){var a=e[t+i],s=e[t+i+1];n[i/2]=s<<8|a}return String.fromCharCode.apply(null,n)},unpackHexString:function(e){for(var r=10===e.length?i:[],n=0;n<e.length;n++){var o=e.charCodeAt(n);r[2*n]=t[255&o],r[2*n+1]=t[o>>8&255]}return r.join("")},hexToBin:function(e,r,i){if(10!==e.length)for(var o=i,s=0;s<n.length;s+=2){var l=a(n.charCodeAt(s)),u=a(n.charCodeAt(s+1));r[o++]=l<<4|u}else!function(e,r,n){for(var i=n,o=0;o<e.length;o++){var s=e.charCodeAt(o),l=t[255&s],u=t[s>>8&255],c=a(l.charCodeAt(0)),h=a(l.charCodeAt(1));r[i++]=c<<4|h,c=a(u.charCodeAt(0)),h=a(u.charCodeAt(1)),r[i++]=c<<4|h}}(e,r,i)}}},86620:(e,t,r)=>{"use strict";r.r(t),r.d(t,{serializeLmvBufferGeom:()=>N,readLmvBufferGeom:()=>V});var n=r(84998),i=r(28400),o=r(22585),a=0,s=1,l=2,u=3,c=4,h=5,d=0,f=1,p=2,m=3,g=4,v=5,y=6,b=7,x=8,_=9,E=10,w=1,A=2,S=3,M={position:l,normal:u,index:a,indexlines:s,color:h},T={};T[l]="position",T[u]="normal",T[a]="index",T[s]="indexlines",T[h]="color",T[c]="uv";var C={};function P(e){for(var t=[],r=0;r<e.length;r+=2)t.push([e[r],e[r+1]]);for(r=0;r<t.length;r++){if((i=t[r])[0]>i[1]){var n=i[0];i[0]=i[1],i[1]=n}}t.sort((function(e,t){return e[0]-t[0]}));var i=t[0],o=0;e[o]=i[0],e[o+1]=i[1]-i[0],o+=2;for(r=1;r<t.length;r++,o+=2)i=t[r],e[o]=i[0]-t[r-1][0],e[o+1]=i[1]-i[0]}function D(e){if(e.length){e[1]+=e[0],e[2]+=e[0];for(var t=3;t<e.length;t+=3)e[t]+=e[t-3],e[t+1]+=e[t],e[t+2]+=e[t]}}function L(e){if(e.length){e[1]+=e[0];for(var t=2;t<e.length;t+=2)e[t]+=e[t-2],e[t+1]+=e[t]}}function R(e){var t=T[e];return t||(console.error("Unknown vertex attribute"),c)}function I(){}function O(e){this.buffer=e,this.readOffset=0,this.meshFlag=0,this.numBuffers=0,this.numAttributes=0,this.bufferOffsets=[],this.attributes=[],this.buffers=[]}function N(e){var t=new I,r=[];if(!e.vb)return console.error("Unexpected non-interleaved vertex buffer"),null;r=[e.vb.byteLength,e.ib.byteLength],e.iblines&&r.push(e.iblines.byteLength);var n,i,o=Object.keys(e.attributes),a=0;e.isLines&&(a|=w),e.isWideLines&&(a|=S),e.isPoints&&(a|=A),t.beginHeader(a,o.length,r);for(var s=0;s<o.length;s++){var l=e.attributes[o[s]],u=(n=o[s],i=void 0,void 0!==(i=M[n])?i:(0===n.indexOf("uv")||console.warn("Unknown attribute name"),c));"index"===o[s]?t.addAttribute(u,l,0,1):"indexlines"===o[s]?t.addAttribute(u,l,0,2):t.addAttribute(u,l,e.vbstride,0)}t.endHeader();var h=Buffer.from(e.vb.buffer,e.vb.byteOffset,e.vb.byteLength);return t.addBuffer(h),e.isLines?P(e.ib):function(e){for(var t,r,n=[],i=0;i<e.length;i+=3)n.push([e[i],e[i+1],e[i+2]]);for(i=0;i<n.length;i++)for(var o=n[i];o[0]>o[1]||o[0]>o[2];)r=void 0,r=(t=o)[0],t[0]=t[1],t[1]=t[2],t[2]=r;n.sort((function(e,t){return e[0]-t[0]})),o=n[0];var a=0;for(e[a]=o[0],e[a+1]=o[1]-o[0],e[a+2]=o[2]-o[0],a+=3,i=1;i<n.length;i++,a+=3)o=n[i],e[a]=o[0]-n[i-1][0],e[a+1]=o[1]-o[0],e[a+2]=o[2]-o[0]}(e.ib),h=Buffer.from(e.ib.buffer,e.ib.byteOffset,e.ib.byteLength),t.addBuffer(h),e.iblines&&(P(e.iblines),h=Buffer.from(e.iblines.buffer,e.iblines.byteOffset,e.iblines.byteLength),t.addBuffer(h)),t.end()}C[d]=1,C[f]=2,C[p]=1,C[m]=2,C[g]=1,C[v]=2,C[y]=1,C[b]=2,C[x]=4,C[_]=4,C[E]=4,I.prototype.beginHeader=function(e,t,r){var n=8,i=r.length;for(n+=4*(i-1),n+=5*t;n%4!=0;)n++;for(var o=0,a=0;a<r.length;a++)o+=r[a];this.buffer=Buffer.alloc(n+o),this.writeOffset=0;for(a=0;a<4;a++)this.writeOffset=this.buffer.writeUInt8("OTG0".charCodeAt(a),this.writeOffset);this.writeOffset=this.buffer.writeUInt16LE(e,this.writeOffset),this.writeOffset=this.buffer.writeUInt8(i,this.writeOffset),this.writeOffset=this.buffer.writeUInt8(t,this.writeOffset);var s=r[0];for(a=1;a<r.length;a++)this.writeOffset=this.buffer.writeUInt32LE(s,this.writeOffset),s+=r[a]},I.prototype.addAttribute=function(e,t,r,n){this.writeOffset=this.buffer.writeUInt8(e,this.writeOffset),e===a||e===s?(this.writeOffset=this.buffer.writeUInt8(function(e){var t=m,r=e.bytesPerItem||2;return 1===r?t=p:2===r?t=m:4===r&&(t=E),t<<4|15&e.itemSize}(t),this.writeOffset),this.writeOffset=this.buffer.writeUInt8(4*(t.itemOffset||0),this.writeOffset),this.writeOffset=this.buffer.writeUInt8(4*(r||0),this.writeOffset),this.writeOffset=this.buffer.writeUInt8(n,this.writeOffset)):(this.writeOffset=this.buffer.writeUInt8(function(e){var t=x,r=e.bytesPerItem||4;return 1===r?t=e.normalized?y:p:2===r&&(t=e.normalized?b:m),t<<4|15&e.itemSize}(t),this.writeOffset),this.writeOffset=this.buffer.writeUInt8(4*(t.itemOffset||0),this.writeOffset),this.writeOffset=this.buffer.writeUInt8(4*(r||0),this.writeOffset),this.writeOffset=this.buffer.writeUInt8(n,this.writeOffset))},I.prototype.endHeader=function(){for(;this.writeOffset%4!=0;)this.writeOffset=this.buffer.writeUInt8(0,this.writeOffset)},I.prototype.addBuffer=function(e){e.copy(this.buffer,this.writeOffset),this.writeOffset+=e.length},I.prototype.end=function(){return this.writeOffset!==this.buffer.length&&console.error("Incorrect encoding buffer size"),this.buffer},O.prototype.readNodeJS=function(){if("OTG0"!==this.buffer.toString("ascii",0,4))return console.error("Invalid OTG header"),!1;if(this.readOffset=4,this.meshFlag=this.buffer.readUInt16LE(this.readOffset),this.readOffset+=2,this.numBuffers=this.buffer.readUInt8(this.readOffset),this.readOffset++,this.numAttributes=this.buffer.readUInt8(this.readOffset),this.readOffset++,this.numBuffers){this.bufferOffsets.push(0);for(var e=1;e<this.numBuffers;e++){var t=this.buffer.readUInt32LE(this.readOffset);this.readOffset+=4,this.bufferOffsets.push(t)}}for(e=0;e<this.numAttributes;e++){var r={};r.name=this.buffer.readUInt8(this.readOffset),this.readOffset++;var n=this.buffer.readUInt8(this.readOffset);this.readOffset++,r.itemSize=15&n,r.type=n>>4,r.bytesPerItem=C[r.type],r.normalized=r.type===g||r.type===v||r.type===y||r.type===b,r.itemOffset=this.buffer.readUInt8(this.readOffset)/4,this.readOffset++,r.itemStride=this.buffer.readUInt8(this.readOffset)/4,this.readOffset++,r.bufferIndex=this.buffer.readUInt8(this.readOffset),this.readOffset++,this.attributes.push(r)}for(;this.readOffset%4!=0;)this.readOffset++;for(e=0;e<this.bufferOffsets.length;e++){var i,o=this.readOffset+this.bufferOffsets[e];i=e<this.bufferOffsets.length-1?this.readOffset+this.bufferOffsets[e+1]:this.buffer.length,this.buffers.push(this.buffer.slice(o,i))}return!0},O.prototype.readWeb=function(){var e=new i.A(this.buffer);if("OTG0"!==e.getString(4))return console.error("Invalid OTG header"),!1;if(this.meshFlag=e.getUint16(),this.numBuffers=e.getUint8(),this.numAttributes=e.getUint8(),this.numBuffers){this.bufferOffsets.push(0);for(var t=1;t<this.numBuffers;t++){var r=e.getUint32();this.bufferOffsets.push(r)}}for(t=0;t<this.numAttributes;t++){var n={};n.name=e.getUint8();var o=e.getUint8();n.itemSize=15&o,n.type=o>>4,n.bytesPerItem=C[n.type],n.normalized=n.type===g||n.type===v||n.type===y||n.type===b,n.itemOffset=e.getUint8()/4,n.itemStride=e.getUint8()/4,n.bufferIndex=e.getUint8(),this.attributes.push(n)}for(;e.offset%4!=0;)e.offset++;for(t=0;t<this.bufferOffsets.length;t++){var a,s=e.offset+this.bufferOffsets[t];a=t<this.bufferOffsets.length-1?e.offset+this.bufferOffsets[t+1]:e.byteLength,this.buffers.push(this.buffer.subarray(s,a))}return!0},O.prototype.read=function(){return(0,n.isNodeJS)()&&this.buffer instanceof Buffer?this.readNodeJS():this.readWeb()};var k=new o.LmvBox3;k.min.x=-.5,k.min.y=-.5,k.min.z=-.5,k.max.x=.5,k.max.y=.5,k.max.z=.5;var F={center:{x:0,y:0,z:0},radius:Math.sqrt(.75)};function V(e,t){var r=new O(e);if(!r.read())return console.error("Failed to parse OTG geometry"),null;for(var n={vblayout:{},vb:new Float32Array(r.buffers[0].buffer,r.buffers[0].byteOffset,r.buffers[0].byteLength/4),isLines:(3&r.meshFlag)===w,isWideLines:(3&r.meshFlag)===S,isPoints:(3&r.meshFlag)===A,boundingBox:k,boundingSphere:F},i=0;i<r.attributes.length;i++){var o=r.attributes[i];if(o.name===a){var l=r.buffers[1];1===o.bytesPerItem?n.indices=l:2===o.bytesPerItem?n.indices=new Uint16Array(l.buffer,l.byteOffset,l.byteLength/o.bytesPerItem):4===o.bytesPerItem&&(n.indices=new Uint32Array(l.buffer,l.byteOffset,l.byteLength/o.bytesPerItem)),n.isLines?L(n.indices):D(n.indices)}else if(o.name===s){if(!t){var u=r.buffers[2];1===o.bytesPerItem?n.iblines=u:2===o.bytesPerItem?n.iblines=new Uint16Array(u.buffer,u.byteOffset,u.byteLength/o.bytesPerItem):4===o.bytesPerItem&&(n.iblines=new Uint32Array(u.buffer,u.byteOffset,u.byteLength/o.bytesPerItem)),L(n.iblines)}}else{var c=R(o.name);n.vbstride?n.vbstride!==o.itemStride&&console.error("Unexpected vertex buffer stride mismatch."):n.vbstride=o.itemStride,o.itemOffset>=o.itemStride||(n.vblayout[c]={bytesPerItem:o.bytesPerItem,offset:o.itemOffset,normalized:o.normalized,itemSize:o.itemSize})}}return{mesh:n,packId:0,meshIndex:0}}},439:(e,t,r)=>{"use strict";function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}r.r(t),r.d(t,{Empty2DModelLoader:()=>i});var i=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.viewer3DImpl=t}var t,r,i;return t=e,r=[{key:"loadFile",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0,i=t.width||100,o=t.height||100;n&&n(),this.svf={is2d:!0,viewports:[],layersMap:{0:0},layerCount:1,bbox:new THREE.Box3(new THREE.Vector3(0,0,0),new THREE.Vector3(i,o,0)),fragments:{length:1,fragId2dbId:[0],dbId2fragId:{},transforms:new Float32Array(12),boxes:[0,0,0,i,o,0]},loadOptions:{bubbleNode:new Autodesk.Viewing.BubbleNode({urn:"Dummy_urn",guid:"Dummy_guid"})},metadata:{page_dimensions:{page_width:i,page_height:o,logical_width:i,logical_height:o,logical_offset_x:0,logical_offset_y:0,page_units:"inch"}},strings:[],stringDbIds:[],loadDone:!0};var a=new Autodesk.Viewing.Model(this.svf);a.initialize(),a.loader=this,this.model=a,r(null,a),this.viewer3DImpl.api.dispatchEvent({type:Autodesk.Viewing.MODEL_ROOT_LOADED_EVENT,svf:this.svf,model:a}),this.viewer3DImpl.onLoadComplete(a)}},{key:"dtor",value:function(){}},{key:"is2d",value:function(){return!0}},{key:"is3d",value:function(){return!1}}],r&&n(t.prototype,r),i&&n(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}()},7440:(e,t,r)=>{"use strict";r.r(t),r.d(t,{OUTPUT_TYPE:()=>y,F2DLoader:()=>b});var n=r(98926),i=r(25131),o=r(79659),a=r(18588),s=r(50411),l=r(57601),u=r(58092),c=r(8283),h=r(84998),d=r(37169),f=r(50005),p=r(58964),m=r(83161),g=r(23909),v=Autodesk.Viewing.Private,y={GEOMETRY:"geometry",VERTEX_BUFFER:"vertexBuffer"};function b(e){this.viewer3DImpl=e,this.loading=!1,this.tmpMatrix=new g.Matrix4,this.logger=n.logger,this.loadTime=0}b.prototype.dtor=function(){this.initWorkerScriptToken&&(this.initWorkerScriptToken.cancel(),this.initWorkerScriptToken=null,n.logger.debug("F2D loader dtor: on init worker script.")),this.streamingWorker&&(this.streamingWorker.terminate(),this.streamingWorker=null,n.logger.debug("F2D loader dtor: on streaming worker.")),this.parsingWorker&&(this.parsingWorker.terminate(),this.parsingWorker=null,n.logger.debug("F2D loader dtor: on parsing worker.")),this.svf&&this.svf.propDbLoader&&(this.svf.propDbLoader.dtor(),this.svf.propDbLoader=null),this.viewer3DImpl=null,this.loading=!1,this.tmpMatrix=null,this.logger=null,this.loadTime=0,this.svf=null,this.model=null,this.options=null},b.prototype.isValid=function(){return!!this.viewer3DImpl},b.prototype.loadFile=function(e,t,r,i){if(!this.viewer3DImpl)return n.logger.log("F2D loader was already destructed. So no longer usable."),!1;if(this.loading)return n.logger.log("Loading of F2D already in progress. Ignoring new request."),!1;this.loading=!0;var o=e.indexOf("urn:");if(-1!=o){var a=(e=decodeURIComponent(e)).substr(o,e.substr(o).indexOf("/"));n.logger.log("Extracted URN: "+a);var s=a.lastIndexOf(":");this.svfUrn=a.substr(s+1)}else this.svfUrn=e;this.sharedDbPath=t.sharedPropertyDbPath,this.currentLoadPath=e,this.acmSessionId=t.acmSessionId,this.queryParams="",this.acmSessionId&&(this.queryParams="acmsession="+this.acmSessionId),this.options=t,this.options.placementTransform?this.modelScale=this.options.modelScale||this.options.placementTransform.getMaxScaleOnAxis():this.modelScale=this.options.modelScale||1,this.isf2d=!0;var l=this;return this.initWorkerScriptToken=(0,u.initWorkerScript)((function(){l.loadFydoCB(e,t,r,i)})),!0},b.prototype.loadFydoCB=function(e,t,r,i){this.t0=Date.now();var s=(0,l.pathToURL)(e);this.streamingWorker=(0,u.createWorker)(!0),this.parsingWorker=(0,u.createWorker)();var c,f,m=this,v=!0,b=this.viewer3DImpl.glrenderer();b&&(c=b.supportsInstancedArrays(),f=b.capabilities.isWebGL2);var x=function(){m.parsingWorker.terminate(),m.parsingWorker=null};this.streamingWorker.addEventListener("message",(function(e){var l;m.isValid()&&(v&&i&&(v=!1,i()),e.data&&"F2DBLOB"==e.data.type?(l={operation:"PARSE_F2D",data:e.data.buffer,metadata:e.data.metadata,manifest:e.data.manifest,basePath:e.data.basePath,f2dLoadOptions:{modelSpace:t.modelSpace,bgColor:t.bgColor,noShadow:t.noShadow,isMobile:(0,h.isMobileDevice)(),supportsInstancing:c,isWebGL2:f,excludeTextGeometry:t.excludeTextGeometry,outputType:t.outputType||y.VERTEX_BUFFER,extendStringsFetching:t.extendStringsFetching},url:s},m.parsingWorker.doOperation(l,[l.data]),m.streamingWorker.terminate(),m.streamingWorker=null):e.data&&"F2DSTREAM"==e.data.type?(l={operation:"PARSE_F2D_FRAME",data:e.data.frames,url:s,f2dLoadOptions:{modelSpace:t.modelSpace,bgColor:t.bgColor,noShadow:t.noShadow,isMobile:(0,h.isMobileDevice)(),supportsInstancing:c,isWebGL2:f,excludeTextGeometry:t.excludeTextGeometry,outputType:t.outputType||y.VERTEX_BUFFER,extendStringsFetching:t.extendStringsFetching}},e.data.metadata&&(l.metadata=e.data.metadata,l.manifest=e.data.manifest),e.data.finalFrame&&(l.finalFrame=!0,m.streamingWorker.terminate(),m.streamingWorker=null,m.fileMemorySize/=2),e.data.progress&&m.viewer3DImpl.signalProgress(100*e.data.progress,a.ProgressState.LOADING),m.parsingWorker.doOperation(l,l.data?[l.data]:void 0)):e.data&&"F2DAssetURL"==e.data.type||e.data&&e.data.assetRequest||e.data&&e.data.progress||(e.data&&e.data.debug?n.logger.debug(e.data.message):e.data&&e.data.error?(m.loading=!1,m.streamingWorker.terminate(),m.streamingWorker=null,r&&r(e.data.error)):(n.logger.error("F2D download failed.",(0,o.errorCodeString)(o.ErrorCodes.NETWORK_FAILURE)),m.loading=!1,m.streamingWorker.terminate(),m.streamingWorker=null)))}),!1);var _=t.outputType===y.GEOMETRY?function(e){if(m.isValid()&&(v&&i&&(v=!1,i()),e.data&&e.data.f2d)){m.svf=e.data.f2d;var t=e.data.f2d.geometry;x(),n.logger.info("Num polylines: "+t.numPolylines),n.logger.info("Line segments: "+t.numLineSegs),n.logger.info("Circular arcs: "+t.numCircles),n.logger.info("Ellipitcal arcs:"+t.numEllipses),m.onModelRootLoadDone(m.svf),r&&r(null,m.model),m.viewer3DImpl.api.dispatchEvent({type:d.MODEL_ROOT_LOADED_EVENT,svf:m.svf,model:m.model}),m.onGeomLoadDone()}}:function(e){var t,a;if(m.isValid())if(v&&i&&(v=!1,i()),e.data&&e.data.f2d){for(t=m.svf=e.data.f2d,x(),n.logger.info("Num polylines: "+t.numPolylines),n.logger.info("Line segments: "+t.numLineSegs),n.logger.info("Circular arcs: "+t.numCircles),n.logger.info("Ellipitcal arcs:"+t.numEllipses),n.logger.info("Plain triangles:"+t.numTriangles),n.logger.info("Total # of op codes generated by fydo.parse: "+t.opCount),m.onModelRootLoadDone(m.svf),r&&r(null,m.model),m.viewer3DImpl.api.dispatchEvent({type:d.MODEL_ROOT_LOADED_EVENT,svf:m.svf,model:m.model}),a=0;a<t.meshes.length;a++)m.processReceivedMesh2D(t.meshes[a],a);t.meshes=null,m.onGeomLoadDone(),m.loading=!1}else if(e.data&&e.data.f2dframe){var s=0;if(e.data.meshes){var l=e.data.bbox;m.svf.bbox=(new g.Box3).copy(l),m.svf.modelSpaceBBox=m.svf.bbox.clone(),m.svf.placementTransform&&m.svf.bbox.applyMatrix4(m.svf.placementTransform),s=e.data.baseIndex}else m.svf=e.data.f2dframe,s=e.data.baseIndex;if((t=m.svf).fragments&&t.fragments.initialized||(m.onModelRootLoadDone(t),r&&r(null,m.model),m.viewer3DImpl.api.dispatchEvent({type:d.MODEL_ROOT_LOADED_EVENT,svf:t,model:m.model})),e.data.meshes&&e.data.meshes.length)for(a=0;a<e.data.meshes.length;a++)m.processReceivedMesh2D(e.data.meshes[a],s+a);if(e.data.finalFrame){var u=e.data.cumulativeProps;for(var c in u)t[c]=u[c];x(),m.onGeomLoadDone(),m.loading=!1}}else e.data&&e.data.progress||(e.data&&e.data.debug?n.logger.debug(e.data.message):e.data&&e.data.error?(m.loading=!1,x(),n.logger.error("Error while processing F2d: "+JSON.stringify(e.data.error.args)),r&&r(e.data.error)):(n.logger.error("F2D download failed.",(0,o.errorCodeString)(o.ErrorCodes.NETWORK_FAILURE)),m.loading=!1,x()))};this.parsingWorker.addEventListener("message",_,!1);var E={operation:"STREAM_F2D",url:s,objectIds:t.ids,queryParams:this.queryParams};return this.streamingWorker.doOperation(p.endpoint.initLoadContext(E)),!0},b.prototype.processReceivedMesh=function(e){var t=e.packId+":"+e.meshIndex,r=this.svf,o=r.fragments,a=o.mesh2frag[t];if(void 0!==a){Array.isArray(a)||(a=[a]);var s=e.mesh;if(s.dbIds[-1]&&this.options.hideBackground&&this.model.changePaperVisibility(!1),i.BufferGeometryUtils.meshToGeometry(e),e.geometry.unpackXform=s.unpackXform,s.texData){var l=new g.DataTexture(new Uint8Array(s.texData.buffer),s.texData.length,1,g.RGBAFormat,g.UnsignedByteType,g.UVMapping,g.ClampToEdgeWrapping,g.ClampToEdgeWrapping,g.NearestFilter,g.NearestFilter,0);l.generateMipmaps=!1,l.flipY=!1,l.needsUpdate=!0,e.geometry.tIdColor=l,e.geometry.vIdColorTexSize=new g.Vector2(s.texData.length,1)}var u=a.length,c=this.model;c.getGeometryList().addGeometry(e.geometry,u,e.meshIndex+1);for(var h=(e.geometry.index.array||e.geometry.ib).length/3,d=0;d<a.length;d++){var f=0|a[d];c.getFragmentList().getOriginalWorldMatrix(f,this.tmpMatrix),this.options.placementTransform&&(this.tmpMatrix=(new g.Matrix4).multiplyMatrices(this.options.placementTransform,this.tmpMatrix));var p=o.materials[f].toString();o.polygonCounts&&(o.polygonCounts[f]=h);var m=this.viewer3DImpl.setupMesh(this.model,e.geometry,p,this.tmpMatrix);c.activateFragment(f,m)}o.mesh2frag[t]=null,o.numLoaded+=a.length;var v=o.numLoaded;r.geomPolyCount>r.nextRepaintPolys&&(r.numRepaints++,r.nextRepaintPolys+=1e4*Math.pow(1.5,r.numRepaints),this.viewer3DImpl.invalidate(!1,!0)),v%20==0&&this.viewer3DImpl.invalidate(!1,!0)}else n.logger.warn("Mesh "+t+" was not referenced by any fragments.")},b.prototype.processReceivedMesh2D=function(e,t){t>=this.bufferCount&&(this.bufferCount=t+1);var r={mesh:e,is2d:!0,packId:"0",meshIndex:t},n="0:"+t,i=this.svf.fragments;if(!i.fragId2dbId[t]){var o=Object.keys(r.mesh.dbIds).map((function(e){return parseInt(e)}));i.fragId2dbId[t]=o;for(var a=0;a<o.length;a++){var s=o[a],l=i.dbId2fragId[s];Array.isArray(l)?l.push(t):i.dbId2fragId[s]=void 0!==l?[l,t]:t}var u=this.model.getFragmentList();if(e.material.modelScale=this.modelScale,e.material.opacity=this.options.opacity,e.material.doNotCut=this.options.doNotCut||(null==u?void 0:u.getDoNotCut()),null!=u&&u.viewBounds){var c=u.viewBounds;e.material.viewportBounds=new g.Vector4(c.min.x,c.min.y,c.max.x,c.max.y)}var d=this.viewer3DImpl;i.materials[t]=this.viewer3DImpl.matman().create2DMaterial(this.model,e.material,!1,!1,(function(e,t){var r=t.getData();null==r||!r.loadDone||r.texLoadDone||f.TextureLoader.requestsInProgress()||(r.texLoadDone=!0,d.onTextureLoadComplete(t)),(0,h.isMobileDevice)()&&f.TextureLoader.requestsInProgress()||d.invalidate(!1,!0,!1)})),i.length++}i.mesh2frag[n]=t,this.processReceivedMesh(r)},b.prototype.onModelRootLoadDone=function(e){var t,r;e.fragments={},e.fragments.mesh2frag={},e.fragments.materials=[],e.fragments.fragId2dbId=[],e.fragments.dbId2fragId={},e.fragments.length=0,e.fragments.initialized=!0,e.geomMemory=0,e.fragments.numLoaded=0,e.gpuNumMeshes=0,e.gpuMeshMemory=0,e.nextRepaintPolys=1e4,e.numRepaints=0,e.urn=this.svfUrn,e.acmSessionId=this.acmSessionId,e.basePath="";var i=this.currentLoadPath.lastIndexOf("/");-1!==i&&(e.basePath=this.currentLoadPath.substr(0,i+1)),e.placementTransform=null===(t=this.options.placementTransform)||void 0===t?void 0:t.clone(),e.placementWithOffset=null===(r=this.options.placementTransform)||void 0===r?void 0:r.clone(),e.loadOptions=this.options,e.texLoadDone=!1;var o=Date.now();this.loadTime+=o-this.t0,n.logger.log("SVF load: "+(o-this.t0)),this.t0=o,e.bbox=(new g.Box3).copy(e.bbox),e.modelSpaceBBox=e.bbox.clone(),e.placementTransform&&e.bbox.applyMatrix4(e.placementTransform);var s=this.model=new m.Model(e);s.loader=this,s.initialize(),this.options.skipPropertyDb||(this.svf.propDbLoader=new c.PropDbLoader(this.sharedDbPath,this.model,this.viewer3DImpl.api)),n.logger.log("scene bounds: "+JSON.stringify(e.bbox));var l={category:"metadata_load_stats",urn:e.urn,layers:e.layerCount};n.logger.track(l),this.viewer3DImpl.setDoNotCut(s,!!this.options.doNotCut),this.viewer3DImpl.signalProgress(5,a.ProgressState.ROOT_LOADED,this.model),this.viewer3DImpl.invalidate(!1,!1)},b.prototype.onGeomLoadDone=function(){this.svf.loadDone=!0,this.svf.fragments.entityIndexes=null,this.svf.fragments.mesh2frag=null;var e=Date.now(),t="Fragments load time: "+(e-this.t0);this.loadTime+=e-this.t0,f.TextureLoader.loadModelTextures(this.model,this.viewer3DImpl),this.options.skipPropertyDb||this.loadPropertyDb(),n.logger.log(t);var r={category:"model_load_stats",is_f2d:!0,has_prism:this.viewer3DImpl.matman().hasPrism,load_time:this.loadTime,geometry_size:this.model.getGeometryList().geomMemory,meshes_count:this.model.getGeometryList().geoms.length,urn:this.svfUrn};n.logger.track(r,!0);var i=this.model.getGeometryList(),o={load_time:this.loadTime,polygons:i.geomPolyCount,fragments:this.model.getFragmentList().getCount(),mem_usage:i.gpuMeshMemory,viewable_type:"2d"};v.analytics.track("viewer.model.loaded",o),this.currentLoadPath=null,this.isf2d=void 0,this.viewer3DImpl.onLoadComplete(this.model)},b.prototype.loadPropertyDb=function(){this.svf.propDbLoader&&this.svf.propDbLoader.load()},b.prototype.is3d=function(){return!1},s.FileLoaderManager.registerFileLoader("f2d",["f2d"],b)},36257:(e,t,r)=>{"use strict";r.r(t),r.d(t,{LeafletLoader:()=>m});var n=r(18588),i=r(79659),o=r(98926),a=r(57601),s=r(35313),l=r(50005),u=r(50411),c=r(83161),h=r(58964),d=r(37169),f=r(23909),p=Autodesk.Viewing.Private;function m(e){var t=e;this.isLeafletLoader=!0,this.loading=!1;var r=function(e,t){var r=[80,75,1,2],n=t;if(e[n++]!==r[0]||e[n++]!==r[1]||e[n++]!==r[2]||e[n++]!==r[3])return o.logger.error("invalid file header signature"),null;var i={};return i.version=e[n++],i.os=e[n++],i.needVersion=e[n++]|e[n++]<<8,i.flags=e[n++]|e[n++]<<8,i.compression=e[n++]|e[n++]<<8,i.time=e[n++]|e[n++]<<8,i.date=e[n++]|e[n++]<<8,i.crc32=(e[n++]|e[n++]<<8|e[n++]<<16|e[n++]<<24)>>>0,i.compressedSize=(e[n++]|e[n++]<<8|e[n++]<<16|e[n++]<<24)>>>0,i.plainSize=(e[n++]|e[n++]<<8|e[n++]<<16|e[n++]<<24)>>>0,i.fileNameLength=e[n++]|e[n++]<<8,i.extraFieldLength=e[n++]|e[n++]<<8,i.fileCommentLength=e[n++]|e[n++]<<8,i.diskNumberStart=e[n++]|e[n++]<<8,i.internalFileAttributes=e[n++]|e[n++]<<8,i.externalFileAttributes=e[n++]|e[n++]<<8|e[n++]<<16|e[n++]<<24,i.relativeOffset=(e[n++]|e[n++]<<8|e[n++]<<16|e[n++]<<24)>>>0,i.filename=String.fromCharCode.apply(null,e.slice(n,n+=i.fileNameLength)),i.extraField=e.slice(n,n+=i.extraFieldLength),i.comment=e.slice(n,n+i.fileCommentLength),i.length=n-t,i},u=function(e){var t=function(e){var t=[80,75,3,4],r=0;if(e[r++]!==t[0]||e[r++]!==t[1]||e[r++]!==t[2]||e[r++]!==t[3])return o.logger.error("invalid local file header signature"),null;var n={};return n.needVersion=e[r++]|e[r++]<<8,n.flags=e[r++]|e[r++]<<8,n.compression=e[r++]|e[r++]<<8,n.time=e[r++]|e[r++]<<8,n.date=e[r++]|e[r++]<<8,n.crc32=(e[r++]|e[r++]<<8|e[r++]<<16|e[r++]<<24)>>>0,n.compressedSize=(e[r++]|e[r++]<<8|e[r++]<<16|e[r++]<<24)>>>0,n.plainSize=(e[r++]|e[r++]<<8|e[r++]<<16|e[r++]<<24)>>>0,n.fileNameLength=e[r++]|e[r++]<<8,n.extraFieldLength=e[r++]|e[r++]<<8,n.filename=String.fromCharCode.apply(null,e.slice(r,r+=n.fileNameLength)),n.extraField=e.slice(r,r+=n.extraFieldLength),n.length=r,n}(e);if(!t)return null;var r=t.length,n=t.compressedSize;return e.slice(r,r+n)};this.continueLoadFile=function(e,r,a,l,u,h){var m,g,v=this;null!==(m=r.loadOptions)&&void 0!==m&&m.loadFromZip?g="{z}/{x}_{y}."+r.loadOptions.mime.split("/")[1]:g=e;u.initFromLoadOptions(g,r.loadOptions,h,r);var y=null;l&&l(),!u.valid()&&u.initForSimpleImage(e),u.onRootLoaded=function(){if(v.loading){var s=new function(i){var o;this.bbox=new f.Box3,this.basePath=e,this.is2d=!0,this.urn=null===(o=r.bubbleNode)||void 0===o?void 0:o.getRootNode().urn();var a=i&&i.paperWidth>=0?i.paperWidth:u.texWidth,s=i&&i.paperHeight>=0?i.paperHeight:u.texHeight;this.pageToModelTransform=u.getPageToModelTransform(a,s),this.metadata={},this.metadata.page_dimensions={};var l=this.metadata.page_dimensions;l.page_width=a,l.page_height=s,l.page_units=i&&i.paperUnits,this.loadDone=!0,this.isLeaflet=!0,t.signalProgress(100,n.ProgressState.LOADING),u.texWidth>0&&(this.maxPixelPerUnit=u.texWidth/u.getQuadWidth(),u.isSimpleImage&&(this.maxPixelPerUnit*=10))}(r.loadOptions);s.loadOptions=r,s.bbox.copy(u.getBBox()),s.modelSpaceBBox=s.bbox.clone(),r.placementTransform&&(s.placementTransform=r.placementTransform.clone(),s.placementWithOffset=r.placementTransform.clone(),s.bbox.applyMatrix4(r.placementTransform));var l=new c.Model(s);return l.initFromCustomIterator(y),l.loader=v,t.api.dispatchEvent({type:d.MODEL_ROOT_LOADED_EVENT,svf:s,model:l}),y.callWhenRefined((function(){var e,t,r=Date.now();s.loadTime=r-v.t0,o.logger.log("SVF load: "+s.loadTime),p.analytics.track("viewer.model.loaded",{load_time:s.loadTime,total_raster_pixels:null===(e=s.loadOptions.bubbleNode)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.totalRasterPixels,viewable_type:"2d"})})),a(null,l),v.loading=!1,l.id}a({code:i.ErrorCodes.LOAD_CANCELED,msg:"Load canceled"},null)},u.onDone=a,u.getPixelRatio=t.glrenderer().getPixelRatio,u.maxAnisotropy=t.glrenderer().getMaxAnisotropy(),u.placementTransform=r.placementTransform,(y=new s.ModelIteratorTexQuad(u,t.getMaterials())).requestRootTile()},this.loadFile=function(e,t,n,c){if(this.loading)return o.logger.log("Loading of Leaflet already in progress. Ignoring new request."),!1;var d=this;this.options=t,this.t0=Date.now();var p=new s.TexQuadConfig,m=null,g=t.acmSessionId;if(t.loadOptions&&t.loadOptions.loadFromZip){m=function(e,t,r){for(var n,i=e.split("/")[0]-p.levelOffset,o=0;o<p.zips.length;o++)if(i<=p.zips[o].zipMaxLevel){n=p.zips[o];break}if(!n)return r("Failed loading texture - tile's level doesn't exists."),!1;var a=n.fileTable[e];if(!a)return r("Failed loading texture - entry does not exist inside fileTable."),!1;var s={extractImage:u},c=a.relativeOffset,h=a.relativeOffset+a.contentSize;n.rawData?s.rawData=n.rawData.slice(c,h):s.range={min:c,max:h},l.TextureLoader.loadTextureWithSecurity(n.urnZip,f.UVMapping,t,r,g,!0,s)};t.loadOptions.zips.forEach((function(s){var l=s.centralDirOffset,u=s.centralDirLength,f=s.centralDirEntries;!function(e,t,r,n,i,o){var s=null,l={};(0,h.isOffline)()||(t&&(s="acmsession="+t),l.range={min:r,max:n+r});var u=(0,h.initLoadContext)({queryParams:s});a.ViewingService.getItem(u,e,i,o,l)}(s.urnZip,g,l,u,(function(i){(0,h.isOffline)()&&(s.rawData=i,i=i.slice(l,l+u));var o=function(e,t,n){for(var i,o=0,a={},s=null,l=0;l<n;++l){if(!(i=r(e,o)))return null;s&&(s.contentSize=i.relativeOffset-s.relativeOffset),o+=i.length,a[i.filename]=i,s=i}return s.contentSize=t-s.relativeOffset,a}(i,l,f);if(!o)return n("Failed parsing central directory of the zip.",null),!1;s.fileTable=o,t.loadOptions.zips.every((function(e){return Object.keys(e.fileTable).length>0}))&&d.continueLoadFile(e,t,n,c,p,m)}),(function(e){o.logger.error("Zip download failed: "+e.statusText,(0,i.errorCodeString)(i.ErrorCodes.NETWORK_FAILURE)),n("Zip download failed: "+e.statusText,null)}))}))}else m=function(e,t,r){l.TextureLoader.loadTextureWithSecurity(e,f.UVMapping,t,r,g,!0)},this.continueLoadFile(e,t,n,c,p,m);return this.loading=!0,!0},this.dtor=function(){this.loading=!1}}m.prototype.is3d=function(){return!1},m.prototype.isPageCoordinates=function(){var e,t;return!(null===(e=this.options)||void 0===e||null===(t=e.loadOptions)||void 0===t||!t.fitPaperSize)},u.FileLoaderManager.registerFileLoader("Leaflet",["jpeg","jpg","png"],m)},16727:(e,t,r)=>{"use strict";r.r(t),r.d(t,{OtgLoader:()=>k});var n=r(43586),i=r(22585),o=r(73075),a=r(98926),s=r(50005),l=r(26245),u=r(46759),c=r(8283),h=r(58092),d=r(58964),f=r(57601);function p(e){return p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},p(e)}function m(e){switch(e){default:return 1;case"feet and inches":case"foot":case"feet":case"ft":return.3048;case"inch":case"inches":case"in":return.0254;case"centimeter":case"centimeters":case"cm":return.01;case"millimeter":case"millimeters":case"mm":return.001}}function g(e,t){if(e.metadata){var r=e.metadata["world bounding box"],a=new o.LmvVector3(r.minXYZ[0],r.minXYZ[1],r.minXYZ[2]),s=new o.LmvVector3(r.maxXYZ[0],r.maxXYZ[1],r.maxXYZ[2]);e.bbox=new i.LmvBox3(a,s),e.modelSpaceBBox=e.bbox.clone();var l=function(e,t){if(e.placementTransform=t.placementTransform,t.applyScaling){var r="m";e.metadata["distance unit"]&&(r=e.metadata["distance unit"].value),e.scalingUnit=r,"object"===p(t.applyScaling)?(t.applyScaling.from&&(r=t.applyScaling.from),t.applyScaling.to&&(e.scalingUnit=t.applyScaling.to)):e.scalingUnit=t.applyScaling;var i=m(r)/m(e.scalingUnit);if(1!=i){var o=new n.LmvMatrix4(!0),a=new n.LmvMatrix4(!0);a.elements[0]=i,a.elements[5]=i,a.elements[10]=i,t.placementTransform&&o.copy(t.placementTransform),t.applyPlacementInModelUnits?t.placementTransform=a.multiply(o):t.placementTransform=o.multiply(a),e.placementTransform=t.placementTransform,e.scalingFactor=i}}var s=e.metadata["custom values"];if(s&&s.refPointTransform){e.refPointTransform=new n.LmvMatrix4(!0);var l=e.refPointTransform.elements,u=s.refPointTransform;l[0]=u[0],l[1]=u[1],l[2]=u[2],l[4]=u[3],l[5]=u[4],l[6]=u[5],l[8]=u[6],l[9]=u[7],l[10]=u[8],l[12]=u[9],l[13]=u[10],l[14]=u[11]}else{var c=e.metadata.georeference,h=c&&c.refPointLMV,d=0;if(s&&s.hasOwnProperty("angleToTrueNorth")&&(d=Math.PI/180*s.angleToTrueNorth),h||d){var f=new n.LmvMatrix4(!0),g=f.elements;g[0]=g[5]=Math.cos(d),g[1]=-Math.sin(d),g[4]=Math.sin(d);var v=new n.LmvMatrix4(!0);g=v.elements,h&&(g[12]=-h[0],g[13]=-h[1],g[14]=-h[2]),e.refPointTransform=f.multiply(v)}}if(t.applyRefPoint&&e.refPointTransform){var y=new n.LmvMatrix4(!0);t.placementTransform&&y.copy(t.placementTransform),y.multiply(e.refPointTransform),e.placementTransform=t.placementTransform=y}else!t.applyRefPoint&&t.placementTransform&&(e.placementTransform=new n.LmvMatrix4(!0).copy(t.placementTransform));return e.placementTransform&&function(e){for(var t=e.elements,r=0;r<4;r++)for(var n=0;n<4;n++)if(r===n){if(1!==t[4*r+n])return!1}else if(0!==t[4*r+n])return!1;return!0}(e.placementTransform)&&(e.placementTransform=null),e.placementTransform}(e,t);l&&!e.bbox.isEmpty()&&e.bbox.applyMatrix4(l),t.globalOffset?e.globalOffset=t.globalOffset:e.globalOffset=e.bbox.getCenter(new o.LmvVector3),function(e,t){var r=e.globalOffset;if(r.x||r.y||r.z){if(t){var i=new n.LmvMatrix4(!0);i.copy(t),(t=i).elements[12]-=r.x,t.elements[13]-=r.y,t.elements[14]-=r.z}else(t=new n.LmvMatrix4(!0)).makeTranslation(-r.x,-r.y,-r.z);e.placementWithOffset=t}else e.placementWithOffset=t}(e,l),e.bbox.isEmpty()||(e.bbox.min.sub(e.globalOffset),e.bbox.max.sub(e.globalOffset)),e.metadata.hasOwnProperty("double sided geometry")&&e.metadata["double sided geometry"].value&&(e.doubleSided=!0)}}function v(e,t){e[0]-=t.x,e[1]-=t.y,e[2]-=t.z}function y(e,t){if(t&&(t.transformPoint(e.position),t.transformPoint(e.target),t.transformDirection(e.up),isFinite(e.orthoScale))){var r=t.getMaxScaleOnAxis();e.orthoScale*=r}}var b=r(4100),x=r(59481);function _(e,t){var r,n,i,o,s,l=0;function u(e){var l=new Uint8Array(4);if("string"==typeof e)for(var u=0;u<4;u++)l[u]=e.charCodeAt(u);else for(var c=0;c<4;c++)l[c]=e[c];(r=l[1]<<8|l[0])||(r=t||0),r||a.logger.error("Unknwon byte stride."),r%4&&a.logger.error("Expected byte size to be multiple of 4, but got "+r),n=l[3]<<8|l[2],r/4,i=new Uint8Array(r),o=new Float32Array(i.buffer),s=new Uint32Array(i.buffer)}this.onData=function(t,n,o){void 0===n&&(n=t.length);for(var a="string"==typeof t;;){if(!l&&n>=4)u(t),l++;else if(n<4)return!1;var s=l*r;if(n<s+r)return o;if(a)for(var c=0;c<r;c++)i[c]=255&t.charCodeAt(c+s);else for(var h=0;h<r;h++)i[h]=t[h+s];if(!e(this,l))return!1;l++}},this.onEnd=function(e,t){this.onData(e,t,!0)||(this.rawData=e,this.rawLength=t)},this.flush=function(){this.rawData&&(this.onData(this.rawData,this.rawLength,!0)&&(this.rawData=null))},this.idata=function(){return s},this.fdata=function(){return o},this.bdata=function(){return i},this.version=function(){return n},this.byteStride=function(){return r}}var E="urn:adsk.fluent:",w="$otg_cdn$";function A(){this.materials=null,this.fragments=null,this.geompacks=[],this.propertydb={attrs:[],avs:[],ids:[],values:[],offsets:[],dbid:[]},this.bbox=null,this.animations=null,this.pendingRequests=0,this.globalOffset={x:0,y:0,z:0},this.pendingRequests=0,this.initialLoadProgress=0,this.materialIdToHash=[],this.aborted=!1}A.prototype.getMaterialHash=function(e){var t=this.materialIdToHash[e];if(t)return t;var r=this.materialHashes.byteStride,n=(0,b.getHexStringPacked)(this.materialHashes.hashes,e*r,r);return this.materialIdToHash[e]=n,n},A.prototype.getGeometryHash=function(e){var t=this.geomMetadata.byteStride;return(0,b.getHexStringPacked)(this.geomMetadata.hashes,e*t,t)},A.prototype.initEmptyLists=function(e){var t=this,r=t.fragments={};r.length=t.metadata.stats.num_fragments,r.numLoaded=0,r.boxes=e.fragmentTransformsDouble?new Float64Array(6*r.length):new Float32Array(6*r.length),r.transforms=e.fragmentTransformsDouble?new Float64Array(12*r.length):new Float32Array(12*r.length),r.materials=(0,x.R)(r.length,t.metadata.stats.num_materials),r.geomDataIndexes=(0,x.R)(r.length,t.metadata.stats.num_geoms),r.fragId2dbId=new Int32Array(r.length),r.visibilityFlags=new Uint8Array(r.length),r.mesh2frag={},r.topoIndexes=null,t.geomMetadata={hashes:null,byteStride:0,version:0,numLoaded:0,hashToIndex:{}},t.materialHashes={hashes:null,byteStride:0,version:0,numLoaded:0},t.materials={name:"LMVTK Simple Materials",version:"1.0",scene:{SceneUnit:8215,YIsUp:0},materials:{}}},A.prototype.loadAsyncResource=function(e,t,r,n){var i=this;this.pendingRequests++,t=(0,f.pathToURL)(t,e.basePath),f.ViewingService.getItem(e,t,(function(e){i.pendingRequests--,n(e)}),e.onFailureCallback,{responseType:r||"arraybuffer"})},A.prototype.loadAsyncProgressive=function(e,t,r,n,i){var o=this;t=(0,f.pathToURL)(t,e.basePath),f.ViewingService.getItem(e,t,(function(t,i){r.onEnd(t,i),o.postLoad(e,n,r,t)}),i||e.onFailureCallback,{responseType:"text",onprogress:function(e,t){if(o.aborted)return!0;r.onData(e,t,!1)}})},A.prototype.loadMetadata=function(e,t){var r=this;this.loadAsyncResource(e,t,"json",(function(i){r.metadata=i,r.manifest=r.metadata.manifest,r.numGeoms=r.metadata.stats.num_geoms,r.processMetadata(e),r.initEmptyLists(e);var o=r.metadata.manifest,a=o.shared_assets.pdb;for(var s in a)r.propertydb[s]&&r.propertydb[s].push({path:a[s],isShared:!0});var l=o.assets.pdb;for(var s in l)r.propertydb[s]&&r.propertydb[s].push({path:l[s],isShared:!1});o.assets.animations&&r.loadAsyncResource(e,o.assets.animations,"json",(function(e){r.animations=e,function(e){if(e.animations){var t=e.animations.animations;if(t)for(var r=e.globalOffset,i=(new n.LmvMatrix4).makeTranslation(r.x,r.y,r.z),o=(new n.LmvMatrix4).makeTranslation(-r.x,-r.y,-r.z),a=new n.LmvMatrix4,s=new n.LmvMatrix4,l=0;l<t.length;l++){var u=t[l];if(u.hierarchy)for(var c=0;c<u.hierarchy.length;c++){var h=u.hierarchy[c].keys;if(h)for(var d=0;d<h.length;d++){var f=h[d].pos;if(f){var p=r,m=h[d].rot;m&&(a.makeRotationFromQuaternion({x:m[0],y:m[1],z:m[2],w:m[3]}),s.multiplyMatrices(i,a).multiply(o),p={x:s.elements[12],y:s.elements[13],z:s.elements[14]}),v(f,p)}var g=h[d].target;g&&v(g,r);var y=h[d].points;if(y)for(var b=0;b<y.length;b++)v(y[b],r)}}}}}(r)})),o.assets.topology&&r.loadAsyncResource(e,t,"json",(function(e){r.topology=e})),e.onLoaderEvent("otg_root"),r.postLoad(e,"metadata")}))},A.prototype.loadFragmentList=function(e,t){var r=this,a=new o.LmvVector3,s=new o.LmvVector3,l={x:0,y:0,z:0,w:1},c=new n.LmvMatrix4(!0),h=new i.LmvBox3,d={x:0,y:0,z:0};var f=new _((function(t,n){if(n-=1,!r.metadata)return!1;var i=t.idata(),o=t.fdata(),f=r.fragments,p=f.geomDataIndexes[n]=i[0],m=f.materials[n]=i[1],g=f.fragId2dbId[n]=i[2],v=i[3];if(p>r.geomMetadata.numLoaded||m>r.materialHashes.numLoaded)return!1;var y,b=f.mesh2frag[p];void 0===b?f.mesh2frag[p]=n:Array.isArray(b)?b.push(n):f.mesh2frag[p]=[b,n],y=!r.dbIdFilter||r.dbIdFilter[g]?1&v?u.MeshFlags.MESH_HIDE:0:u.MeshFlags.MESH_NOTLOADED,f.visibilityFlags[n]=y;var x=r.metadata.fragmentTransformsOffset||d;a.set(o[4]+x.x,o[5]+x.y,o[6]+x.z),l.x=o[7],l.y=o[8],l.z=o[9],l.w=o[10],s.set(o[11],o[12],o[13]),c.compose(a,l,s),r.placementWithOffset&&c.multiplyMatrices(r.placementWithOffset,c);var _=c.elements,E=f.transforms,w=12*n;return E[w+0]=_[0],E[w+1]=_[1],E[w+2]=_[2],E[w+3]=_[4],E[w+4]=_[5],E[w+5]=_[6],E[w+6]=_[8],E[w+7]=_[9],E[w+8]=_[10],E[w+9]=_[12],E[w+10]=_[13],E[w+11]=_[14],h.min.x=-.5,h.min.y=-.5,h.min.z=-.5,h.max.x=.5,h.max.y=.5,h.max.z=.5,h.applyMatrix4(c),f.boxesLoaded||((E=f.boxes)[(w=6*n)+0]=h.min.x,E[w+1]=h.min.y,E[w+2]=h.min.z,E[w+3]=h.max.x,E[w+4]=h.max.y,E[w+5]=h.max.z),f.numLoaded=n+1,e.onLoaderEvent("fragment",n),!0}),52);return this.loadAsyncProgressive(e,t,f,"all_fragments"),f},A.prototype.handleHashListRequestFailures=function(e){this.metadata&&(this.geomHashListFailure&&this.metadata.stats.num_geoms>0&&e.onFailureCallback.apply(e,this.geomHashListFailure),this.matHashListFailure&&this.metadata.stats.num_materials>0&&e.onFailureCallback.apply(e,this.matHashListFailure),this.geomHashListFailure=null,this.matHashListFailure=null)},A.prototype.loadGeometryHashList=function(e,t){var r=this;var n=new _((function(e,t){return!!r.metadata&&(r.geomMetadata.hashes||(r.geomMetadata.hashes=new Uint8Array(e.byteStride()*(r.numGeoms+1)),r.geomMetadata.byteStride=e.byteStride(),r.geomMetadata.version=e.version()),r.geomMetadata.hashes.set(e.bdata(),t*e.byteStride()),r.geomMetadata.numLoaded=t,!0)}),20);return this.loadAsyncProgressive(e,t,n,"geometry_ptrs",(function(){r.geomHashListFailure=arguments,r.handleHashListRequestFailures(e),r.postLoad(e,"geometry_ptrs",n)})),n},A.prototype.loadMaterialHashList=function(e,t){var r=this;var n=new _((function(e,t){return!!r.metadata&&(r.materialHashes.hashes||(r.numMaterials=r.metadata.stats.num_materials,r.materialHashes.hashes=new Uint8Array(e.byteStride()*(r.numMaterials+1)),r.materialHashes.byteStride=e.byteStride(),r.materialHashes.version=e.version()),r.materialHashes.hashes.set(e.bdata(),t*e.byteStride()),r.materialHashes.numLoaded=t,!0)}),20);return this.loadAsyncProgressive(e,t,n,"material_ptrs",(function(){r.matHashListFailure=arguments,r.handleHashListRequestFailures(e),r.postLoad(e,"material_ptrs",n)})),n},A.prototype.processMetadata=function(e){var t=this,r=t.metadata;g(t,e);var n=t.placementWithOffset;if(r.cameras){t.cameras=r.cameras;for(var i=0;i<t.cameras.length;i++){var a=t.cameras[i];a.position=new o.LmvVector3(a.position.x,a.position.y,a.position.z),a.target=new o.LmvVector3(a.target.x,a.target.y,a.target.z),a.up=new o.LmvVector3(a.up.x,a.up.y,a.up.z),n&&y(a,n)}}},A.prototype.beginLoad=function(e,t){this.loadMetadata(e,t);var r=e.objectIds;if(r){this.dbIdFilter={};for(var n=0,i=r.length;n<i;n++)this.dbIdFilter[r[n]]=1}this.materialsCtx=this.loadMaterialHashList(e,"materials_ptrs.hl"),this.geometryCtx=this.loadGeometryHashList(e,"geometry_ptrs.hl"),this.fragmentsCtx=this.loadFragmentList(e,"fragments.fl")},A.prototype.makeSharedResourcePath=function(e,t,r){if(10===r.length&&(r=(0,b.unpackHexString)(r)),e){var n=r,i="";(s=this.manifest.shared_assets.global_sharding||0)&&(i="/"+r.slice(0,s),n=r.slice(s));var o=this.manifest.shared_assets[t];if(0===o.indexOf(E)||0===o.indexOf(w))o=o.slice(o.indexOf("/"));else{var a=o.split("/");o="/"+(a[a.length-1]||a[a.length-2])+"/"}return e+i+o+n}var s;n=r,i="";return(s=this.manifest.shared_assets.global_sharding||2)&&(i="/"+r.slice(0,s)+"/",n=r.slice(s)),(0,f.pathToURL)(this.basePath)+this.manifest.shared_assets[t]+i+n},A.prototype.postLoad=function(e,t,r,n){t&&this.initialLoadProgress++,4===this.initialLoadProgress?(this.materialsCtx.flush(),this.geometryCtx.flush(),this.fragmentsCtx.flush(),this.materialsCtx=null,this.geometryCtx=null,this.fragmentsCtx=null,this.fragments.numLoaded<this.metadata.stats.num_fragments&&a.logger.warn("Fragments actually loaded fewer than expected."),e.onLoaderEvent("all_fragments")):"metadata"===t&&(this.materialsCtx.flush(),this.geometryCtx.flush(),this.fragmentsCtx.flush())},A.prototype.abort=function(){this.aborted=!0};var S=r(50411),M=r(83161),T=r(37169),C=r(18588),P=r(84998),D=r(19115),L=r(7913);function R(e,t,r,n,i,o,a){try{var s=e[o](a),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,i)}function I(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function a(e){R(o,n,i,a,s,"next",e)}function s(e){R(o,n,i,a,s,"throw",e)}a(void 0)}))}}var O=Autodesk.Viewing,N=Autodesk.Viewing.Private;function k(e){this.viewer3DImpl=e,this.loading=!1,this.tmpMatrix=new n.LmvMatrix4,this.tmpBox=new i.LmvBox3,this.logger=a.logger,this.loadTime=0,this.pendingMaterials={},this.pendingMaterialsCount=0,this.pendingMeshes={},this.pendingMeshesCount=0,this.operationsDone=0}function F(e){var t="",r=e.lastIndexOf("/");return-1!=r&&(t=e.substr(0,r+1)),t}function V(e){return e.acmSessionId?"acmsession="+e.acmSessionId:""}function U(e,t,r){var n={basePath:t,objectIds:e.ids,globalOffset:e.globalOffset,fragmentTransformsDouble:e.fragmentTransformsDouble,placementTransform:e.placementTransform,applyRefPoint:e.applyRefPoint,queryParams:r,bvhOptions:e.bvhOptions||{isWeakDevice:(0,P.isMobileDevice)()},applyScaling:e.applyScaling,applyPlacementInModelUnits:e.applyPlacementInModelUnits,loadInstanceTree:e.loadInstanceTree};return(0,d.initLoadContext)(n)}function B(e){return Math.floor(100*e.fragsLoaded/e.metadata.stats.num_fragments)}k.prototype.dtor=function(){this.initWorkerScriptToken&&(this.initWorkerScriptToken.cancel(),this.initWorkerScriptToken=null,a.logger.debug("SVF loader dtor: on init worker script.")),this.bvhWorker&&(this.bvhWorker.clearAllEventListenerWithIntercept(),this.bvhWorker.terminate(),this.bvhWorker=null,a.logger.debug("SVF loader dtor: on svf worker.")),this.svf&&(this.svf.loadDone||console.log("stopping load before it was complete"),this.svf.abort(),this.svf.propDbLoader&&(this.svf.propDbLoader.dtor(),this.svf.propDbLoader=null)),this.viewer3DImpl.geomCache()&&this.model&&(this.loading&&this.viewer3DImpl.geomCache().cancelRequests(this.svf.geomMetadata.hashToIndex),this.removeMeshReceiveListener()),this.viewer3DImpl=null,this.model=null,this.svf=null,this.logger=null,this.tmpMatrix=null,this.loading=!1,this.loadTime=0},k.prototype.isValid=function(){return null!=this.viewer3DImpl},k.prototype.removeMeshReceiveListener=function(){this.meshReceiveListener&&(this.viewer3DImpl.geomCache().updateMruTimestamps(),this.viewer3DImpl.geomCache().removeEventListener(D.MESH_RECEIVE_EVENT,this.meshReceiveListener),this.viewer3DImpl.geomCache().removeEventListener(D.MESH_FAILED_EVENT,this.meshReceiveListener),this.viewer3DImpl.geomCache().removeEventListener(D.MATERIAL_RECEIVE_EVENT,this.materialReceiveListener),this.viewer3DImpl.geomCache().removeEventListener(D.MATERIAL_FAILED_EVENT,this.materialReceiveListener),this.meshReceiveListener=null)},k.prototype.loadFile=function(e,t,r,n){if(!this.viewer3DImpl)return a.logger.log("SVF loader was already destructed. So no longer usable."),!1;if(this.loading)return a.logger.log("Loading of SVF already in progress. Ignoring new request."),!1;if(this.loading=!0,t.acmSessionId)this.svfUrn=t.acmSessionId.split(",")[0];else{console.warn("DEPRECATED: Automatic derivation of URN will be removed in a future release. Please set the acmSessionId parameter when loading OTG data.");var i=e.indexOf(E);if(-1===i&&(i=e.indexOf(w)),-1!==i){var o=e.split("/"),s=o[1]+"?version="+o[2],l=O.toUrlSafeBase64(s);this.svfUrn=l}}return this.sharedDbPath=t.sharedPropertyDbPath,this.currentLoadPath=e,this.basePath=F(e),this.acmSessionId=t.acmSessionId,this.options=t,this.queryParams=V(t),this.loadContext=U(t,this.basePath,this.queryParams),this.loadContext.raiseError=function(e,t,n){r&&r({code:e,msg:t,args:n})},this.loadContext.onFailureCallback=f.ViewingService.defaultFailureCallback.bind(this.loadContext),this.loadModelRoot(this.loadContext,r),n&&n(),!0},k.prototype.loadModelRoot=function(e,t){this.t0=(new Date).getTime(),this.firstPixelTimestamp=null;var r=this,n=!1,i={};this.initWorkerScriptToken=(0,h.initWorkerScript)((function(){for(var t in n=!0,i)i.hasOwnProperty(t)&&i[t].forEach((function(r){e.onLoaderEvent(t,r)}));i={}}));var o=this.svf=new A;return o.basePath=e.basePath,e.onLoaderEvent=function(e,s){if(r.svf){if(!n)return i.hasOwnProperty(e)||(i[e]=[]),void i[e].push(s);if("otg_root"===e){r.onModelRootLoadDone(o),t&&t(null,r.model),r.makeBVHInWorker();var l=r.viewer3DImpl.geomCache();l||a.logger.error("geomCache is required for loading OTG models."),l.initWorker(r.options.acmSessionId),r.meshReceiveListener=function(e){e.error&&e.error.args?r.onMeshError(e):r.onMeshReceived(e.geom)},l.addEventListener(D.MESH_RECEIVE_EVENT,r.meshReceiveListener),l.addEventListener(D.MESH_FAILED_EVENT,r.meshReceiveListener),r.materialReceiveListener=function(e){!e.error&&e.material&&e.material.length?r.onMaterialLoaded((0,L.Up)(e.material),e.hash):r.onMaterialLoaded(null,e.hash)},l.addEventListener(D.MATERIAL_RECEIVE_EVENT,r.materialReceiveListener),l.addEventListener(D.MATERIAL_FAILED_EVENT,r.materialReceiveListener),r.svf.loadDone=!1}else if("fragment"===e)r.options.skipMeshLoad||r.tryToActivateFragment(s,"fragment"),r.options.onFragmentListLoadProgress&&r.trackFragmentListLoadProgress();else if("all_fragments"===e)r.options.skipPropertyDb||r.loadPropertyDb(),r.fragmentDataLoaded=!0,r.viewer3DImpl.api.fireEvent({type:T.MODEL_ROOT_LOADED_EVENT,svf:o,model:r.model}),r.options.skipMeshLoad||!r.svf.fragments.length?r.onGeomLoadDone():r.onOperationComplete();else if("bvh"===e){var u=s;r.model&&(r.model.setBVH(u.nodes,u.primitives,r.options.bvhOptions),r.viewer3DImpl&&r.viewer3DImpl.modelVisible(r.model.id)&&r.viewer3DImpl.invalidate(!1,!0)),r.onOperationComplete()}}else console.error("load callback called after load was aborted")},o.beginLoad(e,(0,f.pathToURL)(r.currentLoadPath)),!0},k.prototype.makeBVHInWorker=function(){var e=this;e.bvhWorker=(0,h.createWorkerWithIntercept)();e.bvhWorker.addEventListenerWithIntercept((function(t){if(t.data.bvh){console.log("Received BVH from worker");var r=t.data.bvh;e.model&&(e.svf.bvh=r,e.model.setBVH(new l.NodeArray(r.nodes,r.useLeanNodes),r.primitives,e.options.bvhOptions),e.viewer3DImpl&&e.viewer3DImpl.modelVisible(e.model.id)&&e.viewer3DImpl.invalidate(!1,!0)),e.bvhWorker.clearAllEventListenerWithIntercept(),e.bvhWorker.terminate(),e.bvhWorker=null,e.onOperationComplete()}if(t.data.boxes&&e.model){var n=e.model.myData.fragments;!function(e,t){for(var r=t.data.boxes,n=t.data.boxStride,i=r.length/n,o=0,a=0,s=0;o<i;o++,a+=n,s+=6)e[s+0]=r[a+0],e[s+1]=r[a+1],e[s+2]=r[a+2],e[s+3]=r[a+3],e[s+4]=r[a+4],e[s+5]=r[a+5]}(n.boxes,t),n.boxesLoaded=!0,e.model.visibleBoundsDirty=!0}}));var t=Object.assign({},e.loadContext);t.operation="LOAD_OTG_BVH",t.raiseError=null,t.onFailureCallback=null,t.onLoaderEvent=null,t.fragments_extra=(0,f.pathToURL)(e.basePath)+e.svf.manifest.assets.fragments_extra,t.placementTransform=e.svf.placementTransform,t.placementWithOffset=e.svf.placementWithOffset,t.fragmentTransformsOffset=e.svf.metadata.fragmentTransformsOffset,t.globalOffset=e.svf.globalOffset,t.fragments_extra?e.bvhWorker.doOperation(t):e.onOperationComplete()},k.prototype.tryToActivateFragment=function(e,t){var r,n=this.svf,i=this.model;if(i){var o=n.fragments.visibilityFlags[e],a=o&u.MeshFlags.MESH_NOTLOADED,s=o&u.MeshFlags.MESH_HIDE,l=null!==(r=n.loadOptions.skipHiddenFragments)&&void 0!==r&&r;if(a||s&&l)return i.getFragmentList().setFlagFragment(e,u.MeshFlags.MESH_NOTLOADED,!0),void this.trackGeomLoadProgress(n,e,!1);o&u.MeshFlags.MESH_HIDE&&(i.getFragmentList().setFlagFragment(e,u.MeshFlags.MESH_HIDE,!1),i.getFragmentList().setFlagFragment(e,u.MeshFlags.MESH_VISIBLE,!1));var c=!1,h=n.fragments.materials[e],d=n.getMaterialHash(h),f=this.findOrLoadMaterial(i,d,h);f||("fragment"===t&&this.pendingMaterials[d].push(e),"material"!==t&&(c=!0));var p=n.fragments.geomDataIndexes[e];if(0!==p){i.getFragmentList().getOriginalWorldMatrix(e,this.tmpMatrix);var m=i.getGeometryList().getGeometry(p);if(m||("fragment"===t&&this.loadGeometry(p,e),c=!0),!c){var g=this.viewer3DImpl.setupMesh(i,m,d,this.tmpMatrix);g.geomId=p,i.activateFragment(e,g,!!n.placementTransform),this.viewer3DImpl.geomCache().updateGeomImportance(i,e),this.trackGeomLoadProgress(n,e,!1)}}else(f||"material"===t)&&this.trackGeomLoadProgress(n,e,!1)}},k.prototype.onModelRootLoadDone=function(e){e.isOTG=!0,e.geomMetadata.hashToIndex={},e.failedFrags={},e.failedMeshes={},e.failedMaterials={},e.geomMemory=0,e.gpuNumMeshes=0,e.gpuMeshMemory=0,e.fragsLoaded=0,e.fragsLoadedNoGeom=0,e.nextRepaintPolys=0,e.numRepaints=0,e.urn=this.svfUrn,e.acmSessionId=this.acmSessionId,e.basePath=this.basePath,e.loadOptions=this.options||{};var t=Date.now();this.loadTime+=t-this.t0,a.logger.log("SVF load: "+(t-this.t0));var r=this.model=new M.Model(e);r.loader=this,r.initialize(),this.t0=t,a.logger.log("scene bounds: "+JSON.stringify(e.bbox));var n={category:"metadata_load_stats",urn:e.urn,has_topology:!!e.topology,has_animations:!!e.animations,materials:e.metadata.stats.num_materials,is_mobile:(0,P.isMobileDevice)()};a.logger.track(n),this.viewer3DImpl.signalProgress(5,C.ProgressState.ROOT_LOADED,this.model),e.handleHashListRequestFailures(this.loadContext),e.propDbLoader=new c.PropDbLoader(this.sharedDbPath,this.model,this.viewer3DImpl.api)},k.prototype.trackGeomLoadProgress=function(e,t,r){if(r){if(e.failedFrags[t])return void console.log("Double fail",t);e.failedFrags[t]=1}var n=B(e);e.fragsLoaded++;var i=B(e);i>n&&this.viewer3DImpl.signalProgress(i,C.ProgressState.LOADING,this.model),this.model.getGeometryList().geomPolyCount>e.nextRepaintPolys&&(this.firstPixelTimestamp=this.firstPixelTimestamp||Date.now(),e.numRepaints++,e.nextRepaintPolys+=1e5*Math.pow(1.5,e.numRepaints),this.viewer3DImpl.modelVisible(this.model.id)&&this.viewer3DImpl.invalidate(!1,!0)),e.fragsLoaded===e.metadata.stats.num_fragments&&this.onOperationComplete()},k.prototype.trackFragmentListLoadProgress=function(){var e=this.svf;function t(e){return Math.floor(100*e.fragsLoadedNoGeom/e.metadata.stats.num_fragments)}var r=t(e);e.fragsLoadedNoGeom++;var n=t(e);n>r&&this.options.onFragmentListLoadProgress(this.model,n)},k.prototype.onOperationComplete=function(){this.operationsDone++,3===this.operationsDone&&this.onGeomLoadDone()},k.prototype.onMaterialLoaded=function(){var e=I(regeneratorRuntime.mark((function e(t,r,n){var i,o,a,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.loading){e.next=2;break}return e.abrupt("return");case 2:if(i=this.pendingMaterials[r]){e.next=5;break}return e.abrupt("return");case 5:if(o=this.viewer3DImpl.matman(),!t){e.next=21;break}return t.hash=r,e.prev=8,e.next=11,o.convertSharedMaterial(this.model,t,r);case 11:a=e.sent,s.TextureLoader.loadMaterialTextures(this.model,a,this.viewer3DImpl),o.hasTwoSidedMaterials()&&this.viewer3DImpl.renderer().toggleTwoSided(!0),e.next=19;break;case 16:e.prev=16,e.t0=e.catch(8),this.svf.failedMaterials[r]=1;case 19:e.next=22;break;case 21:this.svf.failedMaterials[r]=1;case 22:for(l=0;l<i.length;l++)this.tryToActivateFragment(i[l],"material");this.pendingMaterialsCount--,delete this.pendingMaterials[r];case 25:case"end":return e.stop()}}),e,this,[[8,16]])})));return function(t,r,n){return e.apply(this,arguments)}}(),k.prototype.findOrLoadMaterial=function(e,t,r){if(this.pendingMaterials[t])return!1;var n=this.svf;if(this.viewer3DImpl.matman().findMaterial(e,t))return!0;this.pendingMaterialsCount++,this.pendingMaterials[t]=[];var i=!!this.loadContext.otg_cdn,o=n.makeSharedResourcePath(this.loadContext.otg_cdn,"materials",t);return this.viewer3DImpl.geomCache().requestMaterial(o,i,t,r,this.queryParams),!1},k.prototype.loadGeometry=function(e,t){var r=this.svf,n=r.getGeometryHash(e);if(this.pendingMeshes[n])return this.pendingMeshes[n].push(t),!1;this.pendingMeshesCount++,this.pendingMeshes[n]=[t];var i=!!this.loadContext.otg_cdn;r.geomMetadata.hashToIndex[n]=e;var o=r.makeSharedResourcePath(this.loadContext.otg_cdn,"geometry",n);this.viewer3DImpl.geomCache().requestGeometry(o,i,n,e,this.queryParams)},k.prototype.onMeshError=function(e){var t=e.error.args.hash;this.svf.failedMeshes[t]=1;var r=this.pendingMeshes[t];if(r){for(var n=0;n<r.length;n++)this.trackGeomLoadProgress(this.svf,r[n],!0);delete this.svf.geomMetadata.hashToIndex[t],delete this.pendingMeshes[t],this.pendingMeshesCount--}},k.prototype.onMeshReceived=function(e){var t=this.model;if(t){var r=t.getGeometryList(),n=this.svf.geomMetadata.hashToIndex[e.hash];if(void 0!==n){var i=r.getGeometry(n),o=this.pendingMeshes[e.hash];if(!i){r.addGeometry(e,o&&o.length||1,n),this.svf.loadDone&&console.error("Geometry received after load was done");for(var a=0;a<o.length;a++)this.tryToActivateFragment(o[a],"geom");delete this.svf.geomMetadata.hashToIndex[e.hash],delete this.pendingMeshes[e.hash],this.pendingMeshesCount--}}}else console.warn("Received geometry after loader was done. Possibly leaked event listener?",e.hash)},k.prototype.onGeomLoadDone=function(){if(this.svf.loadDone=!0,this.removeMeshReceiveListener(),s.TextureLoader.loadModelTextures(this.model,this.viewer3DImpl),this.options.skipMeshLoad)return this.currentLoadPath=null,void this.viewer3DImpl.onLoadComplete(this.model);this.svf.fragments.entityIndexes=null,this.svf.fragments.mesh2frag=null,this.svf.geomMetadata.hashes=null;var e=Date.now(),t="Fragments load time: "+(e-this.t0);this.loadTime+=e-this.t0;var r=this.firstPixelTimestamp-this.t0;t+=" (first pixel time: "+r+")",a.logger.log(t),this.options.useConsolidation&&this.viewer3DImpl.consolidateModel(this.model,this.options.consolidationMemoryLimit);var n={category:"model_load_stats",is_f2d:!1,has_prism:this.viewer3DImpl.matman().hasPrism,load_time:this.loadTime,geometry_size:this.model.getGeometryList().geomMemory,meshes_count:this.svf.metadata.stats.num_geoms,fragments_count:this.svf.metadata.stats.num_fragments,urn:this.svfUrn};r>0&&(n.first_pixel_time=r),a.logger.track(n,!0);var i=this.model.getGeometryList(),o={load_time:this.loadTime,polygons:i.geomPolyCount,fragments:this.model.getFragmentList().getCount(),mem_usage:i.gpuMeshMemory,time_to_first_pixel:this.firstPixelTimestamp-this.t0,viewable_type:"3d"};N.analytics.track("viewer.model.loaded",o),this.currentLoadPath=null,this.viewer3DImpl.onLoadComplete(this.model)},k.prototype.loadPropertyDb=function(){this.svf.propDbLoader.load()},k.prototype.is3d=function(){return!0},k.loadOnlyOtgRoot=function(e,t){var r=F(e),n=U(t,r,V(t)),i=new A;i.basePath=r;var o=(0,f.pathToURL)(e);return new Promise((function(e){i.loadAsyncResource(n,o,"json",(function(t){i.metadata=t,i.manifest=t.manifest,i.numGeoms=i.metadata.stats.num_geoms,i.processMetadata(n),e(i)}))}))},k.prototype.waitForFragmentData=I(regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.fragmentDataLoaded){e.next=2;break}return e.abrupt("return",!0);case 2:return t=this.viewer3DImpl.api,r=this,e.next=6,new Promise((function(e){var n=function(){t.removeEventListener(O.MODEL_ROOT_LOADED_EVENT,i),t.removeEventListener(O.MODEL_UNLOADED_EVENT,o)},i=function(t){t.model.loader===r&&(n(),e(!0))},o=function(t){t.model.loader===r&&(n(),e(!1))};t.addEventListener(O.MODEL_ROOT_LOADED_EVENT,i),t.addEventListener(O.MODEL_UNLOADED_EVENT,o)}));case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e,this)}))),S.FileLoaderManager.registerFileLoader("json",["json"],k)},19115:(e,t,r)=>{"use strict";r.r(t),r.d(t,{MATERIAL_FAILED_EVENT:()=>w,MATERIAL_RECEIVE_EVENT:()=>E,MESH_FAILED_EVENT:()=>_,MESH_RECEIVE_EVENT:()=>x,OtgResourceCache:()=>C});var n=r(84998),i=r(25131),o=r(58092),a=r(58964),s=r(62546),l=r(37169),u=r(17167),c=r(73075),h=r(22585),d=r(29747),f=r(27820);function p(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function m(e,t,r){return Math.abs(e.x-t.x)<r&&Math.abs(e.y-t.y)<r&&Math.abs(e.z-t.z)<r}function g(e,t){return t.importance-e.importance}var v=new h.LmvBox3;function y(e,t,r){var n=function(e,t,r){var n=6*t;return r.min.y=e[n+1],r.min.z=e[n+2],r.min.x=e[n+0],r.max.x=e[n+3],r.max.y=e[n+4],r.max.z=e[n+5],r}(t,e,v),i=r.intersectsBox(n);if(i===d.OUTSIDE)return 0;var o=i===d.CONTAINS,a=r.projectedBoxArea(n,o),s=f.SceneMath.pointToBoxDistance2(r.eye,n);return a/(s=Math.max(s,.01))}var b=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.viewers=[],this.waitingTasks=[],this.urgentHashes={},this.prevNumTasks=0,this.fullSortDone=!1,this.lastCamPos={},this.lastCamTarget={},this.lastVisibleModelIds={}}var t,r,n;return t=e,(r=[{key:"addViewer",value:function(e){this.viewers.push(e),this.lastCamPos[e.id]=new c.LmvVector3,this.lastCamTarget[e.id]=new c.LmvVector3,this.lastVisibleModelIds[e.id]=[]}},{key:"removeViewer",value:function(e){var t=this.viewers.indexOf(e);-1!==t&&(delete this.lastCamPos[e.id],delete this.lastCamTarget[e.id],delete this.lastVisibleModelIds[e.id],this.viewers.splice(t,1))}},{key:"checkCameraChanged",value:function(){for(var e=!1,t=0;t<this.viewers.length;t++){var r=this.viewers[t],n=r.impl.camera,i=n.position,o=n.target;m(this.lastCamPos[r.id],i,.01)&&m(this.lastCamTarget[r.id],o,.01)||(this.lastCamPos[r.id].copy(i),this.lastCamTarget[r.id].copy(o),e=!0)}return e}},{key:"checkModelsChanged",value:function(){for(var e=!1,t=0;t<this.viewers.length;t++){var r=this.viewers[t],n=r.impl.modelQueue().getModels();n.length!==this.lastVisibleModelIds[r.id].length&&(this.lastVisibleModelIds[r.id].length=n.length,e=!0);for(var i=0;i<n.length;i++){var o=this.lastVisibleModelIds[r.id][i],a=n[i].id;o!==a&&(this.lastVisibleModelIds[r.id][i]=a,e=!0)}}return e}},{key:"validateRequestPriorities",value:function(){var e=this.checkCameraChanged(),t=this.checkModelsChanged();if(e||t)for(var r=0;r<this.waitingTasks.length;r++)this.waitingTasks[r].importanceNeedsUpdate=!0}},{key:"updateRequestPriorities",value:function(){var e=performance.now();this.validateRequestPriorities();for(var t={},r=[],n=0;n<this.viewers.length;n++){var i=(_=this.viewers[n]).impl.modelQueue(),o=i.frustum();r=r.concat(i.getModels()),o.reset(_.impl.camera),t[_.id]=o}var a=!1,s=0===this.prevNumTasks||this.waitingTasks.length-this.prevNumTasks>3e3||!this.fullSortDone;for(this.fullSortDone=!s,this.prevNumTasks=this.waitingTasks.length,n=0;n<this.waitingTasks.length;n++){var l=this.waitingTasks[n];if(l.importanceNeedsUpdate)if(this.urgentHashes[l.hash])l.importance=1/0;else{if(n%10==0&&performance.now()-e>10){a=!0;break}l.importanceNeedsUpdate=!1,l.importance=0;for(var u=0,c=l.hash,h=0;h<r.length;h++){var d=r[h];if(d.isOTG()){var f=d.myData,p=f.fragments,m=p.boxes,v=f.geomMetadata.hashToIndex[c];if(v&&p.mesh2frag)for(var b=p.mesh2frag[v],x=0;x<this.viewers.length;x++){var _;if(-1!==(_=this.viewers[x]).impl.modelQueue().getModels().indexOf(d))if("number"==typeof b)u+=y(b,m,t[_.id]);else if(Array.isArray(b))for(x=0;x<b.length;x++)u+=y(b[x],m,t[_.id])}}}if(l.importance=u,!s){for(h=n;h>0&&u>this.waitingTasks[h-1].importance;)this.waitingTasks[h]=this.waitingTasks[h-1],h--;this.waitingTasks[h]=l}}}return s&&!a&&(this.waitingTasks.sort(g),this.fullSortDone=!0),!a}},{key:"makeUrgent",value:function(e){var t=0;for(var r in e)!0===e[r]&&(this.urgentHashes[r]=!0,t++);if(0===t)return 0;for(var n=0;n<this.waitingTasks.length;n++){var i=this.waitingTasks[n];this.urgentHashes[i.hash]&&(i.importance=1/0)}return this.waitingTasks.sort(g),t}},{key:"removeUrgent",value:function(e){delete this.urgentHashes[e]}},{key:"addTask",value:function(e){this.waitingTasks.push(e)}},{key:"takeTask",value:function(){return this.waitingTasks.shift()}},{key:"isEmpty",value:function(){return 0===this.waitingTasks.length}}])&&p(t.prototype,r),n&&p(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}(),x="meshReceived",_="meshFailed",E="materialReceived",w="materialFailed",A="true"===(0,u.getParameterByName)("disableIndexedDb").toLowerCase()||(0,n.getGlobal)().DISABLE_INDEXED_DB,S="true"===(0,u.getParameterByName)("disableWebSocket").toLowerCase()||(0,n.getGlobal)().DISABLE_WEBSOCKET;function M(e){var t=(0,a.initLoadContext)(e);return t.disableIndexedDb=A,t.disableWebSocket=S,t.isInlineWorker=Autodesk.Viewing.Private.ENABLE_INLINE_WORKER,t}function T(e,t){return e.importance-t.importance}function C(){for(var e=new Map,t=new Map,r={},a=(0,n.isMobileDevice)()?2:8,s=[],u=0;u<a;u++)s.push((0,o.createWorkerWithIntercept)());this.initialized=!0,this.byteSize=0,this.refCount=0,this.requestsSent=0,this.requestsReceived=0;var c=0,h=void 0,d=new b,f=this,p=1048576,m=100*p,g=0,y=!1;function A(){y=!1}var S=[];function C(n){if(n.data)if(d.waitingTasks.length&&!h&&(h=setTimeout(D,0)),n.data.error){var o=n.data.error,a=o.args?o.args.hash:void 0,s=o.args?o.args.type:"g";a&&("m"===s?(t.set(a,o),f.fireEvent({type:w,error:o}),console.warn("Error loading material",a)):(e.set(a,o),f.fireEvent({type:_,error:o}),console.warn("Error loading mesh",a)),delete r[o.hash],c--,f.requestsReceived++)}else if(n.data.material){a=(m=n.data).hash;var l=m.material;t.set(a,l),f.fireEvent({type:E,material:l,hash:a}),delete r[m.hash],c--,f.requestsReceived++}else for(var u=n.data,p=0;p<u.length;p++){var m;if((m=u[p]).hash&&m.mesh){i.BufferGeometryUtils.meshToGeometry(m);a=m.hash;var g=m.geometry;e.set(a,g),f.byteSize+=g.byteSize,f.cleanup(),f.fireEvent({type:x,geom:g}),delete r[m.hash]}c--,f.requestsReceived++}}this.addViewer=function(e){e.addEventListener(l.MODEL_UNLOADED_EVENT,A),S.push(e),d.addViewer(e)},this.removeViewer=function(e){var t=S.indexOf(e);-1!==t&&(e.removeEventListener(l.MODEL_UNLOADED_EVENT,A),d.removeViewer(e),S.splice(t,1)),0===S.length&&this.dtor()},this.dtor=function(){S=[];for(var r=0;r<a;r++)s[r].clearAllEventListenerWithIntercept(),s[r].terminate();e=null,t=null,this.initialized=!1};for(u=0;u<a;u++)s[u].addEventListenerWithIntercept(C);function P(e){return"number"==typeof e?e%a:0|Math.random()*a}function D(){var e=100*a-c;if(0!==e){d.updateRequestPriorities()||(e=Math.min(e,10*a));for(var t=[],r=0;!d.isEmpty()&&r<e;){var n=d.takeTask(),i=P(n.geomIdx);(l=t[i])?(l.urls.push(n.url),l.hashes.push(n.hash)):(l={operation:"LOAD_CDN_RESOURCE_OTG",type:"g",urls:[n.url],hashes:[n.hash],isCDN:n.isCDN,queryParams:n.queryParams},t[i]=l),r++}for(var o=0;o<t.length;o++){var l;(l=t[o])&&(s[o].doOperation(M(l)),c+=l.urls.length,f.requestsSent+=l.urls.length)}h=void 0}else h=setTimeout(D,30)}this.initWorker=function(e){for(var t=0;t<a;t++){var r={operation:"INIT_WORKER_OTG",authorizeUrns:[e]};s[t].doOperation(M(r))}},this.updateMruTimestamps=function(){for(var e=0;e<a;e++){var t={operation:"UPDATE_MRU_TIMESTAMPS_OTG",endSession:d.isEmpty()};s[e].doOperation(M(t))}},this.requestGeometry=function(t,i,o,a,s){var l=this,u=e.get(o);if(u&&u.args)(0,n.isNodeJS)()?setImmediate((function(){return l.fireEvent({type:_,error:u,hash:o,repeated:!0})})):this.fireEvent({type:_,error:u,hash:o,repeated:!0});else if(u)(0,n.isNodeJS)()?setImmediate((function(){return l.fireEvent({type:x,geom:u})})):this.fireEvent({type:x,geom:u});else{var c=r[o];if(c&&c.refcount)return c.importanceNeedsUpdate=!0,void c.refcount++;var f={operation:"LOAD_CDN_RESOURCE_OTG",type:"g",url:t,isCDN:i,hash:o,queryParams:s,importance:0,geomIdx:a,importanceNeedsUpdate:!0,refcount:1};d.addTask(f),r[o]=f,h||(h=setTimeout(D,0))}},this.requestMaterial=function(e,n,i,o,a){var l=this,u=t.get(i);if(u&&u.args)setImmediate((function(){return l.fireEvent({type:w,error:u,hash:i,repeated:!0})}));else if(u)setImmediate((function(){return l.fireEvent({type:E,material:u,hash:i})}));else{var h=r[i];if(h&&h.refcount)h.refcount++;else{var d={operation:"LOAD_CDN_RESOURCE_OTG",type:"m",urls:[e],hashes:[i],isCDN:n,queryParams:a,refcount:1};r[i]=d;var f=P(o);s[f].doOperation(M(d)),c++,this.requestsSent++}}},this.cancelRequests=function(e){for(var t in e){var n=r[t];n&&n.refcount--}for(var i=[],o=0;o<d.waitingTasks.length;o++){var a=d.waitingTasks[o],s=r[a.hash];s&&s.refcount?i.push(a):delete r[a.hash]}d.waitingTasks=i},this.updateGeomImportance=function(e,t){return function(e,t){var r=e.getFragmentList(),n=r.getGeometry(t);if(r.getWorldBounds(t,v),n){var i,o,a,s,l=n.importance||0,u=2*((o=(i=v).max.x-i.min.x)*(a=i.max.y-i.min.y)+a*(s=i.max.z-i.min.z)+s*o);n.importance=Math.max(l,u)}}(e,t)},this.cleanup=function(){var t=[];if(!(this.byteSize<m)){for(var r=[],n=0;n<S.length;n++){var i=S[n].impl.modelQueue();r=r.concat(i.getModels().concat(S[n].getHiddenModels()))}if(!y){g++;for(n=0;n<r.length;n++){var o=r[n],a=o.getData();if(o.isOTG()){var s=a.geomMetadata.hashes;if(s)for(var l=s.length/a.geomMetadata.byteStride,u=1;u<l;u++){var c=a.getGeometryHash(u);(h=e.get(c))&&(h.timeStamp=g)}}}for(var c in t.length>0&&console.warn("OtgResourceCache.cleanup(): array must be empty"),e){(h=e.get(c)).timeStamp!==g&&t.push(h)}t.sort(T);for(n=0;n<t.length&&this.byteSize>=52428800;n++){var h=t[n];e.delete(h.hash),this.byteSize-=h.byteSize,h.dispose()}n===t.length&&(y=!0),t.length=0}}},this.waitForGeometry=function(t,r){var n=0,i=d.makeUrgent(t);if(0===i&&t)r(t);else for(var o in D(),this.addEventListener(x,l),this.addEventListener(_,u),t){var a=e.get(o);a&&s(o,a)}function s(e,o){d.removeUrgent(e),!0!=!t[e]&&(t[e]=o,++n<i||(f.removeEventListener(x,l),f.removeEventListener(_,u),r(t)))}function l(e){s(e.geom.hash,e.geom)}function u(e){s(e.error.args.hash,void 0)}},this.getGeometry=function(t){return e.get(t)},this.reportLoadingState=function(){console.log("OtgResourceCache:",{sent:this.requestsSent,received:this.requestsReceived});for(var e=0;e<s.length;e++){var t={operation:"REPORT_LOADING_STATE",workerIndex:e};s[e].doOperation(M(t))}}}s.EventDispatcher.prototype.apply(C.prototype)},8283:(e,t,r)=>{"use strict";r.r(t),r.d(t,{getPropWorker:()=>E,shutdownPropWorker:()=>w,clearPropertyWorkerCache:()=>A,PropDbLoader:()=>P});var n=r(98926),i=r(57601),o=r(79659),a=r(37169),s=r(58964),l=r(1840),u=r(6420),c=r(58092),h=r(62546);function d(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function f(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var p,m="GET_PROPERTIES",g="GET_PROPERTY_SET",v="UNLOAD_PROPERTYDB",y=1,b={};function x(e){var t=e.data;if(t&&t.debug)n.logger.debug(t.message);else{var r=t&&t.cbId&&b[t.cbId];r&&(t.progress?r[2]&&r[2](t.progress):(t.error?r[1]&&r[1](t.error):r[0]&&r[0](t.result),delete b[t.cbId]))}}function _(e,t,r){var n=y++;return b[n]=[e,t,r],n}function E(){return p}function w(){p&&(p.clearAllEventListenerWithIntercept(),p.terminate(),p=void 0)}function A(){p&&p.doOperation({operation:v,clearCaches:!0})}var S=0,M=1,T=2,C=3,P=function(e,t,r){var o,a,s,l;this.eventTarget=r||new h.EventDispatcher,this.model=t,this.svf=t&&t.getData(),this.dbPath="",this.sharedDbPath=!1;var u=this.svf&&this.svf.loadOptions.bubbleNode&&this.svf.loadOptions.bubbleNode.findViewableParent()._getOtgManifest(),c=u&&this.svf&&this.svf.is2d;if(this.svf&&!c&&this.svf.propertydb&&this.svf.propertydb.avs.length){for(var d in this.dbFiles=this.svf.propertydb,this.dbFiles)this.dbFiles[d][0]&&(this.dbFiles[d][0].path=this.dbFiles[d][0].path.replace(/\\/g,"/"));var f=(0,i.pathToURL)(this.svf.basePath);if(e){var p=i.ViewingService.simplifyPath(f+this.svf.propertydb.avs[0].path);if((p=p.slice(0,p.lastIndexOf("/")+1))===e){var m={};for(var g in this.dbFiles){var v=this.dbFiles[g][0],y=v.path;0===(y=i.ViewingService.simplifyPath(f+y)).indexOf(e)&&(y=y.slice(e.length)),m[g]=[{path:y,isShared:v.isShared}]}this.dbFiles=m,this.dbPath=e,this.sharedDbPath=!0}else this.dbPath=f,this.sharedDbPath=!1}else this.dbPath=f,this.sharedDbPath=!1}else{if(this.sharedDbPath=!0,this.svf&&this.svf.loadOptions.bubbleNode){this.dbPath=e;var b=this.svf.loadOptions.bubbleNode.getPropertyDbManifest();this.dbFiles=b.propertydb,this.needsDbIdRemap=b.needsDbIdRemap}else n.logger.warn("Deprecated shared property database initialization without bubbleNode in Model load options."),this.dbPath=e,this.dbFiles={attrs:[],avs:[],ids:[],values:[],offsets:[]};n.logger.log("Using shared db path "+e)}u&&(this.needsDbIdRemap=this.svf.loadOptions.needsDbIdRemap||this.needsDbIdRemap),this.queryParams="";var x=null===(o=this.model)||void 0===o||null===(a=o.getDocumentNode())||void 0===a||null===(s=a.getDocument())||void 0===s?void 0:s.getAcmSessionId(this.dbPath);x=x||(null===(l=this.svf)||void 0===l?void 0:l.acmSessionId),this.svf&&x&&(this.queryParams="acmsession="+x),this.loadProgress=0,this.cbId=void 0,this.idLoadState=S,this.waitingForExternalIds=[]};P.prototype.dtor=function(){this.asyncPropertyOperation({operation:v},(function(){}),(function(){}));var e,t=Boolean(this.cbId),r=this.instanceTree||this.propertyDbError;t&&!r&&(e=this.cbId,delete b[e],this.propertyDbError={propDbWasUnloaded:!0},this.eventTarget.dispatchEvent({type:a.OBJECT_TREE_UNAVAILABLE_EVENT,svf:this.svf,model:this.model,target:this})),this.model=null,this.svf=null},P.prototype.processLoadResult=function(e){var t=this;if(e.instanceTreeStorage){var r=new u.InstanceTreeAccess(e.instanceTreeStorage,e.rootId,e.instanceBoxes);t.instanceTree=new l.InstanceTree(r,e.objectCount,e.maxTreeDepth),t.svf&&(t.svf.instanceTree=t.instanceTree,t.instanceTree.setFragmentList(t.model.getFragmentList()))}e.objectCount&&(t.hasObjectProperties=e.objectCount,t.svf&&(t.svf.hasObjectProperties=e.objectCount)),e.dbidOldToNew&&this.model.setDbIdRemap(e.dbidOldToNew),t.onLoadProgress(100),t.eventTarget.dispatchEvent({type:a.OBJECT_TREE_CREATED_EVENT,svf:t.svf,model:t.model,target:t})},P.prototype.processLoadError=function(e){var t=this;t.propertyDbError=e,t.onLoadProgress(100),t.eventTarget.dispatchEvent({type:a.OBJECT_TREE_UNAVAILABLE_EVENT,svf:t.svf,model:t.model,target:t})},P.prototype.load=function(e){var t=this;e=e||{},p||(p=(0,c.createWorkerWithIntercept)(!0)).addEventListenerWithIntercept(x);this.cbId=_((function(e){t.processLoadResult(e)}),(function(e){t.processLoadError(e)}),(function(e){t.onLoadProgress(e.percent)}));var r=this.svf&&this.svf.loadOptions,n=!(r&&r.disablePrecomputedNodeBoxes),i=!(!r||!r.skipExternalIds);i||(this.idLoadState=M);var o=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?d(Object(r),!0).forEach((function(t){f(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({operation:this.svf&&this.svf.instanceTree&&this.svf.instanceBoxes?"CREATE_TREE":"LOAD_PROPERTYDB",dbPath:this.dbPath,sharedDbPath:this.sharedDbPath,propertydb:this.dbFiles,fragToDbId:this.svf&&this.svf.fragments.fragId2dbId,fragBoxes:n&&this.svf&&this.svf.fragments.boxes,needsDbIdRemap:this.needsDbIdRemap,is2d:this.svf&&this.svf.is2d,cbId:this.cbId,queryParams:this.queryParams,skipExternalIds:i,gltfTree:this.svf.instanceTree,dbToFragId:this.svf&&this.svf.fragments.dbToFragId},e);p.doOperation((0,s.initLoadContext)(o))},P.prototype.asyncPropertyOperation=function(e,t,r,n){var i=this;if(e.dbPath=this.dbPath,i.instanceTree||i.hasObjectProperties)e.cbId=_(t,r,n),p.doOperation(e);else if(i.propertyDbError)r&&r(i.propertyDbError);else{var s=function s(l){i.model===l.model&&(i.eventTarget.removeEventListener(a.OBJECT_TREE_CREATED_EVENT,s),i.eventTarget.removeEventListener(a.OBJECT_TREE_UNAVAILABLE_EVENT,s),i.instanceTree||i.hasObjectProperties||i.propertyDbError?i.asyncPropertyOperation(e,t,r,n):r&&r({code:o.ErrorCodes.UNKNOWN_FAILURE,msg:"Failed to load properties"}))};i.eventTarget.addEventListener(a.OBJECT_TREE_CREATED_EVENT,s),i.eventTarget.addEventListener(a.OBJECT_TREE_UNAVAILABLE_EVENT,s)}},P.prototype.getProperties=function(e,t,r){this.idLoadState===S&&n.logger.warn("Calling getProperties() will cause loading of the potentially large externalIDs file. Use getProperties2() to avoid this warning."),this.getProperties2(e,t,r,{needsExternalId:!0})},P.prototype.getProperties2=function(e,t,r,n){var i=this,o=function(){i.asyncPropertyOperation({operation:m,dbId:e,gltfTree:i.svf&&i.svf.instanceTreeBackup},t,r)};n&&n.needsExternalId?this.loadExternalIds().then(o).catch(r):o()},P.prototype.getBulkProperties=function(e,t,r,i,o){var a={ignoreHidden:o,propFilter:t,needsExternalId:!t||t.includes("externalId")};a.needsExternalId&&this.idLoadState===S&&n.logger.warn("Calling getProperties() will cause loading of the potentially large externalIDs file. Use getProperties2() to avoid this warning."),this.getBulkProperties2(e,a,r,i)},P.prototype.getBulkProperties2=function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,o=function(){t.asyncPropertyOperation({operation:m,dbIds:e,propFilter:r.propFilter,categoryFilter:r.categoryFilter,ignoreHidden:r.ignoreHidden},n,i)};r&&r.needsExternalId?this.loadExternalIds().then(o).catch(i):o()},P.prototype.getPropertySet=function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,o=function(){t.asyncPropertyOperation({operation:g,dbIds:e,propFilter:r.propFilter,ignoreHidden:r.ignoreHidden,fileType:r.fileType},n,i)};r&&r.needsExternalId?this.loadExternalIds().then(o).catch(i):o()},P.prototype.searchProperties=function(e,t,r,n,i){this.asyncPropertyOperation({operation:"SEARCH_PROPERTIES",searchText:e,attributeNames:t,searchOptions:i},r,n)},P.prototype.findProperty=function(e){var t=this;return new Promise((function(r,n){t.asyncPropertyOperation({operation:"FIND_PROPERTY",propertyName:e},r,n)}))},P.prototype.diffProperties=function(e,t,r,n,i){this.asyncPropertyOperation({operation:"DIFF_PROPERTIES",dbPath2:e,diffOptions:n},t,r,i)},P.prototype.findLayers=function(){var e=this;return new Promise((function(t,r){e.asyncPropertyOperation({operation:"FIND_LAYERS"},t,r)}))},P.prototype.getExternalIdMapping=function(e,t,r){var n=this;return this.loadExternalIds().then((function(){n.asyncPropertyOperation({operation:"BUILD_EXTERNAL_ID_MAPPING",extIdFilter:r},e,t)}))},P.prototype.getLayerToNodeIdMapping=function(e,t){this.asyncPropertyOperation({operation:"BUILD_LAYER_TO_NODE_ID_MAPPING"},e,t)},P.prototype.executeUserFunction=function(e,t){var r,n=this;if("function"==typeof e)e=e.toString();else if("string"!=typeof e)return Promise.reject("Expected Function or string.");try{r=new Blob([e],{type:"application/javascript"})}catch(t){var i=new BlobBuilder;i.append(e),r=i.getBlob()}var o=URL.createObjectURL(r);return new Promise((function(e,r){n.asyncPropertyOperation({operation:"USER_FUNCTION",userFunction:o,userData:t},e,r)}))},P.prototype.isObjectTreeLoaded=function(){return!!this.instanceTree},P.prototype.getObjectTree=function(e,t){var r=this;if(r.instanceTree)e(r.instanceTree);else if(r.propertyDbError)t&&t(r.propertyDbError);else if("hasObjectProperties"in r)r.svf&&r.svf.is2d&&t?t("F2D files do not have an InstanceTree."):e(null);else{var n=function n(){r.eventTarget.removeEventListener(a.OBJECT_TREE_CREATED_EVENT,n),r.eventTarget.removeEventListener(a.OBJECT_TREE_UNAVAILABLE_EVENT,n),r.getObjectTree(e,t)};r.eventTarget.addEventListener(a.OBJECT_TREE_CREATED_EVENT,n),r.eventTarget.addEventListener(a.OBJECT_TREE_UNAVAILABLE_EVENT,n)}},P.prototype.onLoadProgress=function(e){this.eventTarget.dispatchEvent({type:a.OBJECT_TREE_LOAD_PROGRESS_EVENT,percent:e,svf:this.svf,model:this.model,target:this}),this.loadProgress=e},P.prototype.getLoadProgress=function(){return this.loadProgress},P.prototype.isLoadDone=function(){return 100==this.loadProgress},P.prototype.loadExternalIds=function(){var e=this;switch(this.idLoadState){case M:return Promise.resolve();case C:return Promise.reject();case S:this.idLoadState=T;var t={operation:"LOAD_EXTERNAL_IDS",idsFile:this.dbFiles.ids[0],queryParams:this.queryParams};(0,s.initLoadContext)(t),this.asyncPropertyOperation(t,(function(){e.idLoadState=M,e.waitingForExternalIds.forEach((function(e){return e.resolve()}))}),(function(){e.idLoadState=C,e.waitingForExternalIds.forEach((function(e){return e.reject()}))}))}return new Promise((function(t,r){e.waitingForExternalIds.push({resolve:t,reject:r})}))}},33450:(e,t,r)=>{"use strict";r.r(t),r.d(t,{SvfLoader:()=>M});var n=r(84998),i=r(98926),o=r(43586),a=r(79659),s=r(26245),l=r(46759),u=r(25131),c=r(88715),h=r(57601),d=r(8283),f=r(50005),p=r(58092),m=r(37169),g=r(83161),v=r(23909),y=r(50411),b=r(58964),x=r(18588);function _(e,t,r,n,i,o,a){try{var s=e[o](a),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,i)}function E(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function a(e){_(o,n,i,a,s,"next",e)}function s(e){_(o,n,i,a,s,"throw",e)}a(void 0)}))}}var w=Autodesk.Viewing,A=w.Private,S=(0,n.isNodeJS)()?10:(0,n.isMobileDevice)()?2:6,M=function(e){this.viewer3DImpl=e,this.next_pack=0,this.loading=!1,this.loadedPacksCount=0,this.tmpMatrix=new v.Matrix4,this.tmpBox=new v.Box3,this.fetchingTopology=!1,this.loadTime=0,this.notifiesFirstPixel=!0};M.prototype.dtor=function(){if(this.initWorkerScriptToken&&(this.initWorkerScriptToken.cancel(),this.initWorkerScriptToken=null,i.logger.debug("SVF loader dtor: on init worker script.")),this.svfWorker&&(this.svfWorker.clearAllEventListenerWithIntercept(),this.svfWorker.terminate(),this.svfWorker=null,i.logger.debug("SVF loader dtor: on svf worker.")),this.pack_workers){for(var e=0;e<this.pack_workers.length;e++)this.pack_workers[e].clearAllEventListenerWithIntercept(),this.pack_workers[e].terminate();this.pack_workers=null,i.logger.debug("SVF loader dtor: on geom worker.")}this.svf&&this.svf.propDbLoader&&(this.svf.propDbLoader.dtor(),this.svf.propDbLoader=null),this.tmpMatrix=null,this.tmpBox=null,this.svf=null,this.model=null,this.next_pack=0,this.loading=!1,this.loadedPacksCount=0,this.loadTime=0,this.viewer3DImpl=null},M.prototype.initWorkerScript=p.initWorkerScript,M.prototype.createWorkerWithIntercept=p.createWorkerWithIntercept,M.prototype.startWorkers=function(){for(var e=this,t=this.svf,r=Math.min(t.geompacks.length,w.NUM_WORKER_THREADS||S),i=0;i<r;i++){var o=t.geompacks[this.next_pack++];o.loading=!0,(0,n.isNodeJS)()?this.loadGeometryPack(o.id,o.uri):function(t){setTimeout((function(){e.loadGeometryPack(t.id,t.uri)}),200*i)}(o)}},M.prototype.createModel=function(e){var t=this.model=new g.Model(e);return t.loader=this,t.initialize(),t},M.prototype.isValid=function(){return this.viewer3DImpl},M.prototype.loadFile=function(e,t,r,n){if(!this.viewer3DImpl)return i.logger.log("SVF loader was already destructed. So no longer usable."),!1;if(this.loading)return i.logger.log("Loading of SVF already in progress. Ignoring new request."),!1;this.loading=!0;var o=e.indexOf("urn:");if(-1!=o){var a=(e=decodeURIComponent(e)).substr(o,e.substr(o).indexOf("/"));i.logger.log("Extracted URN: "+a);var s=a.lastIndexOf(":");this.svfUrn=a.substr(s+1)}else this.svfUrn=e;this.sharedDbPath=t.sharedPropertyDbPath,this.currentLoadPath=e;var l=this.currentLoadPath.lastIndexOf("/");-1!=l&&(this.basePath=this.currentLoadPath.substr(0,l+1)),this.acmSessionId=t.acmSessionId,this.queryParams="",this.acmSessionId&&(this.queryParams="acmsession="+this.acmSessionId),this.options=t;var u=this;return this.initWorkerScriptToken=this.initWorkerScript((function(){u.loadSvfCB(e,t,r,n)})),!0},M.prototype.loadSvfCB=function(e,t,r,o){this.t0=(new Date).getTime(),this.firstPixelTimestamp=null,this.failedToLoadSomeGeometryPacks=null,this.failedToLoadPacksCount=0;var l=!0,u=this,c={url:(0,h.pathToURL)(e),basePath:this.currentLoadPath,objectIds:t.ids,globalOffset:t.globalOffset,fragmentTransformsDouble:t.fragmentTransformsDouble,placementTransform:t.placementTransform,applyRefPoint:t.applyRefPoint,queryParams:this.queryParams,bvhOptions:t.bvhOptions||{isWeakDevice:(0,n.isMobileDevice)()},applyScaling:t.applyScaling,applyPlacementInModelUnits:t.applyPlacementInModelUnits,loadInstanceTree:t.loadInstanceTree};this.viewer3DImpl._signalNoMeshes();var d=this.svfWorker=this.createWorkerWithIntercept(),f=function(){var e=E(regeneratorRuntime.mark((function e(t){var n,h,f;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=function(){d.clearAllEventListenerWithIntercept(),d.terminate(),u.svfWorker=null,d=null},l&&o&&(l=!1,o()),!t.data||!t.data.manifest){e.next=9;break}u.interceptManifest(t.data.manifest),c.operation="LOAD_SVF_CONTD",c.manifest=t.data.manifest,d.doOperation(c),e.next=26;break;case 9:if(!t.data||!t.data.svf){e.next=25;break}return h=u.svf=t.data.svf,u.failedToLoadSomeGeometryPacks&&(r&&r(u.failedToLoadSomeGeometryPacks),u.failedToLoadSomeGeometryPacks=null),e.next=14,u.onModelRootLoadDone(h);case 14:r&&r(null,u.model),u.viewer3DImpl.api.dispatchEvent({type:m.MODEL_ROOT_LOADED_EVENT,svf:h,model:u.model}),h.loadDone=!1,f=!1,h.metadata&&h.metadata.gltf&&(f=!0),f||(0==h.geompacks.length?u.onGeomLoadDone():u.startWorkers()),1==t.data.progress&&(u.loading=!1,n()),h.fragments.polygonCounts||(h.fragments.polygonCounts=new Int32Array(h.fragments.length)),t.data.bvh&&(h.bvh=t.data.bvh,u.model.setBVH(new s.NodeArray(h.bvh.nodes,h.bvh.useLeanNodes),h.bvh.primitives,u.options.bvhOptions),u.viewer3DImpl.invalidate(!1,!0)),e.next=26;break;case 25:t.data&&t.data.bvh?(u.svf&&!u.svf.bvh&&(u.svf.bvh=t.data.bvh,u.model.setBVH(new s.NodeArray(u.svf.bvh.nodes,u.svf.bvh.useLeanNodes),u.svf.bvh.primitives,u.options.bvhOptions),u.viewer3DImpl.invalidate(!1,!0)),u.loading=!1,n()):t.data&&t.data.mesh?(u.processReceivedMesh(t.data),1===t.data.progress&&(u.onGeomLoadDone(),u.loading=!1,n())):t.data&&t.data.progress?1==t.data.progress&&(u.loading=!1,n()):t.data&&t.data.error?(u.loading=!1,n(),i.logger.error("Error while processing SVF: "+JSON.stringify(t.data.error.args)),r&&r(t.data.error,null)):t.data&&t.data.debug?i.logger.debug(t.data.message):(i.logger.error("SVF download failed.",(0,a.errorCodeString)(a.ErrorCodes.NETWORK_FAILURE)),u.loading=!1,n());case 26:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return d.addEventListenerWithIntercept(f),c.operation="LOAD_SVF",c.interceptManifest=!!this.interceptManifest,d.doOperation((0,b.initLoadContext)(c)),!0},M.prototype.loadGeometryPack=function(e,t){var r,n,o,a,s=this;if(this.svf&&this.isValid()){var l=this.pack_workers;if(l||(l=this.pack_workers=[]),l.length<(w.NUM_WORKER_THREADS||S)){var u=!0;for(o=0;o<l.length;o++)if(0===l[o].queued){u=!1;break}if(u){var c=this.createWorkerWithIntercept();c.addEventListenerWithIntercept((function(e){if(e.data&&e.data.meshes){for(var t=e.data.meshes,r={packId:e.data.packId,meshIndex:0,mesh:null},n=0;n<t.length;n++){var o=t[n];o&&(r.meshIndex=n,r.mesh=o,s.processReceivedMesh(r))}if(e.data.progress>=1){s.pack_workers[e.data.workerId].queued-=1,s.loadedPacksCount++,s.viewer3DImpl.signalProgress(100*s.loadedPacksCount/s.svf.geompacks.length,x.ProgressState.LOADING,s.model);var l=!0;for(a=0;a<s.pack_workers.length;a++)if(0!=s.pack_workers[a].queued){l=!1;break}if(l){for(a=0;a<s.pack_workers.length;a++)s.pack_workers[a].clearAllEventListenerWithIntercept(),s.pack_workers[a].terminate();s.pack_workers=null}s.loadedPacksCount+s.failedToLoadPacksCount==s.svf.geompacks.length&&s.onGeomLoadDone()}}else if(e.data&&e.data.progress){if(s.pack_workers[e.data.workerId].queued-=1,s.next_pack<s.svf.geompacks.length){var u=null;if(!u||u.loading)for(;s.next_pack<s.svf.geompacks.length&&(u=s.svf.geompacks[s.next_pack++]).loading;);u&&!u.loading?(u.loading=!0,s.loadGeometryPack(u.id,u.uri)):(s.viewer3DImpl.modelQueue().enforceBvh=!1,s.svf.fragments.packIds=null)}}else e.data&&e.data.debug?i.logger.debug(e.data.message):e.data&&e.data.error?(++s.failedToLoadPacksCount,s.failedToLoadSomeGeometryPacks={code:e.data.error.code,msg:e.data.error.msg}):s.pack_workers[e.data.workerId].queued-=2})),c.queued=0,l.push(c)}}var d=0,f=l[0].queued;for(o=1;o<l.length;o++)l[o].queued<f&&(d=o,f=l[o].queued);(r=l[d]).queued+=2,n=d;var p={operation:"LOAD_GEOMETRY",url:(0,h.pathToURL)(this.svf.basePath+t),packId:parseInt(e),workerId:n,createWireframe:this.options.createWireframe||this.model.getMetadata("renderEnvironmentDisplayEdges","value",!1),packNormals:this.options.packNormals,queryParams:this.queryParams};r.doOperation((0,b.initLoadContext)(p))}},M.prototype.processReceivedMesh=function(e){var t=e.packId+":"+e.meshIndex,r=this.svf,n=r.fragments,o=this.model,a=n.mesh2frag[t];if(void 0!==a){Array.isArray(a)||(a=[a]),u.BufferGeometryUtils.meshToGeometry(e),e.geometry.packId=e.packId;for(var s=a.length,c=o.getFragmentList().getGeometryId(a[0]),h=o.getGeometryList().addGeometry(e.geometry,s,c),d=(e.geometry.index.array||e.geometry.ib).length/3,p=0;p<a.length;p++){var m=0|a[p];if(r.loadOptions.skipHiddenFragments)if(!(n.visibilityFlags[m]&l.MeshFlags.MESH_VISIBLE))continue;o.getFragmentList().getOriginalWorldMatrix(m,this.tmpMatrix);var g=n.materials[m].toString(),v=this.viewer3DImpl.matman().findMaterial(o,g);v&&!v.texturesLoaded&&f.TextureLoader.loadMaterialTextures(o,v,this.viewer3DImpl),n.polygonCounts&&(n.polygonCounts[m]=d);var y=this.viewer3DImpl.setupMesh(this.model,e.geometry,g,this.tmpMatrix);o.activateFragment(m,y,!!r.placementTransform)}this.options.onMeshReceived&&this.options.onMeshReceived(this.model,h,a),n.mesh2frag[t]=null,n.numLoaded+=a.length,this.viewer3DImpl._signalMeshAvailable(),o.getGeometryList().geomPolyCount>r.nextRepaintPolys&&(this.firstPixelTimestamp=this.firstPixelTimestamp||Date.now(),r.numRepaints++,r.nextRepaintPolys+=1e4*Math.pow(1.5,r.numRepaints),this.viewer3DImpl.invalidate(!1,!0))}else i.logger.warn("Mesh "+t+" was not referenced by any fragments.")},M.prototype.onModelRootLoadDone=function(){var e=E(regeneratorRuntime.mark((function e(t){var r,a,s,l,u,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.geomMemory=0,t.fragments.numLoaded=0,t.gpuNumMeshes=0,t.gpuMeshMemory=0,t.nextRepaintPolys=0,t.numRepaints=0,t.urn=this.svfUrn,t.acmSessionId=this.acmSessionId,t.basePath=this.basePath,t.loadOptions=this.options,t.verylargebbox&&this.viewer3DImpl.setNearRadius(this.options.nearRadius||1),r=Date.now(),this.loadTime+=r-this.t0,i.logger.log("SVF load: "+(r-this.t0)),a=this.createModel(t),this.options.skipPropertyDb||this.loadPropertyDb(),e.next=18,this.convertMaterials(a);case 18:if(s=e.sent,this.viewer3DImpl.matman().hasTwoSidedMaterials()&&this.viewer3DImpl.renderer().toggleTwoSided(!0),this.t1=r,t.bbox=(new v.Box3).copy(t.bbox),t.refPointTransform&&(t.refPointTransform=new o.LmvMatrix4(!0).copy(t.refPointTransform)),t.placementTransform&&(t.placementTransform=new o.LmvMatrix4(!0).copy(t.placementTransform)),t.placementWithOffset&&(t.placementWithOffset=new o.LmvMatrix4(!0).copy(t.placementWithOffset)),t.cameras)for(l=0;l<t.cameras.length;l++)(u=t.cameras[l]).position=(new v.Vector3).copy(u.position),u.target=(new v.Vector3).copy(u.target),u.up=(new v.Vector3).copy(u.up),isFinite(u.position.x+u.position.y+u.position.z+u.target.x+u.target.y+u.target.z+u.up.x+u.up.y+u.up.z)||(u.target=t.bbox.getCenter(new v.Vector3),u.position.copy(u.target),u.position.z+=t.bbox.max.z-t.bbox.min.z,u.up={x:0,y:1,z:0}),isFinite(u.aspect)||(u.aspect=1),isFinite(u.fov)||(u.fov=90),isFinite(u.orthoScale)||(u.orthoScale=1);i.logger.log("scene bounds: "+JSON.stringify(t.bbox)),c={category:"metadata_load_stats",urn:t.urn,has_topology:!!t.topologyPath,has_animations:!!t.animations,cameras:t.cameras?t.cameras.length:0,lights:t.lights?t.lights.length:0,materials:s,is_mobile:(0,n.isMobileDevice)()},i.logger.track(c),this.viewer3DImpl.signalProgress(5,x.ProgressState.ROOT_LOADED,this.model),this.viewer3DImpl.invalidate(!1,!1);case 31:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),M.prototype.convertMaterials=function(){var e=E(regeneratorRuntime.mark((function e(t){var r,n,i,o,a,s,l,u,h,d,f,p;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.viewer3DImpl.matman(),n=t.getData(),i=0,n.materials){e.next=5;break}return e.abrupt("return",i);case 5:if(!n.gltfMaterials){e.next=9;break}for(o in a=n.materials.materials)s=a[o],l=c.MaterialConverter.convertMaterialGltf(s,n),u=r._getMaterialHash(t,o),r.addMaterial(u,l,!1),i++;return e.abrupt("return",i);case 9:h=n.materials.materials,d=n.proteinMaterials?n.proteinMaterials.materials:null,e.t0=regeneratorRuntime.keys(h);case 12:if((e.t1=e.t0()).done){e.next=21;break}return o=e.t1.value,f=d&&d[o]&&c.MaterialConverter.isPrismMaterial(d[o]),p=f?d[o]:h[o],e.next=18,r.convertOneMaterial(t,p,r._getMaterialHash(t,o));case 18:i++,e.next=12;break;case 21:return e.abrupt("return",i);case 22:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),M.prototype.makeBVH=function(e){var t=performance.now(),r=e.materials?e.materials.materials:null;e.bvh=new s.BVHBuilder(e.fragments,r),e.bvh.build(this.options.bvhOptions||{isWeakDevice:(0,n.isMobileDevice)()});var o=performance.now();i.logger.log("BVH build time: "+(o-t))},M.prototype.onGeomLoadDone=function(){this.svf.loadDone=!0,f.TextureLoader.loadModelTextures(this.model,this.viewer3DImpl),this.svf.fragments.entityIndexes=null,this.svf.fragments.mesh2frag=null,this.svf.fragments.visibilityFlags=null;var e=Date.now(),t="Fragments load time: "+(e-this.t1);this.loadTime+=e-this.t0;var r=this.firstPixelTimestamp-this.t0;t+=" (first pixel time: "+r+")",this.svf.bvh&&!this.svf.placementTransform||(this.makeBVH(this.svf),this.model.setBVH(this.svf.bvh.nodes,this.svf.bvh.primitives,this.options.bvhOptions)),i.logger.log(t),this.options.useConsolidation&&this.viewer3DImpl.consolidateModel(this.model,this.options.consolidationMemoryLimit);var n={category:"model_load_stats",is_f2d:!1,has_prism:this.viewer3DImpl.matman().hasPrism,load_time:this.loadTime,geometry_size:this.model.getGeometryList().geomMemory,meshes_count:this.model.getGeometryList().geoms.length,fragments_count:this.model.getFragmentList().getCount(),urn:this.svfUrn};r>0&&(n.first_pixel_time=r),i.logger.track(n,!0);var o=this.model.getGeometryList(),a={load_time:this.loadTime,polygons:o.geomPolyCount,fragments:this.model.getFragmentList().getCount(),mem_usage:o.gpuMeshMemory,viewable_type:"3d"};A.analytics.track("viewer.model.loaded",a),this.currentLoadPath=null,this.viewer3DImpl.onLoadComplete(this.model)},M.prototype.loadPropertyDb=function(){this.svf.propDbLoader=new d.PropDbLoader(this.sharedDbPath,this.model,this.viewer3DImpl.api),this.svf.propDbLoader.load()},M.prototype.fetchTopologyFile=function(e,t){if(!this.fetchingTopology){this.fetchingTopology=!0;var r=this.createWorkerWithIntercept();r.addEventListenerWithIntercept((function(e){if(e.data["status-topology"])return n=(new Date).getTime(),a=Math.round((n-l)/1e3),void i.logger.log("Topology file downloaded. ("+a+" seconds). Processing...");var s=e.data["fetch-topology"];s&&(o=(new Date).getTime(),a=Math.round((o-n)/1e3),s.topology?i.logger.log("Topology file processed successfully! ("+a+" seconds)."):i.logger.log("Topology file processed, but an error ocurred. ("+a+" seconds)."),t(s),u.fetchingTopology=!1,r.clearAllEventListenerWithIntercept(),r.terminate(),r=null)}));var n,o,a,s={path:e,queryParams:this.queryParams},l=(new Date).getTime();i.logger.log("Fetching topology file..."),s.operation="FETCH_TOPOLOGY",r.doOperation((0,b.initLoadContext)(s));var u=this}},M.prototype.is3d=function(){return!0},y.FileLoaderManager.registerFileLoader("svf",["svf"],M)},50005:(e,t,r)=>{"use strict";r.r(t),r.d(t,{TextureLoader:()=>M});var n=r(57601),i=r(84998),o=r(79659),a=r(88715),s=r(4388),l=r(98926),u=r(23909),c=r(90050),h=r(58964),d=r(79916),f=(0,i.getGlobal)(),p=f.document,m=new d;m.max=(0,i.isMobileDevice)()?4:6;var g=0,v=(0,i.isMobileDevice)()?32:1/0;v*=1048576;var y=0,b=1/0,x=function(e,t,r,n){u.ImageUtils.loadTexture(e,t,r,n)};function _(e,t,r,a,s,d,v){var y=h.endpoint.getUseCredentials(),_=h.endpoint.getUseCookie();y&&_?u.ImageUtils.crossOrigin="use-credentials":h.endpoint.getUseCredentials()?u.ImageUtils.crossOrigin="anonymous":u.ImageUtils.crossOrigin="";var E="";y&&s&&(E="acmsession="+s),v&&v.queryParams&&(E=E?E+"&":"",E+=v.queryParams);var w=h.endpoint.initLoadContext({queryParams:E});g++,m.go((function(s){var h=function(e,t){g--,t&&a?a(t):r(e),s()},m=d?h:function(e){function t(t){e&&(e.image=t),g--,r(e),s()}e&&e.image?function(e,t){var r,n,i=e.width,a=e.height;if(0==(i&i-1)&&0==(a&a-1)){if(i*a<=b)return void t(e);r=i,n=a}else{for(r=1;1.5*r<i;)r*=2;for(n=1;1.5*n<a;)n*=2}for(;r*n>b;)r=Math.max(r/2,1),n=Math.max(n/2,1);var s=p.createElement("canvas"),u=s.getContext("2d");s.width=r,s.height=n,u.drawImage(e,0,0,r,n);var c=new Image;c.src=s.toDataURL(),c.onload=function(){t(c)},c.onerror=function(e){l.logger.error(e,(0,o.errorCodeString)(o.ErrorCodes.UNKNOWN_FAILURE)),t(null)}}(e.image,t):t()},E=function(e){g--,l.logger.error("Texture load error",e),r(null),s()};if((0,i.isNodeJS)())!function(e,t,r,i,a){var s=new u.DataTexture(void 0,r);function c(e){a&&a.extractImage&&(e=a.extractImage(e)),s.image={data:e,width:void 0,height:void 0},s.needsUpdate=!0,i&&i(s)}function h(e,t){var r="Error: "+e+" ("+t+")";l.logger.error(r,(0,o.errorCodeString)(o.ErrorCodes.NETWORK_SERVER_ERROR)),i&&i(null,{msg:t,args:e})}n.ViewingService.getItem(t,e,c,h)}(e,w,t,h,v);else if(".dds"===e.slice(e.length-4).toLocaleLowerCase())if((0,i.isIOSDevice)()){var A=e.slice(0,e.length-4)+".pvr";(new PVRLoader).load(A+"?"+w.queryParams,h,E)}else(new c.DDSLoader).load(e+"?"+w.queryParams,h,E);else if(y&&!_||v&&(v.rawData||v.extractImage))!function(e,t,r,i,a){var s=new u.Texture(void 0,r);function c(e){a&&a.extractImage&&(e=a.extractImage(e));var t,r,n=new Image;s.image=n,n.onload=function(){s.needsUpdate=!0,i&&i(s),f.URL.revokeObjectURL(n.src)},n.onerror=function(e){l.logger.error(e,(0,o.errorCodeString)(o.ErrorCodes.UNKNOWN_FAILURE)),i&&i(null)},n.src=(t=new Uint8Array(e),r=new Blob([t],{type:"image/jpeg"}),(f.URL||f.webkitURL).createObjectURL(r))}function h(e,t){var r="Error: "+e+" ("+t+")";l.logger.error(r,(0,o.errorCodeString)(o.ErrorCodes.NETWORK_SERVER_ERROR)),i&&i(null,{msg:t,args:e})}a&&a.rawData?c(a.rawData):n.ViewingService.getItem(t,e,c,h,a)}(e,w,t,m,v);else if(/^data:/.test(e))x(e,t,m,E);else{/(\w+):\/\//gi.exec(e)&&!/^(https?|file|blob:\w+):\/\//gi.test(e)?Autodesk.Viewing.Private.ViewingService.rawGet("","",e,(function(r){var n=/\.(\w+)$/gi.exec(e);n=n?n[1]:"png";var i,o,a="data:image/".concat(n,";base64, ")+(i=r,o=Array.prototype.map.call(i,(function(e){return String.fromCharCode(e)})).join(""),btoa(o));x(a,t,m,E)}),console.error):x(w.queryParams?e+"?"+w.queryParams:e,t,m,E)}}))}function E(e,t,r){var i=t.getData();if(e.startsWith("embed:"))var o=i.loadedBuffers[e.charAt(e.length-1)];else{e=e.replace(/\\/g,"/");o=t.isOTG()?function(e){var t=h.endpoint.initLoadContext({});return i.makeSharedResourcePath(t.otg_cdn,"textures",e)}(e):function(e){for(var t=null,r=0;r<i.manifest.assets.length;++r){var o=i.manifest.assets[r];if(o.id.toLowerCase()==e.toLowerCase()){var a=o.URI;-1===a.indexOf("://")&&(a=i.basePath+a),t=(0,n.pathToURL)(a);break}}return t||(t=(0,n.pathToURL)(i.basePath+e)),t}(e)}return _(o,u.UVMapping,r,null,i.acmSessionId)}function w(e,t,r){if(t.textureMaps&&!t.texturesLoaded){t.texturesLoaded=!0;var n=e.getData(),i=t.textureMaps;for(var o in i){var s=i[o];if(!r.matman().loadTextureFromCache(e,t,s,o))E(s.uri,e,function(t){return function(i){if(i){var o=n.materials.scene.SceneUnit,s=r.renderer()?r.renderer().getMaxAnisotropy():0;(t.converter||a.MaterialConverter.convertTexture)(t,i,o,s)}var l=r.matman();l&&(l.setTextureInCache(e,t,i),n.loadOptions.onTextureReceived&&n.loadOptions.onTextureReceived(l,t,i,!A()),!A()&&r&&n.loadDone&&!n.texLoadDone&&(n.texLoadDone=!0,r.onTextureLoadComplete(e)))}}(s))}}}function A(){return g}function S(e){e>=0&&(y=e,b=Math.max(16384,v/(4*y)))}var M={loadTextureWithSecurity:_,loadMaterialTextures:w,loadModelTextures:function(e,t){var r=t.matman(),n=r._getModelHash(e),i=0;if(e.isOTG())i=e.getData().metadata.stats.num_textures||0;else for(var o in r._materials){if(-1!==o.indexOf(n))(a=r._materials[o]).textureMaps&&(i+=Object.keys(a.textureMaps).length)}for(var o in S(i),r._materials){var a;if(-1!==o.indexOf(n))w(e,a=r._materials[o],t)}var s=e.getData();!A()&&t&&s.loadDone&&!s.texLoadDone&&(s.texLoadDone=!0,t.onTextureLoadComplete(e))},loadCubeMap:function(e,t,r){var n,i=function(n){n?(n.mapping=u.CubeReflectionMapping,n.LogLuv=-1!==e.indexOf("logluv"),n.RGBM=-1!==e.indexOf("rgbm"),(0,s.DecodeEnvMap)(n,t,!1,r)):r&&r(n)};return u.ImageUtils.crossOrigin="",Array.isArray(e)?(n=u.ImageUtils.loadTextureCube(e,u.CubeReflectionMapping,i)).format=u.RGBFormat:"string"==typeof e?-1!==e.toLowerCase().indexOf(".dds")?(n=(new c.DDSLoader).load(e,i)).mipmaps=n.mipmaps||[]:(n=x(e,u.SphericalReflectionMapping,r)).format=u.RGBFormat:e?r&&r(e):r&&r(null),n},requestsInProgress:A,calculateTextureSize:function(e){var t=4;switch(e.format){case u.AlphaFormat:t=1;break;case u.RGBFormat:t=3;break;case u.LuminanceFormat:t=1;break;case u.LuminanceAlphaFormat:t=2}switch(e.type){case u.ShortType:case u.UnsignedShortType:case u.HalfFloatType:t*=2;break;case u.IntType:case u.UnsignedIntType:case u.FloatType:t*=4;break;case u.UnsignedShort4444Type:case u.UnsignedShort5551Type:case u.UnsignedShort565Type:t=2}var r=t*e.image.width;return r+=e.unpackAlignment-1,r-=r%e.unpackAlignment,e.image.height*r},imageToCanvas:function(e,t,r){var n=e.width,i=e.height,o=p.createElement("canvas"),a=o.getContext("2d");return a.globalCompositeOperation="copy",o.width=n,o.height=i,t&&(a.fillStyle=r||"#FFFFFF",a.fillRect(0,0,n,i)),a.drawImage(e,0,0,n,i),o}}},58092:(e,t,r)=>{var n=r(84998),i=n.isNodeJS,o=n.getGlobal,a=r(17167).getResourceUrl;i()?function(){var t=r(15523).MainWorker;function n(){return new t}e.exports={createWorker:n,initWorkerScript:function(e,t){e&&e()},createWorkerWithIntercept:function(){return n()}}}():function(){var t=Autodesk.Viewing.Private,r=t.LMV_WORKER_URL||"src/file-loaders/workers/MainWorker-web.js",n=null,i=!1,s=[];function l(e){var i;return(i=t.ENABLE_INLINE_WORKER?new Worker(n):new Worker(a(r))).doOperation=i.postMessage,!0===e&&t.ViewingService.forwardProtocolHandlerToWorker(i),i}e.exports={createWorker:l,initWorkerScript:function(e,l){if(t.ENABLE_INLINE_WORKER&&!n){if(s.push({successCB:e}),!i){var u=new XMLHttpRequest,c=r,h=a(r);h&&(c=h),u.open("GET",c,!0),u.withCredentials=!1,u.onload=function(){var e,t=o();i=!1,t.URL=t.URL||t.webkitURL;try{e=new Blob([u.responseText],{type:"application/javascript"})}catch(t){var r=new BlobBuilder;r.append(u.responseText),e=r.getBlob()}n=URL.createObjectURL(e);var a=s.concat();s=[];for(var l=0;l<a.length;++l)a[l].successCB&&a[l].successCB()},i=!0,u.send()}var d={cancel:function(){var t=-1;return!!s.some((function(r,n){return r.successCB==e&&(t=n,!0)}))&&(s.splice(t,1),!0)}};return d}return e&&e(),null},createWorkerWithIntercept:function(e){var t=l(e);t.checkEvent=function(e){return!(!e.data||!e.data.assetRequest)};var r=[];return t.addEventListenerWithIntercept=function(e){var n=function(r){t.checkEvent(r)||e(r)};return r||(r=[]),r.push({arg:e,callback:n}),t.addEventListener("message",n,!1),n},t.removeEventListenerWithIntercept=function(e){var n=function(e){if(!r)return null;for(var t=0;t<r.length;++t)if(r[t].arg===e){var n=r[t].callback;return r.splice(t,1),0===r.length&&(r=null),n}return null}(e);n&&t.removeEventListener("message",n,!1)},t.clearAllEventListenerWithIntercept=function(){if(r)for(var e=r.concat(),n=0;n<e.length;++n)t.removeEventListenerWithIntercept(e[n].arg)},t},clearWorkerDataURL:function(){n=null}}}()},62066:(e,t,r)=>{"use strict";r.r(t),r.d(t,{loadWasmWorker:()=>o});var n=r(17167).getResourceUrl,i=r(84998).getGlobal;function o(e){var t={},r=n("wasm.worker.js");return new Promise((function(t,a){var s,l;(s=r,l=Autodesk.Viewing.Private,new Promise((function(e){if(l.ENABLE_INLINE_WORKER){var t=new XMLHttpRequest;t.open("GET",s,!0),t.withCredentials=!1,t.onload=function(){var r,n=i();n.URL=n.URL||n.webkitURL;try{r=new Blob([t.responseText],{type:"application/javascript"})}catch(e){var o=new BlobBuilder;o.append(t.responseText),r=o.getBlob()}e(URL.createObjectURL(r))},t.send()}else e(s)}))).then((function(r){var i=new Worker(r),s={},l=n(e);i.postMessage({eventType:"INITIALIZE",eventData:l}),i.addEventListener("message",(function(e){if("INITIALIZED"===e.data.eventType){e.data.eventData.forEach((function(e){s[e]=function(){var t=arguments;return o(e,i,(function(r){r.postMessage({eventData:{method:e,arguments:Array.from(t)}})}))}}));var r="getBuffer";return s[r]=function(){return o(r,i,(function(e){e.postMessage({eventType:"GET_BUFFER"})}))},void t(s)}})),i.addEventListener("error",(function(e){a(e)}))}))}));function o(e,r,n){return new Promise((function(i,o){var a=function(e,r){var n,i;t&&t.hasOwnProperty(e)?i=(n=t[e][0]).inUse:(t[e]=[],i=!0);i&&(n={channel:new MessageChannel,inUse:!1},t[e].push(n),r.postMessage({eventType:"SET_CHANNEL_PORT",eventData:{method:e,port:n.channel.port2}},[n.channel.port2]));return n}(e,r),s=a.channel;a.inUse=!0,n(s.port1),s.port1.onmessage=function(r){a.inUse=!1;var n=r.data.eventType,s=r.data.eventData;"ERROR"===n?o(s):i(s),function(e,t){for(var r=1;r<t.length;r++){if(t[r].channel===e.channel)return t.splice(r,1),!0}}(a,t[e])}}))}}},79659:(e,t,r)=>{"use strict";r.r(t),r.d(t,{ErrorCodes:()=>n,errorCodeString:()=>i,getErrorCode:()=>o});var n={UNKNOWN_FAILURE:1,BAD_DATA:2,NETWORK_FAILURE:3,NETWORK_ACCESS_DENIED:4,NETWORK_FILE_NOT_FOUND:5,NETWORK_SERVER_ERROR:6,NETWORK_UNHANDLED_RESPONSE_CODE:7,BROWSER_WEBGL_NOT_SUPPORTED:8,BAD_DATA_NO_VIEWABLE_CONTENT:9,BROWSER_WEBGL_DISABLED:10,BAD_DATA_MODEL_IS_EMPTY:11,RTC_ERROR:12,UNSUPORTED_FILE_EXTENSION:13,VIEWER_INTERNAL_ERROR:14,WEBGL_LOST_CONTEXT:15,LOAD_CANCELED:16};function i(e){return"ErrorCode:"+e+"."}function o(e){return 403===e||401===e?n.NETWORK_ACCESS_DENIED:404===e?n.NETWORK_FILE_NOT_FOUND:e>=500?n.NETWORK_SERVER_ERROR:n.NETWORK_UNHANDLED_RESPONSE_CODE}},57601:(e,t,r)=>{"use strict";r.r(t),r.d(t,{ViewingService:()=>w,pathToURL:()=>M,textToArrayBuffer:()=>T});r(82526),r(41817),r(72443),r(92401),r(8722),r(32165),r(69007),r(83510),r(41840),r(6982),r(32159),r(96649),r(39341),r(60543),r(92222),r(50545),r(43290),r(57327),r(69826),r(34553),r(84944),r(86535),r(91038),r(26699),r(66992),r(69600),r(21249),r(26572),r(47042),r(2707),r(38706),r(40561),r(33792),r(99244),r(18264),r(96078),r(4855),r(68309),r(73706),r(51532),r(99752),r(82376),r(73181),r(23484),r(2388),r(88621),r(60403),r(84755),r(25438),r(90332),r(40658),r(40197),r(44914),r(52420),r(60160),r(60970),r(10408),r(73689),r(9653),r(93299),r(35192),r(33161),r(44048),r(78285),r(44363),r(55994),r(61874),r(9494),r(56977),r(19601),r(59595),r(35500),r(69720),r(43371),r(38559),r(38880),r(49337),r(36210),r(30489),r(43304),r(41825),r(98410),r(72200),r(47941),r(94869),r(33952),r(57227),r(60514),r(41539),r(26833),r(88674),r(17727),r(36535),r(12419),r(69596),r(52586),r(74819),r(95683),r(39361),r(51037),r(5898),r(67556),r(14361),r(83593),r(39532),r(24603),r(74916),r(92087),r(39714),r(70189),r(79841),r(27852),r(94953),r(32023),r(78783),r(4723),r(66528),r(83112),r(38992),r(82481),r(15306),r(64765),r(23123),r(23157),r(73210),r(48702),r(55674),r(15218),r(74475),r(57929),r(50915),r(29253),r(42125),r(78830),r(58734),r(29254),r(37268),r(7397),r(60086),r(80623),r(44197),r(76495),r(87145),r(35109),r(65125),r(82472),r(49743),r(8255),r(29135),r(92990),r(18927),r(33105),r(35035),r(74345),r(7174),r(32846),r(98145),r(44731),r(77209),r(96319),r(58867),r(37789),r(33739),r(95206),r(29368),r(14483),r(12056),r(3462),r(30678),r(27462),r(33824),r(55021),r(12974),r(15016),r(4129),r(38478),r(8628),r(83475),r(46273),r(51568),r(26349),r(65743),r(10072),r(99137),r(71957),r(96306),r(103),r(8582),r(90618),r(74592),r(88440),r(58276),r(35082),r(12813),r(18222),r(24838),r(38563),r(50336),r(7512),r(46603),r(70100),r(10490),r(13187),r(60092),r(19041),r(30666),r(51638),r(62975),r(15728),r(46056),r(44299),r(5162),r(50292),r(1025),r(97314),r(96290),r(77479),r(34582),r(47896),r(12647),r(98558),r(84018),r(97507),r(61605),r(49076),r(34999),r(88921),r(96248),r(13599),r(11477),r(64362),r(15389),r(46006),r(90401),r(45164),r(91238),r(54837),r(87485),r(56767),r(69916),r(76651),r(61437),r(35285),r(39865),r(86035),r(67501),r(13728),r(27207),r(21568),r(48824),r(44130),r(78206),r(76478),r(79715),r(43561),r(32049),r(86020),r(56585),r(54747),r(33948),r(84633),r(85844),r(60285),r(83753),r(41637),r(35666);var n=r(98926),i=r(79659),o=r(7913),a=r(58964),s=r(84998),l=r(24414);function u(e,t,r,n,i,o,a){try{var s=e[o](a),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,i)}function c(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==r)return;var n,i,o=[],a=!0,s=!1;try{for(r=r.call(e);!(a=(n=r.next()).done)&&(o.push(n.value),!t||o.length!==t);a=!0);}catch(e){s=!0,i=e}finally{try{a||null==r.return||r.return()}finally{if(s)throw i}}return o}(e,t)||d(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(e){return function(e){if(Array.isArray(e))return f(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||d(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(e,t){if(e){if("string"==typeof e)return f(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?f(e,t):void 0}}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var p,m,g,v,y,b,x,_,E=r(99591),w={WORKER_REGISTER_FILE_PORT:"REGISTER_FILE_PORT",WORKER_READ_FILE:"READ_FILE"},A=!1;function S(e){var t=e.split("/");if(0==t.length)return e;for(var r=[],n=0;n<t.length;++n){var i=t[n];"."!==i&&(".."===i&&r.length?r.pop():r.push(i))}return 0==r.length?"":r.join("/")}function M(e,t){if(-1!==e.indexOf("://")||0===e.indexOf("urn:"))return e;if(t)return t+e;if("undefined"==typeof window)return e;var r=(0,s.getGlobal)(),n=r.location.pathname,i=n.lastIndexOf("/");return n=n.substr(0,i+1),r.location.protocol+"//"+r.location.host+n+e}function T(e,t){for(var r=e.length-t,n=new ArrayBuffer(r),i=new Uint8Array(n,0),o=0,a=t;o<r;o++,a++)i[o]=255&e.charCodeAt(a);return i}function C(e,t){return-1===t.indexOf("file://")&&(-1!==t.indexOf("://")||(!!e||void 0))}if(w.simplifyPath=S,w.OSS_PREFIX="urn:adsk.objects:os.object:",w.generateUrl=function(e,t,r,n,i,o){if(r=r||"",(0,s.isNodeJS)()&&!C(e,r))return r;var l=(r=S(r)).indexOf("urn:"),u=r.indexOf("?");if(r=-1!=l?-1!==u?r.slice(0,l)+encodeURIComponent(r.slice(l,u))+r.slice(u):r.slice(0,l)+encodeURIComponent(r.slice(l)):encodeURI(r),i&&w.isOSSUrl(r)){var c=r.indexOf("/objects/")+9,h=r.substring(c);r=r.substring(0,c)+encodeURIComponent(h)}if(!t||0!==decodeURIComponent(r).indexOf("urn:"))return C(null,r)?r:e+r;switch("items"!==t&&(r=r.substr(6)),t){case"items":return a.endpoint.getItemApi(e,r,n);case"bubbles":return a.endpoint.getManifestApi(e,r,n);case"thumbnails":return a.endpoint.getThumbnailApi(e,r,n);case"properties":return a.endpoint.getPropertyQueryApi(e,r,n,o)}},(0,s.isNodeJS)())p=r(74617),m=r(78322),g=r(80959),v=r(75725),y=r(8575),b=new g.Agent({keepAlive:!0,keepAliveMsecs:100,maxSockets:10}),x=new v.Agent({keepAlive:!0,keepAliveMsecs:100,maxSockets:10}),_=new g.Agent({maxSockets:10}),w.rawGet=function(e,t,r,o,a,s){if(s=s||{},C(e,r=w.generateUrl(e,t,r,void 0,s.escapeOssObjects))){if(s.queryParams){var l=-1===r.indexOf("?")?"?":"&";r=r+l+s.queryParams}var u=y.parse(r),c={host:u.hostname,port:u.port,method:s.method||"GET",path:u.path,headers:{},retryCount:0,agent:"https:"===u.protocol?b:x};if(c.host.endsWith(".api.autodesk.com")&&(c.path.startsWith("/derivativeservice")||c.path.startsWith("/modelderivative"))&&(c.agent=_),s.headers)for(var h in s.headers)c.headers[h]=s.headers[h];c.headers["accept-encoding"]||(c.headers["accept-encoding"]="gzip, deflate"),s.range&&(c.headers.Range="bytes="+s.range.min+"-"+s.range.max),(s.ondata||s.onprogress)&&(s.responseType="arraybuffer");var d=("https:"===u.protocol?g:v).request(c,(function(e){var t=!(e.statusCode>=200&&e.statusCode<400),l=e;t||!function(e,t){return!!("gzip"===e.headers["content-encoding"]||t.endsWith(".json.gz")||t.endsWith("FragmentList.pack")||t.endsWith("LightList.bin")||t.endsWith("CameraList.bin")||t.endsWith("CameraDefinitions.bin")||t.endsWith("LightDefinitions.bin"))}(e,u.pathname)||s.skipDecompress||(l=e.pipe(m.createGunzip())),"json"!==s.responseType&&"text"!==s.responseType&&s.responseType||l.setEncoding("utf8");var c=[],h=Buffer.allocUnsafe(65536),f=0;l.on("data",(function(e){if(s.onprogress){if(e.length+f>h.length){var t=Buffer.allocUnsafe(0|Math.ceil(1.5*h.length));h.copy(t,0,0,f),h=t}return e.copy(h,f,0,e.length),f+=e.length,void(s.onprogress(h,f)&&d.abort())}c.push(e),s.ondata&&s.ondata(e)})),l.on("end",(function(){if(e.statusCode>=200&&e.statusCode<400){if("json"===s.responseType){var t=JSON.parse(c.join(""));return void o(t)}if("text"===s.responseType||""===s.responseType){var l=c.join("");return void o(l)}var u=s.onprogress?h:Buffer.concat(c);if(!s.skipDecompress&&31===u[0]&&139===u[1]){n.logger.warn("An LMV resource ("+r+") was double compressed, or Content-Encoding header missing");try{u=m.gunzipSync(u),f=u.length}catch(e){a(i.ErrorCodes.BAD_DATA,"Malformed data received when requesting file",{url:r,exception:e.toString(),stack:e.stack})}}200===d.status&&s.range&&(u=new Uint8Array(u,s.range.min,s.range.max-s.range.min)),o(u,f)}else a&&a(e.statusCode,e.statusMessage,{url:r})}))}));d.on("error",(function(e){a&&a(e.code,e.message,{url:r})})),s.postData&&d.write(s.postData),d.end()}else!function(e,t,r,n){function i(e){if("json"===n.responseType)try{return JSON.parse(e.toString("utf8"))}catch(e){r(e)}return e}0===e.indexOf("file://")&&(e=e.substr(7)),p.readFile(e,(function(o,a){o?r(0,0,{httpStatusText:o,url:e}):31===a[0]&&139===a[1]?m.gunzip(a,null,(function(o,a){o?r(0,0,{httpStatusText:o,url:e}):(a=i(a),n.ondata&&n.ondata(a),t(a))})):(a=i(a),n.ondata&&n.ondata(a),t(a))}))}(r,o,a,s)};else{var P=new(r(79916));P.max=25;var D={},L={},R={};w.registerProtocolPort=function(e,t){/^(http(s)?|file):/gi.test(e)?console.warn("http(s) or file protocol were not allowed to be handled"):t?(D[e]=t,t.onmessage=function(e){var t=e.data.url;if(L[t]){var r=L[t];if(e.data.error)r.onFailureWrapped(i.ErrorCodes.BAD_DATA,"Malformed data received when requesting file",{url:t,exception:e.data.error.message,stack:e.data.error.stack});else{var n=e.data.buffer;if(L[t]=void 0,31===n[0]&&139===n[1]&&t.match(/(.f2d|.gz)$/gi))try{n=E.ungzip(n),r.options&&r.options.ondata&&r.options.ondata(n),r.onSuccessWrapped(n)}catch(e){r.onFailureWrapped(i.ErrorCodes.BAD_DATA,"Malformed data received when requesting file",{url:t,exception:e.toString(),stack:e.stack})}else r.onSuccessWrapped(n)}}else if(R[t]){var o=[];e.data&&e.data.buffer&&e.data.buffer.buffer instanceof ArrayBuffer&&o.push(e.data.buffer.buffer),R[t].postMessage(e.data,o),R[t]=void 0}}):D[e]&&D[e]instanceof MessagePort&&(D[e].onmessage=void 0,D[e]=void 0)},w.handlerProtocol=function(e,t,r,n,i){var o=D[e];L[t]={onSuccessWrapped:r,onFailureWrapped:n,options:i},o.postMessage({operation:w.WORKER_READ_FILE,url:t})},w.forwardProtocolHandlerToWorker=function(e){var t={},r=new MessageChannel;for(var n in r.port1.onmessage=function(e){var t=new URL(e.data.url);D[t.protocol].postMessage(e.data),R[t]=r.port1},D)D[n]instanceof MessagePort&&(t[n]=r.port2);e.doOperation({operation:w.WORKER_REGISTER_FILE_PORT,protocolPortMap:t},[r.port2])},w.rawGet=function(e,t,r,n,i,o){P.go((function(a){var s=function(){a();for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];i&&i.apply(i,t)},l=function(){a();for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];n&&n.apply(n,t)},u=/^(\w+:)\/\//gi.exec(r);u&&2==u.length&&D[u[1]]?w.handlerProtocol(u[1],r,l,s,o):w._rawGet(e,t,r,l,(function(){var n=arguments.length<=0?void 0:arguments[0],i=((null==o?void 0:o.method)||(null!=o&&o.noBody?"HEAD":"GET")).toLowerCase(),a="get"===i&&(429===n||n>=500);if(a){var u=arguments.length<=3?void 0:arguments[3],c=100,d=(429===n||503===n)&&(null==u?void 0:u.getResponseHeader("Retry-After"));if(d){var f=Number(d);c=(c=!isNaN(f)&&1e3*f||Date.parse(d)-(new Date).getTime())>100?c:100}w._retryRequest(e,t,r,o,c).then((function(e){return l.apply(void 0,h(e))})).catch((function(e){return s.apply(void 0,h(e))}))}else s.apply(void 0,arguments)}),o)}))},w._retryRequest=function(e,t,r,i,o){var a={delayFirstAttempt:!0,startingDelay:o,numOfAttempts:4,retry:function(e,t){var r=c(e,3),i=r[0],o=r[1],a=r[2].url;return n.logger.warn("request ".concat(a," failed with status ").concat(i," ").concat(o,". Attempt ").concat(t)),!0},timeMultiple:5};return(0,l.backOff)((function(){return new Promise((function(n,o){w._rawGet(e,t,r,(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n(t)}),(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return o(t)}),i)}))}),a)},w.isOSSUrl=function(e){return!!e&&-1!==e.indexOf("/oss/v2/buckets")},w.getSignedS3DownloadUrl=function(e){return new Promise((function(t){var r=e.indexOf("?acmsession=");-1!==r&&(e=e.substring(0,r)),e+="/signeds3download?useCdn=true";var n=new XMLHttpRequest;n.open("GET",e),n.setRequestHeader("Authorization",a.endpoint.HTTP_REQUEST_HEADERS.Authorization),n.responseType="json",n.send();var i=function(){t(null)};n.onload=function(e){var r=e.currentTarget.response;t(r.url)},n.onerror=i,n.ontimeout=i,n.onabort=i}))},w._rawGet=function(){var e,t=(e=regeneratorRuntime.mark((function e(t,r,a,s,l,u){var c,h,d,f,p,m,g,v,y,b;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(v=function(e){if(f.status>=200&&f.status<400)if(f.response&&f.response instanceof ArrayBuffer){var t;if(t=200===f.status&&u.range?new Uint8Array(f.response,u.range.min,u.range.max-u.range.min):new Uint8Array(f.response),!u.skipDecompress&&31===t[0]&&139===t[1]){A||(A=!0,n.logger.warn("An LMV resource ("+a+") was not uncompressed by the browser. This hurts performance. Check the Content-Encoding header returned by the server and check whether you're getting double-compressed streams. The warning prints only once but it's likely the problem affects multiple resources."));try{t=E.ungzip(t)}catch(e){l(i.ErrorCodes.BAD_DATA,"Malformed data received when requesting file",{url:a,exception:e.toString(),stack:e.stack},f)}}s&&s(g(t))}else{var r=f.response;r||u.responseType&&"text"!==u.responseType||(r=f.responseText),s&&s(g(r))}else p(e)},g=function(e){if("json"===u.responseType)try{if(e instanceof Uint8Array)return(0,o.Up)(e);if("string"==typeof e)return JSON.parse(e)}catch(e){}return e},m=function(e){l&&l(f.status,"request was aborted",{url:a,aborted:!0},f)},p=function(e){l&&l(f.status,f.statusText,{url:a},f)},u=u||{},a=w.generateUrl(t,r,a,u.apiData,u.escapeOssObjects,u.guid),c=!1,!w.isOSSUrl(a)){e.next=12;break}return e.next=10,w.getSignedS3DownloadUrl(a);case 10:(h=e.sent)?(a=h,c=!0):console.warn("Failed getting signed URL - Fallback to direct OSS resource.");case 12:u.queryParams&&!c&&(d=-1===a.indexOf("?")?"?":"&",a=a+d+u.queryParams),f=new XMLHttpRequest;try{if(y=!u.hasOwnProperty("asynchronous")||u.asynchronous,f.open(u.method||(u.noBody?"HEAD":"GET"),a,y),u.hasOwnProperty("responseType")&&(f.responseType=u.responseType),u.range&&f.setRequestHeader("Range","bytes="+u.range.min+"-"+u.range.max),!c&&(f.withCredentials=!0,u.hasOwnProperty("withCredentials")&&(f.withCredentials=u.withCredentials),u.headers))for(b in u.headers)f.setRequestHeader(b,u.headers[b]),"authorization"===b.toLocaleLowerCase()&&(f.withCredentials=!1);y&&(f.onload=v,f.onerror=p,f.ontimeout=p,f.onabort=m,(u.ondata||u.onprogress)&&(f.overrideMimeType("text/plain; charset=x-user-defined"),u._dlProgress={streamOffset:0},f.onreadystatechange=function(){if(f.readyState>2&&200===f.status)if(u.ondata){var e=f.responseText;if(u._dlProgress.streamOffset>=e.length)return;var t=T(e,u._dlProgress.streamOffset);u._dlProgress.streamOffset=e.length,u.ondata(t)}else u.onprogress&&u.onprogress(f.responseText)&&f.abort()})),f.send(u.postData),y||v()}catch(e){l(f.status,f.statusText,{url:a,exception:e},f)}case 15:case"end":return e.stop()}}),e)})),function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function a(e){u(o,n,i,a,s,"next",e)}function s(e){u(o,n,i,a,s,"throw",e)}a(void 0)}))});return function(e,r,n,i,o,a){return t.apply(this,arguments)}}()}function I(e,t){t.hasOwnProperty("responseType")||(t.responseType="arraybuffer"),t.hasOwnProperty("withCredentials")||(t.withCredentials=!!e.auth),t.headers=e.headers,t.queryParams=e.queryParams,t.endpoint=e.endpoint,t.escapeOssObjects=e.escapeOssObjects}w.defaultFailureCallback=function(e,t,r){403==e?this.raiseError(i.ErrorCodes.NETWORK_ACCESS_DENIED,"Access denied to remote resource",{url:r.url,httpStatus:e,httpStatusText:t}):404==e?this.raiseError(i.ErrorCodes.NETWORK_FILE_NOT_FOUND,"Remote resource not found",{url:r.url,httpStatus:e,httpStatusText:t}):0===e&&r.aborted?this.raiseError(i.ErrorCodes.LOAD_CANCELED,"Request aborted",{url:r.url,httpStatus:e,httpStatusText:t}):e>=500&&e<600?this.raiseError(i.ErrorCodes.NETWORK_SERVER_ERROR,"Server error when accessing resource",{url:r.url,httpStatus:e,httpStatusText:t}):r.exception?this.raiseError(i.ErrorCodes.NETWORK_FAILURE,"Network failure",{url:r.url,exception:r.exception.toString(),stack:r.exception.stack}):this.raiseError(i.ErrorCodes.NETWORK_UNHANDLED_RESPONSE_CODE,"Unhandled response code from server",{url:r.url,httpStatus:e,httpStatusText:t,data:r})},w.getItem=function(e,t,r,n,i){if(I(e,i=i||{}),i.range&&!e.supportsRangeRequests){var o="start="+i.range.min+"&end="+i.range.max;i.queryParams?i.queryParams+="&"+o:i.queryParams=o,i.range=void 0}w.rawGet(e.endpoint,"items",t,r,n,i)},w.getManifest=function(e,t,r,n,i){(i=i||{}).hasOwnProperty("responseType")||(i.responseType="json"),I(e,i),w.rawGet(e.endpoint,"bubbles",t,r,n,i)},w.getProperties=function(e,t,r,n,i,o){var a={};I(e,a),a.responseType="json",a.guid=r,a.method="POST",a.postData=JSON.stringify(n),a.headers["Content-Type"]="application/json",a.headers.accept="application/json",a.headers["Access-Control-Allow-Origin"]="*",w.rawGet(e.endpoint,"properties",t,i,o,a)},w.getThumbnail=function(e,t,r,n,i){I(e,i=i||{});var o=i.queryParams||"",a=[];if(-1===o.indexOf("guid=")&&i.guid&&a.push("guid="+encodeURIComponent(i.guid)),-1===o.indexOf("role=")){var s=i.role||"rendered";a.push("role="+s)}if(-1===o.indexOf("width=")){var l=i.size||400;a.push("width="+l)}if(-1===o.indexOf("height=")){l=i.size||400;a.push("height="+l)}-1===o.indexOf("acmsession=")&&i.acmsession&&a.push("acmsession="+i.acmsession);var u=a.join("&");i.queryParams?i.queryParams=i.queryParams+"&"+u:i.queryParams=u,w.rawGet(e.endpoint,"thumbnails",t,r,n,i)},w.getACMSession=function(e,t,r,i){var o={numOfAttempts:4,timeMultiple:5,retry:function(e,t){return n.logger.warn("acmsession request failed. Attempt #".concat(t)),!0}};(0,l.backOff)((function(){return new Promise((function(r,n){w._getACMSession(e,t,r,n)}))}),o).then((function(){return r.apply(void 0,arguments)})).catch((function(){return i.apply(void 0,arguments)}))},w._getACMSession=function(e,t,r,n){var i,o={};for(var a in t)"oauth2AccessToken"===a?i=t[a]:-1!==a.indexOf("x-ads-acm")&&(o[a]=t[a]);o.application="autodesk";var s=new XMLHttpRequest;s.open("POST",e+"/oss-ext/v2/acmsessions",!0),s.setRequestHeader("Content-Type","application/json"),s.setRequestHeader("Authorization","Bearer "+i),s.responseType="json",s.onload=function(){if(200===s.status&&s.response){var e="string"==typeof s.response?JSON.parse(s.response):s.response;e&&e.acmsession?r(e.acmsession):n(s.status,"Can't get acm session from response.")}else n(s.status)},s.onerror=n,s.ontimeout=n,s.send(JSON.stringify(o)),delete o.application}},58964:(e,t,r)=>{"use strict";r.r(t),r.d(t,{getEnv:()=>g,setEnv:()=>v,isOffline:()=>b,setOffline:()=>x,setOfflineResourcePrefix:()=>E,getOfflineResourcePrefix:()=>w,endpoint:()=>A,initLoadContext:()=>S});var n=r(84998),i=r(17167),o=(0,n.getGlobal)(),a={},s=null;a.ENDPOINT_API_DERIVATIVE_SERVICE_V2="derivativeV2",a.ENDPOINT_API_MODEL_DERIVATIVE_V2="modelDerivativeV2",a.ENDPOINT_API_FLUENT="fluent",a.ENDPOINT_API_D3S="D3S",a.ENDPOINT_API_DERIVATIVE_STREAMING="streamingV2";var l,u={derivativeV2:{baseURL:"/derivativeservice/v2",itemURL:"/derivativeservice/v2/derivatives/:derivativeurn",manifestURL:"/derivativeservice/v2/manifest/:urn",thumbnailsURL:"/derivativeservice/v2/thumbnails/:urn",propertyQueryURL:"/modelderivative/v2/designdata/:urn/metadata/:guid/properties:query"},derivativeV2_EU:{baseURL:"/derivativeservice/v2/regions/eu",itemURL:"/derivativeservice/v2/regions/eu/derivatives/:derivativeurn",manifestURL:"/derivativeservice/v2/regions/eu/manifest/:urn",thumbnailsURL:"/derivativeservice/v2/regions/eu/thumbnails/:urn"},derivativeV2_Fedramp:{baseURL:"/derivativeservice/v2/regions/fedramp",itemURL:"/derivativeservice/v2/regions/fedramp/derivatives/:derivativeurn",manifestURL:"/derivativeservice/v2/regions/fedramp/manifest/:urn",thumbnailsURL:"/derivativeservice/v2/regions/fedramp/thumbnails/:urn"},modelDerivativeV2:{baseURL:"/modelderivative/v2/",itemURL:"/modelderivative/v2/designdata/:urn/manifest/:derivativeurn",manifestURL:"/modelderivative/v2/designdata/:urn/manifest",thumbnailsURL:"/modelderivative/v2/designdata/:urn/thumbnail",propertyQueryURL:"/modelderivative/v2/designdata/:urn/metadata/:guid/properties:query"},fluent:{baseURL:"/modeldata",itemURL:"/modeldata/file/:derivativeurn",manifestURL:"/modeldata/manifest/:urn",thumbnailsURL:"/derivativeservice/v2/thumbnails/:urn",cdnURL:"/cdn",cdnWS:"/cdnws"},D3S:{baseURL:"/modeldata",itemURL:"/modeldata/file/:derivativeurn",manifestURL:"/modeldata/manifest/:urn",thumbnailsURL:"/derivativeservice/v2/thumbnails/:urn",cdnURL:"/cdn",cdnWS:"/cdnws"},D3S_EU:{baseURL:"/modeldata",itemURL:"/modeldata/file/:derivativeurn",manifestURL:"/modeldata/manifest/:urn",thumbnailsURL:"/derivativeservice/v2/regions/eu/thumbnails/:urn",cdnURL:"/cdn",cdnWS:"/cdnws"},streamingV2:{baseURL:"/modeldata",itemURL:"/modeldata/file/:derivativeurn",manifestURL:"/modeldata/manifest/:urn",thumbnailsURL:"/derivativeservice/v2/thumbnails/:urn",cdnURL:"/cdn",cdnWS:"/cdnws"},streamingV2_EU:{baseURL:"/regions/eu/modeldata",itemURL:"/regions/eu/modeldata/file/:derivativeurn",manifestURL:"/regions/eu/modeldata/manifest/:urn",thumbnailsURL:"/derivativeservice/v2/regions/eu/thumbnails/:urn",cdnURL:"/regions/eu/cdn",cdnWS:"/regions/eu/cdnws"},streamingV2_Fedramp:{baseURL:"/regions/fedramp/modeldata",itemURL:"/regions/fedramp/modeldata/file/:derivativeurn",manifestURL:"/regions/fedramp/modeldata/manifest/:urn",thumbnailsURL:"/derivativeservice/v2/regions/fedramp/thumbnails/:urn",cdnURL:"/regions/fedramp/cdn",cdnWS:"/regions/fedramp/cdnws"}},c="",h=a.ENDPOINT_API_DERIVATIVE_SERVICE_V2,d=!1,f=!1,p="",m=!1;function g(){return l}function v(e){l=e,e.startsWith("MD20")&&console.warn("env=".concat(e," is deprecated and will be removed in a future release. Use Autodesk{env}2 instead, where env=Development, Staging, or Production"))}a.HTTP_REQUEST_HEADERS={},a.queryParams={},a.setEndpointAndApi=function(e,t){e&&(c=e),t&&(h=t,t.startsWith("D3S")&&console.warn("api=".concat(t," is deprecated and will be removed in a future release. Use streamingV2 or streamingV2_EU (europe region) instead")))},a.getEndpointAndApi=function(){return c+u[h].baseURL},a.getApiEndpoint=function(){return c},a.getApiFlavor=function(){return h},a.getCdnUrl=function(){return s||(c?c+u[h].cdnURL:void 0)},a.getCdnWebSocketEndpoint=function(){return c+(u[h].cdnWS||"")},a.setCdnUrl=function(e){s=e},a.getCdnRedirectUrl=function(){var e=u[h].cdnRedirectURL;return e?c+e:null},a.setAcmSession=function(e){p=e},a.getAcmSession=function(){return p},a.getManifestApi=function(e,t,r){var n=e||c;return t=t||"",n=(n+=u[r=r||h].manifestURL).replace(":urn",t)},a.getItemApi=function(e,t,r){var n=r||h,i=(e||c)+u[n].itemURL;t=t||"";var o=decodeURIComponent(t);if(-1!==i.indexOf(":urn")){var s=o.split("/")[0]||"";s=(s=s.split(":"))[s.length-1]||"",i=i.replace(":urn",s)}return n===a.ENDPOINT_API_MODEL_DERIVATIVE_V2&&(t=encodeURIComponent(o)),i=i.replace(":derivativeurn",t)},a.getThumbnailApi=function(e,t,r){return((e||c)+u[r||h].thumbnailsURL).replace(":urn",t||"")},a.getPropertyQueryApi=function(e,t,r,n){var i=(e||c)+u[r||h].propertyQueryURL;return(i=i.replace(":urn",t||"")).replace(":guid",n||"")},a.getUseCredentials=function(){return d},a.getDomainParam=function(){return console.warn("getDomainParam is deprecated, switch to getQueryParams instead."),this.getUseCredentials()&&!(0,n.isNodeJS)()?"domain="+encodeURIComponent(o.location.origin):""},a.addQueryParam=function(e,t){this.queryParams[e]=t},a.deleteQueryParam=function(e){delete this.queryParams[e]},a.getQueryParams=function(e){var t=this.getUseCredentials()&&!(0,n.isNodeJS)()?"domain="+encodeURIComponent(o.location.origin):"";(0,i.getParameterByName)("bypassds")&&(t=t?t+"&bypassds=1":"bypassds=1");var r=[];for(var a in this.queryParams)r.push(encodeURIComponent(a)+"="+encodeURIComponent(this.queryParams[a]));return r.length&&(t?t+="&"+r.join("&"):t=r.join("&")),t&&e&&(e.queryParams?e.queryParams+="&"+t:e.queryParams=t),t},a.setUseCredentials=function(e){d=e},a.setUseCookie=function(e){f=e},a.getUseCookie=function(){return f},a.isOtgBackend=function(){return this.getApiFlavor()===this.ENDPOINT_API_FLUENT},a.isSVF2Backend=function(){var e=this.getApiFlavor();return e.startsWith(this.ENDPOINT_API_D3S)||e.startsWith(this.ENDPOINT_API_DERIVATIVE_STREAMING)},a.setEscapeOssObjects=function(e){m=e},a.getEscapeOssObjects=function(){return m},a.initLoadContext=function(e){for(var t in(e=e||{}).auth=this.getUseCredentials(),e.endpoint||(e.endpoint=this.getApiEndpoint()),e.api||(e.api=this.getApiFlavor()),e.headers||(e.headers={}),this.HTTP_REQUEST_HEADERS)e.headers[t]=this.HTTP_REQUEST_HEADERS[t];return e.api,this.ENDPOINT_API_FLUENT,this.getQueryParams(e),e.otg_cdn=s||this.getCdnUrl(),e.otg_ws=this.getCdnWebSocketEndpoint(),e.escapeOssObjects=this.getEscapeOssObjects(),e};var y=!1;function b(){return y}function x(e){y=e}var _="";function E(e){_=e}function w(){return _}var A=a,S=a.initLoadContext.bind(a)},41471:(e,t,r)=>{"use strict";r.r(t),r.d(t,{extendLocalization:()=>S,initializeLocalization:()=>T,setLanguage:()=>M});var n=r(84998);function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}var o=[],a=o.forEach,s=o.slice;function l(e){return a.call(s.call(arguments,1),(function(t){if(t)for(var r in t)void 0===e[r]&&(e[r]=t[r])})),e}function u(){return"function"==typeof XMLHttpRequest||"object"===("undefined"==typeof XMLHttpRequest?"undefined":i(XMLHttpRequest))}var c,h,d,f=r(83154),p=r.t(f,2);function m(e){return m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},m(e)}"function"==typeof fetch&&("undefined"!=typeof global&&global.fetch?c=global.fetch:"undefined"!=typeof window&&window.fetch&&(c=window.fetch)),u&&("undefined"!=typeof global&&global.XMLHttpRequest?h=global.XMLHttpRequest:"undefined"!=typeof window&&window.XMLHttpRequest&&(h=window.XMLHttpRequest)),"function"==typeof ActiveXObject&&("undefined"!=typeof global&&global.ActiveXObject?d=global.ActiveXObject:"undefined"!=typeof window&&window.ActiveXObject&&(d=window.ActiveXObject)),c||!p||h||d||(c=f||p),"function"!=typeof c&&(c=void 0);var g=function(e,t){if(t&&"object"===m(t)){var r="";for(var n in t)r+="&"+encodeURIComponent(n)+"="+encodeURIComponent(t[n]);if(!r)return e;e=e+(-1!==e.indexOf("?")?"&":"?")+r.slice(1)}return e};const v=function(e,t,r,n){return"function"==typeof r&&(n=r,r=void 0),n=n||function(){},c?function(e,t,r,n){e.queryStringParams&&(t=g(t,e.queryStringParams));var i=l({},"function"==typeof e.customHeaders?e.customHeaders():e.customHeaders);r&&(i["Content-Type"]="application/json"),c(t,l({method:r?"POST":"GET",body:r?e.stringify(r):void 0,headers:i},"function"==typeof e.requestOptions?e.requestOptions(r):e.requestOptions)).then((function(e){if(!e.ok)return n(e.statusText||"Error",{status:e.status});e.text().then((function(t){n(null,{status:e.status,data:t})})).catch(n)})).catch(n)}(e,t,r,n):u||"function"==typeof ActiveXObject?function(e,t,r,n){r&&"object"===m(r)&&(r=g("",r).slice(1)),e.queryStringParams&&(t=g(t,e.queryStringParams));try{var i;(i=h?new h:new d("MSXML2.XMLHTTP.3.0")).open(r?"POST":"GET",t,1),e.crossDomain||i.setRequestHeader("X-Requested-With","XMLHttpRequest"),i.withCredentials=!!e.withCredentials,r&&i.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),i.overrideMimeType&&i.overrideMimeType("application/json");var o=e.customHeaders;if(o="function"==typeof o?o():o)for(var a in o)i.setRequestHeader(a,o[a]);i.onreadystatechange=function(){i.readyState>3&&n(i.status>=400?i.statusText:null,{status:i.status,data:i.responseText})},i.send(r)}catch(e){console&&console.log(e)}}(e,t,r,n):void 0};function y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function b(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var x=function(){return{loadPath:"/locales/{{lng}}/{{ns}}.json",addPath:"/locales/add/{{lng}}/{{ns}}",allowMultiLoading:!1,parse:function(e){return JSON.parse(e)},stringify:JSON.stringify,parsePayload:function(e,t,r){return function(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}({},t,r||"")},request:v,reloadInterval:"undefined"==typeof window&&36e5,customHeaders:{},queryStringParams:{},crossDomain:!1,withCredentials:!1,overrideMimeType:!1,requestOptions:{mode:"cors",credentials:"same-origin",cache:"default"}}},_=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};y(this,e),this.services=t,this.options=r,this.allOptions=n,this.type="backend",this.init(t,r,n)}var t,r,n;return t=e,r=[{key:"init",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.services=e,this.options=l(r,this.options||{},x()),this.allOptions=n,this.services&&this.options.reloadInterval&&setInterval((function(){return t.reload()}),this.options.reloadInterval)}},{key:"readMulti",value:function(e,t,r){this._readAny(e,e,t,t,r)}},{key:"read",value:function(e,t,r){this._readAny([e],e,[t],t,r)}},{key:"_readAny",value:function(e,t,r,n,i){var o,a=this,s=this.options.loadPath;"function"==typeof this.options.loadPath&&(s=this.options.loadPath(e,r)),(s=function(e){return!!e&&"function"==typeof e.then}(o=s)?o:Promise.resolve(o)).then((function(o){var s=a.services.interpolator.interpolate(o,{lng:e.join("+"),ns:r.join("+")});a.loadUrl(s,i,t,n)}))}},{key:"loadUrl",value:function(e,t,r,n){var i=this;this.options.request(this.options,e,void 0,(function(o,a){if(a&&(a.status>=500&&a.status<600||!a.status))return t("failed loading "+e+"; status code: "+a.status,!0);if(a&&a.status>=400&&a.status<500)return t("failed loading "+e+"; status code: "+a.status,!1);if(!a&&o&&o.message&&o.message.indexOf("Failed to fetch")>-1)return t("failed loading "+e+": "+o.message,!0);if(o)return t(o,!1);var s,l;try{s="string"==typeof a.data?i.options.parse(a.data,r,n):a.data}catch(t){l="failed parsing "+e+" to json"}if(l)return t(l,!1);t(null,s)}))}},{key:"create",value:function(e,t,r,n,i){var o=this;if(this.options.addPath){"string"==typeof e&&(e=[e]);var a=this.options.parsePayload(t,r,n),s=0,l=[],u=[];e.forEach((function(r){var n=o.options.addPath;"function"==typeof o.options.addPath&&(n=o.options.addPath(r,t));var c=o.services.interpolator.interpolate(n,{lng:r,ns:t});o.options.request(o.options,c,a,(function(t,r){s+=1,l.push(t),u.push(r),s===e.length&&i&&i(l,u)}))}))}}},{key:"reload",value:function(){var e=this,t=this.services,r=t.backendConnector,n=t.languageUtils,i=t.logger,o=r.language;if(!o||"cimode"!==o.toLowerCase()){var a=[],s=function(e){n.toResolveHierarchy(e).forEach((function(e){a.indexOf(e)<0&&a.push(e)}))};s(o),this.allOptions.preload&&this.allOptions.preload.forEach((function(e){return s(e)})),a.forEach((function(t){e.allOptions.ns.forEach((function(e){r.read(t,e,"read",null,null,(function(n,o){n&&i.warn("loading namespace ".concat(e," for language ").concat(t," failed"),n),!n&&o&&i.log("loaded namespace ".concat(e," for language ").concat(t),o),r.loaded("".concat(t,"|").concat(e),n,o)}))}))}))}}}],r&&b(t.prototype,r),n&&b(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();_.type="backend";const E=_;var w=r(58660);function A(e){return A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},A(e)}var S=function(e){return null!==e&&"object"===A(e)&&(Object.keys(e).forEach((function(t){Autodesk.Viewing.i18n.addResourceBundle(t,"allstrings",e[t],!0,!0)})),!0)},M=function(e,t){return(0,n.getGlobal)().LOCALIZATION_REL_PATH="res/locales/"+e+"/",Autodesk.Viewing.i18n.changeLanguage(e).then((function(){return Autodesk.Viewing.i18n.reloadResources()})).then((function(){t&&t()}))},T=function(e){var t=(0,n.getGlobal)(),r=t&&t.document;Autodesk.Viewing.i18n.localize=function(e){var t=e||r;Array.prototype.forEach.call(t.querySelectorAll("[data-i18n]"),(function(e){var t=e.getAttribute("data-i18n"),r=[null,t],n=r[0],i=r[1],o=Autodesk.Viewing.i18n.translate(i);o?n?e.setAttribute(n,o):e.placeholder?e.placeholder=o:e.textContent=o:n?e.setAttribute(n,i):e.textContent=i}))};var i=e&&e.language||navigator.language,o=w.Lang.getSupported(i);Autodesk.Viewing.i18n.use(E).init({lng:i,backend:{loadPath:Autodesk.Viewing.Private.getResourceUrl("res/locales/%(lng)/%(ns).json")},ns:"allstrings",defaultNS:"allstrings",fallbackLng:"en",debug:!1,useCookie:!1,interpolation:{prefix:"%(",suffix:")",escapeValue:!1}}),M(o)}},58660:e=>{"use strict";var t=new function(){this.names=[{symbol:"en",label:"English"},{symbol:"zh-Hans",label:"Chinese Simplified"},{symbol:"zh-Hant",label:"Chinese Traditional"},{symbol:"zh-HK",label:"Hong Kong Traditional"},{symbol:"ja",label:"Japanese"},{symbol:"cs",label:"Czech"},{symbol:"ko",label:"Korean"},{symbol:"pl",label:"Polish"},{symbol:"ru",label:"Russian"},{symbol:"fr",label:"French"},{symbol:"fr-CA",label:"Canadian French"},{symbol:"de",label:"German"},{symbol:"it",label:"Italian"},{symbol:"nl",label:"Dutch"},{symbol:"es",label:"Spanish"},{symbol:"pt-BR",label:"Portuguese Brazil"},{symbol:"tr",label:"Turkish"},{symbol:"sv",label:"Swedish"},{symbol:"da",label:"Danish"},{symbol:"no",label:"Norwegian"},{symbol:"en-GB",label:"British English"}],this.isSupported=function(e){for(var t=0;t<this.names.length;++t)if(this.names[t].symbol===e)return!0;return!1},this.getSupported=function(e){var t=e.split("-");if(e=t[0].toLowerCase(),t.length>1){var r=t[1].toUpperCase();r.length>2&&(r=r[0]+r.substring(1).toLowerCase()),e+="-"+r}return this.isSupported(e)||(e=e.indexOf("zh-CN")>-1?"zh-Hans":e.indexOf("zh-TW")>-1?"zh-Hant":t.length>1&&this.isSupported(t[0].toLowerCase())?t[0]:"en"),e},this.getLanguages=function(){return this.names.slice()}};e.exports={Lang:t}},17167:(e,t,r)=>{"use strict";r.r(t),r.d(t,{DISABLE_FORGE_LOGO:()=>s,DISABLE_FORGE_CANVAS_LOGO:()=>l,getScript:()=>u,injectCSS:()=>c,getHtmlTemplate:()=>h,isExperimentalFlagEnabled:()=>d,getResourceUrl:()=>f,getParameterByName:()=>p,getParameterByNameFromPath:()=>m,stringToDOM:()=>g,toUrlSafeBase64:()=>v,fromUrlSafeBase64:()=>y});var n=r(84998),i=(0,n.getGlobal)(),o=i,a=o&&o.document;i.LOCALIZATION_REL_PATH="",i.LMV_VIEWER_VERSION="7.67.0",i.LMV_BUILD_TYPE="Production",i.LMV_RESOURCE_ROOT="",i.LMV_IS_FLUENT_BUILD=!1,i.USE_OTG_DS_PROXY=!1,i.LMV_THIRD_PARTY_COOKIE=!(0,n.isNodeJS)()&&void 0,"v"===i.LMV_VIEWER_VERSION.charAt(0)&&(i.LMV_VIEWER_VERSION=i.LMV_VIEWER_VERSION.substr(1)),i.LMV_VECTOR_PDF=!1,i.LMV_RASTER_PDF=!0;var s=!1,l=!0;function u(e){e=e.toLowerCase();var t=a.getElementsByTagName("SCRIPT");if(t&&t.length>0)for(var r=0;r<t.length;++r)if(t[r].src&&-1!==t[r].src.toLowerCase().indexOf(e))return t[r];return null}function c(e,t,r){for(var n=e.indexOf("://")>0?e:f(e),i=a.getElementsByTagName("link"),o=0,s=i.length;o<s;o++)if(i[o].href===n)return void(t&&t());var l=a.createElement("link");l.setAttribute("rel","stylesheet"),l.setAttribute("type","text/css"),l.setAttribute("href",n),t&&(l.onload=t),r&&(l.onerror=r),a.head.appendChild(l)}function h(e,t){var r=e.indexOf("://")>0?e:f(e),n=new XMLHttpRequest;function i(e){t(e,null)}n.onload=function(e){var r=e.currentTarget.responseText;t(null,r)},n.onerror=i,n.ontimeout=i,n.open("GET",r,!0),n.send()}function d(e,t){return!(!t||!Array.isArray(t.experimental))&&-1!==t.experimental.indexOf(e)}function f(e){return i.LMV_RESOURCE_ROOT+e}function p(e){return"undefined"==typeof window?"":m(e,o.location.href)}function m(e,t){e=e.replace(/[[]/,"\\[").replace(/[\]]/,"\\]");var r=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(t);return null==r?"":decodeURIComponent(r[1].replace(/\+/g," "))}function g(e){var t=a.createElement("div");return t.innerHTML=e,t.firstChild}function v(e){return btoa(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}function y(e){for(e=(e=e.replace(/-/g,"+")).replace(/_/g,"/");e.length%4;)e+="=";return(0,n.isNodeJS)()?Buffer.from(e,"base64").toString():atob(e)}},36311:(e,t,r)=>{"use strict";r.r(t),r.d(t,{AlertBox:()=>i});var n=r(71224);function i(){}i.instances=[],i.displayError=function(e,t,r,o,a,s){var l=e.ownerDocument,u=l.createElement("div");u.className="alert-box error",e.appendChild(u);var c=o;c||(c="img-item-not-found");var h=l.createElement("div");h.className="alert-box-image "+c,u.appendChild(h);var d=l.createElement("div");d.className="alert-box-msg",u.appendChild(d);var f=r;f||(f=n.Z.t("Error Occurred",{defaultValue:"Error Occurred"}));var p=l.createElement("div");p.className="alert-box-title",p.textContent=f,p.setAttribute("data-i18n",f),d.appendChild(p);var m=l.createElement("div");if(m.className="alert-box-text",m.textContent=t,m.setAttribute("data-i18n",t),d.appendChild(m),a){var g=l.createElement("div");g.className="alert-box-content",d.appendChild(g);var v=l.createElement("ul");v.className="alert-box-content";for(var y=0;y<a.length;y++){var b=a[y];if(b){var x=l.createElement("li"),_=this.extractList(b);if(_.list.length){var E=this.generateListElement(list,l);v.appendChild(E)}x.innerHTML=_.msg,x.setAttribute("data-i18n",_.msg),v.appendChild(x)}}g.appendChild(v)}var w=l.createElement("div");w.className="alert-box-ok",w.textContent=n.Z.t("OK",{defaultValue:"OK"});var A={alertBox:u,container:e,tag:s};w.addEventListener("click",(function(t){u.style.visibility="hidden",e.removeChild(u),i.instances.splice(i.instances.indexOf(A),1)})),u.appendChild(w),u.style.visibility="visible",i.instances.push(A)},i.displayErrors=function(e,t,r){var o=e.ownerDocument,a=o.createElement("div");a.className="alert-box errors",e.appendChild(a);var s=t;s||(s="img-item-not-found");var l=o.createElement("div");l.className="alert-box-image "+s,a.appendChild(l);var u=o.createElement("div");u.className="alert-box-msg errors",a.appendChild(u);for(var c=0;c<r.length;c++){var h=r[c].header;h||(h=n.Z.t("Error",{defaultValue:"Error"}));var d=o.createElement("div");d.className="alert-box-title errors",d.textContent=h,u.appendChild(d);var f=o.createElement("div");f.className="alert-box-text errors";var p=r[c].msg;if((_=this.extractList(p)).list.length){var m=o.createElement("div"),g=this.generateListElement(_.list,o);m.appendChild(g),f.textContent=_.msg,f.appendChild(m)}else f.textContent=p;if(u.appendChild(f),r[c].hints){var v=o.createElement("ul");v.className="alert-box-content";for(var y=r[c].hints,b=0;b<y.length;b++){var x=y[b];if(x){var _,E=o.createElement("li");if(v.appendChild(E),(_=this.extractList(x)).list.length){g=this.generateListElement(_.list,o);v.appendChild(g)}E.innerHTML=_.msg}}u.appendChild(v)}}var w=o.createElement("div");w.className="alert-box-ok",w.textContent=n.Z.t("OK",{defaultValue:"OK"});var A={alertBox:a,container:e};w.addEventListener("click",(function(t){a.style.visibility="hidden",e.removeChild(a),i.instances.splice(i.instances.indexOf(A),1)})),a.appendChild(w),a.style.visibility="visible",i.instances.push(A)},i.extractList=function(e){var t={msg:e,list:[]};if(e&&-1!=e.indexOf("<ul>")){var r=e.split("<ul>");t.msg=r[0],r=r[1].split("</ul>"),t.list=r[0].split(", "),1===t.list.length&&(t.list=r[0].split(","))}return t},i.generateListElement=function(e,t){for(var r=t.createElement("ul"),n=0;n<e.length;n++){var i=t.createElement("li");i.textContent=e[n],i.setAttribute("data-i18n",e[n]),r.appendChild(i)}return r},i.dismissByTag=function(e){var t=i.instances.findIndex((function(t){return t&&t.tag===e}));if(-1==t)return!1;var r=i.instances[t];return r.alertBox.style.visibility="hidden",r.container.removeChild(r.alertBox),i.instances.splice(t,1),!0},i.dismiss=function(){if(i.instances.length>0){var e=i.instances.pop();return e.alertBox.style.visibility="hidden",e.container.removeChild(e.alertBox),!0}return!1}},74593:(e,t,r)=>{"use strict";r.r(t),r.d(t,{OptionSlider:()=>u,OptionCheckbox:()=>c,OptionLabel:()=>h,OptionButton:()=>d,OptionDropDown:()=>f,ResizeFooter:()=>p,OptionRow:()=>m,SimpleList:()=>g});var n=r(62546),i=r(71224),o=r(84998),a=r(35449);function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var l=r(41145);function u(e,t,r,n,o){var a=this;this.tbody=n;var s=o&&o.insertAtIndex?o.insertAtIndex:-1;this.hideStepper=o&&o.hideStepper;var l=o&&o.hideCaption;this.sliderRow=this.tbody.insertRow(s),this.sliderRow.classList.add("switch-slider-row");var u=this.getDocument(),c=this.sliderRow.insertCell(0);function h(e){e.target!=a.stepperElement&&(a.stepperElement.value=a.sliderElement.value),a.fireChangeEvent()}this.caption=u.createElement("div"),this.caption.setAttribute("data-i18n",e),this.caption.textContent=i.Z.t(e),l&&(this.caption.style.display="none"),c.appendChild(this.caption),c=this.sliderRow.insertCell(1),this.sliderElement=u.createElement("input"),this.sliderElement.type="range",this.sliderElement.id=e+"_slider",this.sliderElement.min=t,this.sliderElement.max=r,this.sliderElement.style.width="85%",c.appendChild(this.sliderElement),c=this.sliderRow.insertCell(2),this.stepperElement=u.createElement("input"),this.stepperElement.type="number",this.stepperElement.id=e+"_stepper",this.stepperElement.min=t,this.stepperElement.max=r,this.stepperElement.step=1,this.stepperElement.style.width="64px",this.hideStepper&&(this.stepperElement.style.display="none"),c.appendChild(this.stepperElement),this.blockEvent=!1,this.stepperElement.addEventListener("change",(function(e){e.target!=a.sliderElement&&(a.sliderElement.value=a.stepperElement.value),a.fireChangeEvent()}),!1),this.sliderElement.addEventListener("change",h,!1),this.sliderElement.addEventListener("input",h,!1)}function c(e,t,r,n,a,s){var u=this;this.tbody=t;var c=s&&s.insertAtIndex?s.insertAtIndex:-1;this.sliderRow=this.tbody.insertRow(c),this.sliderRow.classList.add("switch-slider-row");var h=this.getDocument(),d=this.sliderRow.insertCell(0);this.caption=h.createElement("div"),this.caption.setAttribute("data-i18n",e),this.caption.textContent=i.Z.t(e),d.appendChild(this.caption),d=this.sliderRow.insertCell(1),n&&(this.description=h.createElement("div"),this.description.setAttribute("data-i18n",n),this.description.textContent=i.Z.t(n),d.appendChild(this.description),d=this.sliderRow.insertCell(2));var f=h.createElement("label");f.classList.add("switch"),this.checkElement=h.createElement("input"),this.checkElement.type="checkbox",this.checkElement.id=e+"_check",this.checkElement.checked=r,f.appendChild(this.checkElement);var p=h.createElement("div");p.classList.add("slider"),f.appendChild(p),d.appendChild(f),this.blockEvent=!1,this.checked=r,this.checkElement.addEventListener("change",(function(e){u.fireChangeEvent()}),!1),(0,o.isTouchDevice)()&&(this.sliderRowHammer=new l.Manager(this.sliderRow,{recognizers:[[l.Tap]],handlePointerEventMouse:!1,inputClass:o.isIE11?l.PointerEventInput:l.TouchInput}),this.sliderRowHammer.on("tap",(function(e){e.preventDefault(),e.target.click()}))),this.checkElement.addEventListener("click",(function(e){e.stopPropagation()}),!1),this.sliderRow.addEventListener("click",(function(e){u.checkElement.disabled||(u.checkElement.checked=!u.checkElement.checked,u.fireChangeEvent())}),!1)}function h(e,t,r,n){this.tbody=t;var o=n&&n.insertAtIndex?n.insertAtIndex:-1;this.sliderRow=this.tbody.insertRow(o);var a=this.getDocument(),s=this.sliderRow.insertCell(0);this.caption=a.createElement("div"),this.caption.setAttribute("data-i18n",e),this.caption.textContent=i.Z.t(e),s.appendChild(this.caption),s.colSpan="3",this.blockEvent=!1,this.removeFromParent=function(){this.tbody.removeChild(this.sliderRow),this.tbody=null,this.sliderRow=null,this.caption=null}}function d(e,t,r,n){this.tbody=t;var o=n&&n.insertAtIndex?n.insertAtIndex:-1;this.sliderRow=this.tbody.insertRow(o),this.sliderRow.insertCell();var a=this.sliderRow.insertCell();this.sliderRow.insertCell();var s=this.getDocument();this.caption=s.createElement("div"),this.caption.setAttribute("data-i18n",e),this.caption.textContent=i.Z.t(e),this.caption.classList.add("adsk-button"),this.caption.classList.add("table-button"),a.appendChild(this.caption),this.removeFromParent=function(){this.tbody.removeChild(this.sliderRow),this._onClick&&(this.caption.removeEventListener("click",this._onClick),this._onClick=null),this.tbody=null,this.sliderRow=null,this.caption=null},this.setOnClick=function(e){this._onClick=e,this.caption.addEventListener("click",e,!1)}}function f(e,t,r,n,o,a,s){var l=this;this.tbody=t;var u=s&&s.insertAtIndex?s.insertAtIndex:-1;this.sliderRow=this.tbody.insertRow(u);var c=this.getDocument();this.dropdownElement=c.createElement("select"),this.dropdownElement.id=e+"_dropdown",this.dropdownElement.classList.add("option-drop-down");for(var h=0;h<r.length;h++){var d=c.createElement("option");d.value=h,d.setAttribute("data-i18n",r[h]),d.textContent=i.Z.t(r[h]),this.dropdownElement.add(d)}this.selectedIndex=this.dropdownElement.selectedIndex=n;var f=this.sliderRow.insertCell(0);this.caption=c.createElement("div"),this.caption.setAttribute("data-i18n",e),this.caption.textContent=i.Z.t(e),f.appendChild(this.caption),o?(f.colSpan="2",this.sliderRow=this.tbody.insertRow(u),(f=this.sliderRow.insertCell(0)).appendChild(this.dropdownElement),f.colSpan="2",this.dropdownElement.classList.add("tabcell")):(f=this.sliderRow.insertCell(1)).appendChild(this.dropdownElement),f.style.paddingLeft=(s&&void 0!==s.paddingLeft?s.paddingLeft:5)+"px",f.style.paddingRight=(s&&void 0!==s.paddingRight?s.paddingRight:5)+"px",this.blockEvent=!1,this.dropdownElement.addEventListener("change",(function(e){l.fireChangeEvent()}),!1)}function p(e,t,r){this.resizeCallback=t;var n=this.getDocument(),i=n.createElement("div");i.classList.add("docking-panel-footer");var o=n.createElement("div");o.classList.add("docking-panel-footer-resizer"),i.appendChild(o);var a=!1,s=e.getBoundingClientRect(),l={x:0,y:0},u=n.createElement("div");u.classList.add("adsk-viewing-viewer"),u.classList.add("docking-panel-resize-overlay");var c=function(t){a=!0,s=e.getBoundingClientRect(),this.getDocument().body.appendChild(u),this.addDocumentEventListener("touchmove",d),this.addDocumentEventListener("touchcancel",h),this.addDocumentEventListener("touchend",h),this.addDocumentEventListener("mousemove",d),this.addDocumentEventListener("mouseup",h),t.preventDefault(),t.stopPropagation()};c=c.bind(this);var h=function(e){var t=this.getDocument();t.body.contains(u)&&(t.body.removeChild(u),this.removeDocumentEventListener("touchmove",d),this.removeDocumentEventListener("touchcancel",h),this.removeDocumentEventListener("touchend",h),this.removeDocumentEventListener("mousemove",d),this.removeDocumentEventListener("mouseup",h),e.preventDefault(),e.stopPropagation())};h=h.bind(this);var d=function(t){"touchmove"===t.type&&(t.canvasX=t.touches[0].screenX,t.canvasY=t.touches[0].screenY),a&&(a=!1,l.x=t.canvasX||t.clientX,l.y=t.canvasY||t.clientY);var r=(t.canvasX||t.clientX)-l.x,n=(t.canvasY||t.clientY)-l.y,i=parseInt(s.width+r),o=parseInt(s.height+n);e.style.width=i+"px",e.style.height=o+"px",this.resizeCallback&&this.resizeCallback(i,o),t.preventDefault(),t.stopPropagation()};d=d.bind(this),o.addEventListener("touchstart",c),o.addEventListener("mousedown",c),e.style.resize="none",e.appendChild(i),this.footer=i,this.resizer=o}function m(e,t,r,n,o){this.tbody=t;var a=o&&o.insertAtIndex?o.insertAtIndex:-1;this.sliderRow=this.tbody.insertRow(a),this.sliderRow.classList.add("switch-slider-row");var s=this.getDocument(),l=this.sliderRow.insertCell(0);this.caption=s.createElement("div"),this.caption.setAttribute("data-i18n",e),this.caption.textContent=i.Z.t(e),l.appendChild(this.caption),l=this.sliderRow.insertCell(1),r&&(this.description=s.createElement("div"),this.description.setAttribute("data-i18n",r),this.description.textContent=i.Z.t(r),l.appendChild(this.description),l=this.sliderRow.insertCell(2))}u.prototype.constructor=u,n.EventDispatcher.prototype.apply(u.prototype),u.prototype.fireChangeEvent=function(){if(!this.blockEvent){this.value=this.sliderElement.value;var e=new CustomEvent("change",{detail:{target:this,value:this.sliderElement.value}});this.dispatchEvent(e)}},u.prototype.setValue=function(e){this.blockEvent=!0,this.value=e,this.sliderElement.value=e,this.stepperElement.value=e,this.blockEvent=!1},u.prototype.setDisabled=function(e){this.sliderElement.disabled=e,this.stepperElement.disabled=e,this.caption.disabled=e},a.GlobalManagerMixin.call(u.prototype),c.prototype.constructor=c,n.EventDispatcher.prototype.apply(c.prototype),a.GlobalManagerMixin.call(c.prototype),c.prototype.fireChangeEvent=function(){if(!this.blockEvent){this.checked=this.checkElement.checked;var e=new CustomEvent("change",{detail:{target:this,value:this.checkElement.checked}});this.dispatchEvent(e)}},c.prototype.setChecked=function(e){this.checkElement.checked!=e&&(this.checkElement.checked=e,this.fireChangeEvent())},c.prototype.setValue=function(e){this.blockEvent=!0,this.checked=e,this.checkElement.checked=e,this.blockEvent=!1},c.prototype.getValue=function(){return this.checkElement.checked},c.prototype.setDisabled=function(e){this.checkElement.disabled=e,this.caption.disabled=e},c.prototype.setVisibility=function(e){this.sliderRow.style.display=e?"table-row":"none"},a.GlobalManagerMixin.call(h.prototype),a.GlobalManagerMixin.call(d.prototype),f.prototype.constructor=f,n.EventDispatcher.prototype.apply(f.prototype),f.prototype.setSelectedIndex=function(e){this.blockEvent=!0,this.selectedIndex=this.dropdownElement.selectedIndex=e,this.blockEvent=!1},f.prototype.setSelectedValue=function(e){this.blockEvent=!0,this.dropdownElement.selectedValue=e,this.selectedIndex=this.dropdownElement.selectedIndex,this.blockEvent=!1},f.prototype.fireChangeEvent=function(){if(!this.blockEvent){this.selectedIndex=this.dropdownElement.selectedIndex;var e=new CustomEvent("change",{detail:{target:this,value:this.selectedIndex}});this.dispatchEvent(e)}},f.prototype.setDisabled=function(e){this.dropdownElement.disabled=e,this.caption.disabled=e},a.GlobalManagerMixin.call(f.prototype),a.GlobalManagerMixin.call(p.prototype),a.GlobalManagerMixin.call(m.prototype);var g=function(){function e(t,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._parentDiv=t,this._renderRowFn=r,this._onClickFn=n,this._onRowClick=this._onRowClick.bind(this);var i=this.getDocument(),o=i.createElement("div");o.classList.add("settings-container"),this._parentDiv.appendChild(o),this._myContainer=o,this._myContainer.addEventListener("click",this._onRowClick,{capture:!0});var a=i.createElement("div");a.classList.add("settings-table"),this._rowsContainer=a,o.appendChild(a)}var t,r,n;return t=e,(r=[{key:"setData",value:function(e,t){this._removeAllRows(),this._items=e;for(var r=0;r<e.length;++r)this._addRow(r);this._updateSelection(t)}},{key:"removeFromParent",value:function(){this._myContainer.removeEventListener("click",this._onRowClick,{capture:!0}),this._removeAllRows(),this._parentDiv.removeChild(this._myContainer),this._parentDiv=null,this._myContainer=null,this._rowsContainer=null,this._onClickFn=null,this._items=null}},{key:"_addRow",value:function(e){var t=this._items[e],r=this.getDocument(),n=r.createElement("div");this._renderRowFn(n,t,{domDocument:r}),n.setAttribute("data-index",e),this._rowsContainer.appendChild(n)}},{key:"_removeAllRows",value:function(){for(var e=this._rowsContainer.children;e.length;)this._rowsContainer.removeChild(e[0])}},{key:"_updateSelection",value:function(e){for(var t=this._rowsContainer.children,r=0;r<t.length;r++){var n=t[r];r===e?n.classList.add("border-select"):n.classList.remove("border-select")}}},{key:"_onRowClick",value:function(e){for(var t,r=e.target;r!==this._myContainer&&!(t=r.getAttribute("data-index"));)r=r.parentNode;if(t){var n=parseInt(t);this._onClickFn(n)}}}])&&s(t.prototype,r),n&&s(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();a.GlobalManagerMixin.call(g.prototype)},89576:(e,t,r)=>{"use strict";r.r(t),r.d(t,{ContextMenu:()=>l});var n=r(84998),i=r(98926),o=r(71224),a=r(35449),s=r(11294);function l(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.viewer=e,this.setGlobalManager(e.globalManager),this.menus=[],this.container=null,this.open=!1,this._onDOMevent=this._onDOMevent.bind(this),this.onHide=t.onHide}l.prototype.constructor=l,a.GlobalManagerMixin.call(l.prototype),l.prototype.show=function(e,t){var r=this.viewer.container.getBoundingClientRect();Array.isArray(e.changedPointers)&&e.changedPointers.length>0&&(e.clientX=e.changedPointers[0].clientX,e.clientY=e.changedPointers[0].clientY);var n=e.clientX-r.left,i=e.clientY-r.top;this.open||(this.showMenu(t,n,i),this.open=!0),this._startX=e.clientX,this._startY=e.clientY},l.prototype.showMenu=function(e,t,r,o){var a,s=this,l=[],u=this.getDocument(),c=u.createElement("div");c.style.left="0",c.style.top="0",c.style.width="100%",c.style.height="100%",c.style.position="absolute",c.style.zIndex="10";var h=u.createElement("div");h.classList.add("menu"),h.classList.add("docking-panel"),h.classList.add("docking-panel-container-solid-color-a"),c.appendChild(h),this.viewer.container.appendChild(c),this.container=c,this.menus.push(h);for(var d=!1,f=0;f<e.length;++f){var p=e[f],m=p.title,g=p.target,v=p.icon,y=p.shortcut,b=p.divider,x=Array.isArray(g);x&&!e.isChild?d=!0:x=!1,b?(a=this.createDivider(),h.appendChild(a)):(a=this.createMenuItem(m,v,y,x),h.appendChild(a),"function"==typeof g?this.addCallbackToMenuItem(a,g):x?l.push({menuItem:a,target:g}):i.logger.warn("Invalid context menu option:",m,g))}if(!d)for(var _=h.children,E=0;E<_.length;E++){var w=_[E],A=w.getElementsByClassName("menu-item-expand");A.length>0&&w.removeChild(A[0])}var S=h.getBoundingClientRect(),M=S.width,T=S.height,C=this.viewer.container.getBoundingClientRect(),P=C.width,D=C.height;(o=!!o||(0,n.isTouchDevice)()&&!this.viewer.navigation.getUseLeftHandedInput())&&(t-=M),t<0&&(t=0),P<t+M&&(t=P-M)<0&&(t=0),r<0&&(r=0),D<r+T&&(r=D-T)<0&&(r=0),h.style.top=Math.round(r)+"px",h.style.left=Math.round(t)+"px";var L=function(e,t){var r=e.getElementsByClassName("menu-item-expand");e.removeChild(r[0]);var n=e.getElementsByClassName("menu-item-icon");n.length>0&&e.insertBefore(n[0],e.childNodes[e.length-1]),s.setMenuExpand(e,!0,t)},R=!1;for(f=0;f<l.length;++f){var I=l[f],O=(a=I.menuItem).getBoundingClientRect(),N=this.viewer.container.getBoundingClientRect(),k=O.right-O.left;(R=N.right-O.right<k||o)&&L(a,!0),t=Math.round((R?O.left:O.right)-N.left),r=Math.round(O.top-N.top),this.addSubmenuCallbackToMenuItem(a,I.target,t,r,R)}if(l.length>0&&R)for(var F=h.children,V=0;V<F.length;V++){var U=F[V];U.children.length>2&&-1!==U.children[2].className.indexOf("menu-item-expand")&&L(U,!1)}this.container.addEventListener("touchend",this._onDOMevent),this.container.addEventListener("mousedown",this._onDOMevent),this.container.addEventListener("mouseup",this._onDOMevent),(0,n.isTouchDevice)()||this.container.addEventListener("mousemove",this._onDOMevent)},l.prototype._onDOMevent=function(e){switch(e.type){case"touchend":this._isContextMenu(e)||this.hide();break;case"mousedown":this._startX=e.clientX,this._startY=e.clientY;break;case"mouseup":this._isContextMenu(e)||(this.hide(),s.EventUtils.isRightClick(e)&&e.clientX===this._startX&&e.clientY===this._startY&&this.viewer.triggerContextMenu(e));break;case"mousemove":if(!this.currentItem||this.menus.length<2)break;var t=this._isInside(e,this.currentItem),r=this._isInside(e,this.menus[1]);t||r?this.currentItem.backgroundColor&&(this.currentItem.style.backgroundColor=this.currentItem.backgroundColor):(this.hideMenu(this.menus[1]),this.currentItem.style.backgroundColor=null,this.currentItem=null)}},l.prototype.createMenuItem=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=this.getDocument(),o=i.createElement("div");return o.className="menu-item",r=r||"",this.setMenuItemIcon(o,t),this.setMenuItemText(o,e),this.setMenuExpand(o,!1,n),this.setMenuItemShortcut(o,r),o},l.prototype.createDivider=function(){var e=this.getDocument(),t=e.createElement("div");t.className="menu-divider-container";var r=e.createElement("div");return r.className="menu-divider",t.appendChild(r),t},l.prototype.setMenuItemIcon=function(e,t){var r=this.getDocument().createElement("div");r.classList.add("menu-item-icon"),t&&r.classList.add(t),e.appendChild(r)},l.prototype.setMenuItemText=function(e,t){var r=this.getDocument().createElement("div");r.classList.add("menu-item-text"),r.setAttribute("data-i18n",t),r.textContent=o.Z.t(t),e.appendChild(r)},l.prototype.setMenuItemShortcut=function(e,t){var r=this.getDocument().createElement("div");r.classList.add("menu-item-shortcut"),r.textContent=t,e.appendChild(r)},l.prototype.setMenuExpand=function(e,t,r){var n=this.getDocument().createElement("div");n.classList.add("menu-item-expand"),t?(n.style.transform="scale(-1)",e.insertBefore(n,e.childNodes[0])):e.appendChild(n);var i=0|r;n.style.opacity=i},l.prototype.addCallbackToMenuItem=function(e,t){var r=this;e.addEventListener("click",(function(e){return r.hide(),t(),e.preventDefault(),!1}),!1)},l.prototype.addSubmenuCallbackToMenuItem=function(e,t,r,i,o){var a=this;t.isChild=!0,(0,n.isTouchDevice)()?e.addEventListener("click",(function(){a.open=!0,a.currentItem=e,a.showMenu(t,r,i,o)}),!1):e.addEventListener("mouseenter",(function(){if(a._isInside(event,e)){a.open=!0,a.currentItem=e;var n=a.getWindow().getComputedStyle(a.currentItem).getPropertyValue("background-color");a.currentItem.backgroundColor=n,a.showMenu(t,r,i,o)}}),!1)},l.prototype.hideMenu=function(e){var t,r=this;e&&-1!==this.menus.indexOf(e)&&e.parentNode&&((t=e.parentNode).removeEventListener("touchend",r._onDOMevent),t.removeEventListener("mousedown",r._onDOMevent),t.removeEventListener("mouseup",r._onDOMevent),(0,n.isTouchDevice)()||t.removeEventListener("mousemove",r._onDOMevent),t.parentNode.removeChild(t),this.menus.splice(this.menus.indexOf(e),1)),0===this.menus.length?(this.open=!1,this.container=null):1===this.menus.length&&(this.container=this.menus[0].parentNode)},l.prototype.hide=function(){if(this.open){for(;this.menus.length>0;)this.hideMenu(this.menus[0]);return this.onHide&&this.onHide(),!0}return!1},l.prototype._isContextMenu=function(e){for(var t=0;t<this.menus.length;t++)for(var r=this.menus[t],n=e.target;n!==this.container;){if(n===r)return!0;n=n.parentNode}return!1},l.prototype._isInside=function(e,t){var r=this.viewer.container.getBoundingClientRect();Array.isArray(e.changedPointers)&&e.changedPointers.length>0&&(e.clientX=e.changedPointers[0].clientX,e.clientY=e.changedPointers[0].clientY);var n=Math.ceil(e.clientX-r.left),i=Math.ceil(e.clientY-r.top),o=t.getBoundingClientRect(),a=Math.floor(o.top-r.top),s=Math.ceil(o.bottom-r.top),l=Math.floor(o.left-r.left),u=Math.ceil(o.right-r.left);return i>=a&&i<=s&&n>=l&&n<=u}},12074:(e,t,r)=>{"use strict";r.r(t),r.d(t,{DataTable:()=>o});var n=r(52072),i=Autodesk.Viewing.UI;function o(e){if(!(e instanceof i.DockingPanel))throw new Error("Invalid docking panel");this.dockingPanel=e;var t=this.dockingPanel.getDocument();this.datatableDiv=t.createElement("div"),this.datatableDiv.setAttribute("id","datatable"),this.datatableDiv.setAttribute("class","datatable"),e.container.appendChild(this.datatableDiv),e.footerInstance&&(e.footerInstance.resizeCallback=this._fitHeaderColumns.bind(this)),this.groupedByColumn=!1,this.aggregated=!1}o.prototype._createColumns=function(e){var t=this.dockingPanel.getDocument(),r=t.createElement("div");r.setAttribute("id","columnArea"),r.setAttribute("class","clusterize-headers");var n='<table id="headersArea"><thead><tr id ="columnRow"></tr></thead></table>';r.innerHTML=n,this.datatableDiv.appendChild(r);var i=r.querySelector("tr");e.forEach((function(e){var r=t.createElement("th");r.appendChild(t.createTextNode(e)),i.appendChild(r)})),n=this.datatableDiv.querySelector("table"),this._makeTableSortable(n)},o.prototype._createRows=function(){var e=this.dockingPanel.getDocument().createElement("div");e.innerHTML='<div id="scrollArea" class="clusterize-scroll"><table id="bodyArea" class="table-striped"><tbody id="contentArea" class="clusterize-content"><tr class="clusterize-no-data"><td>Loading data</td></tr></tbody></table></div>',this.datatableDiv.appendChild(e)},o.prototype.setData=function(e,t){if(t.length!==e[0].length)throw new Error("Column length should be same as the row length");this._createColumns(t),this._createRows();var r=this;this.rowData=e,this.clusterize=new n({rows:this.rowData.map((function(e){return"<tr>"+e.map((function(e){return"<td>"+e+"</td>"})).join(" ")+"</tr>"})),scrollId:"scrollArea",contentId:"contentArea",callbacks:{clusterChanged:function(){r._fitHeaderColumns(),r._syncHeaderWidth(),r.groupedByColumn&&r._updateClusterGroup()}}}),this.datatableDiv.querySelector(".clusterize-scroll").addEventListener("scroll",(function(){var e=this.scrollLeft;i(e)}));var i=function(e){r.datatableDiv.querySelector("#headersArea").style.setProperty("margin-left",-e+"px")}},o.prototype.destroyTable=function(){this.clusterize.destroy(!0),this.clusterize=null,this.rowData=null,this.groupedByColumn=!1},o.prototype._makeTableSortable=function(e){var t,r=this,n=e.tHead;if(n&&n.rows[0]&&(n=n.rows[0].cells),n)for(t=n.length;--t>=0;)!function(e){var t=1;n[e].addEventListener("click",(function(){r._sortTable(e,t=1-t)}))}(t)},o.prototype._sortTable=function(e,t){var r=this.rowData;this.sortFunction||this.restoreDefaultSortFunction();var n=this.sortFunction&&this.sortFunction.bind(this),i=(r=r.sort(n(e,t))).map((function(e){return"<tr>"+e.map((function(e){return"<td>"+e+"</td>"})).join(" ")+"</tr>"}));this.clusterize.update(i);var o=this.datatableDiv.querySelector("#bodyArea");o.classList.contains("table-striped")||o.classList.add("table-striped")},o.prototype.setSortFunction=function(e){this.sortFunction=e},o.prototype.getSortFunction=function(){return this.sortFunction},o.prototype.restoreDefaultSortFunction=function(){this.sortFunction=function(e,t){return t=-(+t||-1),function(r,n){return t*r[e].localeCompare(n[e])}}},o.prototype.getGroupByColumn=function(e){for(var t=this.rowData,r={},n=0;n<t.length;n++){var i=t[n][e];r[i]||(r[i]=[]),r[i].push(n)}return r},o.prototype.groupByColumn=function(e){for(var t=this,r=this.rowData,n={},i=0;i<r.length;i++){var o=r[i],a=o[e];if(n[a]||(n[a]=[]),n[a].length>0)o="<tr class= 'subrow'>"+o.map((function(e){return"<td>"+e+"</td>"})).join(" ")+"</tr>";else!function(){var e=o.length;'<span value="click"></span>',o="<tr class= 'parentrow'>"+o.map((function(t,r){return e===r+1?"<td>"+t+'<span value="click"></span></td>':"<td>"+t+"</td>"})).join(" ")+"</tr>"}();n[a].push(o)}var s=[];for(var l in n)for(var u=n[l],c=0;c<u.length;c++){var h=u[c];s.push(h)}this.clusterize.update(s);var d=this.datatableDiv.querySelector("#bodyArea");d.classList.contains("table-striped")&&d.classList.remove("table-striped"),this.datatableDiv.querySelectorAll(".subrow").forEach((function(e){t._slideDown(e),e.style.fontSize="14px"}));var f=this._fitHeaderColumns.bind(this),p=this._expandContent.bind(this);this.datatableDiv.querySelectorAll("span").forEach((function(e){e.addEventListener("click",(function(e){p(this,e),f()}))})),this._fitHeaderColumns(),this.groupedByColumn||(this.groupedByColumn=!0)},o.prototype._updateClusterGroup=function(){var e=this,t=this._fitHeaderColumns.bind(this),r=this._expandContent.bind(this);this.datatableDiv.querySelectorAll("span").forEach((function(e){e.addEventListener("click",(function(e){r(this,e),t()}))})),this.datatableDiv.querySelectorAll(".subrow").forEach((function(t){e._slideDown(t),t.style.fontSize="14px"}))},o.prototype._expandContent=function(e){var t=!1;"collapsed"===e.className&&(t=!0);for(var r=t?14:0,n=e.closest("tr"),i=this._nextUntil(n,":not(.subrow)"),o=0;o<i.length;o++)this._slideToggle(i[o],500),i[o].style.fontSize=r+"px";e.classList.toggle("collapsed")},o.prototype._nextUntil=function(e,t,r){var n=[];for(e=e.nextElementSibling;e&&!e.matches(t);)!r||e.matches(r)?(n.push(e),e=e.nextElementSibling):e=e.nextElementSibling;return n},o.prototype._slideToggle=function(e,t){return"none"===this.dockingPanel.getWindow().getComputedStyle(e).display?this._slideDown(e,t):this._slideUp(e,t)},o.prototype._slideUp=function(e,t){e.style.transitionProperty="height, margin, padding",e.style.transitionDuration=t+"ms",e.style.boxSizing="border-box",e.style.height=e.offsetHeight+"px",e.offsetHeight,e.style.overflow="hidden",e.style.height=0,e.style.paddingTop=0,e.style.paddingBottom=0,e.style.marginTop=0,e.style.marginBottom=0,e.style.display="none",e.style.removeProperty("height"),e.style.removeProperty("padding-top"),e.style.removeProperty("padding-bottom"),e.style.removeProperty("margin-top"),e.style.removeProperty("margin-bottom"),e.style.removeProperty("overflow"),e.style.removeProperty("transition-duration"),e.style.removeProperty("transition-property")},o.prototype._slideDown=function(e,t){var r=this.dockingPanel.getWindow();e.style.removeProperty("display");var n=r.getComputedStyle(e).display;"none"===n&&(n="block"),e.style.display=n;e.style.overflow="hidden",e.style.height=0,e.style.paddingTop=0,e.style.paddingBottom=0,e.style.marginTop=0,e.style.marginBottom=0,e.offsetHeight,e.style.boxSizing="border-box",e.style.transitionProperty="height, margin, padding",e.style.transitionDuration=t+"ms",e.style.height="21pxpx",e.style.removeProperty("padding-top"),e.style.removeProperty("padding-bottom"),e.style.removeProperty("margin-top"),e.style.removeProperty("margin-bottom"),r.setTimeout((function(){e.style.removeProperty("height"),e.style.removeProperty("overflow"),e.style.removeProperty("transition-duration"),e.style.removeProperty("transition-property")}),t)},o.prototype.getAggregate=function(e,t){var r,n=this.rowData,i=null;switch(e){case"MIN":i=function(){for(var e=n[0][t],r=1;r<n.length;r++)e>n[r][t]&&(e=n[r][t]);return e||0}();break;case"MAX":i=function(){for(var e=n[0][t],r=1;r<n.length;r++)e<n[r][t]&&(e=n[r][t]);return e||0}();break;case"SUM":i=o();break;case"AVG":r=o()/n.length,i=(r=parseFloat(r))||0;break;case"COUNT":i=n.length}return i;function o(){for(var e=0,r=0;r<n.length;r++)e+=parseFloat(n[r][t]);return e||0}},o.prototype.aggregate=function(e,t){var r=this.datatableDiv.querySelector(".clusterize-content").querySelector("tr:not(.clusterize-extra-row):not(.first)");if(r){for(var n=[],i=0;i<r.children.length;i++)n.push(r.children[i].clientWidth);var o=this.getAggregate(e,t),a=this.dockingPanel.getDocument();if(!this.aggregated){var s=a.createElement("div");s.setAttribute("id","aggregate"),s.setAttribute("class","aggregate-headers");s.innerHTML='<table id="aggregateArea"><tbody></tbody></table>',this.datatableDiv.appendChild(s)}for(var l=this.datatableDiv.querySelector("#aggregateArea"),u=0;u<l.rows.length;u++){if(l.rows[u].cells[t].innerText.indexOf(e)>-1)return}for(var c=0;c<l.rows.length;c++){var h=l.rows[c].cells[t];if(0===h.innerText.length)return h.appendChild(a.createTextNode(e+": ")),void h.appendChild(a.createTextNode(o))}for(var d=l.insertRow(l.rows.length),f=0;f<n.length;f++){var p=a.createElement("td");d.appendChild(p),p.style.setProperty("min-width",n[f]+"px","important"),f===t&&(p.appendChild(a.createTextNode(e+": ")),p.appendChild(a.createTextNode(o)))}this.aggregated=!0}},o.prototype.clearAggregates=function(){for(var e=this.datatableDiv.querySelectorAll(".aggregate-headers"),t=0;t<e.length;t++)e[t].parentNode.removeChild(e[t])},o.prototype._fitHeaderColumns=function(){var e=this.datatableDiv.querySelector(".clusterize-content"),t=this.datatableDiv.querySelector("#headersArea"),r=e.querySelector("tr:not(.clusterize-extra-row):not(.first)");if(r){for(var n=[],i=[],o=0;o<r.children.length;o++)i.push(r.children[o].clientWidth);if(i.toString()!=n.toString()){for(var a=t.querySelector("tr"),s=0;s<a.children.length;s++)a.children[s].style.setProperty("clientWidth",i[s]+"px","important"),a.children[s].style.setProperty("min-width",i[s]+"px","important");if(this.aggregated)for(var l=this.datatableDiv.querySelector("#aggregateArea"),u=0;u<l.rows.length;u++)for(var c=l.rows[u],h=0;h<c.children.length;h++)c.children[h].style.setProperty("clientWidth",i[h]+"px","important"),c.children[h].style.setProperty("min-width",i[h]+"px","important");n=i}}},o.prototype._syncHeaderWidth=function(){var e=this.datatableDiv.querySelector(".clusterize-content"),t=this.datatableDiv.querySelector("#headersArea");t.style.setProperty("clientWidth",e.width),t.style.setProperty("min-idth",e.width)}},76723:(e,t,r)=>{"use strict";r.r(t),r.d(t,{DockingPanel:()=>o});var n=r(71224),i=r(74593);function o(e,t,r,n){this.kMinWdth=100,this.kMinHeight=100,this.visibilityCallbacks=[],this.movedSinceLastClick=!1,this.movedSinceCreate=!1,this.parentContainer=e;var i=this.getDocument();this.container=i.createElement("div"),this.container.id=t,this.container.lastWidth="",this.container.dockRight=!1,this.container.dockBottom=!1,this.titleLabel=r,n=n||{},Object.prototype.hasOwnProperty.call(n,"localizeTitle")||(n.localizeTitle=!0),Object.prototype.hasOwnProperty.call(n,"addFooter")||(n.addFooter=!0),this.options=n,this.container.classList.add("docking-panel"),e.appendChild(this.container),this.listeners=[],this.initialize(),this.setVisible(!1)}r(35449).GlobalManagerMixin.call(o.prototype),o.prototype.onSetGlobalManager=function(e){this.footerInstance&&this.footerInstance.setGlobalManager(e)},o.prototype.initialize=function(){this.title=this.createTitleBar(this.titleLabel||this.container.id),this.container.appendChild(this.title),this.initializeMoveHandlers(this.title),this.setTitle(this.titleLabel||this.container.id,this.options),this.closer=this.createCloseButton(),this.container.appendChild(this.closer),this.options.addFooter&&(this.footer=this.createFooter(),this.container.appendChild(this.footer))},o.prototype.uninitialize=function(){for(var e=0;e<this.listeners.length;++e){var t=this.listeners[e];t.target.removeEventListener(t.eventId,t.callback)}this.listeners=[],this.visibilityCallbacks=[],this.parentContainer.removeChild(this.container),this.parentContainer=null,this.container=null,this.title=null,this.closer=null},o.prototype.addVisibilityListener=function(e){this.visibilityCallbacks.push(e)},o.prototype.setVisible=function(e){if(e){var t=this.getContainerBoundingRect();if(this.container.dockRight){var r=t.width,n=300,i=this.container.lastWidth||this.container.style.width;i||(i=this.container.getBoundingClientRect().width),i&&(n=parseInt(i)),this.container.style.left=r-n+"px"}if(this.container.dockBottom){var o=t.height,a=300,s=this.container.lastHeight||this.container.style.height;s||(s=this.container.getBoundingClientRect().height),s&&(a=parseInt(s));var l=o-a;this.container.style.top=l>0?l+"px":0}this.container.style.maxHeight=t.height+"px",this.container.style.maxWidth=t.width+"px",this.container.style.display="block",this.bringToFront()}else this.container.lastWidth=this.container.style.width,this.container.lastHeight=this.container.style.height,this.container.style.display="none";for(var u=0;u<this.visibilityCallbacks.length;u++)this.visibilityCallbacks[u](e)},o.prototype.isVisible=function(){return"block"===this.container.style.display},o.prototype.visibilityChanged=function(){},o.prototype.initializeMoveHandlers=function(e){var t,r,n,i,o,a,s,l,u=this.container,c=this;function h(e){var h=u.style.minWidth?parseInt(u.style.minWidth):c.kMinWdth,d=u.style.minHeight?parseInt(u.style.minHeight):c.kMinHeight,f=c.getContainerBoundingRect();u.style.maxWidth&&parseInt(u.style.width)>parseInt(u.style.maxWidth)&&(u.style.width=u.style.maxWidth),u.style.maxHeight&&parseInt(u.style.height)>parseInt(u.style.maxHeight)&&(u.style.height=u.style.maxHeight),parseInt(u.style.width)<h&&(u.style.width=h+"px"),parseInt(u.style.height)<d&&(u.style.height=d+"px"),"touchmove"===e.type&&(e.screenX=e.touches[0].screenX,e.screenY=e.touches[0].screenY),s+=e.screenX-n,l+=e.screenY-i,t=o+s,r=a+l;var p=parseInt(u.style.width),m=parseInt(u.style.height);isNaN(p)&&(p=c.container.getBoundingClientRect().width),isNaN(m)&&(m=c.container.getBoundingClientRect().height),t<5&&(t=0),r<5&&(r=0),u.dockRight=!1,u.dockBottom=!1,f.width-5<t+p&&(t=f.width-p,u.dockRight=!0),f.height-5<r+m&&(r=f.height-m,u.dockBottom=!0),u.style.left=t+"px",u.style.top=r+"px",u.style.maxWidth=f.width-t+"px",u.style.maxHeight=f.height-r+"px",n=e.screenX,i=e.screenY,c.onMove(e,t,r)}function d(e){c.removeWindowEventListener("mousemove",h),c.removeWindowEventListener("mouseup",d),c.removeWindowEventListener("touchmove",h),c.removeWindowEventListener("touchend",d),c.onEndMove(e,t,r)}function f(e){"touchstart"===e.type&&(e.screenX=e.touches[0].screenX,e.screenY=e.touches[0].screenY),n=e.screenX,i=e.screenY,s=0,l=0,o=c.container.offsetLeft,a=c.container.offsetTop,c.addWindowEventListener("mousemove",h,!1),c.addWindowEventListener("mouseup",d,!1),c.addWindowEventListener("touchmove",h,!1),c.addWindowEventListener("touchend",d,!1),e.preventDefault(),c.onStartMove(e,o,a)}c.addEventListener(e,"mousedown",f),c.addEventListener(e,"touchstart",f)},o.prototype.initializeCloseHandler=function(e){var t=this;t.addEventListener(e,"click",(function(){t.setVisible(!1)}),!1)},o.prototype.createScrollContainer=function(e){var t=this.getDocument().createElement("div"),r=t.classList;return r.add("docking-panel-scroll"),r.add("docking-panel-container-solid-color-a"),r.add(e&&e.left?"left":"right"),e&&e.heightAdjustment&&(t.style.height="calc(100% - "+e.heightAdjustment+"px)"),e&&e.marginTop&&(t.style.marginTop=e.marginTop+"px"),t.id=this.container.id+"-scroll-container",this.container.appendChild(t),this.scrollContainer=t,this.scrollEaseCurve=e&&e.scrollEaseCurve||[0,0,.29,1],this.scrollEaseSpeed=e&&e.scrollEaseSpeed||.003,t},o.prototype.createTitleBar=function(e){var t=this.getDocument().createElement("div");t.classList.add("docking-panel-title"),t.textContent=e;var r=this;return r.addEventListener(t,"click",(function(e){r.movedSinceLastClick||r.onTitleClick(e),r.movedSinceLastClick=!1})),r.addEventListener(t,"mousedown",(function(){r.bringToFront()})),r.addEventListener(t,"dblclick",(function(e){r.onTitleDoubleClick(e)})),t},o.prototype.createFooter=function(){var e=new i.ResizeFooter(this.container);return e.setGlobalManager(this.globalManager),this.footerInstance=e,this.container.style.resize="none",e.footer},o.prototype.setTitle=function(e,t){t&&t.localizeTitle?(this.title.setAttribute("data-i18n",e),e=n.Z.t(e,t.i18nOpts)):this.title.removeAttribute("data-i18n"),this.title.textContent=e},o.prototype.createCloseButton=function(){var e=this.getDocument().createElement("div");return e.className="docking-panel-close",this.initializeCloseHandler(e),e},o.prototype.onStartMove=function(){},o.prototype.onEndMove=function(){},o.prototype.onMove=function(){this.movedSinceLastClick=!0,this.movedSinceCreate=!0},o.prototype.onTitleClick=function(){},o.prototype.onTitleDoubleClick=function(){},o.prototype.addEventListener=function(e,t,r){e.addEventListener(t,r),this.listeners.push({target:e,eventId:t,callback:r})},o.prototype.removeEventListener=function(e,t,r){for(var n=0;n<this.listeners.length;++n){var i=this.listeners[n];if(i.target===e&&i.eventId===t&&i.callback===r)return e.removeEventListener(t,r),this.listeners.splice(n,1),!0}return!1},o.prototype.getContentSize=function(){return{height:this.container.clientHeight,width:this.container.clientWidth}},o.prototype.resizeToContent=function(e){if(this.isVisible()){var t=this.getContentSize().height,r=this.container.getBoundingClientRect(),n=this.getContainerBoundingRect(),i=this.container.querySelector(".docking-panel-footer");i&&(t+=i.getBoundingClientRect().height);var o=n.height;o-=r.top-n.top+75,e&&void 0!==e.maxHeight&&(o=Math.min(o,e.maxHeight)),t>o&&(t=o),this.container.style.maxHeight=o.toString()+"px",this.container.style.height=t.toString()+"px"}},o.prototype.getContainerBoundingRect=function(){return this.parentContainer.getBoundingClientRect()},o.prototype.animateScroll=function(e,t,r){var n=this.scrollEaseCurve,i=this.scrollEaseSpeed,o=this.scrollContainer;var a=performance.now();requestAnimationFrame((function s(l){var u=(l-a)*i;u=Math.min(u,1);var c=function(e,t){var r=3*e[1],n=3*(e[3]-e[1])-r;return(((1-r-n)*t+n)*t+r)*t}(n,u),h=e+(t-e)*c;o.scrollTop=h,r&&r(h),u<1&&requestAnimationFrame(s)}))},o.prototype.onViewerResize=function(e,t,r,n,i,o){var a=this.container,s=a.getBoundingClientRect(),l=s.width,u=s.height;if(!l||!u)return!1;var c=s.top,h=s.bottom,d=s.left,f=s.right;return i<l&&(l=Math.round(i),a.style.width=l+"px"),o<u&&(u=Math.round(o),a.style.height=u+"px"),(n<f||a.dockRight)&&(d=Math.round(n-l-r),a.style.left=d+"px"),(t<h||a.dockBottom)&&((c=Math.round(t-u-e))<0&&(c=0),a.style.top=c+"px"),a.style.maxWidth=Math.round(i)+"px",a.style.maxHeight=Math.round(o)+"px",!0},o.prototype.bringToFront=function(){var e=this.scrollContainer?this.scrollContainer.scrollTop:0;this.parentContainer.appendChild(this.container),this.scrollContainer&&(this.scrollContainer.scrollTop=e)}},96250:(e,t,r)=>{"use strict";r.r(t),r.d(t,{ErrorHandler:()=>u});var n=r(36311),i=r(98926),o=r(71224),a=r(26261);function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}var l={1:{img:"img-reload","globalized-msg":"Viewer-UnknownFailure","default-msg":"<title> Sorry </title><message>We seem to have some technical difficulties and couldn't complete your request.</message><hint>Try loading the item again. </hint><hint>Please verify your Internet connection, and refresh the browser to see if that fixes the problem.</hint>"},2:{img:"img-unsupported","globalized-msg":"Viewer-BadData","default-msg":"<title> Sorry </title><message>The item you are trying to view was not processed completely. </message><hint>Try loading the item again.</hint><hint>Please upload the file again to see if that fixes the issue.</hint>"},3:{img:"img-reload","globalized-msg":"Viewer-NetworkError","default-msg":"<title> Sorry </title><message>We seem to have some technical difficulties and couldn't complete your request.</message><hint> Try loading the item again.</hint><hint> Please verify your Internet connection, and refresh the browser to see if that fixes the problem.</hint>"},4:{img:"img-unlock","globalized-msg":"Viewer-AccessDenied","default-msg":"<title> No access </title><message>Sorry. You dont have the required privileges to access this item.</message><hint> Please contact the author</hint>"},5:{img:"img-item-not-found","globalized-msg":"Viewer-FileNotFound","default-msg":'<title> Sorry </title><message>We cant display the item you are looking for. It may not have been processed yet. It may have been moved, deleted, or you may be using a corrupt file or unsupported file format.</message><hint> Try loading the item again.</hint><hint> Please upload the file again to see if that fixes the issue.</hint><hint> <a href="http://help.autodesk.com/view/ADSK360/ENU/?guid=GUID-488804D0-B0B0-4413-8741-4F5EE0FACC4A" target="_blank">See a list of supported formats.</a></hint>'},6:{img:"img-reload","globalized-msg":"Viewer-ServerError","default-msg":"<title> Sorry </title><message>We seem to have some technical difficulties and couldn't complete your request.</message><hint> Try loading the item again.</hint><hint> Please verify your Internet connection, and refresh the browser to see if that fixes the problem.</hint>"},7:{img:"img-reload","globalized-msg":"Viewer-UnhandledResponseCode","default-msg":"<title> Network problem </title><message>Sorry. We seem to have some technical difficulties and couldn't complete your request.</message><hint> Try loading the item again.</hint><hint> Please verify your Internet connection, and refresh the browser to see if that fixes the problem.</hint>"},8:{img:"img-unsupported","globalized-msg":"Viewer-WebGlNotSupported","default-msg":'<title>Sorry</title><message>We can\'t show this item because this browser doesn\'t support WebGL.</message><hint>Try Google Chrome, Mozilla Firefox, or another browser that supports WebGL 3D graphics.</hint><hint>For more information, see the <a href="WEBGL_HELP" target="_blank">A360 browser reqirements.</a></hint>'},9:{img:"img-item-not-found","globalized-msg":"Viewer-NoViewable","default-msg":"<title> No viewable content </title><message>Theres nothing to display for this item. It may not have been processed or it may not have content we can display.</message><hint> Please contact the author.</hint><hint> Please upload the file again to see if that fixes the issue.</hint>"},10:{img:"img-unsupported","globalized-msg":"Viewer-WebGlDisabled","default-msg":'<title>Sorry</title><message>We can\'t show this item because WebGL is disabled on this device.</message><hint> For more information see the <a href="WEBGL_HELP" target="_blank">A360 Help.</a></hint>'},11:{img:"img-item-not-found","globalized-msg":"Viewer-ModeIsEmpty","default-msg":"<title>Model is empty</title><message>Model is empty, there is no geometry for the viewer to show.</message><hint> Please contact the author.</hint><hint> Please upload the file again to see if that fixes the issue.</hint>"},12:{img:"img-unsupported","globalized-msg":"Viewer-RTCError","default-msg":"<title> Sorry </title><message>We couldnt connect to the Collaboration server.</message><hint> Please verify your Internet connection, and refresh the browser to see if that fixes the problem.</hint>"},13:{img:"img-unsupported","globalized-msg":"Viewer-FileExtNotSupported","default-msg":{title:"Sorry",message:"The file extension loaded into the Viewer is not supported",hints:["Try a different file"]}},15:{img:"img-unsupported","globalized-msg":"Viewer-WebGlContextLost","default-msg":{title:"WebGL context lost",message:"Unable to recover from software mode.  Please restart your browser and reload the Viewer",hints:["If you continue to encounter this issue when viewing this model, we recommend switching to a different browser."]}}};function u(){}u.prototype.constructor=u,u.reportError=function(e,t,r,s,c,h){if(u.currentError=null,u.currentErrors=null,t){var d={category:"error",code:t,message:r,httpStatusCode:s,httpStatusText:c};i.logger.track(d,!0),u.currentError=[e,t,r,h];var f=l[t];if(f){(b={defaultValue:""}).defaultValue=f["default-msg"];var p=f.img,m=f["globalized-msg"],g=this.parseErrorString(m,b);if(t===Autodesk.Viewing.ErrorCodes.BROWSER_WEBGL_DISABLED||t===Autodesk.Viewing.ErrorCodes.BROWSER_WEBGL_NOT_SUPPORTED)for(var v=(0,a.getWebGLHelpLink)()||"http://www.autodesk.com/a360-browsers",y=0;y<g.hints.length;y++){-1!==g.hints[y].indexOf('href="WEBGL_HELP"')&&(g.hints[y]=g.hints[y].replace('href="WEBGL_HELP"','href="'+v+'"'))}n.AlertBox.displayError(e,g.msg,g.header,p,g.hints)}else{p="img-unsupported";var b={defaultValue:"",interpolationPrefix:"{",interpolationSuffix:"}"};this.parseArguments(r,b),(g=this.parseErrorString(t,b)).header||(g.header="warning"===h?o.Z.t("header-warning"):""),n.AlertBox.displayError(e,g.msg,g.header,p,g.hints,t)}}},u.reportErrors=function(e,t){if(u.currentError=null,u.currentErrors=null,t){u.currentErrors=[e,t];for(var r={defaultValue:"",interpolationPrefix:"{",interpolationSuffix:"}"},a=[],s=0;s<t.length;s++)if(t[s].code){this.parseArguments(t[s].message,r);var l=this.parseErrorString(t[s].code,r);l.header||(l.header="warning"===t[0].type?o.Z.t("header-warning",{defaultValue:"Warning"}):""),a.push(l);var c={category:"error",code:t[s].code,message:t[s].message};i.logger.track(c,!0)}if(a.length){n.AlertBox.displayErrors(e,"img-unsupported",a)}}},u.parseArguments=function(e,t){if(e)if("string"==typeof e)t.defaultValue=e;else{t.defaultValue=e[0];for(var r=1;r<e.length;r++){t[(r-1).toString()]=e[r]}}},u.parseErrorString=function(e,t){var r={msg:null,msgList:null,header:null,hints:null};if(!e)return r;if("object"===s(t.defaultValue)){var n=t.defaultValue;return r.header=n.title,r.msg=n.message,r.hints=n.hints.concat(),r}var i=o.Z.t(e,t);if(!i)return r;if(-1!=i.indexOf("<title>")){var a=i.split("<title>")[1].split("</title>");r.header=a[0],i=a[1]}if(i&&-1!=i.indexOf("<message>")){a=i.split("<message>")[1].split("</message>");r.msg=a[0],i=a[1]}else r.msg=i;if(i&&-1!=i.indexOf("<hint>")){r.hints=[];for(var l=i.split("<hint>"),u=0;u<l.length;u++){var c=l[u].split("</hint")[0];r.hints.push(c)}}return r},u.localize=function(){if(n.AlertBox.instances.length>0)if(n.AlertBox.dismiss(),u.currentError){var e=u.currentError.shift(),t=u.currentError;u.reportError(e,t[0],t[1],t[2])}else{e=u.currentErrors.shift();var r=u.currentErrors[0];u.reportErrors(e,r)}},u.dismissError=function(e){return n.AlertBox.dismissByTag(e)}},66803:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GuiViewer3D:()=>C});var n=r(37169),i=r(55412),o=r(24327),a=r(84998),s=r(79659),l=r(41471),u=r(71224),c=r(58660),h=r(17167),d=r(98926),f=r(42024),p=r(36311),m=r(42106),g=r(66704),v=r(96250),y=r(6355),b=r(56441),x=r(76095),_=r(42430),E=r(89853),w=r(65663),A=r(51676),S=r(73306);function M(e,t){null!=t&&t.globalManager&&this.setGlobalManager(t.globalManager),S.ToolBar.call(this,e,t),this.onToolbarUpdated=(null==t?void 0:t.onToolbarUpdated)||function(){},this.screenModeDelegate=null==t?void 0:t.screenModeDelegate,this.navigation=null==t?void 0:t.navigation,this.onClickViewerOption=(null==t?void 0:t.onClickViewerOption)||function(){},this.onClickRenderOptions=(null==t?void 0:t.onClickRenderOptions)||function(){},this.onClickFullScreen=(null==t?void 0:t.onClickFullScreen)||function(){},this.navTools=new A.RadioButtonGroup(y.TOOLBAR.NAVTOOLSID),this.modelTools=new g.ControlGroup(y.TOOLBAR.MODELTOOLSID),this.settingsTools=new g.ControlGroup(y.TOOLBAR.SETTINGSTOOLSID),this.addControl(this.navTools),this.addControl(this.modelTools),this.addControl(this.settingsTools)}r(35449).GlobalManagerMixin.call(M.prototype),M.prototype=Object.create(S.ToolBar.prototype),M.prototype.constructor=M,M.prototype.initRenderOptionsButton=function(){this.settingsTools&&!this.renderOptionsButton&&(this.renderOptionsButton=new m.Button("toolbar-renderOptionsTool"),this.renderOptionsButton.setToolTip("Rendering options"),this.renderOptionsButton.setIcon("adsk-icon-settings-render"),this.renderOptionsButton.onClick=this.onClickRenderOptions,this.settingsTools.addControl(this.renderOptionsButton))},M.prototype.initSettingsOptionsButton=function(){var e=new m.Button("toolbar-settingsTool");this.viewerOptionButton=e,e.setIcon("adsk-icon-settings"),e.setToolTip("Settings"),this.viewerOptionButton.onClick=this.onClickViewerOption,this.settingsTools.addControl(e)},M.prototype.initModelTools=function(){if(!this.settingsTools.fullscreenbutton){var e=new m.Button("toolbar-fullscreenTool",{collapsible:!1});e.setToolTip("Full screen"),e.setIcon("adsk-icon-fullscreen"),e.onClick=this.onClickFullScreen,this.settingsTools.addControl(e),this.settingsTools.fullscreenbutton=e,this.updateFullscreenButton(this.screenModeDelegate.getMode())}},M.prototype.updateFullscreenButton=function(e){var t="adsk-icon-fullscreen";switch(e){case w.ScreenMode.kNormal:this.screenModeDelegate.isModeSupported(w.ScreenMode.kFullBrowser)||(t="adsk-icon-fullscreen");break;case w.ScreenMode.kFullBrowser:t=this.screenModeDelegate.isModeSupported(w.ScreenMode.kFullScreen)?"adsk-icon-fullscreen":"adsk-icon-fullscreen-exit";break;case w.ScreenMode.kFullScreen:t="adsk-icon-fullscreen-exit"}this.settingsTools.fullscreenbutton.setIcon(t)},M.prototype.updateToolbarButtons=function(e,t){var r,n,i;i=e>310?"block":"none",(n=this.modelTools.getControl("toolbar-explodeTool"))&&n.setDisplay(i),i=e>380?"block":"none",(n=this.modelTools.getControl("toolbar-collaborateTool"))&&n.setDisplay(i),i=e>515?"block":"none";var o=this.navTools.getControl("toolbar-cameraSubmenuTool");o&&(o.setDisplay(i),(n=o.subMenu.getControl("toolbar-homeTool"))&&n.setDisplay(this.navigation.isActionEnabled("gotoview")?"block":"none"),(n=o.subMenu.getControl("toolbar-fitToViewTool"))&&n.setDisplay(this.navigation.isActionEnabled("gotoview")?"block":"none"),(n=o.subMenu.getControl("toolbar-focalLengthTool"))&&n.setDisplay(this.navigation.isActionEnabled("fov")?"block":"none"),(n=o.subMenu.getControl("toolbar-rollTool"))&&n.setDisplay(this.navigation.isActionEnabled("roll")?"block":"none")),i=e>700?"block":"none",(n=this.modelTools.getControl("toolbar-measureTool"))&&n.setDisplay(i),(n=this.modelTools.getControl("toolbar-sectionTool"))&&n.setDisplay(i),i=e>740?"block":"none",(n=this.navTools.getControl("toolbar-beelineTool"))&&n.setDisplay(this.navigation.isActionEnabled("walk")?i:"none"),(n=this.navTools.getControl("toolbar-firstPersonTool"))&&n.setDisplay(this.navigation.isActionEnabled("walk")?i:"none"),(n=this.navTools.getControl("toolbar-zoomTool"))&&n.setDisplay(this.navigation.isActionEnabled("zoom")?i:"none"),(n=this.navTools.getControl("toolbar-panTool"))&&n.setDisplay(this.navigation.isActionEnabled("pan")?i:"none"),(n=this.navTools.getControl("toolbar-orbitTools"))&&n.setDisplay(this.navigation.isActionEnabled("orbit")?i:"none"),null===(r=this.onToolbarUpdated)||void 0===r||r.call(this,e,t)},M.prototype.registerCustomizeToolbarCB=function(e){this.onToolbarUpdated=e};var T=r(49710);function C(e,t){t||(t={}),t.startOnInitialize=!1,o.Viewer3D.call(this,e,t),this.toolbar=null,this.dockingPanels=[],this.onFullScreenModeEvent=this.onFullScreenModeEvent.bind(this),this.onProgressBarUpdate=this.onProgressBarUpdate.bind(this)}C.prototype=Object.create(o.Viewer3D.prototype),C.prototype.constructor=C,C.prototype.initialize=function(e){var t=o.Viewer3D.prototype.initialize.call(this,e);if(t>0)return v.ErrorHandler.reportError(this.container,t),t;var r=this;if(this.toolController){var i=new f.HotGestureTool(this);this.toolController.registerTool(i),this.toolController.activateTool(i.getName())}return this.addEventListener(n.FULLSCREEN_MODE_EVENT,this.onFullScreenModeEvent),this.contextMenu||this.setDefaultContextMenu(),this.progressbar=new x.ProgressBar(this.container),this.addEventListener(n.PROGRESS_UPDATE_EVENT,this.onProgressBarUpdate),this.addEventListener(n.VIEWER_RESIZE_EVENT,(function(e){var t;r.resizePanels(),null===(t=r.toolbar)||void 0===t||t.updateToolbarButtons(e.width,e.height)})),this.addEventListener(n.NAVIGATION_MODE_CHANGED_EVENT,(function(){var e;null===(e=r.toolbar)||void 0===e||e.updateToolbarButtons(r.container.clientWidth,r.container.clientHeight)})),this.initEscapeHandlers(),this.localize(),this.addEventListener(n.WEBGL_CONTEXT_LOST_EVENT,function(){for(var e=this.container,t=e.childElementCount,r=0;r<t;++r)e.children[r].classList.add("hide-while-context-lost");v.ErrorHandler.reportError(this.container,s.ErrorCodes.WEBGL_LOST_CONTEXT)}.bind(this)),this.addEventListener(n.WEBGL_CONTEXT_RESTORED_EVENT,function(){for(var e=this.container,t=e.childElementCount,r=0;r<t;++r)e.children[r].classList.remove("hide-while-context-lost");v.ErrorHandler.dismissError(s.ErrorCodes.WEBGL_CONTEXT_LOST_EVENT)}.bind(this)),this.run(),0},C.prototype.uninitialize=function(){this.viewerSettingsPanel&&(this.viewerSettingsPanel.uninitialize(),this.viewerSettingsPanel=null),this.renderoptions&&(this.renderoptions.uninitialize(),this.renderoptions=null),this.viewerOptionButton&&(this.viewerOptionButton=null),this.removeEventListener(n.FULLSCREEN_MODE_EVENT,this.onFullScreenModeEvent),this.removeEventListener(n.PROGRESS_UPDATE_EVENT,this.onProgressBarUpdate),this.progressbar=null,this.debugMenu=null,this.modelStats=null,this.toolbar=null,o.Viewer3D.prototype.uninitialize.call(this)},C.prototype.setUp=function(e){e||(e={}),e.startOnInitialize=!1,o.Viewer3D.prototype.setUp.call(this,e)},C.prototype.tearDown=function(e){o.Viewer3D.prototype.tearDown.call(this,e),this.toolbar&&(this.toolbar.container.parentNode.removeChild(this.toolbar.container),this.toolbar=null),this.viewerSettingsPanel&&this.setSettingsPanel(null),this.renderoptions&&(this.removePanel(this.renderoptions),this.renderoptions.uninitialize(),this.renderoptions=null),this.debugMenu=null,this.removeEventListener(n.GEOMETRY_LOADED_EVENT,this.checkGeometry),this.checkGeometry=null},C.prototype.onPostExtensionLoad=function(e){var t,r=this.getToolbar();r&&e.onToolbarCreated&&e.onToolbarCreated(r),null===(t=this.toolbar)||void 0===t||t.updateToolbarButtons(this.container.clientWidth,this.container.clientHeight)},C.prototype.loadModel=function(e,t,r,n,i){var a=this;var l=o.Viewer3D.prototype.loadModel.call(this,e,t,(function(e){setTimeout((function(){t&&(t.loadAsHidden||t.headlessViewer)||function(e){a.running?a.createUI(e):d.logger.error("createUI expects the viewer to be running.",(0,s.errorCodeString)(s.ErrorCodes.VIEWER_INTERNAL_ERROR))}(e),r&&r.call(r,e)}),1)}),(function(e){e!==s.ErrorCodes.LOAD_CANCELED?v.ErrorHandler.reportError(a.container,e):d.logger.warn("A load was canceled"),n&&n.apply(n,arguments)}),i);return l},C.prototype.createUI=function(e,t){var r=this;if(this.model===e||t){var i=this,o=this._createToolbar();this.checkGeometry=function(e){setTimeout((function(){if(!i.impl.is2d&&e.model&&!e.model.hasGeometry()){var t=s.ErrorCodes.BAD_DATA_MODEL_IS_EMPTY;v.ErrorHandler.reportError(i.container,t,"Model is empty"),i._loadingSpinner.hide()}}),1)};var l=this.config.disabledExtensions||{},u=function(e){return-1===(r.profile&&r.profile.extensions.unload?r.profile.extensions.unload:[]).indexOf(e)};this.initModelTools(e),(0,a.getGlobal)().ENABLE_DEBUG&&this.initDebugTools(),"true"===(0,h.getParameterByName)("lmv_viewer_debug")&&this.loadExtension("Autodesk.Debug",this.config);var c=function(e){i.getExtension(e)&&i.unloadExtension(e)};e.is2d()&&(c("Autodesk.BimWalk"),c("Autodesk.Section"),c("Autodesk.Viewing.FusionOrbit"),c("Autodesk.Explode")),l.measure||c("Autodesk.Measure"),o&&(this.dispatchEvent({type:y.TOOLBAR_CREATED_EVENT}),this.forEachExtension((function(e){e.onToolbarCreated&&e.onToolbarCreated(r.toolbar)})));var d="Autodesk.DefaultTools.NavTools",f=this.getExtension(d);f?f.updateUI(e.is3d()):this.loadExtension(d,i.config),this.resize(),e.is2d()?(this.setDefaultNavigationTool("pan"),this.setClickToSetCOI(!1,!1),setTimeout((function(){var e={viewcube:"Autodesk.ViewCubeUi",measure:"Autodesk.Measure",hyperlink:"Autodesk.Hyperlink",layerManager:"Autodesk.LayerManager",propertiesPanel:"Autodesk.PropertiesManager"};for(var t in(0,a.isMobileDevice)()||(e.boxSelection="Autodesk.BoxSelection"),e){var r=e[t];!l[t]&&u(r)&&i.loadExtension(r,i.config)}}),1)):(-1===this.getDefaultNavigationToolName().indexOf("orbit")&&this.setDefaultNavigationTool("orbit"),setTimeout((function(){var e={viewcube:"Autodesk.ViewCubeUi",explode:"Autodesk.Explode",bimwalk:"Autodesk.BimWalk",fusionOrbit:"Autodesk.Viewing.FusionOrbit",measure:"Autodesk.Measure",section:"Autodesk.Section",layerManager:"Autodesk.LayerManager",modelBrowser:"Autodesk.ModelStructure",propertiesPanel:"Autodesk.PropertiesManager"};for(var t in(0,a.isMobileDevice)()||(e.boxSelection="Autodesk.BoxSelection"),e){var r=e[t];!l[t]&&u(r)&&i.loadExtension(r,i.config)}!l.scalarisSimulation&&u("Autodesk.Viewing.ScalarisSimulation")&&i.model&&i.model.isScalaris&&i.loadExtension("Autodesk.Viewing.ScalarisSimulation",i.config)}),1),e.isLoadDone()?this.checkGeometry({model:e}):this.addEventListener(n.GEOMETRY_LOADED_EVENT,this.checkGeometry,{once:!0}))}},C.prototype.onFullScreenModeEvent=function(e){this.resizePanels(),this.toolbar.updateFullscreenButton(e.mode)},C.prototype.onProgressBarUpdate=function(e){e.percent>=0&&this.progressbar.setPercent(e.percent)},C.prototype.addOptionToggle=function(e,t,r,n,i){var o=i?this.prefs[i]:null;r="boolean"==typeof o?o:r;var s=this.getDocument(),l=s.createElement("li");l.className="toolbar-submenu-listitem";var c=s.createElement("input");c.className="toolbar-submenu-checkbox",c.type="checkbox",c.id=t,l.appendChild(c);var h=s.createElement("label");return h.setAttribute("for",t),h.setAttribute("data-i18n",t),h.textContent=u.Z.t(t),l.appendChild(h),e.appendChild(l),c.checked=r,c.addEventListener("touchstart",a.touchStartToClick),h.addEventListener("touchstart",a.touchStartToClick),l.addEventListener("touchstart",a.touchStartToClick),c.addEventListener("click",(function(e){n(c.checked),e.stopPropagation()})),h.addEventListener("click",(function(e){e.stopPropagation()})),l.addEventListener("click",(function(e){n(!c.checked),e.stopPropagation()})),i&&this.prefs.addListeners(i,(function(e){c.checked=e}),(function(e){c.checked=e,n(e)})),c},C.prototype.addOptionList=function(e,t,r,n,i,o){var a=this.prefs[o];n="number"==typeof a?a:n;var s=this.getDocument(),l=s.createElement("select");l.className="option-drop-down",l.id="selectMenu_"+t;for(var c=0;c<r.length;c++){var h=s.createElement("option");h.value=c,h.setAttribute("data-i18n",r[c]),h.textContent=u.Z.t(r[c]),l.add(h)}var d=s.createElement("li");d.className="toolbar-submenu-select";var f=s.createElement("div");return f.className="toolbar-submenu-selectlabel",f.setAttribute("for",t),f.setAttribute("data-i18n",t),f.textContent=u.Z.t(t),d.appendChild(f),d.appendChild(l),e.appendChild(d),l.selectedIndex=n,l.onchange=function(e){var t=e.target.selectedIndex;i(t),e.stopPropagation()},l.addEventListener("touchstart",(function(e){e.stopPropagation()})),l.addEventListener("click",(function(e){e.stopPropagation()})),o&&this.prefs.addListeners(o,(function(e){l.selectedIndex=e}),(function(e){l.selectedIndex=e,i(e)})),l},C.prototype.showViewer3dOptions=function(e){var t=this.getSettingsPanel(!0);e&&t.isVisible()&&t.setVisible(!1),t.setVisible(e)},C.prototype.showRenderingOptions=function(e){e&&this._createRenderingOptionsPanel(),this.renderoptions&&this.renderoptions.setVisible(e)},C.prototype._createRenderingOptionsPanel=function(){this.renderoptions||this.model.is2d()||(this.renderoptions=new _.RenderOptionsPanel(this),this.addPanel(this.renderoptions),this.toolbar.initRenderOptionsButton())},C.prototype.showLayerManager=function(){d.logger.warn('viewer.showLayerManager() is now handled the extension "Autodesk.LayerManager" and will be removed in version 8.0.0.')},C.prototype.initHotkeys=function(){d.logger.warn("viewer.initHotkeys() has been deprecated and will be removed in version 8.0.0.")},C.prototype.setModelStructurePanel=function(e){d.logger.warn('viewer.setModelStructurePanel() is deprecated and will be removed in v8.0.0 - Use extension "Autodesk.ModelStructure".');var t=this.getExtension("Autodesk.ModelStructure");return!!t&&t.setModelStructurePanel(e)},C.prototype.setLayersPanel=function(){d.logger.warn('viewer.setLayersPanel() is now handled the extension "Autodesk.LayerManager" and will be removed in version 8.0.0.')},C.prototype.setPropertyPanel=function(e){d.logger.warn('viewer.setPropertyPanel() is now handled by extension "Autodesk.PropertiesManager" and will be removed in version 8.0.0.');var t=this.getExtension("Autodesk.PropertiesManager");return!!t&&t.setPanel(e)},C.prototype.getPropertyPanel=function(e){d.logger.warn('viewer.getPropertyPanel() is now handled the extension "Autodesk.PropertiesManager" and will be removed in version 8.0.0.');var t=this.getExtension("Autodesk.PropertiesManager");return!t&&e&&(this.loadExtension("Autodesk.PropertiesManager"),t=this.getExtension("Autodesk.PropertiesManager")),t?t.getPanel():null},C.prototype.setSettingsPanel=function(e){var t=this;return(e instanceof E.SettingsPanel||!e)&&(this.viewerSettingsPanel&&(this.viewerSettingsPanel.setVisible(!1),this.removePanel(this.viewerSettingsPanel),this.viewerSettingsPanel.uninitialize()),this.viewerSettingsPanel=e,e&&(this.addPanel(e),e.addVisibilityListener((function(r){var n;r&&t.onPanelVisible(e,t),null===(n=t.toolbar)||void 0===n||n.viewerOptionButton.setState(r?m.Button.State.ACTIVE:m.Button.State.INACTIVE)}))),!0)},C.prototype.getSettingsPanel=function(e,t){return!this.viewerSettingsPanel&&e&&this.createSettingsPanel(t||this.model),this.viewerSettingsPanel},C.prototype.createSettingsPanel=function(e){var t=new T.ViewerSettingsPanel(this,e);this.setSettingsPanel(t),t.syncUI(),this.toolbar.initSettingsOptionsButton(),this.dispatchEvent({type:y.SETTINGS_PANEL_CREATED_EVENT})},C.prototype.initModelTools=function(e){this.createSettingsPanel(e),(0,a.getGlobal)().ENABLE_DEBUG&&this._createRenderingOptionsPanel(),this.canChangeScreenMode()&&(0,a.isFullscreenEnabled)(this.getDocument())&&(this.toolbar.initModelTools(),this.toolbar.updateFullscreenButton(this.getScreenMode()))},C.prototype.setPropertiesOnSelect=function(e){d.logger.warn('viewer.setPropertiesOnSelect() is now handled by viewer.prefs.set("openPropertiesOnSelect", <boolean>) and will be removed in version 8.0.0.'),this.prefs.set(i.Prefs.OPEN_PROPERTIES_ON_SELECT,e)},C.prototype.addDivider=function(e){var t=this.getDocument().createElement("li");return t.className="toolbar-submenu-horizontal-divider",e.appendChild(t),t},C.prototype.initDebugTools=function(){if(this.debugMenu)return!1;var e=new g.ControlGroup("debugTools");this.debugMenu=e;var t=new m.Button("toolbar-debugTool");return t.setIcon("adsk-icon-bug"),e.addControl(t),this.debugMenu.debugSubMenuButton=t,this.createDebugSubmenu(this.debugMenu.debugSubMenuButton),this.toolbar.addControl(e),!0},C.prototype.removeDebugTools=function(){this.debugMenu&&(this.debugMenu.removeFromParent(),this.debugMenu=null)},C.prototype.createDebugSubmenu=function(e){var t=this,r=this.getDocument().createElement("div");r.id="toolbar-debugToolSubmenu",r.classList.add("toolbar-submenu"),r.classList.add("toolbar-settings-sub-menu"),r.classList.add("adsk-hidden"),this.debugMenu.subMenu=r,this.debugMenu.subMenu.style.minWidth="180px",this.container.appendChild(r),this.initModelStats(),this.addDivider(r),this.addDivider(r);var n=c.Lang.getLanguages(),i=n.map((function(e){return e.label})),o=n.map((function(e){return e.symbol}));function s(){t.localize()}var u=t.selectedLanguage?t.selectedLanguage:0;this.addOptionList(r,"Language",i,u,(function(e){var r=o[e];t.selectedLanguage=e,(0,l.setLanguage)(r,s)}),null).parentNode.style.paddingBottom="15px",this.addDivider(this.debugMenu.subMenu);this.addOptionList(r,"Error",["UNKNOWN FAILURE","BAD DATA","NETWORK ERROR","NETWORK ACCESS DENIED","NETWORK FILE NOT FOUND","NETWORK SERVER ERROR","NETWORK UNHANDLED RESPONSE CODE","BROWSER WEBGL NOT SUPPORTED","BAD DATA NO VIEWABLE CONTENT"],0,(function(e){var r=e+1;v.ErrorHandler.reportError(t.container,r,"")}),null).parentNode.style.paddingBottom="15px";var h=r.getBoundingClientRect();this.debugMenu.subMenu.style.width=h.width+"px",this.container.removeChild(r),e.container.appendChild(r);var d=h.left+h.width,f=this.container.getBoundingClientRect().right;if(d>f){var p=-(d-f+10)+"px";this.debugMenu.subMenu.style.left=p}e.onMouseOver=function(){r.classList.remove("adsk-hidden")},e.onMouseOut=function(){r.classList.add("adsk-hidden")},(0,a.isTouchDevice)()&&(e.onClick=function(){r.classList.toggle("adsk-hidden")})},C.prototype.initModelStats=function(){var e=this;function t(t){var r=e.impl,n="";e.model&&(n+="Geom&nbsp;polys:&nbsp;"+r.modelQueue().getGeometryList().geomPolyCount+"<br>",n+="Instance&nbsp;polys:&nbsp;"+r.modelQueue().getGeometryList().instancePolyCount+"<br>",n+="Fragments:&nbsp;"+r.modelQueue().getFragmentList().getCount()+"<br>",n+="Geoms:&nbsp;"+r.modelQueue().getGeometryList().geoms.length+"<br>",n+="Loading&nbsp;time:&nbsp;"+(r.model.loader.loadTime/1e3).toFixed(2)+" s<br>"),n+="# "+(t||""),e.modelStats.innerHTML=n}this.addOptionToggle(this.debugMenu.subMenu,"Model statistics",!1,(function(r){var i;r&&!e.modelStats&&(i=e.getDocument(),e.modelStats=i.createElement("div"),e.modelStats.className="statspanel",e.container.appendChild(e.modelStats),e.addEventListener(n.PROGRESS_UPDATE_EVENT,(function(e){e.message&&t(e.message)})),e.fpsDisplay=i.createElement("div"),e.fpsDisplay.className="fps",e.container.appendChild(e.fpsDisplay),t("")),e.modelStats.style.visibility=r?"visible":"hidden",e.fpsDisplay.style.visibility=r?"visible":"hidden",e.impl.fpsCallback=r?function(t){e.fpsDisplay.textContent=""+(0|t)}:null}))},C.prototype.initEscapeHandlers=function(){var e=this;this.addEventListener(n.ESCAPE_EVENT,(function(){if(!e.contextMenu||!e.contextMenu.hide())if(e.renderoptions&&e.renderoptions.isVisible())e.renderoptions.setVisible(!1);else if(e.impl.selector.hasSelection())e.clearSelection();else{if(e.getActiveNavigationTool()!==e.getDefaultNavigationToolName())return e.toolController&&e.toolController.setIsLocked(!1),e.setActiveNavigationTool(),void b.HudMessage.dismiss();if(e.areAllVisible()){if(!p.AlertBox.dismiss()){for(var t=0;t<e.dockingPanels.length;++t){var r=e.dockingPanels[t];if("none"!==r.container.style.display&&""!==r.container.style.display)return void r.setVisible(!1)}e.escapeScreenMode()}}else e.showAll()}}))},C.prototype.getToolbar=function(){return this.toolbar},C.prototype._createToolbar=function(){var e=this;if(this.toolbar)return!1;var t=this;if(this.toolbar=new M("guiviewer3d-toolbar",{globalManager:this.globalManager,navigation:this.navigation,screenModeDelegate:this.getScreenModeDelegate(),onClickFullScreen:t.nextScreenMode.bind(t),onClickRenderOptions:function(){var t=e.renderoptions&&e.renderoptions.isVisible();e.renderoptions.setVisible(!t)},onClickViewerOption:function(){t.getSettingsPanel(!0).isVisible()?t.showViewer3dOptions(!1):t.showViewer3dOptions(!0)}}),this._forgeLogo){var r=this._forgeLogo.getBoundingClientRect();this.toolbar.container.style.bottom="".concat(r.height+10,"px")}return this.container.appendChild(this.toolbar.container),this.toolbar.updateToolbarButtons(this.container.clientWidth,this.container.clientHeight,this.navigation),!0},C.prototype.showModelStructurePanel=function(e){d.logger.warn('viewer.showModelStructurePanel() is deprecated and will be removed in v8.0.0 - Use extension "Autodesk.ModelStructure".'),e?this.activateExtension("Autodesk.ModelStructure"):this.deactivateExtension("Autodesk.ModelStructure")},C.prototype.onPanelVisible=function(e){this.dockingPanels.splice(this.dockingPanels.indexOf(e),1),this.dockingPanels.splice(0,0,e)},C.prototype.localize=function(){o.Viewer3D.prototype.localize.call(this),this.debugMenu&&this.debugMenu.debugSubMenuButton&&(this.debugMenu.debugSubMenuButton.container.removeChild(this.debugMenu.subMenu),this.createDebugSubmenu(this.debugMenu.debugSubMenuButton)),v.ErrorHandler.localize()},C.prototype.addPanel=function(e){return-1===this.dockingPanels.indexOf(e)&&(this.dockingPanels.push(e),!0)},C.prototype.removePanel=function(e){var t=this.dockingPanels.indexOf(e);return t>-1&&(this.dockingPanels.splice(t,1),!0)},C.prototype.resizePanels=function(e){e=e||{};var t=this.toolbar?this.toolbar.getDimensions().height:0,r=this.getDimensions(),n=r.height;e.dimensions&&e.dimensions.height?n=e.dimensions.height:e.dimensions={height:r.height,width:r.width},e.dimensions.height=n-t;var i=e?e.dockingPanels:null;i||(i=this.dockingPanels);var o,a,s=this.container.getBoundingClientRect(),l=s.top,u=s.bottom,c=s.left,h=s.right;e&&e.dimensions?(o=e.dimensions.width,u=l+(a=e.dimensions.height)):(o=s.width,a=s.height);for(var d=0;d<i.length;++d)i[d].onViewerResize(l,u,c,h,o,a)},C.prototype.initExplodeSlider=function(){d.logger.warn('viewer.initExplodeSlider() has been replaced by extension "Autodesk.Explode". initExplodeSlier() will be removed in version 7.0.0.')},C.prototype.registerCustomizeToolbarCB=function(e){var t,r;null===(t=this.toolbar)||void 0===t||t.registerCustomizeToolbarCB(e.bind(null,this)),null===(r=this.toolbar)||void 0===r||r.updateToolbarButtons(this.container.clientWidth,this.container.clientHeight)},Object.defineProperty(C.prototype,"navTools",{get:function(){var e;return null===(e=this.toolbar)||void 0===e?void 0:e.navTools}}),Object.defineProperty(C.prototype,"modelTools",{get:function(){var e;return null===(e=this.toolbar)||void 0===e?void 0:e.modelTools}}),Object.defineProperty(C.prototype,"settingsTools",{get:function(){var e;return null===(e=this.toolbar)||void 0===e?void 0:e.settingsTools}}),Object.defineProperty(C.prototype,"updateFullscreenButton",{get:function(){var e;return null===(e=this.toolbar)||void 0===e?void 0:e.updateFullscreenButton.bind(this)}}),Autodesk.Viewing.Private.GuiViewer3D=C},6355:(e,t,r)=>{"use strict";r.r(t),r.d(t,{TOOLBAR_CREATED_EVENT:()=>n,SETTINGS_PANEL_CREATED_EVENT:()=>i,VIEW_CUBE_CREATED_EVENT:()=>o,TOOLBAR:()=>a});var n="toolbarCreated",i="settingsPanelCreated",o="viewCubeCreated",a={NAVTOOLSID:"navTools",MODELTOOLSID:"modelTools",SETTINGSTOOLSID:"settingsTools",MEASURETOOLSID:"measureTools"}},56441:(e,t,r)=>{"use strict";r.r(t),r.d(t,{HudMessage:()=>i});var n=r(71224);function i(){}i.instances=[],i.displayMessage=function(e,t,r,o,a){var s=e.ownerDocument,l=s.defaultView||s.parentWindow;function u(e){var t=l.getComputedStyle(e),r=parseInt(t["margin-top"]),n=parseInt(t["margin-bottom"]);return e.getBoundingClientRect().height+r+n}function c(e,t,r){var n=l.getComputedStyle(e,null);if(!Array.isArray(t))return n[t];for(var i=r||{},o=0;o<t.length;o++){var a=t[o];i[a]=n[a]}return i}if(!(i.instances.length>0)){var h=t.msgTitleKey,d=t.msgTitleDefaultValue||h,f=t.messageKey,p=t.messageDefaultValue||f,m=t.buttonText,g=t.checkboxChecked||!1,v=t.position||"center",y=s.createElement("div");if(y.classList.add("docking-panel"),y.classList.add("hud"),"top"===v&&y.classList.add("top"),e.appendChild(y),h){var b,x=s.createElement("div");x.classList.add("docking-panel-title"),x.classList.add("docking-panel-delimiter-shadow"),x.textContent=n.Z.t(h,{defaultValue:d}),x.setAttribute("data-i18n",h),y.appendChild(x),r&&((b=s.createElement("div")).classList.add("docking-panel-close"),b.addEventListener("click",(function(e){i.dismiss(),r&&r(e)})),y.appendChild(b));var _=c(x,["width","font-size"]),E=function(e){var t=e.textContent,r=s.createElement("span");c(e,["font-size","font-weight","text-transform","padding","white-space","font-family"],r.style),r.textContent=t,r.style.position="absolute",r.style.top="10000px",r.style.left="-10000px",s.body.appendChild(r);var n=r.offsetWidth;return s.body.removeChild(r),n}(x),w=parseFloat(_["font-size"]),A=b?parseFloat(c(b,"width")):0,S=parseFloat(_.width)-A;x.style["font-size"]="".concat(E>S?S/E*w:w,"px")}var M=s.createElement("div");M.classList.add("hud-client"),M.classList.add("docking-panel-container-solid-color-b"),y.appendChild(M);var T=s.createElement("div");T.className="hud-message",T.textContent=n.Z.t(f,{defaultValue:p}),T.setAttribute("data-i18n",p),M.appendChild(T);var C=u(T);if(o){var P=s.createElement("div");P.classList.add("docking-panel-primary-button"),P.classList.add("hud-button"),P.textContent=n.Z.t(m,{defaultValue:m}),P.setAttribute("data-i18n",m),P.addEventListener("click",o),M.appendChild(P),C+=u(P)}if(a){var D=s.createElement("div"),L=s.createElement("input");L.className="hud-checkbox",L.type="checkbox",L.checked=g,D.appendChild(L);var R="Do not show this message again",I=s.createElement("label");I.setAttribute("for",R),I.setAttribute("data-i18n",R),I.textContent=n.Z.t(R,{defaultValue:R}),D.appendChild(I),L.addEventListener("change",a),M.appendChild(D),C+=u(a)}M.style.height=C+"px",y.style.height=C+(x?u(x):0)+"px";var O={hudMessage:y,container:e};i.instances.push(O)}},i.dismiss=function(){if(i.instances.length>0){var e=i.instances.pop();return e.hudMessage.style.visibility="hidden",e.container.removeChild(e.hudMessage),!0}return!1}},59005:(e,t,r)=>{"use strict";r.r(t),r.d(t,{LoadingSpinner:()=>i});var n=r(71224);function i(e){this.parentDiv=e;var t=this.getDocument();this.container=t.createElement("div"),this.container.innerHTML=['<div class="path">','<svg width="100%" height="100%" viewBox="0 0 100 100" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">','<path d="M2.5,50a47.5,47.5 0 1,0 95,0a47.5,47.5 0 1,0 -95,0" vector-effect="non-scaling-stroke"/>','<path d="M 2.5 50 A 47.5 47.5 0 0 1 47.5 2.5" vector-effect="non-scaling-stroke"/>',"</svg>","</div>",'<div class="message" data-i18n="Spinner Loading">LOADING</div>'].join(""),this.container.className="loading-spinner"}r(35449).GlobalManagerMixin.call(i.prototype),i.prototype.addClass=function(e){this.container.classList.add(e)},i.prototype.attachToDom=function(){return!this.container.parentNode&&(n.Z.localize(this.container),this.parentDiv.appendChild(this.container),!0)},i.prototype.removeFromDom=function(){return!!this.container.parentNode&&(this.container.parentNode.removeChild(this.container),!0)},i.prototype.setVisible=function(e){e?this.attachToDom():this.removeFromDom()}},1204:(e,t,r)=>{"use strict";r.r(t),r.d(t,{ModelStructurePanel:()=>m});var n=r(76723),i=r(79893),o=r(30814),a=r(98926),s=r(17167),l=r(71224);function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}var c=-1,h=-2,d=-1e10;function f(e,t){o.TreeDelegate.call(this),this.panel=e,this.model=t;var r=this.getDocument();this.modelDiv=r.createElement("div"),this.modelDiv.classList.add("model-div"),this.modelDiv.setAttribute("lmv-modelId",t.id),this.instanceTree=null,this.rootId=c,this.state=1}function p(e){var t=function(e){var t=e.getData();if(t&&t.loadOptions&&t.loadOptions.modelNameOverride)return t.loadOptions.modelNameOverride;return""}(e);if(t)return t;if(!e.getData())return"";var r=e.getDocumentNode();return r?r.getModelName():"Model"}function m(e,t,r,i){n.DockingPanel.call(this,e,t,r,i),this.container.classList.add("model-structure-panel"),(i=i||{}).heightAdjustment||(i.heightAdjustment=40),i.marginTop||(i.marginTop=0),i.left=!0,this.createScrollContainer(i),this.onScroll=this.onScroll.bind(this),this.scrollContainer.addEventListener("scroll",this.onScroll),this.scrollContainer.style["overflow-x"]="hidden",this.options=i,this.tree=null,this._pendingModels=[],this.uiCreated=!1;var o=this;this.addVisibilityListener((function(e){e&&(o.uiCreated||o.createUI(),o.resizeToContent())}))}f.prototype=Object.create(o.TreeDelegate.prototype),f.prototype.constructor=f,f.prototype.isLoading=function(){return 1===this.state},f.prototype.isAvailable=function(){return 2===this.state},f.prototype.isNotAvailable=function(){return 3===this.state},f.prototype.isControlId=function(e){return e===c||e===h},f.prototype.getControlIdCss=function(e){return null},f.prototype.getRootId=function(){return this.rootId},f.prototype.getTreeNodeId=function(e){return"object"==u(e)?(a.logger.warn("Object used instead of dbId. Fix it."),e.dbId):e},f.prototype.getTreeNodeIndex=function(e){return this.instanceTree.nodeAccess.dbIdToIndex[e]},f.prototype.getTreeNodeLabel=function(e){if(e===c){var t=p(this.model);return l.Z.t("Loading model",{name:t})}return e===h||e===this.getRootId()?t=p(this.model):e==d?"Object 0":this.instanceTree.getNodeName(e,!0)||"Object "+e},f.prototype.getTreeNodeClass=function(e){return e===c||e===h?"message-unexpected":""},f.prototype.getTreeNodeParentId=function(e){if(e===d)return 0;var t=this.instanceTree.nodeAccess.getParentId(e);return 0===t?d:t},f.prototype.getTreeNodeCount=function(){return this.instanceTree.nodeAccess.getNumNodes()},f.prototype.getTreeNodeClientHeight=function(e){return 36},f.prototype.getTreeNodeDepthOffset=function(e,t){return 13+25*t},f.prototype.isTreeNodeGroup=function(e){return!this.isControlId(e)&&this.instanceTree.getChildCount(e)>0},f.prototype.shouldCreateTreeNode=function(e){return!0},f.prototype.createTreeNode=function(e,t){var r=this,n=r.getDocument();if(t.addEventListener("mousedown",(function(){var e=function(){this.classList.remove("highlight"),r.removeDocumentEventListener("mouseup",e)}.bind(t);t.classList.add("highlight"),r.addDocumentEventListener("mouseup",e)})),!this.isControlId(e)){var i=n.createElement("div");i.dbId=e,i.classList.add("visibility"),i.addEventListener("mousedown",(function(e){e.preventDefault(),e.stopPropagation()})),i.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation();var t=parseInt(e.target.dbId);this.panel.onEyeIcon(t,this.model)}.bind(this)),t.appendChild(i)}if(e===c){var a=n.createElement("img");a.src=(0,s.getResourceUrl)("res/ui/spinner.png"),a.style.animation="loading-spinner-perpetual-motion 1s infinite linear",a.style.float="right",a.style.marginRight="5px",a.style.width="20px",t.appendChild(a)}var l={localize:e===c||e===h};o.TreeDelegate.prototype.createTreeNode.call(this,e,t,l)},f.prototype.onTreeNodeRightClick=function(e,t,r){this.isControlId(t)||this.panel.onTreeNodeRightClick(e,t,this.model,r)},f.prototype.onTreeNodeClick=function(e,t,r){this.isControlId(t)||this.panel.onTreeNodeClick(e,t,this.model,r)},f.prototype.onTreeNodeDoubleClick=function(e,t,r){},f.prototype.onTreeNodeIconClick=function(e,t,r){if(this.isTreeNodeGroup(t)){var n=e.isCollapsed(this,t);e.setCollapsed(this,t,!n)}},f.prototype.onTreeNodeReized=function(e){},f.prototype.forEachChild=function(e,t,r){this.isControlId(e)||this.instanceTree.enumNodeChildren(e,t,r)},f.prototype.setInstanceTree=function(e){this.instanceTree=e,this.state=e?2:3,this.rootId=e?e.getRootId():h,function(e){var t=e.instanceTree;if(!t)return;var r,n=e.rootId,i=t.getNodeName(n),o=0,a=0;t.enumNodeChildren(n,(function(e){a||(r=t.getNodeName(e),o=e),a++})),e.hasDoubleRoot=1===a&&i===r,e.rootId=e.hasDoubleRoot?o:n}(this)},f.prototype.clean=function(){for(var e,t=this.modelDiv;e=t.lastChild;)t.removeChild(e)},m.prototype=Object.create(n.DockingPanel.prototype),m.prototype.constructor=m,m.prototype.uninitialize=function(){var e;this.scrollContainer.addEventListener("scroll",this.onScroll),this.scrollContainer.parentNode.removeChild(this.scrollContainer),null===(e=this.tree)||void 0===e||e.destroy(),n.DockingPanel.prototype.uninitialize.call(this)},m.prototype.addModel=function(e){if(e)if(this.uiCreated)this.createTreeUI(e);else{if(-1!==this._pendingModels.indexOf(e))return;this._pendingModels.push(e)}},m.prototype.unloadModel=function(e){if(e)if(this.uiCreated)this.removeTreeUI(e);else{var t=this._pendingModels.indexOf(e);if(-1===t)return;this._pendingModels.splice(t,1)}},m.prototype.createUI=function(){if(!this.uiCreated){var e,t="";if(this.options&&this.options.defaultTitle?(t=this.options.defaultTitle,e=void 0===this.options.localizeTitle||!!this.options.localizeTitle):(t=this.modelTitle,e=!1),t||(t="Browser",e=!0),this.setTitle(t,{localizeTitle:e}),this.uiCreated=!0,this.tree=new i.TreeOnDemand(this.scrollContainer,this.options),this.tree.setGlobalManager(this.globalManager),0!==this._pendingModels.length){for(var r=0;r<this._pendingModels.length;++r)this.createTreeUI(this._pendingModels[r]);this._pendingModels=[]}}},m.prototype.createTreeUI=function(e){if(this.tree.getDelegate(e.id))return!1;var t=new f(this,e);t.setGlobalManager(this.globalManager),this.tree.pushDelegate(t);var r=this;return e.getObjectTree((function(e){r.setInstanceTree(t,e)}),(function(){r.setInstanceTree(t,null)})),!0},m.prototype.setInstanceTree=function(e,t){this.tree.setInstanceTree(e,t)},m.prototype.removeTreeUI=function(e){this.tree.removeDelegate(e.id)&&(this.scrollContainer.scrollTop=0,this.onScroll())},m.prototype.onScroll=function(){this.tree.setScroll(this.scrollContainer.scrollTop)},m.prototype.getNodeLabel=function(e){return this.myDelegate.getNodeLabel(e)},m.prototype.onTreeNodeClick=function(){throw new Error("Method must be overriden.")},m.prototype.onTreeNodeRightClick=function(){throw new Error("Method must be overriden.")},m.prototype.onTitleClick=function(){},m.prototype.onTitleDoubleClick=function(){}},30587:(e,t,r)=>{"use strict";r.r(t),r.d(t,{ObjectContextMenu:()=>o});var n=r(89576),i=r(35449);function o(e){this.viewer=e,this.setGlobalManager(e.globalManager),this.contextMenu=new n.ContextMenu(e)}o.prototype.constructor=o,i.GlobalManagerMixin.call(o.prototype),o.prototype.show=function(e){var t=this.viewer.getSelectionCount(),r=this.viewer.getSelectionVisibility(),n=this.viewer.impl.getCanvasBoundingClientRect(),i={event:e,numSelected:t,hasSelected:0<t,hasVisible:r.hasVisible,hasHidden:r.hasHidden,canvasX:e.clientX-n.left,canvasY:e.clientY-n.top},o=this.buildMenu(e,i);this.viewer.runContextMenuCallbacks(o,i),o&&0<o.length&&this.contextMenu.show(e,o)},o.prototype.hide=function(){return this.contextMenu.hide()},o.prototype.buildMenu=function(){return null}},76095:(e,t,r)=>{"use strict";function n(e){var t=e.ownerDocument;this.bg=t.createElement("div"),this.bg.className="progressbg",this.fg=t.createElement("div"),this.fg.className="progressfg",this.bg.appendChild(this.fg),e.appendChild(this.bg),this.lastValue=-1,this.fg.style.transform="scale(0, 1)"}r.r(t),r.d(t,{ProgressBar:()=>n}),n.prototype.setPercent=function(e){e!=this.lastValue&&(this.lastValue=e,e>=99?this.bg.style.opacity="0":(this.bg.style.opacity="1",this.fg.style.transform="scale(".concat(e/100,", 1)")))},n.prototype.setStyle=function(e){!this.fg.classList.contains(e)&&this.fg.classList.add(e)},n.prototype.removeStyle=function(e){this.fg.classList.contains(e)&&this.fg.classList.remove(e)}},53974:(e,t,r)=>{"use strict";r.r(t),r.d(t,{PropertyPanel:()=>u});var n=r(76723),i=r(30814),o=r(33218),a=r(50638),s=r(71224),l=r(51137);function u(e,t,r,a){n.DockingPanel.call(this,e,t,r,a),this.title.classList.add("docking-panel-delimiter-shadow"),this.container.classList.add("property-panel"),this.container.dockRight=!0,this.createScrollContainer({left:!1,heightAdjustment:70,marginTop:0}),this.highlightableElements={};var s=this;var l=function(){var e=new i.TreeDelegate;function t(e){return"category"===e.type}return e.setGlobalManager(s.globalManager),e.getTreeNodeId=function(e){return e.name+(Object.prototype.hasOwnProperty.call(e,"value")?e.value:"")+(Object.prototype.hasOwnProperty.call(e,"category")?e.category:"")},e.getTreeNodeClass=function(e){return t(e)?s.getCategoryClass(e):s.getPropertyClass(e)},e.isTreeNodeGroup=function(e){return t(e)},e.onTreeNodeClick=function(e,r,n){t(r)?s.onCategoryClick(r,n):s.onPropertyClick(r,n)},e.onTreeNodeRightClick=function(e,r,n){t(r)?s.onCategoryRightClick(r,n):s.onPropertyRightClick(r,n)},e.onTreeNodeDoubleClick=function(e,r,n){t(r)?s.onCategoryDoubleClick(r,n):s.onPropertyDoubleClick(r,n)},e.onTreeNodeIconClick=function(e,r,n){t(r)?s.onCategoryIconClick(r,n):s.onPropertyIconClick(r,n)},e.createTreeNode=function(e,r,n){var i=null;(i=t(e)?s.displayCategory(e,r,n):s.displayProperty(e,r,n))&&(s.highlightableElements[this.getTreeNodeId(e)]=i)},e}();this.tree=new o.Tree(l,null,this.scrollContainer,{}),this.tree.setGlobalManager(this.globalManager)}function c(e){e=String(e);var t=' target="blank" class="propertyLink" ';return[{pattern:/\b(?:https?|ftp):\/\/[a-z0-9-+&@#/%?=~_|()!:,.;]*[a-z0-9-+&@#/%=~_|()]/gim,value:"<a"+t+'href="$&">$&</a>'},{pattern:/(^|[^/])(www\.[\S]+(\b|$))/gim,value:"$1<a"+t+'href="http://$2">$2</a>'}].reduce((function(e,t){return e.replace(t.pattern,t.value)}),e)}u.prototype=Object.create(n.DockingPanel.prototype),u.prototype.constructor=u,u.prototype.setAggregatedProperties=function(e){var t=this;this.removeAllProperties();var r=Autodesk.Viewing.Private,n=this.viewer.prefs.get(r.Prefs.DISPLAY_UNITS),i=this.viewer.prefs.get(r.Prefs.DISPLAY_UNITS_PRECISION),o=Object.prototype.hasOwnProperty.call(e.map,"Name")?e.map.Name.map((function(e){return e.displayValue})):[];function u(e,t){var r=Number(e);e=isNaN(r)?e:r;var o="number"==typeof i?i:t.precision||(0,a.calculatePrecision)(e),s=(0,a.convertToDisplayUnits)(e,t.type,t.units,n);return(0,a.formatValueWithUnits)(s.displayValue,s.displayUnits,t.type,o)}var c=e.getValue2PropertiesMap("Name");if(c){var h=Object.keys(c);if(1===h.length){var d=h[0];this.tree.createElement_({name:"Name",value:d,type:"property",category:"",css:{name:"aggregate-name"}},this.tree.myRootContainer)}else{var f={name:"Name",type:"category",value:"Varies"},p=this.tree.createElement_(f,this.tree.myRootContainer);for(var m in this.setCategoryCollapsed(f,!0),c)this.tree.createElement_({name:m,value:"",type:"property",category:"Name"},p)}}var g=e.getKeysWithCategories().length>0;e.forEach((function(r,n){if("Name"!==r){var i=e.getAggregation(r),a=e.getValue2PropertiesMap(r);if(i||a){var c=n[0];if(!c.hidden){var h,d=!!c.displayCategory,f="";if(d)f=c.displayCategory,h=(h=t.tree.getElementForNode({name:f}))||t.tree.createElement_({name:f,type:"category"},t.tree.myRootContainer);else if(g){if(f="Other",!(h=t.tree.getElementForNode({name:f}))){var p=f,m=(h=t.tree.createElement_({name:p,type:"category"},t.tree.myRootContainer)).children[0].children[1];m.setAttribute("data-i18n",p),p=s.Z.t(p),m.textContent=p,m.title=p}}else h=t.tree.myRootContainer;var v=Object.keys(a);if(1===v.length){var y=v[0];return y=(0,l.OY)(n[0].type)?u(Number(y),c):y,void(h=t.tree.createElement_({name:c.displayName,value:y,type:"property",category:f,css:{name:"aggregate-name"}},h))}var b={name:c.displayName,value:"Varies",type:"category",category:f};if(h=t.tree.createElement_(b,h),t.setCategoryCollapsed(b,!0),f=c.displayName,(d||g)&&h.classList.add("indented"),i){var x={};for(var _ in i)if("count"!==_)if("mode"!==_){var E=i[_];x[_]=u(E,c)}else x[_]=i[_].map((function(e){return u(e,c)})).join(", ");else x[_]=i[_];t.tree.createElement_({map:x,default:"sum",type:"property",category:f},h)}var w=[];for(var A in a){for(var S=u(A,c),M=a[A],T=0;T<M.length;++T){var C=o.indexOf(M[T]);C>-1&&o.splice(C,1)}w.push({name:M,value:S,type:"property",category:f})}o.length>0&&t.tree.createElement_({name:o,value:"--",type:"property",category:f},h),w.forEach((function(e){t.tree.createElement_(e,h)}))}}}}))},u.prototype.setProperties=function(e){this.removeAllProperties();for(var t=[],r=[],n=0;n<e.length;n++){var i=e[n];if(!i.hidden){var o=e[n].displayCategory;o&&"string"==typeof o&&""!==o?t.push(i):r.push(i)}}if(t.length+r.length!==0){r[0]&&"Name"===r[0].displayName&&(this.addProperty(r[0].displayName,r[0].displayValue),r.shift());for(var s=Autodesk.Viewing.Private,l=this.viewer.prefs.get(s.Prefs.DISPLAY_UNITS),u=this.viewer.prefs.get(s.Prefs.DISPLAY_UNITS_PRECISION),c=0;c<t.length;c++){var h=t[c],d="number"==typeof u?u:h.precision||(0,a.calculatePrecision)(h.displayValue),f=(0,a.convertToDisplayUnits)(h.displayValue,h.type,h.units,l),p=(0,a.formatValueWithUnits)(f.displayValue,f.displayUnits,h.type,d);this.addProperty(h.displayName,p,h.displayCategory)}for(var m=t.length>0,g=0;g<r.length;g++){var v=r[g],y="number"==typeof u?u:v.precision||(0,a.calculatePrecision)(v.displayValue),b=(0,a.convertToDisplayUnits)(v.displayValue,v.type,v.units,l),x=(0,a.formatValueWithUnits)(b.displayValue,b.displayUnits,v.type,y);this.addProperty(v.displayName,x,m?"Other":"",m?{localizeCategory:!0}:{})}}else this.showNoProperties()},u.prototype.showNoProperties=function(){this.removeAllProperties();var e=this.tree.myRootContainer,t=this.getDocument().createElement("div");t.className="no-properties";var r="No properties to display";t.setAttribute("data-i18n",r),t.textContent=s.Z.t(r),e.appendChild(t)},u.prototype.showDefaultProperties=function(){this.showNoProperties(),this.resizeToContent()},u.prototype.areDefaultPropertiesShown=function(){return!this.hasProperties()},u.prototype.addProperty=function(e,t,r,n){if(this.tree.getElementForNode({name:e,value:t,category:r}))return!1;var i=null,o={name:e,value:t,type:"property"};return r?((i=this.tree.getElementForNode({name:r}))||(i=this.tree.createElement_({name:r,type:"category"},this.tree.myRootContainer,n&&n.localizeCategory?{localize:!0}:null)),o.category=r):i=this.tree.myRootContainer,this.tree.createElement_(o,i,n&&n.localizeProperty?{localize:!0}:null),!0},u.prototype.hasProperties=function(){for(var e in this.highlightableElements)return!0;return!1},u.prototype.removeProperty=function(e,t,r){var n={name:e,value:t,category:r},i=this.tree.getElementForNode(n);return!!i&&(delete this.highlightableElements[this.tree.delegate().getTreeNodeId(n)],i.parentNode.removeChild(i),!0)},u.prototype.removeAllProperties=function(){this.highlightableElements={},this.tree.clear()},u.prototype.setCategoryCollapsed=function(e,t){var r=this.tree.delegate().getTreeNodeId(e);this.tree.setCollapsed(r,t)},u.prototype.isCategoryCollapsed=function(e){var t=this.tree.delegate().getTreeNodeId(e);return this.tree.isCollapsed(t)},u.prototype.getContentSize=function(){var e=this.tree.myRootContainer;return{height:e.clientHeight+55,width:e.clientWidth}},u.prototype.highlight=function(e){function t(t){var r=t.innerHTML,n=r.replace(/(<highlight>|<\/highlight>)/gim,"");if(r!==n&&(t.innerHTML=n),e&&""!==e){var i=new RegExp("(\\b"+e+"\\b)","gim"),o=n.replace(i,"<highlight>$1</highlight>");t.innerHTML=o}}for(var r in this.highlightableElements)for(var n=this.highlightableElements[r],i=0;i<n.length;++i)t(n[i])},u.prototype.displayCategory=function(e,t,r){var n=this.getDocument(),i=n.createElement("div"),o=e.name;r&&r.localize&&(i.setAttribute("data-i18n",o),o=s.Z.t(o)),i.textContent=o,i.title=o,i.className="category-name",t.appendChild(i);var a=[i];if(e.value){var l=n.createElement("div");l.textContent=e.value;var u=e.value;l.title=u,u=c(u),l.innerHTML=u,l.className="category-value",t.appendChild(l),a.push(l)}return a},u.prototype.displayProperty=function(e,t,r){var n,i=this.getDocument(),o=i.createElement("div");if(o.className="separator",e.map){for(var a in n=i.createElement("select"),e.map){var l=i.createElement("option");l.value=a,a=a.charAt(0).toUpperCase()+a.slice(1),l.setAttribute("data-i18n",a),l.textContent=s.Z.t(a),n.add(l)}n.value=e.default,e.value=e.map[e.default],n.className="property-drop-down",o.innerText="="}else{n=i.createElement("div");var u=e.name;r&&r.localize&&(n.setAttribute("data-i18n",u),u=s.Z.t(u)),n.textContent=u,n.title=u,n.className="property-name"}var h=i.createElement("div");h.textContent=e.value;var d=e.value;h.title=d,d=c(d),h.innerHTML=d,h.className="property-value",e.map&&n.addEventListener("change",(function(t){var r=t.target.value,n=e.map[r];h.title=n,h.innerHTML=n}),!1);var f=e.css;return f&&(f.name&&n.classList.add(f.name),f.value&&h.classList.add(f.value)),t.appendChild(n),t.appendChild(o),t.appendChild(h),[n,h]},u.prototype.getCategoryClass=function(){return"category"},u.prototype.getPropertyClass=function(){return"property"},u.prototype.onCategoryClick=function(e){this.setCategoryCollapsed(e,!this.isCategoryCollapsed(e))},u.prototype.onPropertyClick=function(){},u.prototype.onCategoryIconClick=function(e){this.setCategoryCollapsed(e,!this.isCategoryCollapsed(e))},u.prototype.onPropertyIconClick=function(){},u.prototype.onCategoryDoubleClick=function(){},u.prototype.onPropertyDoubleClick=function(){},u.prototype.onCategoryRightClick=function(){},u.prototype.onPropertyRightClick=function(){}},42430:(e,t,r)=>{"use strict";r.r(t),r.d(t,{RenderOptionsPanel:()=>l});var n=r(76723),i=r(37169),o=r(84998),a=r(74593),s=r(95018);function l(e){var t=this;this.viewer=e,this.setGlobalManager(e.globalManager),n.DockingPanel.call(this,e.container,"RenderOptionsPanel","Rendering Options");var r=this.getDocument();this.table=r.createElement("table"),this.table.className="adsk-lmv-tftable",this.tbody=r.createElement("tbody"),this.table.appendChild(this.tbody),this.createScrollContainer({heightAdjustment:70}),this.scrollContainer.appendChild(this.table),this.container.style.width="320px",this.container.style.top="260px",this.container.style.left="220px",this.container.style.height="460px",this.container.dockRight=!0,this.saoToggle=new a.OptionCheckbox("AO Enabled",this.tbody,!0),this.saoToggle.setGlobalManager(this.globalManager),this.addEventListener(this.saoToggle,"change",(function(r){var n=t.saoToggle.checked;e.prefs.set("ambientShadows",n),e.setQualityLevel(n,e.impl.renderer().settings.antialias)})),this.saoRadius=new a.OptionSlider("AO Radius",0,200,this.tbody),this.saoRadius.setGlobalManager(this.globalManager),this.saoRadius.setValue(10),this.saoRadius.sliderElement.step=this.saoRadius.stepperElement.step=.01,this.addEventListener(this.saoRadius,"change",(function(r){e.impl.renderer().setAOOptions(parseFloat(t.saoRadius.value),parseFloat(t.saoIntensity.value)),e.impl.renderer().composeFinalFrame()})),this.saoIntensity=new a.OptionSlider("AO Intensity",0,3,this.tbody),this.saoIntensity.setGlobalManager(this.globalManager),this.saoIntensity.setValue(.4),this.saoIntensity.sliderElement.step=this.saoIntensity.stepperElement.step=.01,this.addEventListener(this.saoIntensity,"change",(function(r){e.impl.renderer().setAOOptions(parseFloat(t.saoRadius.value),parseFloat(t.saoIntensity.value)),e.impl.renderer().composeFinalFrame()})),this.groundShadowAlpha=new a.OptionSlider("Shadow Alpha",0,2,this.tbody),this.groundShadowAlpha.setGlobalManager(this.globalManager),this.groundShadowAlpha.setValue(1),this.groundShadowAlpha.sliderElement.step=this.groundShadowAlpha.stepperElement.step=.1,this.addEventListener(this.groundShadowAlpha,"change",(function(r){e.setGroundShadowAlpha(parseFloat(t.groundShadowAlpha.value))})),this.groundShadowColor=new a.OptionCheckbox("Shadow Color",this.tbody),this.groundShadowColor.setGlobalManager(this.globalManager),o.isIE11||(this.groundShadowColor.checkElement.value="#000000",this.groundShadowColor.checkElement.type="color"),this.addEventListener(this.groundShadowColor,"change",(function(r){var n=t.groundShadowColor.checkElement.value;e.setGroundShadowColor(new THREE.Color(parseInt(n.substr(1,7),16)))})),this.groundReflectionAlpha=new a.OptionSlider("Reflection Alpha",0,2,this.tbody),this.groundReflectionAlpha.setGlobalManager(this.globalManager),this.groundReflectionAlpha.setValue(1),this.groundReflectionAlpha.sliderElement.step=this.groundReflectionAlpha.stepperElement.step=.1,this.addEventListener(this.groundReflectionAlpha,"change",(function(r){e.setGroundReflectionAlpha(parseFloat(t.groundReflectionAlpha.value))})),this.groundReflectionColor=new a.OptionCheckbox("Reflection Color",this.tbody),this.groundReflectionColor.setGlobalManager(this.globalManager),o.isIE11||(this.groundReflectionColor.checkElement.value="#000000",this.groundReflectionColor.checkElement.type="color"),this.addEventListener(this.groundReflectionColor,"change",(function(r){var n=t.groundReflectionColor.checkElement.value;e.setGroundReflectionColor(new THREE.Color(parseInt(n.substr(1,7),16)))}));for(var l=[],u=0;u<s.LightPresets.length;u++)l.push(s.LightPresets[u].name);this.envSelect=new a.OptionDropDown("Environment",this.tbody,l,e.impl.currentLightPreset()),this.envSelect.setGlobalManager(this.globalManager),this.addEventListener(this.envSelect,"change",(function(r){var n=t.envSelect.selectedIndex;e.setLightPreset(n)}));var c=e.impl.renderer().getToneMapMethod();this.toneMapMethod=new a.OptionDropDown("Tonemap Method",this.tbody,["None","Canon-Lum","Canon-RGB"],c),this.toneMapMethod.setGlobalManager(this.globalManager),this.addEventListener(this.toneMapMethod,"change",(function(){var r=t.toneMapMethod.selectedIndex;e.impl.setTonemapMethod(r)})),this.exposureBias=new a.OptionSlider("Exposure Bias",-30,30,this.tbody),this.exposureBias.setGlobalManager(this.globalManager),this.exposureBias.setValue(e.impl.renderer().getExposureBias()),this.exposureBias.sliderElement.step=this.exposureBias.stepperElement.step=.1,this.addEventListener(this.exposureBias,"change",(function(r){e.impl.setTonemapExposureBias(t.exposureBias.value,t.whiteScale.value)})),this.exposureBias.setDisabled(0==c),this.whiteScale=new a.OptionSlider("Light Intensity",-5,20,this.tbody),this.whiteScale.setGlobalManager(this.globalManager);var h=0;e.impl.dir_light1&&(h=0!=e.impl.dir_light1.intensity?Math.log(e.impl.dir_light1.intensity)/Math.log(2):-1e-20),this.whiteScale.setValue(h),this.whiteScale.sliderElement.step=this.whiteScale.stepperElement.step=.1,this.addEventListener(this.whiteScale,"change",(function(r){e.impl.dir_light1.intensity=Math.pow(2,t.whiteScale.value),e.impl.setTonemapExposureBias(t.exposureBias.value,t.whiteScale.value)})),this.fovAngle=new a.OptionSlider("FOV-degrees",6.88,100,this.tbody),this.fovAngle.setGlobalManager(this.globalManager),this.fovAngle.setValue(e.getFOV()),this.addEventListener(this.fovAngle,"change",(function(r){e.setFOV(parseFloat(t.fovAngle.value))})),this.frameRate=new a.OptionSlider("Frame rate:",1,100,this.tbody),this.frameRate.setGlobalManager(this.globalManager),this.frameRate.setValue(e.impl.getFrameRate()),this.frameRate.sliderElement.step=this.frameRate.stepperElement.step=1,this.addEventListener(this.frameRate,"change",(function(r){e.impl.setFrameRate(t.frameRate.value)})),this.addEventListener(this.viewer,i.CAMERA_CHANGE_EVENT,(function(r){var n=parseFloat(t.fovAngle.value),i=e.getFOV();n!=i&&t.fovAngle.setValue(i)})),this.addEventListener(this.viewer,i.RENDER_OPTION_CHANGED_EVENT,(function(e){t.syncUI()})),this.addEventListener(this.viewer,i.VIEWER_STATE_RESTORED_EVENT,(function(e){t.syncUI()})),this.addVisibilityListener((function(e){e&&t.resizeToContent()}))}l.prototype=Object.create(n.DockingPanel.prototype),l.prototype.constructor=l,l.prototype.getContentSize=function(){return{height:this.table.clientHeight+75,width:this.table.clientWidth}},l.prototype.syncUI=function(){var e=this.viewer.impl,t=0;e.dir_light1&&(t=0!=e.dir_light1.intensity?Math.log(e.dir_light1.intensity)/Math.log(2):-1e-20),this.whiteScale.setValue(t),this.exposureBias.setValue(e.renderer().getExposureBias());var r=e.renderer().getToneMapMethod();this.toneMapMethod.setSelectedIndex(r),this.envSelect.setSelectedIndex(e.currentLightPreset()),this.exposureBias.setDisabled(0==r),this.saoToggle.setValue(e.renderer().getAOEnabled()),this.saoRadius.setDisabled(!e.renderer().getAOEnabled()),this.saoIntensity.setDisabled(!e.renderer().getAOEnabled()),this.saoRadius.setValue(e.renderer().getAORadius()),this.saoIntensity.setValue(e.renderer().getAOIntensity()),this.groundShadowAlpha.setDisabled(!this.viewer.prefs.get("groundShadow")),this.groundShadowColor.setDisabled(!this.viewer.prefs.get("groundShadow")),this.groundReflectionAlpha.setDisabled(!this.viewer.prefs.get("groundReflection")),this.groundReflectionColor.setDisabled(!this.viewer.prefs.get("groundReflection")),this.fovAngle.setValue(this.viewer.getFOV())},l.prototype.uninitialize=function(){n.DockingPanel.prototype.uninitialize.call(this),this.table=null,this.tbody=null,this.saoToggle=null,this.saoRadius=null,this.saoIntensity=null,this.groundShadowAlpha=null,this.envSelect=null,this.toneMapMethod=null,this.exposureBias=null,this.whiteScale=null,this.fovAngle=null,this.viewer=null}},89853:(e,t,r)=>{"use strict";r.r(t),r.d(t,{SettingsPanel:()=>l});var n=r(76723),i=r(71224),o=r(84998),a=r(74593);function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}function l(e,t,r,i){n.DockingPanel.call(this,e,t,r,i),this.panelTabs=[],this.tabIdToIndex={},this.controls={},this.controlIdCount=0,this.shown=!1;var o=this,a=i&&void 0!==i.width?i.width:340;this.container.style.maxWidth="800px",this.container.style.minWidth=a+"px",this.container.style.top="10px",this.container.style.left=e.offsetWidth/2-170+"px",this.container.style.position="absolute";var s=this.getDocument();this.tabContainer=s.createElement("div"),this.tabContainer.classList.add("docking-panel-container-solid-color-b"),this.tabContainer.classList.add("settings-tabs"),this.tabContainer.classList.add("docking-panel-delimiter-shadow"),this.container.appendChild(this.tabContainer),this.tabs=s.createElement("ul"),this.tabContainer.appendChild(this.tabs),this.heightAdjustment=i&&i.heightAdjustment?i.heightAdjustment:179,i&&i.hideTabBar&&(this.heightAdjustment-=40,this.tabContainer.style.display="none",this.tabContainer.style.height=0),this.createScrollContainer({left:!1,heightAdjustment:this.heightAdjustment,marginTop:0}),this.tablesContainer=s.createElement("div"),this.tablesContainer.classList.add("settings-tabs-tables-container"),i&&i.hideTabBar&&(this.scrollContainer.style.top="50px"),this.scrollContainer.appendChild(this.tablesContainer),this.mouseOver=!1,this.addEventListener(this.container,"mouseover",(function(e){var t=e.toElement||e.relatedTarget;if(o.mouseOver)return!0;for(var r=o.getWindow();t&&t.parentNode&&t.parentNode!=r;){if(t.parentNode==this||t==this){t.preventDefault&&t.preventDefault(),o.mouseOver=!0;for(var n=0;n<o.panelTabs.length;n++)o.panelTabs[n].classList.remove("selectedmouseout");return!0}t=t.parentNode}})),this.addEventListener(this.container,"mouseout",(function(e){var t=e.toElement||e.relatedTarget;if(o.mouseOver){for(var r=o.getWindow();t&&t.parentNode&&t.parentNode!=r;){if(t.parentNode==this||t==this)return t.preventDefault&&t.preventDefault(),!1;t=t.parentNode}o.mouseOver=!1;for(var n=0;n<o.panelTabs.length;n++)o.panelTabs[n].classList.contains("tabselected")&&o.panelTabs[n].classList.add("selectedmouseout")}})),this.expandID=function(e){return t+"-"+e}}l.prototype=Object.create(n.DockingPanel.prototype),l.prototype.constructor=l,l.prototype.setVisible=function(e){e&&(this.container.style.display="block",this.shown||(this.resizeToContent(),this.container.style.left=this.parentContainer.offsetWidth/2-this.container.getBoundingClientRect().width/2+"px"),this.shown=!0),n.DockingPanel.prototype.setVisible.call(this,e)},l.prototype.addTab=function(e,t,r){var n=this;if(void 0!==this.tabIdToIndex[e])return!1;var a=r&&void 0!==r.className?r.className:null,s=r&&void 0!==r.width?r.width:200,l=r&&void 0!==r.index?r.index:this.panelTabs.length;var u=this.getDocument(),c=u.createElement("li");c._id=e,c.id=this.expandID(c._id),c.classList.add(a);var h=u.createElement("a"),d=u.createElement("span");d.setAttribute("data-i18n",t),d.textContent=i.Z.t(t),h.appendChild(d),c.appendChild(h),this.tabs.appendChild(c);var f=u.createElement("table");f._id=e+"-table",f.id=this.expandID(f._id),f.classList.add("settings-table"),f.classList.add("adsk-lmv-tftable"),f.classList.add(a);var p=u.createElement("tbody");return p.style.display="table",p.style.width="100%",f.appendChild(p),this.tablesContainer.appendChild(f),this.addEventListener(c,"touchstart",o.touchStartToClick),this.addEventListener(c,"click",(function(){n.selectTab(e)})),this.panelTabs.push(c),this.tabIdToIndex[e]=l,s>(this.container.style.minWidth?parseInt(this.container.style.minWidth):0)&&(this.container.style.minWidth=s+"px"),!0},l.prototype.removeTab=function(e){var t=this.tabIdToIndex[e];if(!t)return!1;this.panelTabs.splice(t,1);var r=this.getDocument().getElementById(this.expandID(e));this.tabs.removeChild(r),this.tabIdToIndex={};for(var n=this.panelTabs.length,i=0;i<n;i++){var a=this.panelTabs[i];this.tabIdToIndex[a._id]=i,this.removeEventListener(a,"touchstart",o.touchStartToClick)}return!0},l.prototype.resizeTabs=function(){for(var e=this.tabs.getElementsByTagName("li"),t=100/e.length,r=0;r<e.length;r++)e[r].style.width=t+"%"},l.prototype.hasTab=function(e){var t=this.tabIdToIndex[e];return void 0!==this.panelTabs[t]},l.prototype.selectTab=function(e){if(this.isTabSelected(e))return!1;for(var t=this.getDocument(),r=this.panelTabs.length,n=0;n<r;n++){var i=this.panelTabs[n],o=t.getElementById(this.expandID(i._id+"-table"));e===i._id?(i.classList.add("tabselected"),o.classList.add("settings-selected-table"),this.mouseOver||i.classList.add("selectedmouseout")):(i.classList.remove("tabselected"),o.classList.remove("settings-selected-table"),this.mouseOver||this.panelTabs[n].classList.remove("selectedmouseout"))}return this.scrollContainer.scrollTop=0,!0},l.prototype.isTabSelected=function(e){var t=this.tabIdToIndex[e],r=this.panelTabs[t];return r&&r.classList.contains("tabselected")},l.prototype.getSelectedTabId=function(){for(var e in this.tabIdToIndex)if(this.isTabSelected(e))return e;return null},l.prototype.addLabel=function(e,t){var r,n=this.tabIdToIndex[e];if(-1===n)return!1;r=this.tablesContainer.childNodes[n];var i=new a.OptionLabel(t,r.tBodies[0]);return i.setGlobalManager(this.globalManager),i.sliderRow.classList.add("logical-group"),i},l.prototype.addButton=function(e,t){var r=this.tabIdToIndex[e];if(void 0===r)return null;var n=this.tablesContainer.childNodes[r],i=new a.OptionButton(t,n.tBodies[0]);return i.setGlobalManager(this.globalManager),this.addControl(e,i)},l.prototype.addCheckbox=function(e,t,r,n,i,o){var s=this.tabIdToIndex[e];if(void 0===s)return null;var l=this.tablesContainer.childNodes[s],u=new a.OptionCheckbox(t,l.tBodies[0],r,i,o);return u.setGlobalManager(this.globalManager),u.changeListener=function(e){var t=e.detail.target.checked;n(t)},this.addEventListener(u,"change",u.changeListener),this.addControl(e,u)},l.prototype.addRow=function(e,t,r,n){if(void 0===this.tabIdToIndex[e])return null;var i=this.getDocument().getElementById(this.expandID(e+"-table")),o=new a.OptionRow(t,i.tBodies[0],r,n);return o.setGlobalManager(this.globalManager),this.addControl(e,o)},l.prototype.addSlider=function(e,t,r,n,i,o,s){if(void 0===this.tabIdToIndex[e])return null;var l=this.getDocument().getElementById(this.expandID(e+"-table")),u=new a.OptionSlider(t,r,n,l.tBodies[0],s);u.setGlobalManager(this.globalManager),u.setValue(i);var c=1;return s&&s.step&&(c=s.step),u.sliderElement.step=u.stepperElement.step=c,this.addEventListener(u,"change",(function(e){o(e)})),this.addControl(e,u)},l.prototype.addSliderV2=function(e,t,r,n,i,o,a,s){(s=s||{}).hideStepper=!0,s.hideCaption=!0;var l=[];return l.push(this.addRow(e,t,r,s)),l.push(this.addSlider(e,t,n,i,o,a,s)),l},l.prototype.addDropDownMenu=function(e,t,r,n,i,o){if(void 0===this.tabIdToIndex[e])return null;var s=this.getDocument().getElementById(this.expandID(e+"-table")),l=new a.OptionDropDown(t,s.tBodies[0],r,n,null,this.globalManager,o);return l.setGlobalManager(this.globalManager),this.addEventListener(l,"change",(function(e){i(e)})),this.addControl(e,l)},l.prototype.addControl=function(e,t,r){if(void 0===this.tabIdToIndex[e])return null;if(!Object.prototype.hasOwnProperty.call(t,"sliderRow")){var n=r&&r.insertAtIndex?r.insertAtIndex:-1,o=r&&r.caption?r.caption:null,a=this.getDocument(),s=a.getElementById(this.expandID(e+"-table"));n>s.length&&(n=-1);var l=s.tBodies[0].insertRow(n),u=l.insertCell(0);if(o){var c=a.createElement("div");c.setAttribute("data-i18n",o),c.textContent=i.Z.t(o),u.appendChild(c),u=l.insertCell(1)}else u.colSpan=3;u.appendChild(t),t.sliderRow=l,t.tbody=s.tBodies[0]}var h=this.expandID("adsk_settings_control_id_"+this.controlIdCount.toString());return this.controlIdCount=this.controlIdCount+1,this.controls[h]=t,t.parent=this,h},l.prototype.removeButton=function(e){return this.removeControl(e)},l.prototype.removeCheckbox=function(e){return this.removeControl(e)},l.prototype.removeSlider=function(e){return this.removeControl(e)},l.prototype.removeDropdownMenu=function(e){return this.removeControl(e)},l.prototype.removeControl=function(e){var t;if("object"===s(e)&&e.tbody){for(var r in t=e,this.controls)if(this.controls[r]===t){e=r;break}}else t=this.controls[e];if(void 0===t)return!1;if(t.removeFromParent)t.removeFromParent();else{var n=t.tbody,i=t.sliderRow.rowIndex;n.deleteRow(i)}return delete this.controls[e],t.parent=void 0,!0},l.prototype.getControl=function(e){return this.controls[e]||null},l.prototype.getContentSize=function(){for(var e=this.heightAdjustment,t=0,r=this.getDocument(),n=0;n<this.panelTabs.length;n++){var i=this.panelTabs[n],o=r.getElementById(this.expandID(i._id+"-table")),a=o?o.clientHeight:0;t=Math.max(t,a)}return{height:e+t,width:this.container.clientWidth}},l.prototype.sizeToContent=function(e){var t=this.getContentSize().height+this.heightAdjustment,r=e.clientHeight-this.heightAdjustment,n=Math.min(t,r);this.container.style.height=parseInt(n)+"px"},l.prototype.addSimpleList=function(e,t,r){var n=new a.SimpleList(e,t,r);return n.setGlobalManager(this.globalManager),n},l.prototype.removeSimpleList=function(e){return!!e&&(e.removeFromParent(),!0)}},33218:(e,t,r)=>{"use strict";r.r(t),r.d(t,{Tree:()=>s});var n=r(84998),i=r(33317),o=r(35449),a=r(41145);function s(e,t,r,n){this.myDelegate=e,this.mySelectedNodes=[],this.myOptions=n||{},this.parentContainer=r;this.groupClassName=this.myOptions.groupClassName||"expanded",this.leafClassName=this.myOptions.leafClassName||"expanded",this.selectedClassName=this.myOptions.selectedClassName||"selected",this.myGroupNodes=[],this.nodeToElement={},this.nodeIdToNode={};var i=this.myRootContainer=this.createHtmlElement_(r,"div","treeview"),o=this.rootElem=this.createElement_(t,i,n,0);this.setInputHandlers_(),n&&n.excludeRoot&&o.classList.add("exclude")}s.prototype.constructor=s,o.GlobalManagerMixin.call(s.prototype),s.prototype.destroy=function(){this.myDelegate=null,this.parentContainer&&(this.parentContainer.removeChild(this.myRootContainer),this.myRootContainer=null,this.parentContainer=null)},s.prototype.show=function(e){var t=this.myRootContainer;t.style.display=e?"block":"none"},s.prototype.getRootContainer=function(){return this.myRootContainer},s.prototype.getElementForNode=function(e){return"number"!=typeof e&&"string"!=typeof e&&(e=this.myDelegate.getTreeNodeId(e)),this.nodeToElement[e]},s.prototype.delegate=function(){return this.myDelegate},s.prototype.isCollapsed=function(e){return this.hasClass(e,"collapsed")},s.prototype.setCollapsed=function(e,t,r){t?(this.addClass(e,"collapsed",r),this.removeClass(e,"expanded",r)):(this.addClass(e,"expanded",r),this.removeClass(e,"collapsed",r))},s.prototype.setAllCollapsed=function(e){var t,r;e?(t=function(e){return e.classList.contains("expanded")},r=function(e){e.classList.add("collapsed"),e.classList.remove("expanded")}):(t=function(e){return e.classList.contains("collapsed")},r=function(e){e.classList.add("expanded"),e.classList.remove("collapsed")});for(var n=0;n<this.myGroupNodes.length;++n){var i=this.myGroupNodes[n];t(i)&&r(i)}},s.prototype.addToSelection=function(e){var t=this;function r(e){return-1===t.mySelectedNodes.indexOf(e)&&(t.mySelectedNodes.push(e),!0)}for(var n=e.length,i=0;i<n;++i){var o=e[i];r(o)&&this.addClass(o,this.selectedClassName)}},s.prototype.removeFromSelection=function(e){var t=this;function r(e){var r=t.mySelectedNodes.indexOf(e);return-1!==r&&(t.mySelectedNodes.splice(r,1),!0)}for(var n=e.length-1;n>=0;--n){var i=e[n];r(i)&&this.removeClass(i,this.selectedClassName)}},s.prototype.setSelection=function(e){return this.removeFromSelection(this.mySelectedNodes),this.addToSelection(e),this.mySelectedNodes},s.prototype.getSelection=function(){return this.mySelectedNodes.concat()},s.prototype.clearSelection=function(){this.removeFromSelection(this.mySelectedNodes)},s.prototype.isSelected=function(e){return this.hasClass(e,this.selectedClassName)},s.prototype.scrollTo=function(e){var t=this.getElementForNode(e);if(t){var r=t.offsetTop;for(t=t.parentNode;t&&t!=this.myRootContainer;)r+=t.offsetTop,t=t.parentNode;var n=this.myRootContainer.parentNode;this.myDelegate.getScrollContainer()&&(n=this.myDelegate.getScrollContainer()),n.scrollTop=r}},s.prototype.addClass=function(e,t,r){var n=this.getElementForNode(e);if(n){if(r){n=n.parentNode;for(var i=this.myOptions.excludeRoot?this.rootElem:this.myRootContainer;n&&n!==i;)n.classList.add(t),n=n.parentNode}else n.classList.add(t);return!0}return!1},s.prototype.removeClass=function(e,t,r){var n=this.getElementForNode(e);if(n){if(r){n=n.parentNode;for(var i=this.myOptions.excludeRoot?this.rootElem:this.myRootContainer;n&&n!==i;)n.classList.remove(t),n=n.parentNode}else n.classList.remove(t);return!0}return!1},s.prototype.hasClass=function(e,t){return this.getElementForNode(e).classList.contains(t)},s.prototype.clear=function(){for(var e=this.myRootContainer;e.hasChildNodes();)e.removeChild(e.lastChild);this.nodeToElement={},this.nodeIdToNode={}},s.prototype.createElement_=function(e,t,r,n){if(null==e)return null;if(!this.myDelegate.shouldCreateTreeNode(e))return null;var i,o=this;function a(t,i,a,s){var l=o.createHtmlElement_(t,i,a),u=o.myDelegate.getTreeNodeId(s);l.setAttribute("lmv-nodeId",u);var c=o.createHtmlElement_(l,"lmvheader"),h=o.createHtmlElement_(c,"icon");return h.addEventListener("mousedown",(function(e){e.stopPropagation(),e.preventDefault()}),!1),h.addEventListener("click",(function(t){o.myDelegate.onTreeNodeIconClick(o,e,t),t.stopPropagation(),t.preventDefault()}),!1),o.myDelegate.createTreeNode(e,c,r,i,n),l}var s=this.myDelegate.getTreeNodeId(e),l=o.myOptions.excludeRoot?1:0;o.myDelegate.isTreeNodeGroup(e)?(i=a(t,"group",o.groupClassName,e),o.nodeToElement[s]=i,o.nodeIdToNode[s]=e,n==l&&(i.style.left="0px"),o.myGroupNodes.push(i),o.myDelegate.forEachChild(e,(function(e){o.createElement_(e,i,r,n+1)}))):(i=a(t,"leaf",o.leafClassName,e),o.nodeToElement[s]=i,o.nodeIdToNode[s]=e,n==l&&(i.style.marginLeft="0px"));var u=o.myDelegate.getTreeNodeClass(e);return u&&i.classList.add(u),i},s.prototype.setInputHandlers_=function(){var e=this,t=this.myRootContainer,r=null,o=function(n){var i=null,o=!1;do{n&&n!==t?n.hasAttribute("lmv-nodeId")?(i=n,o=!0):n=n.parentElement:(i=null,o=!0)}while(!o);if(i){var a=i.getAttribute("lmv-nodeId");return e.nodeIdToNode[a]||r}return r};(0,n.isTouchDevice)()&&(this.hammer=new a.Manager(t,{recognizers:[i.GestureRecognizers.doubletap,i.GestureRecognizers.press],handlePointerEventMouse:!1,inputClass:n.isIE11?a.PointerEventInput:a.TouchInput}),this.hammer.on("doubletap",(function(t){var n=o(t.target);n!==r&&e.myDelegate.onTreeNodeDoubleClick(e,n,t)})),this.hammer.on("press",(function(t){var n=o(t.target);n!==r&&e.myDelegate.onTreeNodeRightClick(e,n,t)}))),t.addEventListener("click",(function(t){var n=o(t.target);n!==r&&(e.myDelegate.onTreeNodeClick(e,n,t),t.stopPropagation(),t.target.classList.contains("propertyLink")||t.preventDefault())}),!1),t.addEventListener("dblclick",(function(t){var n=o(t.target);n!==r&&(e.myDelegate.onTreeNodeDoubleClick(e,n,t),t.stopPropagation(),t.preventDefault())}),!1),t.addEventListener("contextmenu",(function(t){var n=o(t.target);n!==r&&(e.myDelegate.onTreeNodeRightClick(e,n,t),t.stopPropagation(),t.preventDefault())}),!1),t.addEventListener("mouseover",(function(t){var n=o(t.target);n!==r&&(e.myDelegate.onTreeNodeHover(e,n,t),t.stopPropagation(),t.preventDefault())}),!1),t.addEventListener("mouseout",(function(t){var r=t.toElement||t.relatedTarget;if(o(t.target)!=o(r)){e.myDelegate.onTreeNodeHover(e,-1,t),t.stopPropagation(),t.preventDefault()}}),!1)},s.prototype.createHtmlElement_=function(e,t,r){var n=this.getDocument().createElement(t);return e.appendChild(n),r&&(n.className=r),n},s.prototype.iterate=function(e,t){if(null!=e&&this.myDelegate.shouldCreateTreeNode(e)){var r=this.getElementForNode(e);if(r){t(e,r);var n=this;this.myDelegate.forEachChild(e,(function(e){n.iterate(e,t)}))}}}},30814:(e,t,r)=>{"use strict";r.r(t),r.d(t,{TreeDelegate:()=>i});var n=r(71224);function i(){}r(35449).GlobalManagerMixin.call(i.prototype),i.prototype.constructor=i,i.prototype.isTreeNodeGroup=function(e){throw"isTreeNodeGroup is not implemented."},i.prototype.getTreeNodeId=function(e){throw"getTreeNodeId is not implemented."},i.prototype.getTreeNodeIndex=function(e){throw"getTreeNodeIndex is not implemented."},i.prototype.getTreeNodeParentId=function(e){throw"getTreeNodeParentId is not implemented."},i.prototype.getTreeNodeLabel=function(e){return e.name},i.prototype.getTreeNodeCount=function(){throw"getTreeNodeCount is not implemented."},i.prototype.shouldCreateTreeNode=function(e){return!0},i.prototype.forEachChild=function(e,t){for(var r=e.children?e.children.length:0,n=0;n<r;++n){t(e.children[n])}},i.prototype.createTreeNode=function(e,t,r,i,o){var a=this.getDocument().createElement("label");t.appendChild(a);var s=this.getTreeNodeLabel(e);return r&&r.localize&&(a.setAttribute("data-i18n",s),s=n.Z.t(s)),a.textContent=s,a},i.prototype.onTreeNodeClick=function(e,t,r){},i.prototype.onTreeNodeIconClick=function(e,t,r){e.delegate().isTreeNodeGroup(t)&&e.setCollapsed(t,!e.isCollapsed(t))},i.prototype.onTreeNodeDoubleClick=function(e,t,r){},i.prototype.onTreeNodeRightClick=function(e,t,r){},i.prototype.onTreeNodeReized=function(e){},i.prototype.getTreeNodeClass=function(e){return""},i.prototype.getTreeNodeParentMaxSize=function(e){return{width:0,height:0}},i.prototype.getTreeNodeClientHeight=function(e){return 0},i.prototype.getTreeNodeDepthOffset=function(e,t){return 0},i.prototype.onTreeNodeHover=function(e,t,r){},i.prototype.getScrollContainer=function(){return null}},79893:(e,t,r)=>{"use strict";r.r(t),r.d(t,{TreeOnDemand:()=>c});var n=r(84998),i=r(33317),o=r(59005),a=r(71224),s=r(35449),l=r(41145),u=300;function c(e,t){this.dirty=!1,this.nextFrameId=0,this.scrollY=0,this.delegates=[],this.idToDelegate={},this.options=t;var r=this.getDocument();this.rootContainer=r.createElement("div"),this.rootContainer.classList.add("docking-panel-container-gradient"),this.rootContainer.classList.add("treeview"),this.rootContainer.classList.add("on-demand"),e.appendChild(this.rootContainer),this.paddingDiv=r.createElement("div"),this.paddingDiv.style.border=0,this.paddingDiv.style.margin=0,this.paddingDiv.style.padding=0,this.sizedDiv=e.parentNode,this.nodeCssTable=[[],["group"],["leaf"]],this.cssStringToNodeCssTable={"":0,group:1,leaf:2},this.nodeIndexToNodeCssTables={};for(var a=[],s=0;s<150;++s){var u=x(r);a[s]=u}this.elementsPool=a,this.elementsUsed=0,this.spinner=new o.LoadingSpinner(e),this.spinner.setGlobalManager(this.globalManager),this.spinner.addClass("tree-loading-spinner");var c=(0,n.isTouchDevice)();c&&(this.hammer=new l.Manager(this.rootContainer,{recognizers:[i.GestureRecognizers.doubletap,i.GestureRecognizers.press],handlePointerEventMouse:!1,inputClass:n.isIE11?l.PointerEventInput:l.TouchInput}));for(s=0;s<150;++s){u=a[s];c&&(this.hammer.on("doubletap",_.bind(this)),this.hammer.on("press",E.bind(this))),u.addEventListener("click",w.bind(this)),u.addEventListener("dblclick",A.bind(this)),u.addEventListener("contextmenu",S.bind(this)),u.icon.addEventListener("click",M.bind(this)),u.icon.addEventListener("mousedown",T.bind(this))}p(this)}var h=c.prototype;function d(e){if(e.dirty=!1,function(e){for(var t=e.elementsUsed,r=e.elementsPool,n=0;n<t;++n){var i=r[n];i.setAttribute("lmv-nodeId",""),i.className="";for(var o=i.header,a=o.childNodes.length-1,s=0;s<a;++s)o.removeChild(o.lastChild)}e.clear()}(e),e.displayNoProperties(!1),0!==e.delegates.length)if(1===e.delegates.length&&e.delegates[0].isLoading())e.spinner.setVisible(!0);else{if(1===e.delegates.length&&e.delegates[0].isNotAvailable())return e.spinner.setVisible(!1),void e.displayNoProperties(!0);e.spinner.setVisible(!1),function(e){var t=e.rootContainer,r=function(e){return{width:0|e.sizedDiv.clientWidth,height:0|e.sizedDiv.clientHeight}}(e).height,n=0,i=0,o=!0;t.appendChild(e.paddingDiv);var a=e.delegates.slice(0),s=e.isExcludeRoot();for(;a.length;){var l=a.shift(),c=l.modelDiv;t.appendChild(c);for(var h=[l.getRootId()],d={curr:s?-1:0,popIds:[]};h.length&&o;){if(n>e.scrollY+r+u){o=!1;break}if(e.elementsUsed===e.elementsPool.length){o=!1;break}var p=h.shift(),m=n+(S=-1===d.curr?0:l.getTreeNodeClientHeight(p));if(S>0&&m+u>=e.scrollY){var g=e.elementsPool[e.elementsUsed++];g.setAttribute("lmv-nodeId",p),l.createTreeNode(p,g.header);var v=l.getTreeNodeClass(p);v&&g.classList.add(v);var b=y(e,l,p);if(b)for(var x=b.length,_=0;_<x;++_)g.classList.add(b[_]);var E=l.getTreeNodeDepthOffset(p,d.curr);g.header.style.paddingLeft=E+"px",c.appendChild(g)}if(m+u<e.scrollY&&(i=m),n=m,(M=f(e,l,p,0===S))&&M.length>0){d.curr++;for(var w=M[M.length-1],A=d.popIds.length-1;A>=0&&d.popIds[A]===p;)d.popIds[A--]=w;d.popIds.push(w),h=M.concat(h)}for(;d.popIds.length>0&&p===d.popIds[d.popIds.length-1];)d.popIds.pop(),d.curr--}for(e.paddingDiv.style.height=i+"px";h.length;){var S,M;p=h.shift();n=m=n+(S=-1===d.curr?0:l.getTreeNodeClientHeight(p)),(M=f(e,l,p))&&M.length&&(h=M.concat(h))}}t.style.height=n+"px"}(e)}else e.spinner.setVisible(!1)}function f(e,t,r,n){if(!t.isTreeNodeGroup(r))return null;if(!n&&e.isCollapsed(t,r))return null;var i=[];return t.forEachChild(r,(function(e){i.push(e)})),i}function p(e,t){e.dirty&&!t||(t?d(e):(e.dirty=!0,e.nextFrameId=requestAnimationFrame((function(){d(e)}))))}function m(e,t){return"number"!=typeof t&&"string"!=typeof t?e.threeDelegate.getTreeNodeId(0|t):t}function g(e,t){for(var r=null;t&&t!==e.rootContainer;){if(t.hasAttribute("lmv-nodeId")){r=t;break}t=t.parentElement}if(!r)return null;var n=r.getAttribute("lmv-nodeId");return parseFloat(n)}function v(e,t){for(var r=null;t&&t!==e.rootContainer;){if(t.hasAttribute("lmv-modelId")){r=t;break}t=t.parentElement}if(!r)return null;var n=r.getAttribute("lmv-modelId");return parseInt(n)}function y(e,t,r){if(t.isControlId(r))return t.getControlIdCss(r);var n=t.getTreeNodeIndex(r);return e.nodeCssTable[e.nodeIndexToNodeCssTables[t.model.id][n]]}function b(e,t,r,n){var i=n.join(" "),o=e.cssStringToNodeCssTable[i]||e.nodeCssTable.length;o===e.nodeCssTable.length&&(e.nodeCssTable.push(n),e.cssStringToNodeCssTable[i]=o);var a=t.getTreeNodeIndex(r);e.nodeIndexToNodeCssTables[t.model.id][a]=o}function x(e,t,r){var n=e.createElement("lmvheader"),i=e.createElement("icon");n.appendChild(i);var o=e.createElement("div");return o.header=n,o.icon=i,o.appendChild(n),o}function _(e){var t=g(this,e.target);if(t){var r=v(this,e.target),n=this.getDelegate(r);n&&n.onTreeNodeDoubleClick(this,t,e)}}function E(e){var t=g(this,e.target);if(t){var r=v(this,e.target),n=this.getDelegate(r);n&&n.onTreeNodeRightClick(this,t,e)}}function w(e){if(!e.target.classList.contains("group")&&!e.target.classList.contains("leaf")){var t=g(this,e.target);if(t){var r=v(this,e.target),n=this.getDelegate(r);n&&(n.onTreeNodeClick(this,t,e),e.stopPropagation(),e.preventDefault())}}}function A(e){if(!e.target.classList.contains("group")&&!e.target.classList.contains("leaf")){var t=g(this,e.target);if(t){var r=v(this,e.target),n=this.getDelegate(r);n&&(n.onTreeNodeDoubleClick(this,t,e),e.stopPropagation(),e.preventDefault())}}}function S(e){if(!e.target.classList.contains("group")&&!e.target.classList.contains("leaf")){var t=g(this,e.target);if(t){var r=v(this,e.target),n=this.getDelegate(r);n&&(n.onTreeNodeRightClick(this,t,e),e.stopPropagation(),e.preventDefault())}}}function M(e){var t=g(this,e.target);if(t){var r=v(this,e.target),n=this.getDelegate(r);n&&(n.onTreeNodeIconClick(this,t,e),e.stopPropagation(),e.preventDefault())}}function T(e){e.stopPropagation(),e.preventDefault()}h.constructor=c,s.GlobalManagerMixin.call(h),h.pushDelegate=function(e){this.delegates.push(e),this.idToDelegate[e.model.id]=e,p(this)},h.removeDelegate=function(e){for(var t=0;t<this.delegates.length;++t){if(this.delegates[t].model.id===e)return this.delegates.splice(t,1),delete this.idToDelegate[e],delete this.nodeIndexToNodeCssTables[e],p(this),!0}return!1},h.setInstanceTree=function(e,t){if(e.setInstanceTree(t),p(this),t){var r=new Uint8Array(e.getTreeNodeCount()),n=e.instanceTree.getRootId();e.forEachChild(n,(function(t){var n=e.getTreeNodeIndex(t);r[n]=e.isTreeNodeGroup(t)?1:2}),!0);var i=e.model.id;this.nodeIndexToNodeCssTables[i]=r;var o=0,a=0;t.enumNodeChildren(n,(function(e){a||(o=e),a++})),this.setAllCollapsed(e,!0);var s=this.options.excludeRoot,l=this.options.startCollapsed;s?(this.setCollapsed(e,n,!1),l||this.setCollapsed(e,o,!1)):l||this.setCollapsed(e,e.rootId,!1),p(this,!0)}},h.show=function(e){this.rootContainer.style.display=block},h.getRootContainer=function(){return this.rootContainer},h.getDelegate=function(e){return this.idToDelegate[parseInt(e)]},h.isCollapsed=function(e,t){var r=y(this,e,t);return r&&-1!==r.indexOf("collapsed")},h.setCollapsed=function(e,t,r,n){r?(this.addClass(e,t,"collapsed",n),this.removeClass(e,t,"expanded",n)):(this.addClass(e,t,"expanded",n),this.removeClass(e,t,"collapsed",n))},h.setAllCollapsed=function(e,t){var r=function(t){this.addClass(e,t,"collapsed",!1),this.removeClass(e,t,"expanded",!1)}.bind(this),n=e.instanceTree.getRootId();this.iterate(e,n,(function(t){return e.isTreeNodeGroup(t)&&r(t),!0}))},h.addToSelection=function(e,t){for(var r=t.length,n=0;n<r;++n)this.addClass(e,t[n],"selected",!1);p(this)},h.removeFromSelection=function(e,t){for(var r=t.length,n=0;n<r;++n)this.removeClass(e,t[n],"selected",!1);p(this)},h.setSelection=function(e,t){return this.clearSelection(e),this.addToSelection(e,t),this.selectedNodes},h.clearSelection=function(e){var t=[],r=function(r){var n=y(this,e,r);n&&-1!==n.indexOf("selected")&&(t[0]=r,this.removeFromSelection(e,t))}.bind(this),n=e.instanceTree.getRootId();e.forEachChild(n,r,!0)},h.isSelected=function(e){var t=y(this,delegate,e);return t&&-1!==t.indexOf("selected")},h.scrollTo=function(e,t){var r=this.getDelegate(t.id);if(!r||!r.isNotAvailable()){var n=!1,i=[],o=function(t,r){if(!(n=n||e===t)){i.push(r.getTreeNodeClientHeight(t));var a=i.length,s=r.isTreeNodeGroup(t)&&-1!==y(this,r,t).indexOf("expanded");r.forEachChild(t,(function(e){o(e,r)})),s||n||i.length>a&&i.splice(a)}}.bind(this);this.setCollapsed(r,e,!1,!0);var a=r.getRootId();if(o(a,r),!n)return-1;for(var s=0,l=i.length,u=this.isExcludeRoot()?1:0;u<l;++u)s+=i[u];if(1===this.delegates.length)return p(this,!0),s;for(u=0;u<this.delegates.length;++u){var c=this.delegates[u];if(c===r)break;i=[],e=-1,n=!1,a=c.getRootId(),o(a,c),l=i.length;for(var h=0,d=0;d<l;++d)h+=i[d];s+=h}return p(this,!0),s}},h.addClass=function(e,t,r,n){function i(t,r,n){var i=y(t,e,r);i&&(-1===i.indexOf(n)&&((i=i.slice(0)).push(n),i.sort(),b(t,e,r,i)))}if(n)for(var o=e.getTreeNodeParentId(m(this,t));o;)i(this,o,r),o=e.getTreeNodeParentId(o);else i(this,t,r);return p(this),!0},h.removeClass=function(e,t,r,n){function i(t,r,n){var i=y(t,e,r);if(i){var o=i.indexOf(n);-1!==o&&((i=i.slice(0)).splice(o,1),b(t,e,r,i))}}if(n)for(var o=e.getTreeNodeParentId(m(this,t));o;)i(this,o,r),o=e.getTreeNodeParentId(o);else i(this,t,r);return p(this),!0},h.hasClass=function(e,t){return 1!==y(this,delegate,e).indexOf(t)},h.clear=function(){for(var e,t=this.rootContainer;e=t.lastChild;)t.removeChild(e);for(var r=0;r<this.delegates.length;++r)this.delegates[r].clean();this.elementsUsed=0},h.iterate=function(e,t,r){null!=t&&e.shouldCreateTreeNode(t)&&r(t)&&e.forEachChild(t,function(t){this.iterate(e,t,r)}.bind(this))},h.forEachDelegate=function(e){for(var t=0;t<this.delegates.length;++t)e(this.delegates[t])},h.destroy=function(){this.clear(),cancelAnimationFrame(this.nextFrameId),this.rootContainer.parentNode.removeChild(this.rootContainer),this.rootContainer=null,this.rootId=-1,this.nodeCssTable=null,this.nodeIndexToNodeCssTables=null,this.cssStringToNodeCssTable=null,this.elementsPool=null,this.elementsUsed=-1,this.scrollY=-1,this.hammer&&(this.hammer.destroy(),this.hammer=null)},h.setScroll=function(e){Math.abs(this.scrollY-e)>u&&(this.scrollY=e,p(this))},h.displayNoProperties=function(e){var t=this.getDocument();if(e){if(!this.divNoProps){this.divNoProps=t.createElement("div");var r="Model Browser is not available";this.divNoProps.innerText=a.Z.t(r),this.divNoProps.setAttribute("data-i18n",r),this.divNoProps.classList.add("lmv-no-properties")}if(!this.divNoProps.parentNode)this.rootContainer.parentNode.appendChild(this.divNoProps)}else this.divNoProps&&this.divNoProps.parentNode&&this.divNoProps.parentNode.removeChild(this.divNoProps)},h.isExcludeRoot=function(){return 1===this.delegates.length&&this.options.excludeRoot},h.getDelegateCount=function(){return this.delegates.length}},75977:(e,t,r)=>{"use strict";r.r(t),r.d(t,{ViewerModelStructurePanel:()=>g,generateDefaultViewerHandlerOptions:()=>u});var n=r(1204),i=r(20361),o=r(37169),a=r(68005),s=r(98926),l=r(83802),u=function(e){return{onSearchSelected:function(t){var r=t.id,n=e.impl.findModel(t.modelId);e.isolate(r,n)},onVisibilityIconClick:function(t,r){e.toggleVisibility(t,r)},onCreateUI:function(t){e.resizePanels&&e.resizePanels({dockingPanels:[t]}),t.scrollContainer.addEventListener("contextmenu",function(t){e.contextMenu.show(t)}.bind(t))},onIsolate:function(t,r){if(e.isolate(t,r),e.fitToView([t],r,!1),r){var n={type:o.SHOW_PROPERTIES_EVENT,dbId:t,model:r};e.dispatchEvent(n)}},onToggleMultipleOverlayedSelection:function(t){e.impl.selector.setAggregateSelection(t.map((function(t){return{model:e.impl.findModel(parseInt(t.modelId)),ids:t.ids}})));var r=e.getAggregateSelection();e.fitToView(r)},onToggleOverlayedSelection:function(t,r,n){n?e.select([],void 0,r):(e.select(t,r),e.fitToView([t],r,!1))},onTreeNodeRightClick:function(t){e.contextMenu.show(t)},onSelectOnly:function(t,r){e.select(t,r)},onDeselectAll:function(){e.clearSelection()},onSelectToggle:function(t,r){e.toggleSelect(t,r)},onShowAll:function(){e.showAll()},onFocus:function(){e.fitToView()},onHide:function(t,r){e.hide(t,r)},onShow:function(t,r){e.show(t,r)},onToggleVisibility:function(t,r){e.toggleVisibility(t,r)},getAggregateIsolation:e.getAggregateIsolation.bind(e),getAggregateHiddenNodes:e.getAggregateHiddenNodes.bind(e),getAggregateSelection:e.getAggregateSelection.bind(e),globalManager:e.globalManager,container:e.container,removeEventListener:e.removeEventListener.bind(e),addEventListener:e.addEventListener.bind(e)}};function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}function h(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function d(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?h(Object(r),!0).forEach((function(t){f(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):h(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function f(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var p=Autodesk.Viewing.Private,m={click:{onObject:["isolate"]},clickShift:{onObject:["toggleMultipleOverlayedSelection"]},clickCtrl:{onObject:["toggleVisibility"]}};function g(e,t,r){var o=d({},r)||{},l=t;e instanceof Autodesk.Viewing.GuiViewer3D||e instanceof Autodesk.Viewing.Viewer3D?(s.logger.warn("Deprecated use of Viewer as parameter. Use options callbacks instead"),o=d(d({},o),u(e))):o=d({},e),this.visible=!1,this._trackNodeClick=!0,o.defaultTitle="Model",o.excludeRoot=void 0===o.excludeRoot||o.excludeRoot,o.startCollapsed=void 0!==o.startCollapsed&&o.startCollapsed,o.scrollEaseCurve=o.scrollEaseCurve||[0,0,.29,1],o.scrollEaseSpeed=void 0!==o.scrollEaseSpeed?o.scrollEaseSpeed:.003,o.addFooter=void 0===o.addFooter||o.addFooter,this.clickConfig=o&&o.docStructureConfig?o.docStructureConfig:m,this.isMac=-1!==navigator.userAgent.search("Mac OS"),o.hideSearch?(o.heightAdjustment=70,n.ModelStructurePanel.call(this,o.container,o.container.id+"ViewerModelStructurePanel",l,o),this.scrollContainer.classList.add("no-search")):(o.heightAdjustment=104,n.ModelStructurePanel.call(this,o.container,o.container.id+"ViewerModelStructurePanel",l,o),this.searchbox=new a.Searchbox(o.container.id+"ViewerModelStructurePanel-Searchbox",o.container,{excludeRoot:o.excludeRoot,searchFunction:v.bind(this)}),this.searchbox.setGlobalManager(this.globalManager),o.onSearchSelected&&this.searchbox.addEventListener(i.J,o.onSearchSelected),this.container.appendChild(this.searchbox.container)),this.setGlobalManager(o.globalManager),this._ignoreScroll=!1,this.selectedNodes={},this.onViewerSelect=this.onViewerSelect.bind(this),this.onViewerIsolate=this.onViewerIsolate.bind(this),this.onViewerHide=this.onViewerHide.bind(this),this.onViewerShow=this.onViewerShow.bind(this)}function v(e){var t=this.tree,r=e.toLowerCase(),n=[];return t.forEachDelegate((function(e){var i=e.getRootId(),o=[];t.iterate(e,i,(function(t){var n=e.instanceTree&&e.instanceTree.getNodeName(t);return n&&-1!==n.toLowerCase().indexOf(r)&&o.push(t),!0})),n.push({ids:o,delegate:e})})),p.analytics.track("viewer.model_browser",{from:"Panel",action:"Search"}),n}g.prototype=Object.create(n.ModelStructurePanel.prototype),g.prototype.constructor=g,l.ViewerPanelMixin.call(g.prototype),g.prototype.uninitialize=function(){var e,t,r,i,a,s,l,u;null===(e=(t=this.options).removeEventListener)||void 0===e||e.call(t,o.AGGREGATE_SELECTION_CHANGED_EVENT,this.onViewerSelect),null===(r=(i=this.options).removeEventListener)||void 0===r||r.call(i,o.AGGREGATE_ISOLATION_CHANGED_EVENT,this.onViewerIsolate),null===(a=(s=this.options).removeEventListener)||void 0===a||a.call(s,o.HIDE_EVENT,this.onViewerHide),null===(l=(u=this.options).removeEventListener)||void 0===l||l.call(u,o.SHOW_EVENT,this.onViewerShow),this.searchResults&&(this.searchResults.uninitialize(),this.searchResults=null),n.ModelStructurePanel.prototype.uninitialize.call(this)},g.prototype.resizeToContent=function(){var e=this.scrollContainer,t=this.tree?this.tree.getRootContainer():null;if(e&&t){var r="calc(100% + "+e.scrollLeft+"px)";t.style.width=r}},g.prototype.createUI=function(){var e,t,r,i,a,s,l,u,c,h;if(!this.uiCreated){n.ModelStructurePanel.prototype.createUI.call(this),this.scrollContainer.classList.remove("left");var d=function(){this.visible&&this.resizeToContent(),requestAnimationFrame(d)}.bind(this);d(),null===(e=(t=this.options).onCreateUI)||void 0===e||e.call(t,this);var f=this.options,p=f.maxHeight?f.maxHeight:"calc("+this.container.style.maxHeight+" - 30px)";this.container.style.top="10px",this.container.style.left="10px",this.container.style.height=p,this.container.style.maxHeight=p,null===(r=(i=this.options).addEventListener)||void 0===r||r.call(i,o.AGGREGATE_SELECTION_CHANGED_EVENT,this.onViewerSelect),null===(a=(s=this.options).addEventListener)||void 0===a||a.call(s,o.AGGREGATE_ISOLATION_CHANGED_EVENT,this.onViewerIsolate),null===(l=(u=this.options).addEventListener)||void 0===l||l.call(u,o.HIDE_EVENT,this.onViewerHide),null===(c=(h=this.options).addEventListener)||void 0===c||c.call(h,o.SHOW_EVENT,this.onViewerShow)}},g.prototype.onViewerSelect=function(e){this.setSelection(e.selections),this._ignoreScroll||this.scrollToSelection(e.selections),this._ignoreScroll=!1},g.prototype.onViewerIsolate=function(e){this.setIsolation(e.isolation)},g.prototype.onViewerHide=function(e){this.setHidden(e.nodeIdArray.slice(),e.model,!0)},g.prototype.onViewerShow=function(e){this.setHidden(e.nodeIdArray.slice(),e.model,!1)},g.prototype.setVisible=function(e){n.ModelStructurePanel.prototype.setVisible.call(this,e),this.visible!==e&&(this.visible=e,this.visible&&this.sync())},g.prototype.sync=function(){var e,t,r,n,i,o,a=(null===(e=(t=this.options).getAggregateIsolation)||void 0===e?void 0:e.call(t))||[],s=(null===(r=(n=this.options).getAggregateHiddenNodes)||void 0===r?void 0:r.call(n))||[],l=(null===(i=(o=this.options).getAggregateSelection)||void 0===i?void 0:i.call(o))||[];if(this.setIsolation(a),0===a.length)for(var u=0;u<s.length;++u){var c=s[u].model,h=s[u].ids;this.setHidden(h,c,!0)}this.setSelection(l),this.scrollToSelection(l)},g.prototype.removeTreeUI=function(e){delete this.selectedNodes[e.id],n.ModelStructurePanel.prototype.removeTreeUI.call(this,e)},g.prototype.setHidden=function(e,t,r){for(var n=this.tree,i=n.getDelegate(t.id),o=r?function(e){return n.addClass(i,e,"dim",!1),n.removeClass(i,e,"visible",!1),!0}:function(e){return n.removeClass(i,e,"dim",!1),n.addClass(i,e,"visible",!1),!0},a=0;a<e.length;++a)n.iterate(i,e[a],o)},g.prototype.setIsolation=function(e){var t=this,r=this.tree;if(0!==e.length){var n=[];e.length&&this.tree.forEachDelegate(function(t){for(var r=-1,i=0;i<e.length;i++)if(e[i].model===t.model){r=i;break}-1===r&&n.push(t)}.bind(this));for(var i=function(n){var i=e[n].model,o=i.getData().instanceTree;if(!o)return"continue";var s=o.getRootId(),l=r.getDelegate(i.id);return r.iterate(l,s,(function(e){return r.removeClass(l,e,"dim",!1),r.removeClass(l,e,"visible",!1),!0})),0===(a=e[n].ids).length?"continue":1===a.length&&a[0]===s?{v:void 0}:(t.setHidden([s],i,!0),void t.setHidden(a,i,!1))},o=0;o<e.length;++o){var a,s=i(o);if("continue"!==s&&"object"===c(s))return s.v}for(var l=function(e){var i=n[e],o=i.model,a=i.instanceTree;if(!a)return"continue";var s=a.getRootId();r.iterate(i,s,(function(e){return r.removeClass(i,e,"dim",!1),r.removeClass(i,e,"visible",!1),!0})),t.setHidden([s],o,!0)},u=0;u<n.length;++u)l(u)}else r.forEachDelegate(function(e){var t=e.model,n=e.instanceTree;if(n){var i=n.getRootId();r.iterate(e,i,(function(t){return r.removeClass(e,t,"dim",!1),r.removeClass(e,t,"visible",!1),!0})),this.setHidden([i],t,!1)}}.bind(this))},g.prototype.setSelection=function(e){var t,r,n,i,o,a,s,l=this.tree;for(var u in this.selectedNodes)if(o=this.selectedNodes[u],(a=l.getDelegate(u))&&(s=a.instanceTree)){for(r=0;r<o.length;++r)for(n=s.getNodeParentId(o[t]);n;)l.removeClass(a,n,"ancestor-selected"),n=s.getNodeParentId(n);l.clearSelection(a)}for(this.selectedNodes={},t=0;t<e.length;++t)if(i=e[t].model,o=e[t].dbIdArray||e[t].selection,(a=l.getDelegate(i.id))&&(s=a.instanceTree)){for(r=0;r<o.length;++r)for(n=s.getNodeParentId(o[t]);n;)l.addClass(a,n,"ancestor-selected"),n=s.getNodeParentId(n);l.setSelection(a,o),this.selectedNodes[i.id]=o.concat()}},g.prototype.scrollToSelection=function(e){var t=e[0];if(t){var r=t.model,n=t.dbIdArray||t.selection,i=this.tree.scrollTo(n[0],r),o=this.scrollContainer.scrollTop;this.scrollContainer.scrollTop=i;var a=this.scrollContainer.scrollTop;this.scrollContainer.scrollTop=o,this.options.scrollEaseSpeed>0?this.animateScroll(o,a,function(e){this.tree.setScroll(e)}.bind(this)):(this.scrollContainer.scrollTop=a,this.tree.setScroll(a))}},g.prototype.onEyeIcon=function(e,t){var r,n;null===(r=(n=this.options).onVisibilityIconClick)||void 0===r||r.call(n,e,t),p.analytics.track("viewer.model_browser",{from:"Panel",action:"Toggle Visibility"})},g.prototype.onTreeNodeClick=function(e,t,r,n){if(this._trackNodeClick&&(s.logger.track({category:"node_selected",name:"model_browser_tool"}),this._trackNodeClick=!1),!this.isMac||!n.ctrlKey){var i="click";this.ctrlDown(n)&&(i+="Ctrl"),n.shiftKey&&(i+="Shift"),n.altKey&&(i+="Alt");var o=["toggleOverlayedSelection"],a=this.clickConfig[i];a&&(o=a.onObject),p.analytics.track("viewer.model_browser",{from:"Panel",action:"Select"}),this.handleAction(o,t,r)}},g.prototype.onTreeNodeRightClick=function(e,t,r,n){if(this.isMac&&n.ctrlKey&&0===n.button)return this.clickConfig&&this.clickConfig.clickCtrl&&this.handleAction(this.clickConfig.clickCtrl.onObject,t,r),null;this.options.onTreeNodeRightClick&&this.options.onTreeNodeRightClick(n)},g.prototype.handleAction=function(e,t,r){var n,i,o,a,s,l,u,c,h,d,f,p,m,g,v,y;for(var b in e)switch(e[b]){case"toggleOverlayedSelection":this.toggleOverlayedSelection(t,r);break;case"toggleMultipleOverlayedSelection":this.toggleMultipleOverlayedSelection(t,r);break;case"selectOnly":this.options.onSelectOnly&&this.options.onSelectOnly(t,r);break;case"deselectAll":null===(n=(i=this.options).onDeselectAll)||void 0===n||n.call(i,t,r);break;case"selectToggle":null===(o=(a=this.options).onSelectToggle)||void 0===o||o.call(a,t,r);break;case"isolate":null===(s=(l=this.options).onIsolate)||void 0===s||s.call(l,t,r);break;case"showAll":null===(u=(c=this.options).onShowAll)||void 0===u||u.call(c,t,r);break;case"focus":null===(h=(d=this.options).onFocus)||void 0===h||h.call(d,t,r);break;case"hide":null===(f=(p=this.options).onHide)||void 0===f||f.call(p,t,r);break;case"show":null===(m=(g=this.options).onShow)||void 0===m||m.call(g,t,r);break;case"toggleVisibility":null===(v=(y=this.options).onToggleVisibility)||void 0===v||v.call(y,t,r)}},g.prototype.toggleOverlayedSelection=function(e,t){var r,n,i=this.selectedNodes[t.id],o=i?i.indexOf(e):-1;this._ignoreScroll=!0,null===(r=(n=this.options).onToggleOverlayedSelection)||void 0===r||r.call(n,e,t,-1!==o)},g.prototype.toggleMultipleOverlayedSelection=function(e,t){var r=this.selectedNodes[t.id],n=r?r.indexOf(e):-1;if(-1===n?(r||(r=this.selectedNodes[t.id]=[]),r.push(e)):r.splice(n,1),this.options.onToggleMultipleOverlayedSelection){var i=[];for(var o in this.selectedNodes)if(Object.prototype.hasOwnProperty.call(this.selectedNodes,o)){var a=this.selectedNodes[o];i.push({modelId:o,ids:a})}this.options.onToggleMultipleOverlayedSelection(i)}this._ignoreScroll=!0},g.prototype.ctrlDown=function(e){return this.isMac&&e.metaKey||!this.isMac&&e.ctrlKey}},66190:(e,t,r)=>{"use strict";r.r(t),r.d(t,{ViewerObjectContextMenu:()=>o});var n=r(30587),i=r(98926);function o(e){n.ObjectContextMenu.call(this,e)}o.prototype=Object.create(n.ObjectContextMenu.prototype),o.prototype.constructor=o,o.prototype.buildMenu=function(e,t){var r=this;if(this.viewer.model){var n=this,o=[],a=this.viewer.navigation,s=this.viewer.model.is2d(),l=Autodesk.Viewing.Private.analytics;t.hasSelected&&(o.push({title:"Isolate",target:function(){var e=n.viewer.getAggregateSelection();n.viewer.clearSelection(),n.viewer.impl.visibilityManager.aggregateIsolate(e),i.logger.track({name:"isolate_count",aggregate:"count"}),l.track("viewer.object.visibility",{action:"Isolate"})}}),t.hasVisible&&o.push({title:"Hide Selected",target:function(){var e=n.viewer.impl.selector.getAggregateSelection();n.viewer.clearSelection(),n.viewer.impl.visibilityManager.aggregateHide(e),l.track("viewer.object.visibility",{action:"Hide Selected"})}}),t.hasHidden&&o.push({title:"Show Selected",target:function(){var e=n.viewer.getSelection();n.viewer.clearSelection(),n.viewer.show(e),l.track("viewer.object.visibility",{action:"Show Selected"})}})),s&&o.push({title:"Show All Layers",target:function(){n.viewer.setLayerVisible(null,!0),l.track("viewer.object.visibility",{action:"Show All Layers"})}}),o.push({title:"Show All Objects",target:function(){n.viewer.showAll(),i.logger.track({name:"showall",aggregate:"count"}),l.track("viewer.object.visibility",{action:"Show All Objects"})}});var u=n.viewer.getAggregateSelection();if(!s&&1===u.length&&a.isActionEnabled("gotoview")&&o.push({title:"Focus",target:function(){if((u=n.viewer.getAggregateSelection()).length>0){var e=u[0];n.viewer.fitToView(e.selection,e.model)}else 0===u.length&&n.viewer.fitToView();i.logger.track({name:"fittoview",aggregate:"count"})}}),!s){var c=this.viewer.impl.getCanvasBoundingClientRect(),h=e.clientX-c.left,d=e.clientY-c.top,f=this.viewer.clientToWorld(h,d,!1);f&&o.push({title:"Pivot",target:function(){r.viewer.navigation.setPivotPoint(f.point)}})}return t.hasSelected&&o.push({title:"Clear Selection",target:function(){n.viewer.clearSelection(),i.logger.track({name:"clearselection",aggregate:"count"})}}),o}}},83802:(e,t,r)=>{"use strict";function n(){this.getContainerBoundingRect=function(){var e=this.parentContainer.getBoundingClientRect(),t={height:0,width:0,left:0,bottom:0,right:0,top:0},r=this.getDocument().getElementsByClassName("toolbar-menu");return r&&r.length>0&&(t=r[0].getBoundingClientRect()),{height:e.height-t.height,width:e.width,left:e.left,bottom:e.bottom-t.height,right:e.right,top:e.top}}}r.r(t),r.d(t,{ViewerPanelMixin:()=>n})},32757:(e,t,r)=>{"use strict";r.r(t),r.d(t,{ViewerPropertyPanel:()=>u});var n=r(53974),i=r(83802),o=r(37169),a=r(76723),s=r(98926);function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}function u(e){this.viewer=e,this.setGlobalManager(e.globalManager),this.currentNodeIds=[],this.currentModel=null,this.currentSelections=[],this.isDirty=!0,this.propertyNodeId=null,this.normalTitle="Properties",this.loadingTitle="Object Properties Loading",this._viewDbId=null,this.onProperties=this.onProperties.bind(this),this.onPropertySet=this.onPropertySet.bind(this),this.onPropError=this.onPropError.bind(this),this.setPropertiesIntoUI=this.setPropertiesIntoUI.bind(this),this.setAggregatedPropertiesIntoUI=this.setAggregatedPropertiesIntoUI.bind(this),this._onDisplayUnitPreferenceChanged=this._onDisplayUnitPreferenceChanged.bind(this),n.PropertyPanel.call(this,e.container,"ViewerPropertyPanel",this.loadingTitle)}function c(e){var t=e.getDocumentNode(),r=t&&t.findViewableParent();return!(!r||-1===r.name().toLocaleLowerCase().indexOf(".sld"))}u.prototype=Object.create(n.PropertyPanel.prototype),u.prototype.constructor=u,i.ViewerPanelMixin.call(u.prototype),u.prototype._onDisplayUnitPreferenceChanged=function(){this.isDirty=!0;var e=this.currentModel?this.currentModel.getRootId():null;if(null!==this.propertyNodeId&&this.propertyNodeId!==e){var t={model:this.currentModel};t.selection=Array.isArray(this.propertyNodeId)?this.propertyNodeId:[this.propertyNodeId],this.requestAggregatedNodeProperties(t)}else this.requestProperties()},u.prototype.initialize=function(){n.PropertyPanel.prototype.initialize.call(this);var e=this;this.viewer.prefs.addListeners(Autodesk.Viewing.Private.Prefs.DISPLAY_UNITS,this._onDisplayUnitPreferenceChanged),this.viewer.prefs.addListeners(Autodesk.Viewing.Private.Prefs.DISPLAY_UNITS_PRECISION,this._onDisplayUnitPreferenceChanged),e.addEventListener(e.viewer,o.AGGREGATE_SELECTION_CHANGED_EVENT,(function(t){t.selections&&t.selections.length?(e.currentNodeIds=t.selections[0].dbIdArray,e.currentModel=t.selections[0].model,e.currentSelections=[],t.selections.forEach((function(t){e.currentSelections.push({model:t.model,selection:t.dbIdArray})}))):e.resetCurrentModel(),e.isDirty=!0,e.requestProperties()})),e.addEventListener(e.viewer,o.SHOW_PROPERTIES_EVENT,(function(t){t&&t.dbId&&(e.currentModel=t.model,e.requestAggregatedNodeProperties({model:t.model,selection:[t.dbId]}))})),e.addEventListener(e.viewer,o.HIDE_EVENT,(function(t){e.isDirty=!0,e.requestProperties()})),e.addEventListener(e.viewer,o.OBJECT_TREE_CREATED_EVENT,(function(t){e.currentModel===t.model&&(e.isDirty=!0,e.requestProperties())})),e.addEventListener(e.viewer,o.SHOW_EVENT,(function(t){e.isDirty=!0,e.requestProperties()}));var t=this.viewer.getAggregateSelection();t.length?(this.currentModel=t[0].model,this.currentNodeIds=t[0].selection,this.currentSelections=t):this.resetCurrentModel()},u.prototype.resetCurrentModel=function(){var e=this.viewer?this.viewer.getVisibleModels():[];this.currentModel=1===e.length?e[0]:null,this.currentNodeIds=[],this.currentSelections=[]},u.prototype.setTitle=function(e,t){e||(e="Object Properties",(t=t||{}).localizeTitle=!0),n.PropertyPanel.prototype.setTitle.call(this,e,t)},u.prototype.setVisible=function(e){a.DockingPanel.prototype.setVisible.call(this,e),this.requestProperties()},u.prototype.visibilityChanged=function(){a.DockingPanel.prototype.visibilityChanged.call(this),this.isVisible()&&this.requestProperties()},u.prototype.requestProperties=function(){this.isVisible()&&this.isDirty&&(this.currentSelections.length>0?this.requestAggregatedNodeProperties(this.currentSelections):this.showDefaultProperties(),this.isDirty=!1)},u.prototype.onProperties=function(e){var t=this;if(this.viewer&&this.currentModel&&e.dbId===this.propertyNodeId){var r,n=[],i=e.properties;if(i)for(var o=0,a=i.length;o<a;++o){var s=i[o];"__internalref__"===s.displayCategory&&n.push(s.displayValue)}var l=this.currentModel;r=l.is3d()&&c(l)&&n.length>0?function(e,t,r){return new Promise((function(n,i){e.getBulkProperties2(t,{ignoreHidden:!0},(function(e){for(var t=0,i=e.length;t<i;++t)for(var o=e[t],a=0,s=o.properties.length;a<s;++a){for(var l=o.properties[a],u=!0,c=0,h=r.properties.length;c<h;++c)r.properties[c].displayName===l.displayName&&(u=!1,c=h);u&&r.properties.push(l)}n(r)}))}))}(l,n,e):Promise.resolve(e),r.then(this.setPropertiesIntoUI).catch((function(){t.setProperties([]),t.highlight(""),t.resizeToContent(),t.respositionPanel()}))}},u.prototype.onPropertySet=function(e){var t=this;if(this.viewer&&this.currentModel){if(0===e.getVisibleKeys().length)return this.onPropError(),this.resizeToContent(),void this.respositionPanel();var r=e.map,n=[];e.getValidIds(null,"__internalref__").forEach((function(e){r[e].forEach((function(e){n.includes(e.displayValue)||n.push(e.displayValue)}))}));var i=this.currentModel;(i.is3d()&&c(i)&&n.length>0?function(e,t,r){return new Promise((function(n,i){e.getPropertySet(t,(function(e){n(r.merge(e))}),i,{ignoreHidden:!0})}))}(i,n,e):Promise.resolve(e)).then(this.setAggregatedPropertiesIntoUI).catch((function(e){s.logger.error(e),t.setProperties([]),t.highlight(""),t.resizeToContent(),t.respositionPanel()}))}},u.prototype.setAggregatedPropertiesIntoUI=function(e){var t=e.getDbIds().length;if(1===t){var r=Object.prototype.hasOwnProperty.call(e.map,"Name"),n=r?e.map.Name[0]:this.normalTitle;"object"===l(n)&&Object.prototype.hasOwnProperty.call(n,"displayValue")&&(r=!0,n=n.displayValue),this.setTitle(n,{localizeTitle:!r})}else this.setTitle("Properties %(value)",{localizeTitle:!0,i18nOpts:{value:"(".concat(t,")")}});this.setAggregatedProperties(e),this.highlight(this.viewer.searchText),this.resizeToContent(),this.respositionPanel()},u.prototype.setPropertiesIntoUI=function(e){var t=e.name||this.normalTitle,r=!e.name;this.setTitle(t,{localizeTitle:r}),"name"in e&&e.properties&&e.properties.splice(0,0,{displayName:"Name",displayValue:e.name,displayCategory:null,attributeName:"Name",type:20,units:null,hidden:!1,precision:0}),this.setProperties(e.properties),this.highlight(this.viewer.searchText),this.resizeToContent(),this.respositionPanel()},u.prototype.onPropError=function(){this.setTitle(this.normalTitle,{localizeTitle:!0}),this.showNoProperties()},u.prototype.requestAggregatedNodeProperties=function(e){var t,r=this;1===(e=Array.isArray(e)?e:[e]).length&&1===(null===(t=e[0].selection)||void 0===t?void 0:t.length)&&(this.propertyNodeId=e[0].selection[0]);var n=[];e.forEach((function(e){var t,r,i,o;n.push(e.model.getPropertySetAsync(e.selection,{fileType:null===(t=e.model.getData())||void 0===t||null===(r=t.loadOptions)||void 0===r?void 0:r.fileExt,needsExternalId:null===(i=e.model.getData())||void 0===i||null===(o=i.loadOptions)||void 0===o?void 0:o.needsExternalId}))})),Promise.all(n).then((function(e){for(var t=e[0],n=1;n<e.length;n++)t.merge(e[n]);r.onPropertySet(t)})).catch(this.onPropError)},u.prototype.requestNodeProperties=function(e){var t=this,r=this.currentModel;this.propertyNodeId=e;var n=Array.isArray(e);(n?r.getPropertySet.bind(r):r.getProperties2.bind(r))(e,(function(e){t.viewer&&r===t.currentModel&&(n?t.onPropertySet(e):t.onProperties(e))}),this.onPropError)},u.prototype.setNodeProperties=u.prototype.requestNodeProperties,u.prototype.requestViewProperties=function(e){var t=this;if(null===this._viewDbId){var r=this.currentModel,n=r.getRootId();this.propertyNodeId=n,r.getPropertySet([n],(function(i){if(t.viewer&&r===t.currentModel){t._viewDbId=n;var o=e.name(),a=e.isSheet(),s=[],l=[],u=i.getValidIds("Sheet"),c=i.getValidIds("View");u.forEach((function(e){i.map[e].forEach((function(e){l.push(e.displayValue)}))})),c.forEach((function(e){i.map[e].forEach((function(e){s.push(e.displayValue)}))}));var h=a?l:s;if(0!==h.length){var d=t;r.getBulkProperties2(h,{propFilter:["name","dbId"],ignoreHidden:!0},(function(e){for(var t=[],s=0;s<e.length;++s)if(-1!==o.indexOf(e[s].name)){var l=e[s].dbId;if(!a)return d._viewDbId=l,void d.requestAggregatedNodeProperties({model:d.currentModel,selection:[l]});t.push(l)}0!==t.length?function(e,t,r){return new Promise((function(n,i){r=r||e.myData.metadata.title,e.getBulkProperties2(t,{ignoreHidden:!0},(function(e){for(var t=0,i=e.length;t<i;++t){var o=e[t];if(o.name&&-1!==r.indexOf(o.name))for(var a=0,s=o.properties.length;a<s;++a){var l=o.properties[a];if("Sheet Number"===l.displayName&&-1!==r.indexOf(l.displayValue))return n(o)}}return n(null)}))}))}(r,t,o).then((function(e){e&&e.dbId&&e.dbId!==n?(d._viewDbId=e.dbId,d.requestAggregatedNodeProperties({model:d.currentModel,selection:[e.dbId]})):d.onPropertySet(i)})):d.onPropertySet(i)}))}else t.onPropertySet(i)}}),this.onPropError)}else{var i={model:this.currentModel,selection:[this._viewDbId]};this.requestAggregatedNodeProperties(i)}},u.prototype.respositionPanel=function(){if(this.isVisible()){var e=this.viewer.toolController,t=e.lastClickX,r=e.lastClickY,n=this.container.getBoundingClientRect(),i=n.left,o=n.top,a=n.width,s=n.height,l=this.viewer.impl.getCanvasBoundingClientRect(),u=l.left,c=l.top,h=l.width,d=l.height;i<=t&&t<i+a&&o<=r&&r<o+s&&(t<i+a/2&&t+a<u+h?(this.container.style.left=Math.round(t-u)+"px",this.container.dockRight=!1):u<=t-a?(this.container.style.left=Math.round(t-u-a)+"px",this.container.dockRight=!1):t+a<u+h?(this.container.style.left=Math.round(t-u)+"px",this.container.dockRight=!1):r+s<c+d?(this.container.style.top=Math.round(r-c)+"px",this.container.dockBottom=!1):c<=r-s&&(this.container.style.top=Math.round(r-c-s)+"px",this.container.dockBottom=!1))}},u.prototype.showDefaultProperties=function(){var e=this.currentModel?this.currentModel.getRootId():null;if(e){var t=this.currentModel.getDocumentNode();t&&!t.isMasterView()?this.requestViewProperties(t):this.requestAggregatedNodeProperties({model:this.currentModel,selection:[e]})}else this.propertyNodeId=null,this.setTitle(this.normalTitle,{localizeTitle:!0}),n.PropertyPanel.prototype.showDefaultProperties.call(this)},u.prototype.areDefaultPropertiesShown=function(){if(!this.currentModel)return!1;var e=this.currentModel.getRootId();return this.propertyNodeId===e},u.prototype.uninitialize=function(){n.PropertyPanel.prototype.uninitialize.call(this),this.viewer.prefs.removeListeners(Autodesk.Viewing.Private.Prefs.DISPLAY_UNITS,this._onDisplayUnitPreferenceChanged),this.viewer.prefs.removeListeners(Autodesk.Viewing.Private.Prefs.DISPLAY_UNITS_PRECISION,this._onDisplayUnitPreferenceChanged),this.viewer=null,this._viewDbId=null,this.currentModel=null,this.currentSelections=[],this.propertyNodeId=null,this.currentNodeIds=null},u.prototype.onCategoryClick=function(e,t){n.PropertyPanel.prototype.onCategoryClick.call(this,e,t),this.resizeToContent()},u.prototype.onCategoryIconClick=function(e,t){n.PropertyPanel.prototype.onCategoryIconClick.call(this,e,t),this.resizeToContent()}},49710:(e,t,r)=>{"use strict";r.r(t),r.d(t,{ViewerSettingTab:()=>S,ViewerSettingsPanel:()=>T});var n=r(89853),i=r(37169),o=r(98926),a=r(95018),s=r(71224),l=r(84998),u=r(83802),c=r(35449);function h(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var d=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._width=t||60,this._height=r||60}var t,r,n;return t=e,(r=[{key:"createThumbnail",value:function(e,t){var r=this;return new Promise((function(t){var n=r.getDocument().createElement("canvas");n.width=r._width,n.height=r._height;var i=n.getContext("2d"),o=i.createLinearGradient(0,0,0,n.height),a=e.bgColorGradient,s=f(a[0],a[1],a[2]),l=f(a[3],a[4],a[5]);o.addColorStop(0,s),o.addColorStop(1,l),i.fillStyle=o,i.fillRect(0,0,n.width,n.height),n.toBlob((function(e){var r=URL.createObjectURL(e);t(r)}))}))}}])&&h(t.prototype,r),n&&h(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function f(e,t,r){return e=parseInt(e),t=parseInt(t),r=parseInt(r),"#"+p(e)+p(t)+p(r)}function p(e){if(0===e)return"00";for(var t="",r=e>255?255:e;0!==r;){var n=r%16;r=r/16|0,t=m[n.toString()]+t}return t.length>1?t:"0"+t}c.GlobalManagerMixin.call(d.prototype);var m={0:"0",1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9",10:"A",11:"B",12:"C",13:"D",14:"E",15:"F"},g=r(23279),v=r.n(g),y=r(55412),b=r(50041),x=r(5130);function _(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function E(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var w=Autodesk.Viewing.Private,A=0,S={Navigation:"navigationtab",Configuration:"performancetab",Appearance:"appearance",Environment:"environment"},M=0;function T(e,t){var r=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?_(Object(r),!0).forEach((function(t){E(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},e);if(e instanceof Autodesk.Viewing.GuiViewer3D||e instanceof Autodesk.Viewing.Viewer3D){var a=e;r={preferences:a.prefs,globalManager:a.globalManager,addEventListener:a.addEventListener.bind(a),removeEventListener:a.removeEventListener.bind(a),container:a.container,version:a.config.viewerVersion,onRestoreDefaults:a.restoreDefaultSettings.bind(a),detectIfModelsHaveEdge:function(){if(t.is2d())return!1;for(var e=!1,r=a.impl.modelQueue().getModels(),n=0;n<r.length;n++){if(r[n].hasEdges){e=!0;break}}return e},loadExtension:function(e){a.loadExtension(e)},unloadExtension:function(e){a.unloadExtension(e)},width:400,heightAdjustment:110}}this.options=r,this.preferences=r.preferences,this.is3dMode=!t.is2d(),this.visible=!1,this._externalButtonIds=[],this._externalButtonsLabel=null,n.SettingsPanel.call(this,this.options.container,"ViewerSettingsPanel"+A+++"-"+M++,"Settings",r),this.container.classList.add("viewer-settings-panel"),this.setGlobalManager(this.options.globalManager),this.addTab(S.Configuration,"Configuration",{className:"performance"}),this.addTab(S.Navigation,"Navigation",{className:"navigation"}),this.addTab(S.Appearance,"Appearance",{className:"appearance"}),this.is3dMode?this.addTab(S.Environment,"Environment",{className:"environment"}):this.container.classList.add("for-2d-model"),this.createRestoreDefaultSettingsButton(),this.modelPreferenceCount=0,this.createNavigationPanel(),this.createConfigurationPanel(),this.createAppearancePanel(),this.modelPreferenceCount&&o.logger.log("Model locked ("+this.modelPreferenceCount+") render settings in UI."),this.selectTab(S.Configuration),this.footer=this.createFooter(),this.createVersionLabel(this.footer),this.syncUI=this.syncUI.bind(this),this.options.addEventListener(i.RESTORE_DEFAULT_SETTINGS_EVENT,this.syncUI),this.options.addEventListener(i.VIEWER_STATE_RESTORED_EVENT,this.syncUI),this.updateEdgeToggle=this.updateEdgeToggle.bind(this),this.options.addEventListener(i.GEOMETRY_LOADED_EVENT,this.updateEdgeToggle),this.sendAnalyticsDebounced=v()((function(e,t){w.analytics.track("viewer.settings.changed",{setting_name:e,setting_value:t})}),500)}function C(e,t,r){e.createThumbnail(r).then((function(e){t.src=e,t.onload=function(){URL.revokeObjectURL(e)}}))}T.prototype=Object.create(n.SettingsPanel.prototype),T.prototype.constructor=T,u.ViewerPanelMixin.call(T.prototype),T.prototype.uninitialize=function(){var e,t,r,o,a,s;this._onBgEnvironmentChange&&this._onBgEnvironmentReset&&(this.preferences.removeListeners(w.Prefs3D.LIGHT_PRESET,this._onBgEnvironmentChange,this._onBgEnvironmentReset),this._onBgEnvironmentChange=null,this._onBgEnvironmentReset=null),null===(e=(t=this.options).removeEventListener)||void 0===e||e.call(t,i.RESTORE_DEFAULT_SETTINGS_EVENT,this.syncUI),null===(r=(o=this.options).removeEventListener)||void 0===r||r.call(o,i.VIEWER_STATE_RESTORED_EVENT,this.syncUI),null===(a=(s=this.options).removeEventListener)||void 0===a||a.call(s,i.GEOMETRY_LOADED_EVENT,this.updateEdgeToggle),n.SettingsPanel.prototype.uninitialize.call(this),this.envSelect=null},T.prototype.setVisible=function(e){this.visible=e,n.SettingsPanel.prototype.setVisible.call(this,e),e&&this.sizeToContent(),e&&this.createEnvironmentPanel()},T.prototype.addCheckbox=function(e,t,r,i,o,a){var s=this.preferences,l=s[a];i="boolean"==typeof l?l:i;var u=n.SettingsPanel.prototype.addCheckbox.call(this,e,t,i,(function(e){a&&(s.set(a,e),w.analytics.track("viewer.settings.changed",{setting_name:a,setting_value:e})),o&&o(e)}),r),c=this.getControl(u);return c.saveKey=a,a?s.addListeners(a,(function(e){c.setValue(e)}),(function(e){c.setValue(e),o&&o(e)})):c.sliderRow.classList.add("logical-group"),s.hasTag(a,"no-storage")&&(c.sliderRow.classList.add("no-storage"),this.modelPreferenceCount++),u},T.prototype.addDropDownMenu=function(e,t,r,i,o,a,s){var l=this.preferences;a&&(o=i.indexOf(l.get(a)));var u=n.SettingsPanel.prototype.addDropDownMenu.call(this,e,t,r,o,(function(e){a&&("displayUnits"==a?l.set(a,new b.EnumType(x.displayUnitsEnum,i[e.detail.value])):"displayUnitsPrecision"==a?l.set(a,new b.EnumType(x.displayUnitsPrecisionEnum,i[e.detail.value])):l.set(a,i[e.detail.value]),w.analytics.track("viewer.settings.changed",{setting_name:a,setting_value:i[e.detail.value]}))}),s),c=this.getControl(u);return a?l.addListeners(a,(function(e){c.setSelectedIndex(i.indexOf(e))}),(function(e){c.setSelectedIndex(i.indexOf(e))})):c.sliderRow.classList.add("logical-group"),l.hasTag(a,"no-storage")&&(c.sliderRow.classList.add("no-storage"),this.modelPreferenceCount++),u},T.prototype.addSliderV2=function(e,t,r,i,o,a,s,l){var u=this.preferences,c=u.get(l);a="number"==typeof c?c:a,l&&!Object.prototype.hasOwnProperty.call(u,l)&&u.add(l,a,["2d","3d"]);var h=n.SettingsPanel.prototype.addSliderV2.call(this,e,t,r,i,o,a,(function(e){var t="number"==typeof e?e:Number(e.detail.value);l&&u.set(l,t)}),s),d=this.getControl(h[1]);return d.saveKey=l,l?u.addListeners(l,(function(e){d.setValue(e)})):d.sliderRow.classList.add("logical-group"),u.hasTag(l,"no-storage")&&(d.sliderRow.classList.add("no-storage"),this.modelPreferenceCount++),h},T.prototype.addGrid=function(e,t,r,n){var i=this.preferences,o=e,a=this.getDocument(),l=a.createElement("div");l.classList.add("environments-container"),o.appendChild(l);var u=a.createElement("div");u.classList.add("environments-lighting-table"),l.appendChild(u);var c=new d(42,26);c.setGlobalManager(this.globalManager);for(var h=0;h<t.length;h++){var f=t[h],p=a.createElement("div");p.classList.add("settings-environment-cell"),p.index=h;var m=a.createElement("img");m.classList.add("settings-environment-image"),C(c,m,f),p.appendChild(m);var g=a.createElement("span");g.textContent=s.Z.t(f.name),g.classList.add("settings-environment-name"),g.setAttribute("data-i18n",f.name),p.appendChild(g),p.addEventListener("click",(function(){i.set(n,this.index)})),u.appendChild(p)}return this.preferences.addListeners(n,r),u},T.prototype.updateEnvironmentSelection=function(){if(this.is3dMode&&this.envTabCreated){var e=this.preferences.get("lightPreset");if("string"==typeof e)e=a.LightPresets.map((function(e){return e.name})).indexOf(e);for(var t=this.gridTable.querySelectorAll(".settings-environment-cell"),r=0;r<t.length;r++)t[r].index===e?t[r].classList.add("border-select"):t[r].classList.remove("border-select")}},T.prototype.removeCheckbox=function(e){return this.preferences.removeListeners(e.saveKey),this.removeEventListener(e,"change",e.changeListener),n.SettingsPanel.prototype.removeCheckbox.call(this,e)},T.prototype.createNavigationPanel=function(){var e=this,t=S.Navigation;function r(){return this.addSliderV2(t,"Drag Speed","Changes sensitivity of mouse movement with the zoom tool",5,300,this.options.initialZoomDragSpeed,{step:5},y.Prefs.ZOOM_DRAG_SPEED)[1]}function n(){return this.addSliderV2(t,"Scroll Speed","Changes sensitivity of the mouse scroll wheel when zooming",.1,3,this.options.initialZoomScrollScale,{step:.1},y.Prefs.ZOOM_SCROLL_SPEED)[1]}this.is3dMode&&(this.addLabel(t,"ViewCube"),this.addCheckbox(t,"Show ViewCube","Toggles availability of the ViewCube navigation control",!0,void 0,y.Prefs3D.VIEW_CUBE),(0,l.isMobileDevice)()||this.addCheckbox(t,"ViewCube acts on pivot","When enabled, the ViewCube orbits the view around the active pivot point When disabled, it orbits around the center of the view",!1,void 0,y.Prefs3D.ALWAYS_USE_PIVOT),this.addLabel(t,"Orbit"),this.addCheckbox(t,"Fusion style orbit","Enables Fusion-style orbit overlay and gives the ability to lock orbit axis",!1,(function(t){t?e.options.loadExtension("Autodesk.Viewing.FusionOrbit",null):e.options.unloadExtension("Autodesk.Viewing.FusionOrbit",null)}),y.Prefs.FUSION_ORBIT),this.addCheckbox(t,"Orbit past world poles","Allows view rotation to continue past the models North Pole",!0,void 0,y.Prefs3D.ORBIT_PAST_WORLD_POLES),this.addLabel(t,"Zoom"),(0,l.isMobileDevice)()||(this.addCheckbox(t,"Zoom towards pivot","When disabled, zooming operations are centered at the current cursor location",!1,void 0,y.Prefs3D.ZOOM_TOWARDS_PIVOT),this.addCheckbox(t,"Reverse mouse zoom direction","Toggles direction of zooming in and out",!1,void 0,y.Prefs.REVERSE_MOUSE_ZOOM_DIR),this.scrollSpeed=n.call(this)),this.dragSpeed=r.call(this),this.addLabel(t,"Mouse"),(0,l.isMobileDevice)()||(this.addCheckbox(t,"Left handed mouse setup","Swaps the buttons on the mouse",!1,void 0,y.Prefs.LEFT_HANDED_MOUSE_SETUP),this.addCheckbox(t,"Set pivot with left mouse button","Change left-click behavior to set new pivot point (overrides select object)",!1,void 0,y.Prefs3D.CLICK_TO_SET_COI)),this.addCheckbox(t,"Open properties on select","Always show properties upon selecting object",!0,void 0,y.Prefs.OPEN_PROPERTIES_ON_SELECT)),this.is3dMode||(this.addLabel(t,"Zoom"),this.addCheckbox(t,"Reverse mouse zoom direction","Toggles direction of zooming in and out",!1,void 0,y.Prefs.REVERSE_MOUSE_ZOOM_DIR),(0,l.isMobileDevice)()||(this.scrollSpeed=n.call(this)),this.dragSpeed=r.call(this),this.addLabel(t,"Mouse"),this.addCheckbox(t,"Open properties on select","Always show properties upon selecting object",!0,void 0,y.Prefs.OPEN_PROPERTIES_ON_SELECT),(0,l.isMobileDevice)()||this.addCheckbox(t,"Left handed mouse setup","Swaps the buttons on the mouse",!1,void 0,y.Prefs.LEFT_HANDED_MOUSE_SETUP))},T.prototype.addConfigButton=function(e,t){var r=this;if(!t)throw new Error("Must register a function callback.");this._externalButtonsLabel||(this._externalButtonsLabel=this.addLabel(S.Configuration,"More"));var n=this.addButton(S.Configuration,e);return this.getControl(n).setOnClick((function(){r.setVisible(!1),t()})),this._externalButtonIds.push(n),n},T.prototype.removeConfigButton=function(e){var t=this._externalButtonIds.indexOf(e);if(-1===t)return!1;var r=this.getControl(e);return!!r&&(this.removeControl(r),this._externalButtonIds.splice(t,1),0===this._externalButtonIds.length&&null!==this._externalButtonsLabel&&(this._externalButtonsLabel.removeFromParent(),this._externalButtonsLabel=null),!0)},T.prototype.updateEdgeToggle=function(){var e=document.getElementById(this.edgeCheckboxName+"_check");e&&(this.is3dMode&&(this.options.detectIfModelsHaveEdge()?e.disabled=!1:(e.disabled=!0,e.checked=!1)))},T.prototype.createConfigurationPanel=function(){var e=this,t=S.Configuration;this.is3dMode?(this.addLabel(t,"Performance Optimization"),this.optimizeNavigationhkBoxId=this.addCheckbox(t,"Smooth navigation","Provides faster response(but degrades quality) while navigating",(0,l.isMobileDevice)(),void 0,y.Prefs3D.OPTIMIZE_NAVIGATION),this.progressiveRenderChkBoxId=this.addCheckbox(t,"Progressive display","Shows incremental updates of the view and allows for more responsive interaction with the model (some elements may flicker) This improves perceived waiting time",!0,void 0,y.Prefs.PROGRESSIVE_RENDERING),this.addLabel(t,"Display"),this.ghosthiddenChkBoxId=this.addCheckbox(t,"Ghost hidden objects","Leave hidden objects slightly visible",!0,void 0,y.Prefs3D.GHOSTING),this.displayLinesId=this.addCheckbox(t,"Display Lines","Toggles display of line objects",!0,void 0,y.Prefs3D.LINE_RENDERING),this.displayPointsId=this.addCheckbox(t,"Display Points","Toggles display of point objects",!0,void 0,y.Prefs.POINT_RENDERING),this.edgeCheckboxName="Display edges",this.displayEdgesId=this.addCheckbox(t,this.edgeCheckboxName,"Shows outline of model surfaces",!1,(function(t){e.getControl(e.displayEdgesId).setValue(t),e.updateEdgeToggle()}),y.Prefs3D.EDGE_RENDERING),this.updateEdgeToggle(),this.displaySectionHatchesId=this.addCheckbox(t,"Display Section Hatches","Shows hatch pattern for section planes this does not apply to section boxes",!0,null,w.Prefs3D.DISPLAY_SECTION_HATCHES)):(this.addLabel(t,"Performance Optimization"),this.progressiveRenderChkBoxId=this.addCheckbox(t,"Progressive display","Shows incremental updates of the view and allows for more responsive interaction with the model (some elements may flicker) This improves perceived waiting time",!0,void 0,y.Prefs.PROGRESSIVE_RENDERING),this.addLabel(t,"Display")),this.displayUnitsId=this.addDropDownMenu(t,"Display Units",w.displayUnits,w.displayUnitsEnum,null,w.Prefs.DISPLAY_UNITS),this.displayUnitsPrecisionId=this.addDropDownMenu(t,"Precision",w.displayUnitsPrecision,w.displayUnitsPrecisionEnum,null,w.Prefs.DISPLAY_UNITS_PRECISION),this.is3dMode&&this._addSelectionModeOption()},T.prototype._addSelectionModeOption=function(){var e=S.Configuration;this.addLabel(e,"Selection");var t=[],r=[],n=0;for(var i in Autodesk.Viewing.SelectionMode)t[n]=i,r[n]=Autodesk.Viewing.SelectionMode[i],n++;var o=t.map((function(e){return e.split("_").map((function(e){return e.charAt(0)+e.slice(1).toLowerCase()})).join(" ")}));this.selectionModeId=this.addDropDownMenu(e,"Selection Mode",o,r,null,w.Prefs3D.SELECTION_MODE)},T.prototype.createAppearancePanel=function(){var e=S.Appearance;this.is3dMode?(this.addLabel(e,"Visual Quality Optimization"),this.antialiasingChkBoxId=this.addCheckbox(e,"Anti-aliasing","Remove jagged edges from lines",!0,void 0,y.Prefs3D.ANTIALIASING),this.ambientshadowsChkBoxId=this.addCheckbox(e,"Ambient shadows","Improve shading of occluded surfaces",!0,void 0,y.Prefs3D.AMBIENT_SHADOWS),this.groundShadowChkBoxId=this.addCheckbox(e,"Ground shadow","Add simulated ground surface shadows",!0,void 0,y.Prefs3D.GROUND_SHADOW),this.groundReflectionChkBoxId=this.addCheckbox(e,"Ground reflection","Add simulated ground surface reflections",!1,void 0,y.Prefs3D.GROUND_REFLECTION)):(this.addLabel(e,"Existing behavior"),this.swapBlackAndWhiteChkBoxId=this.addCheckbox(e,"2D Sheet Color","Switch sheet color white to black",!0,void 0,y.Prefs2D.SWAP_BLACK_AND_WHITE),this.loadingAnimationChkBoxId=this.addCheckbox(e,"Loading Animation","Animate lines during loading",!0,void 0,y.Prefs2D.LOADING_ANIMATION))},T.prototype.createEnvironmentPanel=function(){if(this.is3dMode&&!this.envTabCreated){this.envTabCreated=!0;var e=S.Environment,t=this.tablesContainer.childNodes[3];this.gridTable=t,this.addLabel(e,"Environment"),this.envMapBackgroundChkBoxId=this.addCheckbox(e,"Environment Image Visible","Shows lighting environment as background",!0,void 0,y.Prefs3D.ENV_MAP_BACKGROUND);var r=t.tBodies[0].insertRow(-1).insertCell(0),n=this.getDocument();this.caption=n.createElement("div"),this.caption.setAttribute("data-i18n","Environments and Lighting Selection"),this.caption.textContent=s.Z.t("Environments and Lighting Selection"),this.caption.classList.add("settings-row-title"),r.appendChild(this.caption),r.colSpan="3",this.envSelect=this.addGrid(t,a.LightPresets,this.updateEnvironmentSelection.bind(this),w.Prefs3D.LIGHT_PRESET),this.updateEnvironmentSelection(),this.envSelect.classList.add("with-environment")}},T.prototype.createVersionLabel=function(e){var t=this;if(e){var r=this.getDocument();this.versionDiv=r.createElement("div"),this.versionDiv.textContent=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:LMV_VIEWER_VERSION;"@"===e.charAt(0)&&(e="0.0.0");return"v"+e}(this.options.version),this.versionDiv.className="docking-panel-version-label",this.addEventListener(this.versionDiv,"click",(function(e){e.shiftKey&&navigator.clipboard.writeText(t.versionDiv.textContent)})),e.appendChild(this.versionDiv)}},T.prototype.createRestoreDefaultSettingsButton=function(){var e=this,t=this.getDocument();this.restoreDiv=t.createElement("div"),this.restoreDiv.classList.add("docking-panel-container-solid-color-b"),this.restoreDiv.classList.add("restore-defaults-container"),this.restoreButton=t.createElement("div"),this.restoreButton.className="docking-panel-tertiary-button",this.restoreButton.setAttribute("data-i18n","Restore all default settings"),this.restoreButton.textContent=s.Z.t("Restore all default settings"),this.restoreDiv.appendChild(this.restoreButton),this.addEventListener(this.restoreDiv,"touchstart",l.touchStartToClick),this.addEventListener(this.restoreDiv,"click",(function(){var t,r;null===(t=(r=e.options).onRestoreDefaults)||void 0===t||t.call(r),w.analytics.track("viewer.settings.default")}),!1),this.scrollContainer.appendChild(this.restoreDiv)},T.prototype.selectTab=function(e){n.SettingsPanel.prototype.selectTab.call(this,e),this.sizeToContent()},T.prototype.sizeToContent=function(){n.SettingsPanel.prototype.sizeToContent.call(this,this.options.container)},T.prototype.onViewerResize=function(e,t,r,n,i,o){this.sizeToContent()},T.prototype.syncUI=function(){var e=this.preferences;this.setControlValue(this.antialiasingChkBoxId,e.get("antialiasing")),this.setControlValue(this.ambientshadowsChkBoxId,e.get("ambientShadows")),this.setControlValue(this.groundShadowChkBoxId,e.get("groundShadow")),this.setControlValue(this.groundReflectionChkBoxId,e.get("groundReflection")),this.setControlValue(this.envMapBackgroundChkBoxId,e.get("envMapBackground")),this.setControlValue(this.progressiveRenderChkBoxId,e.get("progressiveRendering")),this.setControlValue(this.swapBlackAndWhiteChkBoxId,e.get("swapBlackAndWhite")),this.setControlValue(this.loadingAnimationChkBoxId,e.get("loadingAnimation")),this.setControlValue(this.ghosthiddenChkBoxId,e.get("ghosting")),this.setControlValue(this.displayLinesId,e.get("lineRendering")),this.setControlValue(this.displayPointsId,e.get("pointRendering")),this.setControlValue(this.displayEdgesId,e.get("edgeRendering")),this.setControlValue(this.displaySectionHatchesId,e.get("displaySectionHatches")),this.setControlValue(this.scrollSpeed,e.get("zoomScrollSpeed")),this.setControlValue(this.dragSpeed,e.get("zoomDragSpeed")),this.updateEnvironmentSelection()},T.prototype.setControlValue=function(e,t){var r=this.getControl(e);r&&r.setValue(t)}},15024:(e,t,r)=>{"use strict";r.r(t),r.d(t,{BrowserDelegate:()=>l,Browser:()=>u});var n=r(38202),i=r(79659),o=r(98926),a=(0,r(84998).getGlobal)(),s=a.document;function l(){}function u(e,t,r){this.myDelegate=e,this.mySelectedIds=[];var n="browserview";this.myRootContainerId=r+"-"+n,this.idToElement={},this.myRootContainer=s.createElement("div"),this.myRootContainer.id=this.myRootContainerId,this.myRootContainer.classList.add(n),s.getElementById(r).appendChild(this.myRootContainer),this.createElements(t,this.myRootContainer)}l.prototype.constructor=l,l.prototype.getNodeId=function(e){throw"getId is not implemented."},l.prototype.getNodeLabel=function(e){return e.name},l.prototype.getNodeClass=function(e){return""},l.prototype.hasThumbnail=function(e){return!1},l.prototype.getThumbnailOptions=function(e){return null},l.prototype.getThumbnail=function(e){return null},l.prototype.onNodeClick=function(e,t,r){},l.prototype.onNodeHover=function(e,t,r){},l.prototype.selectItem=function(e){},l.prototype.deselectItem=function(e){},l.prototype.hasContent=function(e){return!1},l.prototype.addContent=function(e,t){},u.prototype.constructor=u,u.prototype.show=function(e){e?(this.myRootContainer.classList.remove("browserHidden"),this.myRootContainer.classList.add("browserVisible"),this.myRootContainer.style.display="block"):(this.myRootContainer.classList.remove("browserVisible"),this.myRootContainer.classList.add("browserHidden"),this.myRootContainer.style.display="none")},u.prototype.getRootContainer=function(){return this.myRootContainer},u.prototype.delegate=function(){return this.myDelegate},u.prototype.addToSelection=function(e){var t=this;function r(e){return-1==t.mySelectedIds.indexOf(e)&&(t.mySelectedIds.push(e),!0)}for(var n=0,i=e.length;n<i;++n){var o=e[n];if(r(o)){var a=t.idToElement[o];void 0===a?t.myDelegate.selectItem(o):a.classList.add("selected")}}},u.prototype.removeFromSelection=function(e){var t=this;function r(e){var r=t.mySelectedIds.indexOf(e);return-1!=r&&(t.mySelectedIds.splice(r,1),!0)}for(var n=e.length-1;n>=0;--n){var i=e[n];if(r(i)){var o=this.idToElement[i];void 0===o?t.myDelegate.deselectItem(i):o.classList.remove("selected")}}},u.prototype.setSelection=function(e){return this.removeFromSelection(this.mySelectedIds),this.addToSelection(e),this.mySelectedIds},u.prototype.clearSelection=function(){this.removeFromSelection(this.mySelectedIds)},u.prototype.createElements=function(e,t){if(e)for(var r=0;r<e.length;r++){var n=e[r];this.createElement(n,t)}},u.prototype.createElement=function(e,t){var r=this,l=r.myDelegate.getNodeId(e),u=s.createElement("item");t.appendChild(u),this.idToElement[l]=u,u.onmouseover=function(){r.myDelegate.onNodeHover(r,e)},u.onclick=function(t){r.myRootContainer.querySelector(".flipped").removeClass("flipped"),r.myDelegate.onNodeClick(r,e,t)};var c=s.createElement("div");c.classList.add("card"),u.appendChild(c);var h=s.createElement("div");h.classList.add("browserElement"),c.appendChild(h);var d=r.myDelegate.getNodeLabel(e),f=s.createElement("label");f.innerHTML=d,h.appendChild(f),f.onclick=function(t){r.myDelegate.onNodeClick(r,e,t)};var p=r.myDelegate.getThumbnail(e);if(p){var m=s.createElement("img");m.classList.add("thumb");var g=r.myDelegate.getThumbnailOptions(e);n.Document.requestThumbnailWithSecurity(g,(function(e,t){e?o.logger.error("Failed to load thumbnail: "+p,(0,i.errorCodeString)(i.ErrorCodes.NETWORK_FAILURE)):(m.src=a.URL.createObjectURL(t),m.onload=function(){a.URL.revokeObjectURL(m.src)})})),h.appendChild(m),m.onclick=function(t){r.myDelegate.onNodeClick(r,e,t)}}r.myDelegate.hasContent(e)&&r.myDelegate.addContent(e,c),u.classList.add(r.myDelegate.getNodeClass(e))}},42106:(e,t,r)=>{"use strict";r.r(t),r.d(t,{Button:()=>s});var n,i,o=r(37522),a=r(84998);function s(e,t){o.Control.call(this,e,t);var r=this;this._state=s.State.INACTIVE;var n=this.getDocument();this.icon=n.createElement("div"),this.icon.classList.add("adsk-button-icon"),this.container.appendChild(this.icon),this.container.addEventListener("click",(function(e){r.getState()!==s.State.DISABLED&&(r.dispatchEvent(s.Event.CLICK),r.onClick&&r.onClick(e)),e.stopPropagation()})),(0,a.isTouchDevice)()?this.container.addEventListener("touchstart",a.touchStartToClick):(this.container.addEventListener("mouseover",(function(e){r.onMouseOver(e)})),this.container.addEventListener("mouseout",(function(e){r.onMouseOut(e)}))),this.addClass("adsk-button"),this.addClass(s.StateToClassMap[this._state])}s.Event={VISIBILITY_CHANGED:o.Control.Event.VISIBILITY_CHANGED,COLLAPSED_CHANGED:o.Control.Event.COLLAPSED_CHANGED,STATE_CHANGED:"Button.StateChanged",CLICK:"click"},s.State={ACTIVE:0,INACTIVE:1,DISABLED:2},s.StateToClassMap=(n=s.State,(i={})[n.ACTIVE]="active",i[n.INACTIVE]="inactive",i[n.DISABLED]="disabled",i),s.prototype=Object.create(o.Control.prototype),s.prototype.constructor=s,s.prototype.setState=function(e){if(e===this._state)return!1;this.removeClass(s.StateToClassMap[this._state]),this.addClass(s.StateToClassMap[e]),this._state=e;var t={type:s.Event.STATE_CHANGED,state:e};return this.dispatchEvent(t),!0},s.prototype.setIcon=function(e){this.iconClass&&this.icon.classList.remove(this.iconClass),this.iconClass=e,this.icon.classList.add(e)},s.prototype.getState=function(){return this._state},s.prototype.onClick=function(e){},s.prototype.onMouseOver=function(e){},s.prototype.onMouseOut=function(e){}},35010:(e,t,r)=>{"use strict";r.r(t),r.d(t,{ComboButton:()=>a});var n=r(42106),i=r(51676),o=r(17167);function a(e,t){n.Button.call(this,e,t),this.arrowButton=new n.Button(e+"arrow"),this.arrowButton.addClass("adsk-button-arrow"),this.arrowButton.removeClass("adsk-button"),this.subMenu=new i.RadioButtonGroup(e+"SubMenu"),this.subMenu.addClass("toolbar-vertical-group"),this.subMenu.setVisible(!1),this.container.insertBefore(this.subMenu.container,this.container.firstChild),this.container.insertBefore(this.arrowButton.container,this.container.firstChild);var r=this;this.arrowButton.onClick=function(){r.subMenu.setVisible(!r.subMenu.isVisible())},this.toggleFlyoutVisible=function(){r.subMenu.setVisible(!r.subMenu.isVisible())},this.onClick=function(){r.subMenu.setVisible(!r.subMenu.isVisible())},this.subMenuActiveButtonChangedHandler=function(e){e.isActiveButton?(r.setIcon(e.target.getActiveButton().iconClass),r.setToolTip(e.target.getActiveButton().getToolTip()),r.setState(n.Button.State.ACTIVE),r.onClick=e.button.onClick):r.setState(n.Button.State.INACTIVE)},this.subMenu.addEventListener(i.RadioButtonGroup.Event.ACTIVE_BUTTON_CHANGED,this.subMenuActiveButtonChangedHandler);var a=(0,o.stringToDOM)('<div class="clickoff" style="position:fixed; top:0; left:0; width:100vw; height:100vh;"></div>');this.subMenu.container.insertBefore(a,this.subMenu.container.firstChild),a.addEventListener("click",(function(e){r.subMenu.setVisible(!1),e.stopPropagation()}))}a.prototype=Object.create(n.Button.prototype),a.prototype.constructor=a,a.prototype.addControl=function(e){this.subMenu.addControl(e),e.addEventListener(n.Button.Event.CLICK,this.toggleFlyoutVisible)},a.prototype.removeControl=function(e){e.removeEventListener(n.Button.Event.CLICK,this.toggleFlyoutVisible)},a.prototype.setState=function(e){if(e===n.Button.State.INACTIVE){var t=this.subMenu.getActiveButton();t&&t.setState(n.Button.State.INACTIVE)}n.Button.prototype.setState.call(this,e)},a.prototype.saveAsDefault=function(){this.defaultState={},this._toolTipElement&&this._toolTipElement.getAttribute("tooltipText")&&(this.defaultState.tooltip=this._toolTipElement.getAttribute("tooltipText")),this.defaultState.icon=this.iconClass,this.defaultState.onClick=this.onClick},a.prototype.restoreDefault=function(){this.defaultState&&(this.defaultState.tooltip&&this.setToolTip(this.defaultState.tooltip),this.defaultState.icon&&this.setIcon(this.defaultState.icon),this.onClick=this.defaultState.onClick,this.setState(n.Button.State.INACTIVE))}},37522:(e,t,r)=>{"use strict";r.r(t),r.d(t,{Control:()=>i});var n=r(62546);function i(e,t){this._id=e,this._isCollapsible=!t||t.collapsible,this._toolTipElement=null,this._listeners={},this.container=this.getDocument().createElement("div"),this.container.id=e,this.addClass("adsk-control")}r(35449).GlobalManagerMixin.call(i.prototype),i.Event={VISIBILITY_CHANGED:"Control.VisibilityChanged",COLLAPSED_CHANGED:"Control.CollapsedChanged"},n.EventDispatcher.prototype.apply(i.prototype),i.prototype.constructor=i,i.prototype.container=null,i.prototype.getId=function(){return this._id},i.prototype.setVisible=function(e){if(!this.container.classList.contains("adsk-hidden")===e)return!1;e?this.container.classList.remove("adsk-hidden"):this.container.classList.add("adsk-hidden");var t={type:i.Event.VISIBILITY_CHANGED,target:this,controlId:this._id,isVisible:e};return this.dispatchEvent(t),!0},i.prototype.isVisible=function(){return!this.container.classList.contains("adsk-hidden")},i.prototype.setToolTip=function(e){return(!this._toolTipElement||this._toolTipElement.getAttribute("tooltipText")!==e)&&(this._toolTipElement||(this._toolTipElement=this.getDocument().createElement("div"),this._toolTipElement.id=this._id+"-tooltip",this._toolTipElement.classList.add("adsk-control-tooltip"),this.container.appendChild(this._toolTipElement)),this._toolTipElement.setAttribute("data-i18n",e),this._toolTipElement.setAttribute("tooltipText",e),this._toolTipElement.textContent=Autodesk.Viewing.i18n.translate(e,{defaultValue:e}),!0)},i.prototype.getToolTip=function(){return this._toolTipElement&&this._toolTipElement.getAttribute("tooltipText")},i.prototype.setCollapsed=function(e){if(!this._isCollapsible||this.isCollapsed()===e)return!1;e?this.container.classList.add("collapsed"):this.container.classList.remove("collapsed");var t={type:i.Event.COLLAPSED_CHANGED,isCollapsed:e};return this.dispatchEvent(t),!0},i.prototype.isCollapsed=function(){return!!this.container.classList.contains("collapsed")},i.prototype.isCollapsible=function(){return this._isCollapsible},i.prototype.addClass=function(e){this.container.classList.add(e)},i.prototype.removeClass=function(e){this.container.classList.remove(e)},i.prototype.getPosition=function(){var e=this.container.getBoundingClientRect();return{top:e.top,left:e.left}},i.prototype.getDimensions=function(){var e=this.container.getBoundingClientRect();return{width:e.width,height:e.height}},i.prototype.setDisplay=function(e){this.container.style.display=e},i.prototype.removeFromParent=function(){return!!this.parent&&this.parent.removeControl(this)}},66704:(e,t,r)=>{"use strict";r.r(t),r.d(t,{ControlGroup:()=>i});var n=r(37522);function i(e,t){n.Control.call(this,e,t);var r=this;this._controls=[],this.addClass("adsk-control-group"),this.handleChildSizeChanged=function(e){var t={type:i.Event.SIZE_CHANGED,childEvent:e};r.dispatchEvent(t)}}i.Event={VISIBILITY_CHANGED:n.Control.Event.VISIBILITY_CHANGED,COLLAPSED_CHANGED:n.Control.Event.COLLAPSED_CHANGED,SIZE_CHANGED:"ControlGroup.SizeChanged",CONTROL_ADDED:"ControlGroup.ControlAdded",CONTROL_REMOVED:"ControlGroup.ControlRemoved"},i.prototype=Object.create(n.Control.prototype),i.prototype.constructor=i,i.prototype.addControl=function(e,t){e.setGlobalManager(this.globalManager);var r=t&&void 0!==t.index?t.index:this._controls.length;if(null!==this.getControl(e.getId()))return!1;var o={type:i.Event.CONTROL_ADDED,control:e,index:r};return r<this._controls.length?(this.container.insertBefore(e.container,this._controls[r].container),this._controls.splice(r,0,e)):(this.container.appendChild(e.container),this._controls.push(e)),e.addEventListener(n.Control.Event.VISIBILITY_CHANGED,this.handleChildSizeChanged),e.addEventListener(n.Control.Event.COLLAPSED_CHANGED,this.handleChildSizeChanged),e instanceof i&&e.addEventListener(i.Event.SIZE_CHANGED,this.handleChildSizeChanged),e.parent=this,this.dispatchEvent(o),this.dispatchEvent(i.Event.SIZE_CHANGED),!0},i.prototype.indexOf=function(e){for(var t=0;t<this._controls.length;t++){var r=this._controls[t];if(r===e||"string"==typeof e&&e===r.getId())return t}return-1},i.prototype.removeControl=function(e){var t="string"==typeof e?this.getControl(e):e;if(!t)return!1;var r=this._controls.indexOf(t);if(-1===r)return!1;this._controls.splice(r,1),this.container.removeChild(t.container);var o={type:i.Event.CONTROL_REMOVED,control:t,index:r};return t.removeEventListener(n.Control.Event.VISIBILITY_CHANGED,this.handleChildSizeChanged),t.removeEventListener(n.Control.Event.COLLAPSED_CHANGED,this.handleChildSizeChanged),t instanceof i&&t.removeEventListener(i.Event.SIZE_CHANGED,this.handleChildSizeChanged),t.parent=void 0,this.dispatchEvent(o),this.dispatchEvent(i.Event.SIZE_CHANGED),!0},i.prototype.getControl=function(e){for(var t=0;t<this._controls.length;t++)if(e===this._controls[t].getId())return this._controls[t];return null},i.prototype.getControlId=function(e){return e<0||e>=this._controls.length?null:this._controls[e].getId()},i.prototype.getNumberOfControls=function(){return this._controls.length},i.prototype.setCollapsed=function(e){if(!this._isCollapsible)return!1;var t=!1;return this._controls.forEach((function(r){r.isCollapsible()&&r.setCollapsed(e)&&(t=!0)})),t&&(e?this.container.classList.add("collapsed"):this.container.classList.remove("collapsed"),this.dispatchEvent({type:i.Event.COLLAPSED_CHANGED,isCollapsed:e})),t}},55848:(e,t,r)=>{"use strict";r.r(t),r.d(t,{Filterbox:()=>o});var n=r(37522),i=r(71224);function o(e,t){this._id=e,this._listeners={},this._options=t||{},this._filterFunction=this._options.filterFunction||function(){};var r=this.getDocument();this.container=r.createElement("div"),this.container.id=e,this.addClass("adsk-control"),this.addClass("adsk-filterbox"),this.addClass("empty");var n=r.createElement("input");n.classList.add("filter-box"),n.classList.add("docking-panel-delimiter-shadow"),n.type="search",n.placeholder=i.Z.t("Enter filter term"),n.setAttribute("data-i18n","Enter filter term"),n.incremental="incremental",n.autosave=this.container.id+"filter",this.container.appendChild(n),this.filterbox=n;var o=this,a=function(e){0===(e=e.trim()).length?o.container.classList.add("empty"):o.container.classList.remove("empty"),o._filterFunction&&o._filterFunction(e)},s=r.createElement("div");s.className="filter-box-icon",this.container.insertBefore(s,n.nextSibling);var l=r.createElement("div");l.className="filter-box-close",l.addEventListener("click",(function(){o.filterbox.value="",o.addClass("empty")})),this.container.appendChild(l),n.addEventListener("keydown",(function(e){var t=o.getWindow();13===(e=e||t.event).keyCode&&o.filterbox.blur()})),n.addEventListener("input",(function(){a(this.value)})),n.addEventListener("change",(function(){a(this.value)})),n.addEventListener("focus",(function(){s.classList.add("focused")})),n.addEventListener("blur",(function(){s.classList.remove("focused")}))}o.prototype=Object.create(n.Control.prototype),o.prototype.constructor=o},51676:(e,t,r)=>{"use strict";r.r(t),r.d(t,{RadioButtonGroup:()=>a});var n=r(66704),i=r(42106),o=r(37522);function a(e,t){n.ControlGroup.call(this,e,t);var r=this;this._activeButton=null,this._handleButtonStateChange=function(e){var t=i.Button.State;e.state===t.ACTIVE?(r._activeButton=e.target,r.dispatchEvent({type:a.Event.ACTIVE_BUTTON_CHANGED,button:e.target,isActiveButton:!0}),r._controls.forEach((function(r){r!==e.target&&r.getState()!==t.DISABLED&&r.setState(t.INACTIVE)}))):e.target===r._activeButton&&(r._activeButton=null,r.dispatchEvent({type:a.Event.ACTIVE_BUTTON_CHANGED,button:e.target,isActiveButton:!1}))}}a.Event={ACTIVE_BUTTON_CHANGED:"RadioButtonGroup.ActiveButtonChanged",VISIBILITY_CHANGED:o.Control.Event.VISIBILITY_CHANGED,COLLAPSED_CHANGED:o.Control.Event.COLLAPSED_CHANGED,CONTROL_ADDED:n.ControlGroup.Event.CONTROL_ADDED,CONTROL_REMOVED:n.ControlGroup.Event.CONTROL_REMOVED,SIZE_CHANGED:n.ControlGroup.Event.SIZE_CHANGED},a.prototype=Object.create(n.ControlGroup.prototype),a.prototype.constructor=a,a.prototype.addControl=function(e,t){return e instanceof i.Button&&(!!n.ControlGroup.prototype.addControl.call(this,e,t)&&(e.addEventListener(i.Button.Event.STATE_CHANGED,this._handleButtonStateChange),!0))},a.prototype.removeControl=function(e){var t="string"==typeof e?this.getControl(e):e;return!(null===t||!n.ControlGroup.prototype.removeControl.call(this,t))&&(t.removeEventListener(i.Button.Event.STATE_CHANGED,this._handleButtonStateChange),!0)},a.prototype.getActiveButton=function(){return this._activeButton}},20361:(e,t,r)=>{"use strict";r.d(t,{J:()=>n});var n="search-selected"},68005:(e,t,r)=>{"use strict";r.r(t),r.d(t,{Searchbox:()=>E});var n=r(37522),i=r(20361),o=r(98926),a=r(62546),s=r(74593),l=r(35449),u=50,c=100;function h(e,t,r){var n=r;this.excludeRoot=t,(n instanceof Autodesk.Viewing.GuiViewer3D||n instanceof Autodesk.Viewing.Viewer3D)&&(o.logger.warn("Deprecated use of Viewer as parameter. Provide container instead"),n=r.container),this.results=[],this.resultCount=0,this.selectedIndex=-1;var i=this.getDocument();this.container=i.createElement("div"),this.container.classList.add("docking-panel"),this.container.classList.add("adsk-search-results"),this.container.results=i.createElement("div"),this.container.results.classList.add("docking-panel-scroll"),this.container.results.classList.add("docking-panel-container-solid-color-b"),this.container.results.addEventListener("scroll",f.bind(this)),this.container.appendChild(this.container.results),e.insertBefore(this.container,e.firstChild),this.scrollingContainer=i.createElement("div"),this.scrollingContainer.classList.add("adsk-search-results-scrolling-panel"),this.scrollingContainer.addEventListener("click",d.bind(this)),this.container.results.appendChild(this.scrollingContainer),this.footer=new s.ResizeFooter(this.container,function(){var e=this.container.getBoundingClientRect(),t=n.getBoundingClientRect();t.right<e.right&&(this.container.style.width=t.right-e.left+"px"),t.bottom<e.bottom&&(this.container.style.height=t.bottom-e.top+"px")}.bind(this)),this.footer.setGlobalManager(this.globalManager),this.divNoResults=function(e){var t=e.createElement("div"),r=e.createElement("div"),n=e.createElement("div");t.classList.add("no-results-container"),t.style.display="none";var i="No Results";r.setAttribute("data-i18n",i),r.textContent=Autodesk.Viewing.i18n.translate(i),r.classList.add("no-results-title");var o="Try another term";return n.setAttribute("data-i18n",o),n.textContent=Autodesk.Viewing.i18n.translate(o),n.classList.add("no-results-description"),t.appendChild(r),t.appendChild(n),t.domTitle=r,t.domMessage=n,t}(i),this.scrollingContainer.appendChild(this.divNoResults),this.scrollY=0,this.dirty=!1,this.nextFrameId=0,this.it={init:function(e){return this.isDone=!1,this.results=e,this.indexRs=0,this.indexId=-1,this},done:function(){return this.isDone},next:function(){if(this.isDone)return this;for(this.indexId++;this.results.length!==this.indexRs&&this.indexId===this.results[this.indexRs].ids.length;)this.indexId=0,this.indexRs++;return this.isDone=this.indexRs===this.results.length,this},id:function(){return this.results[this.indexRs].ids[this.indexId]},delegate:function(){return this.results[this.indexRs].delegate}},this.elementsPool=[],this.elementsUsed=0;for(var a=0;a<150;++a)this.elementsPool[a]=v(i);this.setVisible(!1)}function d(e){var t=e.target,r=this._getNodeAndModelIds(t);r&&(this.fireEvent({type:i.J,id:r.nodeId,modelId:r.modelId}),e.preventDefault())}function f(){var e=this.container.results.scrollTop;Math.abs(this.scrollY-e)>=100&&(this.scrollY=e,p(this))}function p(e,t){e.dirty&&!t||(t?m(e):(e.dirty=!0,e.nextFrameId=requestAnimationFrame((function(){m(e)}))))}function m(e){e.dirty=!1,function(e){for(var t=e.elementsUsed,r=e.elementsPool,n=0;n<t;++n){y(r[n])}e.elementsUsed=0}(e),0!==e.resultCount?(e.setDisplayNoResults(!1),function(e){var t=e.container.results,r=0,n=t.clientHeight,i=e.scrollY,o=e.it.init(e.results),a=Math.max(0,e.scrollY-c),s=0|Math.floor(a/u),l=0;r=s*u;for(;s;)s--,l++,o.next();var h=e.elementsPool[e.elementsUsed++];h.style.height=r+"px",e.scrollingContainer.appendChild(h);var d=!0;for(;d;){if(o.next(),o.done()){d=!1;break}if(r>i+n+c){d=!1;break}if(e.elementsUsed===e.elementsPool.length){d=!1;break}var f=o.id(),p=o.delegate(),m=r+u,v=e.elementsPool[e.elementsUsed++];g(f,p,v,e,l===e.selectedIndex),e.scrollingContainer.appendChild(v),r=m,l++}var y=e.resultCount*u;e.scrollingContainer.style.height=y+"px"}(e)):e.setDisplayNoResults(!0)}function g(e,t,r,n,i){r.classList.add("search-result"),i?r.classList.add("selected"):r.classList.remove("selected"),r.setAttribute("lmv-nodeId",e),r.setAttribute("lmv-modelId",t.model.id),r.style.height="50px";var o=t.instanceTree.getNodeName(e),a=n.searchString,s=o.toLowerCase().indexOf(a.toLowerCase()),l=o.substr(0,s),u=o.substr(s,a.length),c=o.substr(s+a.length);r.domPrefix.innerText=l,r.domMatch.innerText=u,r.domSufix.innerText=c;var h=function(e,t,r){var n=[],i=t.getRootId(),o=r.isRootExcluded(),a=t.instanceTree,s=e,l=!1;for(;s&&!l&&(s!==i||(l=!0,!o));){var u=a.getNodeName(s);n.unshift(u),s=a.getNodeParentId(s)}return n}(e,t,n);r.domPath.innerText=h.join(" > ")}function v(e){var t=e.createElement("div"),r=e.createElement("div"),n=e.createElement("span"),i=e.createElement("span"),o=e.createElement("span"),a=e.createElement("span");return r.classList.add("search-result-container"),i.classList.add("search-match"),a.classList.add("search-path"),r.appendChild(n),r.appendChild(i),r.appendChild(o),r.appendChild(a),t.appendChild(r),t.domPrefix=n,t.domMatch=i,t.domSufix=o,t.domPath=a,t.domContainer=r,t}function y(e){e.setAttribute("lmv-nodeId",""),e.setAttribute("lmv-modelId",""),e.domPrefix.innerText="",e.domMatch.innerText="",e.domSufix.innerText="",e.domPath.innerText="",e.style.height="0"}function b(e,t){e.scrollTop+e.clientHeight<(t+1)*u&&(e.scrollTop+=(t+1)*u-(e.scrollTop+e.clientHeight)),e.scrollTop/u>t&&(e.scrollTop=t*u)}h.prototype.constructor=h,a.EventDispatcher.prototype.apply(h.prototype),l.GlobalManagerMixin.call(h.prototype),h.prototype.setPosition=function(e,t){this.container.style.left=e+"px",this.container.style.top=t+"px"},h.prototype.setMinWidth=function(e){this.container.style.width=e+"px"},h.prototype.setMaxWidth=function(e){this.container.style.maxHeight=e+"px"},h.prototype.setVisible=function(e){this.container.style.display=e?"":"none"},h.prototype.setResults=function(e,t){this.searchString=e,this.results=t,this.resultCount=function(e){for(var t=0,r=0;r<e.length;++r){t+=e[r].ids.length}return t}(t),this.selectedIndex=0==this.resultCount?-1:0,this.container.style.height=this.resultCount*u+20+"px",this.container.results.scrollTop=0,this.scrollY=0,0===this.resultCount?this.container.classList.add("no-content"):this.container.classList.remove("no-content"),p(this)},h.prototype.getSelection=function(){var e=this.scrollingContainer.querySelector(".selected");if(!e)return null;var t=this._getNodeAndModelIds(e);return t||null},h.prototype.isRootExcluded=function(){return!(this.results&&this.results.length>1)&&(!(this.modelCount>1)&&this.excludeRoot)},h.prototype.uninitialize=function(){this.setVisible(!1),this.container=null,this.container.parentNode&&this.container.parentNode.removeChild(this.container),cancelAnimationFrame(this.nextFrameId),this.clearListeners()},h.prototype.setDisplayNoResults=function(e){this.divNoResults.style.display=e?"":"none"},h.prototype.selectNext=function(){0!==this.resultCount&&(this.selectedIndex=Math.min(this.resultCount-1,this.selectedIndex+1),b(this.container.results,this.selectedIndex),p(this))},h.prototype.selectPrevious=function(){0!==this.resultCount&&(this.selectedIndex=Math.max(0,this.selectedIndex-1),b(this.container.results,this.selectedIndex),p(this))},h.prototype._getNodeAndModelIds=function(e){for(;!e.hasAttribute("lmv-nodeId");)if(!(e=e.parentNode)||e===this.scrollingContainer)return;return{nodeId:parseInt(e.getAttribute("lmv-nodeId")),modelId:parseInt(e.getAttribute("lmv-modelId"))}};var x=r(71224),_=r(23279);function E(e,t,r){this._id=e,this._listeners={},this._options=r||{},this._searchFunction=this._options.searchFunction||function(){};var n=this.getDocument();this.container=n.createElement("div"),this.container.id=e,this.addClass("adsk-control"),this.addClass("adsk-searchbox"),this.addClass("empty");var a=n.createElement("input");a.classList.add("search-box"),a.classList.add("docking-panel-delimiter-shadow"),a.type="search",a.results=[],a.placeholder=x.Z.t("Search"),a.setAttribute("data-i18n","Search"),a.incremental="incremental",a.autosave=this.container.id+"search_autosave",this.container.insertBefore(a,this.scrollContainer),this.searchbox=a;var s=function(){d.searchbox.value="",d.addClass("empty")},l=function(){d.searchbox.classList.remove("searching"),d.searchResults.setVisible(!1)},u=n.createElement("div");u.className="search-box-icon",this.container.insertBefore(u,a.nextSibling);var c=n.createElement("div");c.className="search-box-close",c.addEventListener("click",(function(){s(),l()})),this.container.appendChild(c),this.searchResults=new h(this.container,r.excludeRoot,t),this.searchResults.addEventListener(i.J,(function(e){s(),l(),d.fireEvent(e)}));var d=this,f=!0;a.addEventListener("keydown",(function(e){var t=d.getWindow();if(38===(e=e||t.event).keyCode&&(d.searchResults.selectPrevious(),e.preventDefault()),40===e.keyCode&&(d.searchResults.selectNext(),e.preventDefault()),13===e.keyCode){var r=d.searchResults.getSelection();if(!r)return!1;s(),l(),d.fireEvent({type:E.Events.ON_SEARCH_SELECTED,id:r.nodeId,modelId:r.modelId}),e.preventDefault()}}));var p=_((function(){if(0===a.value.length)return d.container.classList.add("empty"),void l();d.container.classList.remove("empty"),a.value.length<3||function(){var e=a.value.trim();if(0!==e.length){f&&(o.logger.track({category:"search_node",name:"model_browser_tool"}),f=!1),a.classList.add("searching");var t=d._searchFunction(e);d.searchResults.setResults(e,t),d.searchResults.setVisible(!0)}else l()}()}),800);a.addEventListener("input",(function(){p()})),a.addEventListener("change",(function(e){var t=d.getDocument();e.target===t.activeElement&&p()})),a.addEventListener("focus",(function(){u.classList.add("focused")})),a.addEventListener("blur",(function(){u.classList.remove("focused")}))}E.prototype=Object.create(n.Control.prototype),E.prototype.constructor=E,E.Events={ON_SEARCH_SELECTED:i.J}},29271:(e,t,r)=>{"use strict";function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function i(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return o(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return o(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,l=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){l=!0,a=e},f:function(){try{s||null==r.return||r.return()}finally{if(l)throw a}}}}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}r.r(t),r.d(t,{SplitViewLayout:()=>L});var a={down:{pointer:"pointerdown",mouse:"mousedown",touch:"touchstart"},up:{pointer:"pointerup",mouse:"mouseup",touch:"touchend"},move:{pointer:"pointermove",mouse:"mousemove",touch:"touchmove"}};function s(e){if(Autodesk.Viewing.isIE11)return[a[e].pointer];var t=[];return Autodesk.Viewing.isMobileDevice()||t.push(a[e].mouse),Autodesk.Viewing.isTouchDevice()&&t.push(a[e].touch),t}function l(e,t,r){var n,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=(o?"remove":"add")+"EventListener",l=s(t),u=i(l);try{for(u.s();!(n=u.n()).done;){var c=n.value;e[a](c,r)}}catch(e){u.e(e)}finally{u.f()}}var u=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.container=t,this.isDragging=!1,this.resizeHandlerElement=null,this.onMoveCB=r,this.panelSizeThreshold=20,this.margin=16,this.initResizeHandlerElement()}var t,r,i;return t=e,(r=[{key:"onDown",value:function(e){this.isDragging=!0,e.preventDefault()}},{key:"onUp",value:function(e){this.isDragging=!1}},{key:"onMove",value:function(e){if(this.isDragging){"touchmove"===e.type&&(e.pageX=e.touches[0].pageX,e.pageY=e.touches[0].pageY);var t=this.container.getBoundingClientRect(),r=this.getTargetWidthPercentage(e,t);this.panelSizeThreshold<r&&r<100-this.panelSizeThreshold&&this.onMoveCB(r)}}},{key:"getTargetWidthPercentage",value:function(e,t){}},{key:"initResizeHandlerElement",value:function(){this.resizeHandlerElement=document.createElement("div"),this.handlerSplitLine=document.createElement("div"),this.resizeHandlerElement.appendChild(this.handlerSplitLine),l(this.resizeHandlerElement,"down",this.onDown.bind(this)),this.onUpBinded=this.onUp.bind(this),this.onMoveBinded=this.onMove.bind(this),l(document,"move",this.onMoveBinded),l(document,"up",this.onUpBinded),this.resizeHandlerElement.className="resize-handler",this.handlerSplitLine.className="resize-handler-center-mark"}},{key:"setPosition",value:function(e){}},{key:"terminate",value:function(){this.resizeHandlerElement.parentNode.removeChild(this.resizeHandlerElement),this.resizeHandlerElement=null,l(document,"up",this.onUpBinded,!0),l(document,"move",this.onMoveBinded,!0)}}])&&n(t.prototype,r),i&&n(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}function h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function f(){return f="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=p(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}},f.apply(this,arguments)}function p(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=y(e)););return e}function m(e,t){return m=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},m(e,t)}function g(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y(e);if(t){var i=y(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return v(this,r)}}function v(e,t){if(t&&("object"===c(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function y(e){return y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},y(e)}var b=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&m(e,t)}(o,e);var t,r,n,i=g(o);function o(){return h(this,o),i.apply(this,arguments)}return t=o,(r=[{key:"initResizeHandlerElement",value:function(){f(y(o.prototype),"initResizeHandlerElement",this).call(this),this.resizeHandlerElement.classList.add("vertical"),this.handlerSplitLine.classList.add("vertical"),this.resizeHandlerElement.style.width="".concat(this.margin,"px")}},{key:"getTargetWidthPercentage",value:function(e,t){return(e.pageX-t.left)/t.width*100}},{key:"setPosition",value:function(e){this.resizeHandlerElement.style.left="calc(".concat(e,"% - ").concat(this.margin/2,"px)")}}])&&d(t.prototype,r),n&&d(t,n),Object.defineProperty(t,"prototype",{writable:!1}),o}(u);function x(e){return x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},x(e)}function _(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function E(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function w(){return w="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=A(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}},w.apply(this,arguments)}function A(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=C(e)););return e}function S(e,t){return S=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},S(e,t)}function M(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=C(e);if(t){var i=C(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return T(this,r)}}function T(e,t){if(t&&("object"===x(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function C(e){return C=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},C(e)}var P=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&S(e,t)}(o,e);var t,r,n,i=M(o);function o(){return _(this,o),i.apply(this,arguments)}return t=o,(r=[{key:"initResizeHandlerElement",value:function(){w(C(o.prototype),"initResizeHandlerElement",this).call(this),this.resizeHandlerElement.classList.add("horizontal"),this.handlerSplitLine.classList.add("horizontal"),this.resizeHandlerElement.style.height="".concat(this.margin,"px")}},{key:"getTargetWidthPercentage",value:function(e,t){return(e.pageY-t.top)/t.height*100}},{key:"setPosition",value:function(e){this.resizeHandlerElement.style.top="calc(".concat(e,"% - ").concat(this.margin/2,"px)")}}])&&E(t.prototype,r),n&&E(t,n),Object.defineProperty(t,"prototype",{writable:!1}),o}(u);function D(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var L=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._splitType=t||e.SplitType.Vertical,this.onResizeHandlerMove=this.onResizeHandlerMove.bind(this)}var t,r,n;return t=e,(r=[{key:"createSplitViewLayout",value:function(t,r,n){if(this.targetContainer=t,this.splitViewContainer=document.createElement("div"),this.splitViewContainer.classList.add("split-view-container"),this.targetContainer.parentNode.replaceChild(this.splitViewContainer,this.targetContainer),this.firstViewerContainer=this.wrapViewerContainer(r),this._splitType===e.SplitType.Vertical)this._resizeHandler=new b(this.splitViewContainer,this.onResizeHandlerMove);else{if(this._splitType!==e.SplitType.Horizontal)return void console.error("unknown splitType");this._resizeHandler=new P(this.splitViewContainer,this.onResizeHandlerMove)}this._resizeHandler&&this.splitViewContainer.appendChild(this._resizeHandler.resizeHandlerElement),this.secondViewerContainer=this.wrapViewerContainer(n),this.onResizeHandlerMove(50)}},{key:"wrapViewerContainer",value:function(e){var t=document.createElement("div");return t.className="split-view-viewer-container",e&&t.appendChild(e),this.splitViewContainer.appendChild(t),t}},{key:"restoreMainViewer",value:function(){this._resizeHandler&&(this._resizeHandler.terminate(),this._resizeHandler=null),this.splitViewContainer&&(this.splitViewContainer.parentNode.replaceChild(this.targetContainer,this.splitViewContainer),this.splitViewContainer=null,this.targetContainer=null,this.firstViewerContainer=null,this.secondViewerContainer=null)}},{key:"onResizeHandlerMove",value:function(t){this._resizeHandler&&this._resizeHandler.setPosition(t),this._splitType===e.SplitType.Vertical?(this.firstViewerContainer.style.width="".concat(t,"%"),this.secondViewerContainer.style.width="".concat(100-t,"%"),this.secondViewerContainer.style.left="".concat(t,"%")):this._splitType===e.SplitType.Horizontal&&(this.firstViewerContainer.style.height="".concat(t,"%"),this.secondViewerContainer.style.height="".concat(100-t,"%"),this.secondViewerContainer.style.top="".concat(t,"%"))}}])&&D(t.prototype,r),n&&D(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();L.SplitType={Vertical:"vertical",Horizontal:"horizontal"}},73306:(e,t,r)=>{"use strict";r.r(t),r.d(t,{ToolBar:()=>o});var n=r(66704),i=r(37522);function o(e,t){n.ControlGroup.call(this,e,t),this.removeClass("adsk-control-group"),this.addClass("adsk-toolbar"),t&&t.alignVertically&&this.addClass("adsk-toolbar-vertical")}o.Event={VISIBILITY_CHANGED:i.Control.Event.VISIBILITY_CHANGED,COLLAPSED_CHANGED:i.Control.Event.COLLAPSED_CHANGED,CONTROL_ADDED:n.ControlGroup.Event.CONTROL_ADDED,CONTROL_REMOVED:n.ControlGroup.Event.CONTROL_REMOVED,SIZE_CHANGED:n.ControlGroup.Event.SIZE_CHANGED},o.prototype=Object.create(n.ControlGroup.prototype),o.prototype.constructor=o},87571:(e,t,r)=>{"use strict";r.r(t)},78808:(e,t,r)=>{function n(t,r){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e.exports[n]=t[n],r&&(e.exports[r][n]=t[n]))}r(82526),r(41817),r(72443),r(92401),r(8722),r(32165),r(69007),r(83510),r(41840),r(6982),r(32159),r(96649),r(39341),r(60543),r(92222),r(50545),r(43290),r(57327),r(69826),r(34553),r(84944),r(86535),r(91038),r(26699),r(66992),r(69600),r(21249),r(26572),r(47042),r(2707),r(38706),r(40561),r(33792),r(99244),r(18264),r(96078),r(4855),r(68309),r(73706),r(51532),r(99752),r(82376),r(73181),r(23484),r(2388),r(88621),r(60403),r(84755),r(25438),r(90332),r(40658),r(40197),r(44914),r(52420),r(60160),r(60970),r(10408),r(73689),r(9653),r(93299),r(35192),r(33161),r(44048),r(78285),r(44363),r(55994),r(61874),r(9494),r(56977),r(19601),r(59595),r(35500),r(69720),r(43371),r(38559),r(38880),r(49337),r(36210),r(30489),r(43304),r(41825),r(98410),r(72200),r(47941),r(94869),r(33952),r(57227),r(60514),r(41539),r(26833),r(88674),r(17727),r(36535),r(12419),r(69596),r(52586),r(74819),r(95683),r(39361),r(51037),r(5898),r(67556),r(14361),r(83593),r(39532),r(24603),r(74916),r(92087),r(39714),r(70189),r(79841),r(27852),r(94953),r(32023),r(78783),r(4723),r(66528),r(83112),r(38992),r(82481),r(15306),r(64765),r(23123),r(23157),r(73210),r(48702),r(55674),r(15218),r(74475),r(57929),r(50915),r(29253),r(42125),r(78830),r(58734),r(29254),r(37268),r(7397),r(60086),r(80623),r(44197),r(76495),r(87145),r(35109),r(65125),r(82472),r(49743),r(8255),r(29135),r(92990),r(18927),r(33105),r(35035),r(74345),r(7174),r(32846),r(98145),r(44731),r(77209),r(96319),r(58867),r(37789),r(33739),r(95206),r(29368),r(14483),r(12056),r(3462),r(30678),r(27462),r(33824),r(55021),r(12974),r(15016),r(4129),r(38478),r(8628),r(83475),r(46273),r(51568),r(26349),r(65743),r(10072),r(99137),r(71957),r(96306),r(103),r(8582),r(90618),r(74592),r(88440),r(58276),r(35082),r(12813),r(18222),r(24838),r(38563),r(50336),r(7512),r(46603),r(70100),r(10490),r(13187),r(60092),r(19041),r(30666),r(51638),r(62975),r(15728),r(46056),r(44299),r(5162),r(50292),r(1025),r(97314),r(96290),r(77479),r(34582),r(47896),r(12647),r(98558),r(84018),r(97507),r(61605),r(49076),r(34999),r(88921),r(96248),r(13599),r(11477),r(64362),r(15389),r(46006),r(90401),r(45164),r(91238),r(54837),r(87485),r(56767),r(69916),r(76651),r(61437),r(35285),r(39865),r(86035),r(67501),r(13728),r(27207),r(21568),r(48824),r(44130),r(78206),r(76478),r(79715),r(43561),r(32049),r(86020),r(56585),r(54747),r(33948),r(84633),r(85844),r(60285),r(83753),r(41637),r(35666),e.exports.Autodesk=r(45375).Autodesk;var i=Object.assign||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])};e.exports.THREE=r(23909),e.exports.av={},e.exports.avp={},e.exports.avu={},e.exports.ave={},n({Hammer:r(41145)},"av"),n(r(84998),"av"),n(r(84998),"avp"),n(r(17167),"avp"),n(r(17167),"av"),n(r(76967),"avp"),n(r(21319),"avp"),n(r(26261),"avp"),n(r(26261),"av"),n(r(34500),"avp");var o=r(71224).Z;o.translate=o.t.bind(o),o.localize=function(){},n({i18n:o},"av"),n(r(41471),"avp"),n(r(58660),"avp"),n(r(98926),"avp"),n(r(92445),"avp"),n(r(77416),"avp"),n(r(83359),"avp"),n(r(74007),"avp"),n(r(93180),"avp"),n(r(68538),"avp"),n(r(4388),"avp"),n(r(12990),"avp"),n(r(97339),"avp"),n(r(85994),"avp"),n(r(21995),"avp"),n(r(61768),"avp"),n(r(66199),"avp"),n(r(49321),"avp"),n(r(96890),"avp"),n(r(14705),"avp"),n(r(68693),"avp"),n(r(90564),"avp"),n(r(57658),"avp"),n(r(97122),"avp"),n(r(88715),"avp"),n(r(49514),"avp"),n(r(26842),"avp"),n(r(42713),"avp"),n(r(5106),"avp"),n(r(46759),"avp"),n(r(2727),"avp"),n(r(25119),"avp"),n(r(73075),"avp"),n(r(43586),"avp"),n(r(22585),"avp"),n(r(36757),"avp"),n(r(89812),"avp"),n(r(76543),"avp"),n(r(48862),"avp"),n(r(25920),"avp"),n(r(44971),"avp"),n(r(73080),"avp"),n(r(18187),"avp"),n(r(25131),"avp"),n(r(23305),"avp"),n(r(79175),"avp"),n(r(30190),"avp"),n(r(29747),"avp"),n(r(23650),"avp"),n(r(282),"avp"),n(r(82197),"av"),n(r(1840),"avp"),n(r(6420),"avp"),n(r(26245),"avp"),n(r(27820),"avp"),n(r(67317),"avp"),n(r(35313),"avp"),n(r(95920),"avp"),n(r(45451),"avp"),n(r(23406),"avp"),n(r(87289),"avp"),n(r(96610),"avp"),n(r(42517),"avp"),n(r(86620),"avp"),n(r(89371),"avp"),n(r(74751),"avp"),n(r(79659),"av"),n(r(58964),"av"),n(r(57601),"avp"),n(r(90050),"avp"),n(r(85212),"avp"),n(r(50411),"av"),n(r(77368),"av"),n(r(62546),"av"),n(r(25282),"av"),n(r(61445),"av"),n(r(25637),"av"),n(r(37169),"av"),n(r(11294),"av"),n(r(65663),"av"),n(r(95018),"avp"),n(r(24032),"avp"),n(r(19255),"avp"),n(r(83161),"av"),n(r(38202),"av"),n(r(91217),"avp"),n(r(55412),"avp"),n(r(41772),"av"),n(r(50041),"av"),n(r(24327),"av"),n(r(44245),"avp"),n(r(59823),"avp"),n(r(99248),"av"),n(r(66904),"av"),n(r(76079),"av"),n(r(70520),"av"),n(r(12032),"av"),n(r(20974),"av"),n(r(9322),"av"),n(r(7724),"av"),n(r(65522),"av"),n(r(50638),"avp"),e.exports.av.ModelUnits=r(50638).ModelUnits,n(r(7963),"avp"),n(r(51902),"av"),n(r(5130),"avp");var a=e.exports.av.MeasureCommon={};i(a,r(85553)),a.MeasurementTypes=r(37495).o,a.MeasurementTypesToAnalytics=r(37495).D,a.SnapType=r(5646).t,a.Events=r(80890).n,a.Measurement=r(70757).g,a.SnapResult=r(9331).N,n(r(27800),"av"),n(r(35449),"av"),n(r(80382),"avp"),n(r(21550),"avp"),n(r(94981),"avp"),n(r(10831),"av"),n(r(93382),"av"),n(r(2799),"avp"),n(r(26074),"av"),n(r(30093),"avp"),n(r(9487),"av"),n(r(49083),"av"),n(r(3260),"av"),n(r(26099),"av"),n(r(25406),"av"),n(r(33317),"av"),n(r(77702),"av"),n(r(80401),"av"),n(r(42024),"av"),n(r(49991),"av"),n(r(82803),"av"),n(r(79757),"av"),n(r(98265),"avp"),n(r(33450),"avp"),n(r(7440),"avp"),n(r(36257),"avp"),n(r(8283),"avp"),n(r(50005),"avp"),n(r(16727),"avp"),n(r(19115),"avp"),n(r(439),"avp"),n(r(58092),"avp"),n(r(18588),"av"),n(r(80723),"av"),n(r(62066),"avp"),n(r(96651),"avp"),r(87571),n(r(59005),"avu"),n(r(33218),"avu"),n(r(30814),"avu"),n(r(79893),"avu"),n(r(74593),"avp"),n(r(12074),"avu"),n(r(76723),"avu"),n(r(89576),"avp"),n(r(15024),"avp"),n(r(36311),"avp"),n(r(96250),"avp"),n(r(1204),"avu"),n(r(53974),"avu"),n(r(30587),"avu"),n(r(76095),"avp"),n(r(83802),"ave"),n(r(37522),"avu"),n(r(66704),"avu"),n(r(42106),"avu"),n(r(51676),"avu"),n(r(35010),"avu"),n(r(73306),"avu"),n(r(56441),"avp"),n(r(89853),"avu"),n(r(55848),"avu"),n(r(68005),"avu"),n(r(42430),"avp"),n(r(75977),"ave"),n(r(32757),"ave"),n(r(49710),"ave"),n(r(66190),"ave"),n(r(6355),"av"),n(r(66803),"av"),n(r(29271),"avu"),n(r(83522),"av"),n(r(25090),"av"),n(r(17452),"av"),n(r(43155),"av"),n(r(85101),"avp"),n(r(96546),"av"),r(92148).i(e.exports)},43155:(e,t,r)=>{"use strict";r.r(t),r.d(t,{CrossViewerInteractionCommon:()=>i});var n=r(37169),i={onSelectionChanged:{eventName:n.AGGREGATE_SELECTION_CHANGED_EVENT,cb:function(e,t,r){var n=e.getAggregateSelection();if(t.impl.model)if(n.length>0)for(var i=0;i<n.length;i++)for(var o=n[i],a=o.model,s=o.selection,l=0;l<t.impl.modelQueue().getModels().length;l++){var u=t.impl.modelQueue().getModels()[l];u&&u.getDocumentNode()&&a.getDocumentNode()&&u.getDocumentNode().originModel===a.getDocumentNode().originModel?(t.impl.is2d?t.select(s,u):(t.showAll(),t.select(s,u),t.isolate(s,u)),t.fitToView(s)):!t.impl.is2d&&u.visibilityManager&&u.visibilityManager.setAllVisibility(!1)}else t.clearSelection(),t.impl.is2d||t.showAll()}}}},17452:(e,t,r)=>{"use strict";r.r(t),r.d(t,{createLeechViewer:()=>L});var n=r(26842);function i(e){Autodesk.Viewing.Private.RenderContext.call(this),this.originalInit=this.init.bind(this),this.init=function(t,r,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};this.canvas=e,this.ctx2D=this.canvas.getContext("2d");var o=Object.assign({},i,{offscreen:!0});this.originalInit(t,r,n,o),this.glrenderer=t;var a=this.glrenderer.getPixelRatio();this.setSize(r/a,n/a)},this.renderToCanvas=function(){this.ctx2D&&(this.getOffscreenTarget()||0!=this.widthWithPixelRatio&&0!=this.heightWithPixelRatio&&(this.ctx2D.clearRect(0,0,this.widthWithPixelRatio,this.heightWithPixelRatio),this.ctx2D.drawImage(this.glrenderer.domElement,0,this.glrenderer.domElement.height-this.heightWithPixelRatio,this.widthWithPixelRatio,this.heightWithPixelRatio,0,0,this.widthWithPixelRatio,this.heightWithPixelRatio)))},this.originalSetSize=this.setSize.bind(this),this.setSize=function(e,t,r,n){if(!n){var i=this.glrenderer.getPixelRatio();this.width=e,this.height=t,this.widthWithPixelRatio=e*i,this.heightWithPixelRatio=t*i,this.canvas.width=this.widthWithPixelRatio,this.canvas.height=this.heightWithPixelRatio,this.canvas.style.width="".concat(this.width,"px"),this.canvas.style.height="".concat(this.height,"px")}this.prepareViewport(r,n),this.restoreViewport()},this.prepareViewport=function(e,t){this.glrenderer.pushViewport();var r=this.glrenderer.getPixelRatio(),n=this.glrenderer.domElement.width/r,i=this.glrenderer.domElement.height/r;(n<this.width||i<this.height)&&this.glrenderer.setSize(Math.max(this.width,n),Math.max(this.height,i)),this.originalSetSize(this.width,this.height,e,t)},this.restoreViewport=function(){this.glrenderer.popViewport()}}i.prototype=Object.create(n.RenderContext.prototype),i.prototype.constructor=i;var o=r(95018),a=function(){if("undefined"!=typeof Map)return Map;function e(e,t){var r=-1;return e.some((function(e,n){return e[0]===t&&(r=n,!0)})),r}return function(){function t(){this.__entries__=[]}return Object.defineProperty(t.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),t.prototype.get=function(t){var r=e(this.__entries__,t),n=this.__entries__[r];return n&&n[1]},t.prototype.set=function(t,r){var n=e(this.__entries__,t);~n?this.__entries__[n][1]=r:this.__entries__.push([t,r])},t.prototype.delete=function(t){var r=this.__entries__,n=e(r,t);~n&&r.splice(n,1)},t.prototype.has=function(t){return!!~e(this.__entries__,t)},t.prototype.clear=function(){this.__entries__.splice(0)},t.prototype.forEach=function(e,t){void 0===t&&(t=null);for(var r=0,n=this.__entries__;r<n.length;r++){var i=n[r];e.call(t,i[1],i[0])}},t}()}(),s="undefined"!=typeof window&&"undefined"!=typeof document&&window.document===document,l=void 0!==r.g&&r.g.Math===Math?r.g:"undefined"!=typeof self&&self.Math===Math?self:"undefined"!=typeof window&&window.Math===Math?window:Function("return this")(),u="function"==typeof requestAnimationFrame?requestAnimationFrame.bind(l):function(e){return setTimeout((function(){return e(Date.now())}),1e3/60)};var c=["top","right","bottom","left","width","height","size","weight"],h="undefined"!=typeof MutationObserver,d=function(){function e(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=function(e,t){var r=!1,n=!1,i=0;function o(){r&&(r=!1,e()),n&&s()}function a(){u(o)}function s(){var e=Date.now();if(r){if(e-i<2)return;n=!0}else r=!0,n=!1,setTimeout(a,t);i=e}return s}(this.refresh.bind(this),20)}return e.prototype.addObserver=function(e){~this.observers_.indexOf(e)||this.observers_.push(e),this.connected_||this.connect_()},e.prototype.removeObserver=function(e){var t=this.observers_,r=t.indexOf(e);~r&&t.splice(r,1),!t.length&&this.connected_&&this.disconnect_()},e.prototype.refresh=function(){this.updateObservers_()&&this.refresh()},e.prototype.updateObservers_=function(){var e=this.observers_.filter((function(e){return e.gatherActive(),e.hasActive()}));return e.forEach((function(e){return e.broadcastActive()})),e.length>0},e.prototype.connect_=function(){s&&!this.connected_&&(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),h?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},e.prototype.disconnect_=function(){s&&this.connected_&&(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},e.prototype.onTransitionEnd_=function(e){var t=e.propertyName,r=void 0===t?"":t;c.some((function(e){return!!~r.indexOf(e)}))&&this.refresh()},e.getInstance=function(){return this.instance_||(this.instance_=new e),this.instance_},e.instance_=null,e}(),f=function(e,t){for(var r=0,n=Object.keys(t);r<n.length;r++){var i=n[r];Object.defineProperty(e,i,{value:t[i],enumerable:!1,writable:!1,configurable:!0})}return e},p=function(e){return e&&e.ownerDocument&&e.ownerDocument.defaultView||l},m=_(0,0,0,0);function g(e){return parseFloat(e)||0}function v(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return t.reduce((function(t,r){return t+g(e["border-"+r+"-width"])}),0)}function y(e){var t=e.clientWidth,r=e.clientHeight;if(!t&&!r)return m;var n=p(e).getComputedStyle(e),i=function(e){for(var t={},r=0,n=["top","right","bottom","left"];r<n.length;r++){var i=n[r],o=e["padding-"+i];t[i]=g(o)}return t}(n),o=i.left+i.right,a=i.top+i.bottom,s=g(n.width),l=g(n.height);if("border-box"===n.boxSizing&&(Math.round(s+o)!==t&&(s-=v(n,"left","right")+o),Math.round(l+a)!==r&&(l-=v(n,"top","bottom")+a)),!function(e){return e===p(e).document.documentElement}(e)){var u=Math.round(s+o)-t,c=Math.round(l+a)-r;1!==Math.abs(u)&&(s-=u),1!==Math.abs(c)&&(l-=c)}return _(i.left,i.top,s,l)}var b="undefined"!=typeof SVGGraphicsElement?function(e){return e instanceof p(e).SVGGraphicsElement}:function(e){return e instanceof p(e).SVGElement&&"function"==typeof e.getBBox};function x(e){return s?b(e)?function(e){var t=e.getBBox();return _(0,0,t.width,t.height)}(e):y(e):m}function _(e,t,r,n){return{x:e,y:t,width:r,height:n}}var E=function(){function e(e){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=_(0,0,0,0),this.target=e}return e.prototype.isActive=function(){var e=x(this.target);return this.contentRect_=e,e.width!==this.broadcastWidth||e.height!==this.broadcastHeight},e.prototype.broadcastRect=function(){var e=this.contentRect_;return this.broadcastWidth=e.width,this.broadcastHeight=e.height,e},e}(),w=function(e,t){var r=function(e){var t=e.x,r=e.y,n=e.width,i=e.height,o="undefined"!=typeof DOMRectReadOnly?DOMRectReadOnly:Object,a=Object.create(o.prototype);return f(a,{x:t,y:r,width:n,height:i,top:r,right:t+n,bottom:i+r,left:t}),a}(t);f(this,{target:e,contentRect:r})},A=function(){function e(e,t,r){if(this.activeObservations_=[],this.observations_=new a,"function"!=typeof e)throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=e,this.controller_=t,this.callbackCtx_=r}return e.prototype.observe=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(e instanceof p(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var t=this.observations_;t.has(e)||(t.set(e,new E(e)),this.controller_.addObserver(this),this.controller_.refresh())}},e.prototype.unobserve=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(e instanceof p(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var t=this.observations_;t.has(e)&&(t.delete(e),t.size||this.controller_.removeObserver(this))}},e.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},e.prototype.gatherActive=function(){var e=this;this.clearActive(),this.observations_.forEach((function(t){t.isActive()&&e.activeObservations_.push(t)}))},e.prototype.broadcastActive=function(){if(this.hasActive()){var e=this.callbackCtx_,t=this.activeObservations_.map((function(e){return new w(e.target,e.broadcastRect())}));this.callback_.call(e,t,e),this.clearActive()}},e.prototype.clearActive=function(){this.activeObservations_.splice(0)},e.prototype.hasActive=function(){return this.activeObservations_.length>0},e}(),S="undefined"!=typeof WeakMap?new WeakMap:new a,M=function e(t){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var r=d.getInstance(),n=new A(t,r,this);S.set(this,n)};["observe","unobserve","disconnect"].forEach((function(e){M.prototype[e]=function(){var t;return(t=S.get(this))[e].apply(t,arguments)}}));const T=void 0!==l.ResizeObserver?l.ResizeObserver:M;function C(e){return function(e){if(Array.isArray(e))return P(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return P(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return P(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function P(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var D=new Map;function L(e,t,r,n){if(D.has(n))return new(D.get(n))(e,t,r);function a(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=arguments.length>2?arguments[2]:void 0;this.sharedResources=o,this.loadingIntervals={},n.call(this,e,r),this.renderContext=new i(this.canvas),this.originalLoadDocumentNode=this.loadDocumentNode.bind(this),this.sharedResources.mrtFlags?this.renderContext.mrtFlags=this.sharedResources.mrtFlags:this.sharedResources.mrtFlags=this.renderContext.mrtFlags,this.resizeObserver=new T((function(e){var r=e[0].contentRect,n=Math.floor(r.width),i=Math.floor(r.height);n&&i&&(t.impl.resize(n,i,!0),t.dispatchEvent({type:Autodesk.Viewing.VIEWER_RESIZE_EVENT,width:n,height:i}),t.impl.tick(performance.now()))})),this.resizeObserver.observe(this.container)}function s(e,t){var r=e.getModelKey();return r+=".ref:"+!!t.applyRefPoint,r+=".g:"+(t.globalOffset?[t.globalOffset.x,t.globalOffset.y,t.globalOffset.z]:[0,0,0]).toString(),t.placementTransform&&(r+=".p:"+t.placementTransform.toArray().toString()),t.customHash&&(r+=".h:"+t.customHash),r}a.prototype=Object.create(n.prototype),a.prototype.constructor=a,a.prototype.initialize=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={glrenderer:this.sharedResources.glrenderer,materialManager:this.sharedResources.materialManager,renderer:this.renderContext},r=Object.assign({},e,t),i=n.prototype.initialize.call(this,r);return this.overrideAPIs(),this.sharedResources.geomCache&&this.sharedResources.geomCache.initialized&&this.impl.setGeomCache(this.sharedResources.geomCache),i},a.prototype.uninitialize=function(){var e=this;this.resizeObserver&&(this.resizeObserver.disconnect(),this.resizeObserver=null),Object.keys(this.loadingIntervals).forEach((function(t){e.clearLoadingInterval(t)})),n.prototype.uninitialize.call(this)},a.prototype.overrideAPIs=function(){var e=this,t=this.impl.tick.bind(this.impl);this.impl.tick=function(){if(e.impl&&e.impl.glrenderer()){e.impl.renderer().prepareViewport(),e.restoreViewerState();var r=performance.now();t(r),e.impl.renderer().restoreViewport()}},this.addEventListener(Autodesk.Viewing.RENDER_PRESENTED_EVENT,(function(){e.renderContext.renderToCanvas()}),{priority:-1e3});var r=this.impl.setLightPreset.bind(this.impl);this.impl.setLightPreset=function(t,n,i){if(e.impl.is2d){e.impl.initLights();var o=Autodesk.Viewing.Private.LightPresets[t].bgColorGradient;e.setBackgroundColor.apply(e,C(o)),e.impl.setCurrentLightPreset(t);var a=e.impl.loadCubeMapFromColors(e.impl.clearColorTop,e.impl.clearColorBottom);e.impl.renderer().setCubeMap(a)}else r(t,n,i)};var n=this.toolController.__invokeStack.bind(this.toolController);this.toolController.__invokeStack=function(){return e.restoreViewerState(),n.apply(void 0,arguments)};var i=this.impl.unloadModel.bind(this.impl);this.impl.unloadModel=function(t,r){var n=t.leechViewerKey,o=!1,a=e.sharedResources.loadedModels[n];return a&&(a.usedByViewersCounter--,(o=r||a.forceKeepResources||a.usedByViewersCounter>0)||delete e.sharedResources.loadedModels[n]),e.clearLoadingInterval(n),i(t,r=r||o)},this.loadDocumentNode=function(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new Promise((function(i,o){var a=s(r,n),l=e.sharedResources.loadedModels[a];if(l){var u=e.onModelLoaded(l.model,n);i(u)}else e.originalLoadDocumentNode(t,r,n).then((function(t){t.leechViewerKey=a,e.sharedResources.loadedModels[a]={model:t,usedByViewersCounter:1,loadingViewer:e},i(t)})).catch(o)}))};var o=this.impl.geomCache.bind(this.impl);this.impl.geomCache=function(){return e.sharedResources.geomCache&&e.sharedResources.geomCache.initialized||(e.sharedResources.geomCache=o()),e.sharedResources.geomCache}},a.prototype.setViewerProfile=function(e,t){if(!t.loadAsHidden){t.isAEC=e.isAEC();var r=this.chooseProfile(t);delete r.settings.lineRendering,delete r.settings.pointRendering,this.setProfile(r)}},a.prototype.setViewerLight=function(e,t){if(!t.loadAsHidden)if(this.impl.is2d){this.impl.setLightPreset(o.DefaultLightPreset2d);var r=this.impl.clearColorTop.clone().multiplyScalar(255),n=this.impl.clearColorBottom.clone().multiplyScalar(255);t.isAEC?this.impl.setLightPresetForAec():this.impl.setLightPreset(o.DefaultLightPreset),this.impl.toggleEnvMapBackground(!1),this.setBackgroundColor(r.x,r.y,r.z,n.x,n.y,n.z)}else this.impl.toggleEnvMapBackground(this.profile.settings.envMapBackground)},a.prototype.cleanViewerBeforeLoadModel=function(e){if(!e.keepCurrentModels&&this.impl.hasModels()){var t=this.config;this.tearDown(),this.setUp(t)}!this.impl.hasModels()&&this._loadingSpinner&&this._loadingSpinner.show()};var l=new THREE.Vector4(0,0,-1,-1e20);function u(e){var t=!e,r=e&&!e.isLoadDone(),n=e&&e.getPropertyDb()&&!e.getPropertyDb().isLoadDone();return!(t||r||n)}return a.prototype.syncCutPlanes=function(){var e=this.impl.getAllCutPlanes()||[l],t=this.impl.matman(),r=Math.max(e.length,t._cutplanes.length);t._cutplanes.length=0;for(var n=0;n<e.length;n++)t._cutplanes.push(e[n].clone());for(;n<r;n++)t._cutplanes.push(l);t.forEach((function(e){e.doNotCut||(e.cutplanes=t._cutplanes)}),!1,!0)},a.prototype.restoreViewerState=function(){this.sharedResources.lastRenderedViewer!==this&&(this.syncCutPlanes(),this.impl.is2d&&this.impl.updateCameraMatrices(),this.sharedResources.lastRenderedViewer=this)},a.prototype.onModelLoaded=function(e,t){var r=e.leechViewerKey;this.sharedResources.loadedModels[r].forceKeepResources=!0,this.cleanViewerBeforeLoadModel(t);var n=this.cloneModelToViewer(e);return this.addModelToViewer(n,t),delete this.sharedResources.loadedModels[r].forceKeepResources,n},a.prototype.addModelToViewer=function(e,t){this.impl.modelQueue().addHiddenModel(e),t.loadAsHidden||(this.setViewerProfile(e,t),this.showModel(e),this.setViewerLight(e,t),!t.headlessViewer&&this.createUI&&this.createUI(e)),this._loadingSpinner&&this._loadingSpinner.hide()},a.prototype.clearLoadingInterval=function(e){this.loadingIntervals[e]&&(clearInterval(this.loadingIntervals[e]),delete this.loadingIntervals[e])},a.prototype.cloneModelToViewer=function(e){var t=this,r=e.clone(),n=e.leechViewerKey;r.leechViewerKey=n;var i=this.sharedResources.loadedModels[n];i.usedByViewersCounter++;var o=i.loadingViewer;return this.clearLoadingInterval(n),this.loadingIntervals[n]=setInterval((function(){t.impl.invalidate(!1,!0,!1)}),1e3),function(e,t){return new Promise((function(r){u(t)&&r();var n=function n(){u(t)&&(e.removeEventListener(Autodesk.Viewing.GEOMETRY_LOADED_EVENT,n),e.removeEventListener(Autodesk.Viewing.OBJECT_TREE_CREATED_EVENT,n),r())};e.addEventListener(Autodesk.Viewing.GEOMETRY_LOADED_EVENT,n),e.addEventListener(Autodesk.Viewing.OBJECT_TREE_CREATED_EVENT,n)}))}(o,r).then((function(){t.clearLoadingInterval(n),setTimeout((function(){r.setInnerAttributes(e.getInnerAttributes()),t.impl.onLoadComplete(r)}),1)})),r},D.set(n,a),new a(e,t,r,n)}},25090:(e,t,r)=>{"use strict";r.r(t),r.d(t,{MultiViewerFactory:()=>a});var n=r(17452),i=r(49514);function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var t=Autodesk.Viewing.Private.createRenderer(void 0,{alpha:!0}),r=new i.MaterialManager(t);this.sharedResources={glrenderer:t,materialManager:r,loadedModels:{}}}var t,r,a;return t=e,r=[{key:"createViewer",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Autodesk.Viewing.Viewer3D;return(0,n.createLeechViewer)(e,t,this.sharedResources,r)}},{key:"destroy",value:function(){this.sharedResources=null}}],r&&o(t.prototype,r),a&&o(t,a),Object.defineProperty(t,"prototype",{writable:!1}),e}()},98926:(e,t,r)=>{"use strict";r.r(t),r.d(t,{LogLevels:()=>u,Logger:()=>c,logger:()=>p,setLogger:()=>m});var n=r(84998),i=r(58964),o=r(21319);function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}var s=(0,n.getGlobal)(),l=s,u={DEBUG:5,LOG:4,INFO:3,WARNING:2,ERROR:1,NONE:0};function c(){this.runtimeStats={},this.level=-1,this.setLevel(u.ERROR),this._reportError=this._reportError.bind(this)}function h(e,t){var r;"string"==typeof t?r={message:t}:"object"===a(t)&&(r=t),o.analytics.track(e,r)}function d(){return"undefined"!=typeof window?encodeURI(l.location.href):""}function f(){}c.prototype.initialize=function(e){if(e.eventCallback&&(this.callback=e.eventCallback),this.sessionId=e.sessionId,!this.sessionId){var t=Date.now()+"";this.sessionId=parseFloat((1e4*Math.random()|0)+""+t.substring(4))}"number"==typeof e.logLevel&&this.setLevel(e.logLevel),this.environmentInfo={touch:(0,n.isTouchDevice)(),env:(0,i.getEnv)(),referer:d(),version:s.LMV_VIEWER_VERSION,build_type:s.LMV_BUILD_TYPE};var r={category:"viewer_start",touch:this.environmentInfo.touch,env:this.environmentInfo.env,referer:this.environmentInfo.referer,version:this.environmentInfo.version,build_type:this.environmentInfo.build_type};this.track(r);var o=this;this.interval=setInterval((function(){o.reportRuntimeStats()}),6e4)},c.prototype.shutdown=function(){clearInterval(this.interval),this.interval=void 0},c.prototype.track=function(e){this.updateRuntimeStats(e),!(0,i.isOffline)()&&this.sessionId&&(this.callback&&(e.timestamp=Date.now(),e.sessionId=this.sessionId,this.callback(e)),"error"===(null==e?void 0:e.category)&&h("viewer.error.tracked",e))},c.prototype.updateRuntimeStats=function(e){if(Object.prototype.hasOwnProperty.call(e,"aggregate"))switch(e.aggregate){case"count":this.runtimeStats[e.name]>0?this.runtimeStats[e.name]++:this.runtimeStats[e.name]=1,this.runtimeStats._nonempty=!0;break;case"last":this.runtimeStats[e.name]=e.value,this.runtimeStats._nonempty=!0;break;default:this.warn("unknown log aggregate type")}},c.prototype.reportRuntimeStats=function(){this.runtimeStats._nonempty&&(delete this.runtimeStats._nonempty,this.runtimeStats.category="misc_stats",this.track(this.runtimeStats),this.runtimeStats={})},c.prototype.setLevel=function(e){this.level!==e&&(this.level=e,this.debug=e>=u.DEBUG?console.log:f,this.log=e>=u.LOG?console.log:f,this.info=e>=u.INFO?console.info:f,this.warn=e>=u.WARNING?console.warn:f,this.error=e>=u.ERROR?this._reportError:f)},c.prototype._reportError=function(){console.error.apply(console,arguments);var e=Array.prototype.slice.call(arguments).join(" ");this.callback&&this.callback({category:"error",message:e}),h("viewer.error.logged",e)};var p=new c;function m(e){p=e}},5130:(e,t,r)=>{"use strict";r.r(t),r.d(t,{displayUnits:()=>a,displayUnitsEnum:()=>s,displayUnitsPrecision:()=>l,displayUnitsPrecisionEnum:()=>u,getUnitEnum:()=>h});var n=r(71224),i=[{name:"File units",type:""},{name:"Millimeters",type:"mm",matches:["millimeter","millimeters"]},{name:"Centimeters",type:"cm",matches:["centimeter","centimeters"]},{name:"Meters",type:"m"},{name:"Inches",type:"in",matches:["inch","inches"]},{name:"Feet",type:"ft",matches:["foot"]},{name:"Feet and fractional inches",type:"ft-and-fractional-in"},{name:"Feet and decimal inches",type:"ft-and-decimal-in"},{name:"Decimal inches",type:"decimal-in"},{name:"Decimal feet",type:"decimal-ft"},{name:"Fractional inches",type:"fractional-in"},{name:"Meters and centimeters",type:"m-and-cm"},{name:"Points",type:"pt",matches:["point","points"]}],o=[{name:"File precision",value:""},{name:"0 (1)",value:0},{name:"0.1 (1/2)",value:1},{name:"0.01 (1/4)",value:2},{name:"0.001 (1/8)",value:3},{name:"0.0001 (1/16)",value:4},{name:"0.00001 (1/32)",value:5},{name:"0.000001 (1/64)",value:6}],a=i.map((function(e){return e.name})),s=i.map((function(e){return e.type})),l=o.map((function(e){return e.name})),u=o.map((function(e){return e.value}));i.forEach((function(e){if(e.matches){var t=e.matches.map((function(e){return n.Z.t(e)}));e.matches=e.matches.concat(t)}}));var c=new Set(s);function h(e){if(e=e&&e.toLocaleLowerCase(),c.has(e))return e;for(var t in i){var r=i[t],n=r.matches;if(n&&n.indexOf(e)>-1)return r.type}return null}},85553:(e,t,r)=>{"use strict";r.r(t),r.d(t,{EPSILON:()=>s,getSnapResultPosition:()=>l,correctPerpendicularPicks:()=>u,calculateDistance:()=>c,computeResult:()=>v,getFaceArea:()=>y,getCircularArcRadius:()=>b,project:()=>x,inverseProject:()=>_,nearestPointInPointToLine:()=>E,nearestPointInPointToSegment:()=>w,isEqualVectors:()=>A,getEndPointsInEdge:()=>S,angleVectorToVector:()=>M,isParallel:()=>C,isPerpendicular:()=>P,nearestVertexInVertexToEdge:()=>D,createCommonOverlay:()=>L,safeToggle:()=>R});var n=r(23909),i=r(5646),o=r(37495),a=r(50638),s=1e-4;function l(e,t){if(!e)return null;var r=function(r){var n,i,o,a=null==e?void 0:e.viewportIndex2d,s=null==t||null===(n=t.model)||void 0===n||null===(i=n.getData())||void 0===i?void 0:i.viewports;if(s&&a&&null!==(o=s[a])&&void 0!==o&&o.precision){var l=s[a].precision;r.set(Number(r.x.toFixed(l)),Number(r.y.toFixed(l)),Number(r.z.toFixed(l)))}return r};if(e.isPerpendicular)return r(e.intersectPoint);switch(e.geomType){case i.t.SNAP_VERTEX:case i.t.RASTER_PIXEL:case i.t.SNAP_MIDPOINT:case i.t.SNAP_CIRCLE_CENTER:return r(e.getGeometry());case i.t.SNAP_EDGE:var n=S(e.getGeometry()),o=n[0].clone(),a=n[1].clone();return r(E(e.intersectPoint,o,a));case i.t.SNAP_FACE:return r(T(e.intersectPoint,e.getGeometry().vertices[0],e.faceNormal));case i.t.SNAP_CIRCULARARC:if(t&&t.model&&t.model.is2d()){var s=e.snapPoint;return e.geomType=i.t.SNAP_VERTEX,e.geomVertex=s,r(s)}return r(e.circularArcCenter);case i.t.SNAP_CURVEDEDGE:return r(D(e.intersectPoint,e.getGeometry()));case i.t.SNAP_CURVEDFACE:return r(e.intersectPoint);case i.t.SNAP_INTERSECTION:return r(e.snapPoint);default:return null}}function u(e,t,r,o){if(!(e&&t&&e.getGeometry()&&t.getGeometry()))return!1;var a=l(e,r);if(o&&r)if(t.geomType===i.t.SNAP_EDGE){var s=new n.Vector3,u=new n.Vector3,c=t.getGeometry();if(s.subVectors(t.intersectPoint,a).normalize(),u.subVectors(c.vertices[0],c.vertices[1]).normalize(),P(s,u,.05))if(f=w(a,c.vertices[0],c.vertices[1],!0))return o.onMouseMove(x(f,r))&&o.setPerpendicular(!0),t.geomVertex=f,t.intersectPoint=f,!0}else if(t.geomType===i.t.SNAP_FACE){var h=new n.Vector3,d=t.getGeometry();if(h.subVectors(t.intersectPoint,a).normalize(),C(t.faceNormal,h,.05)){var f=T(a,d.vertices[0],t.faceNormal);return o.onMouseMove(x(f,r))&&o.setPerpendicular(!0),t.geomVertex=f,t.intersectPoint=f,!0}}}function c(e,t,r,n){if(!(e&&t&&e.getGeometry()&&t.getGeometry()))return null;var i=l(e,n),a=l(t,n);if(!i||!a)return null;if(A(i,a,s))return null;if(n.model.is2d()&&(i=i.clone(),a=a.clone(),n.model.pageToModel(i,a,e.viewportIndex2d)),r){r=m(r);var u=i.distanceTo(a);return{distanceXYZ:g(u,r),distanceX:g(u=Math.abs(i.x-a.x),r),distanceY:g(u=Math.abs(i.y-a.y),r),distanceZ:0,type:o.o.MEASUREMENT_DISTANCE}}return{distanceXYZ:i.distanceTo(a),distanceX:Math.abs(i.x-a.x),distanceY:Math.abs(i.y-a.y),distanceZ:Math.abs(i.z-a.z),type:o.o.MEASUREMENT_DISTANCE}}function h(e,t){if(e.is3d())return 0;if(e.isPdf(!0))return 0;var r=e.getMetadata("page_dimensions","page_width",null),i=e.getMetadata("page_dimensions","logical_width",null),o=e.getMetadata("page_dimensions","page_height",null),a=e.getMetadata("page_dimensions","logical_height",null);if(!(r&&i&&o&&a))return 0;var s=r/i,l=o/a,u=new n.Vector3(0,0,0),c=new n.Vector3(s,l,0);return e.pageToModel(u,c,t),u.distanceTo(c)}function d(e,t){var r=[];for(var i in e)if(e.hasOwnProperty(i)){var o=l(e[i],t);o&&r.push(o)}if(3!==r.length||function(e){for(var t=0;t<e.length;t++)for(var r=0;r<e.length;r++)if(t!==r&&A(e[t],e[r],s))return!0;return!1}(r))return null;var a=new n.Vector3,u=new n.Vector3;return a.subVectors(r[0],r[1]),u.subVectors(r[2],r[1]),M(a,u)}function f(e,t){var r=[];for(var n in e)if(e.hasOwnProperty(n)){var i=l(e[n],t);i&&r.push(i.clone())}var o=l(e[1],t);o&&r.push(o.clone());for(var a=0;a<r.length;a+=2)t.model.pageToModel(r[a],r[a+1],e[1].viewportIndex2d);var s=0,u=0;for(a=0;a<r.length-1;a++)s+=r[a].x*r[a+1].y,u+=r[a].y*r[a+1].x;return Math.abs((s-u)/2)}function p(e,t,r,i){if(!(e&&t&&e.getGeometry()&&t.getGeometry()))return null;if(!e.circularArcRadius)return null;var o=l(e,i).clone(),a=l(t,i).clone(),u=e.circularArcCenter,c=u instanceof n.Vector3?u.clone():new n.Vector3(u.x,u.y,u.z);if(!o||!a)return null;if(A(o,a,s))return 0;i.model.is2d()&&(i.model.pageToModel(o,a,e.viewportIndex2d),i.model.pageToModel(c,null,e.viewportIndex2d));var h=function(){var e=new n.Vector3,t=new n.Vector3;e.subVectors(o,c),t.subVectors(a,c);var r=e.length()*t.length(),i=e.dot(t);return Math.acos(i/r)*e.length()}();return r?g(h,r=m(r)):h}function m(e){var t=Math.log(e)/Math.log(10),r=Math.floor(t);return 1<e/Math.pow(10,r)&&r++,Math.pow(10,r)}function g(e,t){return Math.floor(e/t+.5)*t}function v(e,t,r,n){switch(t){case o.o.MEASUREMENT_DISTANCE:return c(a=e[1],e[2],h(r.model,a.viewportIndex2d),r);case o.o.MEASUREMENT_ANGLE:var i=d(e,r);return i?{angle:n&&n.angleOuter?360-i:i,type:t}:null;case o.o.MEASUREMENT_AREA:return{area:f(e,r),type:t};case o.o.MEASUREMENT_ARC:var a;return{arc:p(a=e[1],e[2],h(r.model,a.viewportIndex2d),r),type:t};case o.o.MEASUREMENT_LOCATION:return{location:l(e[1],r),type:t};default:return null}}function y(e,t,r,i,o,s){for(var l=0,u=r.vertices,c=new n.Vector3,h=new n.Vector3,d=0;d<u.length;d+=3)c.subVectors(u[d+1],u[d]),h.subVectors(u[d+2],u[d]),l+=c.length()*h.length()*Math.sin(c.angleTo(h))/2;return l=(0,a.convertUnits)(e.model.getUnitString(),i,s,l,"square"),i?(0,a.formatValueWithUnits)(l,i+"^2",3,o):(0,a.formatValueWithUnits)(l,null,3,o)}function b(e,t,r,n,i,o){var s=r.radius;if(s){if(e.model.is2d()){var l=r.center.clone(),u=r.vertices[0].clone();e.model.pageToModel(l,u,t.getPick(1).viewportIndex2d),s=l.distanceTo(u)}return s=(0,a.convertUnits)(e.model.getUnitString(),n,o,s),(0,a.formatValueWithUnits)(s,n,3,i)}}function x(e,t,r){var i=t.navigation.getCamera(),o=t.navigation.getScreenViewport(),a=new n.Vector3(e.x,e.y,e.z);return a=a.project(i),r=r||0,new n.Vector2(Math.round((a.x+1)/2*o.width)+r,Math.round((1-a.y)/2*o.height)+r)}function _(e,t){var r=t.navigation.getCamera(),i=t.navigation.getScreenViewport(),o=new n.Vector3;return o.x=e.x/i.width*2-1,o.y=-(e.y/i.height*2-1),o.z=0,o=o.unproject(r)}function E(e,t,r){var i,o=new n.Vector3,a=new n.Vector3;return o.subVectors(t,e),a.subVectors(r,t),i=o.dot(a),o.subVectors(r,t),i=-i/o.dot(o),o.subVectors(r,t),o.multiplyScalar(i),o.add(t)}function w(e,t,r,i){var o,a,s=new n.Vector3,l=new n.Vector3;return s.subVectors(t,e),l.subVectors(r,t),a=s.dot(l),s.subVectors(r,t),(a=-a/s.dot(s))<0?o=i?null:t:a>1?o=i?null:r:(s.subVectors(r,t),s.multiplyScalar(a),o=s.add(t)),o}function A(e,t,r){return!(!e||!t)&&(Math.abs(e.x-t.x)<=r&&Math.abs(e.y-t.y)<=r&&Math.abs(e.z-t.z)<=r)}function S(e){for(var t=e.vertices,r=[],n=0;n<t.length;++n){for(var i=!1,o=0;o<t.length;++o)if(o!==n&&t[o].equals(t[n])){i=!0;break}i||r.push(t[n])}return r.length<2&&(r[0]=t[0],r[1]=t[1]),r}function M(e,t){return 180*e.angleTo(t)/Math.PI}function T(e,t,r){var i=new n.Vector3,o=r.clone(),a=new n.Vector3;a.subVectors(e,t);var s=-o.dot(a)/o.dot(o);return i.addVectors(e,o.multiplyScalar(s)),i}function C(e,t,r){return r=r||s,1-Math.abs(e.dot(t))<r}function P(e,t,r){return r=r||s,Math.abs(e.dot(t))<r}function D(e,t){for(var r,n=Number.MAX_VALUE,i=0;i<t.vertices.length;i++){var o=e.distanceTo(t.vertices[i]);n>o&&(r=t.vertices[i],n=o)}return r}function L(e,t){e.impl.overlayScenes[t]||e.impl.createOverlayScene(t)}function R(e,t,r){(e.classList.contains(t)&&!r||!e.classList.contains(t)&&r)&&e.classList.toggle(t,r)}},80890:(e,t,r)=>{"use strict";r.d(t,{n:()=>n});var n={MEASUREMENT_CHANGED_EVENT:"measurement-changed",MEASUREMENT_COMPLETED_EVENT:"measurement-completed",UNITS_CALIBRATION_STARTS_EVENT:"units_calibration_starts_event",FINISHED_CALIBRATION_FOR_DIMENSION_EVENT:"finished_calibration_for_dimension_event",CALIBRATION_REQUIRED_EVENT:"calibration-required",OPEN_CALIBRATION_PANEL_EVENT:"open-calibration-panel",CLOSE_CALIBRATION_PANEL_EVENT:"close-calibration-panel",CLEAR_CALIBRATION_SIZE_EVENT:"clear-calibration-size",FINISHED_CALIBRATION:"finished-calibration",DISPLAY_UNITS_CHANGED:"display-units-changed",PRECISION_CHANGED:"precision-changed",MEASUREMENT_MODE_ENTER:"measure-mode-enter",MEASUREMENT_MODE_LEAVE:"measure-mode-leave",DELETE_MEASUREMENT:"delete-measurement"}},70757:(e,t,r)=>{"use strict";r.d(t,{g:()=>a});var n=r(9331),i=r(37495),o=r(85553);function a(e,t,r){this.measurementType=e,this.id=t,this.picks=[],this.closedArea=!1,this.isRestored=!1,this.options=r,this.resetMeasureValues()}a.prototype.clone=function(){var e,t=new a(this.measurementType,this.id,this.options);return t.closedArea=this.closedArea,t.isRestored=this.isRestored,t.picks=this.clonePicks(),t.angle=this.angle,t.distanceX=this.distanceX,t.distanceY=this.distanceY,t.distanceZ=this.distanceZ,t.distanceXYZ=this.distanceXYZ,t.arc=this.arc,t.location=null===(e=this.location)||void 0===e?void 0:e.clone(),t.result=Object.assign({},this.result),t},a.prototype.resetMeasureValues=function(){this.angle=0,this.distanceX=0,this.distanceY=0,this.distanceZ=0,this.distanceXYZ=0,this.arc=0,this.location=null,this.result=null},a.prototype.setPick=function(e,t){var r=this.picks[e]=t;return r.id=parseInt(e),r},a.prototype.getPick=function(e){var t=this.picks[e];return t||(t=this.setPick(e,new n.N)),t},a.prototype.clonePicks=function(e){var t=[];for(var r in this.picks)if(Object.prototype.hasOwnProperty.call(this.picks,r)){var n=this.picks[r];t.push(n.clone())}return t},a.prototype.countPicks=function(){return Object.keys(this.picks).length},a.prototype.getMaxNumberOfPicks=function(){switch(this.measurementType){case i.o.MEASUREMENT_DISTANCE:case i.o.MEASUREMENT_LOCATION:case i.o.MEASUREMENT_CALLOUT:case i.o.MEASUREMENT_ARC:return 2;case i.o.MEASUREMENT_ANGLE:return 3;case i.o.MEASUREMENT_AREA:return this.closedArea?this.countPicks():Number.MAX_VALUE-1}},a.prototype.hasPick=function(e){return this.picks[e]&&!this.picks[e].isEmpty()||this.isRestored},a.prototype.isComplete=function(){var e=this.countPicks()===this.getMaxNumberOfPicks();for(var t in this.picks)if(Object.prototype.hasOwnProperty.call(this.picks,t)&&!(e=e&&this.hasPick(t)))break;return e},a.prototype.isEmpty=function(){var e=!0;for(var t in this.picks)if(Object.prototype.hasOwnProperty.call(this.picks,t)&&!(e=e&&!this.hasPick(t)))break;return e},a.prototype.clearPick=function(e){this.picks[e]&&this.picks[e].clear(),this.resetMeasureValues()},a.prototype.clearAllPicks=function(){for(var e in this.picks)Object.prototype.hasOwnProperty.call(this.picks,e)&&this.clearPick(e)},a.prototype.hasEqualPicks=function(e,t){if(!e||!t)return!1;if(e.geomType===t.geomType){var r=(0,o.getSnapResultPosition)(e),n=(0,o.getSnapResultPosition)(t);return(0,o.isEqualVectors)(r,n,o.EPSILON)}return!1},a.prototype.computeResult=function(e,t){if(this.resetMeasureValues(),!t.model)return this.result=null,!1;var r=this.result=(0,o.computeResult)(e,this.measurementType,t,this.options);if(null===r)return!this.isComplete();switch(r.type){case i.o.MEASUREMENT_DISTANCE:return this.distanceXYZ=r.distanceXYZ,this.distanceX=r.distanceX,this.distanceY=r.distanceY,this.distanceZ=r.distanceZ,!0;case i.o.MEASUREMENT_ANGLE:return this.angle=isNaN(r.angle)?0:r.angle,!0;case i.o.MEASUREMENT_AREA:return this.area=r.area,!0;case i.o.MEASUREMENT_ARC:return this.arc=r.arc,!0;case i.o.MEASUREMENT_LOCATION:return this.location=r.location,!0;case i.o.MEASUREMENT_CALLOUT:return!0;default:return!1}},a.prototype.getGeometry=function(e){return{type:this.picks[e].geomType,geometry:this.picks[e].getGeometry()}},a.prototype.attachIndicator=function(e,t,r){this.indicator=new r(e,this,t),this.indicator.init()}},37495:(e,t,r)=>{"use strict";var n;function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}r.d(t,{o:()=>o,D:()=>a});var o={MEASUREMENT_DISTANCE:1,MEASUREMENT_ANGLE:2,MEASUREMENT_AREA:3,CALIBRATION:4,MEASUREMENT_CALLOUT:5,MEASUREMENT_LOCATION:6,MEASUREMENT_ARC:7},a=(i(n={},o.MEASUREMENT_DISTANCE,"Distance"),i(n,o.MEASUREMENT_ANGLE,"Angle"),i(n,o.MEASUREMENT_AREA,"Area"),i(n,o.CALIBRATION,"Calibration"),i(n,o.MEASUREMENT_CALLOUT,"Callout"),i(n,o.MEASUREMENT_LOCATION,"Location"),i(n,o.MEASUREMENT_ARC,"Arc"),n)},51902:(e,t,r)=>{"use strict";r.r(t),r.d(t,{PDFUtils:()=>s});var n=r(27820);function i(e){var t,r=e.impl.model.getDocumentNode(),n=null==r||null===(t=r.search(Autodesk.Viewing.BubbleNode.LEAFLET_NODE)[0])||void 0===t?void 0:t._raw();if(!n)return null;var i={};return new Autodesk.Viewing.Document(r.getRootNode()._raw(),"").getLeafletParams(i,r,n),i}function o(e){var t=new Autodesk.Viewing.Private.TexQuadConfig,r=i(e);return r?(t.initFromLoadOptions(null,r),t.getBBox()):null}function a(e){var t=o(e);return t?n.SceneMath.getNormalizingMatrix(null,t):null}var s={leafletToPdfWorld:function(e,t){var r,i=a(e);if(!i)return null;if(t.applyMatrix4(i),e.model.isLeaflet()){var o=e.model.getMetadata("page_dimensions"),s=new THREE.Box3(new THREE.Vector3,new THREE.Vector3(o.page_width,o.page_height,0));r=n.SceneMath.getNormalizingMatrix(void 0,s)}else r=n.SceneMath.getNormalizingMatrix(e.model);return t.applyMatrix4(r.invert()),t},pdfToLeafletWorld:function(e,t){var r=n.SceneMath.getNormalizingMatrix(e.model);t.applyMatrix4(r);var i=a(e);return i?(t.applyMatrix4(i.invert()),t):null},getLeafletLoadOptions:i,getLeafletBoundingBox:o,getLeafletNormalizingMatrix:a}},9331:(e,t,r)=>{"use strict";r.d(t,{N:()=>i});var n=r(5646);function i(){this.clear()}i.prototype.clear=function(){this.geomType=null,this.modelId=null,this.snapNode=null,this.geomVertex=null,this.geomEdge=null,this.geomFace=null,this.radius=null,this.intersectPoint=null,this.faceNormal=null,this.viewportIndex2d=null,this.circularArcCenter=null,this.circularArcRadius=null,this.fromTopology=!1,this.isPerpendicular=!1,this.snapPoint=null},i.prototype.copyTo=function(e){e.modelId=this.modelId,e.snapNode=this.snapNode,e.geomVertex=this.geomVertex,e.geomFace=this.geomFace,e.geomEdge=this.geomEdge,e.radius=this.radius,e.geomType=this.geomType,e.intersectPoint=this.intersectPoint,e.faceNormal=this.faceNormal,e.viewportIndex2d=this.viewportIndex2d,e.circularArcCenter=this.circularArcCenter,e.circularArcRadius=this.circularArcRadius,e.fromTopology=this.fromTopology,e.isPerpendicular=this.isPerpendicular,e.snapPoint=this.snapPoint},i.prototype.clone=function(){var e=new i;return this.copyTo(e),e},i.prototype.isEmpty=function(){return!this.getGeometry()};var o=null,a=null,s=null,l=function(e,t){return a=a||new THREE.Vector3,s=s||new THREE.Vector3,a.set(0,0,0),s.set(e,0,0),a.applyMatrix4(t),s.applyMatrix4(t),a.distanceTo(s)};i.prototype.applyMatrix4=function(e){if(this.geomEdge&&this.geomEdge.applyMatrix4(e),this.geomFace&&this.geomFace.applyMatrix4(e),this.geomVertex&&this.geomVertex.applyMatrix4(e),this.intersectPoint&&this.intersectPoint.applyMatrix4(e),this.circularArcCenter&&this.circularArcCenter.applyMatrix4(e),this.snapPoint&&this.snapPoint.applyMatrix4(e),this.faceNormal){var t=(o=o||new THREE.Matrix4).getNormalMatrix(e);this.faceNormal.applyMatrix4(t)}this.radius=l(this.radius,e),this.circularArcRadius=l(this.circularArcRadius,e)},i.prototype.getFace=function(){return this.geomFace},i.prototype.getEdge=function(){return this.geomEdge},i.prototype.getVertex=function(){return this.geomVertex},i.prototype.getGeometry=function(){switch(this.geomType){case n.t.SNAP_VERTEX:case n.t.SNAP_MIDPOINT:case n.t.SNAP_INTERSECTION:case n.t.SNAP_CIRCLE_CENTER:case n.t.RASTER_PIXEL:return this.geomVertex;case n.t.SNAP_EDGE:return this.geomEdge;case n.t.SNAP_FACE:return this.geomFace;case n.t.SNAP_CIRCULARARC:case n.t.SNAP_CURVEDEDGE:return this.geomEdge;case n.t.SNAP_CURVEDFACE:return this.geomFace}return null},i.prototype.setGeometry=function(e,t){switch(e){case n.t.SNAP_VERTEX:case n.t.SNAP_MIDPOINT:case n.t.SNAP_INTERSECTION:case n.t.SNAP_CIRCLE_CENTER:case n.t.RASTER_PIXEL:this.geomVertex=t;break;case n.t.SNAP_EDGE:this.geomEdge=t;break;case n.t.SNAP_FACE:this.geomFace=t;break;case n.t.SNAP_CIRCULARARC:case n.t.SNAP_CURVEDEDGE:this.geomEdge=t;break;case n.t.SNAP_CURVEDFACE:this.geomFace=t;break;default:return}this.geomType=e}},5646:(e,t,r)=>{"use strict";r.d(t,{t:()=>n});var n={SNAP_VERTEX:0,SNAP_MIDPOINT:1,SNAP_CIRCLE_CENTER:2,SNAP_EDGE:3,SNAP_FACE:4,SNAP_CIRCULARARC:5,SNAP_CURVEDEDGE:6,SNAP_CURVEDFACE:7,RASTER_PIXEL:8,SNAP_INTERSECTION:9}},50638:(e,t,r)=>{"use strict";r.r(t),r.d(t,{ModelUnits:()=>u,formatValueWithUnits:()=>b,fixUnitString:()=>x,getUnitData:()=>_,convertUnits:()=>E,calculatePrecision:()=>w,convertToDisplayUnits:()=>A,getMainUnit:()=>S});var n,i=r(71224),o=r(5130);function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}function s(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var l=r(30325),u={METER:"m",CENTIMETER:"cm",MILLIMETER:"mm",FOOT:"ft",INCH:"in",POINT:"pt"},c=(s(n={},u.METER,1),s(n,u.CENTIMETER,.01),s(n,u.MILLIMETER,.001),s(n,u.FOOT,.3048),s(n,u.INCH,.0254),s(n,u.POINT,.0254/72),n);function h(e){var t="";return 2===e?t=String.fromCharCode(178):3===e&&(t=String.fromCharCode(179)),t}function d(e){var t=0<=e?Math.floor(e):Math.ceil(e);return{intPart:t,fracPart:e-t}}function f(e,t,r){var n="";return r&&0===e&&(n+="-"),n+=0<t?e.toFixed(t):e.toFixed(0)}function p(e,t,r,n){for(var i,o,a="",s=1,l=e<0,u=0;u<t;++u)s*=2;e>0?e+=.5/s:e-=.5/s,r?o=e:(a+=f(i=d(e/12).intPart,0,l)+n.feet+" ",(o=e-12*i)<0&&(o=-o));var c=d(o).intPart,h=d((o-c)*s).intPart;if(0!==h&&0===c||(a+=f(c,0)),0!==h){for(c<0&&h<0&&(h=-h);h%2==0;)h/=2,s/=2;0!==c&&(a+="-"),a+=f(h,0)+"/"+f(s,0)}return a+=n.inches}function m(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n="";e<0&&(n="-",e=Math.abs(e));var i=d(e),o=i.intPart,a=i.fracPart*Math.pow(100,r),s=h(r),l=f(o,0),u=f(a,t);return u.startsWith(Math.pow(100,r).toString())&&(l=f(o+1,0),u=f(0,t)),n+l+" m".concat(s," ")+u+" cm".concat(s)}function g(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i="";e<0&&(i="-",e=Math.abs(e));var o=d(e),a=o.intPart,s=o.fracPart*Math.pow(12,n),l=h(n),u=f(a,0),c=f(s,t);return c.startsWith(Math.pow(12,n).toString())&&(u=f(a+1,0),c=f(0,t)),i+u+r.feet+l+" "+c+r.inches+l}var v={feetFractionalInches:"ft-and-fractional-in",fractionalInches:"fractional-in",feet:"feet",inches:"inches",stationingFeet:"feet"};function y(e){if(!e||!e.startsWith("autodesk.unit.unit:"))return e;var t=e.split(":")[1].split("-")[0],r=l.unit[t];if(!r)return console.warn("Failed to find Forge unit schema for",e),e;var n=v[t];if(n)return n;if(!r.symbols)return console.warn("Unit without symbols.",r),"";if(r.defaultSymbol&&r.symbols[r.defaultSymbol])return r.symbols[r.defaultSymbol];for(var i in r.symbols)return r.symbols[i]}function b(e,t,r,n,o){var a;null==n&&(n=3);var s=(o=o||{}).preferLetters?{feet:" ft",inches:" in"}:{feet:"'",inches:'"'};t=y(t);try{if(1===r)a=i.Z.t(e?"Yes":"No");else if(24===r){var l=e.split(" ");a=[];for(var u=0;u<l.length;++u)a.push(b(parseFloat(l[u]),t,3,n));a=a.join(", ")}else if(2!==r&&3!==r||!isNaN(e))if("ft-and-fractional-in"===t)a=p(12*e,n,!1,s);else if("ft-and-fractional-in^2"===t)a=o.noMixedArea?f(e,n)+" ft"+h(2):p(12*e,n,!1,s)+" "+h(2);else if("ft-and-fractional-in^3"===t)a=o.noMixedVolume?f(e,n)+" ft"+h(3):p(12*e,n,!1,s)+" "+h(3);else if("ft-and-decimal-in"===t)a=g(e,n,s);else if("ft-and-decimal-in^2"===t)a=o.noMixedArea?f(e,n)+" ft"+h(2):g(e,n,s,2);else if("ft-and-decimal-in^3"===t)a=o.noMixedVolume?f(e,n)+" ft"+h(3):g(e,n,s,3);else if("decimal-in"===t||"in"===t||"inch"===t||"inches"===t)a=f(e,n)+s.inches;else if("decimal-in^2"===t||"in^2"===t||"inch^2"===t)a=f(e,n)+" in"+h(2);else if("decimal-in^3"===t||"in^3"===t||"inch^3"===t)a=f(e,n)+" in"+h(3);else if("decimal-in-sq"===t||"fractional-in-sq"===t)a=f(e,n)+" sq. in";else if("decimal-ft"===t||"ft"===t||"feet"===t||"foot"===t)a=f(e,n)+s.feet;else if("decimal-ft^2"===t||"ft^2"===t||"feet^2"===t||"foot^2"===t)a=f(e,n)+" ft"+h(2);else if("decimal-ft^3"===t||"ft^3"===t||"feet^3"===t||"foot^3"===t)a=f(e,n)+" ft"+h(3);else if("decimal-ft-sq"===t||"ft-and-fractional-in-sq"===t||"ft-and-decimal-in-sq"===t)a=f(e,n)+" sq. ft";else if("fractional-in"===t)a=p(e,n,!0,s);else if("fractional-in^2"===t)a=p(e,n,!0,s)+h(2);else if("fractional-in^3"===t)a=p(e,n,!0,s)+h(3);else if("m-and-cm"===t)a=m(e,n);else if("m-and-cm^2"===t)a=o.noMixedArea?f(e,n)+" m"+h(2):m(e,n,2);else if("m-and-cm^3"===t)a=o.noMixedVolume?f(e,n)+" m"+h(3):m(e,n,3);else if(t&&t.text){a=function(e,t){var r=t.space?" ":"";return"Prefix"===t.placement?t.text+r+e:e+r+t.text}(3===r?f(e,n):e,t)}else 3===r&&t?(t=(t=t.replace("^2",h(2))).replace("^3",h(3)),a=f(e,n)+" "+t):a=t?e+" "+t:3===r?f(e,n):e;else a="NaN"}catch(r){a=t?e+" "+t:e}return a}function x(e){var t;switch(e=null===(t=e)||void 0===t?void 0:t.toLowerCase()){case"meter":case"meters":case"m":return u.METER;case"foot":case"feet":case"ft":return u.FOOT;case"feet and inches":case"inch":case"inches":case"in":return u.INCH;case"centimeter":case"centimeters":case"cm":return u.CENTIMETER;case"millimeter":case"millimeters":case"mm":return u.MILLIMETER;case"point":case"points":case"pt":return u.POINT;default:return e}}function _(e){var t=x(e);return{unitString:t,unitScale:c[t]||1}}function E(e,t,r,n,i,o){if(r=r||1,o=o||72,(e=x(e))===(t=x(t))&&1===r)return n;var a=u,s=c,l=1;switch(t){case a.MILLIMETER:l=1/s[a.MILLIMETER];break;case a.CENTIMETER:l=1/s[a.CENTIMETER];break;case a.METER:l=1;break;case a.INCH:l=1/s[a.INCH];break;case a.FOOT:case"ft-and-fractional-in":case"ft-and-decimal-in":l=1/s[a.FOOT];break;case"decimal-in":l=1/s[a.INCH];break;case"decimal-ft":l=1/s[a.FOOT];break;case"fractional-in":l=1/s[a.INCH];break;case"m-and-cm":l=1;break;case a.POINT:l=1/s[a.INCH]*o}var h=1;switch(e){case a.MILLIMETER:h=s[a.MILLIMETER];break;case a.CENTIMETER:h=s[a.CENTIMETER];break;case a.METER:h=s[a.METER];break;case a.INCH:h=s[a.INCH];break;case a.FOOT:case"ft-and-fractional-in":case"ft-and-decimal-in":h=s[a.FOOT];break;case"decimal-in":h=s[a.INCH];break;case"decimal-ft":h=s[a.FOOT];break;case"fractional-in":h=s[a.INCH];break;case"m-and-cm":h=1;break;case a.POINT:h=s[a.INCH]/o}return"square"===i?n?n*Math.pow(l*h*r,2):0:"cube"===i?n?n*Math.pow(l*h*r,3):0:n?n*l*h*r:0}function w(e){if(!e)return 0;var t=e.toString().split(".")[1];if(!t){var r=e.toString().split("/")[1],n=r&&r.match(/\d+/);if(n){var i=parseFloat(n);if(i&&!isNaN(i))return Math.floor(Math.log2(i))}return 0}return(t=t.match(/\d+/))&&t[0]&&t[0].length||0}function A(e,t,r,n){if(!r||!n)return{displayValue:e,displayUnits:r};var i,s=r,l=n,u=y(s);return"object"===a(u)&&"text"in u&&(s=u.text),s&&(s=s.replace(/$/,"^2").replace(/$/,"^3")),/\^2$/.test(s)?(s=s.replace("^2",""),l+="^2",i="square"):/\^3$/.test(s)&&(s=s.replace("^3",""),l+="^3",i="cube"),null===(s=(0,o.getUnitEnum)(s))?{displayValue:e,displayUnits:r}:2===t||3===t?{displayValue:E(s,n,1,e,i,null),displayUnits:l}:24===t?{displayValue:e.split(" ").map((function(e){return E(s,n,1,e,i,null)})).join(" "),displayUnits:l}:{displayValue:e,displayUnits:r}}function S(e){switch(e){case"decimal-ft":case"ft-and-fractional-in":case"ft-and-decimal-in":return"ft";case"decimal-in":case"fractional-in":return"in";case"m-and-cm":return"m"}return e}},7963:(e,t,r)=>{"use strict";r.r(t),r.d(t,{UnitParser:()=>n});var n={};function i(e,t,r,n){if(!e)return NaN;var i,o=(e=e.toString()).trim();if(0==o.length)return NaN;var a=r.join("| *"),s=n.join("| *");if(i=o.match(new RegExp("^([+-]?\\d+)(?: *)/(?: *)(\\d+)(?: *)(?:"+s+") *$")))return parseFloat(i[1])/parseFloat(i[2])/t;if(i=o.match(new RegExp("^([+-]?\\d+)(?: *)/(?: *)(\\d+)(?: *)(?:"+a+")? *$")))return parseFloat(i[1])/parseFloat(i[2]);var l;if(!(i=o.match(/^[+-]? *(?:\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?/i)))return NaN;if(l=parseFloat(i[0].replace(/ */g,"")),0==(o=(o=o.slice(i[0].length)).replace("-"," ")).length||isNaN(l))return l;var u=Math.sign(l);return 0===u&&(u=1),o.match(new RegExp("^(?: *)(?:"+s+") *$","i"))?l/t:(i=o.match(new RegExp("^ +(\\d+)(?: *)/(?: *)(\\d+)(?: *)(?:"+s+") *$","i")))?(l+u*parseFloat(i[1])/parseFloat(i[2]))/t:(i=o.match(new RegExp("^(?: *)(?:"+a+"|-| +-?) *","i")))?0==(o=o.slice(i[0].length).trim()).length?i[0].match(/-/)?NaN:l:(i=o.match(new RegExp("^(\\d+(?:\\.\\d*)?)(?: *)(?:"+s+")? *$")))?l+u*parseFloat(i[1])/t:(i=o.match(new RegExp("^(\\d+)(?: *)/(?: *)(\\d+)(?: *)(?:"+s+")? *$")))?l+u*(parseFloat(i[1])/parseFloat(i[2]))/t:(i=o.match(new RegExp("^(\\d+) +(\\d+)(?: *)/(?: *)(\\d+)(?: *)(?:"+s+")? *$")))?l+u*(parseFloat(i[1])+parseFloat(i[2])/parseFloat(i[3]))/t:NaN:NaN}n.parseFeet=function(e){return i(e,12,["ft","feet","'","`","",""],["in","inch",'\\"',"''","``","",""])},n.parseMeter=function(e){return i(e,100,["m","meter"],["cm","centimeter"])},n.parseNumber=function(e,t){switch(t){case"ft":case"decimal-ft":case"ft-and-fractional-in":case"ft-and-decimal-in":case"decimal-in":case"fractional-in":return n.parseFeet(e);default:return n.parseMeter(e)}},n.parsePositiveNumber=function(e,t){var r=n.parseNumber(e,t);return r>=0?r:NaN}},80723:(e,t,r)=>{"use strict";r.r(t),r.d(t,{MobileCallbacks:()=>i});var n=(0,r(84998).getGlobal)();function i(){this.ios=n.webkit,this.android=n.JSINTERFACE,this.iosSend=function(e,t){return n.webkit.messageHandlers.callbackHandler.postMessage({command:e,data:t})},this.androidSend=n.JSINTERFACE}var o=i.prototype;o.animationReady=function(){this.ios?this.iosSend("animationReady"):this.android&&this.androidSend.animationReady()},o.onSelectionChanged=function(e){this.ios?this.iosSend("selectionChanged",e):this.android&&this.androidSend.onSelectionChanged(e)},o.onLongTap=function(e,t){this.ios?this.iosSend("onLongTap",[e,t]):this.android&&this.androidSend.onLongTap(e,t)},o.onSingleTap=function(e,t){this.ios?this.iosSend("onSingleTap",[e,t]):this.android&&this.androidSend.onSingleTap(e,t)},o.onDoubleTap=function(e,t){this.ios?this.iosSend("onDoubleTap",[e,t]):this.android&&this.androidSend.onDoubleTap(e,t)},o.setRTCSession=function(e){this.ios?this.iosSend("setRTCSession",{id:e}):this.android&&this.androidSend.setRTCSessionID(e)},o.putProperties=function(e,t){this.ios?this.iosSend("putProperties",{name:e,value:t}):this.android&&this.androidSend.putProperties(e,t)},o.onPropertyRetrievedSuccess=function(){this.ios?this.iosSend("onPropertyRetrievedSuccess"):this.android&&this.androidSend.onPropertyRetrievedSuccess()},o.onPropertyRetrievedFailOrEmptyProperties=function(){this.ios?this.iosSend("onPropertyRetrievedFailOrEmptyProperties"):this.android&&this.androidSend.onPropertyRetrievedFailOrEmptyProperties()},o.resetAnimationStatus=function(){this.ios?this.iosSend("resetAnimationStatus"):this.android&&this.androidSend.resetAnimationStatus()},o.setPauseUI=function(){this.ios?this.iosSend("setPauseUI"):this.android&&this.androidSend.setToPaused()},o.getDeviceAvailableMemory=function(){return this.ios?this.iosSend("getDeviceAvailableMemory"):this.android?this.androidSend.getDeviceAvailableMemory():void 0},o.onDeviceMemoryInsufficient=function(){return this.ios?this.iosSend("onDeviceMemoryInsufficient"):this.android?this.androidSend.onDeviceMemoryInsufficient():void 0},o.updateAnimationTime=function(e){this.ios?this.iosSend("updateAnimationTime",e):this.android&&this.androidSend.updateAnimationTime(e)},o.setLoadingProgress=function(e,t){this.ios?this.iosSend("setLoadingProgress",{state:e,progress:t}):this.android&&this.androidSend.setLoadingProgress(e,t)},o.objectTreeCreated=function(){this.ios?this.iosSend("objectTreeCreated"):this.android&&this.androidSend.objectTreeCreated()},o.geometryLoaded=function(){this.ios?this.iosSend("geometryLoaded"):this.android&&this.androidSend.geometryLoaded()},o.putSheets=function(e,t){this.ios?this.iosSend("putSheets",[e,t]):this.android&&this.androidSend.putSheets(e,t)},o.putAllSheets=function(e){this.ios?this.iosSend("putAllSheets",e):this.android&&this.androidSend.putAllSheets(e)},o.hideLoadingView=function(){this.android&&this.androidSend.hideLoadingView()},o.instanceTree=function(e){this.ios?this.iosSend("instanceTree",e):this.android&&this.androidSend.instanceTree(e)},o.loadSheetFailed=function(){this.ios?this.iosSend("loadSheetFailed"):this.android&&this.androidSend.loadSheetFailed()},o.sheetSelected=function(e){this.ios?this.iosSend("sheetSelected",e):this.android&&this.androidSend.sheetSelected(e)},"undefined"!=typeof window&&(n.MobileCallbacks=i)},45375:(e,t,r)=>{function n(){return"undefined"!=typeof window&&null!==window?window:"undefined"!=typeof self&&null!==self?self:r.g}function i(e){for(var t=n(),r=e.split("."),i=0;i<r.length;++i)t[r[i]]=t[r[i]]||{},t=t[r[i]];return t}i("Autodesk.Viewing.Private"),i("Autodesk.Viewing.Extensions"),i("Autodesk.Extensions"),i("Autodesk.Viewing.Shaders"),i("Autodesk.Viewing.UI"),i("Autodesk.LMVTK"),Autodesk.Viewing.getGlobal=n,Autodesk.Viewing.AutodeskNamespace=i,n().AutodeskNamespace=i;var o=n().Autodesk.Viewing.Private;o.LMV_WORKER_URL="lmvworker.min.js",o.ENABLE_DEBUG=o.ENABLE_DEBUG||!1,n().ENABLE_DEBUG=o.ENABLE_DEBUG,o.ENABLE_INLINE_WORKER=!0,e.exports.Autodesk=n().Autodesk},92148:(e,t,r)=>{"use strict";function n(e){var t=Autodesk.Viewing,r=t.Private,n=t.UI,i=t.Extensions;for(var o in e.av)t[o]=e.av[o];for(var a in e.avp)r[a]=e.avp[a];for(var s in e.avu)n[s]=e.avu[s];for(var l in e.ave)i[l]=e.ave[l];t.getGlobal().THREE=e.THREE,t.getGlobal().LMV=e,r.isRightClick=t.isRightClick,r.isMiddleClick=t.isMiddleClick}r.d(t,{i:()=>n})},34500:(e,t,r)=>{"use strict";r.r(t),r.d(t,{theResourceLoader:()=>s,loadDependency:()=>l});var n=r(17167);function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var o=(0,r(84998).getGlobal)(),a=o.document,s=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.loadPromises={}}var t,r,s;return t=e,(r=[{key:"getResourceUrl",value:function(e){return e.indexOf("://")>0?e:(0,n.getResourceUrl)(e)}},{key:"loadScriptIntoDom",value:function(e,t,r){var n=a.createElement("SCRIPT");n.src=e;var i=function(){n.onerror=null,n.onload=null};n.onload=function(){i(),t()},n.onerror=function(t){i(),r&&r(new Error("Error loading script ".concat(e,", with error ").concat(t)))},a.head.appendChild(n)}},{key:"loadScript",value:function(e,t){var r=this;if(t&&void 0!==o[t])return Promise.resolve();var i=(e=this.getResourceUrl(e)).toLowerCase();if(i in this.loadPromises)return this.loadPromises[i];var a=(0,n.getScript)(e);return this.loadPromises[i]=a?Promise.resolve():new Promise((function(t,n){r.loadScriptIntoDom(e,t,n)})),this.loadPromises[i]}},{key:"_getLink",value:function(e){for(var t=a.getElementsByTagName("link"),r=0,n=t.length;r<n;r++)if(t[r].href===e)return t[r];return null}}])&&i(t.prototype,r),s&&i(t,s),Object.defineProperty(t,"prototype",{writable:!1}),e}());function l(e,t,r,n){s.loadScript(t,e).then((function(){r&&r()})).catch((function(e){n&&n(e)}))}Object.freeze(s)},96546:(e,t,r)=>{"use strict";function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}r.r(t),r.d(t,{SearchManager:()=>T});var i=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.viewer=t}var t,r,i;return t=e,(r=[{key:"search",value:function(e){return new Promise((function(e,t){}))}},{key:"getProviderId",value:function(){return"Search Provider Id"}}])&&n(t.prototype,r),i&&n(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function s(e,t){return s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},s(e,t)}function l(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=c(e);if(t){var i=c(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return u(this,r)}}function u(e,t){if(t&&("object"===o(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function c(e){return c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},c(e)}var h=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&s(e,t)}(o,e);var t,r,n,i=l(o);function o(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),i.call(this,e)}return t=o,(r=[{key:"search",value:function(e){var t=this;return new Promise((function(r,n){var i=t.viewer.getVisibleModels(),o=[];0===i.length&&r(o);for(var a=function(t){var r=i[t],n=[],a=r.getInstanceTree();r.getObjectTree((function(t){t.enumNodeChildren(t.getRootId(),(function(t){var r=a&&a.getNodeName(t);r&&-1!==r.toLowerCase().indexOf(e)&&n.push(t)}),!0)})),o.push({ids:n,model:r})},s=0;s<i.length;s++)a(s);r(o)}))}},{key:"getProviderId",value:function(){return"ModelPartsSearchProvider"}}])&&a(t.prototype,r),n&&a(t,n),Object.defineProperty(t,"prototype",{writable:!1}),o}(i);function d(e){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d(e)}function f(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function p(e,t){return p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},p(e,t)}function m(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=v(e);if(t){var i=v(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return g(this,r)}}function g(e,t){if(t&&("object"===d(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function v(e){return v=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},v(e)}var y=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p(e,t)}(o,e);var t,r,n,i=m(o);function o(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),i.call(this,e)}return t=o,(r=[{key:"search",value:function(e){var t=this;return new Promise((function(r,n){var i=t.viewer.getVisibleModels(),o=[];0===i.length&&r(o);for(var a=function(t){var a=i[t];a.search(e,(function(e){o.push({ids:e,model:a}),o.length===i.length&&r(o)}),n)},s=0;s<i.length;s++)a(s)}))}},{key:"getProviderId",value:function(){return"PropertiesSearchProvider"}}])&&f(t.prototype,r),n&&f(t,n),Object.defineProperty(t,"prototype",{writable:!1}),o}(i);function b(e){return b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},b(e)}function x(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _(e,t){return _=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},_(e,t)}function E(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=A(e);if(t){var i=A(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return w(this,r)}}function w(e,t){if(t&&("object"===b(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function A(e){return A=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},A(e)}var S=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_(e,t)}(o,e);var t,r,n,i=E(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),t=i.call(this,e),e.loadExtension("Autodesk.StringExtractor"),t}return t=o,(r=[{key:"search",value:function(e){var t=this;return new Promise((function(r){t.viewer.getExtensionAsync("Autodesk.StringExtractor").then((function(n){return n.getDocumentStrings().then((function(n){for(var i=[],o=t.viewer.impl.get2DModels(),a=0;a<o.length;a++){var s=o[a].id,l=!o[a].isLeaflet(),u=n[s];if(u){var c=u.strings,h=t.searchStrings(c,e,s,l);i.push({modelId:s,searchResult:h})}}r(i)}))}))}))}},{key:"searchStrings",value:function(e,t,r,n){var i=[];if(n)for(var o=0;o<e.length;o++){for(var a=0,s=[];-1!==a;)-1!==(a=e[o].string.toLowerCase().indexOf(t,a))&&(s.push(a),a+=1);if(s.length>0){var l=this.splitOccurrences(e[o],s,t,r);i=i.concat(l)}}else for(var u=0;u<e.length;u++)-1!==e[u].string.toLowerCase().indexOf(t)&&i.push(e[u]);return i}},{key:"splitOccurrences",value:function(e,t,r,n){var i=this.viewer.impl.findModel(n),o=[],a=1/72,s=i.getData();function l(t,r){var n=e.stringCharWidths.slice(t,r);return n.length?n.reduce((function(e,t){return e+t})):0}if(i){var u=s.metadata.page_dimensions.page_units;a*=Autodesk.Viewing.Private.convertUnits(Autodesk.Viewing.Private.ModelUnits.INCH,u,1,1);for(var c=s.scaleX,h=(i.getData().scaleY||a)*e.stringHeight,d=0;d<t.length;d++){var f={string:r},p=l(0,t[d]),m=l(t[d],t[d]+r.length);if(e.stringWidth){var g=l(0,e.string.length),v=e.stringWidth/g*a;p*=v,m*=v}else p*=c,m*=c;var y=e.angle||0,b=Math.cos(y)*p,x=Math.sin(y)*p,_=e.stringPosition[0]+b,E=e.stringPosition[1]+x,w=_+m,A=E+h,S=new THREE.Vector2(_,E),M=new THREE.Vector2(w,A),T=new THREE.Box2(S,M);f.boundingBox=T,f.angle=e.angle,o.push(f)}}return o}},{key:"getProviderId",value:function(){return"TextSearchProvider"}}])&&x(t.prototype,r),n&&x(t,n),Object.defineProperty(t,"prototype",{writable:!1}),o}(i);function M(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var T=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.viewer=t,this.searchProviders=new Map}var t,r,n;return t=e,(r=[{key:"addSearchProvider",value:function(e){this.searchProviders.has(e)||this.searchProviders.set(e,new e(this.viewer))}},{key:"search",value:function(e){var t=this;return new Promise((function(r,n){var i=t.prepareSearchInput(e),o=[];t.searchProviders.forEach((function(e){var t=e.search(i),r=e.getProviderId();t.id=r,o.push(t)})),Promise.all(o).then((function(e){var t={};e.forEach((function(e,r){var n=o[r].id;t[n]=e})),r(t)})).catch(n)}))}},{key:"removeAllProviders",value:function(){this.searchProviders.clear()}},{key:"removeProvider",value:function(e){this.searchProviders.delete(e)}},{key:"prepareSearchInput",value:function(e){return e.toLowerCase()}}])&&M(t.prototype,r),n&&M(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}(),C=AutodeskNamespace("Autodesk.Viewing.Search");C.SearchManager=T,C.ModelPartsSearchProvider=h,C.PropertiesSearchProvider=y,C.TextSearchProvider=S},26099:(e,t,r)=>{"use strict";r.r(t),r.d(t,{DefaultHandler:()=>i});r(23909);var n=r(84998);function i(e,t,r){this.clickConfig=null,this.getNames=function(){return["default"]},this.getName=function(){return this.getNames()[0]},this.setClickBehavior=function(e){this.clickConfig=e},this.getClickBehavior=function(){return this.clickConfig},this.activate=function(e){},this.deactivate=function(e){},this.handleAction=function(t,n){for(var i=0;i<t.length;++i)switch(t[i]){case"selectOnly":e.selector&&n&&e.selector.setSelection([n.dbId],n.model);break;case"deselectAll":e.selector&&e.selector.setSelection([]);break;case"selectToggle":e.selector&&n&&e.selector.toggleSelection(n.dbId,n.model);break;case"isolate":n&&e.isolate(n.dbId);break;case"showAll":e.showAll();break;case"setCOI":n&&n.intersectPoint&&(r.setPivotPoint(n.intersectPoint,!0,!0),r.pivotActive(!0,!0));break;case"hide":n&&e.hide(n.dbId);break;case"show":n&&e.show(n.dbId);break;case"toggleVisibility":n&&e.toggleVisibility(n.dbId);break;case"focus":e.selector&&(n?e.selector.setSelection([n.dbId],n.model):e.selector.setSelection([]),r.fitToView())}},this.handleSingleClick=function(t,i){if((0,n.isMobileDevice)())return!1;var o=t.ctrlKey||t.metaKey,a=t.shiftKey,s=t.altKey;if(0===i){var l=e.clientToViewport(t.canvasX,t.canvasY),u="click";o&&(u+="Ctrl"),a&&(u+="Shift"),s&&(u+="Alt");var c=(h=e.hitTestViewport(l,!1))?"onObject":"offObject";if(this.clickConfig&&this.clickConfig[u]&&this.clickConfig[u][c])return this.handleAction(this.clickConfig[u][c],h),!0}else if(1===i&&a&&!s&&!o){var h;l=e.clientToViewport(t.canvasX,t.canvasY);if((h=e.hitTestViewport(l,!1))&&h.intersectPoint)return r.setPivotPoint(h.intersectPoint,!0,!0),r.pivotActive(!0,!0),!0}return!1},this.handleDoubleClick=function(n,i){if(e.selector&&0===i){var o=e.clientToViewport(n.canvasX,n.canvasY),a=e.hitTestViewport(o,!1);return a?e.selector.setSelection([a.dbId],a.model):e.selector.clearSelection(),r.fitToView(),!0}return 1===i&&(t.fitBounds(!1,r.getBoundingBox(!0)),t.setPivotSetFlag(!1),!0)},this.handleSingleTap=function(r){if(r.clientX=r.pointers[0].clientX,r.clientY=r.pointers[0].clientY,e.api.triggerSingleTapCallback(r),r.hasOwnProperty("pointers")&&2===r.pointers.length)return t.setRequestHomeView(!0),!0;if(e.selector&&!e.selector.selectionDisabled){var n=e.clientToViewport(r.canvasX,r.canvasY),i=e.hitTestViewport(n,!1);return i?(e.selector.setSelection([i.dbId],i.model),e.api.triggerSelectionChanged([i.dbId])):(e.selector.clearSelection(),e.api.triggerSelectionChanged(null)),!0}return!1},this.handleDoubleTap=function(t){t.clientX=t.pointers[0].clientX,t.clientY=t.pointers[0].clientY,e.api.triggerDoubleTapCallback(t);var n=this.handleSingleTap(t,0);return r.fitToView(),n},this.handlePressHold=function(t){return"press"===t.type&&(t.clientX=t.pointers[0].clientX,t.clientY=t.pointers[0].clientY,e.api.triggerContextMenu(t))},this.handleGesture=function(t){return!!t.type.includes("swipe")&&(t.clientX=t.pointers[0].clientX,t.clientY=t.pointers[0].clientY,e.api.triggerSwipeCallback(t))}}},49991:(e,t,r)=>{"use strict";r.r(t),r.d(t,{FovTool:()=>i});var n=r(23909);function i(e){var t=.001,r=e.navigation,i=r.getCamera(),o=["fov"],a=!1,s=0,l=null,u=null,c=!1,h=0,d=-5,f=-1,p=d,m=new n.Vector3,g=new n.Vector3,v=new n.Vector3,y=null;function b(e){return e<0&&e>-3?-3:e>0&&e<3?3:e}this.getNames=function(){return o},this.getName=function(){return o[0]},this.activate=function(e){h=0},this.deactivate=function(e){p=d},this.getCursor=function(){return 0!==h&&p===d?null:"url(data:image/x-icon;base64,AAACAAEAGBgAAAAAAACICQAAFgAAACgAAAAYAAAAMAAAAAEAIAAAAAAAYAkAABMLAAATCwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAlgAAAP8AAAD/AAAAlgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAACEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////////////AAAA/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAnAwMD/yEhIf8AAABmAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////////////AAAA/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAGknJyf/goKC/8/Pz/8aGhr/AAAALQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////////////AAAA/wAAAAAAAAAAAAAAAAAAAAAAAABTFBQU/2lpaf/MzMz///////////+Wlpb/AAAAlgAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAAAAAAAAAAAAAAAAlgAAAP8AAAD/AAAAlgAAAAAAAAAAAAAAOAAAAKFTU1P/t7e3////////////8PDw////////////AQEB/wAAAAEAAAAAAAAAFAAAAH0KCgr/AAAAYwAAAAAAAAAAAAAAlgAAAP8AAAD/AAAAlgAAAAAAAAAjCwsL/6Ghof/t7e3///////Dw8P9MTEz/LS0t//Pz8///////Ghoa/wAAABoAAAANDQ0N/319ff+rq6v/Y2Nj/wAAAK8AAABGAAAA////////////AAAA/wAAAF0hISH/jIyM////////////sLCw/xEREf8AAACHAAAArKysrP//////V1dX/wAAAFcAAABSUlJS//f39///////8PDw/6+vr/86Ojr/LS0t////////////FRUV/1xcXP/Gxsb/+Pj4//Hx8f9MTEz/AAAAsAAAAEcAAAAAAAAAZ2dnZ///////pKSk/wAAAKQAAACtra2t///////////////////////m5ub/kZGR/wAAAP8AAAD/q6ur//Hx8f//////vb29/x0dHf8AAACIAAAAAAAAAAAAAAAAAAAAOjo6Ov//////5+fn/wAAAOcAAADd3d3d////////////////////////////+/v7/9bW1v/i4uL//v7+//Pz8/9hYWH/AAAAvQAAAFQAAAAAAAAAAAAAAAAAAAAAAAAAJycnJ//6+vr//////wMDA/8AAADv7+/v/////////////////////////////////////////////////7y8vP8ODg7/AAAAKwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJiYmJv/6+vr//////wkJCf8AAADv7+/v//////////////////////////////////f39//9/f3//////+np6f+UlJT/GBgY/wAAAH0AAAACAAAAAAAAAAAAAAAAAAAAKSkpKf///////v7+/w0NDf8AAADd3d3d////////////////////////////29vb/39/f/+Xl5f/5+fn////////////5ubm/1RUVP8CAgL/AAAAPwAAAAAAAAAAAAAAOTk5Of//////8PDw/wgICP8AAAChoaGh/////////////////+np6f+YmJj/QkJC/wAAAP8AAAD/UFBQ/7e3t//39/f///////////+oqKj/EBAQ/wAAAIgAAAAAAAAAZ2dnZ///////29vb/wEBAf8AAAA4NTU1/9zc3P/t7e3/tbW1/01NTf8AAACYAAAA////////////AwMD/wsLC/9oaGj/y8vL////////////8fHx/zg4OP8AAACWAAAApaWlpf//////n5+f/wAAAJ8AAAAAAAAAczg4OP9LS0v/EhIS/wAAAE0AAAAAAAAA////////////FRUV/wAAABUAAABoJSUl/4GBgf/i4uL///////////9+fn7/Pz8///b29v//////SkpK/wAAAEoAAAAAAAAAAAAAADgAAABLAAAAEgAAAAAAAAAAAAAAlgAAAP8AAAD/AAAAlgAAAAAAAAAAAAAAJQAAAIE8PDz/np6e//z8/P/////////////////8/Pz/CQkJ/wAAAAkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAlgAAAP8AAAD/AAAAlgAAAAAAAAAAAAAAAAAAAAAAAAA8DAwM/09PT/+7u7v///////////+QkJD/AAAAkwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////////////Dw8P/wAAAA8AAAAAAAAAAAAAAAAAAAAAAAAADAAAAFIYGBj/aGho/729vf8WFhb/AAAAJwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////////////FRUV/wAAABUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYAQEB/w8PD/8AAABUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////////////DAwM/wAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAA8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAlgAAAP8AAAD/AAAAlgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///8x/h/nO/4fw1D+HwFy/h4BRu4YAHOGEABkAAAAXAAAIFwAAOBnAAHgIAAD4GUAAOB4AABgXAAAIGMAAABtggAAVMYYAHT+HgE7/g8BcP4Pw2/+D+dc/h//XP///2c=), auto"},this.getMotionDelta=function(e){var r=g.x-m.x,n=g.y-m.y,i=g.z-m.z;Math.abs(r)<t&&(r=0),Math.abs(n)<t&&(n=0),Math.abs(i)<t&&(i=0),e.set(r,n,i)},this.stepMotionDelta=function(e,t){t?(m.x+=.6*e.x,m.y+=.6*e.y,m.z+=.6*e.z):m.copy(g)},this.getAccumulatedWheelDelta=function(){var e=Date.now(),t=0;return u&&e-u>100?(t=b(s),s=0,l=null,u=null,c=!1):l&&e-l>100&&(c?Math.abs(s)>=3&&(t=s,s=0):(t=b(s),c=!0,s=0)),t},this.update=function(){var e=!1,t=p>d;if(p>d){this.controller.setIsLocked(!0),this.getMotionDelta(v);var n=v.x,o=v.y,s=v.z;if(0!==n||0!==o||0!==s)if(t=!0,p>=0)o=-o,0!==(s=Math.abs(n)>Math.abs(o)?n:o)&&(s*=-1,r.setVerticalFov(r.getVerticalFov()*(1+s),!0));else{var l=this.getAccumulatedWheelDelta()/3;0!==l&&r.setFocalLength(r.getFocalLength()+l,!0)}this.stepMotionDelta(v,!0),p===f&&Math.abs(s)<1e-5&&(this.interactionEnd(f),e=!0)}return t?this.utilities.pivotActive(r.getPivotSetFlag(),!0):this.utilities.pivotUpdate(),!a&&(e||p>d)&&(p>f&&m.copy(g),p=d,this.controller.setIsLocked(!1)),i.dirty},this.interactionStart=function(e,t){(t||e>p)&&(p=e,a=!0),r.toPerspective()},this.interactionEnd=function(e){e===p&&(e!==f&&this.utilities.pivotActive(!1),a=!1)},this.handleWheelInput=function(e){if(p>f)return!1;r.getReverseZoomDirection()&&(e*=-1),g.z+=e,s+=e;var t=Date.now();return l||(l=t),u=t,0!=e&&this.interactionStart(f),!0},this.handleGesture=function(e){switch(e.type){case"dragstart":return this.handleButtonDown(e,0);case"dragmove":return this.handleMouseMove(e);case"dragend":return this.handleButtonUp(e,0);case"drag3start":return y="drag",this.handleButtonDown(e,0);case"drag3move":return"drag"===y&&this.handleMouseMove(e);case"drag3end":return"drag"===y&&this.handleButtonUp(e,0),y=null,!1}return!1},this.handleButtonDown=function(e,t){return h+=1<<t,2!==t&&(m.x=.5*(e.normalizedX+1),m.y=1-.5*(e.normalizedY+1),g.copy(m),this.interactionStart(t),!0)},this.handleButtonUp=function(e,t){return h-=1<<t,2!==t&&(g.x=.5*(e.normalizedX+1),g.y=1-.5*(e.normalizedY+1),this.interactionEnd(t),!0)},this.handleMouseMove=function(e){return g.x=.5*(e.normalizedX+1),g.y=1-.5*(e.normalizedY+1),p>f},this.handleBlur=function(e){return this.interactionEnd(p),!1}}},33317:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GestureRecognizers:()=>o,GestureHandler:()=>a});var n,i=r(84998);(0,i.isNodeJS)()||(n=r(41145));var o={};function a(e){var t=e.navigation,r=["gestures"],a=this,s=!0,l=!1,u=!0,c=null,h=!1,d=(0,i.isTouchDevice)();t.setIsTouchDevice(d),d&&((c=new n.Manager(e.canvasWrap,{recognizers:[o.drag,o.doubletap,o.doubletap2,o.singletap,o.singletap2,o.press,o.drag3,o.swipe,o.pan,o.pinch,o.rotate],handlePointerEventMouse:!1,inputClass:i.isIE11?n.PointerEventInput:n.TouchInput})).get("pinch").recognizeWith([c.get("drag")]),e.canvasWrap.addEventListener("touchstart",this.onTouchStart,!1)),this.onTouchStart=function(e){e.preventDefault()},this.getNames=function(){return r},this.getName=function(){return r[0]},this.isActive=function(){return h},this.__clientToCanvasCoords=function(t){var r,n,i=e.impl.getCanvasBoundingClientRect(),o=i.width,a=i.height;t.hasOwnProperty("center")?(r=t.center.x-i.left,n=t.center.y-i.top):(r=t.pointers[0].clientX-i.left,n=t.pointers[0].clientY-i.top),t.canvasX=r,t.canvasY=n,t.normalizedX=r/o*2-1,t.normalizedY=(a-n)/a*2-1},this.distributeGesture=function(e){a.__clientToCanvasCoords(e),a.controller.distributeEvent("handleGesture",e)&&e.preventDefault()},this.onSingleTap=function(e){a.__clientToCanvasCoords(e),a.controller.distributeEvent("handleSingleTap",e)&&e.preventDefault()},this.onDoubleTap=function(e){a.__clientToCanvasCoords(e),a.controller.distributeEvent("handleDoubleTap",e)&&e.preventDefault()},this.onPressHold=function(e){a.__clientToCanvasCoords(e),a.controller.distributeEvent("handlePressHold",e)&&e.preventDefault()},this.onHammerInput=function(e){a.setMouseDisabledWhenTouching(e)},this.setMouseDisabledWhenTouching=function(e){e.isFirst&&!l?(s=a.controller.enableMouseButtons(!1),l=!0):e.isFinal&&setTimeout((function(){a.controller.enableMouseButtons(s),l=!1}),10)},this.activate=function(e){c&&!h&&(c.on("dragstart dragmove dragend",this.distributeGesture),c.on("singletap",this.onSingleTap),c.on("singletap2",this.onSingleTap),c.on("doubletap",this.onDoubleTap),c.on("doubletap2",this.onDoubleTap),c.on("press pressup",this.onPressHold),c.on("drag3start drag3move drag3end",this.distributeGesture),c.on("swipeleft swiperight swipeup swipedown",this.distributeGesture),u&&(c.on("panstart panmove panend",this.distributeGesture),c.on("pinchstart pinchmove pinchend",this.distributeGesture),c.on("rotatestart rotatemove rotateend",this.distributeGesture)),c.on("hammer.input",this.onHammerInput),c.get("doubletap2").recognizeWith("doubletap"),c.get("singletap2").recognizeWith("singletap"),c.get("singletap").requireFailure("doubletap"),c.get("swipe").recognizeWith("drag")),h=!0},this.deactivate=function(e){c&&h&&(c.off("dragstart dragmove dragend",this.distributeGesture),c.off("singletap",this.onSingleTap),c.off("singletap2",this.onSingleTap),c.off("doubletap",this.onDoubleTap),c.off("doubletap2",this.onDoubleTap),c.off("press pressup",this.onPressHold),c.off("drag3start drag3move drag3end",this.distributeGesture),c.off("swipeleft swiperight swipeup swipedown",this.distributeGesture),u&&(c.off("panstart panmove panend",this.distributeGesture),c.off("pinchstart pinchmove pinchend",this.distributeGesture),c.off("rotatestart rotatemove rotateend",this.distributeGesture)),c.off("hammer.input",this.onHammerInput)),h=!1},this.update=function(){return!1},this.handleBlur=function(e){return!1},this.disableTwoFingerSwipe=function(){u=!1,c&&(c.remove(n.Pan),c.remove(n.Pinch),c.remove(n.Rotate),c.off("panstart panmove panend",this.distributeGesture),c.off("pinchstart pinchmove pinchend",this.distributeGesture),c.off("rotatestart rotatemove rotateend",this.distributeGesture))},this.setGestureParameter=function(e,t,r){var n=c&&c.get(e);return!!n&&(n.options[t]=r,!0)},this.restoreGestureParameterDefault=function(e,t){var r=c&&c.get(e);if(!r)return!1;var n=o[e][1];return r.options[t]=n.hasOwnProperty(t)?n[t]:r.defaults[t],!0}}n&&function(){if(!o.singletap){var e=o;e.singletap=[n.Tap,{event:"singletap",threshold:7,time:400}],e.singletap2=[n.Tap,{event:"singletap2",pointers:2,threshold:7,time:400}],e.press=[n.Press,{event:"press",time:500,threshold:50}],e.doubletap=[n.Tap,{event:"doubletap",taps:2,interval:300,threshold:6,posThreshold:30}],e.doubletap2=[n.Tap,{event:"doubletap2",pointers:2,taps:2,interval:300,threshold:6,posThreshold:40}],e.swipe=[n.Swipe,{event:"swipe",pointers:1,threshold:200,velocity:1.7}],e.drag=[n.Pan,{event:"drag",pointers:1}],e.drag3=[n.Pan,{event:"drag3",pointers:3,threshold:15}],e.pan=[n.Pan,{event:"pan",pointers:2,threshold:20}],e.pinch=[n.Pinch,{event:"pinch",pointers:2,enable:!0,threshold:.05}],e.rotate=[n.Rotate,{event:"rotate",pointers:2,enable:!0,threshold:7}]}}()},42024:(e,t,r)=>{"use strict";function n(e){var t=["hottouch"],r={SHIFT:0,ALT:0,CONTROL:0},n=null,i=null,o=!1,a=!1,s=null,l=16,u=17,c=18;this.active=!1,this.getNames=function(){return t},this.getName=function(){return t[0]},this.activate=function(e){this.active=!0},this.deactivate=function(e){this.active=!1},this.isActive=function(){return this.active},this.__checkStart=function(){s&&(this.controller.distributeEvent("handleGesture",s),s=null)},this.update=function(){if(this.controller.getIsLocked())return!1;var t=e.getActiveNavigationTool(),r=!1===o&&!0===a;if(r||!0===o&&!1===a){var s=r?"worldup":"fov";if(t===s)return!1;if(t===n)return e.setActiveNavigationTool(s),n=s,this.__checkStart(),!1;i=t,e.setActiveNavigationTool(s),n=s,this.__checkStart()}else n&&(e.setActiveNavigationTool(i),n=null,i=null);return!1},this.resetKeys=function(){r.SHIFT=0,r.CONTROL=0,r.ALT=0},this.updateModifierState=function(e){r.CONTROL=e.ctrlKey?1:0,r.SHIFT=e.shiftKey?1:0,r.ALT=e.altKey?1:0},this.handleGesture=function(t){if(t===s)return!1;switch(t.type){case"drag3start":e.navigation.isActionEnabled("fov")&&(s=t,o=!0);break;case"drag3move":case"rotatemove":break;case"drag3end":o=!1;break;case"rotatestart":e.navigation.isActionEnabled("roll")&&(s=t,a=!0);break;case"rotateend":a=!1}return!1},this.handleKeyDown=function(e,t){switch(this.updateModifierState(e),t){case l:r.SHIFT=1;break;case u:r.CONTROL=1;break;case c:r.ALT=1}return!1},this.handleKeyUp=function(e,t){switch(this.updateModifierState(e),t){case l:r.SHIFT=0;break;case u:r.CONTROL=0;break;case c:r.ALT=0}return!1},this.handleButtonDown=function(e,t){return this.updateModifierState(e),!1},this.handleButtonUp=function(e,t){return this.updateModifierState(e),!1},this.handleMouseMove=function(e){return this.updateModifierState(e),!1},this.handleBlur=function(e){return this.resetKeys(),!1}}r.r(t),r.d(t,{HotGestureTool:()=>n})},3260:(e,t,r)=>{"use strict";function n(){var e=[],t=[],r=[],n=[],i=["hotkeys"];function o(e,t){return e-t}function a(){var e,i=t.join();for(e=0;e<n.length;)n[e].keys===i?n.splice(e,1):e++;for(e=0;e<r.length;)r[e].keys!==i?r.splice(e,1):e++}function s(i,o){var s=t.join(),l=t.slice(0),u=t.indexOf(o);u>-1&&t.splice(u,1);var c=t.join(),h=t.slice(0);a();var d,f=[],p=[];for(u=e.length-1;u>=0;u--)(d=e[u]).keys===s&&d.onRelease?f.unshift(d):d.keys===c&&d.onPress&&p.unshift(d);for(u=f.length-1;u>=0&&!(d=f[u]).onRelease(l);u--)d.options.tryUntilSuccess&&n.unshift(d);for(u=p.length-1;u>=0&&!(d=p[u]).onPress(h);u--)d.options.tryUntilSuccess&&r.unshift(d)}return{pushHotkeys:function(t,r,n){if(e.some((function(e){return e.id===t})))return!1;for(var i=0;i<r.length;i++)e.push({id:t,keys:r[i].keycodes.sort(o).join(),onPress:r[i].onPress,onRelease:r[i].onRelease,options:n||{}});return!0},popHotkeys:function(t){for(var r=!1,n=e.length-1;n>=0;n--)e[n].id===t&&(e.splice(n,1),r=!0);return r},handleKeyDown:function(i,o){if(-1===t.indexOf(o)){for(var s=t.join(),l=t.slice(0),u=0;u<t.length&&t[u]<o;)u++;t.splice(u,0,o);var c=t.join(),h=t.slice(0);a();var d,f=[],p=[];for(u=e.length-1;u>=0;u--)(d=e[u]).keys===s&&d.onRelease?f.unshift(d):d.keys===c&&d.onPress&&p.unshift(d);for(u=f.length-1;u>=0&&!(d=f[u]).onRelease(l);u--)d.options.tryUntilSuccess&&n.unshift(d);for(u=p.length-1;u>=0&&!(d=p[u]).onPress(h);u--)d.options.tryUntilSuccess&&r.unshift(d)}},handleKeyUp:s,handleBlur:function(){for(var e=t.length-1;e>=0;e--)s(0,t[e])},getName:function(){return i[0]},getNames:function(){return i},activate:function(){},deactivate:function(){},update:function(){var e,t;for(t=0;t<n.length;)!0===(e=n[t]).onRelease(e.keys.split())?n.splice(t,1):t++;for(t=0;t<r.length;)!0===(e=r[t]).onPress(e.keys.split())?r.splice(t,1):t++;return!1}}}r.r(t),r.d(t,{HotkeyManager:()=>n})},9487:(e,t,r)=>{"use strict";r.r(t),r.d(t,{KeyCode:()=>n});var n={BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CONTROL:17,ALT:18,ESCAPE:27,SPACE:32,PAGEUP:33,PAGEDOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,INSERT:45,DELETE:46,ZERO:48,SEMICOLONMOZ:59,EQUALSMOZ:61,a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90,LCOMMAND:91,RCOMMAND:93,PLUS:107,PLUSMOZ:171,DASHMOZ:109,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,DASHMOZNEW:173,SEMICOLON:186,EQUALS:187,COMMA:188,DASH:189,PERIOD:190,SLASH:191,LBRACKET:219,RBRACKET:221,SINGLEQUOTE:222,COMMANDMOZ:224}},10831:(e,t,r)=>{"use strict";r.r(t),r.d(t,{Navigation:()=>s});var n=r(23909),i=r(98926),o=r(62546),a={TRANSITION_ACTIVE_FLAG_CHANGED:"transitionActiveFlagChanged"};function s(e){var t=6.88,r=1e-6;this.__options={dollyToPivot:!1,orbitPastPoles:!0,reverseDolly:!1,reverseHorizontalLook:!1,reverseVerticalLook:!1,useLeftHandedInput:!1,usePivotAlways:!1,lockNavigation:!1},this.__lockSettings={orbit:!1,pan:!1,zoom:!1,roll:!1,fov:!1,gotoview:!1,walk:!1},this.FIT_TO_VIEW_VERTICAL_MARGIN=.05,this.FIT_TO_VIEW_VERTICAL_OFFSET=0,this.FIT_TO_VIEW_HORIZONTAL_MARGIN=.05,this.FIT_TO_VIEW_HORIZONTAL_OFFSET=0,this.__pivotIsSetFlag=!1,this.__fitToViewRequested=!1,this.__homeViewRequested=!1,this.__transitionActive=!1,this.__destinationView=null,this.__is2D=!1,this.__isTouchDevice=!1,this.__kEpsilon=r,this.__minDistance=1e-5;var i=void 0,o=void 0,a=2,s=200,l=null,u={left:0,top:0,width:1,height:1},c=Number.MAX_VALUE;this.uninitialize=function(){this.setCamera(null)},this.setMinimumLineWidth=function(e){c=e||Number.MAX_VALUE},this.setCamera=function(e){e!==l&&(l=e,e&&(Object.prototype.hasOwnProperty.call(e,"target")||(e.target=new n.Vector3(0,0,0)),Object.prototype.hasOwnProperty.call(e,"pivot")||(e.pivot=new n.Vector3(0,0,0)),e.worldup=e.up.clone(),e.dirty=!0))},this.getCamera=function(){return l},this.setScreenViewport=function(e){u=e},this.getScreenViewport=function(){return u},this.__setUp=function(e){if(e&&l&&0!==e.clone().normalize().sub(l.worldup).lengthSq())return l.worldup.copy(e).normalize(),l.dirty=!0,!0;return!1},this.__getUp=function(){return l?l.worldup:new n.Vector3(0,1,0)},this.setView=function(e,t){l&&e&&t&&(l.position.copy(e),l.target.copy(t),l.dirty=!0)},this.orientCameraUp=function(e){l&&(this.isActionEnabled("roll")||e)&&(l.up.copy(this.getAlignedUpVector()),l.dirty=!0)},this.getPivotPoint=function(){return l?l.pivot.clone():new n.Vector3(0,0,0)},this.setPivotPoint=function(e){l&&e&&l.pivot.copy(e)},this.getPosition=function(){return l?l.position.clone():new n.Vector3(0,0,1)},this.setPosition=function(e){l&&e&&(l.position.copy(e),l.dirty=!0)},this.setTarget=function(e){l&&e&&(l.target.copy(e),l.dirty=!0)},this.getTarget=function(){return l?l.target.clone():new n.Vector3(0,0,0)},this.getEyeVector=function(){return l?l.target.clone().sub(l.position):new n.Vector3(0,0,-1)},this.getEyeToCenterOfBoundsVec=function(e){return l?e.getCenter(new n.Vector3).sub(l.position):new n.Vector3(0,0,-1)},this.getFovMin=function(){return t},this.getFovMax=function(){return 100},this.setZoomInLimitFactor=function(e){s=e},this.getZoomInLimitFactor=function(){return s},this.setZoomOutLimitFactor=function(e){a=e},this.getZoomOutLimitFactor=function(){return a},this.isPointVisible=function(e){return(new n.Frustum).setFromProjectionMatrix(l.projectionMatrix.clone().multiply(l.matrixWorldInverse)).containsPoint(e)},this.setVerticalFov=function(e,i){if((!l||l.isPerspective)&&(e<t?e=t:e>100&&(e=100),l&&this.isActionEnabled("fov"))){if(Math.abs(l.fov-e)<=r)return;if(i){var o=this.__pivotIsSetFlag&&this.isPointVisible(this.getPivotPoint()),a=this.getPosition(),s=this.getEyeVector(),u=n.Math.degToRad(l.fov),c=n.Math.degToRad(e),h=o?this.getPivotPlaneDistance():s.length(),d=h*Math.tan(.5*u)/Math.tan(.5*c),f=s.normalize().multiplyScalar(h-d);this.setPosition(a.add(f)),o&&this.setTarget(this.getTarget().add(f))}l.setFov(e),l.dirty=!0}},this.applyRotation=function(e,t,r,n){e.sub(r),e.applyAxisAngle(n,t),e.add(r)},this.getSignedAngle=function(e,t,r){var n=e.angleTo(t),i=e.clone().cross(t).normalize();return n*(r.dot(i)>0?1:-1)},this.computeFit=function(t,r,i,o,a){if(!o||o.isEmpty())return{position:t,target:r};a=void 0===a?1:a;for(var s=o.getCenter(new n.Vector3),l=o.getSize(new n.Vector3),u=t.clone().sub(r).normalize(),c=Math.tan(n.Math.degToRad(.5*i)),h=0,d=this.computeOrthogonalUp(t,r),f=u.clone().cross(d).normalize(),p=new n.Vector3,m=0===l.z?4:8,g=0;g<m;g++){p.set(0==(1&g)?-.5*l.x:.5*l.x,0==(2&g)?-.5*l.y:.5*l.y,0==(4&g)?-.5*l.z:.5*l.z);var v=0;e.isPerspective&&(v=p.dot(u));var y=Math.abs(p.dot(d)),b=Math.abs(p.dot(f)),x=v+(1+2*this.FIT_TO_VIEW_VERTICAL_MARGIN/(1-2*this.FIT_TO_VIEW_VERTICAL_MARGIN))*y/c;h<x&&(h=x),h<(x=v+(1+2*this.FIT_TO_VIEW_HORIZONTAL_MARGIN/(1-2*this.FIT_TO_VIEW_HORIZONTAL_MARGIN))*b/(a*c))&&(h=x)}return s.add(d.multiplyScalar(-h*this.FIT_TO_VIEW_VERTICAL_OFFSET)),s.add(f.multiplyScalar(h*this.FIT_TO_VIEW_HORIZONTAL_OFFSET)),u.multiplyScalar(h),{position:s.clone().add(u),target:s}},this.computeOrthogonalUp=function(e,t){var r=this.__getUp(),n=t.clone().sub(e);if(0===n.lengthSq())return n.copy(r);var i=n.clone().cross(r);return 0===i.lengthSq()&&(r.z>r.y?n.y-=1e-4:n.z-=1e-4,i.crossVectors(n,r)),i.cross(n).normalize()},this.fitBounds=function(e,t,r,n){var i=this.getTarget(),o=this.getPosition();if(!this.isActionEnabled("gotoview")&&!n||!t||t.isEmpty())return{position:o,target:i};var a=this.getVerticalFov();r||(t=this.rotateBoundsToCamera(t,o,i));var s=this.computeFit(o,i,a,t,l.aspect),u=r?this.computeOrthogonalUp(o,i):l.up;return e?(l.up.copy(u),this.setView(s.position,s.target)):this.setRequestTransitionWithUp(!0,s.position,s.target,a,u),this.setPivotPoint(s.target),this.setPivotSetFlag(!0),s},this.rotateBoundsToCamera=function(e,t,r){var i=(e=e.clone()).getCenter(new n.Vector3),o=t.clone().sub(r).normalize(),a=this.getSignedAngle(this.getCameraUpVector(),this.getAlignedUpVector(),o);return this.applyRotation(e.min,a,i,o),this.applyRotation(e.max,a,i,o),e.setFromPoints([e.min.clone(),e.max.clone()]),e},this.computeOverviewDistance=function(e){var t=e.getSize(new n.Vector3);if(this.__is2D){var r=l.aspect,i=t.x/r,o=t.y;return Math.max(i,o)}var a=this.getVerticalFov(),s=t.length();return 0===s&&(s=2),l.isPerspective?.5*s/Math.tan(n.Math.degToRad(.5*a)):s},this.applyDollyConstraint=function(e,t){if(!(i||o||a)||!this.__is2D)return e;var r=e;if(i&&a&&t&&e>1){var n,u=l.isPerspective?this.getEyeToCenterOfBoundsVec(t):this.getEyeVector();n=i?a*this.computeOverviewDistance(i):a*this.computeOverviewDistance(t);var h=Math.abs(n/u.length());h=Math.max(h,1),r=Math.min(r,h)}if(o||s&&t){var d=(o?l.clientHeight/o:Math.min(c,this.computeOverviewDistance(t)/s))/-this.getEyeVector().z;d=Math.min(d,1),r=Math.max(r,d)}return r},this.applyPanningConstraint2D=function(e){if(this.__is2D&&i){var t=l.position.x+e.x,r=l.position.y+e.y;t=n.Math.clamp(t,i.min.x,i.max.x),r=n.Math.clamp(r,i.min.y,i.max.y);var o=t-l.position.x,a=r-l.position.y,s=Math.min(e.x,0),u=Math.min(e.y,0),c=Math.max(e.x,0),h=Math.max(e.y,0);o=n.Math.clamp(o,s,c),a=n.Math.clamp(a,u,h),e.x=o,e.y=a}},this.updateCamera=function(){l&&(l.updateProjectionMatrix(),this.orient(l,l.target,l.position,l.up),l.dirty=!1)},this.setCamera(e),this.setConstraints2D=function(e,t){i=e,o=t},this.getConstrains2D=function(){return{maxViewRegion:i,maxPixelPerUnit:o}}}s.prototype.constructor=s,s.prototype.setIs2D=function(e){this.__is2D=!!e},s.prototype.getIs2D=function(){return this.__is2D},s.prototype.setIsTouchDevice=function(e){this.__isTouchDevice=!!e},s.prototype.getIsTouchDevice=function(){return this.__isTouchDevice},s.prototype.orient=function(){var e,t,r,i;return function(o,a,s,l){e||(e=new n.Matrix4,t=new n.Vector3,r=new n.Vector3,i=new n.Vector3);var u=e.elements;i.subVectors(s,a).normalize(),0===i.lengthSq()&&(i.z=1),t.crossVectors(l,i).normalize(),0===t.lengthSq()&&(l.z>l.y?i.y-=1e-4:i.z+=1e-4,t.crossVectors(l,i).normalize()),r.crossVectors(i,t),u[0]=t.x,u[4]=r.x,u[8]=i.x,u[1]=t.y,u[5]=r.y,u[9]=i.y,u[2]=t.z,u[6]=r.z,u[10]=i.z,o.setRotationFromMatrix(e)}}(),s.prototype.fov2fl=function(e){var t=n.Math.degToRad(e);return t<=0&&(t=1e-4),Math.round(12/Math.tan(.5*t))},s.prototype.fl2fov=function(e){e<=0&&(e=1e-4);var t=2*Math.atan(12/e);return n.Math.radToDeg(t)},s.prototype.setCameraUpVector=function(e,t){if(this.isActionEnabled("roll")||t){var r=this.getCamera();r.up.copy(e),r.dirty=!0}},s.prototype.getCameraUpVector=function(){var e=this.getCameraRightVector(!1),t=this.getEyeVector();return e.cross(t).normalize()},s.prototype.getAlignedUpVector=function(){var e=this.getCameraRightVector(!0),t=this.getEyeVector();return e.cross(t).normalize()},s.prototype.getCameraRightVector=function(e){var t=new n.Vector3,r=e?this.getWorldUpVector():this.getCamera().up,i=this.getEyeVector();return t.crossVectors(i,r),0===t.lengthSq()&&(Math.abs(i.z)>=Math.abs(i.y)?r.set(0,1,0):r.set(0,0,1),t.crossVectors(i,r)),t.normalize()},s.prototype.setWorldUpVector=function(e,t,r){(this.isActionEnabled("roll")||r)&&(this.__setUp(e),t&&this.orientCameraUp(r))},s.prototype.getWorldUpVector=function(){return this.__getUp().clone()},s.prototype.getWorldRightVector=function(){var e=new n.Vector3;return e.copy(this.__getUp()),Math.abs(e.z)<=Math.abs(e.y)?e.set(e.y,-e.x,0):e.z>=0?e.set(e.z,0,-e.x):e.set(-e.z,0,e.x),e.normalize()},s.prototype.getVerticalFov=function(){return this.getCamera().fov},s.prototype.getHorizontalFov=function(){var e=this.getScreenViewport();return this.getCamera().fov*(e.width/e.height)},s.prototype.getFocalLength=function(){return this.fov2fl(this.getVerticalFov())},s.prototype.setFocalLength=function(e,t){this.setVerticalFov(this.fl2fov(e),t)},s.prototype.setReverseZoomDirection=function(e){this.__options.reverseDolly=!!e},s.prototype.setReverseHorizontalLookDirection=function(e){this.getIs2D()?i.logger.warn("Autodesk.Viewing.Navigation.setReverseHorizontalLookDirection is not applicable to 2D"):this.__options.reverseHorizontalLookDirection=!!e},s.prototype.setReverseVerticalLookDirection=function(e){this.getIs2D()?i.logger.warn("Autodesk.Viewing.Navigation.setReverseVerticalLookDirection is not applicable to 2D"):this.__options.reverseVerticalLookDirection=!!e},s.prototype.getReverseZoomDirection=function(){return this.__options.reverseDolly},s.prototype.getReverseHorizontalLookDirection=function(){return this.getIs2D()?(i.logger.warn("Autodesk.Viewing.Navigation.getReverseHorizontalLookDirection is not applicable to 2D"),!1):this.__options.reverseHorizontalLookDirection},s.prototype.getReverseVerticalLookDirection=function(){return this.getIs2D()?(i.logger.warn("Autodesk.Viewing.Navigation.getReverseVerticalLookDirection is not applicable to 2D"),!1):this.__options.reverseVerticalLookDirection},s.prototype.setZoomTowardsPivot=function(e){this.__options.dollyToPivot=!!e},s.prototype.getZoomTowardsPivot=function(){return this.__options.dollyToPivot},s.prototype.setOrbitPastWorldPoles=function(e){this.getIs2D()?i.logger.warn("Autodesk.Viewing.Navigation.setOrbitPastWorldPoles is not applicable to 2D"):this.__options.orbitPastPoles=!!e},s.prototype.getOrbitPastWorldPoles=function(){return this.getIs2D()?(i.logger.warn("Autodesk.Viewing.Navigation.orbitPastWorldPoles is not applicable to 2D"),!1):this.__options.orbitPastPoles},s.prototype.setUsePivotAlways=function(e){this.__options.usePivotAlways=!!e},s.prototype.getUsePivotAlways=function(){return this.__options.usePivotAlways},s.prototype.setUseLeftHandedInput=function(e){this.__options.useLeftHandedInput=!!e},s.prototype.getUseLeftHandedInput=function(){return this.__options.useLeftHandedInput},s.prototype.setWheelSetsPivot=function(e){this.__options.wheelSetsPivot=!!e},s.prototype.getWheelSetsPivot=function(){return this.__options.wheelSetsPivot},s.prototype.setSelectionSetsPivot=function(e){this.__options.SelectionSetsPivot=!!e},s.prototype.getSelectionSetsPivot=function(){return this.__options.SelectionSetsPivot},s.prototype.setIsLocked=function(e){this.__options.lockNavigation=!!e},s.prototype.getIsLocked=function(){return this.__options.lockNavigation},s.prototype.setLockSettings=function(e){for(var t in this.__lockSettings)Object.prototype.hasOwnProperty.call(e,t)&&(this.__lockSettings[t]=e[t])},s.prototype.getLockSettings=function(){var e={};for(var t in this.__lockSettings)e[t]=this.__lockSettings[t];return e},s.prototype.isActionEnabled=function(e){return!this.__options.lockNavigation||!0===this.__lockSettings[e]},s.prototype.setPivotSetFlag=function(e){this.__pivotIsSetFlag=!!e},s.prototype.getPivotSetFlag=function(){return this.__pivotIsSetFlag},s.prototype.setRequestFitToView=function(e){this.isActionEnabled("gotoview")&&(this.__fitToViewRequested=!!e)},s.prototype.getRequestFitToView=function(){return this.__fitToViewRequested},s.prototype.setRequestHomeView=function(e){this.isActionEnabled("gotoview")&&(this.__homeViewRequested=!!e)},s.prototype.getRequestHomeView=function(){return this.__homeViewRequested},s.prototype.setRequestTransition=function(e,t,r,n,i,o){this.__destinationView=e?{position:t.clone(),coi:r.clone(),fov:n,up:this.getCamera().up.clone(),worldUp:this.getWorldUpVector(),reorient:i,pivot:o?o.clone():r.clone()}:null},s.prototype.setRequestTransitionWithUp=function(e,t,r,n,i,o,a){this.__destinationView=e?{position:t.clone(),coi:r.clone(),fov:n,up:i.clone(),worldUp:o||this.getWorldUpVector(),reorient:!1,pivot:a?a.clone():r.clone()}:null},s.prototype.getRequestTransition=function(){return this.__destinationView},s.prototype.setTransitionActive=function(e){var t=this.__transitionActive!=e;this.__transitionActive=!!e,t&&this.fireEvent({type:a.TRANSITION_ACTIVE_FLAG_CHANGED,transitionActive:!!e})},s.prototype.getTransitionActive=function(){return this.__transitionActive},s.prototype.getWorldSize=function(e){var t=this.getCamera(),r=t.aspect,i=2*e*Math.tan(n.Math.degToRad(.5*t.fov)),o=i*r;return new n.Vector2(o,i)},s.prototype.screenToViewport=function(e,t){return e=2*e-1,t=2*(t=1-t)-1,new n.Vector3(e,t,1)},s.prototype.viewportToScreen=function(e,t){return e=(e+1)/2,t=1-(t=(t+1)/2),new n.Vector2(e,t)},s.prototype.getWorldPoint=function(e,t){var r=this.screenToViewport(e,t);e=r.x,t=r.y;var i,o=this.getCamera();o.isPerspective&&(i=(i=new n.Vector3(e,t,1)).unproject(o));var a,s,l=this.getEyeVector(),u=this.getPosition();if(!o.isPerspective||isNaN(i.x)){var c=this.getWorldSize(l.length()),h=this.getCameraRightVector(!1).multiplyScalar(.5*e*c.x),d=this.getCameraUpVector().multiplyScalar(.5*t*c.y);a=l.clone().add(h).add(d).normalize()}else a=i.sub(u).normalize();var f=this.getPivotPoint(),p=a.dot(l);return s=this.__pivotIsSetFlag&&(this.getIs2D()||o.isPerspective&&p>0)?0!==p?Math.abs(f.sub(u).dot(l))/p:f.sub(u).length():o.isPerspective?.5*(o.near+o.far):o.orthoScale,a.multiplyScalar(s).add(u)},s.prototype.getPivotPlaneDistance=function(){var e=this.getPivotPoint(),t=this.getEyeVector(),r=this.getPosition();return e.sub(r).dot(t.normalize())},s.prototype.panRelative=function(e,t,r){if(this.isActionEnabled("pan")){var n=this.getScreenViewport(),i=this.getCamera(),o=this.getWorldSize(r),a=e*o.x*n.width/i.clientWidth,s=t*o.y*n.height/i.clientHeight,l=this.getCameraRightVector(!1).multiplyScalar(a),u=this.getCameraUpVector().multiplyScalar(s),c=l.add(u);this.applyPanningConstraint2D(c),this.setView(this.getPosition().add(c),this.getTarget().add(c))}},s.prototype.dollyFromPoint=function(e,t,r){if(this.isActionEnabled("zoom")&&!(Math.abs(e)<=this.__kEpsilon)){var n=this.getPosition(),i=this.getEyeVector();if(!this.getCamera().isPerspective){var o=i.lengthSq(),a=i.dot(this.getTarget().sub(t));t=i.clone().multiplyScalar(a/o).add(t)}var s=t.clone().sub(n),l=s.length(),u=l+e;u<this.__minDistance&&(u=this.__minDistance);var c=u/l;if(c=this.applyDollyConstraint(c,r),Math.abs(c-1)>this.__kEpsilon){s.multiplyScalar(c),s.set(-s.x,-s.y,-s.z);var h=s.add(t);i=this.getEyeVector(),this.getCamera().isPerspective||i.multiplyScalar(c),this.setView(h,i.add(h))}}},s.prototype.toPerspective=function(){if(this.getIs2D())i.logger.warn("Autodesk.Viewing.Navigation.toPerspective is not applicable to 2D");else{var e=this.getCamera();e.isPerspective||(e.toPerspective(),e.dirty=!0)}},s.prototype.toOrthographic=function(){var e=this.getCamera();e.isPerspective&&(e.toOrthographic(),e.dirty=!0)},s.snapToAxis=function(e){var t=new n.Vector3(Math.abs(e.x),Math.abs(e.y),Math.abs(e.z));return t.x>t.y&&t.x>t.z?e.set(e.x>0?1:-1,0,0):t.y>t.x&&t.y>t.z?e.set(0,e.y>0?1:-1,0):e.set(0,0,e.z>0?1:-1),e},o.EventDispatcher.prototype.apply(s.prototype),s.Events=a},80401:(e,t,r)=>{"use strict";r.r(t),r.d(t,{OrbitDollyPanTool:()=>a});var n=r(37169),i=r(35449),o=r(55412);function a(e,t,r){var i=this;this.setGlobalManager(t.globalManager);var a,s,l=this,u=.001,c=.01,h=r&&r.hasOwnProperty("dollyDragScale")?r.dollyDragScale:100,d=-1!=navigator.userAgent.search("Mac OS"),f=r&&r.disablePinchRotation,p=t.navigation,m=p.getCamera(),g=["orbit","freeorbit","dolly","pan"],v=g[0],y=[v],b=v,x=null,_=1,E=0,w=0,A=0,S=0,M=!0,T=!1,C=null,P=!1,D=33,L=34,R=37,I=38,O=39,N=40,k=48,F=187,V=189,U=-4,B=-1,z=-5,G=new THREE.Vector3,H=new THREE.Vector3,W=new THREE.Vector2,j=new THREE.Vector2,q=new THREE.Vector2,X=new THREE.Vector2,Y=new THREE.Vector3,K=new THREE.Vector3,Z=new THREE.Vector3,Q=new THREE.Vector3,J=new THREE.Vector3,$=new THREE.Vector3,ee=new THREE.Vector3,te=new THREE.Vector3,re=new THREE.Vector3,ne=new THREE.Quaternion,ie=new THREE.Plane,oe=[!1,!1,!1,!1,!1,!1],ae={SHIFT:0,ALT:0,CONTROL:0,SPACE:0};this.active=!1;var se,le=function(t){e.renderer().rolloverObjectId(0,null,0)},ue=.01,ce=r&&r.hasOwnProperty("dollyScrollScale")?r.dollyScrollScale:.6,he=1,de=5,fe=.025;function pe(e,t){var r=l.getWindow(),n=0,i=0,o=r.innerWidth,a=r.innerHeight;te.set((e-.5*o-n)/(.5*o),(.5*a+i-t)/(.5*a),0);var s=te.length();return s>1?te.normalize():te.z=Math.sqrt(1-s*s),Q.copy(m.position).sub(m.pivot),$.copy(m.up).setLength(te.y),$.add(ee.copy(m.up).cross(Q).setLength(te.x)),$.add(Q.setLength(te.z)),$}this.getNames=function(){return g},this.getName=function(){return g[0]},this.activate=function(r){this.active=!0,y.push(r),b=r,M=t.prefs.get(o.Prefs3D.ENABLE_CUSTOM_ORBIT_TOOL_CURSOR),t.prefs.addListeners(o.Prefs3D.ENABLE_CUSTOM_ORBIT_TOOL_CURSOR,this._onPrefCursor),e.canvas.addEventListener("mouseout",le),t.addEventListener(n.ESCAPE_EVENT,this.handleBlur)},this.deactivate=function(r){this.active=!1,t.prefs.removeListeners(o.Prefs3D.ENABLE_CUSTOM_ORBIT_TOOL_CURSOR,this._onPrefCursor);var i=y.length-1;i>0&&y[i]===r&&(y.pop(),b=y[i-1]),e.canvas.removeEventListener("mouseout",le),t.removeEventListener(n.ESCAPE_EVENT,this.handleBlur)},this.isActive=function(){return this.active},this.adjustDollyLookSpeed=function(e){0===e?(fe=.025,de=5):((fe*=e>0?1.1:.9)<1e-6&&(fe=1e-6),(de*=e>0?1.1:.9)<1e-6&&(de=1e-6))},this.getDollySpeed=function(e,t){var r;if(!p.getZoomTowardsPivot()&&!p.getWheelSetsPivot()||m.isPerspective||p.getIs2D()){var n=p.getEyeVector(),i=p.getPosition();o=e.clone().sub(i).dot(n.normalize())*fe;r=Math.abs(o)<ue?o<0?-.01:ue:o}else{var o=m.orthoScale*fe;r=Math.abs(o)<5e-4&&t?0:o}return r},this.setPivotPointFromInput=function(t,r){if(!p.getIs2D()&&p.getWheelSetsPivot()){var n=e.hitTest(t,r,!0);if(n&&n.intersectPoint)this.utilities.setPivotPoint(n.intersectPoint,!0,!0);else{var i=p.getPivotPoint(),o=p.getEyeVector().normalize(),a=-i.dot(o);ie.set(o,a);var s=e.viewportToRay(e.clientToViewport(t,r)).intersectPlane(ie);this.utilities.setPivotPoint(s,!0,!0)}}},this.getDollyScrollScale=function(){return ce},this.setDollyScrollScale=function(e){ce=e},this.getDollyDragScale=function(){return h},this.setDollyDragScale=function(e){h=e},this.getLookSpeed=function(){return de},this.coiIsActive=function(){return p.getPivotSetFlag()&&p.isPointVisible(p.getPivotPoint())},this.adjustSpeed=function(e){this.adjustDollyLookSpeed(e),this.utilities.autocam&&(this.utilities.autocam.orbitMultiplier=this.getLookSpeed())},this.getTriggeredMode=function(){return 1===z&&ae.SHIFT?y[1]:(e=ae,2===z&&e.SHIFT&&!e.ALT&&!e.CONTROL||2===z&&e.ALT&&!e.SHIFT&&!e.CONTROL||"dolly"===b&&!e.ALT&&"pinch"!==x||0!==Y.z?function(){var e=ae;return!(e.CONTROL||e.ALT||e.SHIFT||2!==z&&1!==z)}()?"pan":"dolly":function(){var e=ae;return 2===z&&!e.SHIFT&&!(e.ALT^e.CONTROL)||2===z&&e.SHIFT&&e.CONTROL||1===z&&!e.SHIFT&&!e.CONTROL||1===z&&e.ALT||1===z&&e.CONTROL&&!e.ALT||0===z&&e.SHIFT&&!e.CONTROL&&!e.ALT||"pan"===b&&1!==z&&!e.ALT&&!("pinch"===x)||e.SPACE}()?"pan":"pan"===x||"pinch"===x?"dollypan":b);var e},this.initTracking=function(e,t){var r;if(m.isPerspective){r=.5*(m.near+m.far);var n=this.utilities.getHitPoint(e,t),i=p.getPosition();if(n&&n.sub){var o=n.sub(i),a=p.getEyeVector().normalize();r=Math.abs(a.dot(o))}else{if(p.getPivotSetFlag()&&p.isPointVisible(p.getPivotPoint())){var s=p.getPivotPlaneDistance();s>.01&&(r=s)}}}else r=p.getEyeVector().length();he=r},this.initOrbit=function(){this.utilities.setTemporaryPivot(m.isPerspective&&p.getPivotPoint().sub(p.getPosition()).dot(p.getEyeVector())<=0?p.getTarget():null)},this.getActiveMode=function(){return v},this.getCursor=function(){if(!M)return null;switch(v){case"freeorbit":case"orbit":return"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAMAAADXqc3KAAAAt1BMVEUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///8AAAAzMzP6+vri4uISEhKKioqtra2dnZ2EhIR9fX10dHRkZGQdHR3t7e3Hx8e5ubm1tbWoqKhWVlZKSko4ODgICAjv7+/o6OjMzMyxsbFOTk4pKSkXFxcEBAT29vbW1tZ6enpISEgLCwvhzeX+AAAAGXRSTlMANRO0nHRJHfnskIxQRKh89syDVwTWZjEJxPFEswAAAOFJREFUKM+1j+lygkAQhIflEAJe0Rw9u4CCeKKoSTTX+z9XoMJWWeX+ssrvZ3f19DQ5zOw/0DUMQPlmQ72bE2adBp8/Rp3CQUi3ILx+bxj4fjDs9T1Bmo6bbPPN8aDU4bjJt4nb+de789kSFyxn826jW3ICLNZZKU8nWWbrBTCRVm04U8TpjquRFf1Go0d7l8aYOrUR7FGEFr1S9LGymwthgX2gE/Kl0cHPOtF2xOWZ5QpIC93RflW4InkDoPRXesd5LJIMQPzV7tCMa7f6BvhJL79AVDmYTNQ1NhnxbI/uwB8H5Bjd4zQPBAAAAABJRU5ErkJggg==), auto";case"dolly":return"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAMAAADXqc3KAAAAgVBMVEUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///8mJiYAAADNzc2/v7+fn59paWlPT08MDAwICAj6+vqpqak7Ozv29vby8vLp6em2traAgIBkZGRZWVlAQEAaGhpISEgkS7tbAAAAFHRSTlMAOvhpZD8mkQWegMy9qY1YVE01EYiqlE0AAADZSURBVCjPbY9ZloMgEAAbEbfsmRZZXbJn7n/AAX2RQVN/VD26AXLOeZLDGo6IbfI9tHq8cdxuj1HwvgCoaiHqKoRk+M3hB9jueUW8PnfsE/bJ3vms7nCkq7NoE3s99AXxoh8vFoXCpknrn5faAuJCenT0xPkYqnxQFJaU0gdZrsKm8aHZrAIffBj40mc1jsTfIJRWegq6opTMvlfqLqYg7kr1ZB7jFgeaMC59N//8O4WZ1IiPF8b5wMHcJn8zB4g4mc77zpxgAbMSUVoGK4iV0hL4wrksz+H0Bw5+E+HrniDQAAAAAElFTkSuQmCC), auto";case"pan":return"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAMAAADXqc3KAAABHVBMVEUAAABPTk4AAAAAAAAJCQkRERE0MzQQEBAODg4QEBB4d3dbWlo9PDw/Pj4vLy8sLCwZGBgWFhYcHBwKCgoSEhIAAAAKCgoICAgKCgoQEBAODg4EBAQICAgPDw8REREMDAx2dnY0NDQvLy9QUFAaGhomJSYjIyM7OjokJCQNDA0mJiYNDQ0AAAAUFBQJCQkQEBAEBAQNDQ0PDw8VFRX///+amJkAAAD5+fnz8/PKycn9/f339vbi4eLR0dDNzMyAgIB8e3xycHH7+/vw7+/o6OjX1ta7urq4t7iwsLCnp6eioqKbmppva21OTk74+Pjl5eXc3Nzb29vLy8vDw8PDwsKrqqqdnZ2WlpaSkpKTkZKMiouEg4NkZGRISEgxLzBpgbsEAAAANHRSTlMA+fiQXgngKSYG/vX17uvBuqackpCNg3BpUkpAPBwTDvj18+vl0s/NwrOwoZZ+TDg4NBkBGrzX8QAAAP5JREFUKM99j9Vuw0AQRdeuKZyGkyZNmbnXDLHDVGb8/8/oy7paK1bO0+oc7WiGnGiaxq+QRTQAOh8f9Jv4H/Ge8PZPrCdlvkxfYluUT2WyyCq3mZ7unwlKVLcqOzA/Mf71j0TWJ/Ym6rPeca05Ni4iIevYc7yoUD2zQFhq71BdI9nvBeBabFDSPe8DswlUc1Riw3VxbH0NHBUPQ0jrbDnPYDjALQBMq9E7nkC5y7VDKTZlUg8Q0lmjvl74zlYErgvKa42GPKf3/a0kQmYCDY1SYMDosqMoiWrGwz/uAbNvc/fNon4kXRKGq+PUo2Mb96afV0iUxqGU2s4VBbKUP65NL/LKF+7ZAAAAAElFTkSuQmCC), auto"}return null},this.getMotionDelta=function(e,t){var r=p&&p.getReverseZoomDirection()?-1.5:1.5;d&&(r*=-1),oe[0]&&(H.x+=c,q.x+=20),oe[1]&&(H.x-=c,q.x-=20),oe[2]&&(H.y+=c,q.y+=20),oe[3]&&(H.y-=c,q.y-=20),oe[4]&&(H.z+=r),oe[5]&&(H.z-=r);var n=H.x-G.x,i=H.y-G.y,o=H.z-G.z;Math.abs(n)<u&&(n=0),Math.abs(i)<u&&(i=0),Math.abs(o)<u&&(o=0),e.set(n,i,o),t&&t.set(q.x-j.x,q.y-j.y)},this.stepMotionDelta=function(e,t){t?(G.x+=.6*e.x,G.y+=.6*e.y,G.z+=.6*e.z):G.copy(H),j.copy(q)},this.getFitBounds=function(){return this.utilities.viewerImpl.zoomBoundsChanged&&(se=this.utilities.viewerImpl.getVisibleBounds(!0),this.utilities.viewerImpl.zoomBoundsChanged=!1),se},this.update=function(){var e,r=!1,n=!1;this.getMotionDelta(Y,X);var i=Y.x,o=Y.y,l=Y.z;if(T||this.checkInteractionMode(),(T=z>B)&&this.controller.setIsLocked(!0),0!==i||0!==o||0!==l){switch(v){case"orbit":this.utilities.autocam&&this.utilities.autocam.startState&&(X.x=-X.x,C&&this.utilities.autocam.orbit(q,C,X.multiplyScalar(2),this.utilities.autocam.startState));break;case"freeorbit":!function(){if(p.isActionEnabled("orbit")){Q.subVectors(m.position,m.pivot),J.subVectors(m.position,m.target);var e=J.length();J.normalize();var t=Math.acos(K.dot(Z)/K.length()/Z.length());t&&(t*=2,re.crossVectors(K,Z).normalize(),ne.setFromAxisAngle(re,-t),Q.applyQuaternion(ne),m.up.applyQuaternion(ne),Z.applyQuaternion(ne),J.applyQuaternion(ne),K.copy(Z)),m.position.addVectors(m.pivot,Q),m.target.subVectors(m.position,J.multiplyScalar(e)),m.dirty=!0}}();break;case"dolly":var u,c=new THREE.Vector2;l*=ce,z>=0?(o=-o,l=Math.abs(i)>Math.abs(o)?i:o,p.getReverseZoomDirection()&&(l*=-1),l*=h,i=0,o=0,c=p.viewportToScreen(0,0)):(e=p.getScreenViewport(),a&&s?(c.x=a/e.width,c.y=s/e.height):c=p.viewportToScreen(0,0)),!p.getIs2D()&&p.getZoomTowardsPivot()?this.coiIsActive()?u=p.getPivotPoint():(c=p.viewportToScreen(0,0),u=p.getWorldPoint(c.x,c.y)):u=p.getWorldPoint(c.x,c.y),p.dollyFromPoint(l*this.getDollySpeed(u,l<0),u,this.getFitBounds());break;case"pan":p.panRelative(-i,o,he);break;case"dollypan":0===i&&0===o||p.panRelative(-i,o,he),e=p.getScreenViewport(),u=p.getWorldPoint(a/e.width,s/e.height);var d=p.getPosition(),y=p.getIs2D()?d.sub(u).length():he,b=(E/w-1)*y;p.dollyFromPoint(b,u,this.getFitBounds());var S=new THREE.Vector3,M=new THREE.Quaternion,D=p.getCameraUpVector(),L=S.copy(m.position).sub(m.target).normalize();M.setFromAxisAngle(L,1.2*A),D.applyQuaternion(M),p.getIs2D()||f&&("pinch"===x||"pan"===x)||p.setCameraUpVector(D),E=w,_,he=y+b}n=!0}return this.stepMotionDelta(Y,"pan"!==v&&"dollypan"!==v),z===B&&Math.abs(l)<.01&&(this.interactionEnd(B),H.z=0,G.z=0,r=!0,n=!0),(ae.SHIFT||ae.ALT)&&-1!==g.indexOf(t.getActiveNavigationTool())&&(n=!0),!P&&(r||z>-5)&&(z>B&&(G.copy(H),this.utilities.removeTemporaryPivot()),this.utilities.autocam.endInteraction(),z=-5,T&&this.controller.setIsLocked(!1),T=!1,C=null,x=null),n?this.utilities.pivotActive(p.getPivotSetFlag(),z<=B):this.utilities.pivotUpdate(),m.dirty},this.checkInteractionMode=function(){var e=this.getTriggeredMode();e!==v&&("pan"===(v=e)&&z>B||"dollypan"===v)&&this.initTracking(G.x,G.y)},this.interactionStart=function(e,t){(t||e>z)&&(z=e,P=!0,e>B&&("pan"===v&&this.initTracking(G.x,G.y),"orbit"===v&&this.initOrbit()),!p.getSelectionSetsPivot()&&this.utilities.pivotActive(p.getPivotSetFlag(),e===B),this.utilities.autocam&&(this.utilities.autocam.sync(m),this.utilities.autocam.startInteraction(j.x,j.y),C=j.clone()))},this.interactionCheck=function(){(oe[0]||oe[1]||oe[2]||oe[3]||oe[4]||oe[5]||ae.SHIFT||ae.CONTROL||ae.ALT||ae.SPACE)&&this.interactionStart(U,!0)},this.interactionEnd=function(e){e===z&&(e!==B&&this.utilities.pivotActive(!1),P=!1)},this.isInteractionActive=function(){return P},this.handleWheelInput=function(t,r){if(a=r.canvasX,s=r.canvasY,this.isDragging)return!1;if(p.getIs2D()){var n=p.getScreenViewport(),i=e.intersectGround(a+n.width,s+n.height);this.utilities.setPivotPoint(i,!0,!0)}else this.setPivotPointFromInput(a,s);return p.getReverseZoomDirection()&&(t*=-1),H.z+=t,0!=t&&this.interactionStart(B),!0},this.resetKeys=function(){this.autoMove(-1,!1),ae.SHIFT=0,ae.CONTROL=0,ae.ALT=0,ae.SPACE=0},this.autoMove=function(e,t){t&&this.isDragging||(e<0?oe[0]=oe[1]=oe[2]=oe[3]=oe[4]=oe[5]=t:oe[e]=t,t||this.interactionEnd(U),this.interactionCheck())},this.updateModifierState=function(e){ae.CONTROL=d&&e.metaKey||e.ctrlKey?1:0,ae.SHIFT=e.shiftKey?1:0,ae.ALT=e.altKey?1:0},this.handleKeyDown=function(e,t){this.updateModifierState(e);var r=!1;if(d&&ae.CONTROL)return this.autoMove(-1,!1),this.interactionEnd(U),!1;switch(t){case F:this.adjustSpeed(1),r=!0;break;case V:this.adjustSpeed(-1),r=!0;break;case k:this.adjustSpeed(0),r=!0;break;case R:this.autoMove(0,!0),r=!0;break;case O:this.autoMove(1,!0),r=!0;break;case D:this.autoMove(2,!0),r=!0;break;case L:this.autoMove(3,!0),r=!0;break;case I:this.autoMove(4,!0),r=!0;break;case N:this.autoMove(5,!0),r=!0;break;default:return!1}return this.isDragging||this.interactionStart(U),r},this.handleKeyUp=function(e,t){this.updateModifierState(e);var r=!1;if(d&&ae.CONTROL)return this.autoMove(-1,!1),this.interactionEnd(U),!1;switch(t){case R:this.autoMove(0,!1),r=!0;break;case O:this.autoMove(1,!1),r=!0;break;case D:this.autoMove(2,!1),r=!0;break;case L:this.autoMove(3,!1),r=!0;break;case I:this.autoMove(4,!1),r=!0;break;case N:this.autoMove(5,!1),r=!0;break;default:return!1}return r&&(this.interactionEnd(U),P||this.interactionCheck()),r},this.handleDollyPan=function(e){a=e.canvasX,s=e.canvasY;var t=p.getScreenViewport();q.x=a,q.y=s,H.x=q.x/t.width,H.y=q.y/t.height,w=function(e){var t=e.pointers[1].clientX-e.pointers[0].clientX,r=e.pointers[1].clientY-e.pointers[0].clientY;return Math.sqrt(t*t+r*r)}(e);var r,n,i=THREE.Math.degToRad(e.rotation);A=i-S,Math.abs(A)>1&&(A=0),S=i,r=e.type,n="start",-1!==r.indexOf(n,r.length-n.length)&&(E=w,1,A=0,S=i),_=e.scale},this.handleGesture=function(e){switch(e.type){case"dragstart":return x="drag",this.handleButtonDown(e,0);case"dragmove":return"drag"!==x&&(this.handleButtonDown(e,0),x="drag"),this.handleMouseMove(e);case"dragend":return"drag"===x&&(this.handleButtonUp(e,0),x=null,!0);case"panstart":return x="pan",this.handlePanStart(e),this.handleDollyPan(e),!0;case"panmove":return"pan"!==x&&(x="pan",this.handlePanStart(e)),this.handleDollyPan(e);case"panend":return"pan"===x&&(this.isDragging=!1,this.handleDollyPan(e),this.interactionEnd(3),!0);case"pinchstart":return this.setPivotPointFromInput(e.center.x,e.center.y),this.isDragging=!0,x="pinch",G.x=.5*(e.normalizedX+1),G.y=1-.5*(e.normalizedY+1),W.set(e.canvasX,e.canvasY),j.set(e.canvasX,e.canvasY),T=!1,this.interactionStart(3),this.handleDollyPan(e),!0;case"pinchmove":return"pinch"===x&&this.handleDollyPan(e);case"pinchend":return"pinch"===x&&(this.isDragging=!1,this.handleDollyPan(e),this.interactionEnd(3),!0)}return!1},this.handleButtonDown=function(e,t){return this.updateModifierState(e),G.x=.5*(e.normalizedX+1),G.y=1-.5*(e.normalizedY+1),j.set(e.canvasX,e.canvasY),H.copy(G),q.copy(j),K.copy(pe(e.canvasX,e.canvasY)),Z.copy(K),a=e.canvasX,s=e.canvasY,this.isDragging=!0,this.interactionStart(t),!0},this.handlePanStart=function(e){return this.isDragging=!0,G.x=.5*(e.normalizedX+1),G.y=1-.5*(e.normalizedY+1),W.set(e.canvasX,e.canvasY),j.set(e.canvasX,e.canvasY),this.interactionStart(3),!0},this.handleButtonUp=function(e,t){return this.updateModifierState(e),H.x=.5*(e.normalizedX+1),H.y=1-.5*(e.normalizedY+1),q.set(e.canvasX,e.canvasY),Z.copy(pe(e.canvasX,e.canvasY)),K.copy(Z),a=e.canvasX,s=e.canvasY,this.interactionEnd(t),this.isDragging=!1,!0},this.handleMouseMove=function(t){return this.updateModifierState(t),this.isDragging?(H.x=.5*(t.normalizedX+1),H.y=1-.5*(t.normalizedY+1),q.set(t.canvasX,t.canvasY),Z.copy(pe(t.canvasX,t.canvasY)),a=t.canvasX,s=t.canvasY,!0):(G.x=.5*(t.normalizedX+1),G.y=1-.5*(t.normalizedY+1),j.set(t.canvasX,t.canvasY),H.x=G.x,H.y=G.y,q.copy(j),a=t.canvasX,s=t.canvasY,t.target===e.canvas&&e.rolloverObject(a,s),!1)},this.handleBlur=function(e){i.resetKeys(),i.interactionEnd(z)},this._onPrefCursor=function(e){M=e}.bind(this)}i.GlobalManagerMixin.call(a.prototype)},26074:(e,t,r)=>{"use strict";r.r(t),r.d(t,{SelectionType:()=>n});var n={MIXED:1,REGULAR:2,OVERLAYED:3}},2799:(e,t,r)=>{"use strict";r.r(t),r.d(t,{Selector:()=>u,MultiModelSelector:()=>c});var n=r(82197),i=r(26074),o=r(79659),a=r(98926),s=r(37169),l=r(23909);function u(e,t){var r=this;this.selectedObjectIds={},this.selectionCount=0,this.selectionMode=n.SelectionMode.LEAF_OBJECT,this.lockedNodes=[];var s={};function u(){return t.getData().instanceTree}function c(r){var n=u();if(s[r]>0)s[r]--,0==s[r]&&e.highlightObjectNode(t,r,!1);else if(s[r]<0)throw"Selection State machine broken. Negatively selected object!";n&&n.enumNodeChildren(r,(function(e){c(e)}),!1)}function h(r,n,o){var a=u();if(s[r])s[r]++;else{switch(o){default:case i.SelectionType.MIXED:e.highlightObjectNode(t,r,!0,n);break;case i.SelectionType.REGULAR:e.highlightObjectNode(t,r,!0,!0);break;case i.SelectionType.OVERLAYED:e.highlightObjectNode(t,r,!0,!1)}s[r]=1}a&&a.enumNodeChildren(r,(function(e){h(e,!0,o)}),!1)}function d(e){if(void 0!==e&&r.selectedObjectIds[e])return!0}function f(n,o){if(!r.isNodeSelectionLocked(n)){var a,s,l,c,f=u();if(o=o||i.SelectionType.MIXED,f){var p=(l="ifc"===(null===(a=t.getData())||void 0===a||null===(s=a.loadOptions)||void 0===s?void 0:s.fileExt),c=void 0!==e.api.prefs.getPrefFromLocalStorage(Autodesk.Viewing.Private.Prefs3D.SELECTION_MODE),l&&!c?Autodesk.Viewing.SelectionMode.FIRST_OBJECT:r.selectionMode);if(n=f.findNodeForSelection(n,p),!f.isNodeSelectable(n))return}d(n)||(r.selectedObjectIds[n]=o,r.selectionCount++,h(n,!1,o))}}function p(e){d(e)&&(c(e),r.selectedObjectIds[e]=0,r.selectionCount--)}this.getInstanceTree=u,this.hasSelection=function(){return r.selectionCount>0},this.getSelectionLength=function(){return r.selectionCount},this.getSelection=function(){var e=[],t=r.selectedObjectIds;for(var n in t)if(t[n]){var i=parseInt(n);e.push(i)}return e},this.isSelected=function(e){return d(e)},this.clearNodeSelection=function(e){return void 0!==e&&0!==this.selectionCount&&(c(e),delete r.selectedObjectIds[e],!0)},this.clearSelection=function(e){if(this.selectionCount>0){var t=r.selectedObjectIds;for(var n in t){var i=parseInt(n);void 0!==i&&c(i)}return r.selectedObjectIds={},r.selectionCount=0,!0}},this.deselectInvisible=function(){var n=!1,i=r.selectedObjectIds,o=e.visibilityManager;for(var a in i){var s=parseInt(a);s&&!o.isNodeVisible(t,s)&&(p(s),n=!0)}return n},this.toggleSelection=function(e,r){e||t.isLeaflet()?d(e)?p(e):f(e,r):a.logger.error("Attempting to select node 0.",(0,o.errorCodeString)(o.ErrorCodes.VIEWER_INTERNAL_ERROR))},this.setSelectionMode=function(e){this.clearSelection(!0),this.selectionMode=e},this.isNodeSelectionLocked=function(e){if(-1===e)return!1;var t=u();return t?t.isNodeSelectionLocked(e):-1!==r.lockedNodes.indexOf(e)},this.lockSelection=function(e,t){var n=u();function i(e,t){if(e&&-1!==e)if(t)-1===r.lockedNodes.indexOf(e)&&(r.lockedNodes.push(e),r.clearNodeSelection(e));else{var n=r.lockedNodes.indexOf(e);r.lockedNodes.splice(n,1)}}e=Array.isArray(e)?e:[e],n?e.forEach((function(e){n.enumNodeChildren(e,(function(e){n.lockNodeSelection(e,!1),i(e,t),t&&n.lockNodeSelection(e,t)}),!0)})):e.forEach((function(e){i(e,t)}))},this.setSelection=function(e,t){if(!function(e){if(r.selectionCount!==e.length)return!1;for(var t=0;t<e.length;t++)if(!d(e[t]))return!1;return!0}(e)&&(this.clearSelection(!0),null!=e&&0!==e.length))for(var n=0;n<e.length;n++)f(e[n],t)},this.getSelectionBounds=function(){var e=new l.Box3,n=new l.Box3,i=u();if(i){var o=t.getFragmentList(),a=r.selectedObjectIds;for(var s in a){var c=parseInt(s);i.enumNodeFragments(c,(function(t){o.getWorldBounds(t,n),e.union(n)}),!0)}}return e},this.getSelectionVisibility=function(){var e=!1,n=!1,i=r.selectedObjectIds;for(var o in i){var a=parseInt(o);if(a){var s=u();if(s&&s.isNodeHidden(a)?n=!0:e=!0,e&&n)break}}return{hasVisible:e,hasHidden:n,model:t}},this.update2DSelectionHighlighting=function(){if(!r._2DSelectionHighlightingUpdated&&t.isLoadDone()){var e=t.getPropertyDb();if(!e||e.isLoadDone()){s={};var n={};Object.keys(r.selectedObjectIds).forEach((function(e){n[t.remapDbId(e)]=r.selectedObjectIds[e]})),r.selectedObjectIds=n;for(var i=r.getSelection(),o=0;o<i.length;o++){var a=i[o];h(a,!1,r.selectedObjectIds[a])}r._2DSelectionHighlightingUpdated=!0}}},this.dtor=function(){this.selectedObjectIds=null}}function c(e){var t=[];function r(){t.length>1&&a.logger.warn("This selection call does not yet support multiple models.")}function n(){for(var r,n=[],i=0;i<t.length;i++){var o=[],a=[],l=t[i].selector.selectedObjectIds,u=t[i].selector.getInstanceTree();for(var c in l)if(l[c]){var h=parseInt(c);h&&(o.push(h),u&&u.enumNodeFragments(h,(function(e){a.push(e)}),!1))}o.length&&n.push({fragIdsArray:a,dbIdArray:o,nodeArray:o,model:t[i]})}1===t.length&&(r={type:s.SELECTION_CHANGED_EVENT,fragIdsArray:n[0]?n[0].fragIdsArray:[],dbIdArray:n[0]?n[0].dbIdArray:[],nodeArray:n[0]?n[0].dbIdArray:[],model:t[0]},e.api.dispatchEvent(r)),r={type:s.AGGREGATE_SELECTION_CHANGED_EVENT,selections:n},e.api.dispatchEvent(r)}function i(){for(var e=!1,r=0;r<t.length;r++)e=t[r].selector.deselectInvisible()||e;e&&n()}function o(e){e.model.is2d()&&e.model.selector&&e.model.selector.update2DSelectionHighlighting()}this.highlightDisabled=!1,this.highlightPaused=!1,this.selectionDisabled=!1,this.addModel=function(r){-1==t.indexOf(r)&&(r.selector=new u(e,r),t.push(r))},this.removeModel=function(e){var r=t.indexOf(e);e.selector.getSelection();e.selector.clearSelection(),e.selector=null,t.splice(r,1)},this.hasSelection=function(){for(var e=0;e<t.length;e++)if(t[e].selector.hasSelection())return!0;return!1},this.getSelectionLength=function(){for(var e=0,r=0;r<t.length;r++)e+=t[r].selector.getSelectionLength();return e},this.getSelection=function(){return r(),t.length>1&&a.logger.warn("Use getAggregateSelection instead of getSelection when there are multiple models in the scene."),t[0]?t[0].selector.getSelection():[]},this.getAggregateSelection=function(){for(var e=[],r=0;r<t.length;r++){var n=t[r].selector.getSelection();n&&n.length&&e.push({model:t[r],selection:n})}return e},this.clearSelection=function(e){for(var r,i=0;i<t.length;i++)t[i].selector.clearSelection(e)&&(r=!0);!e&&r&&n()},this.toggleSelection=function(e,i,o){this.selectionDisabled||(i||(r(),i=t[0]),i.selector.toggleSelection(e,o),n())},this.setSelectionMode=function(e){for(var r=0;r<t.length;r++)t[r].selector.setSelectionMode(e)},this.isNodeSelectionLocked=function(e,n){return n||(r(),n=t[0]),n&&n.selector.isNodeSelectionLocked(e)},this.lockSelection=function(e,n,i){i||(r(),i=t[0]),i&&i.selector.lockSelection(e,n)},this.unlockSelection=function(e,n){var i=this;e||n?(n||(r(),n=t[0]),e=e||n.selector.lockedNodes.slice(),this.lockSelection(e,!1,n)):t.forEach((function(e){var t=e.selector.lockedNodes.slice();i.lockSelection(t,!1,e)}))},this.setSelection=function(e,i,o){if(!this.selectionDisabled){if(e&&0!==e.length){if(i)for(var a=0;a<t.length;a++)t[a]!==i&&t[a].selector.clearSelection();else r(),i=t[0];i.selector.setSelection(e,o)}else this.clearSelection(!0);n()}},this.setAggregateSelection=function(e){if(!this.selectionDisabled){if(e&&0!==e.length)for(var t=0;t<e.length;++t){var r=e[t].model,i=e[t].ids,o=e[t].selectionType;r.selector.setSelection(i,o)}else this.clearSelection(!0);n()}},this.getSelectionBounds=function(){if(1==t.length)return t[0].selector.getSelectionBounds();for(var e=new l.Box3,r=0;r<t.length;r++){var n=t[r].selector.getSelectionBounds();e.union(n)}return e},this.getSelectionVisibility=function(){for(var e={hasVisible:!1,hasHidden:!1,details:[]},r=0;r<t.length;r++){var n=t[r].selector.getSelectionVisibility();e.hasVisible=e.hasVisible||n.hasVisible,e.hasHidden=e.hasHidden||n.hasHidden,e.details.push(n)}return e},this.dtor=function(){for(var e=0;e<t.length;e++)t[e].selector.dtor()},e.api.addEventListener(s.ISOLATE_EVENT,(function(e){i()})),e.api.addEventListener(s.HIDE_EVENT,(function(e){i()})),e.api.addEventListener(s.GEOMETRY_LOADED_EVENT,o),e.api.addEventListener(s.OBJECT_TREE_CREATED_EVENT,o),e.api.addEventListener(s.OBJECT_TREE_UNAVAILABLE_EVENT,o)}},49083:(e,t,r)=>{"use strict";r.r(t),r.d(t,{ToolController:()=>l});var n=r(84998),i=r(98926),o=r(37169),a=r(9487),s=r(35449);function l(e,t,r,s,u){this.setGlobalManager(t.globalManager),this.domElement=t.canvasWrap,this.selector=e.selector,this.autocam=r,this.lastClickX=-1,this.lastClickY=-1,this.scrollInputEnabled=!0,this.keyMapCmd=!0,this.propagateInputEventTypes=[];var c=-1!==navigator.userAgent.search("Mac OS"),h=-1!==navigator.userAgent.search("Firefox"),d=-1!==navigator.userAgent.search("Chrome"),f=-1!==navigator.userAgent.search("Safari")&&!d,p={},m={},g={},v=[],y=!1,b=-1,x=-1,_=!1,E=null,w=!1,A={},S=this;function M(e){return e.getPriority instanceof Function&&e.getPriority()||0}function T(e,r){return t.navigation.getUseLeftHandedInput()&&0===e||h&&1===e||c&&!f&&0===e&&r.ctrlKey}this.__registerToolByName=function(e,t){p[t]=e},this.registerTool=function(e,t){var r=this,n=e.getNames();if(!n||0===n.length)return i.logger.warn("Cannot register tool with no name."),!1;for(var o=!1,a=0;a<n.length;++a)if("default"!==n[a]){this.__registerToolByName(e,n[a]);g[n[a]]=t&&t instanceof Function?t:function(t){var n=e.getName();t?r.activateTool(n):r.deactivateTool(n)},o=!0}return e.utilities=s,e.controller=this,e.register&&e.register(),o},this.deregisterTool=function(e){this.deactivateTool(e.getName());var t=e.getNames();if(!t||0===t.length)return!1;for(var r=t.length;--r>=0;)this.__deregisterToolName(t[r]);return e.deregister&&e.deregister(),e.utilities=null,e.controller=null,!0},this.__deregisterToolName=function(e){e in p&&(!function(e){for(var t=v.length;--t>=0;)v[t].activeName===e&&(p[e].deactivate(e),v.splice(t,1))}(e),delete p[e])},this.getTool=function(e){return p[e]},this.getActiveToolName=function(){var e=v.length;return e>0?v[e-1].activeName:"default"},this.getActiveTool=function(){var e=v.length;return e>0?v[e-1]:p.default},this.getActiveTools=function(){return v.slice()},this.isToolActivated=function(e){for(var t=0;t<v.length;t++)if(v[t].activeName===e)return!0;return!1},this.setToolActiveName=function(e){var t=p[e];t&&(t.activeName=e)},this.rearrangeByPriorities=function(){v.sort((function(e,t){return M(e)-M(t)}))},this.activateToolModality=function(e){var t=this.getToolModality(e);for(var r in t){var n=t[r],i=g[r];n!==this.isToolActivated(r)&&i&&i(n,r)}},this.activateTool=function(e){if(y)return!1;var r=p[e];if(this.activateToolModality(e),r){void 0===r.count&&(r.count=0);var n=null;v.length&&"intercept"===v[v.length-1].activeName&&(n=v.pop());for(var a=0,s=0;s<v.length;s++)v[s]===r&&r.count++,M(v[s])<=M(r)&&(a=s+1);return r.activeName=e,0===r.count&&(r.count++,v.splice(a,0,r)),r.activate(e,t),n&&v.push(n),t.dispatchEvent({type:o.TOOL_CHANGE_EVENT,toolName:e,tool:r,active:!0}),!0}return i.logger.warn("activateTool not found: "+e),!1},this.deactivateTool=function(e){if(y)return!1;for(var r=v.length;--r>=0;)if(v[r].activeName===e){var n=p[e];return 1===n.count&&v.splice(r,1),n.count--,n.deactivate(e),t.dispatchEvent({type:o.TOOL_CHANGE_EVENT,toolName:e,tool:n,active:!1}),!0}return i.logger.warn("deactivateTool not found: "+e),!1},this.getToolNames=function(){return Object.keys(p)},this.setDefaultTool=function(e){var t=this.getDefaultTool();return!(!e||e===t)&&(this.__registerToolByName(e,"default"),t&&t.deactivate("default"),e.activate("default"),!0)},this.getDefaultTool=function(){return p.default},this.setDefaultTool(u),this.setIsLocked=function(e){var t=y;return y=!!e,t},this.getIsLocked=function(){return y},this.__checkCursor=function(){for(var e=null,r=v.length;--r>=0;){var n=v[r];if(n.getCursor&&(e=n.getCursor()))break}e||(e="auto"),E!=e&&(t.canvas.style.cursor=e,E=e)},this.update=function(e){this.__checkCursor();var r=!1;s&&s.update()&&(r=!0);for(var n=v.length;--n>=0;){var i=v[n];i.update&&i.update(e)&&(r=!0)}if(t.navigation.getCamera().dirty?(t.navigation.updateCamera(),r=!0,this.cameraUpdated=!0):this.cameraUpdated=!1,r)t.navigation.updateCamera(),this.moveDelay=Date.now()+150;else if(0!==this.moveDelay){this.moveDelay-Date.now()>0?r=!0:this.moveDelay=0}return r},this.__clientToCanvasCoords=function(t,r,n){var i=e.getCanvasBoundingClientRect(),o=i.width,a=i.height,s=t.clientX-i.left,l=t.clientY-i.top;t.canvasX=s,t.canvasY=l,t.normalizedX=s/o*2-1,t.normalizedY=(a-l)/a*2-1,r&&r.set(s/o,l/a,0),n&&n.set(s,l)},this.__invokeStack=function(e,t,r){for(var n=v.length;--n>=0;){var i=v[n];if(i&&i[e]&&i[e](t,r))return!0}var o=this.getDefaultTool();return!(!o[e]||!o[e](t,r))},this.distributeEvent=function(e,t,r){return this.__invokeStack(e,t,r)},this.handleResize=function(){t.navigation.setScreenViewport(t.container.getBoundingClientRect());for(var e=v.length;--e>=0;){var r=v[e];r.handleResize&&r.handleResize()}},this.handleSingleClick=function(e){var t=this.applyButtonMappings(e);this.lastClickX=e.clientX,this.lastClickY=e.clientY,this.__invokeStack("handleSingleClick",e,t)&&this.__onEventHandled(e)},this.handleDoubleClick=function(e){var t=this.applyButtonMappings(e);this.__invokeStack("handleDoubleClick",e,t)&&this.__onEventHandled(e)},this.handleSingleTap=function(e){this.lastClickX=e.canvasX,this.lastClickY=e.canvasY,this.__invokeStack("handleSingleTap",e)&&this.__onEventHandled(e)},this.handleDoubleTap=function(e){this.lastClickX=e.canvasX,this.lastClickY=e.canvasY,this.__invokeStack("handleDoubleTap",e)&&this.__onEventHandled(e)},this.handleWheelInput=function(e,t){this.__invokeStack("handleWheelInput",e,t)&&this.__onEventHandled(t)},this.applyButtonMappings=function(e){var r=e.button;return"buttons"in e&&(e.firefoxSpoof?r=0:!_||1&e.buttons?2===r&&1&e.buttons&&(r=0,e.firefoxSpoof=_=!0):(e.firefoxSpoof=!0,_=!1,r=0)),t.navigation.getUseLeftHandedInput()&&(r=0===r?2:2===r?0:r),r},this.applyKeyMappings=function(e){switch(e.keyCode){case a.KeyCode.EQUALSMOZ:return a.KeyCode.EQUALS;case a.KeyCode.DASHMOZNEW:case a.KeyCode.DASHMOZ:return a.KeyCode.DASH}return e.keyCode},this.handleKeyDown=function(e){var t;!this.keyMapCmd||!c||"MetaLeft"!=e.code&&"MetaRight"!=e.code?(t=this.applyKeyMappings(e))&&this.__invokeStack("handleKeyDown",e,t)&&this.__onEventHandled(e):this.handleCmdKeyEvent(e,"keydown")},this.handleKeyUp=function(e){var t;!this.keyMapCmd||!c||"MetaLeft"!=e.code&&"MetaRight"!=e.code?(t=this.applyKeyMappings(e))&&this.__invokeStack("handleKeyUp",e,t)&&this.__onEventHandled(e):this.handleCmdKeyEvent(e,"keyup")},this.handleCmdKeyEvent=function(e,t){this.__onEventHandled(e);var r=new KeyboardEvent(t,{key:"Control",code:"MetaLeft"==e.code?"ControlLeft":"ControlRight",location:e.location,ctrlKey:!0,metaKey:!1,repeat:e.repeat,isComposing:e.isComposing,charCode:0,keyCode:17,which:17});window.dispatchEvent(r)},this.handleButtonDown=function(e,t){this.__invokeStack("handleButtonDown",e,t)&&this.__onEventHandled(e)},this.handleButtonUp=function(e,t){this.__invokeStack("handleButtonUp",e,t)&&this.__onEventHandled(e)},this.handleMouseMove=function(e){this.__invokeStack("handleMouseMove",e)&&this.__onEventHandled(e)},this.handleBlur=function(e){this.__invokeStack("handleBlur",e)&&this.__onEventHandled(e)},this.keydown=function(e){if(!l._lastTouchedElement||S.domElement.contains(l._lastTouchedElement)){var t=S.getDocument();if(!(t.activeElement instanceof HTMLInputElement||t.activeElement instanceof HTMLTextAreaElement||t.activeElement instanceof HTMLSelectElement)){if(t.activeElement){var r=t.activeElement.getAttribute("contenteditable");if("true"===r||""===r)return}S.handleKeyDown(e)}}},this.keyup=function(e){S.handleKeyUp(e)},this.mousedown=function(e){var t=S.getDocument();n.isIE11&&(0,n.inFullscreen)(t)||t.activeElement&&t.activeElement.blur&&t.activeElement.blur(),S.__clientToCanvasCoords(e);var r=S.applyButtonMappings(e);if(S.handleButtonDown(e,r),b=e.canvasX,x=e.canvasY,T(r,e)){var i=A,o=void 0!==i.time&&e.timeStamp-i.time<500,a=void 0!==i.x&&void 0!==i.y&&Math.abs(i.x-e.canvasX)<=2&&Math.abs(i.y-e.canvasY)<=2;(!o||!a||i.clickCount&&2<=i.clickCount)&&(i.clickCount=0),i.clickCount?1===i.clickCount&&(i.clickCount=2):(i.clickCount=1,i.x=e.canvasX,i.y=e.canvasY,i.time=e.timeStamp)}S.addDocumentEventListener("mouseup",(function e(t){S.applyButtonMappings(t)===r&&(S.removeDocumentEventListener("mouseup",e),S.mouseup(t))}),!1),S.registerWindowMouseMove()},this.mousemove=function(e){S.__clientToCanvasCoords(e);var t=b-e.canvasX,r=x-e.canvasY;(Math.abs(t)>2||Math.abs(r)>2)&&(b=-1,x=-1),S.handleMouseMove(e)},this.mouseup=function(e){S.__clientToCanvasCoords(e);var t=S.applyButtonMappings(e);S.handleButtonUp(e,t);var r=b-e.canvasX,n=x-e.canvasY;if(b=-1,x=-1,Math.abs(r)<=2&&Math.abs(n)<=2&&S.handleSingleClick(e),T(t,e)){var i=A;2===i.clickCount&&(S.handleDoubleClick(e),i.clickCount=0,i.x=void 0,i.y=void 0,i.time=void 0)}S.unregisterWindowMouseMove()},this.doubleclick=function(e){S.__clientToCanvasCoords(e),b=e.canvasX,x=e.canvasY,S.handleDoubleClick(e)},this.mousewheel=function(e){if(S.scrollInputEnabled){S.__clientToCanvasCoords(e);var t=0;if(e.wheelDelta)t=e.wheelDelta/40;else if(e.detail)t=-e.detail;else if(e.deltaY){var r=h?1:40;t=-e.deltaY/r}S.handleWheelInput(t,e)}},this.blur=function(e){S.handleBlur(e)},this.mouseover=function(e){l._lastTouchedElement=e.target},this.registerWindowMouseMove=function(){S.addWindowEventListener("mousemove",S.mousemove),S.addWindowEventListener("mouseover",S.mouseover),S.domElement.removeEventListener("mousemove",S.mousemove),S.domElement.removeEventListener("mouseover",S.mouseover)},this.unregisterWindowMouseMove=function(){S.removeWindowEventListener("mousemove",S.mousemove),S.removeWindowEventListener("mouseover",S.mouseover),S.domElement.addEventListener("mousemove",S.mousemove),S.domElement.addEventListener("mouseover",S.mouseover)},this.enableMouseButtons=function(e){e&&!w?(this.domElement.addEventListener("mousedown",this.mousedown),this.domElement.addEventListener("dblclick",this.doubleclick),this.domElement.addEventListener("mousemove",this.mousemove),this.domElement.addEventListener("mouseover",this.mouseover)):!e&&w&&(this.domElement.removeEventListener("mousedown",this.mousedown),this.domElement.removeEventListener("dblclick",this.doubleclick),this.domElement.removeEventListener("mousemove",this.mousemove),this.domElement.removeEventListener("mouseover",this.mouseover));var t=w;return w=e,t},this.domElement.addEventListener("mousewheel",this.mousewheel,!1),this.domElement.addEventListener("DOMMouseScroll",this.mousewheel,!1),S.addWindowEventListener("keydown",this.keydown,!1),S.addWindowEventListener("keyup",this.keyup,!1),S.addWindowEventListener("blur",this.blur,!1),this.uninitialize=function(){for(this.domElement.removeEventListener("mousemove",this.mousemove),this.domElement.removeEventListener("mouseover",this.mouseover),this.removeWindowEventListener("mousemove",this.mousemove),this.removeWindowEventListener("mouseover",this.mouseover),this.removeWindowEventListener("keydown",this.keydown),this.removeWindowEventListener("keyup",this.keyup),this.removeWindowEventListener("blur",this.blur),this.domElement=null,this.selector=null,this.autocam=null,y=!1;v.length>0;)this.deactivateTool(v[v.length-1].activeName);p=null,v=null,S=null,s=null,t=null,e=null,l._lastTouchedElement=null},this.set2DMode=function(){},this.setAutocam=function(){},this.syncCamera=function(){},this.recordHomeView=function(){var e=t.navigation.getCamera();r.sync(e),r.setHomeViewFrom(e)},this.setMouseWheelInputEnabled=function(e){this.scrollInputEnabled=e},this.setModalityMap=function(e){for(var t in m={},e)this.setToolModality(t,e[t])},this.getModalityMap=function(){return Object.assign({},m)},this.getToolModality=function(e){return m[e]},this.setToolModality=function(e,t){e?t?m[e]=t:i.logger.warn("Cannot add tool modality. Missing tool map."):i.logger.warn("Cannot add tool modality. Missing tool name.")},this.__onEventHandled=function(e){this.propagateInputEventTypes.includes(e.type)||(e.preventDefault(),e.stopPropagation())}}Object.defineProperty(l,"_lastTouchedElement",{value:null,writable:!0}),s.GlobalManagerMixin.call(l.prototype)},77702:(e,t,r)=>{"use strict";function n(){this.names=["unnamed"],this.getNames=function(){return this.names},this.getName=function(){return this.names[0]},this.getPriority=function(){return 0},this.register=function(){},this.deregister=function(){},this.activate=function(e,t){},this.deactivate=function(e){},this.update=function(e){return!1},this.handleSingleClick=function(e,t){return!1},this.handleDoubleClick=function(e,t){return!1},this.handleSingleTap=function(e){return!1},this.handleDoubleTap=function(e){return!1},this.handleKeyDown=function(e,t){return!1},this.handleKeyUp=function(e,t){return!1},this.handleWheelInput=function(e){return!1},this.handleButtonDown=function(e,t){return!1},this.handleButtonUp=function(e,t){return!1},this.handleMouseMove=function(e){return!1},this.handleGesture=function(e){return!1},this.handleBlur=function(e){return!1},this.handleResize=function(){}}r.r(t),r.d(t,{ToolInterface:()=>n})},93382:(e,t,r)=>{"use strict";r.r(t),r.d(t,{UnifiedCamera:()=>h});var n=r(23909),i=r(98926);function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function s(e,t){return s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},s(e,t)}function l(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=c(e);if(t){var i=c(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return u(this,r)}}function u(e,t){if(t&&("object"===o(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function c(e){return c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},c(e)}var h=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&s(e,t)}(u,e);var t,r,i,o=l(u);function u(e,t){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),(r=o.call(this)).fov=45,r.near=.1,r.far=1e5,r.aspect=e/t,r.left=-e/2,r.right=e/2,r.top=t/2,r.bottom=-t/2,r.clientWidth=e,r.clientHeight=t,r.target=new n.Vector3(0,0,-1),r.worldup=new n.Vector3(0,1,0),r.viewInverseEnv=new n.Matrix4,r.projScreenMatrix=new n.Matrix4,r.orthographicCamera=new n.OrthographicCamera(r.left,r.right,r.top,r.bottom,r.near,r.far),r.perspectiveCamera=new n.PerspectiveCamera(r.fov,r.aspect,r.near,r.far),r.zoom=1,r.disableXr=!1,r.globalOffset=new n.Vector3,r.toPerspective(),r}return t=u,r=[{key:"clone",value:function(e){return e=e||new u(2*this.right,2*this.top),n.Camera.prototype.clone.call(this,e),e.position.copy(this.position),e.up.copy(this.up),this.target&&(e.target=this.target.clone()),this.worldup&&(e.worldup=this.worldup.clone()),this.worldUpTransform&&(e.worldUpTransform=this.worldUpTransform.clone()),e.left=this.left,e.right=this.right,e.top=this.top,e.bottom=this.bottom,e.near=this.near,e.far=this.far,e.fov=this.fov,e.aspect=this.aspect,e.zoom=this.zoom,e.clientWidth=this.clientWidth,e.clientHeight=this.clientHeight,e.isPerspective=this.isPerspective,e.globalOffset=this.globalOffset.clone(),e.orthoScale=this.orthoScale,this.updateProjectionMatrix(),e}},{key:"__computeFovPosition",value:function(e){if(Math.abs(this.fov-e)<=1e-4)return this.position.clone();var t,r,i=this.target.clone().sub(this.position),o=i.clone().normalize(),a=n.Math.degToRad(this.fov),s=n.Math.degToRad(e),l=Math.tan(.5*a)/Math.tan(.5*s);this.pivot?(t=(new n.Plane).setFromNormalAndCoplanarPoint(o.clone().negate(),this.pivot).distanceToPoint(this.position),r=o.clone().multiplyScalar(t).add(this.position)):(t=i.length(),r=this.target),t*=l;var u=o.multiplyScalar(-t);return r.clone().add(u)}},{key:"toPerspective",value:function(){!this.isPerspective&&this.saveFov&&(this.position.copy(this.__computeFovPosition(this.saveFov)),this.fov=this.saveFov),this.perspectiveCamera.aspect=this.aspect,this.perspectiveCamera.near=this.near,this.perspectiveCamera.far=this.far,this.perspectiveCamera.fov=this.fov/this.zoom,this.perspectiveCamera.updateProjectionMatrix(),this.projectionMatrix=this.perspectiveCamera.projectionMatrix,this.isPerspective=!0}},{key:"toOrthographic",value:function(){if(this.isPerspective){this.saveFov=this.fov;var e=u.ORTHO_FOV;this.position.copy(this.__computeFovPosition(e)),this.fov=e}this.orthoScale=this.target.clone().sub(this.position).length();var t=.5*this.orthoScale,r=t*this.aspect;this.left=this.orthographicCamera.left=-r,this.right=this.orthographicCamera.right=r,this.top=this.orthographicCamera.top=t,this.bottom=this.orthographicCamera.bottom=-t,this.orthographicCamera.near=this.near,this.orthographicCamera.far=this.far,this.orthographicCamera.updateProjectionMatrix(),this.projectionMatrix=this.orthographicCamera.projectionMatrix,this.isPerspective=!1}},{key:"updateProjectionMatrix",value:function(){this.isPerspective?this.toPerspective():this.toOrthographic()}},{key:"setSize",value:function(e,t){this.aspect=e/t,this.left=-e/2,this.right=e/2,this.top=t/2,this.bottom=-t/2}},{key:"setFov",value:function(e){this.fov=e,this.updateProjectionMatrix()}},{key:"setLens",value:function(e,t){void 0===t&&(t=24);var r=2*n.Math.radToDeg(Math.atan(t/(2*e)));return this.setFov(r),r}},{key:"setViewFromBox",value:function(e,t){u.getViewParamsFromBox(e,t,this.aspect,this.up,this.fov,this),this.updateCameraMatrices()}},{key:"updateCameraMatrices",value:function(){this.lookAt(this.target),this.updateProjectionMatrix(),this.updateMatrixWorld()}},{key:"setView",value:function(e){e.position&&this.position.copy(e.position),e.target&&this.target.copy(e.target),e.up&&this.up.copy(e.up),void 0!==e.isPerspective&&(this.isPerspective=e.isPerspective),void 0!==e.orthoScale&&(this.orthoScale=e.orthoScale),this.updateCameraMatrices()}},{key:"pixelsPerUnitAtDistance",value:function(e){if(!this.isPerspective)return this.clientHeight/this.orthoScale;var t=2*e*Math.tan(n.Math.degToRad(.5*this.fov));return this.clientHeight/t}},{key:"UnifpixelsPerUnitAtPoint",value:function(e){var t=this.position.distanceTo(e);return this.pixelsPerUnitAtDistance(t)}},{key:"setGlobalOffset",value:function(e){var t,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e!==this.position&&e!==this.target&&e!==this.pivot||(e=e.clone()),r&&(this.position.add(this.globalOffset).sub(e),this.target.add(this.globalOffset).sub(e),null===(t=this.pivot)||void 0===t||t.add(this.globalOffset).sub(e)),this.globalOffset.copy(e)}},{key:"getGlobalPosition",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new n.Vector3;return e.copy(this.position).add(this.globalOffset)}},{key:"viewportToRay",value:function(e,t){e.z=-1;var r=new n.Vector3(e.x,e.y,1);return e=e.unproject(this),(r=r.unproject(this)).sub(e).normalize(),t||(t=new n.Ray),t.set(this.isPerspective?this.position:e,r),t}},{key:"transformCurrentView",value:function(e){u.transformViewParams(this,e)}}],r&&a(t.prototype,r),i&&a(t,i),Object.defineProperty(t,"prototype",{writable:!1}),u}(n.Camera);h.ORTHO_FOV=2*Math.atan(.5)*180/Math.PI,h.getViewParamsFromBox=function(e,t,r,i,o,a){var s=a||{},l=e.getSize(new n.Vector3);if(s.target=e.getCenter(new n.Vector3),s.position||(s.position=new n.Vector3),s.up||(s.up=new n.Vector3),t){s.isPerspective=!1;var u=l.x/l.y,c=r;s.orthoScale=c>u?l.y:l.x/c,s.up.set(0,1,0),s.position.copy(s.target),s.position.z+=s.orthoScale,s.target.y+=1e-6*l.y}else s.isPerspective=!0,s.fov=o,s.up.copy(i),s.position.copy(s.target),s.position.z+=1.5*Math.max(l.x,l.y,l.z);return s},h.copyViewParams=function(e,t){return(t=t||{}).position=(t.position||new n.Vector3).copy(e.position),t.target=(t.target||new n.Vector3).copy(e.target),t.up=(t.up||new n.Vector3).copy(e.up),t.aspect=e.aspect,t.fov=e.fov,t.isPerspective=e.isPerspective,t.orthoScale=e.orthoScale,t},h.transformViewParams=function(e,t){var r;e.position.applyMatrix4(t),e.target.applyMatrix4(t),null===(r=e.pivot)||void 0===r||r.applyMatrix4(t),e.up.transformDirection(t)},h.adjustOrthoCamera=function(e,t){if(!e.isPerspective){var r=t.getSize(new n.Vector3),o=e.target.clone().sub(e.position),a=o.length();if(a>1e3*r.length()&&!t.isEmpty()){var s=e.position.distanceTo(t.getCenter(new n.Vector3));e.target.copy(e.position).add(o.normalize().multiplyScalar(s))}else{if(Math.abs(a-e.orthoScale)/a>1e-5)i.logger.warn("Ortho scale does not match eye-target distance. One of them is likely wrong, but which one?"),!(0===e.fov&&1===e.orthoScale)&&e.position.copy(e.target).add(o.normalize().multiplyScalar(-e.orthoScale))}}},h.prototype.isUnifiedCamera=!0},25406:(e,t,r)=>{"use strict";r.r(t),r.d(t,{ViewingUtilities:()=>i});var n=r(23909);function i(e,t,r){this.autocam=t,this.viewerImpl=e,this.setGlobalManager(this.viewerImpl.globalManager);var i=r.getCamera(),o={},a={};var s=new function(e){var t=.6,r=0,i=new n.SphereGeometry(1),o=new n.MeshPhongMaterial({color:32512,opacity:t,transparent:!0}),a=new n.Mesh(i,o),s=e,l=1;s.createOverlayScene("pivot"),a.visible=!1,this.shown=function(){return a.visible},this.show=function(e,n,i){a.scale.x=n*l,a.scale.y=n*l,a.scale.z=n*l,a.position.set(e.x,e.y,e.z),o.opacity=t,a.visible=!0,s.addOverlay("pivot",a),s.invalidate(!1,!1,!0),r=i?Date.now()+500:0},this.hide=function(){a.visible&&(a.visible=!1,s.removeOverlay("pivot",a),s.invalidate(!1,!1,!0),r=0)},this.fade=function(){if(r>0){var e=r-Date.now();if(e<=0)return this.hide(),!0;var n=e/500*t;return o.opacity=n,!0}return!1},this.fading=function(){return r>0},this.setSize=function(e){l=e},this.setColor=function(e,r){o.color=new n.Color(e),void 0!==r&&(t=r,o.opacity=t)}}(this.viewerImpl);this.transitionView=function(e,n,o,a,s,l,u){s=s||r.getWorldUpVector();var c=l?function(e,t,r){var n=t.clone().sub(e);if(0===n.lengthSq())return n.copy(r);var i=n.clone().cross(r);return 0===i.lengthSq()&&(r.z>r.y?n.y-=1e-4:n.z-=1e-4,i.crossVectors(n,r)),i.cross(n).normalize()}(e,n,s):a;c||(c=i.up);var h={position:e,center:n,pivot:u=u||n,fov:o,up:c,worldUp:s,isOrtho:!1===i.isPerspective};t.goToView(h)},this.goHome=function(){this.viewerImpl.track({name:"navigation/home",aggregate:"count"}),t.goHome()},this.getHitPoint=function(e,t){var n=this.viewerImpl.hitTestViewport(r.screenToViewport(e,t),!1);return n?n.intersectPoint:null},this.activatePivot=function(e){if(this.viewerImpl.model&&!this.viewerImpl.model.is2d()){var t=i.isPerspective?r.getPivotPlaneDistance():r.getEyeVector().length(),o=r.getVerticalFov(),a=2*t*Math.tan(n.Math.degToRad(.5*o)),l=r.getScreenViewport(),u=this.getWindow().devicePixelRatio||1,c=5*a/(l.height*u);s.show(r.getPivotPoint(),c,e)}},this.pivotActive=function(e,t){t=t||!1,(e=e&&!r.getIs2D())||!s.shown()?e&&this.activatePivot(t):s.hide()},this.pivotUpdate=function(){s.shown()&&s.fade()&&this.viewerImpl.invalidate(!1,!1,!0)},this.setPivotPoint=function(e,t,n){r.setPivotPoint(e),t||r.setTarget(e),n&&r.setPivotSetFlag(!0),this.setTemporaryPivot(null),r.getIs2D()||s.shown()&&this.activatePivot(s.fading())},this.savePivot=function(e){e||(e="default"),o[e]=r.getPivotPoint(),a[e]=r.getPivotSetFlag()},this.restorePivot=function(e){if(e||(e="default"),o[e]){var t=a[e];this.setPivotPoint(o[e],!0,t),t||r.setPivotSetFlag(!1),delete o[e],delete a[e]}},this.setTemporaryPivot=function(e){if(e){var t=r.getPivotPoint(),n=r.getPivotSetFlag();this.setPivotPoint(e,!0,n),o.TEMP=t,a.TEMP=n}else delete o.TEMP,delete a.TEMP},this.removeTemporaryPivot=function(){this.restorePivot("TEMP")},this.setPivotSize=function(e){s.setSize(e)},this.setPivotColor=function(e,t){s.setColor(e,t)},this.getBoundingBox=function(e){return this.viewerImpl.getFitBounds(e)},this.fitToView=function(e){this.viewerImpl.track({name:"navigation/fit",aggregate:"count"}),this.viewerImpl.fitToView(this.viewerImpl.selector.getAggregateSelection(),e),this.activatePivot(!0)},this.update=function(){r.getRequestFitToView()&&!r.getTransitionActive()&&(r.setRequestFitToView(!1),this.fitToView()),r.getRequestHomeView()&&!r.getTransitionActive()&&(r.setRequestHomeView(!1),this.goHome());var e=r.getRequestTransition();return e&&!r.getTransitionActive()&&(r.setRequestTransition(!1),this.transitionView(e.position,e.coi,e.fov,e.up,e.worldUp,e.reorient,e.pivot)),!1}}r(35449).GlobalManagerMixin.call(i.prototype)},30093:(e,t,r)=>{"use strict";r.r(t),r.d(t,{VisibilityManager:()=>a,MultiModelVisibilityManager:()=>s});var n=r(98926),i=r(37169);function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function a(e,t){this.viewerImpl=e,this.model=t,this.isolatedNodes=[],this.hiddenNodes=[]}function s(e){this.viewerImpl=e,this.models=[]}function l(e){var t=e.getAggregateIsolatedNodes();if(1===e.models.length){var r={type:i.ISOLATE_EVENT,nodeIdArray:t.length?t[0].ids:[],model:e.models[0]};e.viewerImpl.api.dispatchEvent(r)}r={type:i.AGGREGATE_ISOLATION_CHANGED_EVENT,isolation:t};e.viewerImpl.api.dispatchEvent(r)}a.prototype.getInstanceTree=function(){return this.model?this.model.getData().instanceTree:null},a.prototype.getIsolatedNodes=function(){return this.isolatedNodes.slice(0)},a.prototype.getHiddenNodes=function(){return this.hiddenNodes.slice(0)},a.prototype.setAllVisibility=function(e){var t=this.model?this.model.getRootId():null;t&&this.setVisibilityOnNode(t,e),this.model.getData().is2d&&this.model.setAllVisibility(e)},a.prototype.isNodeVisible=function(e){var t=this.getInstanceTree();return t?!t.isNodeHidden(e):-1==this.hiddenNodes.indexOf(e)&&(0==this.isolatedNodes.length||-1!=this.isolatedNodes.indexOf(e))},a.prototype.isolate=function(e){var t=this.getInstanceTree(),r=t?t.getRootId():null,n="number"==typeof e&&e===r||"object"==o(e)&&e.dbId===r;e&&!n?this.isolateMultiple(Array.isArray(e)?e:[e]):this.isolateNone()},a.prototype.isolateNone=function(){this.model.setAllVisibility(!0),this.viewerImpl.sceneUpdated(!0),this.setAllVisibility(!0),this.hiddenNodes=[],this.isolatedNodes=[],this.viewerImpl.invalidate(!0)},a.prototype.isolateMultiple=function(e){if(e&&0!=e.length){this.model.getData().is2d||(this.model.setAllVisibility(!1),this.viewerImpl.sceneUpdated(!0)),this.setAllVisibility(!1),this.isolatedNodes=e.slice(0),this.hiddenNodes=[];for(var t=0;t<e.length;t++)this.setVisibilityOnNode(e[t],!0)}else this.isolateNone();this.viewerImpl.invalidate(!0)},a.prototype.hide=function(e){var t,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(Array.isArray(e)){for(var n=0;n<e.length;++n)this.setVisibilityOnNode(e[n],!1);e.length>0&&(t={type:i.HIDE_EVENT,nodeIdArray:e,model:this.model})}else this.setVisibilityOnNode(e,!1),t={type:i.HIDE_EVENT,nodeIdArray:[e],model:this.model};t&&r&&this.viewerImpl.api.dispatchEvent(t)},a.prototype.show=function(e){var t;if(Array.isArray(e)){for(var r=0;r<e.length;++r)this.setVisibilityOnNode(e[r],!0);e.length>0&&(t={type:i.SHOW_EVENT,nodeIdArray:e,model:this.model})}else this.setVisibilityOnNode(e,!0),t={type:i.SHOW_EVENT,nodeIdArray:[e],model:this.model};t&&this.viewerImpl.api.dispatchEvent(t)},a.prototype.toggleVisibility=function(e){var t=this.getInstanceTree();if(t){var r=t.isNodeHidden(e);this.setVisibilityOnNode(e,r);var n={type:r?i.SHOW_EVENT:i.HIDE_EVENT,nodeIdArray:[e],model:this.model};this.viewerImpl.api.dispatchEvent(n)}},a.prototype.setVisibilityOnNode=function(e,t){var r,n=this.viewerImpl,i=this.model,o=this.getInstanceTree(),a=!t,s=i.getData().is2d;this.viewerImpl.matman();o?o.enumNodeChildren(e,(function(e){var r=o.isNodeVisibleLocked(e);if(o.setNodeHidden(e,a&&!r),s){var n=i.reverseMapDbIdFor2D(e);i.getFragmentList().setObject2DGhosted(n,!t&&!r)}else o.enumNodeFragments(e,(function(e){i.setVisibility(e,t||r)}),!1)}),!0):s?i.isLeaflet()?i.setVisibility(null,t):null===(r=i.getFragmentList())||void 0===r||r.setObject2DGhosted(e,!t):i.setVisibility(e,t);n.sceneUpdated(!0),this.updateNodeVisibilityTracking(e,t)},a.prototype.updateNodeVisibilityTracking=function(e,t){var r=t;if(this.isolatedNodes.length>0){var n=this.isolatedNodes.indexOf(e);r&&-1===n?this.isolatedNodes.push(e):r||-1===n||(this.isolatedNodes.splice(n,1),0===this.isolatedNodes.length&&(this.hiddenNodes=[this.model.getRootId()]))}else{var i=this.hiddenNodes.indexOf(e);r||-1!==i?r&&-1!==i&&this.hiddenNodes.splice(i,1):this.hiddenNodes.push(e)}var o=this.getInstanceTree();o&&o.root&&o.root.dbId===e&&(t?(this.isolatedNodes=[],this.hiddenNodes=[]):(this.isolatedNodes=[],this.hiddenNodes=[e]))},a.prototype.toggleNodeVisibleLocked=function(e){var t=this.getInstanceTree().isNodeVisbileLocked(e);this.lockNodeVisible(e,!t)},a.prototype.lockNodeVisible=function(e,t){var r=this,n=this.viewerImpl,i=this.model,o=this.getInstanceTree(),a=i.getData().is2d;if(o){var s=function(e){o.enumNodeChildren(e,(function(e){if(o.lockNodeVisible(e,t),t)if(o.setNodeHidden(e,!1),a){var r=i.reverseMapDbIdFor2D(e);i.getFragmentList().setObject2DGhosted(r,!1)}else o.enumNodeFragments(e,(function(e){i.setVisibility(e,!0)}),!1)}),!0),t&&(n.sceneUpdated(!0),r.updateNodeVisibilityTracking(e,t))};Array.isArray(e)?e.forEach(s):s(e)}},a.prototype.isNodeVisibleLocked=function(e){var t=this.getInstanceTree();return t&&t.isNodeVisibleLocked(e)},a.prototype.setNodeOff=function(e,t,r,n){var i,o,a=this.viewerImpl,s=this.model,l=this.getInstanceTree(),u=s.getData().is2d;if(!l)return u?s.getFragmentList().setObject2DVisible(e,!t):s.getFragmentList().setFragOff(e,t),void a.sceneUpdated(!0);if(r&&n)if(u)for(var c=0;c<r.length;++c){i=r[c],l.setNodeOff(i,t);var h=s.reverseMapDbIdFor2D(i);s.getFragmentList().setObject2DVisible(h,!t)}else{for(var d=0;d<r.length;++d)i=r[d],l.setNodeOff(i,t);for(var f=0;f<n.length;++f)o=n[f],s.getFragmentList().setFragOff(o,t)}else l.enumNodeChildren(e,(function(e){if(l.setNodeOff(e,t),u){var r=s.reverseMapDbIdFor2D(e);s.getFragmentList().setObject2DVisible(r,!t)}else l.enumNodeFragments(e,(function(e){s.getFragmentList().setFragOff(e,t)}),!1)}),!0);a.sceneUpdated(!0)},s.prototype.addModel=function(e){-1==this.models.indexOf(e)&&(e.visibilityManager=new a(this.viewerImpl,e),this.models.push(e))},s.prototype.removeModel=function(e){var t=this.models.indexOf(e);e.visibilityManager.isolateNone(),e.visibilityManager=null,this.models.splice(t,1)},s.prototype.warn=function(){this.models.length>1&&n.logger.warn("This selection call does not yet support multiple models.")},s.prototype.getAggregateIsolatedNodes=function(){for(var e=[],t=this.models,r=0;r<t.length;r++){var n=t[r].visibilityManager.getIsolatedNodes();n&&n.length&&e.push({model:t[r],ids:n})}return e},s.prototype.getIsolatedNodes=function(e){return e||(this.warn(),e=this.models[0]),e.visibilityManager.getIsolatedNodes()},s.prototype.getAggregateHiddenNodes=function(){for(var e=[],t=this.models,r=0;r<t.length;r++){var n=t[r].visibilityManager.getHiddenNodes();n&&n.length&&e.push({model:t[r],ids:n})}return e},s.prototype.getHiddenNodes=function(e){return e||(this.warn(),e=this.models[0]),e.visibilityManager.getHiddenNodes()},s.prototype.isNodeVisible=function(e,t){return e||(this.warn(),e=this.models[0]),e.visibilityManager.isNodeVisible(t)},s.prototype.isolate=function(e,t){t||(this.warn(),t=this.models[0]),t.visibilityManager.isolate(e),l(this)},s.prototype.aggregateIsolate=function(e,t){if(e&&0!==e.length){var r=this.models.concat();for(s=0;s<e.length;++s){var n=e[s].model,i=e[s].ids||e[s].selection,o=r.indexOf(n);r.splice(o,1),n.visibilityManager.isolate(i)}for(var a=!t||void 0!==t.hideLoadedModels&&t.hideLoadedModels;r.length&&a;)r.pop().visibilityManager.setAllVisibility(!1)}else for(var s=0;s<this.models.length;++s)this.models[s].visibilityManager.isolateNone();l(this)},s.prototype.hide=function(e,t){t||(this.warn(),t=this.models[0]),t.visibilityManager.hide(e)},s.prototype.aggregateHide=function(e){if(e&&0!==e.length){for(var t=0;t<e.length;++t){var r=e[t].model,n=e[t].ids||e[t].selection;r.visibilityManager.hide(n,1===this.models.length)}var o=this.getAggregateHiddenNodes(),a={type:i.AGGREGATE_HIDDEN_CHANGED_EVENT,hidden:o};this.viewerImpl.api.dispatchEvent(a)}},s.prototype.show=function(e,t){t||(this.warn(),t=this.models[0]),t.visibilityManager.show(e)},s.prototype.toggleVisibility=function(e,t){t||(this.warn(),t=this.models[0]),t.visibilityManager.toggleVisibility(e)},s.prototype.setVisibilityOnNode=function(e,t,r){r||(this.warn(),r=this.models[0]),r.visibilityManager.setVisibilityOnNode(e,t)},s.prototype.toggleVisibleLocked=function(e,t){t||(this.warn(),t=this.models[0]),t.visibilityManager.toggleVisibleLocked(e)},s.prototype.lockNodeVisible=function(e,t,r){r||(this.warn(),r=this.models[0]),r.visibilityManager.lockNodeVisible(e,t)},s.prototype.isNodeVisibleLocked=function(e,t){return t||(this.warn(),t=this.models[0]),t.visibilityManager.isNodeVisibleLocked(e,t)},s.prototype.setNodeOff=function(e,t,r,n,i){r||(this.warn(),r=this.models[0]),r.visibilityManager.setNodeOff(e,t,n,i)}},82803:(e,t,r)=>{"use strict";r.r(t),r.d(t,{WorldUpTool:()=>o});var n=r(23909),i=r(37169);function o(e,t){var r,o=t.navigation,a=o.getCamera(),s=["worldup"],l=this,u=(r=new n.Vector3,function(e,t,i,o){var a=new n.Vector3(e,t,i),s=o.dot(a);return r.copy(o),r.multiplyScalar(s),a.sub(r)});var c=2*Math.PI,h=.001,d=1e-5,f=!1,p=!1,m=!1,g=new function(e,t){var r=2*Math.tan(n.Math.degToRad(15)),i=new n.MeshPhongMaterial({color:12303291,opacity:.5,transparent:!0,depthTest:!1,depthWrite:!1}),a=new n.Vector3,s=new n.Vector3,l=new n.Quaternion,h=new n.PerspectiveCamera(30,t.aspect,t.near,t.far),f=t,p=1,m=1,g=null,v=null,y=null,b=null,x=null,_=null,E=null,w=null,A=null,S=new Array(6),M=0,T=!1,C=!0,P=0,D=5*Math.PI/180,L=7*Math.PI/180,R=1,I=1e3;function O(e,t){var r=Math.abs(e-t);return r>c?r:Math.min(c-r,r)}function N(e,t){var r=U(e);return r.distanceToSquared(t)<d||(s.set(-t.x,-t.y,-t.z),r.distanceToSquared(s)<d)}function k(e){return e>c?e:e<=0?e+Math.PI:e-Math.PI}function F(e,t,r){var n,i=e.clone().normalize(),o=new Array(3),a=new Array(6);o[0]=u(1,0,0,i),o[1]=u(0,1,0,i),o[2]=u(0,0,1,i);var c=t.clone().cross(i).normalize();for(n=0;n<3;++n){var h=o[n];a[n]=h.length(),a[n]<.1?S[n]=I:(h.multiplyScalar(1/a[n]),S[n]=Math.atan2(c.dot(h),t.dot(h)))}for(S[3]=k(S[0]),S[4]=k(S[1]),S[5]=k(S[2]),a[3]=a[0],a[4]=a[1],a[5]=a[2],function(e,t){for(var r=D+L+2*Math.PI/180,n=0;n<6;++n)if(S[n]!==I)for(var i=n+1;i<6;++i)if(S[i]!==I&&O(S[n],S[i])<r){if(e[n]<e[i]&&!N(n,t)||N(i,t)){S[n]=I;break}S[i]=I}}(a,r),n=0;n<6;++n)if(S[n]!==I){var d=s.set(0,0,1);l.setFromAxisAngle(d,S[n]);var f=s.set(0,.54,0);f.applyQuaternion(l),w[n].position.copy(f),w[n].visible=!0}else w[n].visible=!1}function V(e,t,r,a,s){return _||(_=function(){_=new n.Object3D;var e=new n.RingGeometry(.5-.01*p,.5,60),t=new n.Mesh(e,i);v=t;var r=.007*p,o=new n.BoxGeometry(.93,r,r),a=new n.BoxGeometry(r,.93,r),s=new n.BoxGeometry(r,r,.93);y=new n.Mesh(o,i),b=new n.Mesh(a,i),x=new n.Mesh(s,i),_.add(y),_.add(b),_.add(x),E=new n.Mesh(new n.CircleGeometry(.005),i),_.add(E),w=new Array(6),A=new Array(6);for(var l=0;l<6;++l){var u=.005*p,c=.0025*p;w[l]=new n.Mesh(new n.CircleGeometry(u,16),i),A[l]=new n.Mesh(new n.CircleGeometry(c,16),i),A[l].visible=!1,w[l].add(A[l]),t.add(w[l])}return _.add(t),_}()),o.orient(v,t,h.position,a),F(r,s,a),_.scale.x=e,_.scale.y=e,_.scale.z=e,_.position.copy(t),_}function U(e){if(a.set(0,0,0),e>=0){var t=e>=3?-1:1;0===(e%=3)&&(a.x=t),1===e&&(a.y=t),2===e&&(a.z=t)}return T&&a.multiplyScalar(-1),a}function B(e,t){for(var r=O(S[0],e),n=0,i=1;i<6;++i){var o=O(S[i],e);o<r&&(r=o,n=i)}return r,r<t?n:-1}function z(e){o.setWorldUpVector(e,!0)}function G(e){if(0!==e){var t=30*Math.PI/180,r=s.copy(h.position).sub(g).normalize();l.setFromAxisAngle(r,e);var n=o.getWorldUpVector(),i=Math.abs(r.angleTo(n));(i<t||Math.PI-i<t)&&n.copy(o.getCameraUpVector()),n.applyQuaternion(l),z(n)}}function H(e,t,r,n){return e<t&&U(r).distanceToSquared(n)<d}function W(e,t){e.dot(t)<0&&(t=t.clone().multiplyScalar(-1)),o.orient(E,g,h.position,t),E.position.copy(t.multiplyScalar(.495));for(var r=!1,n=C?L:D,i=0;i<6;++i){var a=O(S[i],M),s=H(a,n,i,e);s&&(r=!0);var l=s?4:3*(1-3*a/Math.PI);l<1&&(l=1),l*=p,A[i].visible=s;var u=w[i];u.scale.x=l,u.scale.y=l,u.scale.z=l}return y.visible=r,b.visible=r,x.visible=r,r}function j(e){(M+=e)>Math.PI?M-=c:M<=-Math.PI&&(M=c+M);var t=function(){if(!C){var e=B(M,D);if(e>=0)return 0,C=!0,M=S[e],U(e)}return!1}();if(t)P=M,z(t);else if(function(){if(C){if(B(M,L)<0)return C=!1,!0;0}return!1}()){G(M-P),P=0}else{if(C)return!1;G(e)}return!0}e.createOverlayScene("roll",null,null,h),this.updateRollCamera=function(e,t){h.position.copy(f.position),h.quaternion.copy(f.quaternion),h.up.copy(f.up),h.aspect=f.aspect,e&&t&&(h.near=t-e,h.far=t+e),h.updateProjectionMatrix()},this.isSnapped=function(){return C},this.resize=function(){var e=R*r,t=e*f.aspect,n=(f.aspect<1?t:e)*m;_.scale.x=n,_.scale.y=n,_.scale.z=n},this.start=function(t,r){this.updateHUD(t,r),e.addOverlay("roll",_)},this.updateHUD=function(e,t){g=e,t<.35?t=.35:t>.8&&(t=.8),m=t,p=.8/t;var n=a.copy(e).sub(f.position),i=(R=n.length())*r,s=i*f.aspect,l=(f.aspect<1?s:i)*t;this.updateRollCamera(l,R);var u=o.getWorldUpVector(),c=o.getCameraUpVector();V(l,e,n,u,c),M=0,P=0;var h=u.dot(c);T=h<0,C=W(u,c)},this.handleRoll=function(e,t,r){if(this.updateRollCamera(),W(o.getWorldUpVector(),o.getCameraUpVector()),0!==e||0!==t){var n=r.x-e-.5,i=r.y-t-.5,a=r.x-.5,s=r.y-.5;return j(Math.atan2(s,a)-Math.atan2(i,n))}return!1},this.handleRollTouch=function(e){this.updateRollCamera(),W(o.getWorldUpVector(),o.getCameraUpVector());var t=e-M;return Math.abs(t)>.001&&j(t)},this.end=function(){e.removeOverlay("roll",_)}}(e,a),v=new n.Vector3,y=new n.Vector3,b=new n.Vector3,x=null,_=0;this.getNames=function(){return s},this.getName=function(){return s[0]},this.activate=function(e){t.addEventListener(i.CAMERA_CHANGE_EVENT,this.handleCameraChange),m=!1},this.deactivate=function(e){g.end(),t.removeEventListener(i.CAMERA_CHANGE_EVENT,this.handleCameraChange),this.utilities.restorePivot(),x=null,f=!1,m=!1},this.getCursor=function(){return"auto"},this.getMotionDelta=function(e){var t=y.x-v.x,r=y.y-v.y,n=y.z-v.z;Math.abs(t)<h&&(t=0),Math.abs(r)<h&&(r=0),Math.abs(n)<h&&(n=0),e.set(t,r,n)},this.stepMotionDelta=function(){v.copy(y)},this.update=function(){if(!m){var e=o.getEyeVector(),t=.5*(a.near+a.far);e.normalize().multiplyScalar(t);var r=e.add(a.position);this.utilities.savePivot(),this.utilities.setPivotPoint(r,!0,!0),this.utilities.pivotActive(!0);g.start(r,.65),m=!0}var n=p;this.getMotionDelta(b);var i=b.x,s=b.y,l=b.z;return(p||"roll"===x||f&&(0!==i||0!==s||0!==l))&&(p="roll"===x?g.handleRollTouch(_):g.handleRoll(i,s,y)),this.stepMotionDelta(),a.dirty&&(n=!0),n},this.handleResize=function(){g.resize(),p=!0},this.handleGesture=function(e){switch(e.type){case"dragstart":return x="drag",this.handleButtonDown(e,0);case"dragmove":return this.handleMouseMove(e);case"dragend":return x=null,this.handleButtonUp(e,0);case"rotatestart":return t.removeEventListener(i.CAMERA_CHANGE_EVENT,this.handleCameraChange),x="roll",_=n.Math.degToRad(e.rotation),{x:.5*(e.normalizedX+1),y:1-.5*(e.normalizedY+1)},function(e){var t=e.pointers[1].clientX-e.pointers[0].clientX,r=e.pointers[1].clientY-e.pointers[0].clientY,n=Math.sqrt(t*t+r*r),i=o.getScreenViewport();return n/Math.min(i.width,i.height)}(e),!0;case"rotatemove":return _=n.Math.degToRad(e.rotation),"roll"===x;case"rotateend":return t.addEventListener(i.CAMERA_CHANGE_EVENT,this.handleCameraChange),_=n.Math.degToRad(e.rotation),x=null,!1}return!1},this.handleWheelInput=function(e){return!0},this.handleCameraChange=function(){var e=o.getEyeVector(),t=.5*(a.near+a.far);e.normalize().multiplyScalar(t);var r=e.add(a.position);g.updateHUD(r,.65)},this.handleButtonDown=function(e,r){return v.x=.5*(e.normalizedX+1),v.y=1-.5*(e.normalizedY+1),y.copy(v),f=!0,x=null,this.controller.setIsLocked(!0),t.removeEventListener(i.CAMERA_CHANGE_EVENT,l.handleCameraChange),!0},this.handleButtonUp=function(e,r){return y.x=.5*(e.normalizedX+1),y.y=1-.5*(e.normalizedY+1),f=!1,p=!0,this.controller.setIsLocked(!1),t.addEventListener(i.CAMERA_CHANGE_EVENT,l.handleCameraChange),!0},this.handleMouseMove=function(e){return y.x=.5*(e.normalizedX+1),y.y=1-.5*(e.normalizedY+1),!0},this.handleBlur=function(e){return f=!1,x=null,!1}}},79757:(e,t,r)=>{"use strict";r.r(t),r.d(t,{Autocam:()=>c});var n=r(23909),i=r(71224),o=r(35449),a=r(55412),s=Number.MIN_VALUE||3e-308,l=1e-5;function u(e){var t=1e-12;Math.abs(e.x)<t&&Math.abs(e.y)<t?e.set(0,0,e.z>0?1:-1):Math.abs(e.y)<t&&Math.abs(e.z)<t?e.set(e.x>0?1:-1,0,0):Math.abs(e.z)<t&&Math.abs(e.x)<t&&e.set(0,e.y>0?1:-1,0)}function c(e,t,r){var o=this,c=null,h=!1;this.cube=null,this.camera=e,this.renderer="WEBGL",this.startState={},this.navApi=t,this.orthographicFaces=!1,this.canvas=r,this.cameraChangedCallback=function(){},this.pivotDisplayCallback=function(){},this.transitionCompletedCallback=function(){};var d,f=Date.now(),p=!1;function m(t){h=!0,e.target.copy(o.center),e.pivot.copy(o.pivot),e.worldup?e.worldup.copy(o.sceneUpDirection):e.up.copy(o.sceneUpDirection),o.cameraChangedCallback(t),h=!1}function g(e,t){e.position.copy(e.globalPosition).sub(t),e.center.copy(e.globalCenter).sub(t),e.pivot.copy(e.globalPivot).sub(t)}this.recordTime=!0,this.dtor=function(){this.cube=null,this.cameraChangedCallback=null,this.pivotDisplayCallback=null,this.transitionCompletedCallback=null,this.canvas=null,this.recordTime=!1,this.afAnimateTransition&&cancelAnimationFrame(this.afAnimateTransition)},this.registerCallbackCameraChanged=function(e){this.cameraChangedCallback=e},this.registerCallbackPivotDisplay=function(e){this.pivotDisplayCallback=e},this.registerCallbackTransitionCompleted=function(e){this.transitionCompletedCallback=e},this.showPivot=function(e){this.pivotDisplayCallback(e)},this.setWorldUpVector=function(e){h||e&&e.lengthSq()>0&&!e.normalize().equals(this.sceneUpDirection)&&(this.sceneUpDirection.copy(e),this.sceneFrontDirection.copy(this.getWorldFrontVector()),this.cubeFront.copy(this.sceneFrontDirection).cross(this.sceneUpDirection).normalize(),this.cube&&requestAnimationFrame(this.cube.render))},this.getWorldUpVector=function(){return this.sceneUpDirection.clone()},this.getWorldRightVector=function(){var e=this.sceneUpDirection.clone();return Math.abs(e.z)<=Math.abs(e.y)?e.set(e.y,-e.x,0):e.z>=0?e.set(e.z,0,-e.x):e.set(-e.z,0,e.x),e.normalize()},this.getWorldFrontVector=function(){return this.getWorldUpVector().cross(this.getWorldRightVector()).normalize()},this.goToView=function(e){if(this.navApi.isActionEnabled("gotoview")){var t={position:e.position.clone(),up:e.up.clone(),center:e.center.clone(),pivot:e.pivot.clone(),fov:e.fov,worldUp:e.worldUp.clone(),isOrtho:e.isOrtho};this.addGlobalPositions(t),o.elapsedTime=0,this.animateTransition(t)}},this.getCurrentView=function(){return{position:e.position.clone(),up:e.up.clone(),center:this.center.clone(),pivot:this.pivot.clone(),fov:e.fov,worldUp:this.sceneUpDirection.clone(),isOrtho:!1===e.isPerspective}},this.setCurrentViewAsHome=function(e){e?(this.navApi.setRequestFitToView(!0),p=!0):this.homeVector=this.getCurrentView()},this.setHomeViewFrom=function(e){var t=e.pivot?e.pivot:this.center,r=e.target?e.target:this.pivot,n=e.worldup?e.worldup:this.sceneUpDirection;this.homeVector={position:e.position.clone(),up:e.up.clone(),center:r.clone(),pivot:t.clone(),fov:e.fov,worldUp:n.clone(),isOrtho:!1===e.isPerspective},this.originalHomeVector={position:e.position.clone(),up:e.up.clone(),center:r.clone(),pivot:t.clone(),fov:e.fov,worldUp:n.clone(),worldFront:this.sceneFrontDirection.clone(),isOrtho:!1===e.isPerspective},this.addGlobalPositions(this.homeVector),this.addGlobalPositions(this.originalHomeVector)},this.toPerspective=function(){e.isPerspective||(e.toPerspective(),m(!1))},this.toOrthographic=function(){e.isPerspective&&(e.toOrthographic(),m(!1))},this.setOrthographicFaces=function(e){this.orthographicFaces=e},this.getViewType=function(){return this.orthographicFaces?a.VIEW_TYPES.PERSPECTIVE_ORTHO_FACES:e.isPerspective?a.VIEW_TYPES.PERSPECTIVE:a.VIEW_TYPES.ORTHOGRAPHIC},this.setViewType=function(e,t){switch(e){case a.VIEW_TYPES.ORTHOGRAPHIC:return this.setOrthographicFaces(!1),this.toOrthographic(),!0;case a.VIEW_TYPES.PERSPECTIVE:return this.setOrthographicFaces(!1),this.toPerspective(),!0;case a.VIEW_TYPES.PERSPECTIVE_ORTHO_FACES:return this.setOrthographicFaces(!0),void 0===t&&(t=this.isFaceView()),t?this.toOrthographic():this.toPerspective(),!0;default:return!1}},this.goHome=function(){this.navApi.isActionEnabled("gotoview")&&(this.navApi.setPivotSetFlag(!1),this.goToView(this.homeVector))},this.resetHome=function(){this.homeVector.position.copy(this.originalHomeVector.position),this.homeVector.up.copy(this.originalHomeVector.up),this.homeVector.center.copy(this.originalHomeVector.center),this.homeVector.pivot.copy(this.originalHomeVector.pivot),this.homeVector.fov=this.originalHomeVector.fov,this.homeVector.worldUp.copy(this.originalHomeVector.worldUp),this.homeVector.isOrtho=this.originalHomeVector.isOrtho,this.goHome()},this.getView=function(){return this.center.clone().sub(e.position)},this.setCameraUp=function(t){var r=this.dir.clone(),n=r.cross(t).normalize();0===n.lengthSq()&&(r.copy(this.dir),t.z>t.y?r.y+=1e-4:r.z+=1e-4,n=r.cross(t).normalize()),e.up.copy(n).cross(this.dir).normalize()},this.addGlobalPositions=function(e){var t=this.camera.globalOffset;e.globalPosition=e.position.clone().add(t),e.globalCenter=e.center.clone().add(t),e.globalPivot=e.pivot.clone().add(t)},this.onGlobalOffsetChanged=function(e){g(this.homeVector,e),g(this.originalHomeVector,e),this.camera.setGlobalOffset(e)};var v,b,_,E,w=this;!function e(){w.recordTime&&requestAnimationFrame(e);var t=Date.now();d=t-f,f=t}(),this.ortho=!1,this.center=e.target?e.target.clone():new n.Vector3(0,0,0),this.pivot=e.pivot?e.pivot.clone():this.center.clone(),this.sceneUpDirection=e.worldup?e.worldup.clone():e.up.clone(),this.sceneFrontDirection=this.getWorldFrontVector(),this.dir=this.getView(),this.setCameraUp(e.up),this.saveCenter=this.center.clone(),this.savePivot=this.pivot.clone(),this.saveEye=e.position.clone(),this.saveUp=e.up.clone(),this.cubeFront=this.sceneFrontDirection.clone().cross(this.sceneUpDirection).normalize(),this.setHomeViewFrom(e);var A,S,M=new n.Quaternion,T=new n.Quaternion,C=new n.Quaternion,P=new n.Quaternion;this.userPanSpeed=.5,this.userLookSpeed=2,this.userHeightSpeed=5,this.walkMultiplier=1,this.userZoomSpeed=1.015,this.orbitMultiplier=5,this.currentlyAnimating=!1,e.keepSceneUpright=!0,this.preserveOrbitUpDirection=!0,this.alignOrbitUpDirection=!0,this.constrainOrbitHorizontal=!1,this.constrainOrbitVertical=!1,this.doCustomOrbit=!1,this.snapOrbitDeadZone=.045,this.snapOrbitThresholdH=this.snapOrbitThresholdV=n.Math.degToRad(15),this.snapOrbitAccelerationAX=this.snapOrbitAccelerationAY=1.5,this.snapOrbitAccelerationBX=this.snapOrbitAccelerationBY=2,this.snapOrbitAccelerationPointX=this.snapOrbitAccelerationPointY=.5,this.combined=!1,this.useSnap=!1,this.lockDeltaX=0,this.lockedX=!1,this.lastSnapRotateX=0,this.lockDeltaY=0,this.lockedY=!1,this.lastSnapRotateY=0,this.lastSnapDir=new n.Vector3(0,0,0),this.topLimit=!1,this.bottomLimit=!1,this.minSceneBound=0,this.maxSceneBound=0;var D,L,R={destinationPercent:1,duration:1,zoomToFitScene:!0,useOffAxis:!1};this.shotParams=R,this.zoomDelta=new n.Vector2;var I;function O(e,t,r){if(e<=t)return 0;if(e>=r)return 1;var n=(e-t)/(r-t);return.5*(Math.sin((n-.5)*Math.PI)+1)}function N(e){return Math.round(10*e)/10}function k(e,t){var r=new n.Vector2(0,0),i=o.getWindow();return r.x=e/i.innerWidth,r.y=t/i.innerHeight,r}function F(e,t,r){var n,i,a,s;n=i=a=s=0;var l=0,u=null,c=null,h=o.snapOrbitDeadZone,d=o.orbitMultiplier;return"h"==e?(n=o.snapOrbitThresholdH,i=o.snapOrbitAccelerationAX,a=o.snapOrbitAccelerationBX,s=1-o.snapOrbitAccelerationPointX,c=o.lockDeltaX,u=o.lockedX):(n=o.snapOrbitThresholdV,i=o.snapOrbitAccelerationAY,a=o.snapOrbitAccelerationBY,s=1-o.snapOrbitAccelerationPointY,c=o.lockDeltaY,u=o.lockedY),u?(c+=r)<-h?(l=(c+h)*d*1/a,u=!1):c>h&&(l=(c-h)*d*1/a,u=!1):(l=Math.abs(t)>n?r*d:Math.abs(t)>s*n?r*t>0?r*d*i:r*d*1/i:r*t>0?r*d*a:r*d*1/a)*t>0&&Math.abs(l)>Math.abs(t)&&(this.lockDeltaX=this.lockDeltaY=0,u=!0,l=t),l}function V(){return o.combined}function U(e,t){var r=!1,n=o.getWindow(),i=n.innerWidth,a=e.x%i,s=n.innerHeight,l=e.y%s,u=a>0?a-t.x:i+a-t.x,c=l>0?l-t.y:s+l-t.y;return Math.abs(u)<30&&Math.abs(c)<30&&(r=!0),r}function B(e,t,r){var i=o.getWindow();if(!I||!e){if(e){var a=new n.Vector2,s=t.x,l=t.y;!function(e,t,r){var n=o.getWindow();r.x=(e.x-t.x)/n.innerWidth,e.x=t.x+(e.x-t.x)%n.innerWidth,r.y=(e.y-t.y)/n.innerHeight,e.y=t.y+(e.y-t.y)%n.innerHeight}(t,r,a),i.innerWidth*a.x,i.innerHeight*a.y,s<r.x?s-=60:s+=60,l<r.y?l-=60:l+=60}I=e}}function z(e){var t=Math.pow(e,2);e<0&&(t=-t);var r=k(0,t),n=.01*(o.maxSceneBound-o.minSceneBound);r.y*=n;var i=o.userHeightSpeed*r.y;return i=function(e,t,r){if(0===t)return 0;var n=e,i=o.saveEye.clone().sub(worldUp.clone().multiplyScalar(r+n)),a=o.saveEye.clone().sub(worldUp.clone().multiplyScalar(r)),s=0,l=(o.maxSceneBound-o.minSceneBound)/1e3;o.topLimit&&t>0?(s=o.maxSceneBound-l,o.topLimit=!1):o.bottomLimit&&t<0?(s=o.minSceneBound+l,o.bottomLimit=!1):s=i.dot(worldUp);var u=a.dot(worldUp);return s<o.minSceneBound?u<o.minSceneBound&&(o.bottomLimit=!0,n=0):s>o.maxSceneBound&&u>o.maxSceneBound&&(o.topLimit=!0,n=0),n}(i,e,o.m_amount),i}function G(e){var t=o.sceneFrontDirection.clone().cross(o.sceneUpDirection),r=Math.abs(Math.abs(e.dot(o.sceneUpDirection))-1),n=Math.abs(Math.abs(e.dot(o.sceneFrontDirection))-1),i=Math.abs(Math.abs(e.dot(t))-1);return r<l||n<l||i<l}this.viewCubeMenuOpen=!1,this.menuSize=new n.Vector2(0,0),this.menuOrigin=new n.Vector2(0,0),e.lookAt(this.center),this.setCube=function(e){this.cube=e},this.sync=function(t){t.isPerspective!==e.isPerspective&&(t.isPerspective?e.toPerspective():(e.toOrthographic(),t.saveFov&&(e.saveFov=t.saveFov))),e.fov=t.fov,e.position.copy(t.position),t.target&&(this.center.copy(t.target),e.target.copy(t.target)),t.pivot&&(this.pivot.copy(t.pivot),e.pivot.copy(t.pivot)),this.dir.copy(this.center).sub(e.position),this.setCameraUp(t.up);var r=t.worldup?t.worldup:t.up;r.distanceToSquared(this.sceneUpDirection)>1e-4&&this.setWorldUpVector(r),p&&!this.navApi.getTransitionActive()&&(p=!1,this.setCurrentViewAsHome(!1)),this.cube&&requestAnimationFrame(this.cube.render)},this.refresh=function(){this.cube&&this.cube.refreshCube()},n.Matrix3.prototype.makeRotationFromQuaternion=function(e){var t=this.elements,r=e.x,n=e.y,i=e.z,o=e.w,a=r+r,s=n+n,l=i+i,u=r*a,c=r*s,h=r*l,d=n*s,f=n*l,p=i*l,m=o*a,g=o*s,v=o*l;return t[0]=1-(d+p),t[3]=c-v,t[6]=h+g,t[1]=c+v,t[4]=1-(u+p),t[7]=f-m,t[2]=h-g,t[5]=f+m,t[8]=1-(u+d),this},n.Quaternion.prototype.setFromRotationMatrix3=function(e){var t,r=e.elements,n=r[0],i=r[3],o=r[6],a=r[1],s=r[4],l=r[7],u=r[2],c=r[5],h=r[8],d=n+s+h;return d>0?(t=.5/Math.sqrt(d+1),this.w=.25/t,this.x=(c-l)*t,this.y=(o-u)*t,this.z=(a-i)*t):n>s&&n>h?(t=2*Math.sqrt(1+n-s-h),this.w=(c-l)/t,this.x=.25*t,this.y=(i+a)/t,this.z=(o+u)/t):s>h?(t=2*Math.sqrt(1+s-n-h),this.w=(o-u)/t,this.x=(i+a)/t,this.y=.25*t,this.z=(l+c)/t):(t=2*Math.sqrt(1+h-n-s),this.w=(a-i)/t,this.x=(o+u)/t,this.y=(l+c)/t,this.z=.25*t),this},n.Quaternion.prototype.rotate=function(e){var t=(new n.Matrix4).makeRotationFromQuaternion(this).elements,r=(new n.Matrix3).set(t[0],t[1],t[2],t[4],t[5],t[6],t[8],t[9],t[10]);return e.applyMatrix3(r)},this.animateTransition=function(t){if(g(t,e.globalOffset),t){var r=!1,n=0;if(this.setCameraOrtho(t.isOrtho),o.elapsedTime>=R.duration)return n=1,o.center.copy(t.center),o.pivot.copy(t.pivot),e.position.copy(t.position),e.up.copy(t.up),e.target.copy(t.center),t.isOrtho||(e.fov=t.fov),e.dirty=!0,(r=!t.worldUp.equals(this.sceneUpDirection))&&this.setWorldUpVector(t.worldUp),this.currentlyAnimating=!1,m(r),this.showPivot(!1),this.cube&&requestAnimationFrame(this.cube.render),this.navApi.setTransitionActive(!1),void this.transitionCompletedCallback();this.currentlyAnimating=!0,this.showPivot(!0),this.navApi.setTransitionActive(!0);var i=R.destinationPercent,a=1-(n=O(o.elapsedTime/R.duration,0,i));o.elapsedTime+=d/500;var s=o.center.clone().multiplyScalar(a).add(t.center.clone().multiplyScalar(n)),l=e.position.clone().multiplyScalar(a).add(t.position.clone().multiplyScalar(n)),u=e.up.clone().multiplyScalar(a).add(t.up.clone().multiplyScalar(n)),c=e.pivot.clone().multiplyScalar(a).add(t.pivot.clone().multiplyScalar(n)),h=this.sceneUpDirection.clone().multiplyScalar(a).add(t.worldUp.clone().multiplyScalar(n)),f=e.fov*a+t.fov*n;o.center.copy(s),o.pivot.copy(c),e.position.copy(l),e.up.copy(u),e.target.copy(s),t.isOrtho||(e.fov=f),e.dirty=!0,(r=h.distanceToSquared(this.sceneUpDirection)>1e-4)&&this.setWorldUpVector(h),e.lookAt(o.center),m(r),this.cube&&requestAnimationFrame(this.cube.render),o.afAnimateTransition=requestAnimationFrame((function(){o.animateTransition(t)}))}},this.sphericallyInterpolateTransition=function(t){var r,i,a,s,l=0;if(this.currentlyAnimating=!0,this.navApi.setTransitionActive(!0),o.elapsedTime>=R.duration)l=1,this.currentlyAnimating=!1;else{var u=R.destinationPercent;l=O(o.elapsedTime/R.duration,0,u),o.elapsedTime+=d/500}if(1===l)i=L.position,r=L.center,a=L.up;else{var c=new n.Matrix3,h=M.clone();h.slerp(T,l),c.makeRotationFromQuaternion(h);var f=A*(1-(s=l))+S*s,p=c.elements;i=(r=D.center.clone().multiplyScalar(1-l).add(L.center.clone().multiplyScalar(l))).clone().sub(new n.Vector3(p[0],p[1],p[2]).multiplyScalar(f)),a=new n.Vector3(p[3],p[4],p[5])}o.center.copy(r),e.position.copy(i),e.up.copy(a),o.navApi.getUsePivotAlways()||o.pivot.copy(r),e.lookAt(o.center),!0===this.currentlyAnimating?(this.showPivot(!0),requestAnimationFrame((function(){o.sphericallyInterpolateTransition(t)}))):(this.navApi.setTransitionActive(!1),this.showPivot(!1),this.orthographicFaces&&this.isFaceView()&&this.setCameraOrtho(!0),t&&t()),m(!1),this.cube&&requestAnimationFrame(this.cube.render)},this.getOrientation=function(){if(this.cube){var t=N(e.up.x),r=N(e.up.y),n=N(e.up.z),i=this.sceneFrontDirection.clone(),o=this.sceneUpDirection.clone(),a=this.sceneFrontDirection.clone().cross(this.sceneUpDirection).normalize();i.x=N(i.x),i.y=N(i.y),i.z=N(i.z),o.x=N(o.x),o.y=N(o.y),o.z=N(o.z),a.x=N(a.x),a.y=N(a.y),a.z=N(a.z);var s=a.clone().multiplyScalar(-1),l=o.clone().multiplyScalar(-1),u=i.clone().multiplyScalar(-1);switch(this.cube.currentFace){case"front":if(o.x==t&&o.y==r&&o.z==n)return"up";if(l.x==t&&l.y==r&&l.z==n)return"down";if(a.x==t&&a.y==r&&a.z==n)return"right";if(s.x==t&&s.y==r&&s.z==n)return"left";break;case"right":if(o.x==t&&o.y==r&&o.z==n)return"up";if(l.x==t&&l.y==r&&l.z==n)return"down";if(u.x==t&&u.y==r&&u.z==n)return"left";if(i.x==t&&i.y==r&&i.z==n)return"right";break;case"left":if(o.x==t&&o.y==r&&o.z==n)return"up";if(l.x==t&&l.y==r&&l.z==n)return"down";if(i.x==t&&i.y==r&&i.z==n)return"left";if(u.x==t&&u.y==r&&u.z==n)return"right";break;case"back":if(o.x==t&&o.y==r&&o.z==n)return"up";if(l.x==t&&l.y==r&&l.z==n)return"down";if(s.x==t&&s.y==r&&s.z==n)return"right";if(a.x==t&&a.y==r&&a.z==n)return"left";break;case"top":if(u.x==t&&u.y==r&&u.z==n)return"down";if(i.x==t&&i.y==r&&i.z==n)return"up";if(a.x==t&&a.y==r&&a.z==n)return"right";if(s.x==t&&s.y==r&&s.z==n)return"left";break;case"bottom":if(i.x==t&&i.y==r&&i.z==n)return"down";if(u.x==t&&u.y==r&&u.z==n)return"up";if(a.x==t&&a.y==r&&a.z==n)return"right";if(s.x==t&&s.y==r&&s.z==n)return"left"}}},this.setCameraOrtho=function(t){t&&e.isPerspective&&e.toOrthographic(),t||e.isPerspective||e.toPerspective()},this.resetOrientation=function(){this.cube&&this.cube.showCompass(this.cube.prevRenderCompass),this.setCameraOrtho(this.originalHomeVector.isOrtho),this.sceneUpDirection.copy(this.originalHomeVector.worldUp),this.sceneFrontDirection.copy(this.originalHomeVector.worldFront),this.cubeFront.copy(this.sceneFrontDirection).cross(this.sceneUpDirection).normalize(),this.setCameraUp(this.sceneUpDirection),m(!0)},this.setCurrentViewAsFront=function(){this.cube&&(this.cube.currentFace="front",this.cube.showCompass(!1)),this.sceneUpDirection.copy(e.up.clone()),u(this.sceneUpDirection),this.sceneFrontDirection.copy(this.getView()).normalize(),u(this.sceneFrontDirection),this.cubeFront.copy(this.sceneFrontDirection).cross(this.sceneUpDirection).normalize(),u(this.cubeFront),this.orthographicFaces&&this.setCameraOrtho(!0),m(!0)},this.setCurrentViewAsTop=function(){this.cube&&(this.cube.currentFace="top",this.cube.showCompass(!1)),this.sceneUpDirection.copy(this.getView()).multiplyScalar(-1).normalize(),u(this.sceneUpDirection),this.sceneFrontDirection.copy(e.up),u(this.sceneFrontDirection),this.cubeFront.copy(this.sceneFrontDirection).cross(this.sceneUpDirection).normalize(),u(this.cubeFront),m(!0)},this.calculateCubeTransform=function(t){var r=this.sceneUpDirection.clone(),i=this.sceneFrontDirection.clone(),a=this.sceneFrontDirection.clone().cross(this.sceneUpDirection).normalize();(D=e.clone()).center=o.center.clone(),D.pivot=o.pivot.clone(),(L=e.clone()).center=o.center.clone(),L.pivot=o.pivot.clone();var l=new n.Vector3(0,0,0);t.indexOf("back")>=0&&(l=l.add(i)),t.indexOf("front")>=0&&(l=l.sub(i)),t.indexOf("top")>=0&&(l=l.add(r)),t.indexOf("bottom")>=0&&(l=l.sub(r)),t.indexOf("right")>=0&&(l=l.add(a)),t.indexOf("left")>=0&&(l=l.sub(a));var u=r,c=l.clone().normalize();if(1-Math.abs(c.dot(r))<s)for(var h=this.getView().normalize(),d=[i.clone(),i.clone().negate(),a.clone(),a.clone().negate()],f=c.dot(r)>0?1:-1,p=h.clone().add(e.up.clone().multiplyScalar(f)).normalize(),m=-2,g=0;g<4;g++){var v=p.dot(d[g]);v>m&&(m=v,u=d[g].multiplyScalar(f))}S=A=this.getView().length(),L.position.copy(L.center.clone().add(l.multiplyScalar(S/l.length()))),L.up.copy(u);var y=D.center.clone().sub(D.position).normalize(),b=y.clone().cross(D.up).normalize(),x=b.clone().cross(y).normalize(),_=new n.Matrix3;_.set(y.x,x.x,b.x,y.y,x.y,b.y,y.z,x.z,b.z),M.setFromRotationMatrix3(_),x=(b=(y=L.center.clone().sub(L.position).normalize()).clone().cross(L.up).normalize()).clone().cross(y).normalize(),_.set(y.x,x.x,b.x,y.y,x.y,b.y,y.z,x.z,b.z),C.setFromAxisAngle(y,0),P.setFromAxisAngle(x,0),T.setFromRotationMatrix3(_),T.multiply(C).multiply(P).normalize()},this.drawDropdownMenu=function(e,t,r,n,o,a,s){var l=0,u=this.getDocument();if(c)a.appendChild(c);else{(c=u.createElement("div")).className="dropDownMenu",c.style.top="100px",c.style.left="-400px";for(var h=0,d=0,f=0;f<e.length;f++){var p;if(null===e[f])(p=u.createElement("li")).style.height="1px",h+=1,p.style.backgroundColor="#E0E0E0";else{var m=i.Z.t(e[f]);if(d=m.length>d?m.length:d,r[f]){p=u.createElement("div");var g=u.createElement("input"),v=u.createElement("label");g.type="radio",g.className="dropDownMenuCheck",v.innerHTML=m,v.className="dropDownMenuCheckText",p.appendChild(g),p.appendChild(v),p.className="dropDownMenuCheckbox"}else(p=u.createElement("li")).textContent=m,p.className=t[f]?"dropDownMenuItem":"dropDownMenuItemDisabled";p.id="menuItem"+l,l++,h+=25,p.setAttribute("data-i18n",e[f])}c.appendChild(p)}a.appendChild(c),c.style.minWidth=Math.max(256,7.4*d)+"px";var y=c.getBoundingClientRect().width;this.menuSize.x=y,this.menuSize.y=h}l=0;for(f=0;f<e.length;f++)if(null!==e[f]){if(r[f]){var b="menuItem"+l,x=u.getElementById(b);x&&(x.children[0].checked=r[f]())}l++}var _=o-15,E=n+1,w=this.canvas.getBoundingClientRect();E+this.menuSize.x>w.right&&(E=n-this.menuSize.x-1),_+this.menuSize.y>w.bottom&&(_=w.bottom-this.menuSize.y),_-=s.y,E-=s.x,c.style.top=_+"px",c.style.left=E+"px",this.menuOrigin.x=E,this.menuOrigin.y=_},this.removeDropdownMenu=function(e){e.removeChild(c)},this.isFaceView=function(){return G(this.center.clone().sub(e.position).normalize())&&G(e.up)},this.startInteraction=function(e,t){this.startCursor=new n.Vector2(e,t),this.startState={saveCenter:this.center.clone(),saveEye:this.camera.position.clone(),savePivot:this.pivot.clone(),saveUp:this.camera.up.clone()},this.lockDeltaX=0,this.lockedX=!1,this.lastSnapRotateX=0,this.lockDeltaY=0,this.lockedY=!1,this.lastSnapRotateY=0,this.lastSnapDir=new n.Vector3(0,0,0),this.navApi.setTransitionActive(!0)},this.orbit=function(t,r,i,a){if(this.navApi.isActionEnabled("orbit")&&!0!==this.currentlyAnimating){var s="wheel";if(o.orthographicFaces&&!e.isPerspective&&(e.toPerspective(),a&&a.saveEye.copy(this.camera.position)),a&&(s="cube"),"cube"==s?(this.saveCenter.copy(a.saveCenter),this.saveEye.copy(a.saveEye),this.savePivot.copy(a.savePivot),this.saveUp.copy(a.saveUp),this.useSnap=!0,this.doCustomOrbit=!0):(this.saveCenter.copy(this.center),this.savePivot.copy(this.pivot),this.saveEye.copy(e.position),this.saveUp.copy(e.up),this.useSnap=!1,this.doCustomOrbit=!1),V()&&null==b&&(b=this.saveCenter.clone(),v=this.saveEye.clone(),E=this.savePivot.clone(),_=this.saveUp.clone()),this.preserveOrbitUpDirection){var l=k(t.x-r.x,t.y-r.y),u=k(i.x,i.y),c=this.sceneUpDirection.clone(),h=this.sceneFrontDirection.clone(),d=this.sceneFrontDirection.clone().cross(this.sceneUpDirection).normalize(),f=V()?E:this.savePivot,p=V()?v:this.saveEye,g=V()?b:this.saveCenter,y=V()?_:this.saveUp,x=f.clone().sub(p).normalize(),w=g.clone().sub(p).normalize(),A=w.clone().cross(y),S=p.clone().sub(f).length(),M=p.clone().sub(g).length(),T=x.clone().multiplyScalar(-1),C=w.clone().multiplyScalar(-1),P=A,D=y.clone();if(!this.constrainOrbitHorizontal){c.dot(this.saveUp)<-.009&&(l.x=-l.x,u.x=-u.x);var L=0;L=V()?u.x*this.orbitMultiplier:this.useSnap?this.lastSnapRotateX+F("h",0,-u.x):l.x*this.orbitMultiplier,this.lastSnapRotateX=L;var R=(new n.Quaternion).setFromAxisAngle(c,-L);T.applyQuaternion(R),C.applyQuaternion(R),P.applyQuaternion(R),D.applyQuaternion(R)}if(!this.constrainOrbitVertical){var I=h.clone().multiplyScalar(h.dot(P)),O=d.clone().multiplyScalar(d.dot(P)),N=I.clone().add(O);N.clone().normalize();var U=0;if(V())U=u.y*this.orbitMultiplier;else{var B=F("v",0,u.y);U=this.useSnap?this.lastSnapRotateY+B:l.y*this.orbitMultiplier}var z=(new n.Quaternion).setFromAxisAngle(N,-U);if(this.navApi.getOrbitPastWorldPoles())T.applyQuaternion(z).normalize(),C.applyQuaternion(z).normalize(),D.applyQuaternion(z).normalize();else{var G=D.clone();if(G.applyQuaternion(z).normalize(),c.dot(G)<0){var H=C.clone();H.applyQuaternion(z).normalize();var W=H.angleTo(c);Math.abs(W)>.5*Math.PI&&(W-=W>0?Math.PI:-Math.PI),U-=W,z.setFromAxisAngle(N,-U),T.applyQuaternion(z).normalize(),C.applyQuaternion(z).normalize(),D.applyQuaternion(z).normalize()}else T.applyQuaternion(z).normalize(),C.applyQuaternion(z).normalize(),D.applyQuaternion(z).normalize()}this.lastSnapRotateY=U}var j=T.multiplyScalar(S).add(f);e.position.copy(j),e.up.copy(D),this.center.copy(j),this.center.sub(C.multiplyScalar(M)),V()&&(b.copy(this.center),v.copy(e.position),E.copy(this.pivot),_.copy(e.up))}e.lookAt(this.center),m(!1)}},this.endInteraction=function(){this.navApi.setTransitionActive(!1)},this.look=function(t){if(this.navApi.isActionEnabled("walk")){var r=k(t.x,t.y),i=this.userLookSpeed,o=this.getView(),a=e.up,s=o.clone().cross(a).normalize(),l=this.sceneUpDirection.clone(),u=r.clone();u.x*=Math.PI,u.y*=Math.PI/e.aspect,u.multiplyScalar(i);var c=(new n.Quaternion).setFromAxisAngle(s,-u.y);if(e.keepSceneUpright&&!this.navApi.getOrbitPastWorldPoles()){var h=a.clone();if(h.applyQuaternion(c).normalize(),h.dot(l)<0){var d=o.clone();d.applyQuaternion(c);var f=d.angleTo(l);Math.abs(f)>.5*Math.PI&&(f-=f>0?Math.PI:-Math.PI),u.y-=f,c.setFromAxisAngle(s,-u.y)}}o=c.clone().rotate(o),(a=c.clone().rotate(a)).normalize();var p=e.keepSceneUpright?l:a,g=(new n.Quaternion).setFromAxisAngle(p,-u.x);o=g.clone().rotate(o),a=g.clone().rotate(a),this.center.copy(o.add(e.position)),e.up.copy(a),e.lookAt(this.center),m(!1)}},this.pan=function(t){if(this.navApi.isActionEnabled("pan")){t=k(t.x,t.y);var r=this.getView(),i=e.up.clone().cross(r),o=r.clone().cross(i);i.normalize(),o.normalize(),r.normalize();var a=this.pivot.clone().sub(e.position),s=r.clone().dot(a),l=s*(Math.tan(n.Math.degToRad(e.leftFov))+Math.tan(n.Math.degToRad(e.rightFov))),u=s*(Math.tan(n.Math.degToRad(e.topFov))+Math.tan(n.Math.degToRad(e.bottomFov))),c=t.x*Math.abs(l),h=t.y*Math.abs(u),d=new n.Vector3,f=i.clone().multiplyScalar(c),p=o.clone().multiplyScalar(h);d=f.clone().add(p).clone().multiplyScalar(this.userPanSpeed),e.position.add(d),this.center.add(d),e.lookAt(this.center),m(!1)}},this.zoom=function(t){if(this.navApi.isActionEnabled("zoom")){var r=this.userZoomSpeed,n=Number.MAX_VALUE,i=t.x+t.y,a=Math.pow(r,i),s=this.pivot.clone().sub(this.pivot.clone().sub(this.saveEye).clone().multiplyScalar(a)),l=s.clone().add(o.D.clone().multiplyScalar(o.D.clone().dot(this.pivot.clone().sub(s).clone())));if(!(a>=n)){if(i>0){Math.pow(r,i-0);if(i<0)return void 0;e.position.copy(s),this.center.copy(l);var u=s.clone().sub(this.saveEye).dot(o.D);u>n?(e.position.copy(this.saveEye.sub(o.D).clone().multiplyScalar(n)),n>0?-1:0):-u/n}else e.position.copy(s),this.center.copy(l);e.lookAt(this.center),m(!1)}}},this.walk=function(t,r,i,o,a){if(this.navApi.isActionEnabled("walk")){var l=this.sceneUpDirection.clone(),u=this.sceneFrontDirection.clone(),c=this.sceneFrontDirection.clone().cross(this.sceneUpDirection);U(t,r)?(wheel.cursorImage("SWWalk"),B(!0,t,r),x=r.x,y=r.y):B(!1,t,r),x=t.x,y=t.y;var h=k(x-r.x,y-r.y),d=-h.x,f=-h.y,p=d<0?-1:1,g=f<0?-1:1,v=Math.abs(d),b=Math.abs(f),_=new n.Vector2(30,30);_=k(_.x,_.y),v=U(t,r)?0:Math.abs(d)-_.x,b=U(t,r)?0:Math.abs(f)-_.y;b/=.25;var E=(v=(v/=.25)<1?O(v,0,1):Math.pow(v,1))>0?v*p:0,w=(b=b<1?O(b,0,1):Math.pow(b,1))>0?b*g:0,A=this.getView(),S=A.length();A.normalize(),A.clone().cross(e.up).normalize();var M=c.clone().multiplyScalar(c.clone().dot(A)),T=u.clone().multiplyScalar(u.clone().dot(A)).clone().add(M);T=T.clone().length()>s?T.normalize():e.up;var C=w*(1*this.walkMultiplier),P=T,D=Math.cos(.65);1!=D&&(l.clone().dot(e.up)<-s&&l.clone().dot(A)<-D||l.clone().dot(e.up)>s&&l.clone().dot(A)>D)&&(P=-P);var L=-E*this.walkMultiplier*.05,R=e.up;(l.clone().dot(e.up)<-s||Math.abs(l.clone().dot(e.up))<s&&l.clone().dot(A)>s)&&(L=-L),R=l;var I=(new n.Quaternion).setFromAxisAngle(R,L);I.normalize(),(A=I.clone().rotate(A)).normalize(),e.up.copy(I.clone().rotate(e.up)),e.up.normalize(),e.position.add(P.clone().multiplyScalar(C)),this.center.copy(e.position.clone().add(A.clone().multiplyScalar(S))),(P=l).normalize(),0===C&&(C=.01),e.lookAt(this.center),m(!1)}},this.updown=function(t){if(!this.navApi.getIsLocked()){var r=z(t);o.m_amount+=r;var i=new n.Vector3(0,1,0),a=o.saveEye.clone().sub(i.clone().multiplyScalar(o.m_amount)),s=a.clone().dot(i);e.position.copy(a),s<o.minSceneBound&&e.position.add(i.clone().multiplyScalar(o.minSceneBound-s)),s>o.maxSceneBound&&e.position.add(i.clone().multiplyScalar(o.maxSceneBound-s)),this.center.copy(e.position.clone().add(o.saveCenter.clone().sub(o.saveEye))),e.lookAt(this.center),m(!1)}}}o.GlobalManagerMixin.call(c.prototype)},98265:(e,t,r)=>{"use strict";function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var i=(0,r(84998).getGlobal)();function o(){this.stop=null,this.isRunning=!0}function a(e,t,r,n,a){var s=performance.now(),l=1e3*r,u=0,c=new o;c.stop=function(){u&&i.cancelAnimationFrame(u),c.isRunning=!1},c.skip=function(){c.isRunning&&(n(t),c.stop(),a&&a())};return function r(o){var h=(o-s)/l;h=Math.max(h,0),h=Math.min(h,1),n(e+h*(t-e)),h<1?u=i.requestAnimationFrame(r):(c.isRunning=!1,a&&a())}(s),c}var s,l=function(){function e(t,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.setValueCb=r,this.animTime=n,this.fadeAnim=null,this.targetValue=t,this.curValue=t,r(t),this.pendingFinishedCallbacks=[]}var t,r,i;return t=e,(r=[{key:"stopAnim",value:function(){this.fadeAnim&&(this.fadeAnim.stop(),this.fadeAnim=null)}},{key:"_onAnimEnded",value:function(){this.pendingFinishedCallbacks.forEach((function(e){return e()})),this.pendingFinishedCallbacks.length=0}},{key:"fadeTo",value:function(e,t){var r=this,n=this.fadeAnim&&this.fadeAnim.isRunning;n||this.curValue!=e?(t&&this.pendingFinishedCallbacks.push(t),n&&e===this.targetValue||(this.stopAnim(),this.targetValue=e,this.fadeAnim=a(this.curValue,this.targetValue,this.animTime,(function(e){e=c(e),r.curValue=e,r.setValueCb(e)}),(function(){return r._onAnimEnded()})))):t&&t()}},{key:"skipAnim",value:function(){this.fadeAnim&&this.fadeAnim.skip()}},{key:"setValue",value:function(e){this.stopAnim(),this.curValue=e,this.setValueCb(e)}}])&&n(t.prototype,r),i&&n(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();function u(e,t,r){return(1-r)*e+r*t}function c(e){return THREE.Math.smootherstep(e,0,1)}function h(e){var t=new THREE.Vector3,r=new THREE.Vector3,n=new THREE.Vector3,i=new THREE.Vector3,o=new THREE.Vector3,a=new THREE.Vector3,s=0,l=0,h=new THREE.Quaternion,d=new THREE.Quaternion,f=new THREE.Vector3,p=new THREE.Quaternion,m=new THREE.Object3D;new THREE.Matrix4;function g(e,t,r,n){Autodesk.Viewing.Navigation.prototype.orient(m,r,t,n),e.copy(m.quaternion)}function v(){g(h,t,r,n),g(d,i,o,a)}this.init=function(e,u,c,h){var d=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];t.copy(e.position),r.copy(e.target),n.copy(d?e.worldup:e.up),i.copy(u),o.copy(c),a.copy(d?e.worldup:h),s=t.distanceTo(r),l=i.distanceTo(o),v()},this.updateCamera=function(e,r){var n=c(e);r.position.lerpVectors(t,i,n),THREE.Quaternion.slerp(h,d,p,n),p.normalize();var o=u(s,l,n);!function(e,t,r){f.set(0,0,-r).applyQuaternion(t),e.target.addVectors(e.position,f),f.set(0,1,0).applyQuaternion(t),e.up.copy(f)}(r,p,o),r.dirty=!0},this.updateViewerCamera=function(e,t){this.updateCamera(e,t.impl.camera),t.impl.syncCamera(),t.impl.invalidate(!0,!0)}}e.exports={flyToView:function(e,t,r,n){var i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];s||(s=new h),r=r||2;var o=e.impl.camera;s.init(o,t.position,t.target,t.up,i);var l=function(t){s.updateViewerCamera(t,e)};return a(0,1,r,l,n)},ShadowFader:function(e,t,r){var n=1,i=null,o=t,s=void 0,l=r;function u(t){n=t,e.impl.setGroundShadowAlpha(t)}function c(){i=null,l&&l(s)}this.shadowOn=function(){i&&s||(i&&!s&&(i.stop(),i=null),n>=1||(i=a(n,1,o*(1-n),u,c),s=!0))},this.shadowOff=function(){i&&!s||(i&&s&&(i.stop(),i=null),n<=0||(i=a(n,0,o*n,u,c),s=!1))},this.isFading=function(){return i&&i.isRunning}},lerp:u,smootherStep:c,fadeValue:a,AnimatedParam:l}},96651:(e,t,r)=>{"use strict";function n(e,t,r,n,i,o,a){try{var s=e[o](a),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,i)}function i(e,t){try{WebAssembly.instantiateStreaming||(WebAssembly.instantiateStreaming=function(){var e,t=(e=regeneratorRuntime.mark((function e(t,r){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t;case 2:return e.next=4,e.sent.arrayBuffer();case 4:return n=e.sent,e.next=7,WebAssembly.instantiate(n,r);case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e)})),function(){var t=this,r=arguments;return new Promise((function(i,o){var a=e.apply(t,r);function s(e){n(a,i,o,s,l,"next",e)}function l(e){n(a,i,o,s,l,"throw",e)}s(void 0)}))});return function(e,r){return t.apply(this,arguments)}}())}catch(e){throw new Error("WebAssembly is not supported for the current browser.")}if(!e)throw new Error("Expecting a wasm file path.");var r=256,i=256;t&&t.memory&&(r=t.memory.initial,i=t.memory.maximum),this._wasmPath=e,this._memory=new WebAssembly.Memory({initial:r,maximum:i})}r.r(t),r.d(t,{Wasm:()=>i}),i.prototype.constructor=i,i.prototype.instantiate=function(){var e=this,t={env:{abortStackOverflow:function(e){throw new Error("overflow")},table:new WebAssembly.Table({initial:0,maximum:0,element:"anyfunc"}),__table_base:0,memory:this._memory,__memory_base:1024,STACKTOP:0,STACK_MAX:this.getBuffer().byteLength}};return new Promise((function(r,n){try{WebAssembly.instantiateStreaming(fetch(e._wasmPath),t).then((function(t){var n=t.instance.exports;e.proxy=n,r(n)}))}catch(e){n(e)}}))},i.prototype.getBuffer=function(){return this._memory.buffer}},92445:(e,t,r)=>{"use strict";r.r(t),r.d(t,{memoryOptimizedLoading:()=>i,GPU_MEMORY_LIMIT:()=>o,GPU_OBJECT_LIMIT:()=>a,USE_VAO:()=>s,GEOMETRY_OVERHEAD:()=>l,PIXEL_CULLING_THRESHOLD:()=>u});var n=r(84998),i=!0,o=1024*((0,n.isMobileDevice)()?64:256)*1024,a=(0,n.isMobileDevice)()?2500:1e4,s=!(0,n.isMobileDevice)(),l=336,u=1},69632:(e,t,r)=>{"use strict";r.d(t,{Q:()=>l});var n=r(23909),i=r(59047),o=r.n(i),a=r(2867),s=r.n(a),l={uniforms:{color1:{type:"v3",value:new n.Vector3(41/255,76/255,120/255)},color2:{type:"v3",value:new n.Vector3(1/255,2/255,3/255)},opacity:{type:"f",value:1},envMap:{type:"t",value:null},envRotationSin:{type:"f",value:0},envRotationCos:{type:"f",value:1},exposureBias:{type:"f",value:1},envMapExposure:{type:"f",value:1},uCamDir:{type:"v3",value:new n.Vector3},uCamUp:{type:"v3",value:new n.Vector3},uResolution:{type:"v2",value:new n.Vector2(600,400)},uHalfFovTan:{type:"f",value:.5},envMapBackground:{type:"i",value:0},backgroundTexture:{type:"t",value:null}},vertexShader:o(),fragmentShader:s()}},68538:(e,t,r)=>{"use strict";r.r(t),r.d(t,{BasicShader:()=>f});var n,i,o=r(23909),a=r(12990),s=r(75101),l=r.n(s),u=r(48544),c=r.n(u);function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}i=l(),n=c();var d,f={uniforms:o.UniformsUtils.merge([o.UniformsLib.common,o.UniformsLib.fog,o.UniformsLib.shadowmap,a.ShaderChunks.CutPlanesUniforms,a.ShaderChunks.IdUniforms,a.ShaderChunks.ThemingUniform,a.ShaderChunks.PointSizeUniforms,a.ShaderChunks.WideLinesUniforms,a.ShaderChunks.DepthTextureTestUniforms].concat((d=[],function(e){if(Array.isArray(e))return h(e)}(d)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(d)||function(e,t){if(e){if("string"==typeof e)return h(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?h(e,t):void 0}}(d)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()))),vertexShader:i,fragmentShader:n};o.ShaderLib.firefly_basic=f},21995:(e,t,r)=>{"use strict";r.r(t),r.d(t,{CelShader:()=>u});var n=r(23909),i=r(12990),o=r(66209),a=r.n(o),s=r(40518),l=r.n(s),u={uniforms:n.UniformsUtils.merge([i.ShaderChunks.DepthTextureUniforms,{tDiffuse:{type:"t",value:null},tID:{type:"t",value:null},resolution:{type:"v2",value:new n.Vector2(1/1024,1/512)},cameraNear:{type:"f",value:1},cameraFar:{type:"f",value:100},tFill:{type:"t",value:null},tPaper:{type:"t",value:null},style:{type:"i",value:0},idEdges:{type:"i",value:1},normalEdges:{type:"i",value:1},depthEdges:{type:"i",value:1},brightness:{type:"f",value:0},contrast:{type:"f",value:0},grayscale:{type:"i",value:0},preserveColor:{type:"i",value:0},levels:{type:"f",value:6},repeats:{type:"f",value:3},rotation:{type:"f",value:0},outlineRadius:{type:"f",value:1},outlineNoise:{type:"i",value:0},tGraphite1:{type:"t",value:null},tGraphite2:{type:"t",value:null},tGraphite3:{type:"t",value:null},tGraphite4:{type:"t",value:null},tGraphite5:{type:"t",value:null},tGraphite6:{type:"t",value:null},tGraphite7:{type:"t",value:null},tGraphite8:{type:"t",value:null}}]),vertexShader:a(),fragmentShader:l()}},61768:(e,t,r)=>{"use strict";r.r(t),r.d(t,{CopyShader:()=>s});var n=r(66209),i=r.n(n),o=r(67086),a=r.n(o),s={uniforms:{tDiffuse:{type:"t",value:null}},vertexShader:i(),fragmentShader:a()}},4388:(e,t,r)=>{"use strict";r.r(t),r.d(t,{CreateCubeMapFromColors:()=>a,DecodeEnvMap:()=>f});var n=r(23909),i=r(96890),o=r(98926);function a(e,t){for(var r=255*e.x,i=255*e.y,o=255*e.z,a=255*t.x,s=255*t.y,l=255*t.z,u=new Uint8Array(16),c=new Uint8Array(16),h=new Uint8Array(16),d=0;d<4;d++)u[4*d]=r,u[4*d+1]=i,u[4*d+2]=o,u[4*d+3]=255,c[4*d]=a,c[4*d+1]=s,c[4*d+2]=l,c[4*d+3]=255,d>1?(h[4*d]=r,h[4*d+1]=i,h[4*d+2]=o,h[4*d+3]=255):(h[4*d]=a,h[4*d+1]=s,h[4*d+2]=l,h[4*d+3]=255);var f=new n.DataTexture(h,2,2,n.RGBAFormat),p=new n.DataTexture(h,2,2,n.RGBAFormat),m=new n.DataTexture(c,2,2,n.RGBAFormat),g=new n.DataTexture(u,2,2,n.RGBAFormat),v=new n.DataTexture(h,2,2,n.RGBAFormat),y=new n.DataTexture(h,2,2,n.RGBAFormat),b=new n.Texture(null,n.CubeReflectionMapping,n.RepeatWrapping,n.RepeatWrapping,n.LinearFilter,n.LinearFilter,n.RGBAFormat);return b.image=[p,f,g,m,y,v],b.needsUpdate=!0,b}var s=[6.0014,-2.7008,-1.7996,-1.332,3.1029,-5.7721,.3008,-1.0882,5.6268];function l(e,t){var r=255*t[2]+t[3],n=Math.pow(2,(r-127)/2),i=n/t[1],o=t[0]*i,a=s[0]*o+s[3]*n+s[6]*i,l=s[1]*o+s[4]*n+s[7]*i,u=s[2]*o+s[5]*n+s[8]*i;a<0&&(a=0),l<0&&(l=0),u<0&&(u=0),e[0]=a,e[1]=l,e[2]=u}function u(e,t,r){var n=.0625*Math.sqrt(t[0]*r),i=.0625*Math.sqrt(t[1]*r),o=.0625*Math.sqrt(t[2]*r),a=Math.max(Math.max(n,i),Math.max(o,1e-6));a>1&&(a=1);var s=Math.ceil(255*a)/255;n>1&&(n=1),i>1&&(i=1),o>1&&(o=1),e[3]=s;var l=1/s;e[0]=n*l,e[1]=i*l,e[2]=o*l}function c(e,t,r){var n=Math.sqrt(t[0]*r),i=Math.sqrt(t[1]*r),o=Math.sqrt(t[2]*r),a=65504;n>a&&(n=a),i>a&&(i=a),o>a&&(o=a),e[0]=n,e[1]=i,e[2]=o}var h=new Float32Array(4),d=new Float32Array(4);function f(e,t,r,a){if(e.LogLuv){for(var s=Math.pow(2,t),f=Array.isArray(e.image)?e.image:[e.image],p=0;p<f.length;p++)for(var m=f[p],g=0;g<m.mipmaps.length;g++){var v,y=m.mipmaps[g],b=y.data;r?(v=new Uint16Array(b.length/4*3),y.data=v):v=b.buffer;for(var x=0,_=0;_<b.length;_+=4)h[0]=b[_]/255,h[1]=b[_+1]/255,h[2]=b[_+2]/255,h[3]=b[_+3]/255,l(d,h),r?(c(h,d,s),v[x++]=(0,i.FloatToHalf)(h[0]),v[x++]=(0,i.FloatToHalf)(h[1]),v[x++]=(0,i.FloatToHalf)(h[2])):(u(h,d,s),b[_]=Math.round(255*h[0]),b[_+1]=Math.round(255*h[1]),b[_+2]=Math.round(255*h[2]),b[_+3]=Math.round(255*h[3]))}e.LogLuv=!1,r?(e.type=n.HalfFloatType,e.format=n.RGBFormat,e.RGBM=!1,e.GammaEncoded=!0):e.RGBM=!0,a&&a(e)}else o.logger.warn("Environment map expected to be in LogLuv format.")}},95708:(e,t,r)=>{"use strict";r.d(t,{D:()=>c});var n=r(23909),i=r(3911),o=r.n(i),a=r(93285),s=r.n(a),l=r(85994),u={uniforms:{tDiffuse:{type:"t",value:null},uColor:{type:"v4",value:new n.Vector4(1,1,1,1)}},vertexShader:o(),fragmentShader:s()},c=function(e,t,r,i,o){var a,s,c,h=e,d=t,f=r||3,p=i||1,m=o.hasAlpha||!1,g=o.blending||!1,v=o.flipUV||!1;this.render=function(e,t,r){a.render(e,c,r),s.render(e,t,c)},this.setSize=function(e,t){this.cleanup(),h=e,d=t,(c=new n.WebGLRenderTarget(e,t,{minFilter:n.LinearFilter,magFilter:n.LinearFilter,format:void 0!==o.format?o.format:n.RGBAFormat,type:void 0!==o.type?o.type:n.UnsignedByteType,stencilBuffer:!1})).texture.generateMipmaps=!1,a.material.defines.KERNEL_SCALE_H=s.material.defines.KERNEL_SCALE_H=(p/h).toFixed(4),a.material.defines.KERNEL_SCALE_V=s.material.defines.KERNEL_SCALE_V=(p/d).toFixed(4),a.material.needsUpdate=s.material.needsUpdate=!0},this.cleanup=function(){c&&c.dispose()},this.setColor=function(e){s.material.uniforms.uColor.value.x=e.r,s.material.uniforms.uColor.value.y=e.g,s.material.uniforms.uColor.value.z=e.b},this.setAlpha=function(e){s.material.uniforms.uColor.value.w=e},a=new l.ShaderPass(u),s=new l.ShaderPass(u),this.setSize(e,t),a.material.blending=s.material.blending=n.NoBlending,a.material.depthWrite=s.material.depthWrite=!1,a.material.depthTest=s.material.depthTest=!1,a.material.defines.HORIZONTAL=1,a.material.defines.KERNEL_RADIUS=s.material.defines.KERNEL_RADIUS=f.toFixed(1),g&&(s.material.transparent=!0,s.material.blending=n.NormalBlending),m&&(a.material.defines.HAS_ALPHA=s.material.defines.HAS_ALPHA=""),v&&(a.material.defines.FLIP_UV="")}},85989:(e,t,r)=>{"use strict";function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}r.d(t,{S:()=>i});var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,i;return t=e,(r=[{key:"needsClear",value:function(e,t){if(e.length!==t.length)return!0;for(var r=0;r<e.length;r++)if(e[r]!=t[r])return!0}}])&&n(t.prototype,r),i&&n(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}()},5106:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GroundFlags:()=>n});var n={GROUND_UNFINISHED:0,GROUND_FINISHED:1,GROUND_RENDERED:2}},77416:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GroundReflection:()=>p});var n=r(85994),i=r(95708),o=r(69632),a=r(66209),s=r.n(a),l=r(24687),u=r.n(l),c=r(85989),h=r(5106),d=r(23909),f={uniforms:{tDiffuse:{type:"t",value:null}},vertexShader:s(),fragmentShader:u()},p=function(e,t,r,a){var s,l,u,c,p,m,g=e,v=g.getContext(),y=t||512,b=r||512,x=!1,_=new d.Color(0,0,0),E=!1,w=!1;this.inTarget=void 0,this.outTarget=void 0;var A,S,M,T,C,P=!0,D=h.GroundFlags.GROUND_UNFINISHED,L={color:new d.Color(1,1,1),alpha:.3,texScale:.5,blurRadius:2,blurTexScale:.5,fadeAngle:Math.PI/18};if(this.setTransform=function(e,t,r){c=e,u.normal=t,u.constant=-e.dot(t)},this.cleanup=function(){s&&s.cleanup(),this.inTarget&&this.inTarget.dispose(),this.outTarget&&this.outTarget.dispose()},this.setSize=function(e,t){y=e,b=t,this.cleanup(),this.inTarget=new d.WebGLRenderTarget(y*L.texScale,b*L.texScale,{magFilter:d.LinearFilter,minFilter:d.LinearFilter,format:d.RGBAFormat,stencilBuffer:!1}),this.inTarget.texture.generateMipmaps=!1,this.inTarget.name="GroundReflection inTarget",this.outTarget=new d.WebGLRenderTarget(y*L.texScale,b*L.texScale,{magFilter:d.LinearFilter,minFilter:d.LinearFilter,format:d.RGBAFormat,stencilBuffer:!1}),this.outTarget.texture.generateMipmaps=!1,this.outTarget.name="GroundReflection outTarget",s?s.setSize(y*L.texScale*L.blurTexScale,b*L.texScale*L.blurTexScale):s=new i.D(y*L.texScale*L.blurTexScale,b*L.texScale*L.blurTexScale,L.blurRadius,1,{hasAlpha:!0,blending:!0,flipUV:!0})},this.updateCamera=function(e){var t;t=e.isPerspective?c.clone():e.target.clone();var r=e.position.clone().sub(t).normalize(),n=Math.PI/2-r.angleTo(u.normal);if(!(x=n<0)){if(L.fadeAngle>0){var i=Math.min(L.fadeAngle,n)/L.fadeAngle;s.setAlpha(i*L.alpha)}var o,a,l,h=(a=(o=u).normal,l=o.constant,(new d.Matrix4).set(1-2*a.x*a.x,-2*a.y*a.x,-2*a.x*a.z,-2*l*a.x,-2*a.x*a.y,1-2*a.y*a.y,-2*a.y*a.z,-2*l*a.y,-2*a.x*a.z,-2*a.y*a.z,1-2*a.z*a.z,-2*l*a.z,0,0,0,1));(p=e.clone()).applyMatrix4(h),p.projectionMatrix.elements[5]*=-1,p.matrixWorldNeedsUpdate=!0,e.worldUpTransform?p.worldUpTransform=e.worldUpTransform.clone():p.worldUpTransform=new d.Matrix4}},this.renderIntoReflection=function(e){x||(g.setRenderTarget(this.inTarget),g.render(e,p))},this.prepareGroundReflection=(S=[],M=0,T=0,C=0,function(e,t,r,n,i,o){var a=t.modelQueue();if(D!==h.GroundFlags.GROUND_UNFINISHED||a.isEmpty())return D=h.GroundFlags.GROUND_FINISHED,i;var s,l,u,c=a.getGeomScenesPerModel();if(P=this.needsClear(S,c)||P){if(P=!1,this.updateCamera(t.camera),this.isGroundCulled())return D=h.GroundFlags.GROUND_FINISHED,i;this.clear(),S=c,A=a.getGeomScenes(),M=A.length,T=0,C=n?Math.max(Math.ceil(M/100),n):M,D=h.GroundFlags.GROUND_UNFINISHED}else{if(D!==h.GroundFlags.GROUND_UNFINISHED)return D=h.GroundFlags.GROUND_FINISHED,i;0===n&&(C=M)}i&&(s=performance.now(),l=(o=void 0===o?1:o)*i);for(var d=0;d<C&&T<M;){var f=A[T++];if(f&&(d++,f.forceVisible=!0,this.renderIntoReflection(f),f.forceVisible=!1,i)){var p=performance.now()-s;if(l<p&&T<M){D=h.GroundFlags.GROUND_UNFINISHED,u=i-p;break}}}return T<M&&(D=h.GroundFlags.GROUND_UNFINISHED,u=i?i-performance.now()+s:1),void 0===u||r?(this.postprocess(t.camera,t.matman()),e&&e.enabled&&t.renderGroundShadow(this.outTarget),this.renderReflection(t.camera,t.renderer().getColorTarget()),void 0===u&&(D=h.GroundFlags.GROUND_RENDERED),i?i-performance.now()+s:1):u}),this.renderReflection=function(e,t){x||(v.depthRange(.999999,1),l.render(g,t,this.outTarget),v.depthRange(0,1))},this.toggleEnvMapBackground=function(e){w=e,m.uniforms.envMapBackground.value=e},this.postprocess=function(e){if(!x){if(E||w){var t=m.uniforms.uCamDir.value||new d.Vector3;m.uniforms.uCamDir.value=e.worldUpTransform?e.getWorldDirection(t).applyMatrix4(e.worldUpTransform):e.getWorldDirection(t),m.uniforms.uCamUp.value=e.worldUpTransform?e.up.clone().applyMatrix4(e.worldUpTransform):e.up,m.uniforms.uResolution.value.set(y,b),m.uniforms.uHalfFovTan.value=Math.tan(d.Math.degToRad(.5*e.fov)),m.render(g,this.outTarget),g.setRenderTarget(this.outTarget),g.clear(!1,!0,!1)}else g.setClearColor(_,1),g.setRenderTarget(this.outTarget),g.clear(!0,!0,!1);s.render(g,this.outTarget,this.inTarget)}},this.clear=function(){g.setClearColor(_,0),g.setRenderTarget(this.inTarget),g.clear(!0,!0,!1),g.clearBlend()},this.setClearColors=function(e,t,r){t?(_.setRGB(.5*(e.x+t.x),.5*(e.y+t.y),.5*(e.z+t.z)),E=!e.equals(t)&&!r):(_.copy(e),E=!1),E&&(m.uniforms.color1.value.copy(e),m.uniforms.color2.value.copy(t))},this.setEnvRotation=function(e){m.material.envRotationSin=Math.sin(e),m.material.envRotationCos=Math.cos(e)},this.isGroundCulled=function(){return x},this.getStatus=function(){return D},this.setDirty=function(){P=!0,D=h.GroundFlags.GROUND_UNFINISHED},this.setColor=function(e){s.setColor(L.color),L.color.set(e)},this.setAlpha=function(e){s.setAlpha(L.alpha),L.alpha=e},a)for(var R in L)L[R]=void 0!==a[R]?a[R]:L[R];(l=new n.ShaderPass(f)).material.blending=d.NoBlending,l.material.depthTest=!0,l.material.depthWrite=!1,l.scene.position.z=-.999999,a.clearPass?m=a.clearPass:((m=new n.ShaderPass(o.Q)).material.blending=d.NoBlending,m.material.depthWrite=!1,m.material.depthTest=!1),this.setSize(y,b),s.setAlpha(L.color),s.setAlpha(L.alpha),u=new d.Plane(new d.Vector3(0,1,0),0),c=new d.Vector3(0,0,0)};p.prototype=c.S.prototype,p.prototype.constructor=p},83359:(e,t,r)=>{"use strict";r.r(t),r.d(t,{createGroundShape:()=>T,setGroundShapeTransform:()=>C,GroundShadow:()=>P});var n,i,o,a=r(14705),s=r(85994),l=r(40520),u=r.n(l),c=r(57165),h=r.n(c),d=r(66209),f=r.n(d),p=r(24009),m=r.n(p),g=r(8242),v=r.n(g),y=r(14810),b=r.n(y),x=r(85989),_=r(5106),E=r(23909),w={uniforms:{cutplanes:{type:"v4v",value:[]}},vertexShader:u(),fragmentShader:h()},A={uniforms:{tDepth:{type:"t",value:null},worldSize:{type:"v3",value:new E.Vector3(1,1,1)}},defines:{},vertexShader:f(),fragmentShader:m()},S={uniforms:{tDepth:{type:"t",value:null}},defines:{},vertexShader:f(),fragmentShader:v()},M={uniforms:{tDepth:{type:"t",value:null},uShadowColor:{type:"v4",value:new E.Vector4(0,0,0,1)}},vertexShader:f(),fragmentShader:b()};function T(e){var t=new E.PlaneBufferGeometry(1,1);if(t.index.array.reverse)t.index.array.reverse();else for(var r,n=t.index.array,i=Math.floor(n.length/2),o=0,a=n.length;o<i;++o)r=n[o],n[o]=n[a-1-o],n[a-1-o]=r;return new E.Mesh(t,e)}function C(e,t,r,a,s){n||(n=new E.Matrix4),i||(i=new E.Vector3),o||(o=new E.Vector3),i.subVectors(t,a),n.lookAt(i,t,s),o.copy(a).multiplyScalar(-.5*r.y).add(t),e.position.copy(o),e.rotation.setFromRotationMatrix(n),e.scale.set(r.z,r.x,r.y)}function P(e,t){var r,n,i,o,l,u,c,h,d,f,p,m,g,v,y,b,x,P,D,L,R=e,I=!1,O=!0,N=_.GroundFlags.GROUND_FINISHED,k={texSize:64,pixScale:1,blurRadius:7,debug:!1};if(this.setTransform=(m=new E.Vector3(0,0,0),g=new E.Vector3(0,0,0),v=new E.Vector3(0,0,0),y=new E.Vector3(0,0,0),function(e,t,n,o){e.equals(m)&&t.equals(g)&&n.equals(v)&&o.equals(y)||(m.copy(e),g.copy(t),v.copy(n),y.copy(o),this.setDirty(),r.left=-t.z/2,r.right=t.z/2,r.top=t.x/2,r.bottom=-t.x/2,r.near=1,r.far=t.y+r.near,r.updateProjectionMatrix(),C(i,e,t,n,o),r.position.addVectors(e,n.clone().multiplyScalar(-t.y/2-r.near)),o&&r.up.set(o.x,o.y,o.z),r.lookAt(e),k.debug&&(p.position.set(e.x,e.y,e.z),p.rotation.set(r.rotation.x,r.rotation.y,r.rotation.z),p.scale.set(t.z,t.x,t.y)),f.uniforms.worldSize.value.copy(t))}),this.renderIntoShadow=function(e){if(!e.overrideMaterial||!e.overrideMaterial.transparent){var t=e.overrideMaterial;e.overrideMaterial=u,R.setRenderTarget(o),R.render(e,r),e.overrideMaterial=t}},this.prepareGroundShadow=(x=[],P=0,D=0,L=0,function(e,t,r,n){if(!this.enabled||e.isEmpty())return N=_.GroundFlags.GROUND_FINISHED,r;var i,o,a,s=e.getGeomScenesPerModel();if(O=this.needsClear(x,s)||O)this.clear(),O=!1,x=s,b=e.getGeomScenes(),P=b.length,D=0,L=t?Math.max(Math.ceil(P/100),t):P;else{if(N===_.GroundFlags.GROUND_RENDERED||N===_.GroundFlags.GROUND_FINISHED)return N=_.GroundFlags.GROUND_FINISHED,r;0===t&&(L=P)}r&&(i=performance.now(),o=(n=void 0===n?1:n)*r);for(var l=0;l<L&&D<P;){var u=b[D++];if(u&&(l++,u.forceVisible=!0,this.renderIntoShadow(u),u.forceVisible=!1,r)){var c=performance.now()-i;if(o<c){N=_.GroundFlags.GROUND_UNFINISHED,a=r-c;break}}}return D<P&&(N=_.GroundFlags.GROUND_UNFINISHED,a=r?r-performance.now()+i:1),void 0!==a?a:(this.postprocess(),N=_.GroundFlags.GROUND_RENDERED,r?r-performance.now()+i:1)}),this.renderShadow=function(e,t){I&&(t&&R.setRenderTarget(t),R.render(n,e))},this.postprocess=function(){d.render(R,l,o),h.render(R,o,l),I=!0},this.clear=function(){var e=R.getClearColor(new E.Color).getHex(),t=R.getClearAlpha();R.setClearColor(0,0),R.setRenderTarget(o),R.clear(!0,!0,!1),R.setClearColor(e,t),R.clearBlend(),I=!1},this.setColor=function(e){c.uniforms.uShadowColor.value.x=e.r,c.uniforms.uShadowColor.value.y=e.g,c.uniforms.uShadowColor.value.z=e.b},this.getColor=function(){return new E.Color(c.uniforms.uShadowColor.value.x,c.uniforms.uShadowColor.value.y,c.uniforms.uShadowColor.value.z)},this.setAlpha=function(e){c.uniforms.uShadowColor.value.w=e},this.getAlpha=function(){return c.uniforms.uShadowColor.value.w},this.isValid=function(){return I},this.getStatus=function(){return N},this.setDirty=function(){O=!0,N=_.GroundFlags.GROUND_UNFINISHED},this.getDepthMaterial=function(){return u},t)for(var F in k)k[F]=t[F]||k[F];n=new E.Scene,r=new E.OrthographicCamera,(o=new E.WebGLRenderTarget(k.texSize,k.texSize,{minFilter:E.LinearFilter,magFilter:E.LinearFilter,format:E.RGBAFormat,stencilBuffer:!1})).texture.generateMipmaps=!1,o.name="GroundShadow targetH",(l=new E.WebGLRenderTarget(k.texSize,k.texSize,{minFilter:E.LinearFilter,magFilter:E.LinearFilter,format:E.RGBAFormat,stencilBuffer:!1})).texture.generateMipmaps=!1,l.name="GroundShadow targetV",(u=(0,a.createShaderMaterial)(w)).type="GroundDepthShader",u.side=E.DoubleSide,u.blending=E.NoBlending,h=new s.ShaderPass(S,"tDepth"),d=new s.ShaderPass(S,"tDepth"),f=new s.ShaderPass(A,"tDepth"),h.material.defines.KERNEL_SCALE=d.material.defines.KERNEL_SCALE=(k.pixScale/k.texSize).toFixed(4),h.material.defines.KERNEL_RADIUS=d.material.defines.KERNEL_RADIUS=k.blurRadius.toFixed(2),f.material.blending=h.material.blending=d.material.blending=E.NoBlending,f.material.depthWrite=h.material.depthWrite=d.material.depthWrite=!1,f.material.depthTest=h.material.depthTest=d.material.depthTest=!1,h.material.defines.HORIZONTAL=1,(c=(0,a.createShaderMaterial)(M)).uniforms.tDepth.value=o.texture,c.depthWrite=!1,c.transparent=!0,i=T(c),n.add(i),k.debug&&(p=new E.Mesh(new E.BoxGeometry(1,1,1),new E.MeshBasicMaterial({color:65280,wireframe:!0})),n.add(p)),this.setTransform(new E.Vector3(0,0,0),new E.Vector3(1,1,1),new E.Vector3(0,1,0),E.Object3D.DefaultUp)}P.prototype=x.S.prototype,P.prototype.constructor=P},96890:(e,t,r)=>{"use strict";r.r(t),r.d(t,{FloatToHalf:()=>s,HalfToFloat:()=>l,HALF_INT_MAX:()=>u,IntToHalf:()=>c,HalfToInt:()=>h,HalfTest:()=>d});var n=new Float32Array(1),i=new Uint32Array(n.buffer),o=new Uint16Array(1),a=new Uint16Array(1),s=function(e){n[0]=e;var t=i[0],r=0;if(0==(2147483647&t))a[r++]=t>>16;else{var s=2147483648&t,l=2139095040&t,u=8388607&t;if(0===l)a[r++]=s>>16;else if(2139095040==l)a[r++]=0===u?s>>16|31744:65024;else{var c,h,d=s>>16,f=(0|l>>23)-127+15;f>=31?a[r++]=s>>16|31744:f<=0?(14-f>24?c=0:(c=(u|=8388608)>>14-f,o[0]=c,c=o[0],u>>13-f&1&&(c+=1)),a[r++]=d|c):(h=f<<10,o[0]=h,h=o[0],c=u>>13,o[0]=c,c=o[0],a[r++]=4096&u?1+(d|h|c):d|h|c)}}return a[0]},l=function(e){var t,r=65535&e;if(0==(32767&r))t=r<<16;else{var o=32768&r,a=31744&r,s=1023&r;if(0===a){var l=-1;do{l++,s<<=1}while(0==(1024&s));var u=o<<16,c=(a<<16>>26)-15+127-l,h=c<<23,d=(1023&s)<<13;t=u|h|d}else t=31744==a?0===s?o<<16|2139095040:4290772992:(u=o<<16)|(h=(c=(a<<16>>26)-15+127)<<23)|(d=s<<13)}return i[0]=t,n[0]},u=59390,c=function(e){if(e>u-1||e<0)return console.log("out of range"),s(NaN);if(0===e)return 0;var t=!1;e>u/2-1&&(t=!0,e-=u/2-1);var r=0|Math.abs(e/1024),n=Math.pow(2,r-13),i=n+(e-1024*r)*n/1024;return t&&(i=-i),s(i)},h=function(e){if(0===e)return 0;var t=l(e),r=!1;t<0&&(r=!0,t=-t);var n=0|Math.floor(Math.log(t)/Math.log(2)),i=Math.pow(2,n),o=(t-i)/i*1024+1024*(n+13);return r&&(o+=u/2-1),o},d=function(){for(var e=[-1/255,-.17,-75,-1789,-.005],t=0;t<e.length;t++)console.log("input",e[t],"encoded",s(e[t]),"decoded",l(s(e[t])));for(var r=0;r<u;r++){var n=h(c(r));n!==r&&console.log("Roundtrip failed for",r,n)}}},49321:(e,t,r)=>{"use strict";r.r(t),r.d(t,{LineStyleDefs:()=>i,createLinePatternTextureData:()=>o,createLinePatternTextureFromDefs:()=>a,createLinePatternTexture:()=>s,createLinePatternForDef:()=>l});var n=r(23909),i=[{id:"SOLID",name:"Solid",ascii_art:"_______________________________________",def:[1]},{id:"BORDER",name:"Border",ascii_art:"__ __ . __ __ . __ __ . __ __ . __ __ .",def:[.5,-.25,.5,-.25,0,-.25]},{id:"BORDER2",name:"Border (.5x)",ascii_art:"__ __ . __ __ . __ __ . __ __ . __ __ .",def:[.25,-.125,.25,-.125,0,-.125]},{id:"BORDERX2",name:"Border (2x)",ascii_art:"____  ____  .  ____  ____  .  ___",def:[1,-.5,1,-.5,0,-.5]},{id:"CENTER",name:"Center",ascii_art:"____ _ ____ _ ____ _ ____ _ ____ _ ____",def:[1.25,-.25,.25,-.25]},{id:"CENTER2",name:"Center (.5x)",ascii_art:"___ _ ___ _ ___ _ ___ _ ___ _ ___",def:[.75,-.125,.125,-.125]},{id:"CENTERX2",name:"Center (2x)",ascii_art:"________  __  ________  __  _____",def:[2.5,-.5,.5,-.5]},{id:"DASHDOT",name:"Dash dot",ascii_art:"__ . __ . __ . __ . __ . __ . __ . __",def:[.5,-.25,0,-.25]},{id:"DASHDOT2",name:"Dash dot (.5x)",ascii_art:"_._._._._._._._._._._._._._._.",def:[.25,-.125,0,-.125]},{id:"DASHDOTX2",name:"Dash dot (2x)",ascii_art:"____  .  ____  .  ____  .  ___",def:[1,-.5,0,-.5]},{id:"DASHED",name:"Dashed",ascii_art:"__ __ __ __ __ __ __ __ __ __ __ __ __ _",def:[.5,-.25]},{id:"DASHED2",name:"Dashed (.5x)",ascii_art:"_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _",def:[.25,-.125]},{id:"DASHEDX2",name:"Dashed (2x)",ascii_art:"____  ____  ____  ____  ____  ___",def:[1,-.5]},{id:"DIVIDE",name:"Divide",ascii_art:"____ . . ____ . . ____ . . ____ . . ____",def:[.5,-.25,0,-.25,0,-.25]},{id:"DIVIDE2",name:"Divide (.5x)",ascii_art:"__..__..__..__..__..__..__..__.._",def:[.25,-.125,0,-.125,0,-.125]},{id:"DIVIDEX2",name:"Divide (2x)",ascii_art:"________  .  .  ________  .  .  _",def:[1,-.5,0,-.5,0,-.5]},{id:"DOT",name:"Dot",ascii_art:". . . . . . . . . . . . . . . . . . . . . . . .",def:[0,-.25]},{id:"DOT2",name:"Dot (.5x)",ascii_art:"........................................",def:[0,-.125]},{id:"DOTX2",name:"Dot (2x)",ascii_art:".  .  .  .  .  .  .  .  .  .  .  .  .  .",def:[0,-.5]},{id:"HIDDEN",name:"Hidden",ascii_art:"__ __ __ __ __ __ __ __ __ __ __ __ __ __",def:[.25,-.125]},{id:"HIDDEN2",name:"Hidden (.5x)",ascii_art:"_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _",def:[.125,-.0625]},{id:"HIDDENX2",name:"Hidden (2x)",ascii_art:"____ ____ ____ ____ ____ ____ ____",def:[.5,-.25]},{id:"PHANTOM",name:"Phantom",ascii_art:"______  __  __  ______  __  __  ______",def:[1.25,-.25,.25,-.25,.25,-.25]},{id:"PHANTOM2",name:"Phantom (.5x)",ascii_art:"___ _ _ ___ _ _ ___ _ _ ___ _ _",def:[.625,-.125,.125,-.125,.125,-.125]},{id:"PHANTOMX2",name:"Phantom (2x)",ascii_art:"____________    ____    ____   _",def:[2.5,-.5,.5,-.5,.5,-.5]},{id:"ACAD_ISO02W100",name:"ISO dash",ascii_art:"__ __ __ __ __ __ __ __ __ __ __ __ __",def:[12,-3],pen_width:1,unit:"mm"},{id:"ACAD_ISO03W100",name:"ISO dash space",ascii_art:"__    __    __    __    __    __",def:[12,-18],pen_width:1,unit:"mm"},{id:"ACAD_ISO04W100",name:"ISO long-dash dot",ascii_art:"____ . ____ . ____ . ____ . _",def:[24,-3,.5,-3],pen_width:1,unit:"mm"},{id:"ACAD_ISO05W100",name:"ISO long-dash double-dot",ascii_art:"____ .. ____ .. ____ .",def:[24,-3,.5,-3,.5,-3],pen_width:1,unit:"mm"},{id:"ACAD_ISO06W100",name:"ISO long-dash triple-dot",ascii_art:"____ ... ____ ... ____",def:[24,-3,.5,-3,.5,-3,.5,-3],pen_width:1,unit:"mm"},{id:"ACAD_ISO07W100",name:"ISO dot",ascii_art:". . . . . . . . . . . . . . . . . . . .",def:[.5,-3],pen_width:1,unit:"mm"},{id:"ACAD_ISO08W100",name:"ISO long-dash short-dash",ascii_art:"____ __ ____ __ ____ _",def:[24,-3,6,-3],pen_width:1,unit:"mm"},{id:"ACAD_ISO09W100",name:"ISO long-dash double-short-dash",ascii_art:"____ __ __ ____",def:[24,-3,6,-3,6,-3],pen_width:1,unit:"mm"},{id:"ACAD_ISO10W100",name:"ISO dash dot",ascii_art:"__ . __ . __ . __ . __ . __ . __ . ",def:[12,-3,.5,-3],pen_width:1,unit:"mm"},{id:"ACAD_ISO11W100",name:"ISO double-dash dot",ascii_art:"__ __ . __ __ . __ __ . __ _",def:[12,-3,12,-3,.5,-3],pen_width:1,unit:"mm"},{id:"ACAD_ISO12W100",name:"ISO dash double-dot",ascii_art:"__ . . __ . . __ . . __ . .",def:[12,-3,.5,-3,.5,-3],pen_width:1,unit:"mm"},{id:"ACAD_ISO13W100",name:"ISO double-dash double-dot",ascii_art:"__ __ . . __ __ . . _",def:[12,-3,12,-3,.5,-3,.5,-3],pen_width:1,unit:"mm"},{id:"ACAD_ISO14W100",name:"ISO dash triple-dot",ascii_art:"__ . . . __ . . . __ . . . _",def:[12,-3,.5,-3,.5,-3,.5,-3],pen_width:1,unit:"mm"},{id:"ACAD_ISO15W100",name:"ISO double-dash triple-dot",ascii_art:"__ __ . . . __ __ . .",def:[12,-3,12,-3,.5,-3,.5,-3,.5,-3],pen_width:1,unit:"mm"},{id:"FENCELINE1",name:"Fenceline circle",ascii_art:"----0-----0----0-----0----0-----0--",def:[.25,-.1,["CIRC1","ltypeshp.shx","x=-.1","s=.1"],-.1,1]},{id:"FENCELINE2",name:"Fenceline square",ascii_art:"----[]-----[]----[]-----[]----[]---",def:[.25,-.1,["BOX","ltypeshp.shx","x=-.1","s=.1"],-.1,1]},{id:"TRACKS",name:"Tracks",ascii_art:"-|-|-|-|-|-|-|-|-|-|-|-|-|-|-|-|-|-|-|-|-|-|-|-|-",def:[.15,["TRACK1","ltypeshp.shx","s=.25"],.15]},{id:"BATTING",name:"Batting",ascii_art:"SSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSS",def:[1e-4,-.1,["BAT","ltypeshp.shx","x=-.1","s=.1"],-.2,["BAT","ltypeshp.shx","r=180","x=.1","s=.1"],-.1]},{id:"HOT_WATER_SUPPLY",name:"Hot water supply",ascii_art:"---- HW ---- HW ---- HW ----",def:[.5,-.2,["HW","STANDARD","S=.1","R=0.0","X=-0.1","Y=-.05"],-.2]},{id:"GAS_LINE",name:"Gas line",ascii_art:"----GAS----GAS----GAS----GAS----GAS----GAS--",def:[.5,-.2,["GAS","STANDARD","S=.1","R=0.0","X=-0.1","Y=-.05"],-.25]},{id:"ZIGZAG",name:"Zig zag",ascii_art:"/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/",def:[1e-4,-.2,["ZIG","ltypeshp.shx","x=-.2","s=.2"],-.4,["ZIG","ltypeshp.shx","r=180","x=.2","s=.2"],-.2]}],o=function(e,t){for(var r=e+3,i=t,o=1;o<r;)o*=2;for(r=o,o=1;o<i;)o*=2;i=o;var a=new Uint8Array(r*i),s=new n.DataTexture(a,r,i,n.LuminanceFormat,n.UnsignedByteType,n.UVMapping,n.ClampToEdgeWrapping,n.ClampToEdgeWrapping,n.NearestFilter,n.NearestFilter,0);return s.generateMipmaps=!1,s.flipY=!1,s.needsUpdate=!0,{tex:a,pw:r,ph:i,lineStyleTex:s}},a=function(e){for(var t=e.length,r=0,n=0;n<t;n++){var i=e[n];i.def.length>r&&(r=i.def.length)}for(var a=o(r,t),s=a.tex,u=a.pw,c=a.lineStyleTex,h=0;h<t;h++){var d=e[h];l(d,s,h,u)}return c},s=function(){return a(i)},l=function(e,t,r,n){for(var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:96,o=r*n,a=e.unit&&"mm"==e.unit?1/25.4:1,s=e.pen_width||0,l=e.def,u=0,c=0;c<l.length;c++){var h=Math.abs(l[c]),d=h<=.5*s;d&&(h=0);var f=0|h*i*a;u+=f,t[o+c+2]=f||1}t[o]=u%256,t[o+1]=u/256,t[o+l.length+2]=0}},31102:(e,t,r)=>{"use strict";function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}r.d(t,{ZP:()=>i,I5:()=>o,p1:()=>a});var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.webglContextId=1}var t,r,i;return t=e,(r=[{key:"onContextRestored",value:function(){this.webglContextId++}},{key:"refreshTargetIfNeeded",value:function(e){this.refreshIfNeeded(e);var t=null==e?void 0:e.shareDepthFrom;this.refreshIfNeeded(t)}},{key:"refreshTargetsIfNeeded",value:function(e){if(Array.isArray(e))for(var t=0;t<e.length;t++)this.refreshTargetIfNeeded(e[t]);else this.refreshTargetIfNeeded(e)}},{key:"refreshIfNeeded",value:function(e){if(!e||e.__webglContextId===this.webglContextId)return!1;this._refreshGlData(e),e.__webglContextId=this.webglContextId}},{key:"_refreshGlData",value:function(e){e instanceof THREE.Mesh&&this._refreshMeshGlData(e),e instanceof THREE.BufferGeometry&&this._refreshBufferGeometryGlData(e),e instanceof THREE.WebGLRenderTarget&&this._refreshTargetGlData(e),e instanceof THREE.Texture&&this._refreshTextureGlData(e),e instanceof THREE.Material&&this._refreshMaterialGlData(e)}},{key:"_refreshMeshGlData",value:function(e){var t;e.__webglActive&&(e.__webglActive=void 0),null!==(t=e.geometry)&&void 0!==t&&t.__webglInit&&(e.geometry.__webglInit=void 0)}},{key:"_refreshBufferGeometryGlData",value:function(e){for(var t in e.__webglInit&&(e.__webglInit=void 0,e.needsUpdate=!0),e.vbbuffer&&(e.vbbuffer=void 0,e.needsUpdate=!0),e.ibbuffer&&(e.ibbuffer=void 0,e.needsUpdate=!0),e.iblinesbuffer&&(e.iblinesbuffer=void 0,e.needsUpdate=!0),e.vaos&&(e.vaos=void 0,e.needsUpdate=!0),e.attributes){var r=e.attributes[t];r.buffer&&(r.buffer=void 0,e.needsUpdate=!0)}}},{key:"_refreshTargetGlData",value:function(e){e.__webglFramebuffer&&(e.__webglFramebuffer=null),e.__webglRenderbuffer&&(e.__webglRenderbuffer=null),e.__webglBoundBuffers&&(e.__webglBoundBuffers=null),e.__webglTexture&&(e.__webglTexture=null)}},{key:"_refreshTextureGlData",value:function(e){e.__webglInit&&(e.__webglInit=void 0,e.needsUpdate=!0),e.__webglTexture&&(e.__webglTexture=void 0,e.needsUpdate=!0),e.__webglTextureCube&&(e.__webglTextureCube=null,e.needsUpdate=!0)}},{key:"_refreshMaterialGlData",value:function(e){(e.program||e.programs)&&(e.program=null,e.programs=[],e.needsUpdate=!0)}}])&&n(t.prototype,r),i&&n(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}(),o=function(e){var t={};return e.getAllModels().forEach((function(e){e.isConsolidated()&&(e.unconsolidate(),t[e.id]=!0)})),t},a=function(e,t){e.getAllModels().forEach((function(r){t[r.id]&&e.impl.consolidateModel(r)}))}},88715:(e,t,r)=>{"use strict";r.r(t),r.d(t,{MaterialConverter:()=>u});var n=r(23909),i=r(97122);function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function a(e,t,r,n,i,o,a){try{var s=e[o](a),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,i)}function s(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function s(e){a(o,n,i,s,l,"next",e)}function l(e){a(o,n,i,s,l,"throw",e)}s(void 0)}))}}var l=Autodesk.Viewing,u={convertMaterial:function(e,t,r,n){return d.apply(this,arguments)},convertTexture:function(e,t,r,o){"bumpMap"==e.mapName||"normalMap"==e.mapName?t.anisotropy=0:t.anisotropy=o||0;t.flipY=void 0===e.flipY||e.flipY,t.invert=!1,t.wrapS=n.RepeatWrapping,t.wrapT=n.RepeatWrapping,e.isPrism?u.convertPrismTexture(e.textureObj,t,r):function(e,t){if(!e)return;var r=e.properties;t.invert=(0,i.parseMaterialBoolean)(r,"unifiedbitmap_Invert"),t.clampS=!(0,i.parseMaterialBoolean)(r,"texture_URepeat",!0),t.clampT=!(0,i.parseMaterialBoolean)(r,"texture_VRepeat",!0),t.wrapS=t.clampS?n.ClampToEdgeWrapping:n.RepeatWrapping,t.wrapT=t.clampT?n.ClampToEdgeWrapping:n.RepeatWrapping,t.matrix=e.matrix||(e.matrix=(0,i.Get2DSimpleMapTransform)(r))}(e.textureObj,t)},isPrismMaterial:p,convertMaterialGltf:function(e,t){var r=new n.MeshPhongMaterial;r.packedNormals=!0,r.textureMaps={},r.reflectivity=0;var i=e.pbrMetallicRoughness||{},a=i.baseColorTexture||i.baseColorFactor;if(a)if(Array.isArray(a))r.color=new n.Color(a[0],a[1],a[2]),r.opacity=a[3];else if("object"===o(a)){r.color=new n.Color(1,1,1);var s={mapName:"map"},l=t.gltf.textures[a.index];s.uri=t.gltf.images[l.source].uri,s.flipY=!1,r.textureMaps[s.mapName]=s}var u=i.metallicRoughnessTexture;if(u){s={mapName:"metallicRoughnessTexture"},l=t.gltf.textures[u.index];s.uri=t.gltf.images[l.source].uri,s.flipY=!1,r.textureMaps[s.mapName]=s}else r.metalness=void 0!==i.metallicFactor?i.metallicFactor:1,r.roughness=void 0!==i.roughnessFactor?i.roughnessFactor:1;!0===e.doubleSided&&(r.side=n.DoubleSide);var c=e.alphaMode||m;c===v?(r.transparent=!0,r.depthWrite=!1):(r.transparent=!1,c===g&&(r.alphaTest=void 0!==e.alphaCutoff?e.alphaCutoff:.5));if(void 0!==e.normalTexture){s={mapName:"normalTexture"},l=t.gltf.textures[e.normalTexture.index];s.uri=l.source,s.flipY=!1,s.uri=t.gltf.images[l.source].uri,r.normalScale=new n.Vector2(1,1),void 0!==e.normalTexture.scale&&r.normalScale.set(e.normalTexture.scale,e.normalTexture.scale)}if(void 0!==e.occlusionTexture){s={mapName:"occlusionTexture"},l=t.gltf.textures[e.occlusionTexture.index];s.uri=t.gltf.images[l.source].uri,s.flipY=!1,r.textureMaps[s.mapName]=s,void 0!==e.occlusionTexture.strength&&(r.aoMapIntensity=e.occlusionTexture.strength)}void 0!==e.emissiveFactor&&(r.emissive=(new n.Color).fromArray(e.emissiveFactor));if(void 0!==e.emissiveTexture){s={mapName:"emissiveTexture"},l=t.gltf.textures[e.emissiveTexture.index];s.uri=t.gltf.images[l.source].uri,s.flipY=!1,r.textureMaps[s.mapName]=s}return r},applyAppearanceHeuristics:function(e,t,r){var i=e.proteinMat?e.proteinMat:null,o=e.prismType&&-1!==e.prismType.indexOf("Prism");o&&e.transparent&&(e.side===n.FrontSide&&"PrismGlazing"!==e.prismType&&(e.side=n.DoubleSide),e.side===n.DoubleSide&&e.depthTest&&(e.twoPassTransparency=!0));var a=e.textureMaps||{};if(!t){var s,l,u=e.proteinType&&-1!==e.proteinType.indexOf("Prism");if(e.metal)e.reflectivity||(e.reflectivity=y(e.specular)),i&&(1===e.reflectivity&&(e.reflectivity=y(e.specular)),0===e.color.r&&0===e.color.g&&0===e.color.b||(e.color.r*=.1,e.color.g*=.1,e.color.b*=.1));else if(u){var c=!1;if("PrismLayered"===e.proteinType){e.clearcoat=!0,e.reflectivity=.06;var h=e.proteinCategories;h&&h.length&&-1!=h[0].indexOf("Metal")&&(c=!0)}e.reflectivity=Math.sqrt(e.reflectivity),c?e.specular.copy(e.color):(e.specular.r=e.reflectivity,e.specular.g=e.reflectivity,e.specular.b=e.reflectivity)}else e.reflectivity?e.reflectivity>.3?(e.metal=!0,e.specular.r=e.color.r,e.specular.g=e.color.g,e.specular.b=e.color.b,e.color.r*=.1,e.color.g*=.1,e.color.b*=.1):(e.specular.r*=e.reflectivity,e.specular.g*=e.reflectivity,e.specular.b*=e.reflectivity):1!==e.color.r||1!==e.color.g||1!==e.color.b||1!==e.specular.r||1!==e.specular.g||1!==e.specular.b||a.map||a.specularMap?(e.reflectivity=.01+.06*y(e.specular),e.specular.r*=e.reflectivity,e.specular.g*=e.reflectivity,e.specular.b*=e.reflectivity):(e.metal=!0,e.reflectivity=.7,e.color.r*=.1,e.color.g*=.1,e.color.b*=.1),e.opacity<1&&(e.reflectivity=1);(e.transparent||-1!==(null===(s=a.map)||void 0===s||null===(l=s.uri)||void 0===l?void 0:l.toLowerCase().indexOf(".png"))||a.alphaMap)&&(e.alphaTest=.01)}if(a.normalMap){var d=e.bumpScale;(void 0===d||d>=1)&&(d=1),e.normalScale=new n.Vector2(d,d)}else(void 0===e.bumpScale&&(a.map||a.bumpMap)||e.bumpScale>=1)&&(e.bumpScale=.03);if((!t||o)&&e.transparent){if(o)e.lmv_depthWriteTransparent=!0,e.depthWrite=!!r;else if(e.opacity>=1)a.alphaMap||(e.transparency=!1);else e.lmv_depthWriteTransparent=!0,e.depthWrite=!!r}void 0!==e.shininess&&(e.shininess*=.25)},applyGeometryFlagsToMaterial:function(e,t){t.attributes.color&&(e.vertexColors=n.VertexColors,e.needsUpdate=!0);if(!e.proteinType&&t.attributes.uv&&t.attributes.uv.isPattern){var r=!1;e.map&&!e.bumpMap&&(e.bumpMap=e.map,e.needsUpdate=!0,r=!0),e.textureMaps&&e.textureMaps.map&&!e.textureMaps.bumpMap&&(e.textureMaps.bumpMap=e.textureMaps.map,e.needsUpdate=!0,r=!0),r&&void 0===e.bumpScale&&(e.bumpScale=.03)}},hasTiling:function(e){var t=e.materials[e.userassets[0]];if(t){if("TilingPattern"===t.definition)return!0}return!1},loadMaterialConverterPrismLibrary:c};function c(){return h.apply(this,arguments)}function h(){return(h=s(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(l.MaterialConverterPrism&&l.MaterialConverterPrism.convertPrismMaterial){e.next=3;break}return e.next=3,l.theExtensionManager.downloadExtension("Autodesk.Viewing.MaterialConverterPrism");case 3:if(!u.convertPrismMaterial)for(t in l.MaterialConverterPrism)u[t]=l.MaterialConverterPrism[t];case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function d(){return(d=s(regeneratorRuntime.mark((function e(t,r,o,a){var s,l,h,d,m,g,v,y,b,x,_,E,w,A,S,M;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!p(t)){e.next=7;break}return e.next=4,c();case 4:return o=u.convertPrismMaterial(t,r,o,a),t.transparent=o.transparent,e.abrupt("return",o);case 7:if(a=a||t.userassets,s=t.materials,l=s[a],h=l.properties,o){e.next=15;break}o=new n.MeshPhongMaterial,e.next=20;break;case 15:if(o instanceof n.MeshPhongMaterial){e.next=19;break}return e.abrupt("return",null);case 19:o.needsUpdate=!0;case 20:if(o.proteinMat=t,o.proteinCategories=l.categories,o.packedNormals=!0,!l||"SimplePhong"!==l.definition){e.next=86;break}o.tag=l.tag,o.proteinType=l.proteinType,void 0===o.proteinType&&(o.proteinType=null),g=(0,i.parseMaterialBoolean)(h,"generic_baked_lighting",!1),o.disableEnvMap=g,v=o.ambient=(0,i.parseMaterialColor)(h,"generic_ambient"),y=o.color=(0,i.parseMaterialColor)(h,"generic_diffuse"),b=o.specular=(0,i.parseMaterialColor)(h,"generic_specular"),x=o.emissive=(0,i.parseMaterialColor)(h,"generic_emissive"),o.shininess=(0,i.parseMaterialScalar)(h,"generic_glossiness",30),o.opacity=1-(0,i.parseMaterialScalar)(h,"generic_transparency",0),o.reflectivity=(0,i.parseMaterialScalar)(h,"generic_reflectivity_at_0deg",0),_=(0,i.parseMaterialBoolean)(h,"generic_bump_is_normal"),null==(E=(0,i.parseMaterialScalar)(h,"generic_bump_amount",0))&&(E=1),_?(E>1&&(E=1),o.normalScale=new n.Vector2(E,E)):(E>=1&&(E=.03),o.bumpScale=E),void 0!==(w=(0,i.parseMaterialBoolean)(h,"generic_is_metal"))&&(o.metal=w),void 0===(A=(0,i.parseMaterialBoolean)(h,"generic_backface_cull"))||A||(o.side=n.DoubleSide),o.transparent=l.transparent,o.textureMaps={},S=l.textures,e.t0=regeneratorRuntime.keys(S);case 48:if((e.t1=e.t0()).done){e.next=81;break}if(M=e.t1.value,(d={}).textureObj=s[S[M].connections[0]],m=d.textureObj.properties,d.textureObj.matrix=f(d.textureObj),d.uriPointer=m.uris.unifiedbitmap_Bitmap.values,d.uri=d.uriPointer[0],d.uri){e.next=58;break}return e.abrupt("continue",48);case 58:if("generic_diffuse"!=M){e.next=63;break}d.mapName="map",(!o.color||0===o.color.r&&0===o.color.g&&0===o.color.b)&&o.color.setRGB(1,1,1),e.next=78;break;case 63:if("generic_bump"!=M){e.next=67;break}d.mapName=_?"normalMap":"bumpMap",e.next=78;break;case 67:if("generic_specular"!=M){e.next=71;break}d.mapName="specularMap",e.next=78;break;case 71:if("generic_alpha"!=M){e.next=77;break}d.mapName="alphaMap",o.side=n.DoubleSide,o.transparent=!0,e.next=78;break;case 77:return e.abrupt("continue",48);case 78:o.textureMaps[d.mapName]=d,e.next=48;break;case 81:0===y.r&&0===y.g&&0===y.b&&0===b.r&&0===b.g&&0===b.b&&0===v.r&&0===v.g&&0===v.b&&0===x.r&&0===x.g&&0===x.b&&(y.r=y.g=y.b=.4),o.extraDepthOffset=(0,i.parseMaterialScalar)(h,"generic_depth_offset"),o.extraDepthOffset&&(o.polygonOffset=!0,o.polygonOffsetFactor=o.extraDepthOffset,o.polygonOffsetUnits=0),e.next=91;break;case 86:o.ambient=new n.Color(197379),o.color=new n.Color(7829367),o.specular=new n.Color(3355443),o.shininess=30,o.shading=n.SmoothShading;case 91:return t.transparent=o.transparent,e.abrupt("return",o);case 93:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function f(e){return e.matrix||(e.matrix=(0,i.Get2DSimpleMapTransform)(e.properties)),e.matrix}function p(e){var t=e.materials,r=t[e.userassets[0]];if(r){var n=r.definition;if("TilingPattern"===n)(r=t[r.properties.references.grout_material.connections[0]])&&(n=r.definition);return"PrismLayered"===n||"PrismMetal"===n||"PrismOpaque"===n||"PrismTransparent"===n||"PrismGlazing"===n||"PrismWood"===n}return!1}var m="OPAQUE",g="MASK",v="BLEND";function y(e){return.299*e.r+.587*e.g+.114*e.b}},97122:(e,t,r)=>{"use strict";r.r(t),r.d(t,{parseMaterialColor:()=>i,parseMaterialScalar:()=>o,parseMaterialBoolean:()=>a,parseMaterialGeneric:()=>s,SRGBToLinearFloat:()=>l,SRGBToLinear:()=>u,Get2DSimpleMapTransform:()=>c,MaterialConverterCommon:()=>h});var n=r(23909);function i(e,t,r){if(!e||!e.colors)return new n.Color(1,0,0);var i=e.colors[t];if(!i)return new n.Color(0,0,0);var o=i.values;if(!o||!o.length)return new n.Color(1,0,0);var a=o[0];return new n.Color(a.r,a.g,a.b)}function o(e,t,r){if(!e||!e.scalars)return r;var n=e.scalars[t];return n?n.values[0]:r}function a(e,t,r){if(!e||!e.booleans)return r;var n=e.booleans[t];return void 0===n?r:n}function s(e,t,r,n){if(!e||!e[t])return n;var i=e[t][r];return i?i.values[0]:n}function l(e){var t=e;return t<=.04045?t/=12.92:t=Math.pow((t+.055)/1.055,2.4),t}function u(e){var t,r,i;return t=l(e.r),r=l(e.g),i=l(e.b),new n.Color(t,r,i)}function c(e){var t=o(e,"texture_UScale",1),r=o(e,"texture_VScale",1),n=o(e,"texture_UOffset",0),i=o(e,"texture_VOffset",0),a=o(e,"texture_WAngle",0);return{elements:[Math.cos(a)*t,Math.sin(a)*r,0,-Math.sin(a)*t,Math.cos(a)*r,0,n,i,1]}}var h={parseMaterialColor:i,parseMaterialScalar:o,parseMaterialBoolean:a,parseMaterialGeneric:s,SRGBToLinearFloat:l,SRGBToLinear:u,Get2DSimpleMapTransform:c}},49514:(e,t,r)=>{"use strict";r.r(t),r.d(t,{MATERIAL_VARIANT:()=>O,MaterialManager:()=>k});var n=r(23909),i=r(50005),o=r(98926),a=r(71519),s=r.n(a),l=r(18350),u=r.n(l),c=r(12990);function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var d,f={uniforms:n.UniformsUtils.merge([c.ShaderChunks.CutPlanesUniforms,{pixelsPerUnit:{type:"f",value:1},aaRange:{type:"f",value:.5},tLayerMask:{type:"t",value:null},tLineStyle:{type:"t",value:null},vLineStyleTexSize:{type:"v2",value:new n.Vector2(13,70)},tRaster:{type:"t",value:null},tSelectionTexture:{type:"t",value:null},vSelTexSize:{type:"v2",value:new n.Vector2(4096,1)},displayPixelRatio:{type:"f",value:1},opacity:{type:"f",value:1},selectionColor:{type:"v4",value:new n.Vector4(0,0,1,1)},modelId:{type:"v3",value:new n.Vector3(0,0,0)},viewportId:{type:"f",value:0},swap:{type:"f",value:0},grayscale:{type:"f",value:0},viewportBounds:{type:"v4",value:new n.Vector4(0,0,1,1)},unpackXform:{type:"v4",value:new n.Vector4(1,1,0,0),perObject:!0},tIdColor:{type:"t",value:null,perObject:!0},vIdColorTexSize:{type:"v2",value:new n.Vector2(256,1),perObject:!0},meshAnimTime:{type:"f",value:0,perObject:!0}}].concat((d=[],function(e){if(Array.isArray(e))return h(e)}(d)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(d)||function(e,t){if(e){if("string"==typeof e)return h(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?h(e,t):void 0}}(d)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()))),vertexShader:s(),fragmentShader:u()},p=r(84325),m=r.n(p),g=r(59191),v=r.n(g),y={uniforms:n.UniformsUtils.merge([f.uniforms,{aaRange:{type:"f",value:1},size:{type:"v2",value:new n.Vector2(1024,768)},cameraPos:{type:"v3",value:new n.Vector3},tanHalfFov:{type:"f",value:0}}]),vertexShader:m(),fragmentShader:v()};function b(e){return b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},b(e)}function x(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function E(e,t){return E=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},E(e,t)}function w(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=S(e);if(t){var i=S(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return A(this,r)}}function A(e,t){if(t&&("object"===b(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function S(e){return S=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},S(e)}var M=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&E(e,t)}(a,e);var t,r,i,o=w(a);function a(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return _(this,a),(e=o.call(this,t.isScreenSpace?{uniforms:n.UniformsUtils.clone(y.uniforms),vertexShader:y.vertexShader,fragmentShader:y.fragmentShader}:{uniforms:n.UniformsUtils.clone(f.uniforms),vertexShader:f.vertexShader,fragmentShader:f.fragmentShader})).isScreenSpace=!!t.isScreenSpace,t.hasLineStyles&&(e.hasLineStyles=!0),e.is2d=!0,e.supportsViewportBounds=!0,e.depthWrite=!1,e.depthTest=!1,e.side=n.DoubleSide,e.transparent=!0,e.blending=n.NormalBlending,e.type="LMVLineMaterial","multiply"==t.compositeOperation?e.blending=n.MultiplyBlending:"min"==t.compositeOperation||"darken"==t.compositeOperation?(e.blending=n.CustomBlending,e.blendEquation=n.MinEquation,e.blendEquationAlpha=n.AddEquation,e.blendSrcAlpha=n.SrcAlphaFactor,e.blendDstAlpha=n.DstAlphaFactor):"max"!=t.compositeOperation&&"lighten"!=t.compositeOperation||(e.blending=n.CustomBlending,e.blendEquation=n.MaxEquation,e.blendEquationAlpha=n.AddEquation,e.blendSrcAlpha=n.SrcAlphaFactor,e.blendDstAlpha=n.DstAlphaFactor),e}return t=a,r&&x(t.prototype,r),i&&x(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}(n.ShaderMaterial),T=r(49321),C=r(88715);function P(e,t,r,n,i,o,a){try{var s=e[o](a),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,i)}function D(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function a(e){P(o,n,i,a,s,"next",e)}function s(e){P(o,n,i,a,s,"throw",e)}a(void 0)}))}}function L(e,t,r){e.x=t.r,e.y=t.g,e.z=t.b,e.w=r}var R=new n.Color("#0000FF"),I=.6,O={INSTANCED:0,VERTEX_IDS:1},N=function(e,t,r){e[t]=r,e.needsUpdate=!0};function k(e){this._renderer=e,this._textures={},this._texturesToUpdate=[],this._materials={},this._materialsNonHDR={},this._exposureBias=0,this._tonemapMethod=0,this._envMapExposure=1,this._envRotationSin=0,this._envRotationCos=1,this._reflectionMap=null,this._irradianceMap=null,this._cutplanes=[],this._mrtNormals=!1,this._mrtIdBuffer=void 0,this._polygonOffsetOn=!1,this._pixelsPerUnit=1,this._lineStyleTex=null,this._swapBlackAndWhite=0,this._grayscaleLines=0,this._depthWriteTransparent=!0,this._needsTwoSided=!1,this._hasTransparentMaterial=!1,this.hasPrism=!1,this._forceDoubleSided=!1,this._layerMaskTextures=[],this._layerMaps=[],this._selectionTextures={},this._prismWoodTextures=void 0,this.defaultMaterial=new n.MeshPhongMaterial({color:7829367,specular:3355443,shininess:30,reflectivity:0}),this.addMaterial("__defaultMaterial__",this.defaultMaterial),this.initLineStyleTexture(),this.refCount=0}k.prototype.dtor=function(){this.cleanup(),n.Cache.clear(),this._renderer=null},k.prototype._getModelHash=function(e){var t=e&&("number"==typeof e?e:e.id);return"model:"+(t||"")+"|"},k.prototype._getMaterialHash=function(e,t){return e&&e.isOTG()?t:this._getModelHash(e)+"mat:"+t},k.prototype._getTextureHash=function(e,t,r){return this._getModelHash(e)+"tex:"+t+"|map:"+r},k.prototype.addNonHDRMaterial=function(e,t){t.doNotCut||(t.cutplanes=this._cutplanes),this._applyMRTFlags(t),this._materialsNonHDR[e]=t},k.prototype.removeNonHDRMaterial=function(e){delete this._materialsNonHDR[e]},k.prototype.addMaterialNonHDR=function(e,t){this.addNonHDRMaterial(e,t)},k.prototype.addHDRMaterial=function(e,t){this._reflectionMap&&!t.disableEnvMap&&(t.envMap=this._reflectionMap),this._irradianceMap&&(t.irradianceMap=this._irradianceMap),t.exposureBias=Math.pow(2,this._exposureBias),t.tonemapOutput=this._tonemapMethod,t.envMapExposure=this._envMapExposure,t.envRotationSin=this._envRotationSin,t.envRotationCos=this._envRotationCos,this._applyCutPlanes(t),this._applyMRTFlags(t),this._applyPolygonOffset(t,this._polygonOffsetOn),this._materials[e]=t},k.prototype._applyCutPlanes=function(e){e.doNotCut?e.cutplanes=null:(e.cutplanes=this._cutplanes,e.needsUpdate=!0,this._cutplanes&&this._cutplanes.length>0?e.side=n.DoubleSide:this._needsTwoSided||e.is2d||this._forceDoubleSided||(e.side=n.FrontSide))},k.prototype.addMaterial=function(e,t,r){var i=t.prismType&&-1!==t.prismType.indexOf("Prism");this.hasPrism=i||this.hasPrism,C.MaterialConverter.applyAppearanceHeuristics(t,i||r,this.isDepthWriteTransparentEnabled()),t.side===n.DoubleSide&&(this._needsTwoSided=!0),this.addHDRMaterial(e,t)},k.prototype.addLineMaterial=function(e,t,r){var n=r&&this._layerMaskTextures[r];n&&(t.defines.HAS_LAYERS=1,t.uniforms.tLayerMask.value=n),t.hasLineStyles&&(t.defines.HAS_LINESTYLES=1,t.defines.MAX_LINESTYLE_LENGTH=this._lineStyleTex.image.width,t.uniforms.tLineStyle.value=this._lineStyleTex,t.uniforms.vLineStyleTexSize.value.set(this._lineStyleTex.image.width,this._lineStyleTex.image.height)),t.uniforms.swap.value=this._swapBlackAndWhite,t.uniforms.grayscale.value=this._grayscaleLines,t.doNotCut||(t.cutplanes=this._cutplanes),this._updatePixelScaleForMaterial(t),this._materials[e]=t,this._applyMRTFlags(t)},k.prototype.addOverrideMaterial=function(e,t){if(this.addNonHDRMaterial(e,t),t.variants)for(var r=0;r<t.variants.length;r++){var n=t.variants[r];if(n){var i=e+"_variant_"+r;this.addNonHDRMaterial(i,n)}}},k.prototype.getMaterialVariant=function(e,t,r){var n=!!e.hash,i=(n?e.hash:this._getModelHash(r)+e.id)+"|"+t,o=this._materials[i];return o||(o=this.cloneMaterial(e,r),t===O.INSTANCED?(o.useInstancing=!0,o.vertexIds=!0):t===O.VERTEX_IDS&&(o.vertexIds=!0),this.addHDRMaterial(i,o)),n&&this._addMaterialRef(o,r.id),o},k.prototype.addInstancingSupport=function(e){var t=e.clone();t.useInstancing=!0,t.packedNormals=e.packedNormals;var r=e.clone();r.wideLines=!0,r.packedNormals=e.packedNormals,e.variants=[t,r],e.getCustomOverrideMaterial=function(e){return e.useInstancing?this.variants[0]:e.wideLines?(this.variants[1].linewidth=e.linewidth,this.variants[1]):null}},k.prototype.addCompactLayoutSupport=function(e){var t=function(t){var r=t.clone();return e.uniforms.tSelectionTexture.value&&(r.uniforms.tSelectionTexture.value=e.uniforms.tSelectionTexture.value),e.uniforms.tLayerMask.value&&(r.uniforms.tLayerMask.value=e.uniforms.tLayerMask.value),r.is2d=e.is2d,r.supportsViewportBounds=e.supportsViewportBounds,r.modelScale=e.modelScale,r.defines=Object.assign({},e.defines),r.attributes=Object.assign({},e.attributes),r},r=t(e);r.defines.UNPACK_POSITIONS=1;var n=t(e);n.defines.USE_INSTANCING=1;var i=t(e);i.defines.UNPACK_POSITIONS=1,i.defines.USE_INSTANCING=1,e.variants=[r,n,i],e.getCustomOverrideMaterial=function(e){if(e.defines){var t=(e.defines.UNPACK_POSITIONS?1:0)+(e.defines.USE_INSTANCING?2:0);if(t>0)return this.variants[t-1]}return null}},k.prototype.removeMaterial=function(e){delete this._materials[e]},k.prototype.findMaterial=function(e,t){var r=this._getMaterialHash(e,t);return this._materials[r]},k.prototype.convertSharedMaterial=function(){var e=D(regeneratorRuntime.mark((function e(t,r,n){var i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=this.findMaterial(t,n)){e.next=6;break}return e.next=4,this.convertOneMaterial(t,r,n);case 4:(i=e.sent).hash=n;case 6:return this._addMaterialRef(i,t.id),e.abrupt("return",i);case 8:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}(),k.prototype.convertOneMaterial=function(){var e=D(regeneratorRuntime.mark((function e(t,r,i){var a,s,l,u,c,h,d,f,p,m,g,v,y,b,x,_;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(a=C.MaterialConverter.isPrismMaterial(r))){e.next=4;break}return e.next=4,C.MaterialConverter.loadMaterialConverterPrismLibrary();case 4:return s=t.getData(),l=s&&s.materials?s.materials.scene.SceneUnit:"inch",(u=a&&C.MaterialConverter.swapPrismWoodTextures(this._prismWoodTextures))&&o.logger.warn("Unexpected wood textures converting a material"),e.next=10,C.MaterialConverter.convertMaterial(r,l);case 10:if(c=e.sent,s.doubleSided&&(c.side=n.DoubleSide),this.addMaterial(i,c),this._hasTransparentMaterial=this._hasTransparentMaterial||c.transparent,!C.MaterialConverter.hasTiling(r)){e.next=36;break}c.decals=[],h=r.materials,d=h[r.userassets[0]],f=d.properties.references.base_materials.connections,p=d.properties.references.tiles.connections,m=[],g=0;case 22:if(!(g<p.length)){e.next=35;break}return v=h[p[g]],m.push(v),e.next=27,C.MaterialConverter.convertMaterial(r,l,null,f[g]);case 27:(y=e.sent).useTiling=!0,y.transparent=!0,c.decals.push({uv:0,material:y}),this.addMaterial(i+"|tile|"+g,y);case 32:g++,e.next=22;break;case 35:C.MaterialConverter.materialTilingPattern(r,d,m,c.decals,l);case 36:if(!r.decals){e.next=49;break}c.decals||(c.decals=[]),b=0,x=r.decals.length;case 39:if(!(b<x)){e.next=49;break}return _=r.decals[b],e.next=43,C.MaterialConverter.convertMaterial(_.material,l);case 43:y=e.sent,c.decals.push({uv:_.uv||0,material:y}),this.addMaterial(i+"|decal|"+b,y);case 46:b++,e.next=39;break;case 49:return this._prismWoodTextures=a&&C.MaterialConverter.swapPrismWoodTextures(u),e.abrupt("return",c);case 51:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}(),k.prototype.forEach=function(e,t,r,n){for(var i in n=n||this._materials){var o=n[i];t&&o.is2d||(e(o,i),r&&o.variants&&o.variants.forEach((function(t){t&&e(t)})))}},k.prototype.forEachInModel=function(e,t,r){var n=this._getModelHash(e),i=function(e,t){-1!==t.indexOf(n)&&r(e)};this.forEach(i,!1,t),this.forEach(i,!1,t,this._materialsNonHDR)};var F={needsClear:!1,needsRender:!1,overlayDirty:!1};function V(e,t,r){var n=e.slots[r];n?-1==n.indexOf(t)&&n.push(t):e.slots[r]=[t]}k.prototype.updateMaterials=function(){for(F.needsRender=!1;this._texturesToUpdate.length;){var e=this._texturesToUpdate.pop();for(var t in e.slots)for(var r=e.slots[t],n=0;n<r.length;n++)r[n][t]=e.tex,r[n].needsUpdate=!0,F.needsRender=!0}return F},k.prototype.setTextureInCache=function(e,t,r){var n=this._getTextureHash(e,t.uri,t.mapName),i=this._textures[n];if(i){for(var o in i.tex||(i.tex=r),i.slots)for(var a=i.slots[o],s=0;s<a.length;s++)a[s][o]=r;this._texturesToUpdate.push(i)}},k.prototype.loadTextureFromCache=function(e,t,r,n){var i=this._getTextureHash(e,r.uri,r.mapName),o=this._textures[i];if(o)o.tex?(t[n]=o.tex,t.needsUpdate=!0):(o.slots[n]||(o.slots[n]=[]),o.slots[n].push(t));else{var a={};a[n]=[t],this._textures[i]={slots:a,tex:null}}return!!o},k.prototype.getOtgMaterials=function(e){for(var t=function(e,t){var r=t.indexOf(e);if(-1!==r)return{hash:e,idx:r};var n=e+"|"+O.INSTANCED,i=t.indexOf(n);if(-1!==i)return{hash:n,idx:i};var o=e+"|"+O.VERTEX_IDS,a=t.indexOf(o);return-1!==a?{hash:o,idx:a}:void 0},r={},n=e.getData(),i=n.fragments.materials,o=Object.keys(this._materials),a=0;a<i.length;a++){var s=i[a],l=t(n.getMaterialHash(s),o);l&&(r[l.hash]=this._materials[l.hash],o.splice(l.idx,1))}return r},k.prototype.getModelMaterials=function(e,t){var r=this._getModelHash(e),n={},i={};for(var o in t&&e.isOTG()&&(n=this.getOtgMaterials(e)),this._materials)if(-1!==o.indexOf(r)){var a=this._materials[o];a.defines&&a.defines.hasOwnProperty("SELECTION_RENDERER")?i[o]=a:n[o]=a}var s={};for(var l in this._materialsNonHDR)-1!==l.indexOf(r)&&(s[l]=this._materialsNonHDR[l]);var u={};for(var c in this._textures)-1!==c.indexOf(r)&&(u[c]=this._textures[c]);return{mats:n,selectionMats:i,matsNonHDR:s,textures:u}},k.prototype.exportModelMaterials=function(e,t){var r=this.getModelMaterials(e);return this.cleanup(e),r},k.prototype.importModelMaterials=function(e,t){for(var r in e.mats){var n=e.mats[r];n.is2d?this.addLineMaterial(r,n,t):this.addHDRMaterial(r,n)}for(var r in e.matsNonHDR)this.addMaterialNonHDR(r,e.matsNonHDR[r]);for(var i in e.textures)this._textures[i]=e.textures[i]},k.prototype.cloneMaterial=function(e,t){var r=e.clone();if(e.defines&&(r.defines=Object.assign({},e.defines)),(r instanceof n.MeshPhongMaterial||r.isPrismMaterial)&&(r.packedNormals=e.packedNormals,r.exposureBias=e.exposureBias,r.irradianceMap=e.irradianceMap,r.envMapExposure=e.envMapExposure,r.envRotationSin=e.envRotationSin,r.envRotationCos=e.envRotationCos,r.proteinType=e.proteinType,r.proteinMat=e.proteinMat,r.proteinCategories=e.proteinCategories,r.tonemapOutput=e.tonemapOutput,r.cutplanes=e.cutplanes,r.textureMaps=e.textureMaps,r.texturesLoaded=e.texturesLoaded),e.doNotCut&&(r.doNotCut=!0),e.is2d&&(r.is2d=!0),e.disableEnvMap&&(r.disableEnvMap=!0),e.supportsViewportBounds&&(r.supportsViewportBounds=!0),e.textureMaps)for(var i in e.textureMaps)if(e[i])r[i]=e[i];else if(t){var a=r.textureMaps[i],s=a.uri,l=a.mapName,u=this._getTextureHash(t,s,l),c=this._textures[u];c?V(c,r,i):o.logger.error("Missing texture receiver",u)}else o.logger.error("Cannot connect pending texture maps because cloneMaterial was called without a model");return this._applyMRTFlags(r),r},k.prototype.setupMaterial=function(e,t,r){var i=e.getData(),a=this.findMaterial(e,r);if(!a){a=this.cloneMaterial(this.defaultMaterial,e);var s=this._getMaterialHash(e,r);this._materials[s]=a,o.logger.warn("Material ("+r+") missing, using default material instead.")}if(t.isLines||t.isWideLines||t.isPoints){var l=!!t.attributes.color,u=a;if(u||(u=this.defaultMaterial.clone()),t.isPoints)a=new n.PointCloudMaterial({vertexColors:l,size:t.pointSize});else{var c=l?"cachedLineMaterialVC":"cachedLineMaterial";a=u[c],t.isWideLines?(a||((a=u[c]=new n.MeshBasicMaterial({vertexColors:l})).wideLines=!0,t.isLines=!1),a.polygonOffset=u.polygonOffset,a.polygonOffsetFactor=u.polygonOffsetFactor,a.polygonOffsetUnits=u.polygonOffsetUnits,a.linewidth=u.linewidth):a||(a=u[c]=new n.LineBasicMaterial({vertexColors:l}))}l||(a.color=u.color),a.svfMatId=r;var h=this._getMaterialHash(e,r+"_line_"+a.id);this.addMaterialNonHDR(h,a),i.hasLines=!0}else a.svfMatId=r,C.MaterialConverter.applyGeometryFlagsToMaterial(a,t);return a},k.prototype._addMaterialRef=function(e,t){e._sharedBy||(e._sharedBy=[]);var r=e._sharedBy;-1===r.indexOf(t)&&r.push(t)},k.prototype._removeMaterialRef=function(e,t){var r=e._sharedBy,n=r?r.indexOf(t):-1;-1!==n&&r.splice(n,1)},k.prototype.cleanup=function(e){var t=this,r=this._getModelHash(e),i={};for(var o in this._textures){var a=this._textures[o];-1===o.indexOf(r)?i[o]=a:a.tex&&(a.tex.dispose(),a.tex.needsUpdate=!0)}this._textures=i;var s={},l={type:"dispose"};for(var u in this._materials){var c=this._materials[u],h=!e||-1!==u.indexOf(r);if(c._sharedBy&&(h?c._sharedBy.length=0:(this._removeMaterialRef(c,e.id),0===c._sharedBy.length&&(h=!0))),h){if((c=this._materials[u]).dispatchEvent(l),c.needsUpdate=!0,c.envMap=null,c.is2d){c.uniforms.tLayerMask.value=null,c.uniforms.tLineStyle.value=null;var d=c.uniforms.tRaster;d&&d.value instanceof n.Texture&&(d.value.dispose(),d.value.needsUpdate=!0)}}else s[u]=this._materials[u]}this._materials=s;var f={};for(var u in this._materialsNonHDR){if(e&&-1===u.indexOf(r))f[u]=this._materialsNonHDR[u];else(c=this._materialsNonHDR[u]).dispatchEvent(l),c.needsUpdate=!0}this._materialsNonHDR=f;var p=function(e,r){var n=t._selectionTextures[e];n&&(n.dispose(),n.needsUpdate=!0,r&&delete t._selectionTextures[e])};if(this._prismWoodTextures&&C.MaterialConverter.disposePrismWoodTextures(this._prismWoodTextures),this._prismWoodTextures=void 0,e)p(e.id,!0),delete this._layerMaskTextures[e.id],delete this._layerMaps[e.id];else{for(var m in this._selectionTextures)this._selectionTextures.hasOwnProperty(m)&&p(m,!1);this._selectionTextures={},this._layerMaskTextures={},this._layerMaps={},this._reflectionMap=null,this._irradianceMap=null}},k.prototype.toggleDepthWriteTransparent=function(e){this._depthWriteTransparent!=e&&(this._depthWriteTransparent=e,this.forEach((function(t){t.lmv_depthWriteTransparent&&(t.depthWrite=e)}),!1,!0))},k.prototype.isDepthWriteTransparentEnabled=function(){return this._depthWriteTransparent},k.prototype.hasTwoSidedMaterials=function(){return this._needsTwoSided},k.prototype.hasTransparentMaterial=function(){return this._hasTransparentMaterial},k.prototype.texturesLoaded=function(){return 0===this._texturesToUpdate.length},k.prototype.renderer=function(){return this._renderer},k.prototype.setTonemapExposureBias=function(e){this._exposureBias=e;var t=Math.pow(2,e);this.forEach((function(e){N(e,"exposureBias",t)}),!0,!0)},k.prototype.setTonemapMethod=function(e){this._tonemapMethod=e,this.forEach((function(t){t.tonemapOutput=e,t.needsUpdate=!0}),!0,!0)},k.prototype.setEnvExposure=function(e){var t=Math.pow(2,e);this._envMapExposure=t,this.forEach((function(e){N(e,"envMapExposure",t)}),!0,!0)},k.prototype.setEnvRotation=function(e){var t=this._envRotationSin=Math.sin(e),r=this._envRotationCos=Math.cos(e);this.forEach((function(e){e.envRotationSin=t,e.envRotationCos=r,e.needsUpdate=!0}),!0,!0)},k.prototype.setReflectionMap=function(e){this._reflectionMap=e,this.forEach((function(t){t.disableEnvMap||N(t,"envMap",e)}),!0,!0)},k.prototype.setIrradianceMap=function(e){this._irradianceMap=e,this.forEach((function(t){N(t,"irradianceMap",e)}),!0,!0)},k.prototype.setDoubleSided=function(e,t){this._forceDoubleSided=e;var r={};r=t?this.getModelMaterials(t,!0).mats:this._materials,this.forEach((function(t){t.side=e?n.DoubleSide:n.FrontSide,t.needsUpdate=!0}),!0,!0,r)},k.prototype.setCutPlanes=function(e){for(var t=this,r=!1,i=this._cutplanes.length!==(e&&e.length||0);this._cutplanes.length>0;)this._cutplanes.pop();if(e)for(var o=0;o<e.length;o++)this._cutplanes.push(e[o].clone());if(i)for(var a in this.forEach((function(e){t._applyCutPlanes(e),r=r||e.side==n.DoubleSide}),!1,!0),this._materialsNonHDR)this._materialsNonHDR[a].doNotCut||(this._materialsNonHDR[a].needsUpdate=!0);return r||this._needsTwoSided},k.prototype.getCutPlanes=function(){return this._cutplanes.slice()},k.prototype.getCutPlanesRaw=function(){return this._cutplanes},k.prototype._applyPolygonOffset=function(e){(e instanceof n.MeshPhongMaterial||e.isPrismMaterial)&&(e.polygonOffset=this._polygonOffsetOn,e.polygonOffsetFactor=this._polygonOffsetFactor,e.polygonOffsetUnits=this._polygonOffsetUnits,e.extraDepthOffset&&(e.polygonOffsetFactor+=e.extraDepthOffset),e.needsUpdate=!0)},k.prototype.getPolygonOffsetOn=function(){return this._polygonOffsetOn},k.prototype.getPolygonOffsetFactor=function(){return this._polygonOffsetFactor},k.prototype.getPolygonOffsetUnits=function(){return this._polygonOffsetUnits},k.prototype.togglePolygonOffset=function(e,t,r){this._polygonOffsetOn=e,this._polygonOffsetFactor=e?t||1:0,this._polygonOffsetUnits=e?r||.1:0;var n=this;this.forEach((function(e){n._applyPolygonOffset(e)}),!1,!0)},k.prototype._applyMRTFlags=function(e){var t,r=e.supportsMrtNormals||e instanceof n.MeshPhongMaterial||e.isPrismMaterial||e instanceof n.MeshBasicMaterial||e instanceof n.LineBasicMaterial||e instanceof n.PointCloudMaterial||e instanceof n.PointsMaterial,i=e.mrtNormals,o=e.mrtIdBuffer;t=this._renderer&&this._renderer.supportsMRT(),e.skipMrtNormals||(e.mrtNormals=r&&t&&this._mrtNormals),e.mrtIdBuffer=t?this._mrtIdBuffer:void 0,e.mrtNormals===i&&e.mrtIdBuffer===o||(e.needsUpdate=!0)},k.prototype.toggleMRTSetting=function(e){this._mrtNormals=e.mrtNormals,this._mrtIdBuffer=e.mrtIdBuffer;var t=this;function r(e){t._applyMRTFlags(e)}this.forEach(r,!1,!0),this.forEach(r,!1,!0,this._materialsNonHDR)},k.prototype.adjustMaterialMRTSetting=function(e){this._applyMRTFlags(e)},k.prototype.initLineStyleTexture=function(){this._lineStyleTex=(0,T.createLinePatternTexture)()},k.prototype.setLineStyleTexture=function(e){this._lineStyleTex=e},k.prototype.initLayersTexture=function(e,t,r){for(var i=this._layerMaskTextures[r],o=i?i.image.data:new Uint8Array(65536),a=0,s=e;a<s;a++)o[a]=255;(i=i||new n.DataTexture(o,256,256,n.LuminanceFormat,n.UnsignedByteType,n.UVMapping,n.ClampToEdgeWrapping,n.ClampToEdgeWrapping,n.NearestFilter,n.NearestFilter,0)).generateMipmaps=!1,i.flipY=!1,i.needsUpdate=!0,this._layerMaskTextures[r]=i,this._layerMaps[r]=t},k.prototype.setLayerVisible=function(e,t,r){for(var n=this._layerMaskTextures[r],i=n.image.data,o=this._layerMaps[r],a=t?255:0,s=0;s<e.length;++s){i[o[e[s]]]=a}n.needsUpdate=!0,this.forEach((function(e){e.is2d&&(e.needsUpdate=!0)}))},k.prototype.initSelectionTexture=function(e,t){if(this._selectionTextures[t])return this._selectionTextures[t];for(var r=e||1,i=4096,o=0|Math.ceil(r/i),a=1;a<o;)a*=2;o=a;for(var s=new Uint8Array(i*o),l=0;l<r;l++)s[l]=0;var u=new n.DataTexture(s,i,o,n.LuminanceFormat,n.UnsignedByteType,n.UVMapping,n.ClampToEdgeWrapping,n.ClampToEdgeWrapping,n.NearestFilter,n.NearestFilter,0);return u.generateMipmaps=!1,u.flipY=!1,u.needsUpdate=!0,this._selectionTextures[t]=u,u},k.prototype.highlightObject2D=function(e,t,r){var n=this._selectionTextures[r];n&&(n.image.data[e]=t?255:0,n.needsUpdate=!0)},k.prototype._updatePixelScaleForMaterial=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._camera,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this._deviceWidth,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this._deviceHeight,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this._pixelsPerUnit,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1;if(e.is2d){if(e.isScreenSpace)if(e.uniforms.size.value.set(r,n),e.uniforms.aaRange.value=.5,null!=t&&t.isPerspective){e.uniforms.cameraPos.value.copy(t.position);var a=t.fov*Math.PI/180;e.uniforms.tanHalfFov.value=Math.tan(.5*a)}else e.uniforms.tanHalfFov.value=0;else e.uniforms.aaRange.value=.5/(i*e.modelScale*o);e.uniforms.pixelsPerUnit.value=i*e.modelScale*o}},k.prototype.updatePixelScale=function(e,t,r,n){var i=this;this._pixelsPerUnit=e,this._deviceWidth=t,this._deviceHeight=r,this._camera=n,this.forEach((function(o){return i._updatePixelScaleForMaterial(o,n,t,r,e)}))},k.prototype.updatePixelScaleForModel=function(e,t,r,n,i,o){var a=this,s=this.getModelMaterials(e),l=function(e){return a._updatePixelScaleForMaterial(e,o,r,n,t,i)};Object.values(s.mats).forEach(l),Object.values(s.matsNonHDR).forEach(l),Object.values(s.selectionMats).forEach(l)},k.prototype.updateSwapBlackAndWhite=function(e){var t=this._swapBlackAndWhite=e?1:0;this.forEach((function(e){e.is2d&&(e.uniforms.swap.value=t)}))},k.prototype.setGrayscale=function(e){var t=this._grayscaleLines=e?1:0;this.forEach((function(e){e.is2d&&(e.uniforms.grayscale.value=t)}))},k.prototype.updateViewportId=function(e){this.forEach((function(t){t.is2d&&(t.uniforms.viewportId.value=e,t.needsUpdate=!0)}))},k.prototype.create2DMaterial=function(e,t,r,o,a){var s=e?e.getData():null,l="__lineMaterial__";t.image&&(l+="|image:"+t.image.name),t.clip&&(l+="|clip:"+JSON.stringify(t.clip)),r&&(l+="|id"),o&&(l+="|selection"),t.skipEllipticals&&(l+="|skipEllipticals"),t.skipCircles&&(l+="|skipCircles"),t.skipTriangleGeoms&&(l+="|skipTriangleGeoms"),t.useInstancing&&(l+="|useInstancing"),t.isScreenSpace&&(l+="|isScreenSpace"),t.unpackPositions&&(l+="|unpackPositions"),t.hasLineStyles&&(l+="|hasLineStyles"),t.compositeOperation&&(l+="|"+t.compositeOperation),t.hasOpacity&&(l+="|hasOpacity"),t.noIdOutput&&(l+="|noIdOutput");var u=this._getMaterialHash(e,l);if(!this._materials.hasOwnProperty(u)){var c=new M(t);if(r)c.defines.ID_COLOR=1,c.blending=n.NoBlending;else if(o)c.uniforms.tSelectionTexture.value=o,c.uniforms.vSelTexSize.value.set(o.image.width,o.image.height),c.defines.SELECTION_RENDERER=1,this.get2dSelectionColor(c.uniforms.selectionColor);else{this.get2dSelectionColor(c.uniforms.selectionColor);this.renderer()&&this.renderer().supportsMRT()&&(c.mrtIdBuffer=this._mrtIdBuffer)}if(t.skipEllipticals||(c.defines.HAS_ELLIPTICALS=1),t.skipCircles||(c.defines.HAS_CIRCLES=1),t.skipTriangleGeoms||(c.defines.HAS_TRIANGLE_GEOMS=1),t.noIdOutput&&(c.defines.NO_ID_OUTPUT=1),t.useInstancing&&(c.defines.USE_INSTANCING=1),t.unpackPositions&&!r&&(c.defines.UNPACK_POSITIONS=1),t.msdfFontTexture&&(c.defines.MSDF_TEXTURE_FONT=1),t.imageUVTexture&&(c.defines.IMAGE_UV_TEXTURE=1),t.viewportBounds&&(c.uniforms.viewportBounds.value=t.viewportBounds.clone(),c.defines.VIEWPORT_CLIPPING=1),"number"==typeof t.opacity&&(c.uniforms.opacity.value=t.opacity),t.image){var h=function(r,i){r?(r.wrapS=n.ClampToEdgeWrapping,r.wrapT=n.ClampToEdgeWrapping,r.minFilter=i?n.LinearFilter:n.LinearMipMapLinearFilter,r.magFilter=n.LinearFilter,r.anisotropy=1,r.flipY=!0,r.generateMipmaps=!0,r.needsUpdate=!0,t.msdfFontTexture||t.imageUVTexture||(c.defines.HAS_RASTER_QUADS=1),c.uniforms.tRaster.value=r,c.needsUpdate=!0,a&&a(r,e)):a&&a(r,e,t)};if("undefined"!=typeof HTMLCanvasElement&&t.image instanceof HTMLCanvasElement||"undefined"!=typeof HTMLImageElement&&t.image instanceof HTMLImageElement)h(new n.Texture(i.TextureLoader.imageToCanvas(t.image,"multiply"==t.compositeOperation,t.compositeCanvasColor),n.UVMapping),!0);else i.TextureLoader.loadTextureWithSecurity(t.image.dataURI,n.UVMapping,h,null,s.acmSessionId)}c.modelScale=t.modelScale||1,t.doNotCut&&(c.doNotCut=!0),c.textureMaps={},this.addLineMaterial(u,c,e&&e.id),(r||o)&&this.addCompactLayoutSupport(c)}return l},k.prototype.set2dSelectionColor=function(e,t){R=new n.Color(e),I=null==t?I:t,this.forEach((function(e){if(e.is2d&&e.uniforms){var t=e.uniforms.selectionColor;t&&(L(t.value,R,I),e.needsUpdate=!0)}}))},k.prototype.get2dSelectionColor=function(e){return e&&L(e.value,R,I),R},k.prototype.get2dSelectionOpacity=function(){return I},k.prototype.setMaterialViewportBounds=function(e,t){e.supportsViewportBounds&&(t?e.defines.VIEWPORT_CLIPPING?e.uniforms.viewportBounds.value.set(t.min.x,t.min.y,t.max.x,t.max.y):(e.uniforms.viewportBounds.value=new n.Vector4(t.min.x,t.min.y,t.max.x,t.max.y),e.defines.VIEWPORT_CLIPPING=1,e.needsUpdate=!0):e.defines.VIEWPORT_CLIPPING&&(delete e.defines.VIEWPORT_CLIPPING,e.needsUpdate=!0))},k.prototype.setViewportBoundsForModel=function(e,t){var r=this;this.forEachInModel(e,!1,(function(e){r.setMaterialViewportBounds(e,t)}))}},93180:(e,t,r)=>{"use strict";r.r(t),r.d(t,{PhongShader:()=>d});var n=r(23909),i=r(12990),o=r(4352),a=r.n(o),s=r(83039);function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var u,c;u=r.n(s)(),c=a();var h,d={uniforms:n.UniformsUtils.merge([n.UniformsLib.common].concat((h=[],function(e){if(Array.isArray(e))return l(e)}(h)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(h)||function(e,t){if(e){if("string"==typeof e)return l(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?l(e,t):void 0}}(h)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),[n.UniformsLib.bump,n.UniformsLib.normalmap,n.UniformsLib.lights,n.UniformsLib.fog,i.ShaderChunks.CutPlanesUniforms,i.ShaderChunks.IdUniforms,i.ShaderChunks.ThemingUniform,i.ShaderChunks.ShadowMapUniforms,i.ShaderChunks.WideLinesUniforms,{emissive:{type:"c",value:new n.Color(0)},specular:{type:"c",value:new n.Color(1118481)},shininess:{type:"f",value:30},reflMipIndex:{type:"f",value:0},texMatrix:{type:"m3",value:new n.Matrix3},texMatrixBump:{type:"m3",value:new n.Matrix3},texMatrixAlpha:{type:"m3",value:new n.Matrix3},irradianceMap:{type:"t",value:null},exposureBias:{type:"f",value:1},envMapExposure:{type:"f",value:1},envRotationSin:{type:"f",value:0},envRotationCos:{type:"f",value:1}}])),vertexShader:c,fragmentShader:u};n.ShaderLib.firefly_phong=d},90564:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GetPrismMapUniforms:()=>i,PrismUtil:()=>o});var n=r(23909);function i(e){var t=e+"_texMatrix",r=e+"_invert",i={};return i[e]={type:"t",value:null},i[t]={type:"m3",value:new n.Matrix3},i[r]={type:"i",value:0},i}var o={GetPrismMapUniforms:i}},26842:(e,t,r)=>{"use strict";r.r(t),r.d(t,{RenderContext:()=>ae});var n=r(23909),i=r(84998),o=r(79659),a=r(98926),s=r(69632),l=r(12990),u=r(66209),c=r.n(u),h=r(20505),d=r.n(h),f={uniforms:n.UniformsUtils.merge([l.ShaderChunks.DepthTextureUniforms,{tDiffuse:{type:"t",value:null},tAO:{type:"t",value:null},useAO:{type:"i",value:0},aoOpacity:{type:"f",value:.625},tOverlay:{type:"t",value:null},useOverlay:{type:"i",value:0},useOverlayAlpha:{type:"i",value:1},tID:{type:"t",value:null},tID2:{type:"t",value:null},objIDv4:{type:"v4",value:new n.Vector4(0,0,0,0)},modelIDv2:{type:"v2",value:new n.Vector2(0,0)},modelIDsv2v:{type:"v2v",value:[]},edgeObjIDv4:{type:"v4",value:new n.Vector4(0,0,0,0)},edgeModelIDv2:{type:"v2",value:new n.Vector2(0,0)},highlightIntensity:{type:"f",value:1},highlightColor:{type:"c",value:new n.Color(1,1,1)},resolution:{type:"v2",value:new n.Vector2(1/1024,1/512)},selectionColor:{type:"c",value:new n.Color(0,0,0)},expand2dSelection:{type:"f",value:.5},tCrossFadeTex0:{type:"t",value:null},tCrossFadeTex1:{type:"t",value:null},crossFadeOpacity0:{type:"f",value:0},crossFadeOpacity1:{type:"f",value:0},highlightFullModel:{type:"f",value:0}}]),vertexShader:c(),fragmentShader:d()},p=r(61768),m=r(63332),g=r.n(m),v=r(49510),y=r.n(v),b={uniforms:{tDiffuse:{type:"t",value:null},uResolution:{type:"v2",value:new n.Vector2(1/1024,1/512)}},vertexShader:g(),fragmentShader:y()},x=r(79282),_=r.n(x),E=r(6750),w=r.n(E),A={uniforms:{color:{type:"v4",value:new n.Vector4(0,0,0,.3)},cutplanes:{type:"v4v",value:[]}},vertexShader:_(),fragmentShader:w()},S=r(5030),M=r.n(S),T=r(74957),C=r.n(T),P={uniforms:{cutplanes:{type:"v4v",value:[]}},vertexShader:M(),fragmentShader:C()},D=r(14705),L=1,R=2,I=3,O=4,N=5,k=6,F=7,V=8;function U(e,t,r,i,o){var a=new n.WebGLRenderTarget(e,t,{minFilter:n.NearestFilter,magFilter:n.NearestFilter,format:r,type:i,stencilBuffer:!1});return o&&(a.shareDepthFrom=o),a.name="depthTarget",a}var B=new n.Vector4(1,1,1,.5),z=new n.Vector4(1,1,1,1);function G(e,t){var r=new n.WebGLRenderTarget(e,t,{minFilter:n.NearestFilter,magFilter:n.NearestFilter,format:n.RGBAFormat,type:n.UnsignedByteType,stencilBuffer:!1});return r.texture.generateMipmaps=!1,r.canReadPixels=!0,r}function H(e){e.material.blending=n.NoBlending,e.material.depthWrite=!1,e.material.depthTest=!1}function W(e,t){if(e&&t){t.length=0;for(var r=0;r<e.length;r++)t[r]=e[r]}}var j=r(66199),q=r(50410),X=r.n(q),Y={uniforms:{tDiffuse:{type:"t",value:null},size:{type:"v2",value:new n.Vector2(512,512)},resolution:{type:"v2",value:new n.Vector2(1/512,1/512)},axis:{type:"v2",value:new n.Vector2(1,0)},radius:{type:"f",value:50}},vertexShader:c(),fragmentShader:X()},K=r(11342),Z=r.n(K),Q=r(92003),J=r.n(Q),$=r(3819),ee=r.n($),te={uniforms:{tDiffuse:{type:"t",value:null},cameraNear:{type:"f",value:1},cameraInvNearFar:{type:"f",value:100},resolution:{type:"v2",value:new n.Vector2(1/512,1/512)}},vertexShader:Z(),fragmentShader:J()},re={uniforms:{tDiffuse:{type:"t",value:null},resolution:{type:"v2",value:new n.Vector2(1/512,1/512)}},vertexShader:Z(),fragmentShader:ee()},ne=r(97339),ie=r(85994),oe=(0,i.getGlobal)().document;function ae(){var e,t,r,l,u,c,h,d,m,g,v,y,x,_,E,w=!1,S=new j.RenderContextPostProcessManager;this.postShadingManager=function(){return S};var M,T,C,q,X={},K=null,Z=null,Q=null,J=null,$=null,ee=null,ae=null,se=null,le=[],ue=null,ce=0,he=0,de=0,fe=0,pe=1,me=!1,ge=!1,ve={},ye={},be=[0,0],xe=(new n.Color).setRGB(1,1,1),_e=(new n.Color).setRGB(0,0,0),Ee=new n.Vector4(0,0,0,.3),we=null,Ae=1,Se=1,Me=!1,Te={isRenderingHidden:!1,isRenderingOverlays:!1},Ce=!1,Pe=!1,De=n.RGBAFormat,Le=n.FloatType,Re=!1,Ie=0,Oe=0,Ne=0,ke=[.42,0,1,1],Fe=!0,Ve={antialias:!0,sao:!1,useHdrTarget:!1,haveTwoSided:!1,useSSAA:!1,idbuffer:!0,customPresentPass:!1,envMapBg:!1,numIdTargets:1,renderEdges:!1,useIdBufferSelection:!1,copyDepth:!1},Ue={},Be=null,ze=null;function Ge(t){try{var r=U(2,2,t.format,t.type);r.texture.generateMipmaps=!1,e.setRenderTarget(r);var n=e.getContext(),i=n.checkFramebufferStatus(n.FRAMEBUFFER);return e.setRenderTarget(null),r.dispose(),i===n.FRAMEBUFFER_COMPLETE}catch(e){return!1}}function He(){var e=(Me?[{format:n.RGBAFormat,type:n.HalfFloatType},{format:n.RGBAFormat,type:n.FloatType}]:[{format:n.RGBAFormat,type:n.FloatType},{format:n.RGBAFormat,type:n.HalfFloatType}]).find(Ge);e?(Re=!0,De=e.format,Le=e.type):(Re=!1,a.logger.warn("Depth target is unsupported for this device."))}function We(e){Ve.useIdBufferSelection=e,e?_.material.defines.USE_IDBUFFER_SELECTION="1":delete _.material.defines.USE_IDBUFFER_SELECTION}function je(e){e(t);for(var r=1;r<t.variants.length;r++)e(t.variants[r])}function qe(){t=function(){var e=P,t=(0,D.createShaderMaterial)(e);t.blending=n.NoBlending,t.packedNormals=!0,t.depthWrite=!1;var r=1,i=2,o=4,a=8,s=[];s[0]=null;for(var l=1;l<a;l++){var u=t.clone();u.packedNormals=t.packedNormals,l&r&&(u.cutPlanes=null,u.doNotCut=!0),l&i&&(u.useInstancing=!0),l&o&&(u.packedNormals=!1),s[l]=u}return t.variants=s,t.getCustomOverrideMaterial=function(e){var t=!e||!e.cutplanes||0==e.cutplanes.length,n=e.useInstancing,a=!e.packedNormals,s=(t?r:0)|(n?i:0)|(a?o:0);return this.variants[s]},t}(),r=function(e,t){var r=A,o=(0,D.createShaderMaterial)(r);o.depthWrite=!0,o.depthTest=!0,o.isEdgeMaterial=!0,o.transparent=!0,o.blending=n.NormalBlending,o.supportsMrtNormals=!0;var a=1,s=2,l=4,u=[];u[0]=null;for(var c=1;c<l;c++){var h=o.clone();h.defines=(0,i.ObjectAssign)({},o.defines),h.isEdgeMaterial=!0,h.supportsMrtNormals=!0,c&a&&(h.useInstancing=!0),c&s&&(h.doNotCut=!0,h.cutplanes=[]),u[c]=h}return o.variants=u,o.getCustomOverrideMaterial=function(r){var n=r.useInstancing?a:0;r.doNotCut&&(n|=s);var i=this.variants[n]||o;return e.isRenderingOverlays?e.isRenderingHidden?i.uniforms.color.value.copy(B):i.uniforms.color.value.copy(z):i.uniforms.color.value.copy(t),void 0!==r.edgeOpacity&&(i.uniforms.color.value.w=r.edgeOpacity),i.uniforms.color.needsUpdate=!0,i},o}(Te,Ee),H(g=new ie.ShaderPass(ne.SAOShader)),H(m=new ie.ShaderPass(Y)),H(y=new ie.ShaderPass(te)),H(v=new ie.ShaderPass(re)),H(x=new ie.ShaderPass(b)),H(_=new ie.ShaderPass(f)),H(d=new ie.ShaderPass(s.Q)),H(E=new ie.ShaderPass(p.CopyShader))}function Xe(e){switch(e){case L:case O:return!0;case R:return Re&&(Ve.sao||S.isPostProcShaded());case I:return Ve.idbuffer;case F:return Ve.sao;case N:return Ve.antialias||Ve.sao||Ve.customPresentPass||S.isPostProcShaded();case k:return S.isPostProcShaded()||Ve.customPresentPass;case V:return Ve.antialias&&S.isPostProcShaded()}}function Ye(){var t=$,r=Z;if(_.uniforms.useAO.value){var i=function(){var e=[_.uniforms.useOverlay.value,_.uniforms.objIDv4.value];return _.uniforms.useOverlay.value=0,_.uniforms.objIDv4.value=new n.Vector4,e}();_.render(e,t,r),r=t,t=se,function(e){_.uniforms.useOverlay.value=e[0],_.uniforms.objIDv4.value=e[1]}(i)}var o=t===$?se:$;if(t=(r=S.render(e,t,r,o,!1))===$?se:$,_.uniforms.useOverlay.value||_.uniforms.objIDv4.value){var a=function(){var e=_.uniforms.useAO.value;return _.uniforms.useAO.value=0,e}();_.render(e,t,r),r=t,function(e){_.uniforms.useAO.value=e}(a)}return o=(t=r===$?se:$)===$?se:$,r=S.render(e,t,r,o,!0)}function Ke(e,t){return(t=t||new n.Vector2).set((255&e)/255,(e>>8&255)/255),t}function Ze(e,t,r){t=t||0;var n=function(e){return e!==Oe&&(Oe=e,-1===e&&(e=0),_.uniforms.objIDv4.value.set((255&e)/255,(e>>8&255)/255,(e>>16&255)/255,(e>>24&255)/255),!0)}(e),i=function(e){if(Array.isArray(e)&&1==e.length&&(e=e[0]),e===Ne)return!1;var t=Array.isArray(Ne)?Ne.length:1,r=Array.isArray(e)?e.length:1;return!(r>1&&(e.sort(),r==t&&!Ne.some((function(t,r){return t!==e[r]})))||(r!=t&&(1==r?delete _.material.defines.HIGHLIGHT_MODEL_ID_COUNT:_.material.defines.HIGHLIGHT_MODEL_ID_COUNT=r.toString(),_.material.needsUpdate=!0),Ne=e,1==r?Ke(e=Array.isArray(e)?e[0]:e,_.uniforms.modelIDv2.value):_.uniforms.modelIDsv2v.value=e.map((function(e){return Ke(e)})),0))}(t);if(n||i)return _.uniforms.highlightIntensity.value=0,Ie=performance.now(),_.uniforms.highlightFullModel.value=r?1:0,!0}this.settings=Ve,this.depthTargetSupported=function(){return Re},this.isRolloverHighlightEnabled=function(){return _enableRolloverHighlight},this.isWeakDevice=function(){return Me},this.init=function(t,r,n){var s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},l=s.offscreen,u=void 0!==s.useIdBufferSelection&&s.useIdBufferSelection;qe(),t?(Me=(0,i.isMobileDevice)(),Ve.idbuffer=!Me,u&&(Ve.idbuffer=!0,Ve.numIdTargets=2,_.material.defines.USE_MODEL_ID="1",We(!0)),C=r,q=n,e=t,ge=!!l,He()):(0,i.isNodeJS)()||a.logger.error("You need a gl context to make a renderer. Things will go downhill from here.",(0,o.errorCodeString)(o.ErrorCodes.BROWSER_WEBGL_NOT_SUPPORTED))},this.setDepthMaterialOffset=function(e,t,r){je((function(n){n.polygonOffset=e,n.polygonOffsetFactor=t,n.polygonOffsetUnits=r,n.extraDepthOffset&&(n.polygonOffsetFactor+=n.extraDepthOffset),n.needsUpdate=!0}))},this.setNoDepthNoBlend=H,this.overlayUpdate=function(){if(0===Oe||-1===Oe)return!1;var e=_.uniforms.highlightIntensity.value,t=1;if(Fe){var r=.004*(performance.now()-Ie);r=Math.min(r,1),t=function(e,t){var r=3*e[1],n=3*(e[3]-e[1])-r;return(((1-r-n)*t+n)*t+r)*t}(ke,r)}return e!=t&&(_.uniforms.highlightIntensity.value=t,!0)},this.setRollOverFadeEnabled=function(e){Fe=e},this.beginScene=function(t,r,s,l){if(u=r,h=t.fog,c=s,w=!1,X={},!Z&&C)this.initPostPipeline(Ve.sao,Ve.antialias);else if(!Z&&!C)return void(me||(0,i.isNodeJS)()||(a.logger.error("Rendering to a canvas that was resized to zero. If you see this message you may be accidentally leaking a viewer instance.",(0,o.errorCodeString)(o.ErrorCodes.VIEWER_INTERNAL_ERROR)),me=!0));if(l){var f=Ve.envMapBg&&!!d.material.envMap,p=!!d.material.useBackgroundTexture;if(!we||f||p){var m=d.uniforms.uCamDir.value||new n.Vector3;d.uniforms.uCamDir.value=u.worldUpTransform?u.getWorldDirection(m).applyMatrix4(u.worldUpTransform):u.getWorldDirection(m),d.uniforms.uCamUp.value=u.worldUpTransform?u.up.clone().applyMatrix4(u.worldUpTransform):u.up,d.uniforms.uResolution.value.set(C,q),d.uniforms.uHalfFovTan.value=Math.tan(n.Math.degToRad(.5*u.fov)),d.uniforms.opacity.value=Ae,e.setRenderTarget(Z),e.clear(!1,!0,!1),d.render(e,Z,null)}else e.setClearColor(we,Ae),e.setRenderTarget(Z),e.clear(!0,!0,!1);Be&&Be.clearTarget(e);for(var v=0;v<le.length;v++)e.setClearColor(xe,1),e.setRenderTarget(le[v]),e.clear(!0,!1,!1)}if(Xe(R)){l&&(e.setClearColor(_e,0),e.setRenderTarget(T),e.clear(!0,!1,!1));var b=r.near,x=r.far;g.uniforms.cameraNear.value=b,g.uniforms.cameraFar.value=x,y.uniforms.cameraNear.value=b,y.uniforms.cameraInvNearFar.value=1/(b-x);var E=r.projectionMatrix.elements;r.isPerspective?g.uniforms.projInfo.value.set(-2/(Z.width*E[0]),-2/(Z.height*E[5]),(1-E[8])/E[0],(1+E[9])/E[5]):g.uniforms.projInfo.value.set(-2/(Z.width*E[0]),-2/(Z.height*E[5]),(1-E[12])/E[0],(1-E[13])/E[5]),_.uniforms.projInfo.value.copy(g.uniforms.projInfo.value);var A=r.isPerspective?0:1;g.uniforms.isOrtho.value=A,_.uniforms.isOrtho.value=A;if(g.uniforms.projScale.value=Z.height*E[5]*.125,_.uniforms.worldMatrix_mainPass.value=r.matrixWorld,S.isPostProcShaded()){var M=Autodesk.Viewing.Navigation.prototype.fov2fl(r.fov);S.updateUniformValue("focalLength",M),S.updateUniformValue("unitScale",pe),S.updateUniformValue("worldMatrix_mainPass",r.matrixWorld,!0),S.updateUniformValue("cameraPos",r.position,!0),S.updateUniformValue("cameraNear",b),S.updateUniformValue("cameraFar",x),S.updateUniformValue("projInfo",g.uniforms.projInfo.value,!0),S.updateUniformValue("isOrtho",A)}}Ve.sao||(_.uniforms.useAO.value=0),this.renderScenePart(t,!0,!0,!0,!0)},this._render=function(e,t,r,n,i){e.setRenderTarget(t),e.render(r,n,i)},this._renderDepthTarget=function(r,n,i,o){if(n&&!r.sortObjects&&i){var a=r.overrideMaterial;r.overrideMaterial=t,t.depthWrite!==o&&function(e,t){e.depthWrite=t;for(var r=0;r<e.variants.length;r++){var n=e.variants[r];n&&(n.depthWrite=t)}}(t,o),this._render(e,i,r,u),r.overrideMaterial=a}},this.renderScenePart=function(t,n,i,o,a){void 0!==t.skipColorTarget&&(n=!t.skipColorTarget),void 0!==t.skipDepthTarget&&(i=!t.skipDepthTarget),void 0!==t.skipIdTarget&&(o=!t.skipIdTarget),n&&Ve.renderEdges&&(t.edgeMaterial=r);var s=i&&Xe(R),d=Z,f=T,p=!1;Be&&(d=Be.chooseColorTarget(t,d),p=(f=Be.getRenderSao(t)?T:null)&&T.shareDepthFrom!==d),w=!1,X={};var m,g,v=a?c:void 0;t.fog=h,Ce&&Pe?(m=Xe(I)&&o&&s?[d,f].concat(le):s?[d,f]:Xe(I)&&o?[d].concat(le):d,this._render(e,m,t,u,v)):Pe?(m=Xe(I)&&o?[d].concat(le):d,this._render(e,m,t,u,v),this._renderDepthTarget(t,s,f,p)):(n?(m=d,this._render(e,d,t,u,v)):p=!0,Xe(I)&&o&&(l?(g=t.overrideMaterial,t.overrideMaterial=l,this._render(e,le[0],t,u),t.overrideMaterial=g):(e.setProgramPrefix(1,"#define ID_COLOR","#define ID_COLOR"),this._render(e,le[0],t,u),e.setProgramPrefix(0,"","")),p=!1),this._renderDepthTarget(t,s,f,p)),t.edgeMaterial=void 0},this.clearAllOverlays=function(){e.setRenderTarget(Q),e.clear(!0,!1,!1)},this.renderOverlays=function(t,i,o){var a=0;Te.isRenderingOverlays=!0;for(var s=!1,l=!1,c=Object.values(t).sort((function(e,t){return e.needSeparateDepth==t.needSeparateDepth?0:1==e.needSeparateDepth?1:1==t.needSeparateDepth?-1:void 0})),h=0;h<c.length;++h){var d=c[h],f=d.scene,p=d.camera?d.camera:u,m=e;if(f.children.length){if(m.setRenderTarget(Q),a||(a=1,o||(m.setClearColor(_e,0),m.clear(!0,!1,!1))),d.materialPre&&(f.overrideMaterial=d.materialPre),d.needSeparateDepth?l||(Q.shareDepthFrom=null,m.setRenderTarget(Q),m.clear(!1,!0,!1),l=!0):Q.shareDepthFrom=Z,Pe&&d.needIdTarget){ue||((ue=G(Q.width,Q.height)).shareDepthFrom=Z,ue.name="overlayId"),0==s&&(m.setRenderTarget(ue),m.clear(!0,!1,!1),s=!0);var g=[Q];d.needIdTarget&&g.push(ue),this._render(m,g,f,p,i)}else this._render(m,Q,f,p,i),d.needIdTarget&&(ue||((ue=G(Q.width,Q.height)).shareDepthFrom=Z,ue.name="overlayId"),m.setProgramPrefix(1,"#define ID_COLOR","#define ID_COLOR"),this._render(m,ue,f,p,i),m.setProgramPrefix(0,"",""));d.materialPost&&(Te.isRenderingHidden=!0,m.getContext().depthFunc(m.getContext().GREATER),d.materialPost.depthFunc=n.GreaterDepth,Ve.renderEdges&&(r.depthWrite=!1,r.depthTest=!1,f.overrideMaterial=r,this._render(m,Q,f,p)),f.overrideMaterial=d.materialPost,this._render(m,Q,f,p,i),m.getContext().depthFunc(m.getContext().LEQUAL),d.materialPost.depthFunc=n.LessEqualDepth,Te.isRenderingHidden=!1),Ve.renderEdges&&d.materialPre&&(r.depthWrite=!1,r.depthTest=!0,f.overrideMaterial=r,this._render(m,Q,f,p)),f.overrideMaterial=null}}Te.isRenderingOverlays=!1,r.depthWrite=!0,r.depthTest=!0,_.uniforms.useOverlay.value=a,a&&(_.uniforms.useOverlayAlpha.value=Se)},this.computeSSAO=function(t){if(!t&&Ve.sao){if(!w){if(K&&K.length){var r=K[0];y.uniforms.resolution.value.set(1/r.width,1/r.height),y.render(e,r,T);for(var n=1;n<K.length;n++){var i=K[n];v.uniforms.resolution.value.set(1/i.width,1/i.height),v.render(e,i,r),r=i}}g.render(e,ae,Z),m.uniforms.axis.value.set(1,0),m.render(e,$,ae),m.uniforms.axis.value.set(0,1),m.render(e,ae,$),w=!0}_.uniforms.useAO.value=1}else _.uniforms.useAO.value=0},this.getFinalTarget=function(){return ze||null},this.presentBuffer=function(t){if(e){var r=this.getFinalTarget();if(!(_.uniforms.useAO.value||_.uniforms.useOverlay.value||Be||0!==Oe&&-1!==Oe||0!==Ne&&-1!==Ne))if(Ve.antialias)if(t)x.render(e,$,Z),t.render(e,r,$);else if(S.isPostProcShaded()){var n=S.render(e,$,Z,se);E.render(e,ee,n),x.render(e,r,ee)}else x.render(e,r,Z);else if(t)t.render(e,r,Z);else if(S.isPostProcShaded()){var i=S.render(e,$,Z,se);E.render(e,r,i)}else E.render(e,r,Z);else if(Ve.antialias)if(t)_.render(e,$,Z),x.render(e,se,$),t.render(e,r,se);else if(S.isPostProcShaded()){var o=Ye();E.render(e,ee,o),x.render(e,r,ee)}else _.render(e,$,Z),x.render(e,r,$);else if(t)_.render(e,$,Z),t.render(e,r,$);else if(S.isPostProcShaded()){o=Ye();E.render(e,r,o)}else _.render(e,r,Z)}},this.composeFinalFrame=function(e,t){this.computeSSAO(e),t||this.presentBuffer()},this.cleanup=function(){if(e&&e.setRenderTarget(null),Z&&(Z.dispose(),Z=null),T&&(T.dispose(),T=null),Q&&(Q.dispose(),Q=null),ue&&(ue.dispose(),ue=null),J&&(J.dispose(),J=null),M&&(M.dispose(),M=null),Be&&Be.disposeTargets(),$&&($.dispose(),$=null),ae&&(ae.dispose(),ae=null),se&&(se.dispose(),se=null),K){for(var t=0;t<K.length;t++)K[t].dispose();K=[]}for(t=0;t<le.length;t++)le[t]&&le[t].dispose();le=[],X={},ve={},ye={}},this.setSize=function(t,r,i,o){var s,l,u,c,h,d;if(null!==(s=this._renderer)&&void 0!==s&&null!==(l=s.xr)&&void 0!==l&&l.isPresenting)console.warn("RenderContext: Can't change size while XR device is presenting.");else if(C=t,q=r,Ve.logicalWidth=t,Ve.logicalHeight=r,0===t&&0===r||!e)this.cleanup();else{var f,p=0|t*e.getPixelRatio(),v=0|r*e.getPixelRatio();Ve.deviceWidth=p,Ve.deviceHeight=v,o||(ge?e.setViewport(0,0,t,r):e.setSize(t,r));var y=p,b=v;(Ve.useSSAA||S.isPostProcShaded()&&!Me&&e.getPixelRatio()<=1&&S.postProcessEdgesOn())&&(p*=2,v*=2);var E=1/p,w=1/v;if(!i&&Z&&Z.width==p&&Z.height==v||(a.logger.log("Reallocating render targets."),this.cleanup(),(Z=new n.WebGLRenderTarget(p,v,{minFilter:n.LinearFilter,magFilter:n.LinearFilter,format:n.RGBAFormat,type:Ve.useHdrTarget?n.FloatType:n.UnsignedByteType,stencilBuffer:!1})).texture.generateMipmaps=!1,Z.name="colorTarget",(Q=new n.WebGLRenderTarget(p,v,{minFilter:n.NearestFilter,magFilter:n.NearestFilter,format:n.RGBAFormat,stencilBuffer:!1})).texture.generateMipmaps=!1,Q.name="overlayTarget",Q.shareDepthFrom=Z,Pe=e.verifyMRTWorks([Z,Q]),T=null,$=null,ee=null,ae=null,se=null,K=[]),Be&&Be.updateTargets(p,v,i,Ve.useHdrTarget),Xe(N)&&(!i&&$&&$.width==p&&$.height==v||(($=new n.WebGLRenderTarget(p,v,{minFilter:n.LinearFilter,magFilter:n.LinearFilter,format:n.RGBAFormat,stencilBuffer:!1,depthBuffer:!1})).texture.generateMipmaps=!1,$.name="postTarget1")),!ae&&Xe(F)&&((ae=$.clone()).name="SSAO target"),!se&&Xe(k)&&((se=$.clone()).name="post target 2"),!ee&&Xe(V)&&((ee=new n.WebGLRenderTarget(y,b,{minFilter:n.LinearFilter,magFilter:n.LinearFilter,format:n.RGBAFormat,stencilBuffer:!1,depthBuffer:!1})).texture.generateMipmaps=!1,ee.name="postTargetNormal"),Xe(R)){if(i||!T||T.width!=p||T.height!=v){T=U(p,v,De,Le,Z),K=[];for(var A=0;A<5;A++){var M=0|p/(2<<A),P=0|v/(2<<A),D=null;M>=1&&P>=1&&((D=new n.WebGLRenderTarget(M,P,{minFilter:n.NearestFilter,magFilter:n.NearestFilter,format:n.RGBAFormat,depthBuffer:!1,stencilBuffer:!1})).texture.generateMipmaps=!1,K.push(D),D.name="depthTarget_mipmap "+A),g.uniforms["tDepth_mip"+(A+1)].value=D.texture}Ce=e.verifyMRTWorks([Z,T])}g.uniforms.size.value.set(p,v),g.uniforms.resolution.value.set(E,w),g.uniforms.tDepth.value=T.texture,m.uniforms.size.value.set(p,v),m.uniforms.resolution.value.set(E,w),S.updateUniformValue("tDepth",T),_.uniforms.tDepth.value=T.texture}if(Xe(I)){if(i||!le[0]||le[0].width!=p||le[0].height!=v){for(f=0;f<le.length;f++)le[f]&&le[f].dispose();for(le=[],f=0;f<Ve.numIdTargets;f++){var L=G(p,v);L.shareDepthFrom=Z,L.name="id "+f,le.push(L)}Pe||a.logger.warn("ID buffer requested, but MRT is not supported. Some features will not work.")}S.updateUniformValue("tID",le[0])}else if(le[0]){for(f=0;f<le.length;f++)le[f].dispose(),le[f]=null;le.length=0}x.uniforms.uResolution.value.set(E,w),S.changeResolution(E,w),_.uniforms.tOverlay.value=null===(u=Q)||void 0===u?void 0:u.texture,_.uniforms.tAO.value=null===(c=ae)||void 0===c?void 0:c.texture,_.uniforms.useAO.value=Ve.sao?1:0,_.uniforms.resolution.value.set(E,w),_.uniforms.tID.value=(null===(h=le[0])||void 0===h?void 0:h.texture)||null,_.uniforms.tID2.value=(null===(d=le[1])||void 0===d?void 0:d.texture)||null,Be&&Be.updateBlendPass()}},this.getMaxAnisotropy=function(){return e?e.getMaxAnisotropy():0},this.mrtFlags=function(){return{mrtNormals:Ce&&Xe(R),mrtIdBuffer:Pe&&Xe(I)?Ve.numIdTargets:void 0}},this.setIdTargetCount=function(e){if(!(e>2||e<1)&&e!==Ve.numIdTargets&&(Ve.numIdTargets=e,0!==le.length&&2===e&&1===le.length)){var t=G(le[0].width,le[0].height);return t.shareDepthFrom=Z,t.name="id "+le.length,le.push(t),_.uniforms.tID2.value=t,_.material.defines.USE_MODEL_ID="1",_.material.needsUpdate=!0,!0}},this.getAntialiasing=function(){return Ve.antialias},this.initPostPipeline=function(e,t){Ve.sao=e&&!i.isIE11&&Re,Ve.antialias=t&&!i.isIE11,Ve.haveTwoSided&&je((function(e){e.side=n.DoubleSide})),je((function(e){e.needsUpdate=!0})),g.material.needsUpdate=!0,m.material.needsUpdate=!0,y.material.needsUpdate=!0,v.material.needsUpdate=!0,x.material.needsUpdate=!0,S.setMaterialNeedsUpdate(),_.material.needsUpdate=!0,d.material.needsUpdate=!0,E.material.needsUpdate=!0,this.setSize(C,q)},this.setClearColors=function(e,t){(we=t?e.equals(t)||Me?new n.Color(.5*(e.x+t.x),.5*(e.y+t.y),.5*(e.z+t.z)):void 0:e.clone())||(d.uniforms.color1.value.copy(e),d.uniforms.color2.value.copy(t))},this.useOverlayAlpha=function(e){Se=e},this.setClearAlpha=function(e){Ae=e},this.setAOEnabled=function(e){Ve.sao=e&&Re,Ue.sao=Ve.sao,this.setSize(C,q,!1,!0)},this.setAOOptions=function(e,t,r){void 0!==e&&(g.uniforms.radius.value=e,g.uniforms.bias.value=(0,i.isMobileDevice)()?.1:.01,m.uniforms.radius.value=e),void 0!==t&&(g.uniforms.intensity.value=t),_.uniforms.aoOpacity.value=void 0!==r?r:1,w=!1},this.getAOEnabled=function(){return Ve.sao},this.getAORadius=function(){return g.uniforms.radius.value},this.getAOIntensity=function(){return g.uniforms.intensity.value},this.setCubeMap=function(e){d.material.envMap=e,e||this.toggleEnvMapBackground(!1),e&&Ve.envMapBg&&(d.uniforms.envMapBackground.value=!0)},this.setBackgroundTexture=function(e){var t=d.material.useBackgroundTexture;d.uniforms.backgroundTexture.value=e,d.material.useBackgroundTexture=!!e,!!e!==t&&(d.material.needsUpdate=!0)},this.getCubeMap=function(){return d.material.envMap},this.setEnvRotation=function(e){de=e,d.material.envRotationSin=Math.sin(e),d.material.envRotationCos=Math.cos(e)},this.getEnvRotation=function(){return de},this.setEnvExposure=function(e){var t=d.material.envMapExposure,r=Math.pow(2,e);d.uniforms.envMapExposure.value=r,d.material.envMapExposure=r,r!==t&&(d.material.needsUpdate=!0),ce=e},this.setTonemapExposureBias=function(e){he=e,d.uniforms.exposureBias.value=Math.pow(2,e)},this.getExposureBias=function(){return he},this.setCamera=function(e){u=e},this.setTonemapMethod=function(t){var r=fe;fe=t,e.gammaInput=0!==t,d.material.tonemapOutput=fe,t!==r&&(d.material.needsUpdate=!0)},this.getToneMapMethod=function(){return fe},this.toggleTwoSided=function(e){Ve.haveTwoSided!=e&&t&&je((function(t){t.side=e?n.DoubleSide:n.FrontSide,t.needsUpdate=!0})),Ve.haveTwoSided=e},this.toggleEdges=function(e){Ve.renderEdges=e,Ue.renderEdges=e},this.getRenderEdges=function(){return Ve.renderEdges},this.getRenderEdges=function(){return Ve.renderEdges},this.toggleEnvMapBackground=function(e){Ve.envMapBg=e,d.uniforms.envMapBackground.value=e&&!!d.material.envMap},this.enter2DMode=function(e,t){l=e,Ue.sao=Ve.sao,Ue.antialias=Ve.antialias,Ue.idbuffer=Ve.idbuffer,Ue.renderEdges=Ve.renderEdges,Ue.useIdBufferSelection=Ve.useIdBufferSelection,t&&(Ue.selectionColor=Ve.selectionColor,this.setSelectionColor(t)),Ve.idbuffer=!0,Ve.renderEdges=!1,_.material.defines.IS_2D="",We(Ve.idbuffer),this.initPostPipeline(!1,!1)},this.exit2DMode=function(){l=null,Ve.idbuffer=Ue.idbuffer,Ve.renderEdges=Ue.renderEdges,Ue.selectionColor&&this.setSelectionColor(Ue.selectionColor),delete _.material.defines.IS_2D,We(Ue.idbuffer),this.initPostPipeline(Ue.sao,Ue.antialias)},this.idAtPixel=function(e,t,r,n){return this.idAtPixels(e,t,1,r,n)},this.idAtPixels=function(t,r,n,i,o){if(o&&o[0]||(o=le),!o[0])return 0;n%2==0&&(n+=1);var a=.5*(t+1)*o[0].width-.5*(n-1),s=.5*(r+1)*o[0].height-.5*(n-1);if(X[n]&&a===X[n][4]&&s===X[n][5]&&X[n][6]==o[0].name)return W(X[n],i),X[n][0];var l=4*n*n;ve[l]||(ve[l]=new Uint8Array(l));var u,c=ve[l];return e.readRenderTargetPixels(o[0],a,s,n,n,c),o[1]&&(ye[l]||(ye[l]=new Uint8Array(l)),u=ye[l],e.readRenderTargetPixels(o[1],a,s,n,n,u)),function(e,t,r,n,i,o,a){var s;a=a||le;var l=0,u=0,c=0,h=-1;X[r]=[-1,-1,null,null,e,t,a[0].name];for(var d=0;d<r*r;d++){var f=l+(r-1)/2,p=u+(r-1)/2;if(f>=0&&f<=r&&p>=0&&p<=r){var m=f+p*r;if(s=(s=n[4*m+2]<<16|n[4*m+1]<<8|n[4*m])<<8>>8,X[r][0]=s,i){var g=i[4*m+1]<<8|i[4*m];X[r][1]=g<<16>>16}if(X[r][2]=2*(e+f)/a[0].width-1,X[r][3]=2*(t+p)/a[0].height-1,-1!==s)break}if(l==u||l<0&&l==-u||l>0&&l==1-u){var v=c;c=-h,h=v}l+=c,u+=h}return W(X[r],o),s}(a,s,n,c,u,i,o)},this.idsAtPixelsBox=function(t,r,n,i,o,a){if((a=a||le)[0]){var s=n*a[0].width,l=i*a[0].height,u=0|.5*(t+1)*a[0].width,c=0|.5*(r+1)*a[0].height,h=new Uint8Array(4*s*l);e.readRenderTargetPixels(a[0],u,c,s,l,h);var d=void 0;o&&a[1]&&(d=new Uint8Array(4*s*l),e.readRenderTargetPixels(a[1],u,c,s,l,d));for(var f={},p=0;p<h.length;p+=4){var m=h[4*p+2]<<16|h[4*p+1]<<8|h[4*p];if((m=m<<8>>8)>0){var g=0;d&&(g=(g=d[4*p+1]<<8|d[4*p])<<16>>16);var v=m+"-"+g;f[v]||(f[v]=!0,o.push([m,g]))}}}},this.readbackTargetId=function(){if(!le[0])return null;var t=new Uint8Array(4*le[0].width*le[0].height);return e.readRenderTargetPixels(le[0],0,0,le[0].width,le[0].height,t),{buffer:t,width:le[0].width,height:le[0].height}},this.rolloverObjectViewport=function(e,t){be[1]=0;var r=this.idAtPixel(e,t,be);return this.rolloverObjectId(r,null,be[1])},this.rolloverObjectId=function(e,t,r){return Ze(e,r,!1)},this.getRollOverDbId=function(){return Oe},this.getRollOverModelId=function(){return Ne},this.rollOverModelId=function(e){return Ze(1,e,!0)},this.setRollOverHighlightColor=function(e){e?_.uniforms.highlightColor.value.copy(e):_.uniforms.highlightColor.value.setRGB(1,1,1)},this.setDbIdForEdgeDetection=function(e,t){_.uniforms.edgeObjIDv4.value.set((255&e)/255,(e>>8&255)/255,(e>>16&255)/255,(e>>24&255)/255),_.uniforms.edgeModelIDv2.value.set((255&t)/255,(t>>8&255)/255)},this.setSpatialFilterForRollOver=function(e){if(!e||this.spatialFilterForRollOverSupported()){var t="SPATIAL_FILTER";_.material.defines[t]!==e&&(e&&""!==e?_.material.defines[t]=e:delete _.material.defines[t],_.material.needsUpdate=!0,_.uniforms.highlightIntensity.value=0,Ie=performance.now())}else a.logger.warn("Spatial filter for mouse-over can only be used with depth target")},this.spatialFilterForRollOverSupported=function(){return Xe(R)},this.setEdgeColor=function(e){Ee.copy(e)},this.setSelectionColor=function(e){var t=new n.Color(e);t.r=Math.pow(t.r,2),t.g=Math.pow(t.g,2),t.b=Math.pow(t.b,2),_.uniforms.selectionColor.value.set(t),_.material.needsUpdate=!0,Ve.selectionColor=e},this.setUnitScale=function(e){pe=e},this.getUnitScale=function(){return pe},this.getBlendPass=function(){return _},this.getClearPass=function(){return d},this.getColorTarget=function(){return Z},this.getIDTargets=function(){return le},this.getDepthTarget=function(){return T},this.getIdTarget=function(){return le[0]},this.getOverlayIdTarget=function(){return ue},this.getDepthMaterial=function(){return t},this.getPostTarget=function(){return $},this.getEdgeMaterial=function(){return r},this.setCrossFade=function(e){Be=e},this.getCrossFade=function(){return Be},this.setOffscreenTarget=function(e){ze=e},this.getOffscreenTarget=function(){return ze},this.getNamedTarget=function(e){switch(e){case"color":return Z;case"overlay":return Q;case"id":return le[0];case"post1":return $;case"post2":return se;case"postdisplay":return ee;case"ssao":return ae;case"depth":return T}return null},this.getCurrentFramebuffer=function(){return e.getCurrentFramebuffer()},this.getConfig=function(){return{renderEdges:Ve.renderEdges,envMapBackground:Ve.envMapBg,envMap:d.material.envMap,envExposure:ce,toneMapExposureBias:he,envRotation:this.getEnvRotation(),tonemapMethod:fe,clearColor:we&&we.clone(),clearColorTop:!we&&d.uniforms.color1.value.clone(),clearColorBottom:!we&&d.uniforms.color2.value.clone(),clearAlpha:Ae,useOverlayAlpha:Se,aoEnabled:this.getAOEnabled(),aoRadius:this.getAORadius(),aoIntensity:this.getAOIntensity(),twoSided:Ve.haveTwoSided,edgeColor:Ee.clone(),unitScale:this.getUnitScale(),is2D:!!_.material.defines.IS_2D,antialias:this.getAntialiasing(),idMaterial:l,selectionColor:Ve.selectionColor}},this.applyConfig=function(e){this.toggleEdges(e.renderEdges),this.toggleEnvMapBackground(e.envMapBackground),this.setCubeMap(e.envMap),this.setEnvExposure(e.envExposure),this.setTonemapExposureBias(e.toneMapExposureBias),this.setEnvRotation(e.envRotation),this.setTonemapMethod(e.tonemapMethod),this.toggleTwoSided(e.twoSided),this.setEdgeColor(e.edgeColor),this.setUnitScale(e.unitScale),e.clearColor?this.setClearColors(e.clearColor):this.setClearColors(e.clearColorTop,e.clearColorBottom),this.setClearAlpha(e.clearAlpha),this.useOverlayAlpha(e.useOverlayAlpha);var t=!!_.material.defines.IS_2D;e.is2D&&!t?this.enter2DMode(e.idMaterial,e.selectionColor):!e.is2D&&t&&(this.setSelectionColor(e.selectionColor),this.exit2DMode());var r=e.aoEnabled!=this.getAOEnabled(),n=e.antialias!=this.getAntialiasing();(r||n)&&this.initPostPipeline(e.aoEnabled,e.antialias)},this.targetToCanvas=function(t){var r=t.width,n=t.height,o=new Uint8Array(r*n*4);e.readRenderTargetPixels(t,0,0,r,n,o);var a=oe.createElement("canvas");a.width=r,a.height=n;var s,l=a.getContext("2d"),u=new Uint8ClampedArray(o);return i.isIE11?(s=l.createImageData(r,n)).data.set(u):s=new ImageData(u,r,n),l.putImageData(s,0,0),l.globalCompositeOperation="copy",l.translate(0,n),l.scale(1,-1),l.drawImage(a,0,0,r,n),l.globalCompositeOperation="source-over",{canvas:a,ctx:l}}}},66199:(e,t,r)=>{"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function o(e,t,r){return t&&i(e.prototype,t),r&&i(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}r.r(t),r.d(t,{RenderContextPostProcessExtension:()=>a,RenderContextPostProcessManager:()=>s});var a=function(){function e(t,r){n(this,e),this.viewer=r,this.renderContext=t,this.postProcPass=null,this.postProcShaded=!1,this.setGlobalManager(r.globalManager)}return o(e,[{key:"load",value:function(){}},{key:"unload",value:function(){this.viewer=null,this.renderContext=null,this.postProcPass=null}},{key:"enable",value:function(){this.setPostProcShaded(!0);var e=this.renderContext.settings;this.renderContext.initPostPipeline(e.sao,e.antialias),this.viewer.impl.fireRenderOptionChanged(),this.viewer.impl.invalidate(!0,!0,!0)}},{key:"disable",value:function(){this.setPostProcShaded(!1),this.viewer.impl.invalidate(!1,!1,!0)}},{key:"shouldRenderAfterOverlays",value:function(){return!1}},{key:"render",value:function(e,t,r,n){var i=void 0===n||n===this.shouldRenderAfterOverlays();return!(!this.isPostProcShaded()||!i)&&(this.postProcPass.render(e,t,r),!0)}},{key:"updateUniformValue",value:function(e,t,r){this.postProcPass.uniforms[e]&&(r?this.postProcPass.uniforms[e].value.copy(t):this.postProcPass.uniforms[e].value=t,this.viewer.impl.invalidate(!1,!1,!0))}},{key:"updateDefineValue",value:function(e,t){this.postProcPass.material.defines[e]!==t&&(null!==t?this.postProcPass.material.defines[e]=t:delete this.postProcPass.material.defines[e],this.setMaterialNeedsUpdate())}},{key:"getUniformValue",value:function(e){return this.postProcPass.uniforms[e].value}},{key:"getDefineValue",value:function(e){return this.postProcPass.material.defines[e]}},{key:"changeResolution",value:function(e,t){this.postProcPass.uniforms.resolution.value.set(e,t)}},{key:"setMaterialNeedsUpdate",value:function(){this.postProcPass.material.needsUpdate=!0,this.viewer.impl.invalidate(!1,!1,!0)}},{key:"postProcessEdgesOn",value:function(){return!1}},{key:"setPostProcShaded",value:function(e){this.postProcShaded=e}},{key:"isPostProcShaded",value:function(){return this.postProcShaded}},{key:"getOrder",value:function(){return 0}}]),e}(),s=function(){function e(){n(this,e),this.rcExtensions=[]}return o(e,[{key:"registerPostProcessingExtension",value:function(e){this.rcExtensions.push(e),this.rcExtensions.sort((function(e,t){return t.getOrder()-e.getOrder()}))}},{key:"removePostProcessingExtension",value:function(e){var t=this.rcExtensions.indexOf(e);-1!==t&&(e.unload(),this.rcExtensions.splice(t,1))}},{key:"render",value:function(e,t,r,n,i){for(var o=0;o<this.rcExtensions.length;o++){if(this.rcExtensions[o].render(e,t,r,i)){r=t;var a=t;t=n,n=a}}return r}},{key:"updateUniformValue",value:function(e,t,r){for(var n=0;n<this.rcExtensions.length;n++)this.rcExtensions[n].updateUniformValue(e,t,r)}},{key:"changeResolution",value:function(e,t){for(var r=0;r<this.rcExtensions.length;r++)this.rcExtensions[r].changeResolution(e,t)}},{key:"setMaterialNeedsUpdate",value:function(){for(var e=0;e<this.rcExtensions.length;e++)this.rcExtensions[e].setMaterialNeedsUpdate()}},{key:"postProcessEdgesOn",value:function(){return this.rcExtensions.some((function(e){return e.postProcessEdgesOn()}))}},{key:"isPostProcShaded",value:function(){return this.rcExtensions.some((function(e){return e.isPostProcShaded()}))}}]),e}()},97339:(e,t,r)=>{"use strict";r.r(t),r.d(t,{SAOShader:()=>u});var n=r(23909),i=r(12990),o=r(66209),a=r.n(o),s=r(6890),l=r.n(s),u={uniforms:n.UniformsUtils.merge([i.ShaderChunks.DepthTextureUniforms,{size:{type:"v2",value:new n.Vector2(512,512)},resolution:{type:"v2",value:new n.Vector2(1/512,1/512)},cameraNear:{type:"f",value:1},cameraFar:{type:"f",value:100},radius:{type:"f",value:12},bias:{type:"f",value:.1},projScale:{type:"f",value:500},intensity:{type:"f",value:1},tDepth_mip1:{type:"t",value:null},tDepth_mip2:{type:"t",value:null},tDepth_mip3:{type:"t",value:null},tDepth_mip4:{type:"t",value:null},tDepth_mip5:{type:"t",value:null}}]),vertexShader:a(),fragmentShader:l()}},12990:(e,t,r)=>{"use strict";r.r(t),r.d(t,{CutPlanesUniforms:()=>ve,IdUniforms:()=>ye,ThemingUniform:()=>be,ShadowMapCommonUniforms:()=>xe,ShadowMapUniforms:()=>_e,PointSizeUniforms:()=>Ee,WideLinesUniforms:()=>we,DepthTextureUniforms:()=>Ae,DepthTextureTestUniforms:()=>Se,resolve:()=>De,PackDepthShaderChunk:()=>Le,TonemapShaderChunk:()=>Re,OrderedDitheringShaderChunk:()=>Ie,CutPlanesShaderChunk:()=>Oe,PackNormalsShaderChunk:()=>Ne,HatchPatternShaderChunk:()=>ke,EnvSamplingShaderChunk:()=>Fe,IdVertexDeclaration:()=>Ve,IdVertexShaderChunk:()=>Ue,IdFragmentDeclaration:()=>Be,IdOutputShaderChunk:()=>ze,FinalOutputShaderChunk:()=>Ge,ThemingFragmentDeclaration:()=>He,ThemingFragmentShaderChunk:()=>We,InstancingVertexDeclaration:()=>je,ShadowMapDeclareCommonUniforms:()=>qe,ShadowMapVertexDeclaration:()=>Xe,ShadowMapVertexShaderChunk:()=>Ye,ShadowMapFragmentDeclaration:()=>Ke,PointSizeDeclaration:()=>Ze,PointSizeShaderChunk:()=>Qe,ShaderChunks:()=>Je});var n=r(23909),i=r(23300),o=r.n(i),a=r(25334),s=r.n(a),l=r(73985),u=r.n(l),c=r(52035),h=r.n(c),d=r(32263),f=r.n(d),p=r(15931),m=r.n(p),g=r(52698),v=r.n(g),y=r(7246),b=r.n(y),x=r(7959),_=r.n(x),E=r(61539),w=r.n(E),A=r(74610),S=r.n(A),M=r(46223),T=r.n(M),C=r(53833),P=r.n(C),D=r(94005),L=r.n(D),R=r(25759),I=r.n(R),O=r(58121),N=r.n(O),k=r(4949),F=r.n(k),V=r(11458),U=r.n(V),B=r(36238),z=r.n(B),G=r(65080),H=r.n(G),W=r(72448),j=r.n(W),q=r(81456),X=r.n(q),Y=r(65355),K=r.n(Y),Z=r(58998),Q=r.n(Z),J=r(72438),$=r.n(J),ee=r(14227),te=r.n(ee),re=r(16006),ne=r.n(re),ie=r(26649),oe=r.n(ie),ae=r(13458),se=r.n(ae),le=r(16017),ue=r.n(le),ce=r(68643),he=r.n(ce),de=r(21600),fe=r.n(de);function pe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function me(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?pe(Object(r),!0).forEach((function(t){ge(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):pe(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function ge(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var ve={cutplanes:{type:"v4v",value:[]},hatchParams:{type:"v2",value:new n.Vector2(1,10)},hatchTintColor:{type:"c",value:new n.Color(16777215)},hatchTintIntensity:{type:"f",value:1}},ye={dbId:{type:"v3",value:new n.Vector3(0,0,0)},modelId:{type:"v3",value:new n.Vector3(0,0,0)}},be={themingColor:{type:"v4",value:new n.Vector4(0,0,0,0)}},xe={shadowESMConstant:{type:"f",value:0}},_e=n.UniformsUtils.merge([{shadowMap:{type:"t",value:null},shadowMapSize:{type:"v2",value:new n.Vector2(0,0)},shadowBias:{type:"f",value:0},shadowDarkness:{type:"f",value:0},shadowMatrix:{type:"m4",value:new n.Matrix4},shadowLightDir:{type:"v3",value:new n.Vector3}},xe]),Ee={point_size:{type:"f",value:1}},we={view_size:{type:"v2",value:new n.Vector2(640,480)}},Ae={tDepth:{type:"t",value:null},projInfo:{type:"v4",value:new n.Vector4},isOrtho:{type:"f",value:0},worldMatrix_mainPass:{type:"m4",value:new n.Matrix4}},Se={tDepthTest:{type:"t",value:null},tDepthResolution:{type:"v2",value:new n.Vector2(1/1024,1/1024)}},Me={};for(var Te in n.ShaderChunk)Me[Te]=n.ShaderChunk[Te];Me.pack_depth=o(),Me.depth_texture=s(),Me.tonemap=u(),Me.ordered_dither=h(),Me.cutplanes=f(),Me.pack_normals=m(),Me.hatch_pattern=v(),Me.env_sample=b(),Me.id_decl_vert=_(),Me.id_vert=w(),Me.id_decl_frag=S(),Me.id_frag=T(),Me.final_frag=P(),Me.theming_decl_frag=L(),Me.theming_frag=I(),Me.instancing_decl_vert=N(),Me.shadowmap_decl_common=F(),Me.shadowmap_decl_vert=U(),Me.shadowmap_vert=z(),Me.shadowmap_decl_frag=H(),Me.float3_average=j(),Me.line_decl_common=X(),Me.prism_wood=K(),Me.prism_glazing=Q(),Me.prism_transparency=$(),Me.normal_map=te(),Me.decl_point_size=ne(),Me.point_size=oe(),Me.wide_lines_decl=se(),Me.wide_lines_vert=ue(),Me.hsv=he(),Me.importance_sampling=fe();var Ce={},Pe={};for(Te in Ce)Pe[Te]=new RegExp("#"+Te+" *<([\\w\\d., ]*)>","g");var De=function e(t){for(var r in Ce){var n=Pe[r];t=t.replace(n,(function(e,t){var n=t.split(",").map((function(e){return e.trim()}));return Ce[r].apply(null,n)}))}return t.replace(/#include *<([\w\d.]+)>/g,(function(t,r){if(!Me[r])throw new Error("Cannot resolve #include<"+r+">");return e(Me[r])}))},Le=Me.pack_depth,Re=Me.tonemap,Ie=Me.ordered_dither,Oe=Me.cutplanes,Ne=Me.pack_normals,ke=Me.hatch_pattern,Fe=Me.env_sample,Ve=Me.id_decl_vert,Ue=Me.id_vert,Be=Me.id_decl_frag,ze=Me.id_frag,Ge=Me.final_frag,He=Me.theming_decl_frag,We=Me.theming_frag,je=Me.instancing_decl_vert,qe=Me.shadowmap_decl_common,Xe=Me.shadowmap_decl_vert,Ye=Me.shadowmap_vert,Ke=Me.shadowmap_decl_frag,Ze=Me.decl_point_size,Qe=Me.point_size,Je=me(me({IdUniforms:ye,ThemingUniform:be,CutPlanesUniforms:ve,ShadowMapCommonUniforms:xe,ShadowMapUniforms:_e,PointSizeUniforms:Ee,WideLinesUniforms:we,DepthTextureUniforms:Ae,DepthTextureTestUniforms:Se,PackDepthShaderChunk:Le,TonemapShaderChunk:Re,OrderedDitheringShaderChunk:Ie,CutPlanesShaderChunk:Oe,PackNormalsShaderChunk:Ne,HatchPatternShaderChunk:ke,EnvSamplingShaderChunk:Fe,IdVertexDeclaration:Ve,IdVertexShaderChunk:Ue,IdFragmentDeclaration:Be,IdOutputShaderChunk:ze,FinalOutputShaderChunk:Ge,ThemingFragmentDeclaration:He,ThemingFragmentShaderChunk:We,InstancingVertexDeclaration:je,ShadowMapDeclareCommonUniforms:qe,ShadowMapVertexDeclaration:Xe,ShadowMapVertexShaderChunk:Ye,ShadowMapFragmentDeclaration:Ke,PointSizeDeclaration:Ze,PointSizeShaderChunk:Qe},Me),{},{resolve:De})},85994:(e,t,r)=>{"use strict";r.r(t),r.d(t,{ShaderPass:()=>o});var n=r(14705),i=r(23909),o=function(e,t){this.textureID=void 0!==t?t:"tDiffuse",this.material=(0,n.createShaderMaterial)(e),this.uniforms=this.material.uniforms,this.renderToScreen=!1,this.enabled=!0,this.clear=!1,this.camera=new i.OrthographicCamera(-1,1,1,-1,0,1),this.camera.disableXr=!0;var r=new i.BufferGeometry,o=new Float32Array(9);o[0]=-1,o[1]=-1,o[2]=0,o[3]=3,o[4]=-1,o[5]=0,o[6]=-1,o[7]=3,o[8]=0;var a=new Float32Array(6);a[0]=0,a[1]=0,a[2]=2,a[3]=0,a[4]=0,a[5]=2;var s=new Float32Array(9);s[0]=0,s[1]=0,s[2]=1,s[3]=0,s[4]=0,s[5]=1,s[6]=0,s[7]=0,s[8]=1,r.setAttribute("position",new i.BufferAttribute(o,3)),r.setAttribute("normal",new i.BufferAttribute(s,3)),r.setAttribute("uv",new i.BufferAttribute(a,2)),this.quad=new i.Mesh(r,this.material),this.scene=new i.Scene,this.scene.add(this.quad)};o.prototype={render:function(e,t,r,n){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=r),e.setRenderTarget(t),!this.renderToScreen&&this.clear&&e.clear(),e.render(this.scene,this.camera)}}},14705:(e,t,r)=>{"use strict";r.r(t),r.d(t,{cloneShader:()=>i,createShaderMaterial:()=>o,setMacro:()=>a,removeMacro:()=>s,ShaderUtils:()=>l});var n=r(23909),i=function(e){var t={vertexShader:e.vertexShader,fragmentShader:e.fragmentShader};return e.uniforms&&(t.uniforms=n.UniformsUtils.clone(e.uniforms)),e.defines&&(t.defines=Object.assign({},e.defines)),e.extensions&&(t.extensions=Object.assign({},e.extensions)),t},o=function(e){var t=i(e);return e.attributes&&(t.attributes=e.attributes),new n.ShaderMaterial(t)},a=function(e,t,r){r=r||"",e.defines||(e.defines={}),e.defines[t]!=r&&(e.defines[t]=r,e.needsUpdate=!0)},s=function(e,t){(e.defines||e.defines[t])&&(delete e.defines[t],e.needsUpdate=!0)},l={cloneShader:i,createShaderMaterial:o,setMacro:a,removeMacro:s}},57658:(e,t,r)=>{"use strict";r.r(t),r.d(t,{ShadowMapShader:()=>y,GroundShadowShader:()=>b,ShadowMapOverrideMaterials:()=>x,ShadowConfig:()=>_,SHADOWMAP_NEEDS_UPDATE:()=>E,SHADOWMAP_INCOMPLETE:()=>w,SHADOWMAP_VALID:()=>A,ShadowMaps:()=>T,ShadowRender:()=>C});var n=r(12990),i=r(14705),o=r(90564),a=r(83359),s=r(95708),l=r(2727),u=r(23909),c=r(47065),h=r.n(c),d=r(18214),f=r.n(d),p=r(2680),m=r.n(p),g=r(83159),v=r.n(g),y={uniforms:u.UniformsUtils.merge([n.ShaderChunks.ShadowMapCommonUniforms,{shadowMapRangeMin:{type:"f",value:0},shadowMapRangeSize:{type:"f",value:0},shadowMinOpacity:{type:"f",value:0},map:{type:"t",value:null},alphaMap:{type:"t",value:null},texMatrix:{type:"m3",value:new u.Matrix3},texMatrixAlpha:{type:"m3",value:new u.Matrix3}},(0,o.GetPrismMapUniforms)("surface_cutout_map")]),vertexShader:h(),fragmentShader:f()},b={uniforms:n.ShaderChunks.ShadowMapUniforms,vertexShader:m(),fragmentShader:v()};function x(){var e=[],t=(0,i.createShaderMaterial)(y),r=new u.Material;r.visible=!1;var n=[];var o=new function(){this.init=function(){this.isPrism=!1,this.alphaMap=!1,this.alphaClampS=!1,this.alphaClampT=!1,this.alphaInvert=!1,this.rgbaMap=!1,this.rgbaClampS=!1,this.rgbaClampT=!1,this.rgbaInvert=!1,this.instanced=!1,this.decalIndex=-1},this.init(),this.getMaterialIndex=function(){return(this.isPrism?1:0)|(this.alphaMap?2:0)|(this.alphaClampS?4:0)|(this.alphaClampT?8:0)|(this.alphaInvert?16:0)|(this.rgbaMap?32:0)|(this.rgbaClampS?64:0)|(this.rgbaClampT?128:0)|(this.rgbaInvert?256:0)|(this.instanced?512:0)|1024*(this.decalIndex+1)}};function a(n,a){if((s=n)instanceof u.MeshPhongMaterial?s.opacity<_.ShadowMinOpacity:s.isPrismMaterial?"PrismTransparent"===s.prismType||"PrismGlazing"===s.prismType:!s.visible)return r;var s,l=n instanceof u.MeshPhongMaterial,c=n.isPrismMaterial;if(!l&&!c)return null;var h=l?n.alphaMap:n.surface_cutout_map,d=l&&n.alphaTest?n.map:null;if(!h&&!d&&!n.useInstancing)return null;var f=o;f.init(),f.isPrism=c,f.alphaMap=!!h,f.rgbaMap=!!d,f.instanced=n.useInstancing,f.decalIndex=void 0===a?-1:a,h&&(f.alphaClampS=h.clampS,f.alphaClampT=h.clampT,f.alphaInvert=h.invert),d&&(f.rgbaClampS=d.clampS,f.rgbaClampT=d.clampT,f.rgbaInvert=d.invert);var p=function(r,n){var o,a,s,l,u,c=r.getMaterialIndex();if(!e[c]){var h=t.clone();r.isPrism&&r.alphaMap&&((0,i.setMacro)(h,"USE_SURFACE_CUTOUT_MAP"),h.fragmentShader=(o="surface_cutout",a=r.alphaClampS,s=r.alphaClampT,l="uv_"+o+"_map",u="",a&&s?u="if ("+l+".x < 0.0 || "+l+".x > 1.0 || "+l+".y < 0.0 || "+l+".y > 1.0) { discard; }":a?u="if ("+l+".x < 0.0 || "+l+".x > 1.0) { discard; }":s&&(u="if ("+l+".y < 0.0 || "+l+".y > 1.0) { discard; }"),"#define "+o.toUpperCase()+"_CLAMP_TEST "+u+"\n"+h.fragmentShader)),r.instanced&&(h.useInstancing=!0),e[c]=h}return e[c]}(f);return h&&(l?(p.uniforms.alphaMap.value=h,p.uniforms.texMatrixAlpha.value=h.matrix,p.alphaMap=h,p.side=n.side):(p.uniforms.surface_cutout_map.value=h,p.uniforms.surface_cutout_map_texMatrix.value.copy(h.matrix),p.uniforms.surface_cutout_map_invert.value=h.invert,p.side=u.DoubleSide)),d&&(p.uniforms.map.value=d,p.uniforms.texMatrix.value=d.matrix,p.map=d),p}this.forEachMaterial=function(r){for(var n=0;n<e.length;n++){var i=e[n];i&&r(i)}r(t)},this.getCustomOverrideMaterial=function(e){var t=a(e);if(!t)return null;if(!e.decals)return t.decals=null,t;if(e.decals){n.length=0;for(var r=0;r<e.decals.length;r++){var i=e.decals[r],o=a(i.material,r);if(!o)return null;n.push({uv:i.uv,material:o})}}return t.decals=n,t},this.dispose=function(){this.forEachMaterial((function(e){e.dispose()}))}}var _={ShadowMapSize:1024,ShadowESMConstant:80,ShadowBias:.001,ShadowDarkness:.7,ShadowMapBlurRadius:4,ShadowMinOpacity:.9,UseHardShadows:!1,BlurShadowMap:!0},E=0,w=1,A=2;function S(){this.shadowMap=void 0,this.shadowMapSize=void 0,this.shadowMatrix=void 0,this.shadowLightDir=void 0,this.init=function(e){this.shadowMap=e,this.shadowMapSize=new u.Vector2(e.width,e.height),this.shadowMatrix=new u.Matrix4,this.shadowLightDir=new u.Vector3},this.apply=function(e){e.shadowMap=this.shadowMap,e.shadowMatrix=this.shadowMatrix,e.shadowLightDir=this.shadowLightDir,this.shadowMap?((0,i.setMacro)(e,"USE_SHADOWMAP"),_.UseHardShadows&&(0,i.setMacro)(e,"USE_HARD_SHADOWS")):((0,i.removeMacro)(e,"USE_SHADOWMAP"),(0,i.removeMacro)(e,"USE_HARD_SHADOWS"))}}var M=new S;function T(e){var t=null,r=null,n=new u.OrthographicCamera,o=Math.exp(_.ShadowESMConstant),c=_.UseHardShadows?new u.Color(1,1,1):new u.Color(o,1,1),h=e,d=null,f=null,p=null,m=(0,i.createShaderMaterial)(y),g=new x;m.getCustomOverrideMaterial=g.getCustomOverrideMaterial;var v=null;function T(e,t){e.forEach((function(e){t.apply(e)}))}function C(e){var t=new u.WebGLRenderTarget(e,e,{minFilter:u.LinearFilter,magFilter:u.LinearFilter,format:u.RGBAFormat,type:u.FloatType,stencilBuffer:!1,generateMipmaps:!1});return t.texture.generateMipmaps=!1,t}function P(e){h.setRenderTarget(e),h.setClearColor(c,1),h.clear()}var D,L,R,I,O,N,k,F,V,U,B,z=(D=new u.Matrix4,L=new u.Matrix4,R=new u.Vector3(0,0,0),I=new u.Box3,O=new u.Vector3,N=new u.Vector3,function(e,t,r){e.position.copy(r),e.lookAt(R),D.makeRotationFromQuaternion(e.quaternion),L.copy(D).invert(),I.copy(t).applyMatrix4(L),N=I.getCenter(N),O.set(N.x,N.y,I.max.z),O.applyMatrix4(D),e.position.copy(O),N=I.size(N),e.left=-.5*N.x,e.right=.5*N.x,e.bottom=-.5*N.y,e.top=.5*N.y,e.near=0,e.far=N.z,e.updateMatrixWorld(),e.updateProjectionMatrix()});function G(e){e.uniforms.shadowMapRangeMin.value=n.near,e.uniforms.shadowMapRangeSize.value=n.far-n.near,e.uniforms.shadowESMConstant.value=_.ShadowESMConstant,e.uniforms.shadowMinOpacity.value=_.ShadowMinOpacity}this.init=function(){(t=new S).init(C(_.ShadowMapSize)),r=_.BlurShadowMap?new s.D(_.ShadowMapSize,_.ShadowMapSize,_.ShadowMapBlurRadius,1,{type:t.shadowMap.type,format:t.shadowMap.format}):void 0,(d=(0,i.createShaderMaterial)(b)).depthWrite=!1,d.transparent=!0,f=(0,a.createGroundShape)(d),(p=new u.Scene).add(f),this.groundShapeBox=new u.Box3,P(v=C(1))},this.init(),this.state=E,this.startUpdate=function(e,t,r,i,o){var a=e.getVisibleBounds(!0);return this.beginShadowMapUpdate(r,a,i),e.reset(n,l.RenderFlags.RENDER_SHADOWMAP,!0),this.state=w,t=this.continueUpdate(e,t,o)},this.continueUpdate=function(e,r,n){return r=e.renderSome(this.renderSceneIntoShadowMap,r),e.isDone()?(this.state=A,this.finishShadowMapUpdate(n)):function(e){var r=t.shadowMap;t.shadowMap=v,T(e,t),t.apply(d),t.shadowMap=r}(n),r},this.beginShadowMapUpdate=function(e,r,o){z(n,r,o),G(m),g.forEachMaterial(G),_.UseHardShadows&&((0,i.setMacro)(m,"USE_HARD_SHADOWS"),g.forEachMaterial((function(e){(0,i.setMacro)(e,"USE_HARD_SHADOWS")}))),P(t.shadowMap),this.renderSceneIntoShadowMap(p)},this.renderSceneIntoShadowMap=function(e){e.overrideMaterial=m,h.render(e,n,t.shadowMap),e.overrideMaterial=null},this.finishShadowMapUpdate=function(e){r&&!_.UseHardShadows&&r.render(h,t.shadowMap,t.shadowMap),t.shadowMatrix.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),t.shadowMapRangeMin=n.near,t.shadowMapRangeSize=n.far-n.near,t.shadowLightDir.copy(n.position).normalize(),T(e,t),t.apply(d),this.isValid=!0},this.cleanup=function(e){r&&r.cleanup(),t.shadowMap&&t.shadowMap.dispose(),T(e,M),m.dispose(),g.dispose(),d.dispose(),f.geometry.dispose()},this.setGroundShadowTransform=function(e,t,r,n){(0,a.setGroundShapeTransform)(f,e,t,r,n),this.groundShapeBox.setFromObject(f)},this.renderGroundShadow=function(e,t){h.render(p,e,t,!1)},this.expandByGroundShadow=(k=new u.Plane,F=new u.Ray,V=new u.Vector3,U=new u.Vector3,B=new u.Box3,function(e,t){k.normal.set(0,1,0),k.constant=-e.min.y,F.direction.copy(t).negate().normalize();var r,n,i,o=e.getCenter(V),a=100*o.distanceToSquared(e.min)*100;B.makeEmpty();for(var s=0;s<8;s++){F.origin=(r=e,n=s,i=void 0,(i=new u.Vector3).x=1&n?r.max.x:r.min.x,i.y=2&n?r.max.y:r.min.y,i.z=4&n?r.max.z:r.min.z,i);var l=F.intersectPlane(k,U);l&&(l.distanceToSquared(o)>=a||B.expandByPoint(l))}e.union(B)}),this.getShadowParams=function(){return t},this.getShadowCamera=function(){return n}}var C=function(){};C.RefreshUniformsShadow=function(e,t){e.shadowMap&&(e.shadowMap.value=t.shadowMap),e.shadowMatrix&&(e.shadowMatrix.value=t.shadowMatrix),e.shadowLightDir&&(e.shadowLightDir.value=t.shadowLightDir),e.shadowESMConstant&&(e.shadowESMConstant.value=_.ShadowESMConstant),e.shadowBias&&(e.shadowBias.value=_.ShadowBias),e.shadowMapSize&&(e.shadowMapSize.value=_.ShadowMapSize),e.shadowDarkness&&(e.shadowDarkness.value=_.ShadowDarkness)}},98603:(e,t,r)=>{"use strict";r.d(t,{Z:()=>l});var n=r(70057),i=r.n(n),o=r(70125),a=r.n(o);function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var l=function(){function e(t,r,n,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.viewerImpl=t,this.renderContext=r,this.glRenderer=n,this.materialManager=i,this.materialName="__material_2Don3D__",this.tmpVec=new THREE.Vector3,this.tmpBox=new THREE.Box3}var t,r,n;return t=e,r=[{key:"createContext",value:function(){this.sheetContext=new Autodesk.Viewing.Private.RenderContext,this.sheetContext.init(this.glRenderer,this.renderContext.settings.logicalWidth,this.renderContext.settings.logicalHeight,{offscreen:!0});var e=this.renderContext.getConfig();e.antialias=!1,e.renderEdges=!1,e.clearAlpha=0,e.clearColor?e.clearColor.set(1,1,1):(e.clearColorBottom.set(1,1,1),e.clearColorTop.set(1,1,1)),this.sheetContext.applyConfig(e),this.prototypeScene=new THREE.Scene}},{key:"setSize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.renderContext;this.sheetContext&&(this.sheetContext.setSize(e.settings.logicalWidth,e.settings.logicalHeight),this.updateMaterial())}},{key:"createScene",value:function(){this.setSize(),this.scene=new THREE.Scene,this.planeGeometry=new THREE.PlaneBufferGeometry(1,1),this.material=new THREE.ShaderMaterial({uniforms:{sheetMap:{type:"t",value:this.sheetContext.getColorTarget()},idMap:{type:"t",value:this.sheetContext.getIDTargets()[0]},modelIDv2:{type:"v3",value:new THREE.Vector3},resolution:{type:"v2",value:new THREE.Vector2},alphaTest:{type:"f",value:0}},vertexShader:i(),fragmentShader:a(),side:THREE.DoubleSide,transparent:!0}),this.scene.skipDepthTarget=!0,this.updateMaterial(),this.materialManager.addMaterialNonHDR(this.materialName,this.material),this.mesh=new THREE.Mesh(this.planeGeometry,this.material),this.mesh.matrixAutoUpdate=!1,this.scene.add(this.mesh)}},{key:"updateMaterial",value:function(){if(this.material){var e=this.sheetContext.getColorTarget();this.material.uniforms.sheetMap.value=e,this.material.uniforms.idMap.value=this.sheetContext.getIDTargets()[0],this.material.uniforms.resolution.value.set(1/(e.width||1),1/(e.height||1))}}},{key:"renderScenePart",value:function(e,t,r,n){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.renderContext;if(e.frags&&e.frags.is2d){this.sheetContext||this.createContext(),this.scene||this.createScene(),this.material.uniforms.alphaTest.value=!e.needsTwoPasses||e.isSecondPass?0:.9;var o=e.modelId,a=this.viewerImpl.modelQueue().findModel(o),s=this.tmpBox.copy(a.getBoundingBox(!0)),l=a.getViewportBounds();l&&s.intersect(l);var u=a.getModelToViewerTransform();this.material.uniforms.modelIDv2.value.set((255&o)/255,(o>>8&255)/255,(o>>16&255)/255),i.getAOEnabled()!==this.sheetContext.getAOEnabled()&&this.sheetContext.initPostPipeline(i.getAOEnabled(),!1),n=n&&a.areAllVisible(),r=!1;var c=this.lastRenderedModel===a&&e.isSecondPass;c||(this.sheetContext.beginScene(this.prototypeScene,this.viewerImpl.camera,this.viewerImpl.noLights,!0),this.sheetContext.renderScenePart(e,t,r,n,!1),this.sheetContext.presentBuffer());var h=s.getSize(new THREE.Vector3);this.mesh.matrix.makeScale(h.x,h.y,1),s.getCenter(this.tmpVec),this.mesh.matrix.setPosition(this.tmpVec),u&&this.mesh.matrix.multiplyMatrices(u,this.mesh.matrix),this.mesh.matrixWorld.copy(this.mesh.matrix),this.scene.modelId=o,i.renderScenePart(this.scene,t,r,n),this.lastRenderedModel=a}}},{key:"destroy",value:function(){this.material&&(this.material.dispose(),this.materialManager.removeNonHDRMaterial(this.materialName),this.material=null),this.planeGeometry&&(this.planeGeometry.dispose(),this.planeGeometry=null),this.sheetContext&&(this.sheetContext.cleanup(),this.context=null),this.renderContext=null,this.glRenderer=null}}],r&&s(t.prototype,r),n&&s(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}()},68693:(e,t,r)=>{"use strict";r.r(t),r.d(t,{WebGLProgram:()=>g});var n=r(74007),i=r(12990),o=r(23909),a=r(84998);function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(Object(r),!0).forEach((function(t){u(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function u(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var c,h,d,f="#version 300 es\n    #define _LMVWEBGL2_\n    #define texture2D texture\n    #define textureCube texture\n    #define attribute in\n    #define varying out\n",p="#version 300 es\n    #define _LMVWEBGL2_\n    #define texture2D texture\n    #define textureCube texture\n    #define textureCubeLodEXT textureLod\n    #define gl_FragColor outFragColor\n    #define varying in\n",m="\n    #define gl_FragDepth gl_FragDepthEXT\n    #extension GL_OES_standard_derivatives : enable\n",g=(c=0,h=function(e){return""!==e},d=function(e,t,r,n,i){var o=n?"1.0-":"",a="texture2D("+e+", (UV))",s="";return i=i||"vec4(0.0)",t&&r?s="((UV).x < 0.0 || (UV).x > 1.0 || (UV).y < 0.0 || (UV).y > 1.0) ? "+i+" : ":t?s="((UV).x < 0.0 || (UV).x > 1.0) ? "+i+" : ":r&&(s="((UV).y < 0.0 || (UV).y > 1.0) ? "+i+" : "),"#define GET_"+e.toUpperCase()+"(UV) ("+s+o+a+")"},function(e,t,r,s,u){var g,v=e,y=v.context,b=v.capabilities.isWebGL2,x=r.defines,_=r.__webglShader.uniforms;g=l(l({},r.attributes),u.attributes);var E=(0,i.resolve)(s.vertexShader),w=(0,i.resolve)(s.fragmentShader),A=r.index0AttributeName;void 0===A&&!0===s.morphTargets&&(A="position");var S,M,T="ENVMAP_MODE_REFLECTION",C=e.gammaFactor>0?e.gammaFactor:1,P=function(e){var t,r,n=[];for(var i in e)!1!==(t=e[i])&&(r="#define "+i+" "+t,n.push(r));return n.join("\n")}(x),D=y.createProgram();r instanceof o.RawShaderMaterial?((S=[b?f:"",P].filter(h).join("\n")).length>0&&(S+="\n"),(M=[b?p:m,"precision "+s.precisionFragment+" float;",P,b?"out vec4 outFragColor;":""].filter(h).join("\n")).length>0&&(M+="\n")):(S=[b?f:"","precision "+s.precision+" float;","precision "+s.precision+" int;",P,s.vertexPrefix,s.supportsVertexTextures?"#define VERTEX_TEXTURES":"",v.gammaInput?"#define GAMMA_INPUT":"",v.gammaOutput?"#define GAMMA_OUTPUT":"","#define GAMMA_FACTOR "+C,s.mrtNormals?"#define MRT_NORMALS":"",s.mrtIdBuffer?"#define MRT_ID_BUFFER":"","#define MAX_DIR_LIGHTS "+s.maxDirLights,"#define MAX_POINT_LIGHTS "+s.maxPointLights,"#define MAX_SPOT_LIGHTS "+s.maxSpotLights,"#define MAX_HEMI_LIGHTS "+s.maxHemiLights,"#define MAX_BONES "+s.maxBones,"#define NUM_CUTPLANES "+s.numCutplanes,s.loadingAnimationDuration>0?"#define LOADING_ANIMATION":"",s.map?"#define USE_MAP":"",s.envMap?"#define USE_ENVMAP":"",s.envMap?"#define "+T:"",s.irradianceMap?"#define USE_IRRADIANCEMAP":"",s.lightMap?"#define USE_LIGHTMAP":"",s.bumpMap?"#define USE_BUMPMAP":"",s.normalMap?"#define USE_NORMALMAP":"",s.specularMap?"#define USE_SPECULARMAP":"",s.alphaMap?"#define USE_ALPHAMAP":"",s.vertexColors?"#define USE_COLOR":"",s.vertexIds?"#define USE_VERTEX_ID":"",s.useTiling?"#define USE_TILING":"",s.useInstancing?"#define USE_INSTANCING":"",s.wideLines?"#define WIDE_LINES":"",s.skinning?"#define USE_SKINNING":"",s.useVertexTexture?"#define BONE_TEXTURE":"",s.morphTargets?"#define USE_MORPHTARGETS":"",s.morphNormals?"#define USE_MORPHNORMALS":"",s.wrapAround?"#define WRAP_AROUND":"",s.doubleSided?"#define DOUBLE_SIDED":"",s.flipSided?"#define FLIP_SIDED":"",s.sizeAttenuation?"#define USE_SIZEATTENUATION":"",s.packedNormals?"#define UNPACK_NORMALS":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","attribute vec3 position;","#ifdef UNPACK_NORMALS","attribute vec2 normal;","#else","attribute vec3 normal;","#endif","attribute vec2 uv;","attribute vec2 uv2;","#ifdef USE_COLOR","   attribute vec3 color;","#endif",""].join("\n"),M=[b?p:m,b||!s.bumpMap&&!s.normalMap?"":"#extension GL_OES_standard_derivatives : enable",b||!s.mrtIdBuffer&&!s.mrtNormals||a.isIE11?"":"#extension GL_EXT_draw_buffers : enable",!b&&s.mrtIdBuffer?"#define gl_FragColor gl_FragData[0]":"",s.haveTextureLod?"#define HAVE_TEXTURE_LOD":"",P,s.fragmentPrefix,"#define MAX_DIR_LIGHTS "+s.maxDirLights,"#define MAX_POINT_LIGHTS "+s.maxPointLights,"#define MAX_SPOT_LIGHTS "+s.maxSpotLights,"#define MAX_HEMI_LIGHTS "+s.maxHemiLights,"#define NUM_CUTPLANES "+s.numCutplanes,s.loadingAnimationDuration>0?"#define LOADING_ANIMATION":"",s.alphaTest?"#define ALPHATEST "+s.alphaTest:"",v.gammaInput?"#define GAMMA_INPUT":"",v.gammaOutput?"#define GAMMA_OUTPUT":"","#define GAMMA_FACTOR "+C,s.mrtNormals?"#define MRT_NORMALS":"",s.mrtIdBuffer?"#define MRT_ID_BUFFER":"",s.mrtIdBuffer>1?"#define MODEL_COLOR":"","#define TONEMAP_OUTPUT "+(s.tonemapOutput||0),s.useBackgroundTexture?"#define USE_BACKGROUND_TEXTURE":"",s.useFog&&s.fog?"#define USE_FOG":"",s.useFog&&s.fogExp?"#define FOG_EXP2":"",s.map?"#define USE_MAP":"",s.envMap?"#define USE_ENVMAP":"",s.envMap?"#define ENVMAP_TYPE_CUBE":"",s.envMap?"#define "+T:"",s.envMap?"#define ENVMAP_BLENDING_MULTIPLY":"",s.irradianceMap?"#define USE_IRRADIANCEMAP":"",s.envGammaEncoded?"#define ENV_GAMMA":"",s.irrGammaEncoded?"#define IRR_GAMMA":"",s.envRGBM?"#define ENV_RGBM":"",s.irrRGBM?"#define IRR_RGBM":"",s.lightMap?"#define USE_LIGHTMAP":"",s.bumpMap?"#define USE_BUMPMAP":"",s.normalMap?"#define USE_NORMALMAP":"",s.specularMap?"#define USE_SPECULARMAP":"",s.alphaMap?"#define USE_ALPHAMAP":"",s.vertexColors?"#define USE_COLOR":"",s.vertexIds?"#define USE_VERTEX_ID":"",s.metal?"#define METAL":"",s.clearcoat?"#define CLEARCOAT":"",s.wrapAround?"#define WRAP_AROUND":"",s.doubleSided?"#define DOUBLE_SIDED":"",s.flipSided?"#define FLIP_SIDED":"",s.hatchPattern?"#define HATCH_PATTERN":"",s.mapInvert?"#define MAP_INVERT":"",s.useTiling?"#define USE_TILING":"",s.useTiling?"#define TILE_RANGE_X_MIN "+s.tilingRepeatRange[0]:"",s.useTiling?"#define TILE_RANGE_Y_MIN "+s.tilingRepeatRange[1]:"",s.useTiling?"#define TILE_RANGE_X_MAX "+s.tilingRepeatRange[2]:"",s.useTiling?"#define TILE_RANGE_Y_MAX "+s.tilingRepeatRange[3]:"",s.hasRoundCorner?"#define USE_TILING_NORMAL":"",s.useRandomOffset?"#define USE_TILING_RANDOM":"",d("map",s.mapClampS,s.mapClampT),d("bumpMap",s.bumpMapClampS,s.bumpMapClampT),d("normalMap",s.normalMapClampS,s.normalMapClampT),d("specularMap",s.specularMapClampS,s.specularMapClampT),d("alphaMap",s.alphaMapClampS,s.alphaMapClampT,s.alphaMapInvert),"#ifdef USE_ENVMAP","#ifdef HAVE_TEXTURE_LOD",b?"":"#extension GL_EXT_shader_texture_lod : enable","#endif","#endif","precision "+s.precisionFragment+" float;","precision "+s.precisionFragment+" int;",b?"layout(location = 0) out vec4 outFragColor;":"","uniform highp mat4 viewMatrix;","uniform highp mat4 projectionMatrix;","uniform highp vec3 cameraPosition;","#if defined(USE_ENVMAP) || defined(USE_IRRADIANCEMAP)","uniform mat4 viewMatrixInverse;","#endif",""].join("\n"));var L=new n.WebGLShader(y,y.VERTEX_SHADER,S+E),R=new n.WebGLShader(y,y.FRAGMENT_SHADER,M+w);y.attachShader(D,L),y.attachShader(D,R),void 0!==A&&y.bindAttribLocation(D,0,A),y.linkProgram(D),"undefined"!=typeof DEBUG_SHADERS&&DEBUG_SHADERS&&(!1===y.getProgramParameter(D,y.LINK_STATUS)&&(console.error("THREE.WebGLProgram: Could not initialise shader."),console.error("gl.VALIDATE_STATUS",y.getProgramParameter(D,y.VALIDATE_STATUS)),console.error("gl.getError()",y.getError())),""!==y.getProgramInfoLog(D)&&console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",y.getProgramInfoLog(D))),y.deleteShader(L),y.deleteShader(R);var I=["viewMatrix","modelViewMatrix","projectionMatrix","normalMatrix","modelMatrix","cameraPosition","viewMatrixInverse","mvpMatrix","dbId"];for(var O in _)I.push(O);for(var N in this.uniforms=function(e,t,r){for(var n={},i=0,o=r.length;i<o;i++){var a=r[i];n[a]=e.getUniformLocation(t,a)}return n}(y,D,I),I=["position","normal","uv","uv2","tangent","color","lineDistance","uvw","id","instOffset","instScaling","instRotation","prev","next","side","uvp","pointScale"],g)I.push(N);return this.attributes=function(e,t,r){for(var n={},i=0,o=r.length;i<o;i++){var a=r[i];n[a]=e.getAttribLocation(t,a)}return n}(y,D,I),this.attributesKeys=Object.keys(this.attributes),this.id=c++,this.code=t,this.usedTimes=1,this.program=D,this.vertexShader=L,this.fragmentShader=R,this})},42713:(e,t,r)=>{"use strict";r.r(t),r.d(t,{DEBUG_TEXTURE_LOAD:()=>f,WebGLRenderer:()=>g});var n=r(68693),i=r(57658),o=r(31102),a=r(44971),s=r(84998),l=r(23909),u=r(92445),c=r(94370);function h(e,t){e.envMap&&(e.envMap.value=t.envMap),e.irradianceMap&&(e.irradianceMap.value=t.irradianceMap),e.envMapExposure&&(e.envMapExposure.value=t.envMapExposure),e.envRotationSin&&e.envRotationCos&&(e.envRotationSin.value=t.envRotationSin,e.envRotationCos.value=t.envRotationCos)}function d(e,t){e.envMap&&(e.envMap.needsUpdate=t),e.irradianceMap&&(e.irradianceMap.needsUpdate=t),e.envMapExposure&&(e.envMapExposure.needsUpdate=t)}var f=!1,p=(0,s.getGlobal)(),m=p.document,g=function(e){console.log("THREE.WebGLRenderer",l.REVISION);var t=void 0!==(e=e||{}).canvas?e.canvas:m.createElement("canvas"),r=null,s=void 0!==e.precision?e.precision:"highp",g=s,v=void 0!==e.alpha&&e.alpha,y=void 0===e.premultipliedAlpha||e.premultipliedAlpha,b=void 0!==e.antialias&&e.antialias,x=void 0===e.stencil||e.stencil,_=void 0===e.preserveDrawingBuffer||e.preserveDrawingBuffer,E=new l.Color(0),w=0,A=[],S={},M=new l.Matrix4,T=new l.Matrix3;this.highResTimeStamp=0;var C=[],P=[];this.domElement=t,this.context=null,this.refCount=0,this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.gammaInput=!1,this.gammaOutput=!1,this.maxMorphTargets=8,this.maxMorphNormals=4,this.autoScaleCubemaps=!0,this.info={memory:{programs:0,geometries:0,textures:0},render:{calls:0,vertices:0,faces:0,points:0}};var D,L,R,I,O,N,k,F,V=this,U=[],B=null,z=null,G=null,H=null,W=-1,j=null,q="",X=0,Y="",K="",Z=0,Q=0,J=0,$=t.width,ee=t.height,te=new l.Vector4,re={},ne=new l.Frustum,ie=new l.Matrix4,oe=new l.Matrix4,ae=new l.Vector3,se=new l.Vector3,le=!0,ue={ambient:[0,0,0],directional:{length:0,colors:[],positions:[]},point:{length:0,colors:[],positions:[],distances:[]},spot:{length:0,colors:[],positions:[],distances:[],directions:[],anglesCos:[],exponents:[]},hemi:{length:0,skyColors:[],groundColors:[],positions:[]}};V.capabilities={};try{var ce={alpha:v,premultipliedAlpha:y,antialias:b,stencil:x,powerPreference:"high-performance",preserveDrawingBuffer:_};if((D=!1!==e.useWebGL2?t.getContext("webgl2",ce):null)?(V.capabilities.isWebGL2=!0,L=!0):D=t.getContext("webgl",ce)||t.getContext("experimental-webgl",ce),null===D)throw null!==t.getContext("webgl")?"Error creating WebGL context with your selected attributes.":"Error creating WebGL context.";var he=D.getExtension("WEBGL_debug_renderer_info");if(he){var de=D.getParameter(he.UNMASKED_VENDOR_WEBGL),fe=D.getParameter(he.UNMASKED_RENDERER_WEBGL);console.log("WebGL Renderer: "+fe),console.log("WebGL Vendor: "+de)}0==D.getShaderPrecisionFormat(D.FRAGMENT_SHADER,D.HIGH_FLOAT).precision&&(g="mediump"),t.addEventListener("webglcontextlost",(function(e){e.preventDefault(),ve(),ge(),S={},Pt={},Dt=0,ye.dispose(),U.length=0}),!1),t.addEventListener("webglcontextrestored",(function(e){e.preventDefault(),V.enableContextRestore&&(pe(),De(),V.lostContextRecovery=V.lostContextRecovery||new o.ZP,V.lostContextRecovery.onContextRestored(),B=null,z=null)}))}catch(e){return void console.error(e)}function pe(){N=new l.WebGLExtensions(D),k=new l.WebGLState(D,$t),F=k,N.get("EXT_texture_filter_anisotropic"),N.get("WEBGL_compressed_texture_s3tc"),L?N.get("EXT_color_buffer_float"):(N.get("OES_texture_float"),N.get("OES_texture_float_linear"),N.get("OES_texture_half_float"),N.get("OES_texture_half_float_linear"),N.get("OES_standard_derivatives"),N.get("EXT_shader_texture_lod"),R=N.get("WEBGL_draw_buffers"),I=N.get("ANGLE_instanced_arrays"),O=N.get("OES_vertex_array_object")),V.extensions=N}void 0===D.getShaderPrecisionFormat&&(D.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}}),pe();var me=function(e,t,r,n){!0===y&&(e*=n,t*=n,r*=n),D.clearColor(e,t,r,n)},ge=function(){D.clearColor(0,0,0,1),D.clearDepth(1),D.clearStencil(0),D.enable(D.DEPTH_TEST),D.depthFunc(D.LEQUAL),D.frontFace(D.CCW),D.cullFace(D.BACK),D.enable(D.CULL_FACE),D.enable(D.BLEND),D.blendEquation(D.FUNC_ADD),D.blendFunc(D.SRC_ALPHA,D.ONE_MINUS_SRC_ALPHA),D.viewport(Q,J,$,ee),me(E.r,E.g,E.b,w)},ve=function(){B=null,j=null,q="",W=-1,le=!0,k.reset(),F.disableUnusedAttributes()};ge(),this.context=D,this.state=k;for(var ye,be=D.getParameter(D.MAX_TEXTURE_IMAGE_UNITS),xe=D.getParameter(D.MAX_VERTEX_TEXTURE_IMAGE_UNITS),_e=D.getParameter(D.MAX_TEXTURE_SIZE),Ee=D.getParameter(D.MAX_CUBE_MAP_TEXTURE_SIZE),we=xe>0,Ae=D.getShaderPrecisionFormat(D.VERTEX_SHADER,D.HIGH_FLOAT),Se=D.getShaderPrecisionFormat(D.VERTEX_SHADER,D.MEDIUM_FLOAT),Me=D.getShaderPrecisionFormat(D.FRAGMENT_SHADER,D.HIGH_FLOAT),Te=D.getShaderPrecisionFormat(D.FRAGMENT_SHADER,D.MEDIUM_FLOAT),Ce=new Uint8Array(16),Pe=0;Pe<4;Pe++)f?1===Pe||2===Pe?(Ce[4*Pe]=246,Ce[4*Pe+1]=140,Ce[4*Pe+2]=220):(Ce[4*Pe]=48,Ce[4*Pe+1]=195,Ce[4*Pe+2]=3):Ce[4*Pe]=Ce[4*Pe+1]=Ce[4*Pe+2]=0,Ce[4*Pe+3]=255;function De(){(ye=new l.DataTexture(Ce,2,2,l.RGBAFormat,l.UnsignedByteType,l.UVMapping,l.RepeatWrapping,l.RepeatWrapping,l.NearestFilter,l.NearestFilter)).needsUpdate=!0}De();var Le,Re,Ie=function(){if(void 0!==Le)return Le;if(Le=[],N.get("WEBGL_compressed_texture_pvrtc")||N.get("WEBGL_compressed_texture_s3tc"))for(var e=D.getParameter(D.COMPRESSED_TEXTURE_FORMATS),t=0;t<e.length;t++)Le.push(e[t]);return Le},Oe=Ae.precision>0,Ne=Se.precision>0;"highp"!==s||Oe||(Ne?(s="mediump",console.warn("WebGLRenderer: highp not supported, using mediump")):(s="lowp",console.warn("WebGLRenderer: highp and mediump not supported, using lowp"))),"mediump"!==s||Ne||(s="lowp",console.warn("WebGLRenderer: mediump not supported, using lowp")),Oe=Me.precision>0,Ne=Te.precision>0,"highp"!==g||Oe||(Ne?(g="mediump",console.warn("WebGLRenderer: highp not supported, using mediump")):(g="lowp",console.warn("WebGLRenderer: highp and mediump not supported, using lowp"))),"mediump"!==g||Ne||(g="lowp",console.warn("WebGLRenderer: mediump not supported, using lowp")),this.getContext=function(){return D},this.isWebGL2=function(){return L},this.forceContextLoss=function(){N.get("WEBGL_lose_context").loseContext()},this.forceContextRestore=function(){N.get("WEBGL_lose_context").restoreContext()},this.supportsVertexTextures=function(){return we},this.supportsFloatTextures=function(){return L||N.get("OES_texture_float")},this.supportsHalfFloatTextures=function(){return L||N.get("OES_texture_half_float_linear")},this.supportsStandardDerivatives=function(){return L||N.get("OES_standard_derivatives")},this.supportsCompressedTextureS3TC=function(){return L||N.get("WEBGL_compressed_texture_s3tc")},this.supportsElementIndexUint=function(){return L||N.get("OES_element_index_uint")},this.supportsInstancedArrays=function(){return L||!!I},this.supportsBlendMinMax=function(){return L||N.get("EXT_blend_minmax")},this.getMaxAnisotropy=function(){if(void 0!==Re)return Re;var e=N.get("EXT_texture_filter_anisotropic");return Re=null!==e?D.getParameter(e.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0},this.getPixelRatio=function(){return r||p.devicePixelRatio||1},this.setPixelRatio=function(e){r=e},this.getCurrentFramebuffer=function(){return z},this.setSize=function(e,r,n){var i=this.getPixelRatio();t.width=e*i,t.height=r*i,!1!==n&&(t.style.width=e+"px",t.style.height=r+"px"),this.setViewport(0,0,e,r)},this.setViewport=function(e,t,r,n){var i=this.getPixelRatio();Q=e*i,J=t*i,$=r*i,ee=n*i,D.viewport(Q,J,$,ee)};var ke=!1;this.enableViewportOnOffscreenTargets=function(e){ke=e};var Fe=[];function Ve(e){e.__webglVertexBuffer=D.createBuffer(),e.__webglNormalBuffer=D.createBuffer(),e.__webglTangentBuffer=D.createBuffer(),e.__webglColorBuffer=D.createBuffer(),e.__webglUVBuffer=D.createBuffer(),e.__webglUV2Buffer=D.createBuffer(),e.__webglSkinIndicesBuffer=D.createBuffer(),e.__webglSkinWeightsBuffer=D.createBuffer(),e.__webglFaceBuffer=D.createBuffer(),e.__webglLineBuffer=D.createBuffer(),V.info.memory.geometries++}this.pushViewport=function(){Fe.push(Q),Fe.push(J),Fe.push($),Fe.push(ee)},this.popViewport=function(){var e=Fe.length-4;Q=Fe[e],J=Fe[e+1],$=Fe[e+2],ee=Fe[e+3],D.viewport(Q,J,$,ee),Fe.length=e},this.setScissor=function(e,t,r,n){var i=this.getPixelRatio();D.scissor(e*i,t*i,r*i,n*i)},this.enableScissorTest=function(e){e?D.enable(D.SCISSOR_TEST):D.disable(D.SCISSOR_TEST)},this.getClearColor=function(e){return void 0===e&&(console.warn("WebGLRenderer: .getClearColor() now requires a Color as an argument"),e=new l.Color),e.copy(E)},this.setClearColor=function(e,t){E.set(e),w=void 0!==t?t:1,me(E.r,E.g,E.b,w)},this.getClearAlpha=function(){return w},this.setClearAlpha=function(e){w=e,me(E.r,E.g,E.b,w)},this.clear=function(e,t,r){var n=0;(void 0===e||e)&&(n|=D.COLOR_BUFFER_BIT),(void 0===t||t)&&(n|=D.DEPTH_BUFFER_BIT),(void 0===r||r)&&(n|=D.STENCIL_BUFFER_BIT),D.clear(n)},this.clearColor=function(){D.clear(D.COLOR_BUFFER_BIT)},this.clearDepth=function(){D.clear(D.DEPTH_BUFFER_BIT)},this.clearStencil=function(){D.clear(D.STENCIL_BUFFER_BIT)},this.clearTarget=function(e,t,r,n){this.setRenderTarget(e),this.clear(t,r,n)},this.resetGLState=ve;var Ue=function e(t){t.target.traverse((function(t){t.removeEventListener("remove",e),function(e){(e instanceof l.Mesh||e instanceof l.PointCloud||e instanceof l.Line)&&delete S[e.id];delete e.__webglInit,delete e.__webglActive}(t)}))},Be=function e(t){var r=t.target;r.removeEventListener("dispose",e),je(r)},ze=function e(t){var r=t.target;r.removeEventListener("dispose",e),Ze(r),V.info.memory.textures--},Ge=function e(t){var r=t.target;r.removeEventListener("dispose",e),Qe(r),V.info.memory.textures--},He=function e(t){var r=t.target;r.removeEventListener("dispose",e),Je(r)},We=function(e){if(void 0!==e.__webglVertexBuffer&&(D.deleteBuffer(e.__webglVertexBuffer),e.__webglVertexBuffer=void 0),void 0!==e.__webglNormalBuffer&&(D.deleteBuffer(e.__webglNormalBuffer),e.__webglNormalBuffer=void 0),void 0!==e.__webglTangentBuffer&&(D.deleteBuffer(e.__webglTangentBuffer),e.__webglTangentBuffer=void 0),void 0!==e.__webglColorBuffer&&(D.deleteBuffer(e.__webglColorBuffer),e.__webglColorBuffer=void 0),void 0!==e.__webglUVBuffer&&(D.deleteBuffer(e.__webglUVBuffer),e.__webglUVBuffer=void 0),void 0!==e.__webglUV2Buffer&&(D.deleteBuffer(e.__webglUV2Buffer),e.__webglUV2Buffer=void 0),void 0!==e.__webglSkinIndicesBuffer&&(D.deleteBuffer(e.__webglSkinIndicesBuffer),e.__webglSkinIndicesBuffer=void 0),void 0!==e.__webglSkinWeightsBuffer&&(D.deleteBuffer(e.__webglSkinWeightsBuffer),e.__webglSkinWeightsBuffer=void 0),void 0!==e.__webglFaceBuffer&&(D.deleteBuffer(e.__webglFaceBuffer),e.__webglFaceBuffer=void 0),void 0!==e.__webglLineBuffer&&(D.deleteBuffer(e.__webglLineBuffer),e.__webglLineBuffer=void 0),void 0!==e.__webglLineDistanceBuffer&&(D.deleteBuffer(e.__webglLineDistanceBuffer),e.__webglLineDistanceBuffer=void 0),void 0!==e.__webglCustomAttributesList){for(var t in e.__webglCustomAttributesList)D.deleteBuffer(e.__webglCustomAttributesList[t].buffer);e.__webglCustomAttributesList=void 0}V.info.memory.geometries--},je=function(e){var t,r,n,i;if(e.__webglInit=void 0,e instanceof l.BufferGeometry){if(void 0!==e.vbbuffer&&(D.deleteBuffer(e.vbbuffer),e.vbbuffer=void 0),void 0!==e.ibbuffer&&(D.deleteBuffer(e.ibbuffer),e.ibbuffer=void 0),void 0!==e.iblinesbuffer&&(D.deleteBuffer(e.iblinesbuffer),e.iblinesbuffer=void 0),e.vaos){for(t=0;t<e.vaos.length;t++)ct(e.vaos[t].vao);e.vaos=void 0}var o=e.attributes;for(var a in o)void 0!==o[a].buffer&&(D.deleteBuffer(o[a].buffer),o[a].buffer=void 0);V.info.memory.geometries--}else{var s=Pt[e.id];if(void 0!==s){for(t=0,r=s.length;t<r;t++){var u=s[t];if(void 0!==u.numMorphTargets){for(n=0,i=u.numMorphTargets;n<i;n++)D.deleteBuffer(u.__webglMorphTargetsBuffers[n]);delete u.__webglMorphTargetsBuffers}if(void 0!==u.numMorphNormals){for(n=0,i=u.numMorphNormals;n<i;n++)D.deleteBuffer(u.__webglMorphNormalsBuffers[n]);delete u.__webglMorphNormalsBuffers}We(u)}delete Pt[e.id]}else We(e)}};this.deallocateGeometry=je;var qe,Xe,Ye,Ke,Ze=function(e){if(e.__webglTextureCube)D.deleteTexture(e.__webglTextureCube),e.__webglTextureCube=void 0;else{if(!e.__webglInit)return;D.deleteTexture(e.__webglTexture),e.__webglInit=void 0,e.__webglTexture=void 0}},Qe=function(e){e&&e.__webglTexture&&(D.deleteTexture(e.__webglTexture),D.deleteFramebuffer(e.__webglFramebuffer),void 0!==e.__webglRenderbuffer&&D.deleteRenderbuffer(e.__webglRenderbuffer),void 0!==e.__webglRenderbufferOwn&&(D.deleteRenderbuffer(e.__webglRenderbufferOwn),e.__webglRenderbufferOwn=void 0))},Je=function(e){var t=!1;e.program=void 0,e.programs.forEach((function(e){var r,n,i,o;if(void 0!==e&&null!=(r=e.program))for(n=0,i=U.length;n<i;n++)if((o=U[n])&&o.program===r){o.usedTimes--,0===o.usedTimes&&(U[n]=void 0,D.deleteProgram(r),V.info.memory.programs--,t=!0);break}}),!1),e.programs.length=0,t&&(U=U.filter((function(e){return void 0!==e})))};function $e(e,t){var r=e.vertices.length,n=t.material;if(n.attributes)for(var i in void 0===e.__webglCustomAttributesList&&(e.__webglCustomAttributesList=[]),n.attributes){var o=n.attributes[i];if(!o.__webglInitialized||o.createUniqueBuffers){o.__webglInitialized=!0;var a=1;"v2"===o.type?a=2:"v3"===o.type?a=3:"v4"===o.type?a=4:"c"===o.type&&(a=3),o.size=a,o.array=new Float32Array(r*a),o.buffer=D.createBuffer(),o.buffer.belongsToAttribute=i,o.needsUpdate=!0}e.__webglCustomAttributesList.push(o)}}function et(e,t){var r=t.geometry,n=e.faces3,i=3*n.length,o=1*n.length,a=3*n.length,s=tt(t,e),l=it(s),u=rt(s),c=nt(s);e.__vertexArray=new Float32Array(3*i),u&&(e.__normalArray=new Float32Array(3*i)),r.hasTangents&&(e.__tangentArray=new Float32Array(4*i)),c&&(e.__colorArray=new Float32Array(3*i)),l&&(r.faceVertexUvs.length>0&&(e.__uvArray=new Float32Array(2*i)),r.faceVertexUvs.length>1&&(e.__uv2Array=new Float32Array(2*i))),t.geometry.skinWeights.length&&t.geometry.skinIndices.length&&(e.__skinIndexArray=new Float32Array(4*i),e.__skinWeightArray=new Float32Array(4*i));var h=(L||N.get("OES_element_index_uint"))&&o>21845?Uint32Array:Uint16Array;if(e.__typeArray=h,e.__faceArray=new h(3*o),e.__lineArray=new h(2*a),e.__webglFaceCount=3*o,e.__webglLineCount=2*a,s.attributes)for(var d in void 0===e.__webglCustomAttributesList&&(e.__webglCustomAttributesList=[]),s.attributes){var f=s.attributes[d],p={};for(var m in f)p[m]=f[m];if(!p.__webglInitialized||p.createUniqueBuffers){p.__webglInitialized=!0;var g=1;"v2"===p.type?g=2:"v3"===p.type?g=3:"v4"===p.type?g=4:"c"===p.type&&(g=3),p.size=g,p.array=new Float32Array(i*g),p.buffer=D.createBuffer(),p.buffer.belongsToAttribute=d,f.needsUpdate=!0,p.__original=f}e.__webglCustomAttributesList.push(p)}e.__inittedArrays=!0}function tt(e,t){return e.material instanceof l.MeshFaceMaterial?e.material.materials[t.materialIndex]:e.material}function rt(e){return!(e instanceof l.MeshBasicMaterial&&!e.envMap||e instanceof l.MeshDepthMaterial)&&(function(e){return e&&(void 0!==e.shading&&e.shading===l.SmoothShading||void 0!==e.flatShading&&!1===e.flatShading)}(e)?l.SmoothShading:l.FlatShading)}function nt(e){return!!e.vertexColors&&e.vertexColors}function it(e){return!!(e.map||e.lightMap||e.bumpMap||e.normalMap||e.specularMap||e.alphaMap||e instanceof l.ShaderMaterial)}function ot(e){return!0===e.needsUpdate}function at(e){e.needsUpdate=!1}function st(e,t,r,n,i){if(e.__inittedArrays){var o,a,s,u,c,h,d,f,p,m,g,v,y,b,x,_,E,w,A,S,M,T,C,P,L,R,I=rt(i),O=nt(i),N=it(i),k=I===l.SmoothShading,F=0,V=0,U=0,B=0,z=0,G=0,H=0,W=0,j=0,q=0,X=e.__vertexArray,Y=e.__uvArray,K=e.__uv2Array,Z=e.__normalArray,Q=e.__tangentArray,J=e.__colorArray,$=e.__webglCustomAttributesList,ee=e.__faceArray,te=e.__lineArray,re=t.geometry,ne=re.verticesNeedUpdate,ie=re.elementsNeedUpdate,oe=re.uvsNeedUpdate,ae=re.normalsNeedUpdate,se=re.tangentsNeedUpdate,le=re.colorsNeedUpdate,ue=re.vertices,ce=e.faces3,he=re.faces,de=re.faceVertexUvs[0],fe=re.faceVertexUvs[1];if(ne){for(o=0,a=ce.length;o<a;o++)g=ue[(s=he[ce[o]]).a],v=ue[s.b],y=ue[s.c],X[V]=g.x,X[V+1]=g.y,X[V+2]=g.z,X[V+3]=v.x,X[V+4]=v.y,X[V+5]=v.z,X[V+6]=y.x,X[V+7]=y.y,X[V+8]=y.z,V+=9;D.bindBuffer(D.ARRAY_BUFFER,e.__webglVertexBuffer),D.bufferData(D.ARRAY_BUFFER,X,r)}if(le&&O){for(o=0,a=ce.length;o<a;o++)h=(s=he[ce[o]]).vertexColors,d=s.color,3===h.length&&O===l.VertexColors?(E=h[0],w=h[1],A=h[2]):(E=d,w=d,A=d),J[j]=E.r,J[j+1]=E.g,J[j+2]=E.b,J[j+3]=w.r,J[j+4]=w.g,J[j+5]=w.b,J[j+6]=A.r,J[j+7]=A.g,J[j+8]=A.b,j+=9;j>0&&(D.bindBuffer(D.ARRAY_BUFFER,e.__webglColorBuffer),D.bufferData(D.ARRAY_BUFFER,J,r))}if(se&&re.hasTangents){for(o=0,a=ce.length;o<a;o++)b=(f=(s=he[ce[o]]).vertexTangents)[0],x=f[1],_=f[2],Q[H]=b.x,Q[H+1]=b.y,Q[H+2]=b.z,Q[H+3]=b.w,Q[H+4]=x.x,Q[H+5]=x.y,Q[H+6]=x.z,Q[H+7]=x.w,Q[H+8]=_.x,Q[H+9]=_.y,Q[H+10]=_.z,Q[H+11]=_.w,H+=12;D.bindBuffer(D.ARRAY_BUFFER,e.__webglTangentBuffer),D.bufferData(D.ARRAY_BUFFER,Q,r)}if(ae&&I){for(o=0,a=ce.length;o<a;o++)if(u=(s=he[ce[o]]).vertexNormals,c=s.normal,3===u.length&&k)for(S=0;S<3;S++)T=u[S],Z[G]=T.x,Z[G+1]=T.y,Z[G+2]=T.z,G+=3;else for(S=0;S<3;S++)Z[G]=c.x,Z[G+1]=c.y,Z[G+2]=c.z,G+=3;D.bindBuffer(D.ARRAY_BUFFER,e.__webglNormalBuffer),D.bufferData(D.ARRAY_BUFFER,Z,r)}if(oe&&de&&N){for(o=0,a=ce.length;o<a;o++)if(void 0!==(p=de[ce[o]]))for(S=0;S<3;S++)C=p[S],Y[U]=C.x,Y[U+1]=C.y,U+=2;U>0&&(D.bindBuffer(D.ARRAY_BUFFER,e.__webglUVBuffer),D.bufferData(D.ARRAY_BUFFER,Y,r))}if(oe&&fe&&N){for(o=0,a=ce.length;o<a;o++)if(void 0!==(m=fe[ce[o]]))for(S=0;S<3;S++)P=m[S],K[B]=P.x,K[B+1]=P.y,B+=2;B>0&&(D.bindBuffer(D.ARRAY_BUFFER,e.__webglUV2Buffer),D.bufferData(D.ARRAY_BUFFER,K,r))}if(ie){for(o=0,a=ce.length;o<a;o++)ee[z]=F,ee[z+1]=F+1,ee[z+2]=F+2,z+=3,te[W]=F,te[W+1]=F+1,te[W+2]=F,te[W+3]=F+2,te[W+4]=F+1,te[W+5]=F+2,W+=6,F+=3;D.bindBuffer(D.ELEMENT_ARRAY_BUFFER,e.__webglFaceBuffer),D.bufferData(D.ELEMENT_ARRAY_BUFFER,ee,r),D.bindBuffer(D.ELEMENT_ARRAY_BUFFER,e.__webglLineBuffer),D.bufferData(D.ELEMENT_ARRAY_BUFFER,te,r)}if($)for(S=0,M=$.length;S<M;S++)if(ot((R=$[S]).__original)){if(q=0,1===R.size){if(void 0===R.boundTo||"vertices"===R.boundTo)for(o=0,a=ce.length;o<a;o++)s=he[ce[o]],R.array[q]=R.value[s.a],R.array[q+1]=R.value[s.b],R.array[q+2]=R.value[s.c],q+=3;else if("faces"===R.boundTo)for(o=0,a=ce.length;o<a;o++)L=R.value[ce[o]],R.array[q]=L,R.array[q+1]=L,R.array[q+2]=L,q+=3}else if(2===R.size){if(void 0===R.boundTo||"vertices"===R.boundTo)for(o=0,a=ce.length;o<a;o++)s=he[ce[o]],g=R.value[s.a],v=R.value[s.b],y=R.value[s.c],R.array[q]=g.x,R.array[q+1]=g.y,R.array[q+2]=v.x,R.array[q+3]=v.y,R.array[q+4]=y.x,R.array[q+5]=y.y,q+=6;else if("faces"===R.boundTo)for(o=0,a=ce.length;o<a;o++)g=L=R.value[ce[o]],v=L,y=L,R.array[q]=g.x,R.array[q+1]=g.y,R.array[q+2]=v.x,R.array[q+3]=v.y,R.array[q+4]=y.x,R.array[q+5]=y.y,q+=6}else if(3===R.size){var pe;if(pe="c"===R.type?["r","g","b"]:["x","y","z"],void 0===R.boundTo||"vertices"===R.boundTo)for(o=0,a=ce.length;o<a;o++)s=he[ce[o]],g=R.value[s.a],v=R.value[s.b],y=R.value[s.c],R.array[q]=g[pe[0]],R.array[q+1]=g[pe[1]],R.array[q+2]=g[pe[2]],R.array[q+3]=v[pe[0]],R.array[q+4]=v[pe[1]],R.array[q+5]=v[pe[2]],R.array[q+6]=y[pe[0]],R.array[q+7]=y[pe[1]],R.array[q+8]=y[pe[2]],q+=9;else if("faces"===R.boundTo)for(o=0,a=ce.length;o<a;o++)g=L=R.value[ce[o]],v=L,y=L,R.array[q]=g[pe[0]],R.array[q+1]=g[pe[1]],R.array[q+2]=g[pe[2]],R.array[q+3]=v[pe[0]],R.array[q+4]=v[pe[1]],R.array[q+5]=v[pe[2]],R.array[q+6]=y[pe[0]],R.array[q+7]=y[pe[1]],R.array[q+8]=y[pe[2]],q+=9;else if("faceVertices"===R.boundTo)for(o=0,a=ce.length;o<a;o++)g=(L=R.value[ce[o]])[0],v=L[1],y=L[2],R.array[q]=g[pe[0]],R.array[q+1]=g[pe[1]],R.array[q+2]=g[pe[2]],R.array[q+3]=v[pe[0]],R.array[q+4]=v[pe[1]],R.array[q+5]=v[pe[2]],R.array[q+6]=y[pe[0]],R.array[q+7]=y[pe[1]],R.array[q+8]=y[pe[2]],q+=9}else if(4===R.size)if(void 0===R.boundTo||"vertices"===R.boundTo)for(o=0,a=ce.length;o<a;o++)s=he[ce[o]],g=R.value[s.a],v=R.value[s.b],y=R.value[s.c],R.array[q]=g.x,R.array[q+1]=g.y,R.array[q+2]=g.z,R.array[q+3]=g.w,R.array[q+4]=v.x,R.array[q+5]=v.y,R.array[q+6]=v.z,R.array[q+7]=v.w,R.array[q+8]=y.x,R.array[q+9]=y.y,R.array[q+10]=y.z,R.array[q+11]=y.w,q+=12;else if("faces"===R.boundTo)for(o=0,a=ce.length;o<a;o++)g=L=R.value[ce[o]],v=L,y=L,R.array[q]=g.x,R.array[q+1]=g.y,R.array[q+2]=g.z,R.array[q+3]=g.w,R.array[q+4]=v.x,R.array[q+5]=v.y,R.array[q+6]=v.z,R.array[q+7]=v.w,R.array[q+8]=y.x,R.array[q+9]=y.y,R.array[q+10]=y.z,R.array[q+11]=y.w,q+=12;else if("faceVertices"===R.boundTo)for(o=0,a=ce.length;o<a;o++)g=(L=R.value[ce[o]])[0],v=L[1],y=L[2],R.array[q]=g.x,R.array[q+1]=g.y,R.array[q+2]=g.z,R.array[q+3]=g.w,R.array[q+4]=v.x,R.array[q+5]=v.y,R.array[q+6]=v.z,R.array[q+7]=v.w,R.array[q+8]=y.x,R.array[q+9]=y.y,R.array[q+10]=y.z,R.array[q+11]=y.w,q+=12;D.bindBuffer(D.ARRAY_BUFFER,R.buffer),D.bufferData(D.ARRAY_BUFFER,R.array,r)}n&&(delete e.__inittedArrays,delete e.__colorArray,delete e.__normalArray,delete e.__tangentArray,delete e.__uvArray,delete e.__uv2Array,delete e.__faceArray,delete e.__vertexArray,delete e.__lineArray,delete e.__skinIndexArray,delete e.__skinWeightArray)}}function lt(e){var t;if(e.streamingDraw){if(!e.streamingIndex){var r=e.index;r&&(r.buffer=D.createBuffer(),D.bindBuffer(D.ELEMENT_ARRAY_BUFFER,r.buffer),D.bufferData(D.ELEMENT_ARRAY_BUFFER,r.array||e.ib,D.STATIC_DRAW))}}else{e.vb&&void 0===e.vbbuffer&&(e.vbbuffer=D.createBuffer(),e.vbNeedsUpdate=!0);var n=e.ib||(null===(t=e.index)||void 0===t?void 0:t.array);n&&void 0===e.ibbuffer&&(e.ibbuffer=D.createBuffer(),D.bindBuffer(D.ELEMENT_ARRAY_BUFFER,e.ibbuffer),D.bufferData(D.ELEMENT_ARRAY_BUFFER,n,D.STATIC_DRAW)),e.iblines&&void 0===e.iblinesbuffer&&(e.iblinesbuffer=D.createBuffer(),D.bindBuffer(D.ELEMENT_ARRAY_BUFFER,e.iblinesbuffer),D.bufferData(D.ELEMENT_ARRAY_BUFFER,e.iblines,D.STATIC_DRAW));for(var i=e.attributes,o=Object.keys(e.attributes),a=0,s=o.length;a<s;a++){var l=o[a],u=i[l],c="index"===l;if(u.array&&void 0===u.buffer&&(u.buffer=D.createBuffer(),u.needsUpdate=!0),ot(u)){var h=c?D.ELEMENT_ARRAY_BUFFER:D.ARRAY_BUFFER;D.bindBuffer(h,u.buffer),D.bufferData(h,u.array,D.STATIC_DRAW),at(u)}}e.vbNeedsUpdate&&(D.bindBuffer(D.ARRAY_BUFFER,e.vbbuffer),D.bufferData(D.ARRAY_BUFFER,e.vb,D.STATIC_DRAW),e.vbNeedsUpdate=!1,e.discardAfterUpload&&(e.vb=null))}}function ut(e){L?D.bindVertexArray(e):O.bindVertexArrayOES(e)}function ct(e){L?D.deleteVertexArray(e):O.deleteVertexArrayOES(e)}function ht(e,t,r){L?D.vertexAttribDivisor(e,t&&r||0):I&&I.vertexAttribDivisorANGLE(e,t&&r||0)}function dt(e,t,r,n,i){L?D.drawElementsInstanced(e,t,r,n,i):I.drawElementsInstancedANGLE(e,t,r,n,i)}function ft(e,t,r,n){var i,o,a;if(!u.USE_VAO||r.streamingDraw)return r.vaos=null,!1;if(!L&&!O)return r.vaos=null,!1;if(void 0===r.vaos&&(r.vaos=[]),a=L?D.createVertexArray():O.createVertexArrayOES(),r.vaos.push({geomhash:t.id,uv:n,vao:a}),ut(a),e.isEdgeMaterial)D.bindBuffer(D.ELEMENT_ARRAY_BUFFER,r.iblinesbuffer);else{var s=r.index;s&&D.bindBuffer(D.ELEMENT_ARRAY_BUFFER,s.buffer||r.ibbuffer)}for(var l=null,c=t.attributes,h=t.attributesKeys,d=r.vbstride,f=null!==(i=r.groups)&&void 0!==i&&i.length?r.groups[0].index:0,p=null!==(o=r.groups)&&void 0!==o&&o.length&&r.groups[0].instanceStart||0,m=0,g=h.length;m<g;m++){var v=h[m],y=c[v];if(y>=0){var b=r.attributes[v];if("uv"===v&&n&&(b=r.attributes["uv"+(n+1)]),!b){ut(null);for(var x=0;x<r.vaos.length;x++)ct(r.vaos[x].vao);return r.vaos=null,!1}var _=D.FLOAT,E=b.bytesPerItem||4;1===E?_=D.UNSIGNED_BYTE:2===E&&(_=D.UNSIGNED_SHORT),D.enableVertexAttribArray(y);var w=f;b.divisor&&(w+=p),void 0!==b.itemOffset?(l!=r.vbbuffer&&(D.bindBuffer(D.ARRAY_BUFFER,r.vbbuffer),l=r.vbbuffer),D.vertexAttribPointer(y,b.itemSize,_,b.normalized,4*d,4*(b.itemOffset+w*d))):(D.bindBuffer(D.ARRAY_BUFFER,b.buffer),l=b.buffer,D.vertexAttribPointer(y,b.itemSize,_,b.normalized,0,w*b.itemSize*E)),ht(y,r.numInstances,b.divisor)}}return!0}function pt(e,t){var r=re[e];return r||(r=D.createBuffer(),re[e]=r),D.bindBuffer(D.ARRAY_BUFFER,r),D.bufferData(D.ARRAY_BUFFER,t,D.DYNAMIC_DRAW),r}function mt(e,t,r,n,i,o,a){var s,l=t.attributes,u=t.attributesKeys,c=0;if(i)if(!i.buffer&&r.streamingDraw){var h=re.index;h||(h=D.createBuffer(),re.index=h),D.bindBuffer(D.ELEMENT_ARRAY_BUFFER,h),e.isEdgeMaterial?D.bufferData(D.ELEMENT_ARRAY_BUFFER,r.iblines,D.DYNAMIC_DRAW):D.bufferData(D.ELEMENT_ARRAY_BUFFER,i.array||r.ib,D.DYNAMIC_DRAW)}else e.isEdgeMaterial?D.bindBuffer(D.ELEMENT_ARRAY_BUFFER,r.iblinesbuffer):D.bindBuffer(D.ELEMENT_ARRAY_BUFFER,i.buffer||r.ibbuffer);for(var d=0,f=u.length;d<f;d++){var p=u[d],m=l[p];if(m>=0){var g=r.attributes[p];if("uv"===p&&o&&(g=r.attributes["uv"+(o+1)]),g){var v,y,b=void 0!==g.itemOffset;b?(v=r.vbstride,y=g.itemOffset,c!==s&&(r.streamingDraw?c=pt("interleavedVB",r.vb):(c=r.vbbuffer,D.bindBuffer(D.ARRAY_BUFFER,c)),s=c)):(v=g.itemSize,y=0,r.streamingDraw?c=pt(p,g.array):(c=g.buffer,D.bindBuffer(D.ARRAY_BUFFER,c)));var x=D.FLOAT,_=g.bytesPerItem||4;1===_?x=D.UNSIGNED_BYTE:2===_&&(x=D.UNSIGNED_SHORT),b&&(_=4),F.enableAttribute(m);var E=n;g.divisor&&(E+=a),D.vertexAttribPointer(m,g.itemSize,x,g.normalized,v*_,(y+E*v)*_),ht(m,r.numInstances,g.divisor)}else if(e.defaultAttributeValues){var w=e.defaultAttributeValues[p];w&&2===w.length?D.vertexAttrib2fv(m,e.defaultAttributeValues[p]):w&&3===w.length?D.vertexAttrib3fv(m,e.defaultAttributeValues[p]):w&&4===w.length&&D.vertexAttrib4fv(m,e.defaultAttributeValues[p])}}}F.disableUnusedAttributes()}function gt(e,t){return e.object.renderOrder!==t.object.renderOrder?e.object.renderOrder-t.object.renderOrder:e.z!==t.z?e.z-t.z:e.id-t.id}function vt(e,t){return e.object.renderOrder!==t.object.renderOrder?e.object.renderOrder-t.object.renderOrder:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?t.z-e.z:e.id-t.id}function yt(e){xt(e,!0)}function bt(e){xt(e,!1)}function xt(e,t,r){var n,i;if(r||!1!==e.visible){if(e instanceof l.Scene||e instanceof l.Group);else if(e instanceof a.RenderBatch)e.forEach(t?yt:bt);else if(function(e){V.lostContextRecovery&&V.lostContextRecovery.refreshIfNeeded(e),void 0===e.__webglInit&&(e.__webglInit=!0,e.addEventListener("removed",Ue));var t=e.geometry;void 0===t||void 0===t.__webglInit&&(t.__webglInit=!0,t.addEventListener("dispose",Be),t instanceof l.BufferGeometry||(e instanceof l.Mesh?Lt(e,t):e instanceof l.Line?void 0===t.__webglVertexBuffer&&(!function(e){e.__webglVertexBuffer=D.createBuffer(),e.__webglColorBuffer=D.createBuffer(),e.__webglLineDistanceBuffer=D.createBuffer(),V.info.memory.geometries++}(t),function(e,t){var r=e.vertices.length;e.__vertexArray=new Float32Array(3*r),e.__colorArray=new Float32Array(3*r),e.__lineDistanceArray=new Float32Array(1*r),e.__webglLineCount=r,$e(e,t)}(t,e),t.verticesNeedUpdate=!0,t.colorsNeedUpdate=!0,t.lineDistancesNeedUpdate=!0):e instanceof l.PointCloud&&void 0===t.__webglVertexBuffer&&(!function(e){e.__webglVertexBuffer=D.createBuffer(),e.__webglColorBuffer=D.createBuffer(),V.info.memory.geometries++}(t),function(e,t){var r=e.vertices.length;e.__vertexArray=new Float32Array(3*r),e.__colorArray=new Float32Array(3*r),e.__webglPointCount=r,$e(e,t)}(t,e),t.verticesNeedUpdate=!0,t.colorsNeedUpdate=!0)));if(void 0===e.__webglActive)if(e.__webglActive=!0,e instanceof l.Mesh){if(t instanceof l.BufferGeometry)Rt(S,t,e);else if(t instanceof l.Geometry)for(var r=Pt[t.id],n=0,i=r.length;n<i;n++)Rt(S,r[n],e)}else(e instanceof l.Line||e instanceof l.PointCloud)&&Rt(S,t,e)}(e),e instanceof l.Light)A.push(e);else{var o=S[e.id];if(o&&(!1===e.frustumCulled||!0===ne.intersectsObject(e)))for(n=0,i=o.length;n<i;n++){var s=o[n];Ct(s),s.render=!0,!0===t&&(ae.setFromMatrixPosition(e.matrixWorld),ae=(0,c.r)(ae,ie),s.z=ae.z)}}if(e.children)for(n=0,i=e.children.length;n<i;n++)xt(e.children[n],t,r)}}function _t(e,t){if(!t.getCustomOverrideMaterial)return t;var r=t.getCustomOverrideMaterial(e);return r||t}function Et(e,t,r,n,i,o,a){if(e.twoPassTransparency){var s=e.side;e.side=l.BackSide,At(e,t,r,n,i,o,a),e.side=l.FrontSide,At(e,t,r,n,i,o,a),e.side=s}else At(e,t,r,n,i,o,a)}function wt(e,t,r,n,i){for(var o,a=0,s=e.length;a<s;a++){var l=e[a],u=l.object,c=l.buffer;if(i)o=_t(l.material,i);else{if(!(o=l.material))continue;Ft(o)}if(t.isArrayCamera)for(var h=t.cameras,d=0,f=h.length;d<f;d++){var p=h[d];u.layers.test(p.layers)&&(k.viewport(te.copy(p.viewport)),D.viewport(te.x,te.y,te.z,te.w),Et(o,p,r,n,c,i,u))}else Et(o,t,r,n,c,i,u)}}function At(e,t,r,n,i,o,a){if(V.setMaterialFaces(e),i instanceof l.BufferGeometry?V.renderBufferDirect(t,r,n,e,i,a):V.renderBuffer(t,r,n,e,i,a),e.decals)for(var s=e.decals,u=0,c=s.length;u<c;u++){var h=s[u];Ft(e=h.material),V.setMaterialFaces(e),i instanceof l.BufferGeometry&&V.renderBufferDirect(t,r,n,e,i,a,h.uv)}}function St(e,t){if(e.visible&&!e.hide){var r;if(Ke)r=_t(e.material,Ke);else{if(!(r=e.material))return;Ft(r)}if(r.twoPassTransparency){var n=r.side;r.side=l.BackSide,Mt(e,r),r.side=l.FrontSide,Mt(e,r),r.side=n}else Mt(e,r)}}function Mt(e,t){if(V.setMaterialFaces(t),V.renderBufferDirect(qe,Xe,Ye,t,e.geometry,e),t.decals)for(var r=t.decals,n=0,i=r.length;n<i;n++){var o=r[n];Ft(t=o.material),V.setMaterialFaces(t),V.renderBufferDirect(qe,Xe,Ye,t,e.geometry,e,o.uv)}}function Tt(e,t,r,n,i,o){if(Xe=n,Ye=i,Ke=o||null,r.isArrayCamera)for(var a=0;a<r.cameras.length;a++)qe=r.cameras[a],k.viewport(te.copy(qe.viewport)),D.viewport(te.x,te.y,te.z,te.w),e.forEach(St,e.forceVisible?1:32,!1);else qe=r,e.forEach(St,e.forceVisible?1:32,!1)}function Ct(e){var t=e.object,r=e.buffer,n=t.geometry,i=t.material;if(i instanceof l.MeshFaceMaterial){var o=n instanceof l.BufferGeometry?0:r.materialIndex;i=i.materials[o],e.material=i,i.transparent?P.push(e):C.push(e)}else i&&(e.material=i,i.transparent?P.push(e):C.push(e))}this.renderBufferDirect=function(e,t,r,n,i,o,a){var s;if(V.lostContextRecovery&&V.lostContextRecovery.refreshIfNeeded(i),!1!==n.visible&&(!n.isEdgeMaterial||i.iblines)){lt(o.geometry);var u=Vt(e,t,r,n,o),c=!1,h=n.wireframe?1:0,d="direct_"+i.id+(a?"/"+a:"")+"_"+u.id+"_"+h;d!==q&&(q=d,c=!0);var f,p=null===(s=i.groups)||void 0===s?void 0:s.length,m=p&&i.groups.some((function(e){return e.index>=0||e.instanceStart>=0}));m?c=!0:(f=function(e,t,r,n){var i=r.vaos;if(i)for(var o=0,a=i.length;o<a;o++){var s=i[o];if(s.geomhash===t.id&&s.uv===n)return ut(s.vao),!0}else if(null===i)return!1;return ft(e,t,r,n)}(n,u,i,a||0),c=c&&!f),c&&F.initAttributes();var g,v=i.index;if(v){var y,b,x=v.array?v.array:i.ib;n.isEdgeMaterial&&(v=i.attributes.indexlines,x=i.iblines),v.bytesPerItem?4===(b=v.bytesPerItem)&&!L&&N.get("OES_element_index_uint"):b=x instanceof Uint32Array&&(L||N.get("OES_element_index_uint"))?4:2,y=4===b?D.UNSIGNED_INT:D.UNSIGNED_SHORT;var _=i.groups;p&&n.isEdgeMaterial&&!Object.prototype.hasOwnProperty.call(_[0],"edgeStart")&&(_=null);var E=0;do{var w,A,S,M,T;if(p){var C=_[E];w=C.index,A=n.isEdgeMaterial?C.edgeStart||0:C.start,S=n.isEdgeMaterial?C.edgeCount||x.length:C.count,M=C.instanceStart||0,T=C.numInstances||i.numInstances;var P=n.program.uniforms;if(P.themingColor&&"themingColor"in C){var R=C.themingColor;R instanceof l.Vector4?D.uniform4f(P.themingColor,R.x,R.y,R.z,R.w):D.uniform4f(P.themingColor,0,0,0,0)}}else w=0,A=0,S=x.length,M=0,T=i.numInstances;c&&(mt(n,u,i,w,v,a,M),m||(c=!1)),g=D.TRIANGLES,i.isPoints||o instanceof l.PointCloud?g=D.POINTS:(i.isLines||n.isEdgeMaterial||o instanceof l.Line)&&(g=D.LINES),T?dt(g,S,y,A*b,T):D.drawElements(g,S,y,A*b)}while(_&&++E<_.length)}else{var O;(null===(O=i.groups)||void 0===O?void 0:O.length)>1&&console.error("Geometry with draw calls and no index buffer"),c&&mt(n,u,i,0,void 0,a,0);var k=i.attributes.position;g=D.TRIANGLES,i.isPoints||o instanceof l.PointCloud?g=D.POINTS:(i.isLines||n.isEdgeMaterial||o instanceof l.Line)&&(g=D.LINES),i.numInstances?function(e,t,r,n){L?D.drawArraysInstanced(e,t,r,n):I.drawArraysInstancedANGLE(e,t,r,n)}(g,0,k.array.length/3,i.numInstances):D.drawArrays(g,0,k.array.length/k.itemSize)}f&&ut(null)}},this.renderBuffer=function(e,t,r,n,i,o){if(!1!==n.visible&&!n.isEdgeMaterial){!function(e){var t,r,n=e.geometry;if(n instanceof l.BufferGeometry)lt(n);else if(e instanceof l.Mesh){!0===n.groupsNeedUpdate&&Lt(e,n);for(var i=Pt[n.id],o=0,a=i.length;o<a;o++){var s=i[o];t=(r=tt(e,s)).attributes&&It(r),(n.verticesNeedUpdate||n.morphTargetsNeedUpdate||n.elementsNeedUpdate||n.uvsNeedUpdate||n.normalsNeedUpdate||n.colorsNeedUpdate||n.tangentsNeedUpdate||t)&&st(s,e,D.DYNAMIC_DRAW,!n.dynamic,r)}n.verticesNeedUpdate=!1,n.morphTargetsNeedUpdate=!1,n.elementsNeedUpdate=!1,n.uvsNeedUpdate=!1,n.normalsNeedUpdate=!1,n.colorsNeedUpdate=!1,n.tangentsNeedUpdate=!1,r.attributes&&Ot(r)}else e instanceof l.Line?(t=(r=tt(e,n)).attributes&&It(r),(n.verticesNeedUpdate||n.colorsNeedUpdate||n.lineDistancesNeedUpdate||t)&&function(e,t){var r,n,i,o,a,s,l,u,c,h,d,f,p=e.vertices,m=e.colors,g=e.lineDistances,v=p.length,y=m.length,b=g.length,x=e.__vertexArray,_=e.__colorArray,E=e.__lineDistanceArray,w=e.verticesNeedUpdate,A=e.colorsNeedUpdate,S=e.lineDistancesNeedUpdate,M=e.__webglCustomAttributesList;if(w){for(r=0;r<v;r++)o=p[r],x[a=3*r]=o.x,x[a+1]=o.y,x[a+2]=o.z;D.bindBuffer(D.ARRAY_BUFFER,e.__webglVertexBuffer),D.bufferData(D.ARRAY_BUFFER,x,t)}if(A){for(n=0;n<y;n++)s=m[n],_[a=3*n]=s.r,_[a+1]=s.g,_[a+2]=s.b;D.bindBuffer(D.ARRAY_BUFFER,e.__webglColorBuffer),D.bufferData(D.ARRAY_BUFFER,_,t)}if(S){for(i=0;i<b;i++)E[i]=g[i];D.bindBuffer(D.ARRAY_BUFFER,e.__webglLineDistanceBuffer),D.bufferData(D.ARRAY_BUFFER,E,t)}if(M)for(l=0,u=M.length;l<u;l++)if(ot(f=M[l])&&(void 0===f.boundTo||"vertices"===f.boundTo)){if(a=0,h=f.value.length,1===f.size)for(c=0;c<h;c++)f.array[c]=f.value[c];else if(2===f.size)for(c=0;c<h;c++)d=f.value[c],f.array[a]=d.x,f.array[a+1]=d.y,a+=2;else if(3===f.size)if("c"===f.type)for(c=0;c<h;c++)d=f.value[c],f.array[a]=d.r,f.array[a+1]=d.g,f.array[a+2]=d.b,a+=3;else for(c=0;c<h;c++)d=f.value[c],f.array[a]=d.x,f.array[a+1]=d.y,f.array[a+2]=d.z,a+=3;else if(4===f.size)for(c=0;c<h;c++)d=f.value[c],f.array[a]=d.x,f.array[a+1]=d.y,f.array[a+2]=d.z,f.array[a+3]=d.w,a+=4;D.bindBuffer(D.ARRAY_BUFFER,f.buffer),D.bufferData(D.ARRAY_BUFFER,f.array,t)}}(n,D.DYNAMIC_DRAW),n.verticesNeedUpdate=!1,n.colorsNeedUpdate=!1,n.lineDistancesNeedUpdate=!1,r.attributes&&Ot(r)):e instanceof l.PointCloud&&(t=(r=tt(e,n)).attributes&&It(r),(n.verticesNeedUpdate||n.colorsNeedUpdate||t)&&function(e,t){var r,n,i,o,a,s,l,u,c,h,d,f=e.vertices,p=e.colors,m=f.length,g=p.length,v=e.__vertexArray,y=e.__colorArray,b=e.verticesNeedUpdate,x=e.colorsNeedUpdate,_=e.__webglCustomAttributesList;if(b){for(r=0;r<m;r++)i=f[r],v[o=3*r]=i.x,v[o+1]=i.y,v[o+2]=i.z;D.bindBuffer(D.ARRAY_BUFFER,e.__webglVertexBuffer),D.bufferData(D.ARRAY_BUFFER,v,t)}if(x){for(n=0;n<g;n++)a=p[n],y[o=3*n]=a.r,y[o+1]=a.g,y[o+2]=a.b;D.bindBuffer(D.ARRAY_BUFFER,e.__webglColorBuffer),D.bufferData(D.ARRAY_BUFFER,y,t)}if(_)for(s=0,l=_.length;s<l;s++)if(ot(d=_[s])&&(void 0===d.boundTo||"vertices"===d.boundTo)){if(o=0,c=d.value.length,1===d.size)for(u=0;u<c;u++)d.array[u]=d.value[u];else if(2===d.size)for(u=0;u<c;u++)h=d.value[u],d.array[o]=h.x,d.array[o+1]=h.y,o+=2;else if(3===d.size)if("c"===d.type)for(u=0;u<c;u++)h=d.value[u],d.array[o]=h.r,d.array[o+1]=h.g,d.array[o+2]=h.b,o+=3;else for(u=0;u<c;u++)h=d.value[u],d.array[o]=h.x,d.array[o+1]=h.y,d.array[o+2]=h.z,o+=3;else if(4===d.size)for(u=0;u<c;u++)h=d.value[u],d.array[o]=h.x,d.array[o+1]=h.y,d.array[o+2]=h.z,d.array[o+3]=h.w,o+=4;D.bindBuffer(D.ARRAY_BUFFER,d.buffer),D.bufferData(D.ARRAY_BUFFER,d.array,t)}}(n,D.DYNAMIC_DRAW),n.verticesNeedUpdate=!1,n.colorsNeedUpdate=!1,r.attributes&&Ot(r))}(o);var a=Vt(e,t,r,n,o),s=a.attributes,u=!1,c=n.wireframe?1:0,h=i.id+"_"+a.id+"_"+c;if(h!==q&&(q=h,u=!0),u&&F.initAttributes(),!n.morphTargets&&s.position>=0&&u&&(D.bindBuffer(D.ARRAY_BUFFER,i.__webglVertexBuffer),F.enableAttribute(s.position),v(s.position,3,D.FLOAT,!1,0,0)),u){if(i.__webglCustomAttributesList)for(var d=0,f=i.__webglCustomAttributesList.length;d<f;d++){var p=i.__webglCustomAttributesList[d];s[p.buffer.belongsToAttribute]>=0&&(D.bindBuffer(D.ARRAY_BUFFER,p.buffer),F.enableAttribute(s[p.buffer.belongsToAttribute]),v(s[p.buffer.belongsToAttribute],p.size,D.FLOAT,!1,0,0))}s.color>=0&&(o.geometry.colors.length>0||o.geometry.faces.length>0?(D.bindBuffer(D.ARRAY_BUFFER,i.__webglColorBuffer),F.enableAttribute(s.color),v(s.color,3,D.FLOAT,!1,0,0)):n.defaultAttributeValues&&D.vertexAttrib3fv(s.color,n.defaultAttributeValues.color)),s.normal>=0&&(D.bindBuffer(D.ARRAY_BUFFER,i.__webglNormalBuffer),F.enableAttribute(s.normal),v(s.normal,3,D.FLOAT,!1,0,0)),s.tangent>=0&&(D.bindBuffer(D.ARRAY_BUFFER,i.__webglTangentBuffer),F.enableAttribute(s.tangent),v(s.tangent,4,D.FLOAT,!1,0,0)),s.uv>=0&&(o.geometry.faceVertexUvs[0]?(D.bindBuffer(D.ARRAY_BUFFER,i.__webglUVBuffer),F.enableAttribute(s.uv),v(s.uv,2,D.FLOAT,!1,0,0)):n.defaultAttributeValues&&D.vertexAttrib2fv(s.uv,n.defaultAttributeValues.uv)),s.uv2>=0&&(o.geometry.faceVertexUvs[1]?(D.bindBuffer(D.ARRAY_BUFFER,i.__webglUV2Buffer),F.enableAttribute(s.uv2),v(s.uv2,2,D.FLOAT,!1,0,0)):n.defaultAttributeValues&&D.vertexAttrib2fv(s.uv2,n.defaultAttributeValues.uv2)),s.lineDistance>=0&&(D.bindBuffer(D.ARRAY_BUFFER,i.__webglLineDistanceBuffer),F.enableAttribute(s.lineDistance),v(s.lineDistance,1,D.FLOAT,!1,0,0))}if(F.disableUnusedAttributes(),o instanceof l.Mesh){var m=i.__typeArray===Uint32Array?D.UNSIGNED_INT:D.UNSIGNED_SHORT;n.wireframe?(k.setLineWidth(n.wireframeLinewidth*this.getPixelRatio()),u&&D.bindBuffer(D.ELEMENT_ARRAY_BUFFER,i.__webglLineBuffer),D.drawElements(D.LINES,i.__webglLineCount,m,0)):(u&&D.bindBuffer(D.ELEMENT_ARRAY_BUFFER,i.__webglFaceBuffer),D.drawElements(D.TRIANGLES,i.__webglFaceCount,m,0))}else if(o instanceof l.Line){var g=o.mode===l.LineStrip?D.LINE_STRIP:D.LINES;k.setLineWidth(n.linewidth*this.getPixelRatio()),D.drawArrays(g,0,i.__webglLineCount)}else o instanceof l.PointCloud&&D.drawArrays(D.POINTS,0,i.__webglPointCount)}function v(e,t,r,n,i,o){D.vertexAttribPointer(e,t,r,n,i,o),I&&I.vertexAttribDivisorANGLE(e,0)}},this.render=function(e,t,r,n){var i,o,s,u,c,h=r,d=n;if(arguments.length>2&&(r instanceof l.WebGLRenderTarget||Array.isArray(r))&&(console.warn("THREE.WebGLRenderer.render(): the renderTarget argument has been removed. Use .setRenderTarget() instead."),c=r,h=n,d=arguments[4]),t instanceof l.Camera!=!1){if(!D.isContextLost()){q="",W=-1,j=null,void 0!==d&&(A.length=0,le=!0);var f=e.fog;!0===e.autoUpdate&&e.updateMatrixWorld(),void 0!==t.parent&&null!==t.parent||t.updateMatrixWorld(),t.worldUpTransform?oe.multiplyMatrices(t.worldUpTransform,t.matrixWorld):oe.copy(t.matrixWorld),ie.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),ne.setFromProjectionMatrix(ie);var p=e instanceof a.RenderBatch&&e.renderImmediate;if(p||(C.length=0,P.length=0,xt(e,!0===V.sortObjects,!0===e.forceVisible),!0===V.sortObjects&&(C.sort(vt),P.sort(gt))),le&&(d&&d.length&&(A=d.slice()),Ht(A)),void 0!==c&&this.setRenderTarget(c),this.resetGLState(),(this.autoClear||h)&&this.clear(this.autoClearColor,this.autoClearDepth,this.autoClearStencil),e.overrideMaterial){var m=e.overrideMaterial;Ft(m),p?Tt(e,"",t,A,f,m):(wt(C,t,A,f,m),wt(P,t,A,f,m))}else p?Tt(e,"",t,A,f,null):(k.setBlending(l.NoBlending),wt(C,t,A,f,null),wt(P,t,A,f,null));if(e.edgeMaterial){D.depthFunc(D.LESS);var g=e.edgeMaterial;Ft(g),p?Tt(e,"",t,A,f,g):(wt(C,t,A,f,g),wt(P,t,A,f,g)),D.depthFunc(D.LEQUAL)}!H&&null!==(i=G)&&void 0!==i&&null!==(o=i.texture)&&void 0!==o&&o.generateMipmaps&&(null===(s=G)||void 0===s?void 0:s.texture.minFilter)!==l.NearestFilter&&(null===(u=G)||void 0===u?void 0:u.texture.minFilter)!==l.LinearFilter&&Zt(G),this.resetGLState(),k.setDepthTest(!0),k.setDepthWrite(!0)}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.setProgramPrefix=function(e,t,r){X=e,Y=t,K=r},this.getProgramPrefix=function(){return{programPrefix:X,vertexPrefix:Y,fragmentPrefix:K}};var Pt={},Dt=0;function Lt(e,t){var r=e.material,n=!1;void 0!==Pt[t.id]&&!0!==t.groupsNeedUpdate||(delete S[e.id],Pt[t.id]=function(e,t){for(var r,n,i=L||N.get("OES_element_index_uint")?4294967296:65535,o={},a=e.morphTargets?e.morphTargets.length:0,s=e.morphNormals?e.morphNormals.length:0,l={},u=[],c=0,h=e.faces.length;c<h;c++){var d=e.faces[c],f=t?d.materialIndex:0;f in o||(o[f]={hash:f,counter:0}),(r=o[f].hash+"_"+o[f].counter)in l||(n={id:Dt++,faces3:[],materialIndex:f,vertices:0,numMorphTargets:a,numMorphNormals:s},l[r]=n,u.push(n)),l[r].vertices+3>i&&(o[f].counter+=1,(r=o[f].hash+"_"+o[f].counter)in l||(n={id:Dt++,faces3:[],materialIndex:f,vertices:0,numMorphTargets:a,numMorphNormals:s},l[r]=n,u.push(n))),l[r].faces3.push(c),l[r].vertices+=3}return u}(t,r instanceof l.MeshFaceMaterial),t.groupsNeedUpdate=!1);for(var i=Pt[t.id],o=0,a=i.length;o<a;o++){var s=i[o];void 0===s.__webglVertexBuffer?(Ve(s),et(s,e),t.verticesNeedUpdate=!0,t.morphTargetsNeedUpdate=!0,t.elementsNeedUpdate=!0,t.uvsNeedUpdate=!0,t.normalsNeedUpdate=!0,t.tangentsNeedUpdate=!0,t.colorsNeedUpdate=!0,n=!0):n=!1,(n||void 0===e.__webglActive)&&Rt(S,s,e)}e.__webglActive=!0}function Rt(e,t,r){var n=r.id;e[n]=e[n]||[],e[n].push({id:n,buffer:t,object:r,material:null,z:0})}function It(e){for(var t in e.attributes)if(ot(e.attributes[t]))return!0;return!1}function Ot(e){for(var t in e.attributes)at(e.attributes[t])}var Nt={MeshDepthMaterial:"depth",MeshNormalMaterial:"normal",MeshLambertMaterial:"lambert",LineDashedMaterial:"dashed",MeshBasicMaterial:"firefly_basic",LineBasicMaterial:"firefly_basic",PointCloudMaterial:"firefly_basic",PointsMaterial:"firefly_basic",MeshPhongMaterial:"firefly_phong"};function kt(e,t,r,i){e.addEventListener("dispose",He);var o=Nt[e.type];if(o){var a=l.ShaderLib[o],u=l.UniformsUtils.clone(a.uniforms);e.uniforms&&(u=l.UniformsUtils.merge([u,e.uniforms])),e.__webglShader={uniforms:u,vertexShader:a.vertexShader,fragmentShader:a.fragmentShader}}else e.__webglShader={uniforms:e.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader};var c,h,d=function(e){for(var t=0,r=0,n=0,i=0,o=0,a=e.length;o<a;o++){var s=e[o];s.onlyShadow||(s instanceof l.DirectionalLight&&t++,s instanceof l.PointLight&&r++,s instanceof l.SpotLight&&n++,s instanceof l.HemisphereLight&&i++)}return{directional:t,point:r,spot:n,hemi:i}}(t),f={vertexShader:e.__webglShader.vertexShader,fragmentShader:e.__webglShader.fragmentShader,precision:s,precisionFragment:g,supportsVertexTextures:we,haveTextureLod:L||!!N.get("EXT_shader_texture_lod"),loadingAnimationDuration:-1,map:!!e.map,envMap:!!e.envMap,irradianceMap:!!e.irradianceMap,envIsSpherical:e.envMap&&e.envMap.mapping==l.SphericalReflectionMapping,envGammaEncoded:e.envMap&&e.envMap.GammaEncoded,irrGammaEncoded:e.irradianceMap&&e.irradianceMap.GammaEncoded,envRGBM:e.envMap&&e.envMap.RGBM,irrRGBM:e.irradianceMap&&e.irradianceMap.RGBM,lightMap:!!e.lightMap,bumpMap:(L||N.get("OES_standard_derivatives"))&&!!e.bumpMap,normalMap:(L||N.get("OES_standard_derivatives"))&&!!e.normalMap,specularMap:!!e.specularMap,alphaMap:!!e.alphaMap,vertexColors:e.vertexColors,vertexIds:e.vertexIds,useInstancing:e.useInstancing,wideLines:e.wideLines,fog:r,useFog:e.fog,useBackgroundTexture:e.useBackgroundTexture,sizeAttenuation:e.sizeAttenuation,maxDirLights:d.directional,maxPointLights:d.point,maxSpotLights:d.spot,maxHemiLights:d.hemi,alphaTest:e.alphaTest,metal:e.metal,clearcoat:e.clearcoat,wrapAround:e.wrapAround,doubleSided:e.side===l.DoubleSide,flipSided:e.side===l.BackSide,mrtNormals:e.mrtNormals,mrtIdBuffer:e.mrtIdBuffer,vertexPrefix:Y,fragmentPrefix:K,tonemapOutput:e.tonemapOutput,packedNormals:e.packedNormals,hatchPattern:!!e.hatchParams,numCutplanes:e.cutplanes?e.cutplanes.length:0,useTiling:e.useTiling,tilingRepeatRange:e.useTiling&&e.tilingRepeatRange,hasRoundCorner:e.hasRoundCorner,useRandomOffset:e.useRandomOffset,mapInvert:e.map&&e.map.invert,mapClampS:e.map&&e.map.clampS,mapClampT:e.map&&e.map.clampT,bumpMapClampS:e.bumpMap&&e.bumpMap.clampS,bumpMapClampT:e.bumpMap&&e.bumpMap.clampT,normalMapClampS:e.normalMap&&e.normalMap.clampS,normalMapClampT:e.normalMap&&e.normalMap.clampT,specularMapClampS:e.specularMap&&e.specularMap.clampS,specularMapClampT:e.specularMap&&e.specularMap.clampT,alphaMapInvert:e.alphaMap&&e.alphaMap.invert,alphaMapClampS:e.alphaMap&&e.alphaMap.clampS,alphaMapClampT:e.alphaMap&&e.alphaMap.clampT},p=[];for(var m in o?p.push(o):(p.push(e.fragmentShader),p.push(e.vertexShader)),e.defines)p.push(m),p.push(e.defines[m]);for(c in f)p.push(c),p.push(f[c]);var v,y=p.join();for(c=0,h=U.length;c<h;c++){var b=U[c];if(b.code===y){(v=b).usedTimes++;break}}for(var x in void 0===v&&(e.onBeforeCompile(f,V),v=new n.WebGLProgram(V,y,e,f,i.geometry),U.push(v),V.info.memory.programs=U.length),e.programs||(e.programs=[]),e.programs[X]=v,e.uniformsLists||(e.uniformsLists=[]),e.uniformsList=e.uniformsLists[X]=[],e.__webglShader.uniforms){var _=v.uniforms[x];_&&e.uniformsList.push([e.__webglShader.uniforms[x],_])}}function Ft(e){!0===e.transparent?k.setBlending(e.blending,e.blendEquation,e.blendSrc,e.blendDst,e.blendEquationAlpha,e.blendSrcAlpha,e.blendDstAlpha):k.setBlending(l.NoBlending),k.setDepthTest(e.depthTest),k.setDepthWrite(e.depthWrite),k.setPolygonOffset(e.polygonOffset,e.polygonOffsetFactor,e.polygonOffsetUnits)}function Vt(e,t,r,n,o){Z=0,V.lostContextRecovery&&V.lostContextRecovery.refreshIfNeeded(n),ot(n)?(n.program&&Je(n),kt(n,t,r,o),at(n)):n.programs&&n.programs[X]||kt(n,t,r,o);var a=!1,s=!1,u=!1;n.uniformsList=n.uniformsLists[X];var c,f=n.program=n.programs[X],m=f.uniforms,g=n.__webglShader.uniforms;if(f.id!==B&&(D.useProgram(f.program),B=f.id,a=!0,s=!0,u=!0),n.id!==W&&(-1===W&&(u=!0),W=n.id,s=!0),m.meshAnimTime){var v=1;o.geometry.creationTime,0,D.uniform1f(m.meshAnimTime,v)}if((a||e!==j)&&(D.uniformMatrix4fv(m.projectionMatrix,!1,e.projectionMatrix.elements),e!==j&&(j=e),(n instanceof l.ShaderMaterial||n instanceof l.MeshPhongMaterial&&!n.isLmvMaterial||n.envMap)&&null!==m.cameraPosition&&(ae.setFromMatrixPosition(e.matrixWorld),D.uniform3f(m.cameraPosition,ae.x,ae.y,ae.z)),(n instanceof l.MeshPhongMaterial&&!n.isLmvMaterial||n instanceof l.MeshLambertMaterial||n instanceof l.ShaderMaterial||n.skinning)&&(null!==m.viewMatrix&&D.uniformMatrix4fv(m.viewMatrix,!1,e.matrixWorldInverse.elements),null!==m.viewMatrixInverse&&D.uniformMatrix4fv(m.viewMatrixInverse,!1,oe.elements),m.mvpMatrix&&D.uniformMatrix4fv(m.mvpMatrix,!1,ie.elements),u?(h(g,n),d(g,!0)):d(g,!1))),m.unpackXform){var y=o.geometry,b=y.unpackXform;if(b?D.uniform4f(m.unpackXform,b.x,b.y,b.z,b.w):D.uniform4f(m.unpackXform,1,1,0,0),m.tIdColor){D.uniform2f(m.vIdColorTexSize,y.vIdColorTexSize.x,y.vIdColorTexSize.y);var x=zt();D.uniform1i(m.tIdColor,x),V.setTexture(y.tIdColor,x)}}if(s){if((n instanceof l.MeshPhongMaterial&&!n.isLmvMaterial||n instanceof l.MeshLambertMaterial||n.lights)&&(le&&(u=!0,Ht(t),le=!1),u?(!function(e,t){e.ambientLightColor.value=t.ambient,e.directionalLightColor.value=t.directional.colors,e.directionalLightDirection.value=t.directional.positions,e.pointLightColor.value=t.point.colors,e.pointLightPosition.value=t.point.positions,e.pointLightDistance.value=t.point.distances,e.spotLightColor.value=t.spot.colors,e.spotLightPosition.value=t.spot.positions,e.spotLightDistance.value=t.spot.distances,e.spotLightDirection.value=t.spot.directions,e.spotLightAngleCos.value=t.spot.anglesCos,e.spotLightExponent.value=t.spot.exponents,e.hemisphereLightSkyColor.value=t.hemi.skyColors,e.hemisphereLightGroundColor.value=t.hemi.groundColors,e.hemisphereLightDirection.value=t.hemi.positions}(g,ue),Bt(g,!0)):Bt(g,!1)),(n instanceof l.MeshBasicMaterial&&!n.isLmvMaterial||n instanceof l.MeshLambertMaterial||n instanceof l.MeshPhongMaterial&&!n.isLmvMaterial)&&(!function(e,t){e.opacity.value=t.opacity,e.diffuse.value.copy(t.color),e.map.value=t.map,e.lightMap.value=t.lightMap,e.specularMap.value=t.specularMap,e.alphaMap.value=t.alphaMap,t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale);t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale));function r(e,t,r){var n=r.offset,i=r.repeat;if(t){var o=t.value;r.matrix?o.copy(r.matrix):o.identity(),o.elements[6]+=n.x,o.elements[7]+=n.y,o.elements[0]*=i.x,o.elements[3]*=i.x,o.elements[1]*=i.y,o.elements[4]*=i.y}else e.offsetRepeat.value.set(n.x,n.y,i.x,i.y)}t.alphaMap&&r(e,e.texMatrixAlpha,t.alphaMap);var n,i;t.normalMap?n=t.normalMap:t.bumpMap&&(n=t.bumpMap);void 0!==n&&r(e,e.texMatrixBump,n);t.map?i=t.map:t.specularMap&&(i=t.specularMap);void 0!==i&&r(e,e.texMatrix,i);e.envMap.value=t.envMap,e.irradianceMap&&(e.irradianceMap.value=t.irradianceMap);e.reflectivity.value=t.reflectivity,e.refractionRatio.value=t.refractionRatio}(g,n),h(g,n)),(n instanceof l.PointCloudMaterial||n instanceof l.PointsMaterial)&&!n.isLmvMaterial?function(e,t){Ut(e,t),e.point_size.value=t.size,e.map.value=t.map}(g,n):n instanceof l.LineBasicMaterial&&!n.isLmvMaterial?Ut(g,n):n instanceof l.LineDashedMaterial?(Ut(g,n),function(e,t){e.dashSize.value=t.dashSize,e.totalSize.value=t.dashSize+t.gapSize,e.scale.value=t.scale}(g,n)):n instanceof l.MeshPhongMaterial&&!n.isLmvMaterial?function(e,t){if(e.shininess.value=t.shininess,e.reflMipIndex){var r=Math.log(Math.max(1+1e-10,t.shininess));e.reflMipIndex.value=Math.max(0,-.72134752*r+5.5)}e.emissive&&e.emissive.value.copy(t.emissive);e.specular.value.copy(t.specular),e.exposureBias&&(e.exposureBias.value=t.exposureBias)}(g,n):n instanceof l.MeshLambertMaterial?function(e,t){e.emissive.value.copy(t.emissive),t.wrapAround&&e.wrapRGB.value.copy(t.wrapRGB)}(g,n):n instanceof l.MeshDepthMaterial?(g.mNear.value=e.near,g.mFar.value=e.far,g.opacity.value=n.opacity):n instanceof l.MeshNormalMaterial?g.opacity.value=n.opacity:"function"==typeof n.refreshUniforms&&n.refreshUniforms(g),n.wideLines){var _=o.geometry.lineWidth;void 0!==n.linewidth&&(_=n.linewidth),g.view_size.value=new l.Vector2(p.innerWidth/_,p.innerHeight/_)}i.ShadowRender&&n.shadowMap&&i.ShadowRender.RefreshUniformsShadow(g,n);var E=g.cutplanes;n.cutplanes&&n.cutplanes.length>0&&E&&(E.value=n.cutplanes,E._array&&E._array.length!=4*n.cutplanes&&(E._array=void 0)),n.hatchParams&&g.hatchParams&&(g.hatchParams.value.copy(n.hatchParams),g.hatchTintColor.value.copy(n.hatchTintColor),g.hatchTintIntensity.value=n.hatchTintIntensity),function(e){for(var t,r,n,i=0,o=e.length;i<o;i++){var a=e[i][0];if(!1!==a.needsUpdate&&!a.perObject){var s,u,c=a.type,h=a.value,d=e[i][1];switch(c){case"1i":case"i":D.uniform1i(d,h);break;case"1f":case"f":D.uniform1f(d,h);break;case"2f":D.uniform2f(d,h[0],h[1]);break;case"3f":D.uniform3f(d,h[0],h[1],h[2]);break;case"4f":D.uniform4f(d,h[0],h[1],h[2],h[3]);break;case"1iv":case"iv1":D.uniform1iv(d,h);break;case"3iv":case"iv":D.uniform3iv(d,h);break;case"1fv":case"fv1":D.uniform1fv(d,h);break;case"2fv":D.uniform2fv(d,h);break;case"3fv":case"fv":D.uniform3fv(d,h);break;case"4fv":D.uniform4fv(d,h);break;case"Matrix3fv":D.uniformMatrix3fv(d,!1,h);break;case"Matrix4fv":D.uniformMatrix4fv(d,!1,h);break;case"v2":D.uniform2f(d,h.x,h.y);break;case"v3":D.uniform3f(d,h.x,h.y,h.z);break;case"v4":D.uniform4f(d,h.x,h.y,h.z,h.w);break;case"c":D.uniform3f(d,h.r,h.g,h.b);break;case"v2v":for(void 0===a._array&&(a._array=new Float32Array(2*h.length)),s=0,u=h.length;s<u;s++)n=2*s,a._array[n]=h[s].x,a._array[n+1]=h[s].y;D.uniform2fv(d,a._array);break;case"v3v":for(void 0===a._array&&(a._array=new Float32Array(3*h.length)),s=0,u=h.length;s<u;s++)n=3*s,a._array[n]=h[s].x,a._array[n+1]=h[s].y,a._array[n+2]=h[s].z;D.uniform3fv(d,a._array);break;case"v4v":for(void 0===a._array&&(a._array=new Float32Array(4*h.length)),s=0,u=h.length;s<u;s++)n=4*s,a._array[n]=h[s].x,a._array[n+1]=h[s].y,a._array[n+2]=h[s].z,a._array[n+3]=h[s].w;D.uniform4fv(d,a._array);break;case"m3":D.uniformMatrix3fv(d,!1,h.elements);break;case"m3v":for(void 0===a._array&&(a._array=new Float32Array(9*h.length)),s=0,u=h.length;s<u;s++)h[s].flattenToArrayOffset(a._array,9*s);D.uniformMatrix3fv(d,!1,a._array);break;case"m4":D.uniformMatrix4fv(d,!1,h.elements);break;case"m4v":for(void 0===a._array&&(a._array=new Float32Array(16*h.length)),s=0,u=h.length;s<u;s++)h[s].flattenToArrayOffset(a._array,16*s);D.uniformMatrix4fv(d,!1,a._array);break;case"t":if(t=h,r=zt(),D.uniform1i(d,r),!t){D.activeTexture(D.TEXTURE0+r),D.bindTexture(D.TEXTURE_2D,ye.__webglTexture);continue}V.lostContextRecovery&&V.lostContextRecovery.refreshIfNeeded(t),Array.isArray(t.image)&&6===t.image.length||t instanceof l.CubeTexture?ot(t)?qt(t,r):(D.activeTexture(D.TEXTURE0+r),D.bindTexture(D.TEXTURE_CUBE_MAP,t.__webglTextureCube)):t instanceof l.WebGLRenderTargetCube?Xt(t,r):V.setTexture(t,r);break;case"tv":for(void 0===a._array&&(a._array=[]),s=0,u=a.value.length;s<u;s++)a._array[s]=zt();for(D.uniform1iv(d,a._array),s=0,u=a.value.length;s<u;s++)t=a.value[s],r=a._array[s],t&&(V.lostContextRecovery&&V.lostContextRecovery.refreshIfNeeded(t),V.setTexture(t,r));break;default:console.warn("THREE.WebGLRenderer: Unknown uniform type: "+c)}}}}(n.uniformsList)}if(function(e,t,r){M.multiplyMatrices(r.matrixWorldInverse,t.matrixWorld),D.uniformMatrix4fv(e.modelViewMatrix,!1,M.elements),e.normalMatrix&&(T.getNormalMatrix(M),D.uniformMatrix3fv(e.normalMatrix,!1,T.elements));null!==e.modelMatrix&&D.uniformMatrix4fv(e.modelMatrix,!1,t.matrixWorld.elements);e.modelLocalMatrix&&D.uniformMatrix4fv(e.modelLocalMatrix,!1,t.matrix.elements)}(m,o,e),m.modelId){m.dbId&&(c=o.dbId||o.fragId||0,D.uniform3f(m.dbId,(255&c)/255,(c>>8&255)/255,(c>>16&255)/255));var w=o.modelId;D.uniform3f(m.modelId,(255&w)/255,(w>>8&255)/255,(c>>24&255)/255)}else null!==m.dbId&&(c=o.dbId||o.fragId||0,D.uniform3f(m.dbId,(255&c)/255,(c>>8&255)/255,(c>>16&255)/255));if(m.themingColor){var A=o.themingColor;A instanceof l.Vector4?D.uniform4f(m.themingColor,A.x,A.y,A.z,A.w):D.uniform4f(m.themingColor,0,0,0,0)}return f}function Ut(e,t){e.diffuse.value=t.color,e.opacity.value=t.opacity}function Bt(e,t){e.ambientLightColor.needsUpdate=t,e.directionalLightColor.needsUpdate=t,e.directionalLightDirection.needsUpdate=t,e.pointLightColor.needsUpdate=t,e.pointLightPosition.needsUpdate=t,e.pointLightDistance.needsUpdate=t,e.spotLightColor.needsUpdate=t,e.spotLightPosition.needsUpdate=t,e.spotLightDistance.needsUpdate=t,e.spotLightDirection.needsUpdate=t,e.spotLightAngleCos.needsUpdate=t,e.spotLightExponent.needsUpdate=t,e.hemisphereLightSkyColor.needsUpdate=t,e.hemisphereLightGroundColor.needsUpdate=t,e.hemisphereLightDirection.needsUpdate=t}function zt(){var e=Z;return e>=be&&console.warn("WebGLRenderer: trying to use "+e+" texture units while this GPU supports only "+be),Z+=1,e}function Gt(e,t,r,n){e[t]=r.r*n,e[t+1]=r.g*n,e[t+2]=r.b*n}function Ht(e){var t,r,n,i,o,a,s,u,c=0,h=0,d=0,f=ue,p=f.directional.colors,m=f.directional.positions,g=f.point.colors,v=f.point.positions,y=f.point.distances,b=f.spot.colors,x=f.spot.positions,_=f.spot.distances,E=f.spot.directions,w=f.spot.anglesCos,A=f.spot.exponents,S=f.hemi.skyColors,M=f.hemi.groundColors,T=f.hemi.positions,C=0,P=0,D=0,L=0,R=0,I=0,O=0,N=0,k=0,F=0,V=0,U=0;for(t=0,r=e.length;t<r;t++)if(!(n=e[t]).onlyShadow)if(i=n.color,s=n.intensity,u=n.distance,n instanceof l.AmbientLight){if(!n.visible)continue;c+=i.r,h+=i.g,d+=i.b}else if(n instanceof l.DirectionalLight){if(R+=1,!n.visible)continue;se.setFromMatrixPosition(n.matrixWorld),ae.setFromMatrixPosition(n.target.matrixWorld),se.sub(ae),se.normalize(),m[k=3*C]=se.x,m[k+1]=se.y,m[k+2]=se.z,Gt(p,k,i,s),C+=1}else if(n instanceof l.PointLight){if(I+=1,!n.visible)continue;Gt(g,F=3*P,i,s),ae.setFromMatrixPosition(n.matrixWorld),v[F]=ae.x,v[F+1]=ae.y,v[F+2]=ae.z,y[P]=u,P+=1}else if(n instanceof l.SpotLight){if(O+=1,!n.visible)continue;Gt(b,V=3*D,i,s),ae.setFromMatrixPosition(n.matrixWorld),x[V]=ae.x,x[V+1]=ae.y,x[V+2]=ae.z,_[D]=u,se.copy(ae),ae.setFromMatrixPosition(n.target.matrixWorld),se.sub(ae),se.normalize(),E[V]=se.x,E[V+1]=se.y,E[V+2]=se.z,w[D]=Math.cos(n.angle),A[D]=n.exponent,D+=1}else if(n instanceof l.HemisphereLight){if(N+=1,!n.visible)continue;se.setFromMatrixPosition(n.matrixWorld),se.normalize(),T[U=3*L]=se.x,T[U+1]=se.y,T[U+2]=se.z,o=n.color,a=n.groundColor,Gt(S,U,o,s),Gt(M,U,a,s),L+=1}for(t=3*C,r=Math.max(p.length,3*R);t<r;t++)p[t]=0;for(t=3*P,r=Math.max(g.length,3*I);t<r;t++)g[t]=0;for(t=3*D,r=Math.max(b.length,3*O);t<r;t++)b[t]=0;for(t=3*L,r=Math.max(S.length,3*N);t<r;t++)S[t]=0;for(t=3*L,r=Math.max(M.length,3*N);t<r;t++)M[t]=0;f.directional.length=C,f.point.length=P,f.spot.length=D,f.hemi.length=L,f.ambient[0]=c,f.ambient[1]=h,f.ambient[2]=d}function Wt(e,t,r){var n;r?(D.texParameteri(e,D.TEXTURE_WRAP_S,$t(t.wrapS)),D.texParameteri(e,D.TEXTURE_WRAP_T,$t(t.wrapT)),D.texParameteri(e,D.TEXTURE_MAG_FILTER,$t(t.magFilter)),D.texParameteri(e,D.TEXTURE_MIN_FILTER,$t(t.minFilter))):(D.texParameteri(e,D.TEXTURE_WRAP_S,D.CLAMP_TO_EDGE),D.texParameteri(e,D.TEXTURE_WRAP_T,D.CLAMP_TO_EDGE),t.wrapS===l.ClampToEdgeWrapping&&t.wrapT===l.ClampToEdgeWrapping||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping. ( "+t.sourceFile+" )"),D.texParameteri(e,D.TEXTURE_MAG_FILTER,Qt(t.magFilter)),D.texParameteri(e,D.TEXTURE_MIN_FILTER,Qt(t.minFilter)),t.minFilter!==l.NearestFilter&&t.minFilter!==l.LinearFilter&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter. ( "+t.sourceFile+" )")),(n=N.get("EXT_texture_filter_anisotropic"))&&t.type!==l.FloatType&&t.type!==l.HalfFloatType&&(t.anisotropy>1||t.__oldAnisotropy)&&(D.texParameterf(e,n.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(t.anisotropy,V.getMaxAnisotropy())),t.__oldAnisotropy=t.anisotropy)}function jt(e,t){if(e.width<=t&&e.height<=t)return e;if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap){var r=t/Math.max(e.width,e.height),n=Math.max(Math.floor(e.width*r),1),i=Math.max(Math.floor(e.height*r),1),o=m.createElement("canvas");return o.width=n,o.height=i,o.getContext("2d").drawImage(e,0,0,e.width,e.height,0,0,n,i),o}return"data"in e&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+e.width+"x"+e.height+")."),e}function qt(e,t){if(6===e.image.length)if(ot(e)){e.__webglTextureCube||(e.addEventListener("dispose",ze),e.__webglTextureCube=D.createTexture(),V.info.memory.textures++),D.activeTexture(D.TEXTURE0+t),D.bindTexture(D.TEXTURE_CUBE_MAP,e.__webglTextureCube),D.pixelStorei(D.UNPACK_FLIP_Y_WEBGL,e.flipY);var r,n=e instanceof l.CompressedTexture,i=e.image[0]instanceof l.DataTexture,o=[];for(r=0;r<6;r++)!V.autoScaleCubemaps||n||i?o[r]=i?e.image[r].image:e.image[r]:o[r]=jt(e.image[r],Ee);var a=o[0],s=l.Math.isPowerOfTwo(a.width)&&l.Math.isPowerOfTwo(a.height),u=$t(e.format),c=$t(e.type);for(Wt(D.TEXTURE_CUBE_MAP,e,s),r=0;r<6;r++)if(n)for(var h,d=o[r].mipmaps,f=0,p=d.length;f<p;f++)h=d[f],e.format!==l.RGBAFormat&&e.format!==l.RGBFormat?Ie().indexOf(u)>-1?D.compressedTexImage2D(D.TEXTURE_CUBE_MAP_POSITIVE_X+r,f,u,h.width,h.height,0,h.data):console.warn("Attempt to load unsupported compressed texture format"):D.texImage2D(D.TEXTURE_CUBE_MAP_POSITIVE_X+r,f,u,h.width,h.height,0,u,c,h.data);else i?D.texImage2D(D.TEXTURE_CUBE_MAP_POSITIVE_X+r,0,u,o[r].width,o[r].height,0,u,c,o[r].data):D.texImage2D(D.TEXTURE_CUBE_MAP_POSITIVE_X+r,0,u,u,c,o[r]);e.generateMipmaps&&s&&D.generateMipmap(D.TEXTURE_CUBE_MAP),at(e),e.onUpdate&&e.onUpdate()}else D.activeTexture(D.TEXTURE0+t),D.bindTexture(D.TEXTURE_CUBE_MAP,e.__webglTextureCube)}function Xt(e,t){D.activeTexture(D.TEXTURE0+t),D.bindTexture(D.TEXTURE_CUBE_MAP,e.__webglTexture)}function Yt(e){var t=L?D.COLOR_ATTACHMENT0:R.COLOR_ATTACHMENT0_WEBGL,r=[t];for(Pe=1;Pe<e.length;Pe++)r.push(t+Pe);L?D.drawBuffers(r):R.drawBuffersWEBGL(r)}function Kt(e){var t=l.Math.isPowerOfTwo(e.width)&&l.Math.isPowerOfTwo(e.height),r=$t(e.texture.format),n=$t(e.texture.type),i=Jt(e.texture.format,e.texture.type);e.addEventListener("dispose",Ge),e.__webglTexture=D.createTexture(),V.info.memory.textures++,D.bindTexture(D.TEXTURE_2D,e.__webglTexture),Wt(D.TEXTURE_2D,e.texture,t),D.texImage2D(D.TEXTURE_2D,0,i,e.width,e.height,0,r,n,null),t&&e.texture.generateMipmaps&&D.generateMipmap(D.TEXTURE_2D)}function Zt(e){D.bindTexture(D.TEXTURE_2D,e.__webglTexture),D.generateMipmap(D.TEXTURE_2D),D.bindTexture(D.TEXTURE_2D,null)}function Qt(e){return e===l.NearestFilter||e===l.NearestMipMapNearestFilter||e===l.NearestMipMapLinearFilter?D.NEAREST:D.LINEAR}function Jt(e,t){if(L){if(e===l.RGBFormat)switch(t){case l.UnsignedByteType:return D.RGB8;case l.FloatType:return D.RGB32F;case l.HalfFloatType:return D.RGB16F}else if(e===l.RGBAFormat)switch(t){case l.UnsignedByteType:return D.RGBA8;case l.FloatType:return D.RGBA32F;case l.HalfFloatType:return D.RGBA16F}else if(e===l.LuminanceFormat&&t===l.UnsignedByteType)return D.LUMINANCE;console.error("failed to map texture format and type to internalformat")}return $t(e)}function $t(e){var t;if(e===l.RepeatWrapping)return D.REPEAT;if(e===l.ClampToEdgeWrapping)return D.CLAMP_TO_EDGE;if(e===l.MirroredRepeatWrapping)return D.MIRRORED_REPEAT;if(e===l.NearestFilter)return D.NEAREST;if(e===l.NearestMipMapNearestFilter)return D.NEAREST_MIPMAP_NEAREST;if(e===l.NearestMipMapLinearFilter)return D.NEAREST_MIPMAP_LINEAR;if(e===l.LinearFilter)return D.LINEAR;if(e===l.LinearMipMapNearestFilter)return D.LINEAR_MIPMAP_NEAREST;if(e===l.LinearMipMapLinearFilter)return D.LINEAR_MIPMAP_LINEAR;if(e===l.UnsignedByteType)return D.UNSIGNED_BYTE;if(e===l.UnsignedShort4444Type)return D.UNSIGNED_SHORT_4_4_4_4;if(e===l.UnsignedShort5551Type)return D.UNSIGNED_SHORT_5_5_5_1;if(e===l.UnsignedShort565Type)return D.UNSIGNED_SHORT_5_6_5;if(e===l.ByteType)return D.BYTE;if(e===l.ShortType)return D.SHORT;if(e===l.UnsignedShortType)return D.UNSIGNED_SHORT;if(e===l.IntType)return D.INT;if(e===l.UnsignedIntType)return D.UNSIGNED_INT;if(e===l.FloatType)return D.FLOAT;if(e===l.HalfFloatType)return L?D.HALF_FLOAT:36193;if(e===l.AlphaFormat)return D.ALPHA;if(e===l.RGBFormat)return D.RGB;if(e===l.RGBAFormat)return D.RGBA;if(e===l.LuminanceFormat)return D.LUMINANCE;if(e===l.LuminanceAlphaFormat)return D.LUMINANCE_ALPHA;if(e===l.AddEquation)return D.FUNC_ADD;if(e===l.MinEquation)return D.MIN;if(e===l.MaxEquation)return D.MAX;if(e===l.SubtractEquation)return D.FUNC_SUBTRACT;if(e===l.ReverseSubtractEquation)return D.FUNC_REVERSE_SUBTRACT;if(e===l.ZeroFactor)return D.ZERO;if(e===l.OneFactor)return D.ONE;if(e===l.SrcColorFactor)return D.SRC_COLOR;if(e===l.OneMinusSrcColorFactor)return D.ONE_MINUS_SRC_COLOR;if(e===l.SrcAlphaFactor)return D.SRC_ALPHA;if(e===l.OneMinusSrcAlphaFactor)return D.ONE_MINUS_SRC_ALPHA;if(e===l.DstAlphaFactor)return D.DST_ALPHA;if(e===l.OneMinusDstAlphaFactor)return D.ONE_MINUS_DST_ALPHA;if(e===l.DstColorFactor)return D.DST_COLOR;if(e===l.OneMinusDstColorFactor)return D.ONE_MINUS_DST_COLOR;if(e===l.SrcAlphaSaturateFactor)return D.SRC_ALPHA_SATURATE;if(null!==(t=N.get("WEBGL_compressed_texture_s3tc"))){if(e===l.RGB_S3TC_DXT1_Format)return t.COMPRESSED_RGB_S3TC_DXT1_EXT;if(e===l.RGBA_S3TC_DXT1_Format)return t.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(e===l.RGBA_S3TC_DXT3_Format)return t.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(e===l.RGBA_S3TC_DXT5_Format)return t.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(null!==(t=N.get("WEBGL_compressed_texture_pvrtc"))){if(e===l.RGB_PVRTC_4BPPV1_Format)return t.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(e===l.RGB_PVRTC_2BPPV1_Format)return t.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(e===l.RGBA_PVRTC_4BPPV1_Format)return t.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(e===l.RGBA_PVRTC_2BPPV1_Format)return t.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(null!==(t=N.get("EXT_blend_minmax"))){if(e===l.MinEquation)return t.MIN_EXT;if(e===l.MaxEquation)return t.MAX_EXT}return 0}this.setFaceCulling=function(e,t){e===l.CullFaceNone?D.disable(D.CULL_FACE):(t===l.FrontFaceDirectionCW?D.frontFace(D.CW):D.frontFace(D.CCW),e===l.CullFaceBack?D.cullFace(D.BACK):e===l.CullFaceFront?D.cullFace(D.FRONT):D.cullFace(D.FRONT_AND_BACK),D.enable(D.CULL_FACE))},this.setMaterialFaces=function(e){k.setDoubleSided(e.side===l.DoubleSide),k.setFlipSided(e.side===l.BackSide)},this.uploadTexture=function(e){void 0===e.__webglInit&&(e.__webglInit=!0,e.addEventListener("dispose",ze),e.__webglTexture=D.createTexture(),V.info.memory.textures++),D.bindTexture(D.TEXTURE_2D,e.__webglTexture),D.pixelStorei(D.UNPACK_FLIP_Y_WEBGL,e.flipY),D.pixelStorei(D.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.premultiplyAlpha),D.pixelStorei(D.UNPACK_ALIGNMENT,e.unpackAlignment),e.image=jt(e.image,_e);var t=e.image,r=l.Math.isPowerOfTwo(t.width)&&l.Math.isPowerOfTwo(t.height),n=$t(e.format),i=$t(e.type),o=Jt(e.format,e.type);Wt(D.TEXTURE_2D,e,r);var a,s,u,c=e.mipmaps;if(e instanceof l.DataTexture)if(c.length>0&&r){for(s=0,u=c.length;s<u;s++)a=c[s],D.texImage2D(D.TEXTURE_2D,s,o,a.width,a.height,0,n,i,a.data);e.generateMipmaps=!1}else D.texImage2D(D.TEXTURE_2D,0,o,t.width,t.height,0,n,i,t.data);else if(e instanceof l.CompressedTexture){for(s=0,u=c.length;s<u;s++)a=c[s],e.format!==l.RGBAFormat&&e.format!==l.RGBFormat?Ie().indexOf(n)>-1?D.compressedTexImage2D(D.TEXTURE_2D,s,o,a.width,a.height,0,a.data):console.warn("Attempt to load unsupported compressed texture format"):D.texImage2D(D.TEXTURE_2D,s,o,a.width,a.height,0,n,i,a.data);if(c.length>1&&Ie().indexOf(n)>-1)for(var h,d=a.width>>1,f=a.height>>1,p=c.length;d>=1||f>=1;)h=4==a.width&&4==a.height?a.data:new DataView(a.data.buffer,a.data.byteOffset,a.data.byteLength*(Math.max(d,4)*Math.max(f,4))/(a.width*a.height)),D.compressedTexImage2D(D.TEXTURE_2D,p,o,Math.max(d,1),Math.max(f,1),0,h),d>>=1,f>>=1,++p}else if(c.length>0&&r){for(s=0,u=c.length;s<u;s++)D.texImage2D(D.TEXTURE_2D,s,o,n,i,c[s]);e.generateMipmaps=!1}else D.texImage2D(D.TEXTURE_2D,0,o,n,i,e.image);e.generateMipmaps&&r&&D.generateMipmap(D.TEXTURE_2D),at(e),e.onUpdate&&e.onUpdate()},this.setTexture=function(e,t){D.activeTexture(D.TEXTURE0+t),ot(e)?V.uploadTexture(e):e.__webglTexture?D.bindTexture(D.TEXTURE_2D,e.__webglTexture):D.bindTexture(D.TEXTURE_2D,ye.__webglTexture)},V.uploadTexture(ye),this.initFrameBufferMRT=function(e,t){var r=e[0],n=!1;if(r&&!r.__webglFramebuffer){var i,o;if(void 0===r.depthBuffer&&(r.depthBuffer=!0),void 0===r.stencilBuffer&&(r.stencilBuffer=!0),r.__webglFramebuffer=D.createFramebuffer(),D.bindFramebuffer(D.FRAMEBUFFER,r.__webglFramebuffer),r.shareDepthFrom)i=r.__webglRenderbuffer=r.shareDepthFrom.__webglRenderbuffer,r.__isUsingShared=!0;else if(i=r.__webglRenderbuffer,r.__isUsingShared=!1,r.depthBuffer)i||(i=r.__webglRenderbuffer=D.createRenderbuffer(),r.__webglRenderbufferOwn=i),D.bindRenderbuffer(D.RENDERBUFFER,i),o=r.stencilBuffer?L?D.DEPTH24_STENCIL8:D.DEPTH_STENCIL:L?D.DEPTH_COMPONENT32F:D.DEPTH_COMPONENT16,D.renderbufferStorage(D.RENDERBUFFER,o,r.width,r.height);if(r.depthBuffer){var a=r.stencilBuffer?D.DEPTH_STENCIL_ATTACHMENT:D.DEPTH_ATTACHMENT;D.framebufferRenderbuffer(D.FRAMEBUFFER,a,D.RENDERBUFFER,i)}n=!0}else if(r)if(r.shareDepthFrom&&0==r.__isUsingShared){if(i=r.shareDepthFrom.__webglRenderbuffer,r.__isUsingShared=!0,r.depthBuffer){var s=r.stencilBuffer?D.DEPTH_STENCIL_ATTACHMENT:D.DEPTH_ATTACHMENT;D.framebufferRenderbuffer(D.FRAMEBUFFER,s,D.RENDERBUFFER,i)}}else if(null==r.shareDepthFrom&&1==r.__isUsingShared){var l;if(i=r.__webglRenderbufferOwn,r.__isUsingShared=!1,null==i)if(r.depthBuffer)i=r.__webglRenderbuffer=D.createRenderbuffer(),r.__webglRenderbufferOwn=i,D.bindRenderbuffer(D.RENDERBUFFER,i),l=r.stencilBuffer?L?D.DEPTH24_STENCIL8:D.DEPTH_STENCIL:L?D.DEPTH_COMPONENT32F:D.DEPTH_COMPONENT16,D.renderbufferStorage(D.RENDERBUFFER,l,r.width,r.height);if(r.depthBuffer){var u=r.stencilBuffer?D.DEPTH_STENCIL_ATTACHMENT:D.DEPTH_ATTACHMENT;D.framebufferRenderbuffer(D.FRAMEBUFFER,u,D.RENDERBUFFER,i)}}var c=z;if(D.bindFramebuffer(D.FRAMEBUFFER,r.__webglFramebuffer),function(e,t){var r=e.__webglBoundBuffers;if(!r)return!0;if(r.length!==t.length)return!0;for(var n=0;n<t.length;n++)if(t[n]!==r[n])return!0;return!1}(r,e)){var h;for(h=0;h<e.length;h++){var d=e[h];d&&!d.__webglTexture&&Kt(d),D.framebufferTexture2D(D.FRAMEBUFFER,D.COLOR_ATTACHMENT0+h,D.TEXTURE_2D,d&&d.__webglTexture,0)}h=e.length;for(var f=r.__webglBoundBuffers&&r.__webglBoundBuffers.length||h;h<f;)D.framebufferTexture2D(D.FRAMEBUFFER,D.COLOR_ATTACHMENT0+h,D.TEXTURE_2D,null,0),h++;r.__webglBoundBuffers=e.slice()}if(this.supportsMRT()&&Yt(e),t){var p=D.checkFramebufferStatus(D.FRAMEBUFFER);p!==D.FRAMEBUFFER_COMPLETE&&(console.log("Can't use multiple render targets. Falling back to two passes. "+p),c===r.__webglFramebuffer&&(c=z=null),D.bindFramebuffer(D.FRAMEBUFFER,c),D.deleteFramebuffer(r.__webglFramebuffer),delete r.__webglFramebuffer,t=!1)}return D.bindFramebuffer(D.FRAMEBUFFER,c),n&&(D.bindTexture(D.TEXTURE_2D,null),D.bindRenderbuffer(D.RENDERBUFFER,null),D.bindFramebuffer(D.FRAMEBUFFER,null)),t},this.getRenderTarget=function(){return G},this.setRenderTarget=function(e){var t,r,n,i,o,a;if(Array.isArray(e)&&e.length>0?(G=e[0],H=!0):(G=e,H=!1),V.lostContextRecovery&&V.lostContextRecovery.refreshTargetsIfNeeded(e),Array.isArray(e))this.initFrameBufferMRT(e),(t=e[0]).initForMRT=!0;else if(e){var s=e.__webglFramebuffer;s&&z===s&&!e.initForMRT&&null!=e.shareDepthFrom==!!e.__isUsingShared||this.initFrameBufferMRT([e]),(t=e).initForMRT=!1}!t||ke?(n=$,i=ee,o=Q,a=J):(n=t.width,i=t.height,o=0,a=0),(r=t?t.__webglFramebuffer:null)!==z&&(D.bindFramebuffer(D.FRAMEBUFFER,r),z=r),D.viewport(o,a,n,i)},this.readRenderTargetPixels=function(e,t,r,n,i,o){if(e instanceof l.WebGLRenderTarget){if(V.lostContextRecovery&&V.lostContextRecovery.refreshTargetsIfNeeded(e),e.__webglFramebuffer){if(e.texture.format!==l.RGBAFormat&&e.texture.format!==l.RGBFormat||e.texture.type!==l.UnsignedByteType)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not a readable format.");var a=!1;e.__webglFramebuffer!==z&&(D.bindFramebuffer(D.FRAMEBUFFER,e.__webglFramebuffer),a=!0),e.canReadPixels||D.checkFramebufferStatus(D.FRAMEBUFFER)===D.FRAMEBUFFER_COMPLETE?D.readPixels(t,r,n,i,D.RGBA,D.UNSIGNED_BYTE,o):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete."),a&&D.bindFramebuffer(D.FRAMEBUFFER,z)}}else console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.")}}},74007:(e,t,r)=>{"use strict";r.r(t),r.d(t,{WebGLShader:()=>n});function n(e,t,r){var n=e.createShader(t);return e.shaderSource(n,r),e.compileShader(n),"undefined"!=typeof DEBUG_SHADERS&&DEBUG_SHADERS&&(!1===e.getShaderParameter(n,e.COMPILE_STATUS)&&console.error("THREE.WebGLShader: Shader couldn't compile."),""!==e.getShaderInfoLog(n)&&console.warn("THREE.WebGLShader: gl.getShaderInfoLog()",e.getShaderInfoLog(n),function(e){for(var t=e.split("\n"),r=0;r<t.length;r++)t[r]=r+1+": "+t[r];return t.join("\n")}(r))),n}},26245:(e,t,r)=>{"use strict";function n(e,t){var r,n;this.bytes_per_node=t?32:36,e instanceof ArrayBuffer?(r=e.byteLength/this.bytes_per_node,n=e,this.nodeCount=r):(r=0|e,n=new ArrayBuffer(this.bytes_per_node*r),this.nodeCount=0),this.nodeCapacity=r,this.nodesRaw=n,this.is_lean_node=t,this.node_stride=this.bytes_per_node/4,this.node_stride_short=this.bytes_per_node/2,this.nodesF=new Float32Array(this.nodesRaw),this.nodesI=new Int32Array(this.nodesRaw),this.nodesS=new Uint16Array(this.nodesRaw)}r.r(t),r.d(t,{NodeArray:()=>n,BVHBuilder:()=>a}),n.prototype.setLeftChild=function(e,t){this.nodesI[e*this.node_stride+6]=t},n.prototype.getLeftChild=function(e){return this.nodesI[e*this.node_stride+6]},n.prototype.setPrimStart=function(e,t){this.is_lean_node?this.nodesI[e*this.node_stride+6]=t:this.nodesI[e*this.node_stride+8]=t},n.prototype.getPrimStart=function(e){return this.is_lean_node?this.nodesI[e*this.node_stride+6]:this.nodesI[e*this.node_stride+8]},n.prototype.setPrimCount=function(e,t){this.nodesS[e*this.node_stride_short+14]=t},n.prototype.getPrimCount=function(e){return this.nodesS[e*this.node_stride_short+14]},n.prototype.setFlags=function(e,t,r,n){this.nodesS[e*this.node_stride_short+15]=n<<3|r<<2|3&t},n.prototype.getFlags=function(e){return this.nodesS[e*this.node_stride_short+15]},n.prototype.setBox0=function(e,t){var r=e*this.node_stride,n=this.nodesF;n[r]=t[0],n[r+1]=t[1],n[r+2]=t[2],n[r+3]=t[3],n[r+4]=t[4],n[r+5]=t[5]},n.prototype.getBoxThree=function(e,t){var r=e*this.node_stride,n=this.nodesF;t.min.x=n[r],t.min.y=n[r+1],t.min.z=n[r+2],t.max.x=n[r+3],t.max.y=n[r+4],t.max.z=n[r+5]},n.prototype.getBoxArray=function(e,t,r){var n=e*this.node_stride,i=this.nodesF;t[0+(r=r||0)]=i[n],t[1+r]=i[n+1],t[2+r]=i[n+2],t[3+r]=i[n+3],t[4+r]=i[n+4],t[5+r]=i[n+5]},n.prototype.setBoxThree=function(e,t){var r=e*this.node_stride,n=this.nodesF;n[r]=t.min.x,n[r+1]=t.min.y,n[r+2]=t.min.z,n[r+3]=t.max.x,n[r+4]=t.max.y,n[r+5]=t.max.z},n.prototype.makeEmpty=function(e){var t=e*this.node_stride,r=this.nodesI;r[t+6]=-1,r[t+7]=0,this.is_lean_node||(r[t+8]=-1)},n.prototype.realloc=function(e){if(this.nodeCount+e>this.nodeCapacity){var t=0|3*this.nodeCapacity/2;t<this.nodeCount+e&&(t=this.nodeCount+e);var r=new ArrayBuffer(t*this.bytes_per_node),n=new Int32Array(r);n.set(this.nodesI),this.nodeCapacity=t,this.nodesRaw=r,this.nodesF=new Float32Array(r),this.nodesI=n,this.nodesS=new Uint16Array(r)}},n.prototype.nextNodes=function(e){this.realloc(e);var t=this.nodeCount;this.nodeCount+=e;for(var r=0;r<e;r++)this.makeEmpty(t+r);return t},n.prototype.getRawData=function(){return this.nodesRaw.slice(0,this.nodeCount*this.bytes_per_node)};var i=function(){function e(e,t,r){e[0]>t[r]&&(e[0]=t[r]),e[3]<t[r]&&(e[3]=t[r]),e[1]>t[r+1]&&(e[1]=t[r+1]),e[4]<t[r+1]&&(e[4]=t[r+1]),e[2]>t[r+2]&&(e[2]=t[r+2]),e[5]<t[r+2]&&(e[5]=t[r+2])}function t(e,t,r){e[0]>t[r]&&(e[0]=t[r]),e[1]>t[r+1]&&(e[1]=t[r+1]),e[2]>t[r+2]&&(e[2]=t[r+2]),e[3]<t[r+3]&&(e[3]=t[r+3]),e[4]<t[r+4]&&(e[4]=t[r+4]),e[5]<t[r+5]&&(e[5]=t[r+5])}function r(e,t){e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]>t[2]&&(e[2]=t[2]),e[3]<t[3]&&(e[3]=t[3]),e[4]<t[4]&&(e[4]=t[4]),e[5]<t[5]&&(e[5]=t[5])}function n(e,t,r,n){for(var i=0;i<3;i++)e[t+i]=r[n+3+i]-r[n+i]}function i(e,t){e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5]}var o=1/0;function a(e){e[0]=o,e[1]=o,e[2]=o,e[3]=-1/0,e[4]=-1/0,e[5]=-1/0}function s(e){var t=e[3]-e[0],r=e[4]-e[1],n=e[5]-e[2];return t<0||r<0||n<0?0:2*(t*r+r*n+n*t)}function l(){this.vb_left=new Float32Array(6),this.vb_right=new Float32Array(6),this.cb_left=new Float32Array(6),this.cb_right=new Float32Array(6),this.num_left=0,this.best_split=-1,this.best_cost=-1,this.num_bins=-1}function u(){this.box_bbox=new Float32Array(6),this.box_centroid=new Float32Array(6),this.num_prims=0}function c(){this.BL=new Float32Array(6),this.CL=new Float32Array(6),this.NL=0,this.AL=0}l.prototype.reset=function(){this.num_left=0,this.best_split=-1,this.best_cost=-1,this.num_bins=-1},u.prototype.reset=function(){this.num_prims=0,a(this.box_bbox),a(this.box_centroid)},c.prototype.reset=function(){this.NL=0,this.AL=0,a(this.BL),a(this.CL)};var h,d=[];for(h=0;h<16;h++)d.push(new u);var f=[];for(h=0;h<15;h++)f.push(new c);var p=new Float32Array(6),m=new Float32Array(6);function g(n,o,a,l,u,c,h){if(c[l]<n.scene_epsilon)h.best_cost=1/0;else{var g,v,y=16;for(y>a-o+1&&(y=a-o+1),g=0;g<y;g++)d[g].reset();for(g=0;g<y-1;g++)f[g].reset();for(h.num_bins=y,function(r,n,i,o,a,s,l){for(var u=r.centroids,c=r.primitives,h=r.finfo.boxes,f=r.finfo.boxStride,p=.99999*l/s[o],m=a[o],g=r.sort_prims,v=n;v<=i;v++){var y=0|c[v],b=0|p*(u[3*y+o]-m);b<0?b=0:b>=l&&(b=l-1),g[v]=b,d[b].num_prims++,t(d[b].box_bbox,h,y*f),e(d[b].box_centroid,u,3*y)}}(n,o,a,l,u,c,y),i(f[0].BL,d[0].box_bbox),i(f[0].CL,d[0].box_centroid),f[0].AL=s(f[0].BL),f[0].NL=d[0].num_prims,g=1;g<y-1;g++){v=d[g];var b=f[g];i(b.BL,f[g-1].BL),r(b.BL,v.box_bbox),b.AL=s(b.BL),i(b.CL,f[g-1].CL),r(b.CL,v.box_centroid),b.NL=f[g-1].NL+v.num_prims}i(p,d[g=y-1].box_bbox),i(m,d[g].box_centroid);var x=s(p),_=d[g].num_prims,E=g,w=x*_+f[g-1].AL*f[g-1].NL;for(i(h.vb_right,p),i(h.cb_right,d[g].box_centroid),i(h.vb_left,f[g-1].BL),i(h.cb_left,f[g-1].CL),h.num_left=f[g-1].NL,g-=1;g>=1;g--){v=d[g],r(p,v.box_bbox),r(m,v.box_centroid);var A=(x=s(p))*(_+=v.num_prims)+f[g-1].AL*f[g-1].NL;A<=w&&(w=A,E=g,i(h.vb_right,p),i(h.cb_right,m),i(h.vb_left,f[g-1].BL),i(h.cb_left,f[g-1].CL),h.num_left=f[g-1].NL)}h.best_split=E,h.best_cost=w}}var v=new Float32Array(3);return{bvh_subdivide:function(t,r,i,o,s,u,c,h){n(v,0,u,0);var d=t.nodes,f=c?t.frags_per_leaf_node_transparent:t.frags_per_leaf_node,p=c?t.frags_per_inner_node_transparent:t.frags_per_inner_node,m=t.max_polys_per_node,y=0;v[1]>v[0]&&(y=1),v[2]>v[y]&&(y=2),d.setBox0(r,s);var b=0,x=0,_=o-i+1;if(t.finfo.hasPolygonCounts&&t.frags_per_inner_node)for(var E=_<=t.frags_per_inner_node?o:i+t.frags_per_inner_node-1,w=i;w<=E&&(x++,!((b+=t.finfo.getPolygonCount(t.primitives[w]))>m));w++);if(_<=f&&b<m||1===_||h>15||v[y]<t.scene_epsilon)return d.setLeftChild(r,-1),d.setPrimStart(r,i),d.setPrimCount(r,o-i+1),void d.setFlags(r,0,0,c?1:0);p&&(y=function(t,r,i,o,s,l,u,c){var h=t.primitives,d=t.centroids,f=s-o+1;f>t.frags_per_inner_node&&(f=t.frags_per_inner_node),f>c&&(f=c),r.setPrimStart(i,o),r.setPrimCount(i,f),o+=f,a(l);for(var p=o;p<=s;p++)e(l,d,3*h[p]);n(u,0,l,0);var m=0;return u[1]>u[0]&&(m=1),u[2]>u[m]&&(m=2),m}(t,d,r,i,o,u,v,x),i+=d.getPrimCount(r));var A=new l;if(g(t,i,o,y,u,v,A),A.num_bins<0)d.setPrimCount(r,d.getPrimCount(r)+o-i+1);else{!function(e,t,r,n,i,o,a){var s,l,u=e.primitives,c=e.sort_prims,h=0,d=0|t,f=0|a.best_split;for(s=t;s<=r;s++){var p=0|u[s];c[s]<f?u[d++]=p:c[h++]=p}for(l=0;l<h;l++)u[d+l]=c[l]}(t,i,o,0,0,0,A);var S=d.nextNodes(2),M=.5*(A.vb_left[3+y]+A.vb_left[y]),T=.5*(A.vb_right[3+y]+A.vb_right[y]);d.setFlags(r,y,M<T?0:1,c?1:0),d.setLeftChild(r,S),t.recursion_stack.push([t,S+1,i+A.num_left,o,A.vb_right,A.cb_right,c,h+1]),t.recursion_stack.push([t,S,i,i+A.num_left-1,A.vb_left,A.cb_left,c,h+1])}},compute_boxes:function(r){var i=r.boxv_o,o=r.boxc_o,s=r.boxv_t,l=r.boxc_t;a(i),a(o),a(s),a(l);for(var u,c,h,d,f=r.centroids,p=r.finfo.boxes,m=r.finfo.boxStride,g=0,y=r.prim_count;g<y;g++){var b=r.primitives[g];h=p,d=m*b,(u=f)[c=3*b]=.5*(h[d]+h[d+3]),u[c+1]=.5*(h[d+1]+h[d+4]),u[c+2]=.5*(h[d+2]+h[d+5]),g>=r.first_transparent?(e(l,f,3*b),t(s,p,m*b)):(e(o,f,3*b),t(i,p,m*b))}n(v,0,r.boxv_o,0);var x=Math.max(v[0],v[1],v[2]);r.scene_epsilon=1e-5*x},box_area:function(e,t){var r=e[t+3]-e[t],n=e[t+4]-e[t+1],i=e[t+5]-e[t+2];return r<0||n<0||i<0?0:2*(r*n+n*i+i*r)}}}();function o(e,t){this.boxes=e.boxes,this.polygonCounts=e.polygonCounts,this.hasPolygonCounts=!!this.polygonCounts,this.materials=e.materials,this.materialDefs=t,this.count=e.length,this.boxStride=6,this.wantSort=!0}function a(e,t,r){this.finfo=r||new o(e,t),this.prim_count=this.finfo.getCount(),this.frags_per_leaf_node=-1,this.frags_per_inner_node=-1,this.nodes=null,this.work_buf=new ArrayBuffer(4*this.prim_count),this.sort_prims=new Int32Array(this.work_buf),this.primitives=new Int32Array(this.prim_count),this.centroids=new Float32Array(3*this.prim_count),this.boxv_o=new Float32Array(6),this.boxc_o=new Float32Array(6),this.boxv_t=new Float32Array(6),this.boxc_t=new Float32Array(6),this.recursion_stack=[]}o.prototype.getCount=function(){return this.count},o.prototype.isTransparent=function(e){return!(!this.materialDefs||!this.materialDefs[this.materials[e]])&&this.materialDefs[this.materials[e]].transparent},o.prototype.getPolygonCount=function(e){return this.polygonCounts[e]},a.prototype.sortPrimitives=function(e){var t,r,n=new Float32Array(this.work_buf),o=this.primitives,a=0,s=e;for(t=0,r=this.prim_count;t<r;t++){o[t]=t;var l=this.finfo.isTransparent(t);l&&a++,s?(n[t]=i.box_area(this.finfo.boxes,this.finfo.boxStride*t),l&&(n[t]=-n[t])):n[t]=l?-1:1}if(s)Array.prototype.sort.call(this.primitives,(function(e,t){return n[t]-n[e]}));else if(a&&a<this.prim_count){var u=new Int32Array(a),c=0,h=0;for(t=0,r=this.prim_count;t<r;t++)n[t]>=0?o[c++]=o[t]:u[h++]=o[t];o.set(u,this.prim_count-a)}this.first_transparent=this.prim_count-a},a.prototype.build=function(e){var t=e&&!!e.useSlimNodes,r=this;function o(t,n){e.hasOwnProperty(t)?r[t]=e[t]:r[t]=n}if(t)o("frags_per_leaf_node",1),o("frags_per_inner_node",0),o("frags_per_leaf_node_transparent",1),o("frags_per_inner_node_transparent",0),o("max_polys_per_node",1/0);else{var a=e.isWeakDevice?.5:1;o("frags_per_leaf_node",0|256*a),o("frags_per_inner_node",0|this.frags_per_leaf_node),o("frags_per_leaf_node_transparent",this.frags_per_leaf_node),o("frags_per_inner_node_transparent",0),o("max_polys_per_node",0|2e4*a)}if(this.nodes&&this.nodes.is_lean_node==t)this.nodes.nodeCount=0;else{for(var s=this.prim_count/this.frags_per_leaf_node,l=1;l<s;)l*=2;this.nodes=new n(l,!!e&&e.useSlimNodes)}this.sortPrimitives(this.finfo.wantSort),i.compute_boxes(this);var u,c=this.nodes.nextNodes(2);for(i.bvh_subdivide(this,c,0,this.first_transparent-1,this.boxv_o,this.boxc_o,!1,0);this.recursion_stack.length;)u=this.recursion_stack.pop(),i.bvh_subdivide(u[0],u[1],u[2],u[3],u[4],u[5],u[6],u[7]);for(i.bvh_subdivide(this,c+1,this.first_transparent,this.prim_count-1,this.boxv_t,this.boxc_t,!0,0);this.recursion_stack.length;)u=this.recursion_stack.pop(),i.bvh_subdivide(u[0],u[1],u[2],u[3],u[4],u[5],u[6],u[7])}},25131:(e,t,r)=>{"use strict";r.r(t),r.d(t,{createBufferGeometry:()=>p,meshToGeometry:()=>m,BufferGeometryUtils:()=>g});var n=r(92445),i=r(84998),o=r(23909),a=r(98926),s={};function l(e,t,r,n){var i,l=t.normalize||t.normalized;if(t.array)i=new o.BufferAttribute(t.array,t.itemSize);else{var u=e+"|"+t.bytesPerItem+"|"+l+"|"+t.isPattern+"|"+t.divisor+"|"+t.offset;if(i=s[u])return i;i=new o.BufferAttribute(void 0,t.itemSize),s[u]=i}return i.normalized=l,i.bytesPerItem=t.bytesPerItem,i.isPattern=t.isPattern,r&&(i.divisor=t.divisor),t.array||(t.hasOwnProperty("offset")?i.itemOffset=t.offset:a.logger.warn("VB attribute is neither interleaved nor separate. Something is wrong with the buffer specificaiton.")),i}var u,c,h,d={};var f=1;function p(){return u||((u=new o.BufferAttribute(void 0,1)).bytesPerItem=2,(c=new o.BufferAttribute(void 0,1)).bytesPerItem=4,(h=function(){this.id=f++,this.attributes={},this.__webglInit=void 0}).prototype=Object.create(o.BufferGeometry.prototype),h.prototype.constructor=h),new h}function m(e){var t=e.mesh,r=p();(0,i.isNodeJS)()&&(r.packId=e.packId,r.meshIndex=e.meshIndex),r.byteSize=0,r.vb=t.vb;for(var a in r.vbbuffer=void 0,r.vbNeedsUpdate=!0,r.byteSize+=t.vb.byteLength,r.hash=e.hash,r.vbstride=t.vbstride,t.isLines&&(r.isLines=t.isLines),t.isWideLines&&(r.isWideLines=!0,r.lineWidth=t.lineWidth),t.isPoints&&(r.isPoints=t.isPoints,r.pointSize=t.pointSize),e.is2d&&(r.is2d=!0),r.numInstances=t.numInstances,t.vblayout){var s=t.vblayout[a];r.attributes[a]=l(a,s,r.numInstances)}if(n.memoryOptimizedLoading)r.index=t.indices instanceof Uint32Array?c:u,r.ib=t.indices,r.ibbuffer=void 0,t.iblines&&(r.attributes.indexlines=t.iblines instanceof Uint32Array?c:u,r.iblines=t.iblines,r.iblinesbuffer=void 0);else{var h=new o.BufferAttribute(t.indices,1);h.bytesPerItem=t.indices instanceof Uint32Array?4:2,r.setIndex(h)}r.attributesKeys=function(e){var t="";for(var r in e.attributes)t+=r+"|";var n=d[t];return n||(n=Object.keys(e.attributes),d[t]=n,n)}(r),r.byteSize+=t.indices.byteLength,r.boundingBox=(new o.Box3).copy(t.boundingBox),r.boundingSphere=(new o.Sphere).copy(t.boundingSphere),e.geometry=r,e.mesh=null}var g={meshToGeometry:m,createBufferGeometry:p,findBufferAttribute:l}},76543:(e,t,r)=>{"use strict";r.r(t),r.d(t,{MeshAccessor:()=>g,createWireframe:()=>v});var n=r(36757),i=r(73075),o=r(22585),a=1e-6;function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var l={x:0,y:0,z:0},u=function(){function e(t,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.getVertex=t,this.bbox=r,this.boxSize=this.bbox.getSize().length(),n||(n=a),n>0?(this.precisionTolerance=n,this.scale=1/this.precisionTolerance):(this.precisionTolerance=-n*this.boxSize,this.scale=1/this.precisionTolerance),this.snapBaseX=this.bbox.min.x,this.snapBaseY=this.bbox.min.y,this.snapBaseZ=this.bbox.min.z,this.xymap={}}var t,r,n;return t=e,(r=[{key:"findOrAddPoint",value:function(e,t,r,n){for(var i,o=0|(e-this.snapBaseX)*this.scale,a=0|(t-this.snapBaseY)*this.scale,s=0|(r-this.snapBaseZ)*this.scale,u=1/0,c=o-1;c<=o+1;c++){var h=this.xymap[c];if(h)for(var d=a-1;d<=a+1;d++){var f=h[d];if(f)for(var p=s-1;p<=s+1;p++){var m=f[p];if(void 0!==m){this.getVertex(m,l);var g=(l.x-e)*(l.x-e)+(l.y-t)*(l.y-t)+(l.z-r)*(l.z-r);g<u&&(i=m,u=g)}}}}if(Math.sqrt(u)>this.precisionTolerance&&(i=void 0),void 0===i){var v=this.xymap[o];v||(v=this.xymap[o]={});var y=v[a];return y||(y=v[a]={}),y[s]=n,n}return i}}])&&s(t.prototype,r),n&&s(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var h=new i.LmvVector3,d=new i.LmvVector3,f=new i.LmvVector3,p=new i.LmvVector3,m=new i.LmvVector3,g=function(){function e(t,r,a){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var s=t.boundingBox||a,l=new o.LmvBox3;s&&l.copy(s),this.geom=t,this.myVerts=function(e,t){var r=new Float32Array(3*(0,n.getVertexCount)(e));return(0,n.enumMeshVertices)(e,(function(e,n,i,o){t&&t.expandByPoint(e),r[3*o]=e.x,r[3*o+1]=e.y,r[3*o+2]=e.z})),r}(t,s?null:l);var c=new u(this.getV.bind(this),l,-1/65536);this.remap=new Array((0,n.getVertexCount)(t));for(var h=0,d=0;h<this.myVerts.length;h+=3,d++)this.remap[d]=c.findOrAddPoint(this.myVerts[h],this.myVerts[h+1],this.myVerts[h+2],d);r&&function(e,t){for(var r=new i.LmvVector3,n=0;n<e.length;n+=3)r.x=e[n],r.y=e[n+1],r.z=e[n+2],r.applyMatrix4(t),e[n]=r.x,e[n+1]=r.y,e[n+2]=r.z}(this.myVerts,r)}var t,r,a;return t=e,(r=[{key:"getV",value:function(e,t){t.x=this.myVerts[3*e],t.y=this.myVerts[3*e+1],t.z=this.myVerts[3*e+2]}},{key:"getNormal",value:function(e,t,r,n){this.getV(e,h),this.getV(t,d),this.getV(r,f),d.sub(h),f.sub(h),d.cross(f),n.copy(d).normalize()}}])&&c(t.prototype,r),a&&c(t,a),Object.defineProperty(t,"prototype",{writable:!1}),e}();function v(e,t,r,i){if(!e.isLines&&!e.iblines){var o=new g(e,t,r),a={},s=[];for(var l in(0,n.enumMeshTriangles)(e,(function(e,t,r,n,i,o){c(n,i,o),c(i,o,n),c(o,n,i)})),a)for(var u in a[l])s.push(parseInt(l)),s.push(parseInt(u));s.length>1&&(e.iblines=new Uint16Array(s.length),e.iblines.set(s))}function c(e,t,r){var n=o.remap[e],l=o.remap[t],u=o.remap[r];if(n!==l&&n!==u&&l!==u){var c=!1;if(n>l){var h=n;n=l,l=h,c=!0}var d=a[n];if(d){var f=d[l];if(void 0===f)d[l]=c?-r-1:r;else{if(i)s.push(e),s.push(t);else{o.getNormal(e,t,r,p),f<0?o.getNormal(l,n,o.remap[-f-1],m):o.getNormal(n,l,o.remap[f],m);var g=p.dot(m);Math.abs(g)<.25&&(s.push(e),s.push(t))}delete d[l]}}else a[n]={},a[n][l]=r}}}},23650:(e,t,r)=>{"use strict";function n(e){return function(e){if(Array.isArray(e))return i(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return i(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return i(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function o(){var e,t,r,i,o,a,s,l,u,c=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},h=0,d=[],f=[],p=c.timeSlice||15,m=c.sliceDelay||0,g=null!==(e=c.delay)&&void 0!==e?e:-1;function v(e){h&&clearTimeout(h),h=0,i=e,d.length=0,f.length=0,a=null,s=-1,l=0,u=0}function y(){h=0;for(var e=performance.now()+p;performance.now()<e;){var n;if(!E())return v(null),void(null===(n=r)||void 0===n||n());t(f[u],d[l],o,u+1>=f.length,!i||s>=i.length)}h=setTimeout((function(){return y()}),m)}function b(){if(i&&s<i.length)for(;++s<i.length;){if(a=i[s].getInstanceTree(),d.length=0,a)a.enumNodeChildren(i[s].getRootId(),(function(e){d.push(e)}),!0);else{var e,t=i[s].getFragmentList();null!=t&&null!==(e=t.fragments)&&void 0!==e&&e.dbId2fragId&&d.push.apply(d,n(Object.keys(t.fragments.dbId2fragId).map((function(e){return parseInt(e)}))))}if(d.length>0)return o=i[s]}return o=null,!1}function x(e){return a?!a.isNodeHidden(e)&&!a.isNodeOff(e):!i[s].getFragmentList().dbIdIsGhosted[e]}function _(){if(l>=d.length)return!1;for(;++l<d.length;){var e=d[l];if(c.includeHidden||x(e)){if(f.length=0,a)a.enumNodeFragments(e,(function(e){f.push(e)}),!1);else{var t=i[s].getFragmentList();if(t){var r=t.fragments.dbId2fragId[e];Array.isArray(r)||(r=[r]),f.push.apply(f,n(r))}}if(f.length>0)return!0}}return!1}function E(){if(++u<f.length)return!0;for(u=0;;){if(_())return!0;if(!b())return!1;l=-1}}this.start=function(e,n,i){Array.isArray(e)||(e=[e]),v(e),t=n,r=i,n&&(g>=0?h=setTimeout((function(){return y()}),g):y())},this.stop=function(){v(null)}}r.r(t),r.d(t,{FragmentIterator:()=>o})},282:(e,t,r)=>{"use strict";r.r(t),r.d(t,{FragmentList:()=>g,FragmentPointer:()=>M});var n=r(92445),i=r(23909),o=r(46759),a=r(98926),s=r(59481),l=r(89812),u=new Uint32Array(1);function c(e){var t,r,n=this;this.geometry=e,this.vb=e.vb.buffer,this.vbi=new Int32Array(this.vb),this.vbs=new Uint16Array(this.vb),this.stride=e.vbstride,this.vcount=this.vbi.length/this.stride,this.useCompactBuffers=e.unpackXform,this.texData=this.useCompactBuffers&&(null===(t=e.tIdColor)||void 0===t||null===(r=t.image)||void 0===r?void 0:r.data)&&new Uint32Array(e.tIdColor.image.data.buffer),this.texColMap=function(){if(!n.texData)return null;for(var e={},t=new Set,r=0;r<n.vcount;++r){var i=n.vbs[r*n.stride*2+6];t.has(i)||(e[n.texData[i]]=i,t.add(i))}return e}()}c.prototype.setColorAt=function(e,t){if(this.texData){if(o=t,u[0]=o,!((t=u[0])in this.texColMap)){var r=this.texData;if(r.length+1>65536)return void a.logger.warn("setColorAt() cannot add new color as size limit reached");var n=new Uint32Array(r.length+1);n.set(r,0),n[r.length]=t,this.texColMap[t]=r.length;var i=new THREE.DataTexture(new Uint8Array(n.buffer),n.length,1,THREE.RGBAFormat,THREE.UnsignedByteType,THREE.UVMapping,THREE.ClampToEdgeWrapping,THREE.ClampToEdgeWrapping,THREE.NearestFilter,THREE.NearestFilter,0);i.generateMipmaps=!1,i.flipY=!1,i.needsUpdate=!0,this.geometry.tIdColor.dispose(),this.geometry.tIdColor=i,this.texData=new Uint32Array(i.image.data.buffer),this.geometry.vIdColorTexSize=new THREE.Vector2(n.length,1)}this.vbs[e*this.stride*2+6]=this.texColMap[t]}else this.vbi[e*this.stride+6]=t;var o},c.prototype.setVertexFlagsAt=function(e,t){this.texData?this.vbi[e*this.stride+4]=t:this.vbi[e*this.stride+8]=t};var h=new i.Matrix4,d=new i.Box3,f=new i.Quaternion,p=new i.Vector3,m=new i.Vector3;function g(e){this.is2d=e.is2d(),this.modelId=e.getModelId(),this.fragments=e.getData().fragments,this.geoms=e.getGeometryList(),this.isFixedSize=this.fragments.length>0,this.isFixedSize?(this.boxes=this.fragments.boxes,this.transforms=this.fragments.transforms,this.useThreeMesh=!n.memoryOptimizedLoading):(this.boxes=null,this.transforms=null,this.useThreeMesh=!0);var t=this.fragments.length;if(this.vizflags=new Uint16Array(t),this.useThreeMesh&&(this.vizmeshes=new Array(t)),e.isOTG()){var r=e.getData().metadata.stats,i=r.num_materials,o=r.num_geoms;this.materialids=(0,s.R)(t,i),this.geomids=(0,s.R)(t,o)}else this.geomids=new Int32Array(t),this.materialids=new Int32Array(t);this.materialmap={},this.materialIdMap={},this.nextMaterialId=1,this.db2ThemingColor=[],this.originalColors=[],this.themingOrGhostingNeedsUpdate={},this.themingOrGhostingNeedsUpdateByDbId={},this.dbIdOpacity=[],this.dbIdIsGhosted=[],this.animxforms=null;for(var a=0;a<t;a++)this.vizflags[a]=1;!e.isOTG()&&this.fragments.visibilityFlags&&this.vizflags.set(this.fragments.visibilityFlags),this.allVisible=!0,this.allVisibleDirty=!0,this.nextAvailableFragID=t,this.linesHidden=!1,this.pointsHidden=!1,this.matrix=null,this.viewBounds=null}function v(e){var t=e.r;return e.r=e.b,e.b=t,e}g.prototype.getNextAvailableFragmentId=function(){return this.nextAvailableFragID++},g.prototype.fragmentsHaveBeenAdded=function(){return this.vizflags.length>this.fragments.length},g.prototype.getSvfMaterialId=function(e){var t=this.getMaterial(e);return t?t.svfMatId:void 0},g.prototype.setMesh=function(e,t,r,n){if(this.vizmeshes){var s=this.vizmeshes[e];s&&s.parent&&s.parent.remove(s)}if(this.vizflags.length<=e){this.isFixedSize&&(a.logger.warn("Attempting to resize a fragments list that was initialized with fixed data. This will have a performance impact."),this.isFixedSize=!1);var l=Math.ceil(1.5*Math.max(this.vizflags.length,e))||1;this.useThreeMesh&&l<this.vizmeshes.length&&(l=this.vizmeshes.length);var u=new Uint16Array(l);if(u.set(this.vizflags),this.vizflags=u,this.transforms){var c=new Float32Array(12*l);c.set(this.transforms),this.transforms=c}if(this.boxes){var h=new Float32Array(6*l);h.set(this.boxes),this.boxes=h}if(this.geomids){var f=new Int32Array(l);f.set(this.geomids),this.geomids=f}if(this.materialids){var p=new Int32Array(l);p.set(this.materialids),this.materialids=p}}if(this.useThreeMesh){var m;n&&t instanceof i.Mesh?(m=t,t.matrix&&m.matrixWorld.copy(t.matrix),m.dbId=m.dbId||0):(m=new i.Mesh(t.geometry,t.material),t.matrix&&(m.matrix&&m.matrix.copy(t.matrix),m.matrixWorld.copy(t.matrix)),m.is2d=t.is2d,m.isLine=t.isLine,m.isWideLine=t.isWideLine,m.isPoint=t.isPoint,m.dbId=0|this.fragments.fragId2dbId[e]),m.matrixAutoUpdate=!1,m.frustumCulled=!1,m.fragId=e,m.modelId=this.modelId,this.matrix&&m.matrixWorld.multiplyMatrices(this.matrix,m.matrix),this.vizmeshes[e]=m}else{var g=void 0;t.geometry.hash?(void 0===t.geomId&&console.error("meshInfo must provide geomId"),g=t.geomId):g=t.geometry.svfid,this.geomids[e]=g,this.setMaterial(e,t.material)}var v=0;if(t.isLine?v=o.MeshFlags.MESH_ISLINE:t.isWideLine?v=o.MeshFlags.MESH_ISWIDELINE:t.isPoint&&(v=o.MeshFlags.MESH_ISPOINT),this.isFixedSize?this.vizflags[e]|=v:this.vizflags[e]|=o.MeshFlags.MESH_VISIBLE|v,r&&this.transforms&&this.boxes){var y=t.matrix,b=12*e,x=y.elements,_=this.transforms;if(_[b]=x[0],_[b+1]=x[1],_[b+2]=x[2],_[b+3]=x[4],_[b+4]=x[5],_[b+5]=x[6],_[b+6]=x[8],_[b+7]=x[9],_[b+8]=x[10],_[b+9]=x[12],_[b+10]=x[13],_[b+11]=x[14],!this.fragments.boxesLoaded){t.bbox?d.copy(t.bbox):(t.geometry&&t.geometry.boundingBox?d.copy(t.geometry.boundingBox):this.geoms.getModelBox(this.geomids[e],d),d.isEmpty()||d.applyMatrix4(y));var E=6*e,A=this.boxes;A[E]=d.min.x,A[E+1]=d.min.y,A[E+2]=d.min.z,A[E+3]=d.max.x,A[E+4]=d.max.y,A[E+5]=d.max.z}}!function(e,t){if(e.is2d&&!function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}(e.themingOrGhostingNeedsUpdateByDbId)){var r=e.getDbIds(t);(r=(r=Array.isArray(r)?r:[r]).filter((function(t){return e.themingOrGhostingNeedsUpdateByDbId[t]}))).length&&(w(e,t),r.forEach((function(t){delete e.themingOrGhostingNeedsUpdateByDbId[t]})))}}(this,e)},g.prototype.isFlagSet=function(e,t){return!!(this.vizflags[e]&t)},g.prototype.setFlagFragment=function(e,t,r){var n=this.vizflags[e];return!!(n&t)!=r&&(this.vizflags[e]=r?n|t:n&~t,!0)},g.prototype.setFlagGlobal=function(e,t){var r=this.vizflags,n=0,i=r.length;if(t)for(;n<i;n++)r[n]=r[n]|e;else for(var o=~e;n<i;n++)r[n]=r[n]&o},g.prototype.hideLines=function(e){this.linesHidden=e},g.prototype.hidePoints=function(e){this.pointsHidden=e},g.prototype.hideFragments=function(e,t){var r=o.MeshFlags.MESH_HIDE,n=this.vizflags,i=0,a=n.length;if(t)for(;i<a;i++)n[i]&e&&(n[i]=n[i]|r);else for(var s=~r;i<a;i++)n[i]&e&&(n[i]=n[i]&s);this.allVisibleDirty=!0},g.prototype.isFragVisible=function(e){var t=this.linesHidden&&(this.isLine(e)||this.isWideLine(e)),r=this.pointsHidden&&this.isPoint(e);return 1==(7&this.vizflags[e])&&!t&&!r},g.prototype.isFragOff=function(e){return!!(this.vizflags[e]&o.MeshFlags.MESH_HIDE)},g.prototype.isNotLoaded=function(e){return this.vizflags[e]&o.MeshFlags.MESH_NOTLOADED},g.prototype.isLine=function(e){return!!(this.vizflags[e]&o.MeshFlags.MESH_ISLINE)},g.prototype.isWideLine=function(e){return this.isFlagSet(e,o.MeshFlags.MESH_ISWIDELINE)},g.prototype.isPoint=function(e){return this.isFlagSet(e,o.MeshFlags.MESH_ISPOINT)},g.prototype.areAllVisible=function(){if(this.allVisibleDirty){for(var e=this.vizflags,t=!0,r=0,n=e.length;r<n;r++)if(0==(1&e[r])){t=!1;break}this.allVisible=t,this.allVisibleDirty=!1}return this.allVisible};var y,b,x,_,E=(y=null,b=null,x=parseInt("00FFFFFF",16),_=parseInt("FF000000",16),function(e,t){return y||(y=new i.Color,b=new i.Color),y.set(e&x),v(y),t&&(b.setRGB(t.x,t.y,t.z),y.lerp(b,t.w)),v(y).getHex()|e&_});function w(e,t){var r=e.originalColors[t],n=e.getGeometry(t);if(n&&n.vb){var i=new l.VertexBufferReader(n),o=new c(n);if(i.isInterleavedVb){for(var a=!1,s=i.vcount,u=0;u<s;u++){var h=i.getDbIdAt(u),d=r?r[u]:i.getColorAt(u),f=i.getLayerIndexAt(u),p=-1===(h=h<<8>>8)&&0===f,m=e.db2ThemingColor[h],g=0===e.dbIdOpacity[h];if(m||g){if(!r){r=new Uint32Array(s);for(var v=0;v<s;v++)r[v]=i.getColorAt(v);e.originalColors[t]=r}d=g?0:E(d,m),a=!0}else r&&(d=r[u]);if(!g){var y=e.dbIdOpacity[h];if(!isNaN(y))d=d&parseInt("00FFFFFF",16)|(y=255*y<<24)}o.setColorAt(u,d);var b=e.dbIdIsGhosted[h]&&!p,x=i.getVertexFlagsAt(u);b?x|=255<<24:x&=16777215,o.setVertexFlagsAt(u,x)}a||(e.originalColors[t]=null),n.vbNeedsUpdate=!0}}}var A;function S(e,t){if(e.is2d){var r=e.fragments.dbId2fragId[t];if(Array.isArray(r))for(var n=0;n<r.length;n++)e.themingOrGhostingNeedsUpdate[r[n]]=!0;else"number"==typeof r?e.themingOrGhostingNeedsUpdate[r]=!0:e.themingOrGhostingNeedsUpdateByDbId[t]=!0}}function M(e,t){this.frags=e,this.fragId=t,this.scale=null,this.quaternion=null,this.position=null}g.prototype.getVizmesh=function(e){if(this.is2d&&function(e,t){e.themingOrGhostingNeedsUpdate[t]&&(w(e,t),e.themingOrGhostingNeedsUpdate[t]=!1)}(this,e),this.useThreeMesh){var t=this.vizmeshes[e];return t&&(t.themingColor=this.db2ThemingColor[t.dbId]),t}var r=this.scratchMesh=this.scratchMesh||function(){var e=new i.Mesh;return e.isTemp=!0,e.dbId=0,e.modelId=0,e.fragId=-1,e.hide=!1,e.isLine=!1,e.isWideLine=!1,e.isPoint=!1,e}();return r.geometry=this.getGeometry(e),r.material=this.getMaterial(e),r.dbId=this.getDbIds(e),r.modelId=this.modelId,r.fragId=e,r.visible=!0,r.isLine=this.isLine(e),r.isWideLine=this.isWideLine(e),r.isPoint=this.isPoint(e),r.hide=this.isFragOff(e),r.themingColor=this.db2ThemingColor[r.dbId],this.getWorldMatrix(e,r.matrixWorld),r},g.prototype.getMaterialId=function(e){var t=this.getMaterial(e);return t?t.id:0},g.prototype.getMaterial=function(e){return this.useThreeMesh?this.vizmeshes[e].material:this.materialIdMap[this.materialids[e]]},g.prototype.getGeometry=function(e){var t;return this.useThreeMesh?(t=this.vizmeshes[e])?t.geometry:null:this.geoms.getGeometry(this.geomids[e])},g.prototype.getGeometryId=function(e){return this.useThreeMesh?e:this.geomids[e]},g.prototype.setMaterial=function(e,t){if(this.useThreeMesh)this.vizmeshes[e].material=t;else{var r=this.materialmap[t.id];r||(r=this.nextMaterialId++,this.materialids=(0,s.W)(this.materialids,r),this.materialIdMap[r]=t,this.materialmap[t.id]=r),this.materialids[e]=r}},g.prototype.getCount=function(){return this.vizmeshes?this.vizmeshes.length:this.vizflags.length},g.prototype.getDbIds=function(e){return this.fragments.fragId2dbId[e]},g.prototype.dispose=function(e){if(this.useThreeMesh)for(var t={type:"dispose"},r={type:"removed"},n=0;n<this.vizmeshes.length;n++){var i=this.vizmeshes[n];i&&(i.dispatchEvent(r),i.geometry.dispatchEvent(t))}else this.geoms.dispose(e)},g.prototype.dtor=function(e){this.dispose(e),this.scratchMesh=null,this.fragments=null,this.geoms=null,this.boxes=null,this.transforms=null,this.vizflags=null,this.vizmeshes=null,this.geomids=null,this.materialids=null,this.materialmap=null,this.materialIdMap=null,this.db2ThemingColor=null,this.originalColors=null,this.themingOrGhostingNeedsUpdate=null,this.themingOrGhostingNeedsUpdateByDbId=null,this.dbIdOpacity=null,this.dbIdIsGhosted=null,this.animxforms=null,this.matrix=null,this.viewBounds=null},g.prototype.setVisibility=function(e,t){this.setFlagFragment(e,o.MeshFlags.MESH_VISIBLE,t),this.allVisibleDirty=!0},g.prototype.setFragOff=function(e,t){this.setFlagFragment(e,o.MeshFlags.MESH_HIDE,t),this.allVisibleDirty=!0},g.prototype.setAllVisibility=function(e){if(this.is2d){var t=this.fragments;if(t&&t.dbId2fragId)for(var r in t.dbId2fragId)this.setObject2DGhosted(parseInt(r),!e)}else this.setFlagGlobal(o.MeshFlags.MESH_VISIBLE,e);this.allVisible=e,this.allVisibleDirty=!1},g.prototype.updateAnimTransform=function(e,t,r,n){var i,a=this.animxforms;if(!a){var s=this.getCount();a=this.animxforms=new Float32Array(10*s);for(var l=0;l<s;l++)a[i=10*l]=1,a[i+1]=1,a[i+2]=1,a[i+3]=0,a[i+4]=0,a[i+5]=0,a[i+6]=1,a[i+7]=0,a[i+8]=0,a[i+9]=0}i=10*e;var u=!1;t&&(a[i]=t.x,a[i+1]=t.y,a[i+2]=t.z,u=!0),r&&(a[i+3]=r.x,a[i+4]=r.y,a[i+5]=r.z,a[i+6]=r.w,u=!0),n&&(a[i+7]=n.x,a[i+8]=n.y,a[i+9]=n.z,u=!0),this.setFlagFragment(e,o.MeshFlags.MESH_MOVED,u),u||(a[i]=1,a[i+1]=1,a[i+2]=1,a[i+3]=0,a[i+4]=0,a[i+5]=0,a[i+6]=1,a[i+7]=0,a[i+8]=0,a[i+9]=0)},g.prototype.getAnimTransform=function(e,t,r,n){if(!this.animxforms)return!1;if(!this.isFlagSet(e,o.MeshFlags.MESH_MOVED))return!1;var i=10*e,a=this.animxforms;return t&&(t.x=a[i],t.y=a[i+1],t.z=a[i+2]),r&&(r.x=a[i+3],r.y=a[i+4],r.z=a[i+5],r.w=a[i+6]),n&&(n.x=a[i+7],n.y=a[i+8],n.z=a[i+9]),!0},g.prototype.getOriginalWorldMatrix=function(e,t){var r=12*e,n=t.elements,i=this.transforms;if(i)n[0]=i[r],n[1]=i[r+1],n[2]=i[r+2],n[3]=0,n[4]=i[r+3],n[5]=i[r+4],n[6]=i[r+5],n[7]=0,n[8]=i[r+6],n[9]=i[r+7],n[10]=i[r+8],n[11]=0,n[12]=i[r+9],n[13]=i[r+10],n[14]=i[r+11],n[15]=1;else if(this.useThreeMesh){var o=this.vizmeshes[e];o?t.copy(o.matrix):t.identity()}else t.identity()},g.prototype.getWorldMatrix=(A=new i.Matrix4,function(e,t){this.getOriginalWorldMatrix(e,t),this.isFlagSet(e,o.MeshFlags.MESH_MOVED)&&(this.getAnimTransform(e,m,f,p),A.compose(p,f,m),t.multiplyMatrices(A,t)),this.matrix&&t.multiplyMatrices(this.matrix,t)}),g.prototype.setModelMatrix=function(e){var t=this;e?(this.matrix=this.matrix||new i.Matrix4,this.matrix.copy(e),this.useThreeMesh&&this.vizmeshes.forEach((function(e){e.matrixWorld.multiplyMatrices(t.matrix,e.matrix)}))):(this.matrix=null,this.useThreeMesh&&this.vizmeshes.forEach((function(e){e.matrixWorld.copy(e.matrix)}))),this.invMatrix=null},g.prototype.getInverseModelMatrix=function(){return this.matrix?(this.invMatrix||(this.invMatrix=this.matrix.clone().invert()),this.invMatrix):null},g.prototype.getWorldBounds=function(e,t){if(this.boxes&&!this.isFlagSet(e,o.MeshFlags.MESH_MOVED)){var r=this.boxes,n=6*e;return t.min.x=r[n],t.min.y=r[n+1],t.min.z=r[n+2],t.max.x=r[n+3],t.max.y=r[n+4],t.max.z=r[n+5],void(this.matrix&&t.applyMatrix4(this.matrix))}if(this.useThreeMesh){var i=this.vizmeshes[e];i&&i.geometry&&t.copy(i.geometry.boundingBox)}else this.geoms.getModelBox(this.geomids[e],t);this.viewBounds&&t.intersect(this.viewBounds),t.isEmpty()?t.makeEmpty():(this.getWorldMatrix(e,h),t.applyMatrix4(h))},g.prototype.getOriginalWorldBounds=function(e,t){if(this.boxes){var r=this.boxes,n=6*e;return t[0]=r[n],t[1]=r[n+1],t[2]=r[n+2],t[3]=r[n+3],t[4]=r[n+4],void(t[5]=r[n+5])}if(this.useThreeMesh){var i=this.vizmeshes[e];i&&i.geometry&&d.copy(i.geometry.boundingBox)}else this.geoms.getModelBox(this.geomids[e],d);d.isEmpty()||(this.getOriginalWorldMatrix(e,h),d.applyMatrix4(h)),t[0]=d.min.x,t[1]=d.min.y,t[2]=d.min.z,t[3]=d.max.x,t[4]=d.max.y,t[5]=d.max.z},g.prototype.setThemingColor=function(e,t){var r=this.db2ThemingColor[e];r===t||r&&t&&r.equals(t)||(this.db2ThemingColor[e]=t||void 0,S(this,e))},g.prototype.clearThemingColors=function(){if(this.is2d){for(var e in this.fragments.dbId2fragId)S(this,parseInt(e));delete this.db2ThemingColor[-1]}this.db2ThemingColor.length=0},g.prototype.setObject2DGhosted=function(e,t){!!t!=!!this.dbIdIsGhosted[e]&&(this.dbIdIsGhosted[e]=t,S(this,e))},g.prototype.setObject2DOpacity=function(e,t){t!==this.dbIdOpacity[e]&&(this.dbIdOpacity[e]=t,S(this,e))},g.prototype.setObject2DVisible=function(e,t){t!==(0!==this.dbIdOpacity[e])&&(this.dbIdOpacity[e]=0|t,S(this,e))},g.prototype.getViewBounds=function(){return this.viewBounds},g.prototype.setViewBounds=function(e){e?(this.viewBounds=this.viewBounds||new i.Box3,this.viewBounds.copy(e),e.max.hasOwnProperty("z")||(this.viewBounds.max.z=1/0,this.viewBounds.min.z=-1/0)):this.viewBounds=null},g.prototype.getDoNotCut=function(){return this.doNotCut},g.prototype.setDoNotCut=function(e){this.doNotCut=e},M.prototype.getWorldMatrix=function(e){this.frags.getWorldMatrix(this.fragId,e)},M.prototype.getOriginalWorldMatrix=function(e){this.frags.getOriginalWorldMatrix(this.fragId,e)},M.prototype.getWorldBounds=function(e){return this.frags.getWorldBounds(this.fragId,e)},M.prototype.getAnimTransform=function(){return this.scale||(this.scale=new i.Vector3(1,1,1),this.quaternion=new i.Quaternion(0,0,0,1),this.position=new i.Vector3(0,0,0)),this.frags.getAnimTransform(this.fragId,this.scale,this.quaternion,this.position)},M.prototype.updateAnimTransform=function(){this.scale||(this.scale=new i.Vector3(1,1,1),this.quaternion=new i.Quaternion(0,0,0,1),this.position=new i.Vector3(0,0,0)),this.frags.updateAnimTransform(this.fragId,this.scale,this.quaternion,this.position)},M.prototype.getMaterial=function(){return this.frags.getMaterial(this.fragId)},M.prototype.setMaterial=function(e){return this.frags.setMaterial(this.fragId,e)}},29747:(e,t,r)=>{"use strict";r.r(t),r.d(t,{FrustumIntersector:()=>o,OUTSIDE:()=>l,INTERSECTS:()=>u,CONTAINS:()=>c,CONTAINMENT_UNKNOWN:()=>h});var n=r(23909),i=[[1,5,4,7,3,2,6],[0,3,2,1,5,4,6],[0,3,2,6,5,4,6],[0,4,7,3,2,1,6],[0,3,2,1,-1,-1,4],[0,3,2,6,5,1,6],[0,4,7,6,2,1,6],[0,3,7,6,2,1,6],[0,3,7,6,5,1,6],[0,1,5,4,7,3,6],[0,1,5,4,-1,-1,4],[0,1,2,6,5,4,6],[0,4,7,3,-1,-1,4],[-1,-1,-1,-1,-1,-1,0],[1,2,6,5,-1,-1,4],[0,4,7,6,2,3,6],[2,3,7,6,-1,-1,4],[1,2,3,7,6,5,6],[0,1,5,6,7,3,6],[0,1,5,6,7,4,6],[0,1,2,6,7,4,6],[0,4,5,6,7,3,6],[4,5,6,7,-1,-1,4],[1,2,6,7,4,5,6],[0,4,5,6,2,3,6],[2,3,7,4,5,6,6],[1,2,3,7,4,5,6]];function o(){this.frustum=new n.Frustum,this.viewProj=new n.Matrix4,this.viewDir=[0,0,1],this.ar=1,this.viewport=new n.Vector3(1,1,1),this.areaConv=1,this.areaCullThreshold=1,this.eye=new n.Vector3,this.perspective=!1}var a,s,l=0,u=1,c=2,h=-1;function d(e,t,r){return r.x=1&t?e.max.x:e.min.x,r.y=2&t?e.max.y:e.min.y,r.z=4&t?e.max.z:e.min.z,r}o.OUTSIDE=l,o.INTERSECTS=u,o.CONTAINS=c,o.CONTAINMENT_UNKNOWN=h,o.prototype.reset=function(e,t){this.viewProj.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),this.perspective=e.isPerspective,this.frustum.setFromProjectionMatrix(this.viewProj);var r=e.matrixWorldInverse.elements;this.ar=e.aspect,this.viewDir[0]=-r[2],this.viewDir[1]=-r[6],this.viewDir[2]=-r[10],this.eye.x=e.position.x,this.eye.y=e.position.y,this.eye.z=e.position.z,this.areaConv=e.clientWidth*e.clientHeight/4,this.cutPlanes=t},o.prototype.projectedArea=function(){var e=[new n.Vector3,new n.Vector3,new n.Vector3,new n.Vector3,new n.Vector3,new n.Vector3,new n.Vector3,new n.Vector3],t=new n.Box2;function r(e,t){var r=e.x,n=e.y,i=e.z,o=t.elements,a=o[3]*r+o[7]*n+o[11]*i+o[15];a<0&&(a=-a);var s=1/a;e.x=(o[0]*r+o[4]*n+o[8]*i+o[12])*s,e.y=(o[1]*r+o[5]*n+o[9]*i+o[13])*s}return function(n){if(n.isEmpty())return 0;var i=this.viewProj;e[0].set(n.min.x,n.min.y,n.min.z),e[1].set(n.min.x,n.min.y,n.max.z),e[2].set(n.min.x,n.max.y,n.min.z),e[3].set(n.min.x,n.max.y,n.max.z),e[4].set(n.max.x,n.min.y,n.min.z),e[5].set(n.max.x,n.min.y,n.max.z),e[6].set(n.max.x,n.max.y,n.min.z),e[7].set(n.max.x,n.max.y,n.max.z);for(var o=0;o<8;o++)r(e[o],i);return t.makeEmpty(),t.setFromPoints(e),t.min.x<-1&&(t.min.x=-1),t.min.x>1&&(t.min.x=1),t.min.y<-1&&(t.min.y=-1),t.min.y>1&&(t.min.y=1),t.max.x>1&&(t.max.x=1),t.max.x<-1&&(t.max.x=-1),t.max.y>1&&(t.max.y=1),t.max.y<-1&&(t.max.y=-1),(t.max.x-t.min.x)*(t.max.y-t.min.y)}}(),o.prototype.projectedBoxArea=function(){for(var e,t=[],r=[],o=0;o<10;o++)t.push(new n.Vector3),r.push(new n.Vector3);function a(e,t){var r=e.x,n=e.y,i=e.z,o=t.elements,a=o[3]*r+o[7]*n+o[11]*i+o[15];a<0&&(a=-a);var s=1/a;e.x=(o[0]*r+o[4]*n+o[8]*i+o[12])*s,e.y=(o[1]*r+o[5]*n+o[9]*i+o[13])*s}return function(n,o){if(n.isEmpty())return 0;var s,l=this.viewProj;if(this.perspective?(s=this.eye.x>=n.min.x?this.eye.x>n.max.x?2:1:0,this.eye.y>=n.min.y&&(s+=this.eye.y>n.max.y?6:3),this.eye.z>=n.min.z&&(s+=this.eye.z>n.max.z?18:9)):(s=this.viewDir[0]<=0?this.viewDir[0]<0?2:1:0,this.viewDir[1]<=0&&(s+=this.viewDir[1]<0?6:3),this.viewDir[2]<=0&&(s+=this.viewDir[2]<0?18:9)),13===s)return 4;var u,c=i[s][6];for(u=0;u<c;u++){var h=i[s][u];t[u].set((h+1)%4<2?n.min.x:n.max.x,h%4<2?n.min.y:n.max.y,h<4?n.min.z:n.max.z),a(t[u],l)}var d=0;if(o)for(d=(t[c-1].x-t[0].x)*(t[c-1].y+t[0].y),u=0;u<c-1;u++)d+=(t[u].x-t[u+1].x)*(t[u].y+t[u+1].y);else{var f=function(t,n){var i,o,a,s,l,u,c,h,d=t,f=r,p=function(e){switch(c){case 0:return e.x>=-1;case 1:return e.x<=1;case 2:return e.y>=-1;case 3:return e.y<=1}},m=function(e){f[h].x=e.x,f[h++].y=e.y},g=function(){var e,t;switch(c){case 0:e=-1,t=o.y+(a.y-o.y)*(e-o.x)/(a.x-o.x);break;case 1:e=1,t=o.y+(a.y-o.y)*(e-o.x)/(a.x-o.x);break;case 2:t=-1,e=o.x+(a.x-o.x)*(t-o.y)/(a.y-o.y);break;case 3:t=1,e=o.x+(a.x-o.x)*(t-o.y)/(a.y-o.y)}f[h].x=e,f[h++].y=t};for(c=0;c<4&&n>2;c++){for(h=0,s=p(o=d[n-1]),u=0;u<n;u++)l=p(a=d[u]),s?l?m(a):g():l&&(g(),m(a)),o=a,s=l;n=h,i=d,d=f,f=i}return e=n,d}(t,c);if(e>=3)for(d=(f[e-1].x-f[0].x)*(f[e-1].y+f[0].y),u=0;u<e-1;u++)d+=(f[u].x-f[u+1].x)*(f[u].y+f[u+1].y)}return Math.abs(.5*d)}}(),o.prototype.estimateDepth=function(e){var t=this.viewProj.elements,r=(e.min.x+e.max.x)/2,n=(e.min.y+e.max.y)/2,i=(e.min.z+e.max.z)/2,o=1/(t[3]*r+t[7]*n+t[11]*i+t[15]);return(t[2]*r+t[6]*n+t[10]*i+t[14])*o},o.prototype.intersectsBox=(a=new n.Vector3,s=new n.Vector3,function(e){for(var t=this.frustum.planes,r=0,n=0;n<6;n++){var i=t[n];a.x=i.normal.x>0?e.min.x:e.max.x,s.x=i.normal.x>0?e.max.x:e.min.x,a.y=i.normal.y>0?e.min.y:e.max.y,s.y=i.normal.y>0?e.max.y:e.min.y,a.z=i.normal.z>0?e.min.z:e.max.z,s.z=i.normal.z>0?e.max.z:e.min.z;var l=i.distanceToPoint(a),u=i.distanceToPoint(s);if(l<0&&u<0)return o.OUTSIDE;l>0&&u>0&&r++}return 6==r?o.CONTAINS:o.INTERSECTS});var f,p=function(e,t){f||(f=new n.Vector3);for(var r=0;r<8;r++){var i=d(e,r,f);if(a=t,!((o=i).x*a.x+o.y*a.y+o.z*a.z+a.w>1e-6))return!1}var o,a;return!0};o.prototype.boxOutsideCutPlanes=function(e){if(!this.cutPlanes)return!1;for(var t=0;t<this.cutPlanes.length;t++){var r=this.cutPlanes[t];if(p(e,r))return!0}return!1}},25920:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GeometryList:()=>a});var n=r(92445),i=r(84998),o=r(23909);function a(e,t,r,n){this.geoms=[null],this.numGeomsInMemory=0,this.geomMemory=0,this.gpuMeshMemory=0,this.gpuNumMeshes=0,this.geomPolyCount=0,this.instancePolyCount=0,this.is2d=t,this.geomBoxes=n?null:new Float32Array(6*Math.max(1,e+1)),this.numObjects=e,this.disableStreaming=!!r}a.prototype.getGeometry=function(e){return this.geoms[e]},a.prototype.chooseMemoryType=function(e,t,r,i){var o=n.GPU_MEMORY_LIMIT,a=2*o,s=n.GPU_OBJECT_LIMIT;if(0===o)return e.streamingDraw=!0,void(e.streamingIndex=!0);if(this.disableStreaming||i<o&&r<s)e.streamingDraw=!1,e.streamingIndex=!1;else if(i>=a)e.streamingDraw=!0,e.streamingIndex=!0;else{(this.is2d?100001:e.byteSize*(t||1))<1e5&&(e.streamingDraw=!0,e.streamingIndex=!0)}},a.prototype.addGeometry=function(e,t,r){var a;this.chooseMemoryType(e,t,this.gpuNumMeshes,this.gpuMeshMemory);var s=e.byteSize+n.GEOMETRY_OVERHEAD;if(e.streamingDraw||((0,i.isMobileDevice)()&&(s+=e.byteSize),this.gpuMeshMemory+=e.byteSize,this.gpuNumMeshes+=1),this.numGeomsInMemory++,(void 0===r||r<=0)&&(r=this.geoms.length),this.geoms[r]=e,this.geomBoxes){var l=this.geomBoxes.length/6|0;if(l<this.geoms.length){var u=3*this.geoms.length/2|0,c=new Float32Array(6*u);c.set(this.geomBoxes);var h=new o.Box3;for(h.makeEmpty();l<u;)c[6*l]=h.min.x,c[6*l+1]=h.min.y,c[6*l+2]=h.min.z,c[6*l+3]=h.max.x,c[6*l+4]=h.max.y,c[6*l+++5]=h.max.z;this.geomBoxes=c}var d=e.boundingBox;d?(this.geomBoxes[6*r]=d.min.x,this.geomBoxes[6*r+1]=d.min.y,this.geomBoxes[6*r+2]=d.min.z,this.geomBoxes[6*r+3]=d.max.x,this.geomBoxes[6*r+4]=d.max.y,this.geomBoxes[6*r+5]=d.max.z):(e.hash||console.error("Mesh without bbox and without hash should not be."),this.geomBoxes[6*r]=-.5,this.geomBoxes[6*r+1]=-.5,this.geomBoxes[6*r+2]=-.5,this.geomBoxes[6*r+3]=.5,this.geomBoxes[6*r+4]=.5,this.geomBoxes[6*r+5]=.5)}n.memoryOptimizedLoading&&!this.is2d&&(e.boundingBox=null,e.boundingSphere=null),this.geomMemory+=s;var f,p=(null===(a=e.index)||void 0===a?void 0:a.array)||e.ib,m=e.isLines?2:3;return f=p?p.length/m:e.vb?e.vb.length/(m*e.stride):e.attributes.position.length/(3*m),this.geomPolyCount+=f,this.instancePolyCount+=f*(t||1),e.polyCount=f,e.instanceCount=t||1,e.svfid=r,r},a.prototype.removeGeometry=function(e,t){var r=this.getGeometry(e);if(!r)return 0;var o=r.byteSize+n.GEOMETRY_OVERHEAD;return t&&t.deallocateGeometry(r),r.streamingDraw||((0,i.isMobileDevice)()&&(o+=r.byteSize),this.gpuMeshMemory-=r.byteSize,this.gpuNumMeshes-=1),this.geoms[e]=null,this.geomMemory-=o,this.numGeomsInMemory--,this.geomPolyCount-=r.polyCount,this.instancePolyCount-=r.instanceCount*r.polyCount,o},a.prototype.getModelBox=function(e,t){if(this.geomBoxes)if(0===e||this.geomBoxes.length/6<=e)t.makeEmpty();else{var r=6*e,n=this.geomBoxes;t.min.x=n[r],t.min.y=n[r+1],t.min.z=n[r+2],t.max.x=n[r+3],t.max.y=n[r+4],t.max.z=n[r+5]}else e>=1&&e<=this.numObjects?(t.min.x=-.5,t.min.y=-.5,t.min.z=-.5,t.max.x=.5,t.max.y=.5,t.max.z=.5):t.makeEmpty()},a.prototype.dispose=function(e){if(e)for(var t=0,r=this.geoms.length;t<r;t++)this.geoms[t]&&e.deallocateGeometry(this.geoms[t])},a.prototype.printStats=function(){console.log("Total geometry size: "+this.geomMemory/1048576+" MB"),console.log("Number of meshes: "+(this.geoms.length-1)),console.log("Num Meshes on GPU: "+this.gpuNumMeshes),console.log("Net GPU geom memory used: "+this.gpuMeshMemory)}},1840:(e,t,r)=>{"use strict";r.r(t),r.d(t,{NODE_TYPE:()=>o,InstanceTree:()=>l});var n=r(82197),i=r(98926),o={NODE_TYPE_ASSEMBLY:0,NODE_TYPE_INSERT:1,NODE_TYPE_LAYER:2,NODE_TYPE_COLLECTION:3,NODE_TYPE_COMPOSITE:4,NODE_TYPE_MODEL:5,NODE_TYPE_GEOMETRY:6,NODE_TYPE_BITS:7},a=1073741824,s=2147483648;function l(e,t,r){this.nodeAccess=e,this.maxDepth=r,this.objectCount=t,this.numHidden=0,this.numOff=0,this.fragList=null}l.prototype.dtor=function(){this.nodeAccess.dtor(),this.nodeAccess=null,this.fragList=null},l.prototype.setFlagNode=function(e,t,r){var n=this.nodeAccess.getNodeFlags(e);return!!(n&t)!=r&&(r?this.nodeAccess.setNodeFlags(e,n|t):this.nodeAccess.setNodeFlags(e,n&~t),!0)},l.prototype.setFlagGlobal=function(e,t){var r=this.nodeAccess,n=0,i=r.numNodes;if(t)for(;n<i;n++)r.setNodeFlags(n,r.getNodeFlags(n)|e);else for(var o=~e;n<i;n++)r.setNodeFlags(n,r.getNodeFlags(n)&o)},l.prototype.setNodeOff=function(e,t){var r=this.setFlagNode(e,a,t);return r&&(t?this.numOff++:this.numOff--),r},l.prototype.isNodeOff=function(e){return!!(this.nodeAccess.getNodeFlags(e)&a)},l.prototype.setNodeHidden=function(e,t){var r=this.setFlagNode(e,s,t);return r&&(t?this.numHidden++:this.numHidden--),r},l.prototype.isNodeHidden=function(e){return!!(this.nodeAccess.getNodeFlags(e)&s)},l.prototype.lockNodeSelection=function(e,t){return this.setFlagNode(e,16384,t)},l.prototype.isNodeSelectionLocked=function(e){return!!(16384&this.nodeAccess.getNodeFlags(e))},l.prototype.lockNodeVisible=function(e,t){return this.setFlagNode(e,4096,t)},l.prototype.isNodeVisibleLocked=function(e){return!!(4096&this.nodeAccess.getNodeFlags(e))},l.prototype.isNodeExplodeLocked=function(e){return!!(8192&this.nodeAccess.getNodeFlags(e))},l.prototype.lockNodeExplode=function(e,t){return this.setFlagNode(e,8192,t)},l.prototype.getNodeType=function(e){return this.nodeAccess.getNodeFlags(e)&o.NODE_TYPE_BITS},l.prototype.isNodeSelectable=function(e){return!(536870912&this.nodeAccess.getNodeFlags(e))},l.prototype.getNodeParentId=function(e){return this.nodeAccess.getParentId(e)},l.prototype.getRootId=function(){return this.nodeAccess.rootId},l.prototype.getNodeName=function(e,t){return this.nodeAccess.name(e,t)},l.prototype.getChildCount=function(e){return this.nodeAccess.getNumChildren(e)};var u=new Array(6);l.prototype.getNodeBox=function(e,t){var r=this;if(!this.nodeAccess.nodeBoxes)return this.fragList?(t[0]=t[1]=t[2]=1/0,t[3]=t[4]=t[5]=-1/0,void this.enumNodeFragments(e,(function(e){r.fragList.getOriginalWorldBounds(e,u),t[0]=Math.min(t[0],u[0]),t[1]=Math.min(t[1],u[1]),t[2]=Math.min(t[2],u[2]),t[3]=Math.max(t[3],u[3]),t[4]=Math.max(t[4],u[4]),t[5]=Math.max(t[5],u[5])}),!0)):void i.logger.error("getNodeBox() requires fragBoxes or nodeBoxes");this.nodeAccess.getNodeBox(e,t)},l.prototype.getNodeIndex=function(e){return this.nodeAccess.getIndex(e)},l.prototype.enumNodeFragments=function(e,t,r){var n,i=this;"number"==typeof e?n=e:e&&(n=e.dbId);return function e(n){var o=i.nodeAccess.enumNodeFragments(n,t);return o||(r&&(o=i.enumNodeChildren(n,(function(t){return e(t)})))?o:void 0)}(n)},l.prototype.enumNodeChildren=function(e,t,r){var n,i=this;if("number"==typeof e?n=e:e&&(n=e.dbId),r&&t(n))return n;return function e(n){var o=i.nodeAccess.enumNodeChildren(n,(function(n){return t(n)?n:r?e(n):void 0}));if(o)return o}(n)},l.prototype.findNodeForSelection=function(e,t){if(t===n.SelectionMode.LEAF_OBJECT)return e;var r,i,a=e;if(t===n.SelectionMode.FIRST_OBJECT){var s=[];for(r=e;r;)s.push(r),r=this.getNodeParentId(r);for(var l=s.length-1;l>=0;l--)if((i=this.getNodeType(s[l]))!==o.NODE_TYPE_MODEL&&i!==o.NODE_TYPE_LAYER&&i!==o.NODE_TYPE_COLLECTION){a=s[l];break}}else if(t===n.SelectionMode.LAST_OBJECT)for(r=e;r;){if((i=this.getNodeType(r))===o.NODE_TYPE_COMPOSITE){a=r;break}r=this.getNodeParentId(r)}return a},l.prototype.setFragmentList=function(e){this.fragList=e}},6420:(e,t,r)=>{"use strict";r.r(t),r.d(t,{FlatStringStorage:()=>o,InstanceTreeStorage:()=>a,InstanceTreeAccess:()=>l});var n=r(7913);function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var o=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t?(this.buf=t.buf,this.idx=t.idx,this.next=t.next):(this.buf=new Uint8Array(256),this.next=0,this.idx=[0])}var t,r,o;return t=e,(r=[{key:"allocate",value:function(e){if(this.buf.length-this.next<e){var t=Math.max(3*this.buf.length/2,this.buf.length+e),r=new Uint8Array(t);r.set(this.buf),this.buf=r}}},{key:"add",value:function(e){if(null==e)return 0;if(!e.length)return this.idx.push(this.next),this.idx.length-1;var t=(0,n.Ss)(e,null);return this.allocate(t),this.next+=(0,n.Ss)(e,this.buf,this.next),this.idx.push(this.next),this.idx.length-1}},{key:"get",value:function(e){if(e){var t=this.idx[e-1],r=this.idx[e];return t===r?"":(0,n.MA)(this.buf,t,r-t)}}},{key:"flatten",value:function(){this.idx=s(this.idx)}}])&&i(t.prototype,r),o&&i(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}();function a(){this.nodes=[],this.nextNode=0,this.children=[],this.nextChild=0,this.dbIdToIndex={},this.names=[],this.s2i={},this.strings=new o,this.nameSuffixes=[],this.getIndex(0)}function s(e){var t=new Int32Array(e.length);return t.set(e),t}function l(e,t,r){this.nodes=e.nodes,this.children=e.children,this.dbIdToIndex=e.dbIdToIndex,this.names=e.names,this.nameSuffixes=e.nameSuffixes,this.strings=new o(e.strings),this.rootId=t,this.numNodes=this.nodes.length/5,this.visibleIds=null,this.nodeBoxes=r}a.prototype.getIndex=function(e){var t=this.dbIdToIndex[e];if(t)return t;t=this.nextNode++,this.nodes.push(e);for(var r=1;r<5;r++)this.nodes.push(0);return this.dbIdToIndex[e]=t,t},a.prototype.setNode=function(e,t,r,n,i,o){var a,s=this.getIndex(e),l=5*s,u=i.length,c=o&&o.length;for(c&&(u+=o.length),this.nodes[l+1]=t,this.nodes[l+2]=this.nextChild,this.nodes[l+3]=c?-u:u,this.nodes[l+4]=n,a=0;a<i.length;a++)this.children[this.nextChild++]=this.getIndex(i[a]);if(c)for(a=0;a<o.length;a++)this.children[this.nextChild++]=-o[a]-1;this.nextChild>this.children.length&&console.error("Child index out of bounds -- should not happen"),this.processName(s,r)},a.prototype.processName=function(e,t){var r,n,i=-1,o=-1;if(t&&(o=t.lastIndexOf("]"),-1!==(i=t.lastIndexOf("["))&&-1!==o||(i=t.lastIndexOf(":"),o=t.length)),i>=0&&o>i){r=t.slice(0,i+1);var a=t.slice(i+1,o);(n=parseInt(a,10))&&n+""===a||(r=t,n=0)}else r=t,n=0;var s=this.s2i[r];void 0===s&&(s=this.strings.add(r),this.s2i[r]=s),this.names[e]=s,this.nameSuffixes[e]=n},a.prototype.flatten=function(){this.nodes=s(this.nodes),this.children=s(this.children),this.names=s(this.names),this.nameSuffixes=s(this.nameSuffixes),this.strings.flatten(),this.s2i=null},l.prototype.dtor=function(){this.nodes=null,this.children=null,this.dbIdToIndex=null,this.names=null,this.nameSuffixes=null,this.strings=null,this.visibleIds=null,this.nodeBoxes=null},l.prototype.getNumNodes=function(){return this.numNodes},l.prototype.getIndex=function(e){return this.dbIdToIndex[e]},l.prototype.name=function(e,t){var r,n=this.dbIdToIndex[e],i=this.strings.get(this.names[n]),o=this.nameSuffixes[n];o?r="["===i.charAt(i.length-1)?i+o+"]":i+o:r=i;return t&&(this.childCounts||this.computeChildCounts(),this.childCounts[e]>0&&(r+=" ("+this.childCounts[e]+")")),r},l.prototype.getParentId=function(e){var t=this.dbIdToIndex[e];return this.nodes[5*t+1]},l.prototype.getNodeFlags=function(e){var t=this.dbIdToIndex[e];return this.nodes[5*t+4]},l.prototype.setNodeFlags=function(e,t){var r=this.dbIdToIndex[e];r&&(this.nodes[5*r+4]=t)},l.prototype.getNumChildren=function(e){var t=this.dbIdToIndex[e],r=this.nodes[5*t+3];if(r>=0)return r;var n=this.nodes[5*t+2];r=Math.abs(r);for(var i=0,o=0;o<r;o++){if(this.children[n+o]<0)break;i++}return i},l.prototype.getNumFragments=function(e){var t=this.dbIdToIndex[e],r=this.nodes[5*t+3];if(r>=0)return 0;for(var n=this.nodes[5*t+2],i=0,o=(r=Math.abs(r))-1;o>=0;o--){if(this.children[n+o]>=0)break;i++}return i},l.prototype.getNodeBox=function(e,t){for(var r=6*this.getIndex(e),n=0;n<6;n++)t[n]=this.nodeBoxes[r+n]},l.prototype.getVisibleIds=function(){return this.visibleIds||(this.visibleIds=Object.keys(this.dbIdToIndex).map((function(e){return parseInt(e)}))),this.visibleIds},l.prototype.enumNodeChildren=function(e,t){var r=this.dbIdToIndex[e],n=this.nodes[5*r+2],i=this.nodes[5*r+3];i=Math.abs(i);for(var o=0;o<i;o++){var a=this.children[n+o];if(a<0)break;if(t(this.nodes[5*a+0],e,r))return e}},l.prototype.enumNodeFragments=function(e,t){var r=this.dbIdToIndex[e],n=this.nodes[5*r+2],i=this.nodes[5*r+3];if(i<0){i=-i;for(var o=0;o<i;o++){var a=this.children[n+o];if(!(a>0)&&t(-a-1,e,r))return e}}},l.prototype.computeBoxes=function(e){this.nodeBoxes||(this.nodeBoxes=new Float32Array(6*this.numNodes));var t=this,r=t.getIndex(t.rootId),n=t.nodeBoxes;function i(e,r,i){var o=t.getIndex(e);a(e,o);for(var s=6*i,l=6*o,u=0;u<3;u++)n[s+u]>n[l+u]&&(n[s+u]=n[l+u]),n[s+u+3]<n[l+u+3]&&(n[s+u+3]=n[l+u+3])}function o(t,r,i){for(var o=6*t,a=6*i,s=0;s<3;s++)n[a+s]>e[o+s]&&(n[a+s]=e[o+s]),n[a+s+3]<e[o+s+3]&&(n[a+s+3]=e[o+s+3])}function a(e,r){var a=6*r;n[a]=n[a+1]=n[a+2]=1/0,n[a+3]=n[a+4]=n[a+5]=-1/0,t.getNumChildren(e)&&t.enumNodeChildren(e,i,!0),t.getNumFragments(e)&&t.enumNodeFragments(e,o)}a(t.rootId,r)},l.prototype.computeChildCounts=function(){this.childCounts||(this.childCounts=new Uint32Array(this.numNodes));var e=this,t=(e.getIndex(e.rootId),e.childCounts);function r(r,i,o){var a=n(r,e.getIndex(r));t[i]+=a}function n(n,i){var o=0;return 4===e.getNodeFlags(n)?o=1:(e.getNumChildren(n)&&e.enumNodeChildren(n,r,!0),e.getNumFragments(n)&&(o=1)),o+t[n]}n(e.rootId)}},59481:(e,t,r)=>{"use strict";function n(e,t){return t<=255?new Uint8Array(e):t<=65535?new Uint16Array(e):new Uint32Array(e)}function i(e,t){if(t<=255)return e;if(t<=65535&&e instanceof Uint8Array){var r=new Uint16Array(e.length);return r.set(e),r}if(!e instanceof Uint32Array){var n=new Uint32Array(e.length);return n.set(e),n}return e}r.d(t,{R:()=>n,W:()=>i})},22585:(e,t,r)=>{"use strict";r.r(t),r.d(t,{LmvBox3:()=>a});var n,i,o=r(73075),a=function(e,t){this.min=void 0!==e?e:new o.LmvVector3(1/0,1/0,1/0),this.max=void 0!==t?t:new o.LmvVector3(-1/0,-1/0,-1/0)};a.prototype={constructor:a,set:function(e,t){return this.min.copy(e),this.max.copy(t),this},setFromPoints:function(e){this.makeEmpty();for(var t=0,r=e.length;t<r;t++)this.expandByPoint(e[t]);return this},setFromArray:function(e,t){return this.min.x=e[t],this.min.y=e[t+1],this.min.z=e[t+2],this.max.x=e[t+3],this.max.y=e[t+4],this.max.z=e[t+5],this},copyToArray:function(e,t){e[t]=this.min.x,e[t+1]=this.min.y,e[t+2]=this.min.z,e[t+3]=this.max.x,e[t+4]=this.max.y,e[t+5]=this.max.z},setFromCenterAndSize:(i=new o.LmvVector3,function(e,t){var r=i.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}),clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},empty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},isEmpty:function(){return this.empty()},center:function(e){return console.warn("LmvBox3.center() is deprecated. Use LmvBox3.getCenter() instead."),this.getCenter(e)},getCenter:function(e){return(e||new o.LmvVector3).addVectors(this.min,this.max).multiplyScalar(.5)},size:function(e){return(e||new o.LmvVector3).subVectors(this.max,this.min)},getSize:function(e){return(e||new o.LmvVector3).subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},containsPoint:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z},getParameter:function(e,t){return(t||new o.LmvVector3).set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))},isIntersectionBox:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)},intersectsBox:function(e){return this.isIntersectionBox(e)},clampPoint:function(e,t){return(t||new o.LmvVector3).copy(e).clamp(this.min,this.max)},distanceToPoint:function(){var e=new o.LmvVector3;return function(t){return e.copy(t).clamp(this.min,this.max).sub(t).length()}}(),intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},applyMatrix4:(n=[new o.LmvVector3,new o.LmvVector3,new o.LmvVector3,new o.LmvVector3,new o.LmvVector3,new o.LmvVector3,new o.LmvVector3,new o.LmvVector3],function(e){return n[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),n[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),n[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),n[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),n[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),n[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),n[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),n[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.makeEmpty(),this.setFromPoints(n),this}),translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}},43586:(e,t,r)=>{"use strict";r.r(t),r.d(t,{LmvMatrix4:()=>i});var n=r(73075),i=function(e){this.elements=e?new Float64Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]):new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),this.isDoublePrecision=!!e};i.prototype={constructor:i,set:function(e,t,r,n,i,o,a,s,l,u,c,h,d,f,p,m){var g=this.elements;return g[0]=e,g[4]=t,g[8]=r,g[12]=n,g[1]=i,g[5]=o,g[9]=a,g[13]=s,g[2]=l,g[6]=u,g[10]=c,g[14]=h,g[3]=d,g[7]=f,g[11]=p,g[15]=m,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},copy:function(e){return this.elements.set(e.elements),this},makeRotationFromQuaternion:function(e){var t=this.elements,r=e.x,n=e.y,i=e.z,o=e.w,a=r+r,s=n+n,l=i+i,u=r*a,c=r*s,h=r*l,d=n*s,f=n*l,p=i*l,m=o*a,g=o*s,v=o*l;return t[0]=1-(d+p),t[4]=c-v,t[8]=h+g,t[1]=c+v,t[5]=1-(u+p),t[9]=f-m,t[2]=h-g,t[6]=f+m,t[10]=1-(u+d),t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this},multiply:function(e){return this.multiplyMatrices(this,e)},multiplyMatrices:function(e,t){var r=e.elements,n=t.elements,i=this.elements,o=r[0],a=r[4],s=r[8],l=r[12],u=r[1],c=r[5],h=r[9],d=r[13],f=r[2],p=r[6],m=r[10],g=r[14],v=r[3],y=r[7],b=r[11],x=r[15],_=n[0],E=n[4],w=n[8],A=n[12],S=n[1],M=n[5],T=n[9],C=n[13],P=n[2],D=n[6],L=n[10],R=n[14],I=n[3],O=n[7],N=n[11],k=n[15];return i[0]=o*_+a*S+s*P+l*I,i[4]=o*E+a*M+s*D+l*O,i[8]=o*w+a*T+s*L+l*N,i[12]=o*A+a*C+s*R+l*k,i[1]=u*_+c*S+h*P+d*I,i[5]=u*E+c*M+h*D+d*O,i[9]=u*w+c*T+h*L+d*N,i[13]=u*A+c*C+h*R+d*k,i[2]=f*_+p*S+m*P+g*I,i[6]=f*E+p*M+m*D+g*O,i[10]=f*w+p*T+m*L+g*N,i[14]=f*A+p*C+m*R+g*k,i[3]=v*_+y*S+b*P+x*I,i[7]=v*E+y*M+b*D+x*O,i[11]=v*w+y*T+b*L+x*N,i[15]=v*A+y*C+b*R+x*k,this},multiplyToArray:function(e,t,r){var n=this.elements;return this.multiplyMatrices(e,t),r[0]=n[0],r[1]=n[1],r[2]=n[2],r[3]=n[3],r[4]=n[4],r[5]=n[5],r[6]=n[6],r[7]=n[7],r[8]=n[8],r[9]=n[9],r[10]=n[10],r[11]=n[11],r[12]=n[12],r[13]=n[13],r[14]=n[14],r[15]=n[15],this},multiplyScalar:function(e){var t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this},determinant:function(){var e=this.elements,t=e[0],r=e[4],n=e[8],i=e[12],o=e[1],a=e[5],s=e[9],l=e[13],u=e[2],c=e[6],h=e[10],d=e[14];return e[3]*(+i*s*c-n*l*c-i*a*h+r*l*h+n*a*d-r*s*d)+e[7]*(+t*s*d-t*l*h+i*o*h-n*o*d+n*l*u-i*s*u)+e[11]*(+t*l*c-t*a*d-i*o*c+r*o*d+i*a*u-r*l*u)+e[15]*(-n*a*u-t*s*c+t*a*h+n*o*c-r*o*h+r*s*u)},transpose:function(){var e,t=this.elements;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this},flattenToArrayOffset:function(e,t){var r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e[t+9]=r[9],e[t+10]=r[10],e[t+11]=r[11],e[t+12]=r[12],e[t+13]=r[13],e[t+14]=r[14],e[t+15]=r[15],e},setPosition:function(e){var t=this.elements;return t[12]=e.x,t[13]=e.y,t[14]=e.z,this},invert:function(e){var t=this.elements,r=t[0],n=t[1],i=t[2],o=t[3],a=t[4],s=t[5],l=t[6],u=t[7],c=t[8],h=t[9],d=t[10],f=t[11],p=t[12],m=t[13],g=t[14],v=t[15],y=h*g*u-m*d*u+m*l*f-s*g*f-h*l*v+s*d*v,b=p*d*u-c*g*u-p*l*f+a*g*f+c*l*v-a*d*v,x=c*m*u-p*h*u+p*s*f-a*m*f-c*s*v+a*h*v,_=p*h*l-c*m*l-p*s*d+a*m*d+c*s*g-a*h*g,E=r*y+n*b+i*x+o*_;if(0===E)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);var w=1/E;return t[0]=y*w,t[1]=(m*d*o-h*g*o-m*i*f+n*g*f+h*i*v-n*d*v)*w,t[2]=(s*g*o-m*l*o+m*i*u-n*g*u-s*i*v+n*l*v)*w,t[3]=(h*l*o-s*d*o-h*i*u+n*d*u+s*i*f-n*l*f)*w,t[4]=b*w,t[5]=(c*g*o-p*d*o+p*i*f-r*g*f-c*i*v+r*d*v)*w,t[6]=(p*l*o-a*g*o-p*i*u+r*g*u+a*i*v-r*l*v)*w,t[7]=(a*d*o-c*l*o+c*i*u-r*d*u-a*i*f+r*l*f)*w,t[8]=x*w,t[9]=(p*h*o-c*m*o-p*n*f+r*m*f+c*n*v-r*h*v)*w,t[10]=(a*m*o-p*s*o+p*n*u-r*m*u-a*n*v+r*s*v)*w,t[11]=(c*s*o-a*h*o-c*n*u+r*h*u+a*n*f-r*s*f)*w,t[12]=_*w,t[13]=(c*m*i-p*h*i+p*n*d-r*m*d-c*n*g+r*h*g)*w,t[14]=(p*s*i-a*m*i-p*n*l+r*m*l+a*n*g-r*s*g)*w,t[15]=(a*h*i-c*s*i+c*n*l-r*h*l-a*n*d+r*s*d)*w,this},getInverse:function(e,t){if(console.warn("LmvMatrix4.getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(e).invert(),0===this.determinant()){var r="Matrix4.getInverse(): can't invert matrix, determinant is 0";if(t)throw new Error(r);console.warn(r),this.identity()}return this},scale:function(e){var t=this.elements,r=e.x,n=e.y,i=e.z;return t[0]*=r,t[4]*=n,t[8]*=i,t[1]*=r,t[5]*=n,t[9]*=i,t[2]*=r,t[6]*=n,t[10]*=i,t[3]*=r,t[7]*=n,t[11]*=i,this},getMaxScaleOnAxis:function(){var e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],r=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],n=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,Math.max(r,n)))},makeTranslation:function(e,t,r){return this.set(1,0,0,e,0,1,0,t,0,0,1,r,0,0,0,1),this},makeRotationX:function(e){var t=Math.cos(e),r=Math.sin(e);return this.set(1,0,0,0,0,t,-r,0,0,r,t,0,0,0,0,1),this},makeRotationY:function(e){var t=Math.cos(e),r=Math.sin(e);return this.set(t,0,r,0,0,1,0,0,-r,0,t,0,0,0,0,1),this},makeRotationZ:function(e){var t=Math.cos(e),r=Math.sin(e);return this.set(t,-r,0,0,r,t,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(e,t){var r=Math.cos(t),n=Math.sin(t),i=1-r,o=e.x,a=e.y,s=e.z,l=i*o,u=i*a;return this.set(l*o+r,l*a-n*s,l*s+n*a,0,l*a+n*s,u*a+r,u*s-n*o,0,l*s-n*a,u*s+n*o,i*s*s+r,0,0,0,0,1),this},makeScale:function(e,t,r){return this.set(e,0,0,0,0,t,0,0,0,0,r,0,0,0,0,1),this},compose:function(e,t,r){return this.makeRotationFromQuaternion(t),this.scale(r),this.setPosition(e),this},decompose:function(){var e=new n.LmvVector3,t=new i(!0);return function(r,n,i){var o=this.elements,a=e.set(o[0],o[1],o[2]).length(),s=e.set(o[4],o[5],o[6]).length(),l=e.set(o[8],o[9],o[10]).length();this.determinant()<0&&(a=-a),r.x=o[12],r.y=o[13],r.z=o[14],t.elements.set(this.elements);var u=1/a,c=1/s,h=1/l;return t.elements[0]*=u,t.elements[1]*=u,t.elements[2]*=u,t.elements[4]*=c,t.elements[5]*=c,t.elements[6]*=c,t.elements[8]*=h,t.elements[9]*=h,t.elements[10]*=h,n.setFromRotationMatrix(t),i.x=a,i.y=s,i.z=l,this}}(),transformPoint:function(e){var t=e.x,r=e.y,n=e.z,i=this.elements;return e.x=i[0]*t+i[4]*r+i[8]*n+i[12],e.y=i[1]*t+i[5]*r+i[9]*n+i[13],e.z=i[2]*t+i[6]*r+i[10]*n+i[14],e},transformDirection:function(e){var t=e.x,r=e.y,n=e.z,i=this.elements;e.x=i[0]*t+i[4]*r+i[8]*n,e.y=i[1]*t+i[5]*r+i[9]*n,e.z=i[2]*t+i[6]*r+i[10]*n;var o=Math.sqrt(e.x*e.x+e.y*e.y+e.z*e.z);if(o>0){var a=1/o;e.x*=a,e.y*=a,e.z*=a}return e},equals:function(e){for(var t=this.elements,r=e.elements,n=0;n<16;n++)if(t[n]!==r[n])return!1;return!0},fromArray:function(e){return this.elements.set(e),this},toArray:function(){var e=this.elements;return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15]]},clone:function(){return new i(this.isDoublePrecision).fromArray(this.elements)}}},73075:(e,t,r)=>{"use strict";r.r(t),r.d(t,{LmvVector3:()=>s});var n,i,o,a,s=function(e,t,r){this.x=e||0,this.y=t||0,this.z=r||0};s.prototype={constructor:s,set:function(e,t,r){return this.x=e,this.y=t,this.z=r,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this},add:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this},sub:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this},multiply:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this},multiplyVectors:function(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this},applyMatrix3:function(e){var t=this.x,r=this.y,n=this.z,i=e.elements;return this.x=i[0]*t+i[3]*r+i[6]*n,this.y=i[1]*t+i[4]*r+i[7]*n,this.z=i[2]*t+i[5]*r+i[8]*n,this},applyMatrix4:function(e){var t=this.x,r=this.y,n=this.z,i=e.elements;return this.x=i[0]*t+i[4]*r+i[8]*n+i[12],this.y=i[1]*t+i[5]*r+i[9]*n+i[13],this.z=i[2]*t+i[6]*r+i[10]*n+i[14],this},applyProjection:function(e){var t=this.x,r=this.y,n=this.z,i=e.elements,o=1/(i[3]*t+i[7]*r+i[11]*n+i[15]);return this.x=(i[0]*t+i[4]*r+i[8]*n+i[12])*o,this.y=(i[1]*t+i[5]*r+i[9]*n+i[13])*o,this.z=(i[2]*t+i[6]*r+i[10]*n+i[14])*o,this},applyQuaternion:function(e){var t=this.x,r=this.y,n=this.z,i=e.x,o=e.y,a=e.z,s=e.w,l=s*t+o*n-a*r,u=s*r+a*t-i*n,c=s*n+i*r-o*t,h=-i*t-o*r-a*n;return this.x=l*s+h*-i+u*-a-c*-o,this.y=u*s+h*-o+c*-i-l*-a,this.z=c*s+h*-a+l*-o-u*-i,this},transformDirection:function(e){var t=this.x,r=this.y,n=this.z,i=e.elements;return this.x=i[0]*t+i[4]*r+i[8]*n,this.y=i[1]*t+i[5]*r+i[9]*n,this.z=i[2]*t+i[6]*r+i[10]*n,this.normalize(),this},divide:function(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this},divideScalar:function(e){if(0!==e){var t=1/e;this.x*=t,this.y*=t,this.z*=t}else this.x=0,this.y=0,this.z=0;return this},min:function(e){return this.x>e.x&&(this.x=e.x),this.y>e.y&&(this.y=e.y),this.z>e.z&&(this.z=e.z),this},max:function(e){return this.x<e.x&&(this.x=e.x),this.y<e.y&&(this.y=e.y),this.z<e.z&&(this.z=e.z),this},clamp:function(e,t){return this.x<e.x?this.x=e.x:this.x>t.x&&(this.x=t.x),this.y<e.y?this.y=e.y:this.y>t.y&&(this.y=t.y),this.z<e.z?this.z=e.z:this.z>t.z&&(this.z=t.z),this},clampScalar:function(e,t){return void 0===o&&(o=new s,a=new s),o.set(e,e,e),a.set(t,t,t),this.clamp(o,a)},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length())},setLength:function(e){var t=this.length();return 0!==t&&e!==t&&this.multiplyScalar(e/t),this},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this},lerpVectors:function(e,t,r){return this.subVectors(t,e).multiplyScalar(r).add(e),this},cross:function(e,t){if(void 0!==t)return console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t);var r=this.x,n=this.y,i=this.z;return this.x=n*e.z-i*e.y,this.y=i*e.x-r*e.z,this.z=r*e.y-n*e.x,this},crossVectors:function(e,t){var r=e.x,n=e.y,i=e.z,o=t.x,a=t.y,s=t.z;return this.x=n*s-i*a,this.y=i*o-r*s,this.z=r*a-n*o,this},projectOnVector:function(e){return void 0===n&&(n=new s),n.copy(e).normalize(),i=this.dot(n),this.copy(n).multiplyScalar(i)},projectOnPlane:function(){var e;return function(t){return void 0===e&&(e=new s),e.copy(this).projectOnVector(t),this.sub(e)}}(),reflect:function(){var e;return function(t){return void 0===e&&(e=new s),this.sub(e.copy(t).multiplyScalar(2*this.dot(t)))}}(),distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,r=this.y-e.y,n=this.z-e.z;return t*t+r*r+n*n},setEulerFromRotationMatrix:function(e,t){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(e,t){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(e){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(e)},getScaleFromMatrix:function(e){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(e)},getColumnFromMatrix:function(e,t){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(e,t)},setFromMatrixPosition:function(e){return this.x=e.elements[12],this.y=e.elements[13],this.z=e.elements[14],this},setFromMatrixScale:function(e){var t=this.set(e.elements[0],e.elements[1],e.elements[2]).length(),r=this.set(e.elements[4],e.elements[5],e.elements[6]).length(),n=this.set(e.elements[8],e.elements[9],e.elements[10]).length();return this.x=t,this.y=r,this.z=n,this},setFromMatrixColumn:function(e,t){var r=4*e,n=t.elements;return this.x=n[r],this.y=n[r+1],this.z=n[r+2],this},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this.z=e[t+2],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e},fromAttribute:function(e,t,r){return void 0===r&&(r=0),t=t*e.itemSize+r,this.x=e.array[t],this.y=e.array[t+1],this.z=e.array[t+2],this}}},46759:(e,t,r)=>{"use strict";r.r(t),r.d(t,{MeshFlags:()=>n});var n={MESH_VISIBLE:1,MESH_HIGHLIGHTED:2,MESH_HIDE:4,MESH_ISLINE:8,MESH_MOVED:16,MESH_RENDERFLAG:32,MESH_NOTLOADED:64,MESH_ISPOINT:128,MESH_ISWIDELINE:256,MESH_TRAVERSED:512,MESH_DRAWN:1024}},44669:(e,t,r)=>{"use strict";r.d(t,{i:()=>u});var n=r(23909);function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var o=new n.Vector3,a=new Float32Array(6),s="hierarchy",l=s,u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,u;return t=e,u=[{key:"setStrategy",value:function(e){if(l!==e)return l=e,!0}},{key:"getStrategy",value:function(){return l}},{key:"explode",value:function(e,t){var r=e.getData().instanceTree,i=e.getFragmentList(),u=e.getVisibleBounds(!0).getCenter(new n.Vector3);l===s&&r&&0!==t?function(e,t,r,n){var i=(r*=2)*(e.maxDepth-1)+1;1===e.maxDepth&&(i=r);var s=0|i,l=i-s;function u(n,i,c,h,d,f,p,m){var g=2*r;i==s&&(g*=l),e.getNodeBox(n,a);var v=.5*(a[0]+a[3]),y=.5*(a[1]+a[4]),b=.5*(a[2]+a[5]);i>0&&i<=s&&(f+=(v-c)*g,p+=(y-h)*g,m+=(b-d)*g),e.isNodeExplodeLocked(n)&&(f=p=m=0),e.enumNodeChildren(n,(function(e){u(e,i+1,v,y,b,f,p,m)}),!1),o.x=f,o.y=p,o.z=m,e.enumNodeFragments(n,(function(e){t.updateAnimTransform(e,null,null,o)}),!1)}u(e.getRootId(),0,n.x,n.y,n.z,0,0,0)}(r,i,t,u):function(e,t,r,n){var i,a,s=e.fragments.boxes;e.useThreeMesh?i=e.vizmeshes:a=e.fragments.fragId2dbId;for(var l=0,u=e.getCount();l<u;l++)if(0==r||t&&t.isNodeExplodeLocked(i?i[l]&&i[l].dbId:a[l]))e.updateAnimTransform(l);else{var c=6*l,h=.5*(s[c]+s[c+3]),d=.5*(s[c+1]+s[c+4]),f=.5*(s[c+2]+s[c+5]);o.x=r*(h-n.x),o.y=r*(d-n.y),o.z=r*(f-n.z),e.updateAnimTransform(l,null,null,o)}}(i,r,t,u)}}],(r=null)&&i(t.prototype,r),u&&i(t,u),Object.defineProperty(t,"prototype",{writable:!1}),e}()},18187:(e,t,r)=>{"use strict";r.r(t),r.d(t,{ModelIteratorBVH:()=>o});var n=r(29747),i=r(23909);function o(){var e,t,r,a,s,l=null,u=null,c=null,h=null,d=null,f=null,p=!0,m=!1,g=!1,v=new i.Box3,y=new i.Box3,b=!1,x=!0,_=null,E=null;function w(e){var n=f[e],i=r;for(1;i>t&&f[d[i-1]]>n;)d[i]=d[i-1],i--;d[i]=e,r++}function A(e){var t=l.getLeftChild(e);-1!==t&&(A(t),A(t+1)),v.makeEmpty(),-1!==t&&(l.getBoxThree(t,y),v.union(y),l.getBoxThree(t+1,y),v.union(y)),l.getPrimCount(e)&&(v.union(c[e].getBoundingBox()),v.union(c[e].getBoundingBoxHidden())),l.setBoxThree(e,v)}this.initialize=function(t,r,n,i){_=t,E=i,e=t.getFragmentList(),s=t.RenderBatch,i&&i.hasOwnProperty("prioritize_screen_size")&&(p=i.prioritize_screen_size),u=n,c=new Array(r.nodeCount),h=new Int8Array(r.nodeCount),l=r,d=new Int32Array(r.nodeCount+1),f=new Float32Array(r.nodeCount);for(var o=0;o<r.nodeCount;o++){var a=r.getPrimCount(o);a&&(c[o]=new s(e,u,r.getPrimStart(o),a),c[o].lastItem=c[o].start+a,c[o].numAdded=a,c[o].nodeIndex=o,8&r.getFlags(o)&&(c[o].sortObjects=!0),r.getBoxArray(o,c[o].bboxes))}},this.dtor=function(){s=null,e=null,_=null},this.addFragment=function(e,t){},this.reset=function(e){if(a=e,t=0,r=0,h[0]=h[1]=n.FrustumIntersector.CONTAINMENT_UNKNOWN,d[r++]=0,m=!1,g=!1,b=!1,x){for(var i=c,o=i.length,s=0;s<o;++s){var l=i[s];l&&l.resetVisStatus&&l.resetVisStatus()}x=!1}},this.nextBatch=function(){for(g||m||t!==r||(d[r++]=1,m=!0);t!==r;){var e=d[--r],i=h[e];if(i!==n.FrustumIntersector.CONTAINS&&(l.getBoxThree(e,v),i=a.intersectsBox(v)),i!==n.FrustumIntersector.OUTSIDE){var o,s,u=l.getLeftChild(e);if(-1!==u){var y=l.getFlags(e),x=a.viewDir[3&y]<0?1:0,_=y>>2&1,E=y>>3&1,A=0,S=0;p&&!m?(o=u+_,s=u+1-_,l.getBoxThree(o,v),f[o]=A=a.projectedBoxArea(v,i===n.FrustumIntersector.CONTAINS),l.getBoxThree(s,v),f[s]=S=a.projectedBoxArea(v,i===n.FrustumIntersector.CONTAINS),h[o]=h[s]=i,A>0&&w(o),S>0&&w(s)):(1^x^E&&(_=1-_),o=u+_,s=u+1-_,d[r++]=o,f[o]=-1,d[r++]=s,f[s]=-1,h[o]=h[s]=i)}if(0!==l.getPrimCount(e)){var M=c[e];return M.renderImportance=a.projectedBoxArea(M.getBoundingBox(),i===n.FrustumIntersector.CONTAINS),M}}m||g||t!==r||(d[r++]=1,m=!0)}return b=!0,null},this.skipOpaqueShapes=function(){m||g||(t=0,r=0,d[r++]=1,g=!0)},this.getVisibleBounds=function(e,t){for(var r=0;r<c.length;r++){var n=c[r];if(n){n.calculateBounds();var i=n.getBoundingBox();e.union(i),t.union(i),t.union(n.getBoundingBoxHidden())}}A(0),A(1)},this.rayCast=function(e,t,r){for(var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=[1,0],a=new i.Vector3;o.length;){var s=o.pop();if(l.getBoxThree(s,v),v.expandByScalar(.5),!(n.maxDistance&&v.distanceToPoint(e.ray.origin)>n.maxDistance)){var u=e.ray.intersectBox(v,a);if(null!==u){var h=l.getLeftChild(s);-1!==h&&(o.push(h),o.push(h+1));var d=l.getPrimCount(s);if(0!==d){var f=c[s];f.raycast(e,t,r)}}}}},this.intersectFrustum=function(e,t){for(var r=[1,n.FrustumIntersector.CONTAINMENT_UNKNOWN,0,n.FrustumIntersector.CONTAINMENT_UNKNOWN];r.length;){var i,o=r.pop(),a=r.pop();if(o===n.FrustumIntersector.CONTAINS?i=n.FrustumIntersector.CONTAINS:(l.getBoxThree(a,v),i=e.intersectsBox(v)),i!==n.FrustumIntersector.OUTSIDE){var s=l.getLeftChild(a);if(-1!==s&&(r.push(s),r.push(i),r.push(s+1),r.push(i)),0!==l.getPrimCount(a)){var u=c[a];u&&u.intersectFrustum(e,t,i===n.FrustumIntersector.CONTAINS)}}}},this.getSceneCount=function(){return c.length},this.getGeomScenes=function(){return c},this.done=function(){return b},this.resetVisStatus=function(){x=!0},this.clone=function(){var e=new o;return e.initialize(_,l,u,E),e}}},73080:(e,t,r)=>{"use strict";r.r(t),r.d(t,{ModelIteratorLinear:()=>l});r(44971);var n=r(84998),i=r(29747);function o(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return a(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return a(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,l=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){l=!0,o=e},f:function(){try{s||null==r.return||r.return()}finally{if(l)throw o}}}}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var l=function(){function e(t){var r,i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._frags=t.getFragmentList(),this._RenderBatch=t.RenderBatch,this._model=t,this._is2d=this._model.is2d(),this._fragsPerScene=(r=t.is2d(),i=500,r&&(i/=6),(0,n.isMobileDevice)()&&(i/=3),(i=Math.floor(i))>0?i:500),this._fragOrder=[],this._geomScenes=[],this._secondPassIndex=null;var o=this._frags.getCount();this._currentScene=0;for(var a=new Int32Array(o),s=0;s<o;s++)a[s]=s;this.setFragmentOrder(a,o)}var t,r,a;return t=e,(r=[{key:"dtor",value:function(){this.model=null,this._RenderBatch=null,this._frags=null}},{key:"setFragmentOrder",value:function(e,t){this._fragCount=t,this._fragOrder[0]=e;var r=Math.floor((this._fragCount+this._fragsPerScene-1)/this._fragsPerScene);this._geomScenes.length=r;for(var n=0;n<r;n++){var i=n*this._fragsPerScene,o=this._geomScenes[n]=new this._RenderBatch(this._frags,this._fragOrder,i,this._fragsPerScene),a=i+this._fragsPerScene;a>this._fragCount&&(a=this._fragCount),o.lastItem=a}}},{key:"addFragment",value:function(e){if(this._fragOrder[0].length<=e){var t=2*this._fragOrder[0].length;t<=e&&(t=e+1);var r=new Int32Array(t);r.set(this._fragOrder[0]),this._fragOrder[0]=r,this.visibleBoundsDirty=!0}this._fragOrder[0][e]=e;var n=Math.floor(e/this._fragsPerScene);if(this._geomScenes){var i=this._geomScenes[n];i&&!i.isSecondPass||(i=new this._RenderBatch(this._frags,this._fragOrder,n*this._fragsPerScene,this._fragsPerScene),null===this._secondPassIndex?this._geomScenes[n]=i:this.insertSceneToSecondPass(n,i)),i&&(i.onFragmentAdded(e),null!==this._secondPassIndex&&this._geomScenes[this._secondPassIndex+n].onFragmentAdded(e))}}},{key:"insertSceneToSecondPass",value:function(e,t){var r=this._geomScenes.slice(0,this._secondPassIndex),n=this._geomScenes.slice(this._secondPassIndex);r[e]=t,n[e]=this.cloneForSecondPass(t),this._secondPassIndex=r.length,this._geomScenes=r.concat(n)}},{key:"reset",value:function(e,t){if(this._currentScene=0,this._is2d&&this._geomScenes[0]&&(this._geomScenes[0].drawEnd=0,null!==this._secondPassIndex&&(this._geomScenes[this._secondPassIndex].drawEnd=0)),this._resetVisStatus){for(var r=this._geomScenes,n=r.length,i=0;i<n;++i){var o=r[i];o&&o.resetVisStatus&&o.resetVisStatus()}this._resetVisStatus=!1}}},{key:"getSceneCount",value:function(){return this._geomScenes.length}},{key:"getGeomScenes",value:function(){return this._geomScenes}},{key:"resetVisStatus",value:function(){this._resetVisStatus=!0}},{key:"done",value:function(){return!(this._is2d&&!this._model.isLoadDone())&&this._currentScene>=this._geomScenes.length-1&&(!(e=this._geomScenes[this._currentScene])||e.drawStart>=e.lastItem);var e}},{key:"nextBatch",value:function(){if(this._currentScene>=this.getSceneCount())return null;var e=this._geomScenes[this._currentScene];if(this._is2d){var t=this.areTwoPassesNeeded();if(e.lastItem>=e.start+e.count&&(++this._currentScene,this._geomScenes[this._currentScene]&&(this._geomScenes[this._currentScene].drawEnd=this._geomScenes[this._currentScene].start)),e.drawStart=e.drawEnd,e.drawEnd=e.lastItem,e.hasOwnProperty("drawStart")&&e.lastItem<=e.drawStart)return t&&!this._isSecondPass?(this._currentScene=this._secondPassIndex,this.nextBatch()):null;var r=!this._model.areAllVisible()||this._isSecondPass;e.renderImportance=r?-1:1e20,e.needsTwoPasses=t}else e.renderImportance=0,++this._currentScene;return e}},{key:"areTwoPassesNeeded",value:function(){var e=this._model.hasPaperTransparency();return e&&null===this._secondPassIndex&&this.addSecondPassScenes(),this._isSecondPass=!!(e&&this._currentScene>=this._secondPassIndex),e}},{key:"cloneForSecondPass",value:function(e){if(e){var t=e.clone();return t.isSecondPass=!0,t}}},{key:"addSecondPassScenes",value:function(){var e=this._geomScenes.length;e&&(this._geomScenes=this._geomScenes.concat(this._geomScenes.map(this.cloneForSecondPass)),this._secondPassIndex=e)}},{key:"getVisibleBounds",value:function(e,t){for(var r=this.getSceneCount(),n=0;n<r;n++){this._geomScenes[n].calculateBounds();var i=this._geomScenes[n].getBoundingBox();e.union(i),t.union(i),t.union(this._geomScenes[n].getBoundingBoxHidden())}}},{key:"rayCast",value:function(e,t,r){for(var n=this.getSceneCount(),i=0;i<n;i++)this._geomScenes[i].raycast(e,t,r)}},{key:"intersectFrustum",value:function(e,t){var r,n=o(this._geomScenes);try{for(n.s();!(r=n.n()).done;){var a=r.value;if(a){var s=e.intersectsBox(a.getBoundingBox());s!==i.FrustumIntersector.OUTSIDE&&a.intersectFrustum(e,t,s===i.FrustumIntersector.CONTAINS)}}}catch(e){n.e(e)}finally{n.f()}}},{key:"clone",value:function(){return new e(this._model)}}])&&s(t.prototype,r),a&&s(t,a),Object.defineProperty(t,"prototype",{writable:!1}),e}()},44971:(e,t,r)=>{"use strict";r.r(t),r.d(t,{RenderBatch:()=>c});var n=r(48862),i=r(29747),o=r(46759),a=r(2727),s=r(98926),l=new(r(22585).LmvBox3),u=null;function c(e,t,r,n){this.frags=e,this.indices=t,this.start=r,this.count=n,this.lastItem=r,this.overrideMaterial=null,this.sortDone=!1,this.numAdded=0,this.avgFrameTime=void 0,this.nodeIndex=void 0,this.bboxes=new Array(12),this.bboxes[0]=this.bboxes[1]=this.bboxes[2]=1/0,this.bboxes[3]=this.bboxes[4]=this.bboxes[5]=-1/0,this.bboxes[6]=this.bboxes[7]=this.bboxes[8]=1/0,this.bboxes[9]=this.bboxes[10]=this.bboxes[11]=-1/0,this.sortObjects=!1,this.sortDone=!1,this.sortByShaderDone=!1,this.frustumCulled=!0,this.forceVisible=!1,this.renderImmediate=!e.useThreeMesh,this.renderImportance=0}function h(e,t,r,n,i){var s,l=o.MeshFlags.MESH_RENDERFLAG,u=t[r]&~l;switch(e){case a.RenderFlags.RENDER_HIDDEN:s=!(u&o.MeshFlags.MESH_VISIBLE);break;case a.RenderFlags.RENDER_HIGHLIGHTED:s=u&o.MeshFlags.MESH_HIGHLIGHTED;break;default:s=1==(u&(o.MeshFlags.MESH_VISIBLE|o.MeshFlags.MESH_HIGHLIGHTED|o.MeshFlags.MESH_HIDE))}if(n){var c=u&(o.MeshFlags.MESH_ISLINE|o.MeshFlags.MESH_ISWIDELINE);s=s&&!c}if(i){var h=u&o.MeshFlags.MESH_ISPOINT;s=s&&!h}return t[r]=u|(s?l:0),s}function d(e,t,r,n,i){var o=!1;return r.getWorldBounds(n,l),e&&!t.intersectsBox(l)&&(o=!0),o||i||!t.boxOutsideCutPlanes(l)||(o=!0),o}c.prototype.clone=function(){var e=new c(this.frags,this.indices,this.start,this.count);return e.sortDone=this.sortDone,e.sortByShaderDone=this.sortByShaderDone,e.lastItem=this.lastItem,e.visibleStats=this.visibleStats,e.numAdded=this.numAdded,e.bboxes=this.bboxes.slice(),e},c.prototype.getIndices=function(){return Array.isArray(this.indices)?this.indices[0]:this.indices},c.prototype.sortByMaterial=function(){if(!(this.numAdded<this.count)){var e=this.frags,t=this.getIndices();if(t){var r=t.subarray(this.start,this.start+this.count);Array.prototype.sort.call(r,(function(t,r){var n=e.getMaterialId(t),i=e.getMaterialId(r);return void 0===n?i?1:0:void 0===i?-1:n-i})),this.numAdded=0,this.sortDone=!0}else s.logger.warn("Only indexed RenderSubsets can be sorted.")}},c.prototype.sortByShader=function(){if(this.sortDone&&!this.sortByShaderDone){var e=this.frags,t=this.getIndices().subarray(this.start,this.start+this.count);Array.prototype.sort.call(t,(function(t,r){var n=e.getMaterial(t),i=e.getMaterial(r),o=n.program.id-i.program.id;return o||n.id-i.id})),this.numAdded=0,this.sortByShaderDone=!0}},c.prototype.sortByDepth=function(e){var t=this.frags,r=this.getIndices(),n=e,i=l;if(r){(!u||u.length<this.count)&&(u=new Float32Array(this.count));var o,a,c=u,h=this.start;this.forEachNoMesh((function(e,r){t.getGeometry(e)?(t.getWorldBounds(e,i),c[r]=n.estimateDepth(i)):c[r]=-1/0}));for(var d=1;d<this.count;d++)for(var f=d;f>0&&c[f-1]<c[f];)o=c[f-1],c[f-1]=c[f],c[f]=o,a=r[h+f-1],r[h+f-1]=r[h+f],r[h+f]=a,f--}else s.logger.warn("Only indexed RenderSubsets can be sorted.")},c.prototype.addToBox=function(e,t){var r=t?6:0,n=this.bboxes;n[0+r]=Math.min(n[0+r],e.min.x),n[1+r]=Math.min(n[1+r],e.min.y),n[2+r]=Math.min(n[2+r],e.min.z),n[3+r]=Math.max(n[3+r],e.max.x),n[4+r]=Math.max(n[4+r],e.max.y),n[5+r]=Math.max(n[5+r],e.max.z)},c.prototype.getBoundingBox=function(e){e=e||l;var t=this.bboxes;return e.min.x=t[0],e.min.y=t[1],e.min.z=t[2],e.max.x=t[3],e.max.y=t[4],e.max.z=t[5],e},c.prototype.getBoundingBoxHidden=function(e){e=e||l;var t=this.bboxes;return e.min.x=t[6],e.min.y=t[7],e.min.z=t[8],e.max.x=t[9],e.max.y=t[10],e.max.z=t[11],e},c.prototype.onFragmentAdded=function(e){this.frags.getWorldBounds(e,l),this.addToBox(l,!1),this.sortDone=!1,this.lastItem<=e&&(this.lastItem=e+1,void 0!==this.visibleStats&&(this.visibleStats=0),this.numAdded++)},c.prototype.forEach=function(e,t,r){var n,i,a,s=this.getIndices(),l=this.frags,u=!this.sortByShaderDone;if(t||r||u)for(n=t===o.MeshFlags.MESH_RENDERFLAG&&this.hasOwnProperty("drawStart")?this.drawStart:this.start,i=this.lastItem;n<i;n++){a=s?s[n]:n;c=l.getVizmesh(a);!u||c&&c.material&&c.material.program&&!c.geometry_proxy||(u=!1),!(r||c&&c.geometry)||t&&!l.isFlagSet(a,t)||e(c,a)}else for(n=this.start,i=this.lastItem;n<i;n++){var c;a=s?s[n]:n,(c=l.getVizmesh(a))&&c.geometry&&e(c,a)}u&&this.sortByShader()},c.prototype.forEachNoMesh=function(e,t,r){for(var n=this.getIndices(),i=this.frags,o=this.start,a=this.lastItem;o<a;o++){var s,l=n?n[o]:o;if(i.useThreeMesh){var u=i.getVizmesh(l);u&&(s=u.geometry)}else s=i.getGeometry(l);!r&&!s||t&&!i.isFlagSet(l,t)||e(l,o-this.start)}},c.prototype.raycast=function(e,t,r){var i=this;!1!==e.ray.intersectsBox(this.getBoundingBox())&&this.forEach((function(a,s){if(!i.frags.isFlagSet(s,o.MeshFlags.MESH_HIDE)){if(r&&r.length){var u=0|i.frags.getDbIds(s);if(-1===r.indexOf(u))return}i.frags.getWorldBounds(s,l),l.expandByScalar(.5),e.ray.intersectsBox(l)&&n.VBIntersector.rayCast(a,e,t)}}),o.MeshFlags.MESH_VISIBLE)},c.prototype.intersectFrustum=function(e,t,r){var n=this;if(!r){var a=e.intersectsBox(this.getBoundingBox());if(a===i.FrustumIntersector.OUTSIDE)return;a===i.FrustumIntersector.CONTAINS&&(r=!0)}this.forEach((function(a,s){if(!n.frags.isFlagSet(s,o.MeshFlags.MESH_HIDE))if(r)t(s,r);else{n.frags.getWorldBounds(s,l);var u=e.intersectsBox(l);u!==i.FrustumIntersector.OUTSIDE&&t(s,u===i.FrustumIntersector.CONTAINS)}}),o.MeshFlags.MESH_VISIBLE)},c.prototype.calculateBounds=function(){var e=this;this.bboxes[0]=this.bboxes[1]=this.bboxes[2]=1/0,this.bboxes[3]=this.bboxes[4]=this.bboxes[5]=-1/0,this.bboxes[6]=this.bboxes[7]=this.bboxes[8]=1/0,this.bboxes[9]=this.bboxes[10]=this.bboxes[11]=-1/0,this.forEachNoMesh((function(t){e.frags.getWorldBounds(t,l);var r=e.frags.vizflags[t];e.addToBox(l,!(1&r))}),0,!0)},c.prototype.applyVisibility=function(){var e,t,r,n,l,u,c;function f(i,a){if((i||!e.useThreeMesh)&&i.geometry){if(d(l,r,e,a,c))return i?i.visible=!1:s.logger.warn("Unexpected null mesh"),void(t[a]=t[a]&~o.MeshFlags.MESH_RENDERFLAG);var f=h(n,t,a,e.linesHidden,e.pointsHidden);i&&(i.visible=!!f),u=u&&!f}}function p(i){if(e.getGeometryId(i))if(d(l,r,e,i,c))t[i]=t[i]&~o.MeshFlags.MESH_RENDERFLAG;else{var a=h(n,t,i,e.linesHidden,e.pointsHidden);u=u&&!a}}return function(o,s){u=!0,r=s;var h=(n=o)===a.RenderFlags.RENDER_HIDDEN?this.getBoundingBoxHidden():this.getBoundingBox(),d=r.intersectsBox(h);return d===i.FrustumIntersector.OUTSIDE||!(c=this.frags.doNotCut)&&s.boxOutsideCutPlanes(h)||(t=this.frags.vizflags,e=this.frags,l=d!==i.FrustumIntersector.CONTAINS,e.useThreeMesh?this.forEach(f,null):this.forEachNoMesh(p,0,!1),e=null),u}}()},2727:(e,t,r)=>{"use strict";r.r(t),r.d(t,{RenderFlags:()=>n});var n={RENDER_NORMAL:0,RENDER_HIGHLIGHTED:1,RENDER_HIDDEN:2,RENDER_SHADOWMAP:3,RENDER_FINISHED:4}},30190:(e,t,r)=>{"use strict";r.r(t),r.d(t,{RenderModel:()=>_});var n=r(92445),i=r(25920),o=r(282),a=r(44971),s=r(95920),l=r(45451),u=r(73080),c=r(18187),h=r(48862),d=r(23909),f=r(46759),p=r(2727),m=r(98926),g=r(43586),v=r(7724);var y,b=(y=new d.Vector4,function(e,t){y.copy(e);for(var r=0;r<t.length;r++)if(t[r].dot(y)>1e-6)return!0;return!1}),x=1;function _(){var e=this,t=new d.Box3,r=new d.Box3,y=new d.Box3;this.visibleBoundsDirty=!1,this.enforceBvh=!1;var _=0;this.id=x++;var E=null,w=null,A=null,S=null,M=null,T=null,C=null,P=null,D=0,L=null,R=p.RenderFlags.RENDER_NORMAL,I=!1,O=null,N=null,k=null;this._placementTransform,this._globalOffset,this._invPlacementWithOffset,this.getGeometryList=function(){return E},this.getFragmentList=function(){return w},this.getModelId=function(){return this.id},this.RenderBatch=a.RenderBatch;var F,V,U=!1;this.initialize=function(){var e=this.getData(),a=e.numGeoms||0,s=!function(e,t,r){return!(e&&e-3*t*2<=n.GPU_MEMORY_LIMIT&&r<n.GPU_OBJECT_LIMIT)}(e.packFileTotalSize,e.primitiveCount,a);E=new i.GeometryList(a,this.is2d(),s,this.isOTG()),w=new o.FragmentList(this);var l=this.getBoundingBox();l&&(t.copy(l),r.copy(l)),M=A=new u.ModelIteratorLinear(this)},this.getIterator=function(){return M},this.initFromCustomIterator=function(e){M=e,this.visibleBoundsDirty=!0},this.dtor=function(e){E=null,w&&(w.dtor(e),w=null),M&&M.dtor&&(M.dtor(),M=null),A&&(A.dtor(),A=null),C&&(C.dispose(),C=null),this.dispose()},this.activateFragment=function(e,n,i){w&&(w.setMesh(e,n,i),M.addFragment(e),w.getWorldBounds(e,y),t.union(y),r.union(y))},this.setFragment=function(e,n,i){return void 0===e&&(e=this.getFragmentList().getNextAvailableFragmentId()),w.setMesh(e,n,!0,i),A&&A.addFragment(e),S&&!w.fragmentsHaveBeenAdded()&&S.addFragment(e),w.getWorldBounds(e,y),t.union(y),r.union(y),e},this.setBVH=function(e,t,r){var n;(M=S=new c.ModelIteratorBVH).initialize(this,e,t,r),null!==(n=w)&&void 0!==n&&n.matrix&&this.invalidateBBoxes()},this.resetIterator=function(e,t,r){return I=!1,S&&!w.fragmentsHaveBeenAdded()&&(I=!0),I?M=S:A&&(M=A),D=0,R=r,L=t,M.reset(t,e),C&&C.reset(),M},this.setRaycastIterator=function(e){T=e},this.nextBatch=function(){for(;;){var e=M.nextBatch();if(D++,!e)return null;if(C&&e instanceof a.RenderBatch&&(e=C.consolidateNextBatch(e,L,R)),e.modelId=this.id,e instanceof d.Scene)return e;if(!this.applyVisibility(e,R,L))return e}},this.applyVisibility=function(e,t,r){var n=e.applyVisibility(t,r);return n||this.is2d()||(e.sortObjects&&!this.getFragmentList().useThreeMesh?e.sortByDepth(r):e.sortDone||e.sortByMaterial()),n},this.trimPageShadowGeometry=function(e){if(this.hasPageShadow()){var t=Autodesk.Viewing.Private.F2dShadowRatio;e=e.clone();var r=this.getMetadata("page_dimensions","page_width");e.max.x-=r*t,e.min.y+=r*t}return e},this.getVisibleBounds=function(e,n){var i;this.visibleBoundsDirty&&(t.makeEmpty(),r.makeEmpty(),M.getVisibleBounds(t,r,e),null===(i=T)||void 0===i||i.getVisibleBounds(t,r,e),this.visibleBoundsDirty=!1);var o=e?r:t;return n&&(o=this.trimPageShadowGeometry(o)),o},this.rayIntersect2D=(F=new d.Plane,V=new d.Vector3,function(t,r,n,i){var o=e.getBoundingBox(!0),a=o.getCenter(new d.Vector3),s=new d.Vector3;F.normal.set(0,0,1),F.constant=-a.z;var l=e.getModelToViewerTransform();if(l&&F.applyMatrix4(l),s=t.ray.intersectPlane(F,s)){V.copy(s);var u=e.getInverseModelToViewerTransform();if(u&&(V.applyMatrix4(u),V.z=a.z),o.containsPoint(V)){var c,h,f=null===(c=w)||void 0===c||null===(h=c.getMaterial(0))||void 0===h?void 0:h.cutplanes;if(f&&b(s,f))return;var p,m,g=t.ray.origin.distanceTo(s);if(g<t.near||g>t.far)return;if(i){var v=i(s);if(p=v[0],r&&r.length>0&&!r.includes(p))return;var y,x=v[1];if(0!==x&&x!==e.id)return;m=null===(y=w)||void 0===y?void 0:y.fragments.dbId2fragId[p]}var _={intersectPoint:s,point:s,distance:g,dbId:p&&e.remapDbIdFor2D(p),fragId:m,model:e};return n&&n.push(_),_}}}),this.rayIntersect=function(e,t,r,n,i,o){if(this.ignoreRayIntersect)return null;if(this.is2d())return this.rayIntersect2D(e,r,n,i);this.visibleBoundsDirty&&this.getVisibleBounds();var a,s=[];if(r&&r.length>0){var l=this.getInstanceTree(),u=[];if(l)for(a=0;a<r.length;a++)l.enumNodeFragments(r[a],(function(e){u.push(e)}),!0);else u=r;if(u.length>2)(T||M).rayCast(e,s,r);else for(a=0;a<u.length;a++){var c=w.getVizmesh(u[a]);if(c){var d=h.VBIntersector.rayCast(c,e,s,o);d&&s.push(d)}}}else{(T||M).rayCast(e,s,void 0,o)}if(!s.length)return null;s.sort((function(e,t){return e.distance-t.distance}));var f=!!n;for(n=n||[],a=0;a<s.length;a++){var p=s[a].fragId;if(this.isFragVisible(p)){var m=w.getMaterial(p);if(t&&m.transparent)continue;var g=s[a],v=!1;if(m&&m.cutplanes&&(v=b(g.point,m.cutplanes)),v||n.push(g),g.model=this,!f&&n.length>0)break}}var y=n[0]||null;return y&&(y.model=this),y},this.setHighlighted=function(e,t){if(!w)return!1;var r=w.setFlagFragment(e,f.MeshFlags.MESH_HIGHLIGHTED,t);return r&&(t?_++:_--),r},this.setVisibility=function(e,t){w?w.setVisibility(e,t):this.isLeaflet()&&M.setVisibility(t),this.invalidateBBoxes()},this.setAllVisibility=function(e){w?w.setAllVisibility(e):this.isLeaflet()&&M.setVisibility(e),this.invalidateBBoxes()},this.hideLines=function(e){w&&w.hideLines(e)},this.hidePoints=function(e){w&&w.hidePoints(e)},this.hasHighlighted=function(){return!!_},this.isFragVisible=function(e){return w.isFragVisible(e)},this.areAllVisible=function(){return!w||w.areAllVisible()},this.getGeomScenes=function(){return M&&M.getGeomScenes?M.getGeomScenes():[]},this.getRenderProgress=function(){var e=D/M.getSceneCount();return e>1?1:e},this.update=function(e){return!(!M||!M.update)&&M.update(e)},this.setThemingColor=function(e,t,r){if(w){e=this.reverseMapDbIdFor2D(e);var n=this.getInstanceTree();r&&n?n.enumNodeChildren(e,(function(e){w.setThemingColor(e,t)}),!0):w.setThemingColor(e,t)}else M.isModelIteratorTexQuad?M.setThemingColor(t):m.logger.warn("Theming colors are not supported by this model type.")},this.clearThemingColors=function(){w?w.clearThemingColors():M.isModelIteratorTexQuad&&M.clearThemingColor()},this.getLeaflet=function(){return M.isModelIteratorTexQuad?M:null},this.consolidate=function(e,t,r){var n=(0,s.consolidateFragmentList)(this,e,t,r,P);C=new l.ConsolidationIterator(w,n),P=n.consolidationMap},this.unconsolidate=function(){C&&(C.dispose(),C=null)},this.isConsolidated=function(){return!!C},this.getConsolidation=function(){return C?C.getConsolidation():null},this.setDbIdRemap=function(e){this.idRemap=e},this.remapDbId=function(e){return this.idRemap&&e>0&&e<this.idRemap.length?this.idRemap[e]:e},this.remapDbIdFor2D=function(e){return this.is2d()?this.remapDbId(e):e},this.reverseMapDbId=function(e){if(!this.idRemap||e<=0)return e;if(!this.reverseMap){this.reverseMap={};for(var t=0;t<this.idRemap.length;t++)this.reverseMap[this.idRemap[t]]=t}return this.reverseMap[e]},this.reverseMapDbIdFor2D=function(e){return this.is2d()?this.reverseMapDbId(e):e},this.updateRenderProxy=function(e,t){C&&C.updateRenderProxy(e,t)},this.skipOpaqueShapes=function(){M&&M.skipOpaqueShapes&&M.skipOpaqueShapes()},this.invalidateBBoxes=function(){this.visibleBoundsDirty=!0},this.changePaperVisibility=function(e){var t;this.is2d()&&(null===(t=w)||void 0===t||t.setObject2DVisible(-1,e))},this.hasPaperTransparency=function(){var e,t;if(!this.is2d())return!1;var r=null!==(e=null===(t=w)||void 0===t?void 0:t.dbIdOpacity[-1])&&void 0!==e?e:1;return r>0&&r<1},this.setModelTransform=function(e){M.isModelIteratorTexQuad?M.setModelMatrix(e):(w.setModelMatrix(e),C&&C.modelMatrixChanged()),this.invalidateBBoxes(),this.getVisibleBounds(!0),N=null,k=null},this.getModelTransform=function(){var e,t;return null!==(e=M)&&void 0!==e&&e.isModelIteratorTexQuad?M.getModelMatrix():null===(t=w)||void 0===t?void 0:t.matrix},this.getInverseModelTransform=function(){var e,t;return null!==(e=M)&&void 0!==e&&e.isModelIteratorTexQuad?M.getInverseModelMatrix():null===(t=w)||void 0===t?void 0:t.getInverseModelMatrix()},this.getPlacementTransform=function(){return O=O||new g.LmvMatrix4(!0),this._placementTransform||this.getData().placementTransform||O},this.getGlobalOffset=function(){return this._globalOffset||this.getData().globalOffset},this.setPlacementTransform=function(e){this._placementTransform=(this._placementTransform||new g.LmvMatrix4(!0)).copy(e),v.DynamicGlobalOffset.updateModelMatrix(this,e,this.getGlobalOffset())},this.setGlobalOffset=function(e){this._globalOffset=this._globalOffset||new d.Vector3,this._globalOffset.copy(e);var t=this.getPlacementTransform();v.DynamicGlobalOffset.updateModelMatrix(this,t,e)},this.getModelToViewerTransform=function(){var e;if(N)return N;var t=this.getModelTransform(),r=null===(e=this.getData())||void 0===e?void 0:e.placementWithOffset;return(t||r)&&(N=new d.Matrix4,t&&N.multiply(t),r&&N.multiply(r)),N},this.getInverseModelToViewerTransform=function(){if(k)return k;var e=this.getModelToViewerTransform();return e&&(k=e.clone().invert()),k},this.getInversePlacementWithOffset=function(){return this.myData.placementWithOffset?(this._invPlacementWithOffset||(this._invPlacementWithOffset=new g.LmvMatrix4(!0).copy(this.myData.placementWithOffset).invert()),this._invPlacementWithOffset):null},this.setInnerAttributes=function(e){var n;(this.id=e._id,t=e._visibleBounds,r=e._visibleBoundsWithHidden,y=e._tmpBox,this.enforceBvh=e._enforceBvh,_=e._numHighlighted,E=e._geoms,w=e._frags,C=e._consolidationIterator,P=e._consolidationMap,D=e._renderCounter,L=e._frustum,R=e._drawMode,I=e._bvhOn,this.idRemap=e._idRemap,this._reverseMap=e._reverseMap,!A&&e._linearIterator&&(A=e._linearIterator.clone(),e._linearIterator===e._iterator&&(M=A)),!S&&e._bvhIterator&&(S=e._bvhIterator.clone(),e._bvhIterator===e._iterator&&(M=S)),M)||(M=null!==(n=e._iterator)&&void 0!==n&&n.clone?e._iterator.clone():e._iterator)},this.getInnerAttributes=function(){return{_id:this.id,_visibleBounds:t,_visibleBoundsWithHidden:r,_tmpBox:y,_enforceBvh:this.enforceBvh,_numHighlighted:_,_geoms:E,_frags:w,_linearIterator:A,_bvhIterator:S,_iterator:M,_consolidationIterator:C,_consolidationMap:P,_renderCounter:D,_frustum:L,_drawMode:R,_bvhOn:I,_idRemap:this.idRemap,_reverseMap:this.reverseMap}},this.setDoNotCut=function(e,t){if(U!==t){U=t,w?w.setDoNotCut(t):this.isLeaflet()&&M.setDoNotCut(t);e.forEachInModel(this,!1,(function(r){var n;r.doNotCut=t,(null===(n=r.cutplanes)||void 0===n?void 0:n.length)>0===t&&(e._applyCutPlanes(r),r.needsUpdate=!0)}))}},this.getDoNotCut=function(){return U},this.setViewportBounds=function(e,t){this.isLeaflet()?M.setViewBounds(t):w&&(t=t||this.isPdf()&&this.getBoundingBox(!0,!0),w.setViewBounds(t),e.setViewportBoundsForModel(this,t)),this.invalidateBBoxes()},this.getViewportBounds=function(){var e;return this.isLeaflet()?M.getViewBounds():null===(e=w)||void 0===e?void 0:e.getViewBounds()}}},23305:(e,t,r)=>{"use strict";r.r(t),r.d(t,{RenderScene:()=>u});var n=r(92445),i=r(29747),o=r(23909),a=r(2727),s=r(25119),l=r(44669);function u(){var e=!1,t=!1,r=[],u=[],c=[],h=new o.Box3,d=[],f=new i.FrustumIntersector,p=new o.Raycaster,m=performance;this.enableNonResumableFrames=!1,this.budgetForTransparent=.1;var g=!1,v=[],y=null;function b(e,t){for(var r=0;r<e.length;r++){var n=e[r];if(n&&n.id===t)return n}return null}function x(e,t){void 0===e.avgFrameTime?e.avgFrameTime=t:e.avgFrameTime=.8*e.avgFrameTime+.2*t}this.frustum=function(){return f},this.findModel=function(e){return b(r,e)},this.findHiddenModel=function(e){return b(d,e)},this.addModel=function(e){-1===r.indexOf(e)&&(r.push(e),u.length=r.length,c.length=r.length,this.recomputeLinePrecision())},this.removeModel=function(e){var t=r.indexOf(e);return t>=0&&r.splice(t,1),u.length=r.length,c.length=r.length,this.recomputeLinePrecision(),t>=0},this.addHiddenModel=function(e){var t=d.indexOf(e);return t<0&&d.push(e),t<0},this.removeHiddenModel=function(e){var t=d.indexOf(e);return t>=0&&d.splice(t,1),t>=0},this.isEmpty=function(){return 0===r.length},this.needsRender=function(){return e},this.resetNeedsRender=function(){e=!1},this.recomputeLinePrecision=function(){for(var e=1,t=new o.Vector3,n=0,i=r.length;n<i;++n){var a=r[n].getData().bbox;if(0!==a.getSize(t).length()){var s=.001*o.Box3.prototype.getBoundingSphere.call(a,new o.Sphere).radius;e=Math.min(e,s)}}p.params.Line.threshold=e},this.frameResumePossible=function(){return!g},this.renderSome=function(e,n){for(var i,o,a=m.now(),s=this.budgetForTransparent*n;;){for(var l=0,c=null,h=0;h<u.length;h++){var d=u[h];if(o=r[h],d||(u[h]=d=o.nextBatch()),g&&n<s)d&&!d.sortObjects&&(o.skipOpaqueShapes(),d=o.nextBatch());null!==d&&(c||(l=h,c=d),d.renderImportance>c.renderImportance&&(l=h,c=d))}if(!c){t=!0;break}if(u[l]=r[l].nextBatch(),c.sortObjects&&g)v.push(c),n-=void 0===c.avgFrameTime?.05:c.avgFrameTime;else{e(c),c.hasOwnProperty("drawEnd")&&(c.drawEnd=c.lastItem);var f=(i=m.now())-a;a=i,x(c,f),n-=c.avgFrameTime}f=(i=m.now())-a;if(a=i,x(c,f),(n-=c.avgFrameTime)<=0)break}return v.length>0&&(!function(e,t,r){var n,i;for(n=0;n<e.length;n++){var o=(i=e[n]).boundingBox||i.getBoundingBox();i.cameraDistance=o.distanceToPoint(t.position)}e.sort((function(e,t){return t.cameraDistance-e.cameraDistance}));var a=performance.now();for(n=0;n<e.length;n++){r(i=e[n]);var s=performance.now(),l=s-a;a=s,x(i,l)}}(v,y,e),v.length=0),n},this.reset=function(e,i,o,l){if(t=!1,this.resetNeedsRender(),f.reset(e,l),f.areaCullThreshold=n.PIXEL_CULLING_THRESHOLD,r.length){g=this.enableNonResumableFrames&&o==s.ResetFlags.RESET_RELOAD&&i===a.RenderFlags.RENDER_NORMAL,y=e;for(var h=0;h<r.length;h++)r[h].resetIterator(e,f,i,o),u[h]=r[h].nextBatch(),c[h]=null}},this.isDone=function(){return t||this.isEmpty()},this.setAllVisibility=function(e){for(var t=0;t<r.length;t++)r[t].setAllVisibility(e)},this.hideLines=function(e){for(var t=0;t<r.length;t++)r[t].hideLines(e)},this.hidePoints=function(e){for(var t=0;t<r.length;t++)r[t].hidePoints(e)},this.hasHighlighted=function(){for(var e=0;e<r.length;e++)if(r[e].hasHighlighted())return!0;return!1},this.areAllVisible=function(){for(var e=0;e<r.length;e++)if(!r[e].areAllVisible())return!1;return!0},this.areAll2D=function(){for(var e=0;e<r.length;e++)if(!r[e].is2d())return!1;return!0},this.areAll3D=function(){for(var e=0;e<r.length;e++)if(!r[e].is3d())return!1;return!0},this.invalidateVisibleBounds=function(){for(var e=0;e<r.length;e++)r[e].visibleBoundsDirty=!0},this.getVisibleBounds=function(e,t,n){h.makeEmpty();for(var i=0;i<r.length;i++){var o=r[i].getVisibleBounds(e,n);t&&!t(o)||h.union(o)}return h},this.rayIntersect=function(e,t,n,i,o,a,s,l){if(p.set(e,t),r.length>1){var u=[];if(o)for(var c=0;c<o.length;c++){var h=this.findModel(o[c]);if(h){var d=i&&i[c],f=h.rayIntersect(p,n,d,a,s,l);f&&u.push(f)}}else for(var m=0;m<r.length;m++){var g=r[m].rayIntersect(p,n,i,a,s,l);g&&u.push(g)}return u.length?(u.sort((function(e,t){return e.distance-t.distance})),u[0]):null}if(!r.length)return null;var v=r[0];return o&&-1===o.indexOf(v.id)?null:v.rayIntersect(p,n,i,a,s,l)},this.getRenderProgress=function(){return r[0].getRenderProgress()},this.getModels=function(){return r},this.getHiddenModels=function(){return d},this.getAllModels=function(){return r.concat(d)},this.getFragmentList=function(){return r[0].getFragmentList()},this.getGeometryList=function(){return r[0].getGeometryList()},this.getSceneCount=function(){return r[0].getSceneCount()},this.getGeomScenes=function(){for(var e=[],t=0;t<r.length;t++)for(var n=r[t].getGeomScenes(),i=0;i<n.length;i++){var o=n[i];o&&e.push(o)}return e},this.getGeomScenesPerModel=function(){return r.reduce((function(e,t){return e.push(t.getGeomScenes()),e}),[])},this.explode=function(e){if(r.length){for(var t=0;t<r.length;t++){var n=r[t];l.i.explode(n,e)}this.invalidateVisibleBounds()}},this.update=function(e){for(var t=!1,n=0;n<r.length;n++){var i=r[n];t=t||i.update(e)}return t},this.hideModel=function(e){for(var t=0;t<r.length;t++){var n=r[t];if(n&&n.id===e)return this.removeModel(n),d.push(n),!0}return!1},this.showModel=function(e){for(var t=0;t<d.length;++t){var r=d[t];if(r&&r.id===e)return this.addModel(r),d.splice(t,1),!0}return!1}}},25119:(e,t,r)=>{"use strict";r.r(t),r.d(t,{ResetFlags:()=>n});var n={RESET_NORMAL:0,RESET_REDRAW:1,RESET_RELOAD:2}},27820:(e,t,r)=>{"use strict";r.r(t),r.d(t,{SceneMath:()=>u});var n=r(23909),i=[new n.Vector3(1,0,0),new n.Vector3(0,1,0),new n.Vector3(0,0,1),new n.Vector3(-1,0,0),new n.Vector3(0,-1,0),new n.Vector3(0,0,-1)],o=new n.Plane;new n.Vector3;function a(e,t,r,i){var o=e;o.z=-1;var a=new n.Vector3(o.x,o.y,1);o=o.unproject(t),(a=a.unproject(t)).sub(o).normalize();var s,l=a;if(Math.abs(l[r])<1e-6)return null;s=t.isPerspective?t.position:o;var u=((i?i.min[r]:0)-s[r])/l[r];return l.multiplyScalar(u),l.add(s),l}function s(e,t,r){var n=e.clone();return n.max(t),n.min(r),n.distanceToSquared(e)}function l(e,t){return s(e,t.min,t.max)}var u={box2CutPlanes:function(e,t){for(var r=[],a=0;a<i.length;a++){o.normal.copy(i[a]);var s=a<3?e.max:e.min;o.constant=-o.normal.dot(s),t&&o.applyMatrix4(t),r.push(new n.Vector4(o.normal.x,o.normal.y,o.normal.z,o.constant))}return r},getPixelsPerUnit:function(e,t,r,i,o,s){if(!e.isPerspective)return i/e.orthoScale;var u,c=r.getCenter(new n.Vector3);if(t)if(s)u=Math.sqrt(l(e.position,s));else{var h=a(new n.Vector3(0,0,1),e,"z");h&&(c=h),u=e.position.distanceTo(c)}else{if(o){var d=o,f=e.target.clone().sub(e.position).normalize(),p=f.dot(d);if(0!==p){var m=-(e.position.clone().dot(d)+d.w)/p;c=r.clampPoint(f.multiplyScalar(m).add(e.position),c)}}u=e.position.distanceTo(c)}return i/(2*u*Math.tan(n.Math.degToRad(.5*e.fov)))},intersectGroundViewport:a,getNormalizingMatrix:function(e,t){t=t||e.getData().bbox;var r=new n.Matrix4;r.makeTranslation(-t.min.x,-t.min.y,-t.min.z);var i=new n.Vector3(0,0,0).subVectors(t.max,t.min),o=new n.Matrix4;o.makeScale(1/i.x,1/i.y,1);var a=new n.Matrix4;return a.multiplyMatrices(o,r),a},pointToMinMaxBoxDistance2:s,pointToBoxDistance2:l}},82197:(e,t,r)=>{"use strict";r.r(t),r.d(t,{SelectionMode:()=>n});var n={LEAF_OBJECT:0,FIRST_OBJECT:1,LAST_OBJECT:2}},79175:(e,t,r)=>{"use strict";function n(e){var t=e||function(e,t){return e<t},r=[],n=[];function i(e,o,a){if(o||(o=0),a||(a=n.length),o>=a)return a;if(a===o+1){var s=r[n[o]];return t(s,e)?a:o}var l=parseInt(o+(a-o)/2),u=r[n[l-1]];return t(e,u)?i(e,o,l):t(u,e)?i(e,l,a):l-1}this.add=function(e){var t=i(e);if(t==n.length)return r.push(e),void n.push(r.length-1);r.push(e),n.splice(t,0,r.length-1)},this.size=function(){return n.length},this.get=function(e){return r[n[e]]},this.removeAt=function(e){var t=n[e];r[t]=void 0,n.splice(e,1)},this.toString=function(){for(var e="",t=0,r=this.size();t<r;++t)e+=this.get(t),t<r-1&&(e+=", ");return e}}r.r(t),r.d(t,{SortedList:()=>n})},48862:(e,t,r)=>{"use strict";r.r(t),r.d(t,{VBIntersector:()=>m});var n,i,o,a,s=r(36757),l=r(23909);function u(){n||(n=new l.Matrix4,i=new l.Ray,new l.Vector3,new l.Vector3,new l.Vector3,o=new l.Vector3,a=new l.Vector3)}function c(e,t,r){u();var c=e.geometry;if(c){var h=e.material,d=h?h.side:l.FrontSide;n.copy(e.matrixWorld).invert(),i.copy(t.ray).applyMatrix4(n);var f,p,m=t.precision||1e-4;(0,s.enumMeshTriangles)(c,(function(n,s,u,c,h,g,v,y,b,x){null!==(f=d===l.BackSide?i.intersectTriangle(u,s,n,!0,o):i.intersectTriangle(n,s,u,d!==l.DoubleSide,o))&&(f.applyMatrix4(e.matrixWorld),(p=t.ray.origin.distanceTo(f))<m||p<t.near||p>t.far||(l.Triangle.getNormal(n,s,u,a),r.push({distance:p,point:f.clone(),face:new l.Face3(c,h,g,a.clone()),faceIndex:x,fragId:e.fragId,dbId:e.dbId,object:e,modelId:e.modelId})))}))}}function h(e,t,r,o){u();var a=e.geometry;if(a){var c=t.params.Line.threshold;e.isWideLine&&(e.material.linewidth?c=e.material.linewidth:e.geometry.lineWidth&&(c=e.geometry.lineWidth));var h=c*c;n.copy(e.matrixWorld).invert(),i.copy(t.ray).applyMatrix4(n);var d=new l.Vector3,f=new l.Vector3;a instanceof l.BufferGeometry&&(0,s.enumMeshLines)(a,(function(n,a,s,l,u){var c,p;if(i.distanceSqToSegment(n,a,f,d),d.applyMatrix4(e.matrixWorld),f.applyMatrix4(e.matrixWorld),!((p=d.distanceToSquared(f))>h||(c=t.ray.origin.distanceTo(d))<t.near||c>t.far)){var m={distance:c,point:d.clone(),face:{a:s,b:l},faceIndex:u,fragId:e.fragId,dbId:e.dbId,object:e,distanceToRay:Math.sqrt(p)};o&&o.filter&&!o.filter(m)||r.push(m)}}))}}function d(e,t,r,o){e.isLine||e.isWideLine?h(e,t,r,o):e.isPoint?function(e,t,r){u();var o=e.geometry;if(o){n.copy(e.matrixWorld).invert(),i.copy(t.ray).applyMatrix4(n);var a=t.precision||1e-4,c=t.params.PointCloud.threshold;c||(c=1),c*=Math.max(3,o.pointSize),c/=4,o instanceof l.BufferGeometry&&(0,s.enumMeshVertices)(o,(function(n,o,s,l){if(!(i.distanceToPoint(n)>c)){var u=i.closestPointToPoint(n);if(null!==u){u.applyMatrix4(e.matrixWorld);var h=t.ray.origin.distanceTo(u);h<a||h<t.near||h>t.far||r.push({distance:h,point:n,face:{a:l},faceIndex:l,fragId:e.fragId,dbId:e.dbId,object:e})}}}))}}(e,t,r):c(e,t,r)}function f(e,t,r,n){if(e instanceof l.Mesh?d(e,t,r):e.raycast(t,r),!0===n)for(var i=e.children,o=0,a=i.length;o<a;o++)f(i[o],t,r,!0)}var p=function(e,t){return e.distance-t.distance};var m={meshRayCast:c,lineRayCast:h,rayCast:d,intersectObject:function(e,t,r,n){f(e,t,r,n),r.sort(p)}}},89812:(e,t,r)=>{"use strict";r.r(t),r.d(t,{VertexBufferReader:()=>o,BoundsCallback:()=>a});var n=r(23909),i=2*Math.PI;function o(e){var t,r,n=this;this.vb=e.vb.buffer,this.vbf=new Float32Array(this.vb),this.vbi=new Int32Array(this.vb),this.vbs=new Uint16Array(this.vb),this.ib=e.ib,this.stride=e.vbstride,this.vcount=this.vbf.length/this.stride,this.useInstancing=e.numInstances>0,this.useCompactBuffers=e.unpackXform,this.texData=this.useCompactBuffers&&(null===(t=e.tIdColor)||void 0===t||null===(r=t.image)||void 0===r?void 0:r.data)&&new Uint32Array(e.tIdColor.image.data.buffer),this.isInterleavedVb=function(){var t=e.attributes;if(!t)return!1;var r=t.layerVp4b,i=t.flags4b;if(n.useCompactBuffers)return t.uvIdColor&&r&&i;var o=t.color4b,a=t.dbId4b;return o&&a&&r&&i}()}function a(e){this.bounds=e,this.point=new n.Vector4,this.point.z=0,this.point.w=1}o.prototype.getDbIdAt=function(e){return this.texData?this.texData[this.vbs[e*this.stride*2+7]]:this.vbi[e*this.stride+7]},o.prototype.getColorAt=function(e){return this.texData?this.texData[this.vbs[e*this.stride*2+6]]:this.vbi[e*this.stride+6]},o.prototype.getVertexFlagsAt=function(e){return this.texData?this.vbi[e*this.stride+4]:this.vbi[e*this.stride+8]},o.prototype.getLayerIndexAt=function(e){return this.texData?65535&this.vbi[e*this.stride+5]:65535&this.vbi[e*this.stride+9]},o.prototype.getViewportIndexAt=function(e){return this.texData?this.vbi[e*this.stride+5]>>16&65535:this.vbi[e*this.stride+9]>>16&65535},o.prototype.decodeLineAt=function(e,t,r,n){if(n.onLineSegment){if(this.useCompactBuffers)var o=this.stride*e*2,a=this.useCompactBuffers.x*this.vbs[o]/65535+this.useCompactBuffers.z,s=this.useCompactBuffers.y*this.vbs[o+1]/65535+this.useCompactBuffers.w,l=this.vbs[o+2]/65535*i-Math.PI,u=this.vbs[o+3]/65535*Math.max(this.useCompactBuffers.x,this.useCompactBuffers.y),c=this.vbs[o+4]/32767*Math.max(this.useCompactBuffers.x,this.useCompactBuffers.y)*2;else{var h=this.stride*e;a=this.vbf[h],s=this.vbf[h+1],l=this.vbf[h+2]*i-Math.PI,u=this.vbf[h+3],c=2*this.vbf[h+4]}var d=a+u*Math.cos(l),f=s+u*Math.sin(l);n.onLineSegment(a,s,d,f,r,c)}},o.prototype.decodeCircularArcAt=function(e,t,r,n){if(n.onCircularArc){if(this.useCompactBuffers)var o=this.stride*e*2,a=this.useCompactBuffers.x*this.vbs[o]/65535+this.useCompactBuffers.z,s=this.useCompactBuffers.y*this.vbs[o+1]/65535+this.useCompactBuffers.w,l=this.vbs[o+2]/65535*i,u=this.vbs[o+3]/65535*i,c=this.vbs[o+5]/65535*Math.max(this.useCompactBuffers.x,this.useCompactBuffers.y);else{var h=this.stride*e;a=this.vbf[h],s=this.vbf[h+1],l=this.vbf[h+2]*i,u=this.vbf[h+3]*i,c=this.vbf[h+5]}n.onCircularArc(a,s,l,u,c,r)}},o.prototype.decodeEllipticalArcAt=function(e,t,r,n){if(n.onEllipticalArc){var o=this.stride*e,a=this.vbf[o],s=this.vbf[o+1],l=this.vbf[o+2]*i,u=this.vbf[o+3]*i,c=this.vbf[o+5],h=this.vbf[o+10],d=this.vbf[o+11];n.onEllipticalArc(a,s,l,u,c,h,d,r)}},o.prototype.decodeTexQuadAt=function(e,t,r,n){if(n.onTexQuad){if(this.useCompactBuffers)var o=this.stride*e*2,a=this.useCompactBuffers.x*this.vbs[o]/65535+this.useCompactBuffers.z,s=this.useCompactBuffers.y*this.vbs[o+1]/65535+this.useCompactBuffers.w,l=this.vbs[o+2]/65535*i,u=this.vbs[o+3]/65535*Math.max(this.useCompactBuffers.x,this.useCompactBuffers.y),c=this.vbs[o+4]/65535*Math.max(this.useCompactBuffers.x,this.useCompactBuffers.y);else{var h=this.stride*e;a=this.vbf[h],s=this.vbf[h+1],l=this.vbf[h+2]*i,u=this.vbf[h+3],c=this.vbf[h+4]}n.onTexQuad(a,s,u,c,l,r)}},o.prototype.decodeOneTriangleAt=function(e,t,r,n){if(n.onOneTriangle){if(this.useCompactBuffers)var i=this.stride*e*2,o=this.useCompactBuffers.x*this.vbs[i]/65535+this.useCompactBuffers.z,a=this.useCompactBuffers.y*this.vbs[i+1]/65535+this.useCompactBuffers.w,s=this.useCompactBuffers.x*this.vbs[i+2]/65535+this.useCompactBuffers.z,l=this.useCompactBuffers.y*this.vbs[i+3]/65535+this.useCompactBuffers.w,u=this.useCompactBuffers.x*this.vbs[i+4]/65535+this.useCompactBuffers.z,c=this.useCompactBuffers.y*this.vbs[i+5]/65535+this.useCompactBuffers.w;else{var h=this.stride*e;o=this.vbf[h],a=this.vbf[h+1],s=this.vbf[h+2],l=this.vbf[h+3],u=this.vbf[h+4],c=this.vbf[h+5]}n.onOneTriangle(o,a,s,l,u,c,r)}},o.prototype.decodeTriangleIndexed=function(e,t,r,n,i,o){if(o.onOneTriangle){if(this.useCompactBuffers){var a=this.stride*e*2,s=this.useCompactBuffers.x*this.vbs[a]/65535+this.useCompactBuffers.z,l=this.useCompactBuffers.y*this.vbs[a+1]/65535+this.useCompactBuffers.w;a=this.stride*t*2;var u=this.useCompactBuffers.x*this.vbs[a]/65535+this.useCompactBuffers.z,c=this.useCompactBuffers.y*this.vbs[a+1]/65535+this.useCompactBuffers.w;a=this.stride*r*2;var h=this.useCompactBuffers.x*this.vbs[a]/65535+this.useCompactBuffers.z,d=this.useCompactBuffers.y*this.vbs[a+1]/65535+this.useCompactBuffers.w}else{var f=this.stride*e;s=this.vbf[f],l=this.vbf[f+1];f=this.stride*t;u=this.vbf[f],c=this.vbf[f+1];f=this.stride*r;h=this.vbf[f],d=this.vbf[f+1]}o.onOneTriangle(s,l,u,c,h,d,i)}},o.prototype.enumGeomsForObject=function(e,t){if(this.useInstancing)for(var r=0;r<this.vcount;){var n=this.getVertexFlagsAt(r)>>8&255,i=this.getLayerIndexAt(r),o=this.getViewportIndexAt(r);if(s=this.getDbIdAt(r)===e)switch(n){case 1:this.decodeLineAt(r,i,o,t);break;case 2:this.decodeCircularArcAt(r,i,o,t);break;case 3:this.decodeEllipticalArcAt(r,i,o,t);break;case 4:this.decodeTexQuadAt(r,i,o,t);break;case 5:this.decodeOneTriangleAt(r,i,o,t)}r+=1}else for(r=0;r<this.ib.length;){var a=this.ib[r],s=(n=this.getVertexFlagsAt(a)>>8&255,i=this.getLayerIndexAt(a),o=this.getViewportIndexAt(a),this.getDbIdAt(a)===e);if(0===n)s&&this.decodeTriangleIndexed(this.ib[r],this.ib[r+1],this.ib[r+2],i,o,t),r+=3;else{if(s)switch(n){case 1:this.decodeLineAt(a,i,o,t);break;case 2:this.decodeCircularArcAt(a,i,o,t);break;case 3:this.decodeEllipticalArcAt(a,i,o,t);break;case 4:this.decodeTexQuadAt(a,i,o,t);break;case 5:this.decodeOneTriangleAt(a,i,o,t)}r+=6}}},o.prototype.enumGeomsForVisibleLayer=function(e,t){this.enumGeoms((function(t,r,n){return!e||0!==r&&-1!==e.indexOf(r)}),t)},o.prototype.enumGeoms=function(e,t){if(this.useInstancing)for(var r=0;r<this.vcount;){var n=this.getVertexFlagsAt(r)>>8&255,i=this.getLayerIndexAt(r),o=this.getViewportIndexAt(r),a=this.getDbIdAt(r);if(l=!e||e(a,i,o))switch(n){case 1:this.decodeLineAt(r,i,o,t);break;case 2:this.decodeCircularArcAt(r,i,o,t);break;case 3:this.decodeEllipticalArcAt(r,i,o,t);break;case 4:this.decodeTexQuadAt(r,i,o,t);break;case 5:this.decodeOneTriangleAt(r,i,o,t)}r+=1}else for(r=0;r<this.ib.length;){var s=this.ib[r],l=(n=this.getVertexFlagsAt(s)>>8&255,i=this.getLayerIndexAt(s),o=this.getViewportIndexAt(s),a=this.getDbIdAt(s),!e||e(a,i,o));if(0===n)l&&this.decodeTriangleIndexed(this.ib[r],this.ib[r+1],this.ib[r+2],i,o,t),r+=3;else{if(l)switch(n){case 1:this.decodeLineAt(s,i,o,t);break;case 2:this.decodeCircularArcAt(s,i,o,t);break;case 3:this.decodeEllipticalArcAt(s,i,o,t);break;case 4:this.decodeTexQuadAt(s,i,o,t);break;case 5:this.decodeOneTriangleAt(s,i,o,t)}r+=6}}},a.prototype.onVertex=function(e,t,r){this.point.x=e,this.point.y=t,this.bounds.expandByPoint(this.point)},a.prototype.onLineSegment=function(e,t,r,n,i){this.onVertex(e,t),this.onVertex(r,n)},a.prototype.onCircularArc=function(e,t,r,n,i,o){this.onEllipticalArc(e,t,r,n,i,i,0,o)},a.prototype.onEllipticalArc=function(e,t,r,n,i,o,a,s){0==a?r<=0&&n>=2*Math.PI-1e-5?this.onTexQuad(e,t,2*i,2*o,a,s):(this.point.x=e+Math.cos(r)*i,this.point.y=t+Math.sin(r)*o,this.bounds.expandByPoint(this.point),this.point.x=e+Math.cos(n)*i,this.point.y=t+Math.sin(n)*o,this.bounds.expandByPoint(this.point),r>n&&(this.point.x=e+i,this.point.y=t,this.bounds.expandByPoint(this.point),r-=2*Math.PI),r<.5*Math.PI&&n>.5*Math.PI&&(this.point.x=e,this.point.y=t+o,this.bounds.expandByPoint(this.point)),r<Math.PI&&n>Math.PI&&(this.point.x=e-i,this.point.y=t,this.bounds.expandByPoint(this.point)),r<1.5*Math.PI&&n>1.5*Math.PI&&(this.point.x=e,this.point.y=t-o,this.bounds.expandByPoint(this.point))):this.onTexQuad(e,t,2*i,2*o,a,s)},a.prototype.onTexQuad=function(e,t,r,i,o,a){var s=.5*r,l=.5*r;if(0==o)this.onVertex(e-s,t-l),this.onVertex(e+s,t+l);else{var u=new n.Matrix4,c=new n.Matrix4;u.makeRotationZ(o),c.makeTranslation(e,t,0),c.multiply(u);for(var h=0;h<4;h++)this.point.x=h%2==1?s:-s,this.point.y=h>=2?l:-l,this.point.applyMatrix4(c),this.bounds.expandByPoint(this.point)}},a.prototype.onOneTriangle=function(e,t,r,n,i,o,a){this.onVertex(e,t),this.onVertex(r,n),this.onVertex(i,o)}},36757:(e,t,r)=>{"use strict";r.r(t),r.d(t,{getVertexCount:()=>m,getIndicesCount:()=>g,enumMeshVertices:()=>v,enumMeshIndices:()=>y,enumMeshTriangles:()=>b,enumMeshLines:()=>x,enumMeshEdges:()=>_,VertexEnumerator:()=>E});var n,i,o,a,s,l,u,c,h,d,f,p=r(73075);function m(e){return e.vb?e.vb.length/e.vbstride:e.attributes.position?e.attributes.position.array.length/3:0}function g(e){e.attributes;var t=e.ib||e.indices||(e.index?e.index.array:null);if(t){var r=e.groups;if(!r||0===r.length)return t.length;for(var n=0,i=0,o=r.length;i<o;++i)n+=r[i].count;return n}return m(e)}function v(e,t,r){var a=e.attributes;n||(n=new p.LmvVector3,i=new p.LmvVector3,new p.LmvVector3),r&&(o||(o=new THREE.Matrix3),o.getNormalMatrix(r));var s,l=e.vb||a.position.array,u=e.vb||a.normal&&a.normal.array,c=e.vb?e.vbstride:3;if(e.vblayout){if(!e.vblayout.position)return;s=e.vblayout.position.offset}else{if(!a.position)return;s=a.position.itemOffset||0}var h=0,d=e.vblayout?e.vblayout.normal:a.normal||null;d?h=d.offset||d.itemOffset||0:u=null,!d||d.array||3===d.itemSize&&4===d.bytesPerItem||(u=null);for(var f=m(e),g=s,v=h,y=0;y<f;y++,g+=c,v+=c)n.set(l[g],l[g+1],l[g+2]),r&&n.applyMatrix4(r),u&&(i.set(u[v],u[v+1],u[v+2]),r&&i.applyMatrix3(o)),t(n,u?i:null,null,y)}function y(e,t){var r=e.ib||e.indices||(e.index?e.index.array:null);if(r){var n=e.groups;n&&0!==n.length||(n=[{start:0,count:r.length,index:0}]);for(var i=0,o=n.length;i<o;++i)for(var a=n[i].start,s=n[i].count,l=n[i].index,u=a,c=a+s;u<c;u+=3){t(l+r[u],l+r[u+1],l+r[u+2])}}else for(var h=m(e),d=0;d<h;d++){t(3*d,3*d+1,3*d+2)}}function b(e,t){var r,n,i,o=e.attributes;a||(a=new p.LmvVector3,s=new p.LmvVector3,l=new p.LmvVector3,u=new p.LmvVector3,c=new p.LmvVector3,h=new p.LmvVector3);var d,f=e.vb||o.position.array,g=e.vb||o.normal&&o.normal.array,v=e.vb?e.vbstride:3;if(e.vblayout){if(!e.vblayout.position)return;d=e.vblayout.position.offset}else{if(!o.position)return;d=o.position.itemOffset||0}var y=0,b=e.vblayout?e.vblayout.normal:o.normal||null;b?y=b.offset||b.itemOffset||0:g=null,!b||b.array||3===b.itemSize&&4===b.bytesPerItem||(g=null);var x=e.ib||e.indices||(e.index?e.index.array:null);if(x){var _=e.groups;_&&0!==_.length||(_=[{start:0,count:x.length,index:0}]);for(var E=0,w=_.length;E<w;++E)for(var A=_[E].start,S=_[E].count,M=_[E].index,T=A,C=A+S;T<C;T+=3){var P=(r=M+x[T])*v+d,D=(n=M+x[T+1])*v+d,L=(i=M+x[T+2])*v+d;if(a.x=f[P],a.y=f[P+1],a.z=f[P+2],s.x=f[D],s.y=f[D+1],s.z=f[D+2],l.x=f[L],l.y=f[L+1],l.z=f[L+2],g){var R=r*v+y,I=n*v+y,O=i*v+y;u.x=g[R],u.y=g[R+1],u.z=g[R+2],c.x=g[I],c.y=g[I+1],c.z=g[I+2],h.x=g[O],h.y=g[O+1],h.z=g[O+2],t(a,s,l,r,n,i,u,c,h,T/3)}else t(a,s,l,r,n,i,null,null,null,T/3)}}else{var N=m(e);for(T=0;T<N;T+=3){P=(r=T)*v+d,D=(n=T+1)*v+d,L=(i=T+2)*v+d;if(a.x=f[P],a.y=f[P+1],a.z=f[P+2],s.x=f[D],s.y=f[D+1],s.z=f[D+2],l.x=f[L],l.y=f[L+1],l.z=f[L+2],g){R=r*v+y,I=n*v+y,O=i*v+y;u.x=g[R],u.y=g[R+1],u.z=g[R+2],c.x=g[I],c.y=g[I+1],c.z=g[I+2],h.x=g[O],h.y=g[O+1],h.z=g[O+2],t(a,s,l,r,n,i,u,c,h,T/3)}else t(a,s,l,r,n,i,null,null,null,T/3)}}}function x(e,t){var r,n,i=e.attributes;d||(d=new p.LmvVector3,f=new p.LmvVector3);var o=2;e.lineWidth&&(o=6);var a=e.ib||e.indices||(e.index?e.index.array:null);if(a){var s=e.vb?e.vb:i.position.array,l=e.vb?e.vbstride:3,u=e.groups;u&&0!==u.length||(u=[{start:0,count:a.length,index:0}]);for(var c=0,h=u.length;c<h;++c)for(var m=u[c].start,g=u[c].count,v=u[c].index,y=m,b=m+g,x=m/o;y<b;y+=o,x++)r=v+a[y],n=v+a[y+1],d.x=s[r*l],d.y=s[r*l+1],d.z=s[r*l+2],f.x=s[n*l],f.y=s[n*l+1],f.z=s[n*l+2],t(d,f,r,n,x)}else for(s=e.vb?e.vb:i.position.array,l=e.vb?e.vbstride:3,y=0,b=s.length/l,x=0;y<b;y+=o,x++)r=y,n=y+1,d.x=s[r*l],d.y=s[r*l+1],d.z=s[r*l+2],f.x=s[n*l],f.y=s[n*l+1],f.z=s[n*l+2],t(d,f,r,n,x)}function _(e,t){var r,n,i=e.attributes;d||(d=new p.LmvVector3,f=new p.LmvVector3);var o=e.iblines;if(o){var a=e.vb?e.vb:i.position.array,s=e.vb?e.vbstride:3,l=e.groups;l&&0!==l.length||(l=[{start:0,count:o.length,index:0}]);for(var u=0,c=l.length;u<c;++u)for(var h=l[u].start,m=l[u].count,g=l[u].index,v=h,y=h+m;v<y;v+=2)r=g+o[v],n=g+o[v+1],d.x=a[r*s],d.y=a[r*s+1],d.z=a[r*s+2],f.x=a[n*s],f.y=a[n*s+1],f.z=a[n*s+2],t(d,f,r,n)}}var E={getVertexCount:m,enumMeshVertices:v,enumMeshIndices:y,enumMeshTriangles:b,enumMeshLines:x,enumMeshEdges:_}},87289:(e,t,r)=>{"use strict";r.r(t),r.d(t,{Consolidation:()=>V,ConsolidationBuilder:()=>U,copyPrimitiveProps:()=>N,copyVertexFormat:()=>O,isVisible:()=>L,mergeGeometries:()=>k});var n=r(23909),i=r(36757),o=r(25131),a=r(96610),s=r(58092),l=r(43586),u=r(73075);function c(e,t,r,n){var o=function(e){for(var t=new Uint16Array(e.length+1),r=0,n=0;n<e.length;n++)t[n]=r,r+=(0,i.getVertexCount)(e[n]);return t[n]=r,t}(e),s=new a.GeomMergeTask;return s.vb=t.vb,s.vbstride=t.vbstride,s.posOffset=t.attributes.position.itemOffset,s.normalOffset=t.attributes.normal?t.attributes.normal.itemOffset:-1,s.matrices=r,s.ranges=o,s.dbIds=n,s}function h(e,t){t.vb=e.vb,t.attributes.id.array=e.vertexIds,t.needsUpdate=!0}function d(e){var t=0,r={},n=[],i=e,o=new Array(2);function a(e){for(var n=e.data,a=0;a<n.length;a++){var s=n[a],l=s.taskId;h(s,r[l]),delete r[l]}if(0===--t)for(i.inProgress=!1,a=0;a<o.length;a++)o[a].clearAllEventListenerWithIntercept(),o[a].terminate(),o[a]=null}this.addMergeTask=function(e,t,i,o){var a=c(e,t,i,o);n.push(a),r[a.id]=t},this.runTasks=function(){for(var e=0;e<2;e++)o[e]=d.createWorker(),o[e].addEventListenerWithIntercept(a);for(var r=n.length,s=Math.floor(r/2),l=0;l<2;l++){var u=l*s,c=1===l?r:u+s,h=[],f=new Array(4*(c-u)),p=0;for(e=u;e<c;e++){var m=n[e];f[p++]=m.vb.buffer,f[p++]=m.matrices.buffer,f[p++]=m.ranges.buffer,f[p++]=m.dbIds.buffer,h.push(m)}var g={operation:"MERGE_GEOMETRY",tasks:h};o[l].doOperation(g,f),t++}i.inProgress=!0}}d.createWorker=s.createWorkerWithIntercept;var f=r(98926),p=r(49514),m=r(46759),g=r(2727),v=1,y=2,b=3,x=4;function _(e){return e.isLines?y:e.isPoints?x:e.isWideLines?b:v}function E(e,t){switch(!0===e.isLines&&(e.isLines=void 0),!0===e.isWideLines&&(e.isWideLines=void 0),!0===e.isPoints&&(e.isPoints=void 0),t){case y:e.isLines=!0;break;case b:e.isWideLines=!0;break;case x:e.isPoints=!0}}var w=m.MeshFlags.MESH_HIGHLIGHTED,A=m.MeshFlags.MESH_VISIBLE|m.MeshFlags.MESH_HIDE|w,S=m.MeshFlags.MESH_VISIBLE,M=m.MeshFlags.MESH_VISIBLE|m.MeshFlags.MESH_HIDE,T=m.MeshFlags.MESH_HIGHLIGHTED|m.MeshFlags.MESH_HIDE,C=m.MeshFlags.MESH_HIGHLIGHTED,P=g.RenderFlags.RENDER_HIDDEN,D=g.RenderFlags.RENDER_HIGHLIGHTED;function L(e,t){switch(t){case P:return 0==(e&M);case D:return(e&T)===C}return(e&A)==S}var R=new n.Matrix4;function I(e){this.geoms=[],this.matrices=[],this.vertexCount=0,this.material=e,this.fragIds=[],this.worldBox=new n.Box3}function O(e,t){for(var r in e.vb&&e.vbstride||f.logger.warn("copyVertexFormat() supports only interleaved buffers"),e.attributes)t.attributes[r]=e.attributes[r];t.attributesKeys=e.attributesKeys.slice(0),t.vbstride=e.vbstride}function N(e,t){E(t,_(e)),t.lineWidth=e.lineWidth,t.pointSize=e.pointSize}function k(e,t,r,a,s){var d=function(e){for(var t=e[0].vbstride,r=0,a=0,s=0,l=0;l<e.length;l++){var u=e[l];r+=e[l].ib.length,a+=(0,i.getVertexCount)(u),e[l].iblines&&(s+=e[l].iblines.length)}var c=(0,o.createBufferGeometry)();c.vb=new Float32Array(a*t),c.ib=new Uint16Array(r),s&&(c.iblines=new Uint16Array(s)),c.byteSize=c.vb.byteLength+c.ib.byteLength,c.iblines&&(c.byteSize+=c.iblines.byteLength),N(e[0],c),O(e[0],c);var h=new n.BufferAttribute(new Float32Array,3);h.normalized=!0,h.bytesPerItem=1,c.setAttribute("id",h);var d=e[0];return E(c,_(d)),d.isPoints&&(c=d.pointSize),d.isWideLines&&(c=d.lineWidth),c}(e);return d.boundingBox=a.clone(),function(e,t){for(var r=0,n=0,o=0,a=0,s=0;s<e.length;s++){for(var l=e[s],u=(0,i.getVertexCount)(l),c=0;c<l.ib.length;c++)t.ib[o+c]=l.ib[c]+n;if(l.iblines){for(c=0;c<l.iblines.length;c++)t.iblines[a+c]=l.iblines[c]+n;a+=l.iblines.length}t.vb.set(l.vb,r),r+=l.vb.length,n+=u,o+=l.ib.length}}(e,d),s?s.addMergeTask(e,d,t,r):function(e,t,r,n){var i=c(e,t,r,n),o=new u.LmvVector3,a=new l.LmvMatrix4;h(i.run(a,o),t)}(e,d,t,r),d}function F(e,t){if(e.vbstride!=t.vbstride)return!1;if(_(e)!==_(t))return!1;if(e.isPoints&&e.pointSize!==t.pointSize)return!1;if(e.isWideLines&&e.lineWidth!==t.lineWidth)return!1;if(e.attributesKeys.length!=t.attributesKeys.length)return!1;for(var r=0,n=e.attributesKeys.length;r<n;r++){var i=e.attributesKeys[r],o=e.attributes[i],a=t.attributes[i];if(!a)return!1;if(o!==a&&(o.itemOffset!==a.itemOffset||o.normalized!==a.normalized||o.itemSize!==a.itemSize||o.bytesPerItem!==a.bytesPerItem||o.isPattern!==a.isPattern))return!1}return!0}function V(e){this.meshes=[],this.fragId2MeshIndex=new Int32Array(e);for(var t=0;t<this.fragId2MeshIndex.length;t++)this.fragId2MeshIndex[t]=-1;this.byteSize=0,this.consolidationMap=null}function U(){this.buckets={},this.bucketCount=0,this.costs=0}function B(e,t){this.fragOrder=new Uint32Array(e),this.ranges=new Uint32Array(t),this.boxes=new Array(t),this.numConsolidated=-1}I.prototype={constructor:I,addGeom:function(e,t,r){this.geoms.push(e),this.fragIds.push(r),this.worldBox.union(t),this.vertexCount+=(0,i.getVertexCount)(e);var n=this.geoms.length;return 1==n?0:(void 0===e.byteSize&&f.logger.warn("Error in consolidation: Geometry must contain byteSize."),e.byteSize+(2==n?this.geoms[0].byteSize:0))}},V.prototype={constructor:V,addContainerMesh:function(e,t,r,i,o){var a=new n.Mesh(e,t);this.meshes.push(a),this.byteSize+=e.byteSize;var s=i||0,l=s+(o||r.length);a.frustumCulled=!1;for(var u=this.meshes.length-1,c=s;c<l;c++){var h=r[c];this.fragId2MeshIndex[h]=u}},addSingleMesh:function(e,t,r,i,o){var a=new n.Mesh(e,t);a.matrix.copy(i),a.matrixAutoUpdate=!1,a.dbId=o,a.fragId=r,this.meshes.push(a),a.frustumCulled=!1,this.fragId2MeshIndex[r]=this.meshes.length-1},addSingleFragment:function(e,t){var r=e.getVizmesh(t);e.getOriginalWorldMatrix(t,R),this.addSingleMesh(r.geometry,r.material,t,R,r.dbId)},applyAttributes:function(e,t,r,n){var i,o,a=this.meshes[e],s=a.geometry,l=t.vizflags,u=this.consolidationMap,c=u.fragOrder,h=s.numInstances,d=t.db2ThemingColor,f=d.length>0||void 0;if(h?o=(i=a.rangeStart)+a.geometry.numInstances:s.attributes.id?(i=u.ranges[e],o=e+1>=u.ranges.length?u.numConsolidated:u.ranges[e+1]):w=a.fragId,!n||void 0!==w)return s.groups&&void 0===w&&(s.groups=void 0),a.visible=L(l[void 0===w?c[i]:w],r),a.themingColor=f&&d[t.fragments.fragId2dbId[w]],a;var p,m,g=0,v=0,y=0,b=0,x=0;function _(){if(p){s.groups=s.groups||[];var e=s.groups[x]||{index:0};s.groups[x++]=e,h?(e.start=0,e.count=s.ib.length,s.iblines&&(e.edgeStart=0,e.edgeCount=s.iblines.length),e.instanceStart=g,e.numInstances=v-g):(e.start=g,e.count=v-g,s.iblines&&(e.edgeStart=y,e.edgeCount=b-y)),e.themingColor=m}}for(var E=i;E<o;++E){var w,A=L(l[w=c[E]],r),S=f&&t.db2ThemingColor[t.fragments.fragId2dbId[w]];if((A!==p||A&&S!==m)&&(v>g&&_(),g=v,y=b,p=A,m=S),h)v+=1;else{var M=t.getGeometry(w);v+=M.ib.length,M.iblines&&(b+=M.iblines.length)}}return 0===g?(a.themingColor=m,a.visible=p):(a.visible=!0,_()),s.groups&&(s.groups.length=x),a}},U.prototype={addGeom:function(e,t,r,n){var o=null,a=this.buckets[t.id];if(a)for(var s=0;s<a.length;s++){var l=a[s];if(F(l.geoms[0],e))if(!((0,i.getVertexCount)(e)+l.vertexCount>65535)){o=l;break}}o||(o=new I(t),this.bucketCount++,this.buckets[t.id]?this.buckets[t.id].push(o):this.buckets[t.id]=[o]),this.costs+=o.addGeom(e,r,n)},createConsolidationMap:function(e,t){var r=new B(e.length,this.bucketCount),n=0,i=0;for(var o in this.buckets)for(var a=this.buckets[o],s=0;s<a.length;s++){var l=a[s];r.ranges[i]=n,r.boxes[i]=l.worldBox,r.fragOrder.set(l.fragIds,n),n+=l.fragIds.length,i++}r.numConsolidated=t;for(var u=t;u<e.length;u++)r.fragOrder[u]=e[u];return r}},B.prototype={buildConsolidation:function(e,t,r){var i=this.fragOrder,o=e.getCount(),a=this.ranges.length,s=new V(o),l=null;d.createWorker&&(l=new d(s));for(var u=[],c=new n.Matrix4,h=0;h<a;h++){var f=this.ranges[h],m=(h===a-1?this.numConsolidated:this.ranges[h+1])-f;if(1!==m){u.length=m;for(var g=new Float32Array(16*m),v=new Uint32Array(m),y=0;y<m;y++)A=i[f+y],u[y]=e.getGeometry(A),e.getOriginalWorldMatrix(A,c),g.set(c.elements,16*y),v[y]=e.getDbIds(A);var b=this.boxes[h],x=i[f],_=e.getMaterial(x),E=k(u,g,v,b,l),w=t.getMaterialVariant(_,p.MATERIAL_VARIANT.VERTEX_IDS,r);s.addContainerMesh(E,w,i,f,m)}else{var A=i[f];s.addSingleFragment(e,A,s)}}return l&&l.runTasks(),s.consolidationMap=this,s}},V.applyBVHDefaults=function(e){e.frags_per_leaf_node=512,e.max_polys_per_node=1e5},V.getDefaultBVHOptions=function(){var e={};return V.applyBVHDefaults(e),e}},45451:(e,t,r)=>{"use strict";r.r(t),r.d(t,{ConsolidationIterator:()=>l});var n=r(87289),i=r(23406),o=r(23909),a=r(46759),s=r(98926);function l(e,t){var r=e,l=t,u=[],c=!1,h=[],d=[],f=new o.Matrix4,p=new o.Box3;function m(e){var t=r.matrix;t?(e.matrixWorld.copy(t),e.matrixAutoUpdate=!1):e.matrixWorld.identity()}function g(){for(var e=l.meshes,t=0;t<e.length;t++)e[t].matrixWorldNeedsUpdate=!0}g(),this.modelMatrixChanged=function(){for(var e=0;e<h.length;e++){var t=h[e];t&&m(t)}g()},this.getConsolidation=function(){return l},this.reset=function(){u.length=null,d.length=0;var e=r.getCount(),t=a.MeshFlags.MESH_MOVED,n=a.MeshFlags.MESH_VISIBLE,i=n|a.MeshFlags.MESH_HIDE|a.MeshFlags.MESH_HIGHLIGHTED,o=r.vizflags,s=l.fragId2MeshIndex;l.meshes;c=!1;for(var h=r.db2ThemingColor.length>0,f=0;f<e;f++){var p,m=o[f];if(m&t){c=!0;break}if(h){var g=r.fragments.fragId2dbId[f];p=r.db2ThemingColor[g]}var v=s[f];d[v]=d[v]||!!(p||m&i^n)}},this.dispose=function(){for(var e={type:"dispose"},t={type:"removed"},r=0;r<l.meshes.length;r++){var n=l.meshes[r],i=n.geometry;i&&(n.dispatchEvent(t),i.dispatchEvent(e),i.needsUpdate=!0)}},this.consolidateNextBatch=function(e,t,n){var i=e.nodeIndex;if(c||void 0===i)return e;if(l.inProgress)return e;for(var a=function(e){h[e]||(h[e]=new o.Scene,m(h[e]));var t=h[e];return t.children.length=0,t}(i),f=e.start;f<e.lastItem;f++){var g,v=e.indices?e.indices[f]:f,y=l.fragId2MeshIndex[v];if(-1===y){if(!r.getGeometry(v))continue;return s.logger.warn("Warning: Missing fragment in consolidation. Consolidation disabled."),e}if(!u[y]&&(r.getWorldBounds(v,p),t.intersectsBox(p)&&(u[y]=!0,(g=l.applyAttributes(y,r,n,d[y])).visible))){var b=g&&g.geometry,x=b&&(b.isLines||b.isWideLines),_=b&&b.isPoints;r.linesHidden&&x||r.pointsHidden&&_||a.add(g)}}return a.boundingBox||(a.boundingBox=new o.Box3),e.getBoundingBox(a.boundingBox),a.renderImportance=e.renderImportance,a.sortObjects=e.sortObjects,a};var v=1,y=2,b=3;function x(e){return e.numInstances?y:e.attributes.id?v:b}this.updateRenderProxy=function(e,t){if(e.geometry&&e.geometry.attributes){var o=function(e){if(c)return b;var t=l.fragId2MeshIndex[e];return x(l.meshes[t].geometry)}(t),a=x(e.geometry);if(e.needsUpdate||a!=o){var s=r.getGeometry(t),u=l.fragId2MeshIndex[t],h=l.meshes[u];if(o===b)e.geometry=s,e.material=r.getMaterial(t),r.getWorldMatrix(t,e.matrix);else if(o===y){r.getWorldMatrix(t,f);var d=r.fragments.fragId2dbId[t],m=new i.InstanceBufferBuilder(s,1);m.addInstance(f,d),e.geometry=m.finish(),e.material=h.material,e.matrix.identity()}else r.getWorldMatrix(t,f),r.getWorldBounds(t,p),d=r.fragments.fragId2dbId[t],e.geometry=(0,n.mergeGeometries)([s],f.elements,[d],p),e.material=h.material,e.matrix.identity();e.needsUpdate=!1,e.dispatchEvent({type:"removed"})}}}}},95920:(e,t,r)=>{"use strict";r.r(t),r.d(t,{consolidateFragmentList:()=>u});var n=r(87289),i=r(23406),o=r(49514),a=r(23909);var s,l=(s=null,function(e,t,r,n,l,u){var c=e.getFragmentList();s||(s=new a.Matrix4);var h=r[n],d=c.getGeometry(h),f=c.getMaterial(h),p=l-n;if(1!=p){for(var m=l-1,g=new i.InstanceBufferBuilder(d,p),v=n;v<=m;v++){var y=r[v];c.getOriginalWorldMatrix(y,s);var b=c.fragments.fragId2dbId[y];if(!g.addInstance(s,b)){var x=r[m];r[m]=y,r[v]=x,--v,--m}}var _=g.finish();if(_){var E=t.getMaterialVariant(f,o.MATERIAL_VARIANT.INSTANCED,e);u.addContainerMesh(_,E,r,n,p),u.meshes[u.meshes.length-1].rangeStart=n}for(v=m+1;v<l;v++)y=r[v],u.addSingleFragment(c,y)}else u.addSingleFragment(c,h)});function u(e,t,r,i,o){var s=e.getFragmentList(),u=i.supportsInstancedArrays();r=r||100<<20;var c=function(e){for(var t=e.getCount(),r=[],n=0;n<t;n++){var i=e.getGeometryId(n),o=0|r[i];r[i]=o+1}return r}(s);if(!o){var h=function(e,t){function r(r,n){var i=e.getGeometry(r),o=e.getGeometry(n),a=e.getGeometryId(r),s=e.getGeometryId(n),l=t[a],u=t[s],c=l*i.byteSize,h=u*o.byteSize;return c!=h?c-h:i.id!=o.id?i.id-o.id:e.getMaterialId(r)-e.getMaterialId(n)}for(var n=0,i=e.getCount(),o=new Int32Array(i),a=0;a<i;a++)e.getGeometry(a)&&(o[n]=a,n++);if(n<i&&(o=new Int32Array(o.buffer,o.byteOffset,n)),o.sort)o.sort(r);else{var s=new Array(i);for(a=0;a<i;a++)s[a]=o[a];for(s.sort(r),a=0;a<o.length;a++)o[a]=s[a]}return o}(s,c);o=function(e,t,r,i){for(var o=new a.Box3,s=new n.ConsolidationBuilder,l=0;l<r.length&&!(s.costs>=i);l++){var u=r[l];e.getWorldBounds(u,o);var c=e.getGeometry(u),h=e.getMaterial(u);s.addGeom(c,h,o,u)}return s.createConsolidationMap(r,l)}(s,0,h,r)}var d=o.buildConsolidation(s,t,e),f=o.fragOrder,p=o.numConsolidated;if(u)!function(e,t,r,n,i){var o=e.getFragmentList();if(!(n>=r.length)){for(var a=n,s=-1,u=-1,c=n;c<r.length;c++){var h=r[c],d=o.getGeometryId(h),f=o.getMaterialId(h);d==s&&f==u||(c!=n&&l(e,t,r,a,c,i),a=c,s=d,u=f)}l(e,t,r,a,r.length,i)}}(e,t,f,p,d);else for(var m=p;m<f.length;m++){var g=f[m];d.addSingleFragment(s,g)}!function(e,t,r,n){for(var i=e.geoms,o=[],a=0,s=0,l=0;l<t.meshes.length;l++){var u=t.meshes[l],c=u.geometry;c.byteSize||(c.byteSize=(c.vb.byteLength||0)+(c.ib.byteLength||0));var h=Number.isInteger(u.fragId);i.chooseMemoryType(c,c.numInstances,a,s),c.streamingDraw||(s+=c.byteSize,a+=1,h||(c.discardAfterUpload=!0)),h&&(o[c.id]=!0)}for(l=1;l<i.geoms.length;l++)if((c=i.geoms[l])&&!o[l]){var d=r[l];i.chooseMemoryType(c,d,a,s),c.streamingDraw&&n.deallocateGeometry(c),c.streamingDraw||(s+=c.byteSize,a+=1)}}(s,d,c,i);var v=e.getModelId();for(m=0;m<d.meshes.length;m++){d.meshes[m].modelId=v}return d}},96610:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GeomMergeTask:()=>i,writeIdToBuffer:()=>a});var n=1;function i(){this.vb=null,this.vbstride=0,this.posOffset=0,this.normalOffset=0,this.matrices=null,this.ranges=null,this.dbIds=null,this.id=n++}function o(e){e.x=.5*(1+Math.atan2(e.y,e.x)/Math.PI),e.y=.5*(1+e.z),e.z=0}function a(e,t,r){t[r++]=255&e,t[r++]=e>>8&255,t[r++]=e>>16&255,t[r]=0}var s=function(e,t,r,n,i,a,s){for(var l,u,c,h,d,f,p,m=e.posOffset,g=n;g<i;g++){var v=g*e.vbstride+m;s.set(e.vb[v],e.vb[v+1],e.vb[v+2]),s.applyMatrix4(r),e.vb[v]=s.x,e.vb[v+1]=s.y,e.vb[v+2]=s.z}if(-1!==e.normalOffset){var y=2*e.vbstride,b=2*e.normalOffset,x=function(e,t){return t.copy(e),t[12]=0,t[13]=0,t[14]=0,t.invert().transpose()}(r,a);for(g=n;g<i;g++){var _=g*y+b;s.set(t[_],t[_+1],0),s.divideScalar(65535),u=void 0,c=void 0,h=void 0,d=void 0,f=void 0,p=void 0,u=2*(l=s).x-1,c=2*l.y-1,h=Math.sin(u*Math.PI),d=Math.cos(u*Math.PI),f=Math.sqrt(1-c*c),p=c,l.x=d*f,l.y=h*f,l.z=p,s.applyMatrix4(x),s.normalize(),o(s),s.multiplyScalar(65535),t[_]=s.x,t[_+1]=s.y}}};function l(e,t,r){for(var n=16*e,i=0;i<16;i++)r.elements[i]=t[i+n]}i.prototype.run=function(e,t){for(var r=this.vb,n=r.length/this.vbstride,i=e.clone(),o=new Uint8Array(3*n),u=-1!==this.normalOffset?new Uint16Array(r.buffer,r.byteOffset,2*r.length):null,c=this.ranges,h=this.matrices,d=c.length-1,f=0;f<d;f++){var p=c[f],m=c[f+1];l(f,h,e),s(this,u,e,p,m,i,t);for(var g=3*p,v=m-p,y=this.dbIds[f],b=0;b<v;b++)a(y,o,g),g+=3}return{taskId:this.id,vb:this.vb,vertexIds:o}}},23406:(e,t,r)=>{"use strict";r.r(t),r.d(t,{InstanceBufferBuilder:()=>l});var n=r(87289),i=r(96610),o=r(25131),a=r(98926),s=r(23909);function l(e,t){var r=(0,o.createBufferGeometry)();r.ib=e.ib,r.vb=e.vb,r.iblines=e.iblines,(0,n.copyVertexFormat)(e,r),(0,n.copyPrimitiveProps)(e,r);this.offsets=new Float32Array(3*t),this.rotations=new Float32Array(4*t),this.scalings=new Float32Array(3*t),this.ids=new Uint8Array(3*t);var l=new s.Vector3,u=new s.Quaternion,c=new s.Vector3,h=new s.Matrix4,d=0,f=t;this.addInstance=function(e,t){return d>=f?(a.logger.warn("Instance buffer is already full."),!1):(e.decompose(l,u,c),!!function(e,t,r,n){h.compose(t,r,n);for(var i=e.elements,o=h.elements,a=0;a<16;a++){var s=i[a],l=o[a];if(Math.abs(l-s)>1e-4*Math.max(1,Math.min(Math.abs(s),Math.abs(l))))return!1}return!0}(e,l,u,c)&&(this.offsets[3*d]=l.x,this.offsets[3*d+1]=l.y,this.offsets[3*d+2]=l.z,this.rotations[4*d]=u.x,this.rotations[4*d+1]=u.y,this.rotations[4*d+2]=u.z,this.rotations[4*d+3]=u.w,this.scalings[3*d]=c.x,this.scalings[3*d+1]=c.y,this.scalings[3*d+2]=c.z,(0,i.writeIdToBuffer)(t,this.ids,3*d),d++,!0))},this.finish=function(){if(0==d)return null;d<f&&(this.offsets=new Float32Array(this.offsets.buffer,0,3*d),this.rotations=new Float32Array(this.rotations.buffer,0,4*d),this.scalings=new Float32Array(this.scalings.buffer,0,3*d),this.ids=new Uint8Array(this.ids.buffer,0,3*d));var e=new s.BufferAttribute(this.offsets,3),t=new s.BufferAttribute(this.rotations,4),n=new s.BufferAttribute(this.scalings,3),i=new s.BufferAttribute(this.ids,3);return i.normalized=!0,i.bytesPerItem=1,e.divisor=1,t.divisor=1,n.divisor=1,i.divisor=1,r.setAttribute("instOffset",e),r.setAttribute("instRotation",t),r.setAttribute("instScaling",n),r.setAttribute("id",i),r.numInstances=d,r.byteSize=r.vb.byteLength+r.ib.byteLength+this.offsets.byteLength+this.rotations.byteLength+this.scalings.byteLength,r}}},35313:(e,t,r)=>{"use strict";r.r(t),r.d(t,{ModelIteratorTexQuad:()=>M,TexQuadConfig:()=>S});var n=r(84998),i=r(67317),o=r(79175),a=r(43586),s=r(23909);function l(){this.offsetX=0,this.offsetY=0,this.scaleX=1,this.scaleY=1}function u(){var e=[],t=0,r=new l;function n(e,t){var n=t||r,i=[n.offsetX,n.offsetY,n.offsetX+n.scaleX,n.offsetY,n.offsetX+n.scaleX,n.offsetY+n.scaleY,n.offsetX,n.offsetY+n.scaleY],o=e.getAttribute("uv");if(o){for(var a=0;a<i.length;a+=2){var l=a/2;o.setXY(l,i[a],i[a+1])}o.needsUpdate=!0}else e.setAttribute("uv",new s.BufferAttribute(new Float32Array(i),2))}this.acquireQuadGeom=function(r){var i=e[t];return i?n(i,r):(i=this.createQuadGeom(r),e[t]=i),t++,i},this.createQuadGeom=function(e){var t=new s.BufferGeometry;return t.setAttribute("position",new s.BufferAttribute(new Float32Array([0,0,0,1,0,0,1,1,0,0,1,0]),3)),t.setIndex([0,1,2,0,2,3]),t.computeVertexNormals(),n(t,e),t},this.reset=function(){t=0},this.dispose=function(){for(var t=0;t<e.length;t++){var r=e[t];r&&(r.dispose(),r.needsUpdate=!0)}e=[]}}l.prototype.toVec4=function(){return new s.Vector4(this.offsetX,this.offsetY,this.scaleX,this.scaleY)},l.prototype.copyTo=function(e){e.offsetX=this.offsetX,e.offsetY=this.offsetY,e.scaleX=this.scaleX,e.scaleY=this.scaleY};var c,h,d=r(98926),f=r(27820),p=r(14705),m=r(34722),g=r.n(m),v=r(13518),y=r.n(v),b=r(12990);function x(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}h=g(),c=y();var _,E={uniforms:s.UniformsUtils.merge([s.UniformsLib.common,b.ShaderChunks.CutPlanesUniforms,b.ShaderChunks.IdUniforms,b.ShaderChunks.ThemingUniform,{selectionColor:{type:"v4",value:new s.Vector4(0,0,1,0)},viewportBounds:{type:"v4",value:new s.Vector4(0,0,1,1)},modelLocalMatrix:{type:"m4",value:new s.Matrix4}}].concat((_=[],function(e){if(Array.isArray(e))return x(e)}(_)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(_)||function(e,t){if(e){if("string"==typeof e)return x(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?x(e,t):void 0}}(_)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()))),vertexShader:h,fragmentShader:c},w=(0,n.getGlobal)().document,A=function(e,t){this.timeStamps=e,this.mesh=t,this.state=0};function S(){this.urlPattern=null,this.tileSize=null,this.maxLevel=null,this.skippedLevels=[],this.textureLoader=null,this.texWidth=0,this.texHeight=0,this.maxActiveTiles=(0,n.isMobileDevice)()?0:400,this.cacheSize=(0,n.isMobileDevice)()?0:150,this.onRootLoaded=null,this.levelOffset=0,this.getRootTileSize=function(){return 1*(this.tileSize<<this.maxLevel)},this.getQuadWidth=function(){return this.scale*this.texWidth/this.getRootTileSize()},this.getQuadHeight=function(){return this.scale*this.texHeight/this.getRootTileSize()},this.getPageToModelTransform=function(e,t){var r=e/this.getQuadWidth(),n=t/this.getQuadHeight();return new a.LmvMatrix4(!0).set(r,0,0,0,0,n,0,0,0,0,1,0,0,0,0,1)},this.getBBox=function(){var e=this.getQuadWidth(),t=this.getQuadHeight();if(this.fitPaperSize)return new s.Box3(new s.Vector3,new s.Vector3(e,t,0));var r=1-t;return new s.Box3(new s.Vector3(0,r,0),new s.Vector3(e,1,0))},this.valid=function(){return"string"==typeof this.urlPattern&&this.urlPattern.length>0&&"number"==typeof this.tileSize&&this.tileSize>0&&"number"==typeof this.maxLevel&&this.maxLevel>0&&"number"==typeof this.texWidth&&this.texWidth>0&&"number"==typeof this.texHeight&&this.texHeight>0},this.initForSimpleImage=function(e){this.urlPattern=decodeURIComponent(e),this.maxLevel=0,this.levelOffset=0,this.scale=1,this.tileSize=-1,this.texWidth=-1,this.texHeight=-1,this.isSimpleImage=!0},this.isLevelPresent=function(e){return!this.skippedLevels[e]},this.initFromLoadOptions=function(e,t,r,n){if(this.urlPattern=decodeURIComponent(e),this.textureLoader=r,this.options=n,t){this.tileSize=t.tileSize,this.maxLevel=(o=t.texWidth,a=t.texHeight,s=t.tileSize,l=Math.ceil(Math.log2(o)),u=Math.ceil(Math.log2(a)),Math.max(l,u)-Math.log2(s)),this.texWidth=t.texWidth,this.texHeight=t.texHeight,this.levelOffset=t.levelOffset,this.zips=t.zips;var i=!(!t.paperWidth||!t.paperHeight);this.fitPaperSize=t.fitPaperSize&&i,this.paperHeight=t.paperHeight,this.scale=this.fitPaperSize?t.paperWidth*this.getRootTileSize()/this.texWidth:1,this.skippedLevels=function(e){var t=[];if(e.zips){r=(r=(r=(r=e.urlPattern.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")).replace(/\\{x\\}/,"[0-9]+")).replace(/\\{y\\}/,"[0-9]+")).replace(/\\{z\\}/,"([0-9]+)");var r=new RegExp("^"+r+"$");t.length=e.maxLevel+1,t.fill(!0);var n=0;e.zips.forEach((function(i){Object.keys(i.fileTable).forEach((function(i){var o=r.exec(i);if(o&&o[1]){var a=parseInt(o[1])-e.levelOffset;a>=0&&a<=e.maxLevel&&(t[a]=!1,++n)}}))})),0===n&&(t.length=0,d.logger.info("No leaflet levels found - assume all are present"))}return t}(this),"number"==typeof t.maxLevel&&function(e,t,r){for(;r>0&&e.skippedLevels[r];)--r;var n=t-r;n>0&&(e.texWidth>>=n,e.texHeight>>=n,e.maxLevel=r)}(this,this.maxLevel,t.maxLevel),this.maxActiveTiles=t.maxActiveTiles||this.maxActiveTiles,this.cacheSize=t.cacheSize||this.cacheSize}else this.options&&(this.options.loadOptions={});var o,a,s,l,u}}function M(e,t){this.isModelIteratorTexQuad=!0;var r,n=e,a=1,c=e.getBBox(),h=[],d=null,m=null,g=new s.Matrix4,v=new s.Matrix4,y=new s.Matrix4,b=new s.Vector3,x=new s.Quaternion,_=new s.Vector3,S=new Autodesk.Viewing.Private.FrustumIntersector,M=1,T=1,C=new s.Vector4(0,0,0,0),P=(new s.Vector4).copy(C),D=0,L=t,R=null,I=!1,O=!1,N=!1,k=new s.Color,F=[],V=[],U=[];this.registerView=function(){var e=h.indexOf(void 0);-1===e&&(e=h.length);var t=new s.Scene;return t.ignoreFadeMaterial=!0,n.placementTransform&&t.matrix.copy(n.placementTransform),t.matrixAutoUpdate=!1,h[e]=t,U[e]=0,F[e]=!0,e},this.registerView();var B=0,z=0,G=!1,H=[],W=null,j=!1,q=new u;function X(e){var t=n.maxLevel-e;return n.texWidth>>t}function Y(e){var t=n.maxLevel-e;return n.texHeight>>t}function K(e){var t=X(e.level),r=Y(e.level),i=e.x*n.tileSize,o=e.y*n.tileSize;return i>=t||o>=r}function Z(e){var t=X(e.level),r=Y(e.level),i=e.x*n.tileSize,o=e.y*n.tileSize,a=Math.max(0,Math.min(n.tileSize,t-i)),l=Math.max(0,Math.min(n.tileSize,r-o)),u=1*n.tileSize;return new s.Vector2(a/u,l/u)}function Q(e){return n.scale/(1<<e)}function J(e){return Q(e.level)*e.x*a}function $(e){var t=Q(e.level);return(n.fitPaperSize?n.paperHeight:1)-(e.y+1)*t*a}function ee(e){return V[(0,i.tile2Index)(e)]}function te(e){var t=ee(e);return t instanceof A&&2===t.state}function re(e,t,r){var n;if(t)W||(W=q.createQuadGeom()),n=W;else{var i=function(e,t){for(var r=e.getParent();r;){var n=ee(r),i=n&&2===n.state;if(i&&t&&n.mesh.material.map.needsUpdate&&r.level>0&&(i=!1),i)break;r=r.getParent()}return r}(e);t=oe(i).material;var o=function(e,t){var r=1<<e.level-t.level,n=1/r,i=n,o=Z(t);n/=o.x,i/=o.y;var a=t.x*r,s=t.y*r,u=e.x-a,c=e.y-s,h=Z(e);u*=n,c=1-(c*=i)-i*h.y;var d=new l;return d.offsetX=u,d.offsetY=c,d.scaleX=n*h.x,d.scaleY=i*h.y,d}(e,i);n=q.acquireQuadGeom(o)}var u=new s.Mesh(n,t);u.tile=e,u.modelId=D,u.themingColor=P;var c=Q(e.level),h=Z(e),d=(1-h.y)*c*a,f=J(e),p=$(e);return u.position.set(f,p+d,0),u.scale.set(c*h.x*a,c*h.y*a,1),t.uniforms.offsetRepeat.value.set(t.map.offset.x,t.map.offset.y,t.map.repeat.x,t.map.repeat.y),u}this.setAggressivePrefetching=function(e){j=e},this.getScene=function(e){return h[e=e||0]},this.getModelMatrix=function(){return d},this.getInverseModelMatrix=function(){return d?(m||(m=d.clone().invert()),m):null},this.setModelMatrix=function(e){e?(d=d||new s.Matrix4).copy(e):d=null,m=null},this.nextBatch=function(e){return F[e=e||0]?null:(F[e]=!0,h[0].renderImportance=O?-1:void 0,h[0])},this.getSceneCount=function(){return 1},this.done=function(e){return F[e||0]},this.rayCast=function(e,t){return null},this.getVisibleBounds=function(e,t){var r=c;R&&(r=r.clone().intersect(R)),e&&(e.copy(r),n.placementTransform&&e.applyMatrix4(n.placementTransform),d&&e.applyMatrix4(d)),t&&(t.copy(r),n.placementTransform&&t.applyMatrix4(n.placementTransform),d&&t.applyMatrix4(d))},this.setViewBounds=function(e){R=e,L.setViewportBoundsForModel(D,R)},this.getViewBounds=function(){return R},this.setDoNotCut=function(e){return I=e},this.getDoNotCut=function(){return I};var ne=this;function ie(t){var r=(0,i.tile2Index)(t),o=V[r];if(!o||0===o.state){o||(o=new A(U.slice()),V[r]=o),o.state=1;var a=function(e){var t=n.levelOffset?n.levelOffset:0;return n.urlPattern.replace("{x}",e.x).replace("{y}",e.y).replace("{z}",e.level+t)}(t),l=function(r){if(ne&&r){0===n.maxLevel&&(-1===n.texWidth&&(n.texWidth=r.image.width),-1===n.texHeight&&(n.texHeight=r.image.height),-1===n.tileSize&&(n.tileSize=Math.max(r.image.width,r.image.height)),n.options&&(n.options.loadOptions.texWidth=n.texWidth,n.options.loadOptions.texHeight=n.texHeight),c=e.getBBox()),function(e){for(var t=e.image,r=1;(r*=2)<t.width;);for(var n=1;(n*=2)<t.height;);if(r!==t.width||n!==t.height){var i=w.createElement("canvas");i.width=r,i.height=n;var o=i.getContext("2d");o.drawImage(t,0,0);var a,s,l=o.getImageData(0,0,r,n),u=new Uint32Array(l.data.buffer,0,r*n);if(t.height<n){var c=t.height*r;for(a=t.height;a<n;++a,c+=r)for(s=0;s<t.width;++s)u[c+s]=u[c+s-r]}if(t.width<r){var h=0;for(a=0;a<n;++a,h+=r)for(s=t.width;s<r;++s)u[h+s]=u[h+s-1]}o.putImageData(l,0,0),e.image=i,e.flipY&&e.offset.set(0,1-t.height/n),e.repeat.set(t.width/r,t.height/n)}}(r),r.minFilter=s.LinearMipMapLinearFilter,r.magFilter=s.LinearFilter,r.anisotropy=Math.min(4,Math.max(n.maxAnisotropy,1));var i=(0,p.createShaderMaterial)(E);i.supportsMrtNormals=!0,i.supportsViewportBounds=!0,i.map=i.uniforms.map.value=r,i.side=s.DoubleSide,i.doNotCut=ne.getDoNotCut(),i.tile=t,i.disableEnvMap=!0,-1!==a.toLowerCase().indexOf(".png")&&(i.transparent=!0,i.alphaTest=.01);var l=re(t,i);o.mesh=l,o.state=2,z--,G=!0;var u=r&&r.image?r.image.src:null;u&&s.Cache&&s.Cache.get(u)&&s.Cache.remove(u),0===t.level&&n.onRootLoaded&&(D=n.onRootLoaded()),l.themingColor=P,l.modelId=D,i.name="model:".concat(D,"|").concat(a),L.addMaterial(i.name,i,!0),L.setMaterialViewportBounds(i,R),ne._updateMaterialVisibility(i),ne._updateMaterialSelection(i)}};z++,n.textureLoader(a,(function(e,t){l(e)}),(function(e){n.onDone(e,null),console.error(e)}))}}function oe(e){var t=(0,i.tile2Index)(e),r=V[t];return r&&2===r.state?r.mesh:null}function ae(e,t){var r=J(e)*M,n=$(e)*T;t.set(r,n,0)}function se(e,t){var r=Q(e.level),n=(J(e)+r)*M,i=($(e)+r)*T;t.set(n,i,0)}this.requestRootTile=function(){ie(new i.TileCoords(0,0,0))};var le,ue,ce,he=(le=new s.Vector3,ue=new s.Vector3,ce=new s.Box3,function(e,t){return ae(e,le),se(e,ue),ce.set(le,ue),t.intersectsBox(ce)>0}),de=function(){var e=new s.Vector3,t=new s.Vector3;return function(r,n,i){var o=Q(r.level);ae(r,e),se(r,t);var a=f.SceneMath.pointToMinMaxBoxDistance2(i,e,t);return(he(r,n)?100:1)*(o*o)/(a=Math.max(a,1e-4))}}(),fe=function(){var e=new s.Vector3,t=new s.Vector3;return function(r,i,o){ae(r,e),se(r,t);var a=Math.abs(function(e,t,r,n){var i=e.clone();return i.max(r),i.min(n),i.sub(e).dot(t)}(i.position,o,e,t)),s=n.getPixelRatio(),l=i.pixelsPerUnitAtDistance(a)*s;return(t.y-e.y)*l}}();function pe(e,t){this.tile=e,this.prio=t}function me(e,t){return e.prio>t.prio}function ge(e,t){var r=V[(0,i.tile2Index)(e)];r&&r.timeStamps[t]!==U[t]&&(r.timeStamps[t]=U[t],B++)}function ve(e,t,r){e.sort((function(e,n){var i=de(e,t,r);return de(n,t,r)-i}));for(var n=0,i=0;i<e.length;i++){var o=ee(e[i]);if(!o||1!==o.state){if(z>=5)break;ie(e[i]),n++}}return n}function ye(e){if(e&&e.mesh&&e.mesh.material){var t=e.mesh.material;L.removeMaterial(t.name),t.map.dispose(),t.map.needsUpdate=!0;t.dispatchEvent({type:"dispose"}),t.needsUpdate=!0}}function be(e){for(var t=0;t<U.length;t++){if(!!h[t]&&e.timeStamps[t]===U[t])return!0}return!1}this.dispose=function(){var e;for(e in V)ye(V[e]);W&&(W.dispose(),W.needsUpdate=!0),q.dispose()},this.dtor=function(){this.dispose(),ne=null,L=null},this.reset=function(e,t,a){var l,u,c=(a=a||0)>0,f=h[a],p=function(e,t,n){var i=e.matrixWorld;if(d?i.multiplyMatrices(d,e.matrix):i.copy(e.matrix),i.equals(y))M=1,T=1;else{i.decompose(b,x,_),g.makeRotationFromQuaternion(x),g.setPosition(b),M=_.x,T=_.y,r=n.clone(r),v.copy(g).invert(),r.transformCurrentView(v),r.updateCameraMatrices();var o=t.cutPlanes,a=t.areaCullThreshold;(t=S).areaCullThreshold=a,t.reset(r,o),n=r}return{camera:n,frustum:t}}(f,e,t);for(t=p.camera,e=p.frustum,l=0;l<f.children.length;l++){f.children[l].dispatchEvent({type:"removed"})}if(f.children.length=0,U[a]++,B=0,q.reset(),!te(new i.TileCoords(0,0,0)))return F[a]=!0,!1;var m=new o.SortedList(me),E=new i.TileCoords(0,0,0),w=de(E,e,t.position);m.add(new pe(E,w));for(var A=t.getWorldDirection(new s.Vector3),C=[],P=[],D=[];m.size()>0;){if(u=m.get(0).tile,m.removeAt(0),!K(u)){var L=!0;u.level===n.maxLevel&&(L=!1),fe(u,t,A)<n.tileSize&&n.isLevelPresent(u.level)&&(L=!1);var R=he(u,e);if(R&&(!te(u)&&n.isLevelPresent(u.level)&&D.push(u),ge(u,a)),!R&&C.length+P.length>n.maxActiveTiles&&(L=!1),L)for(var I=0;I<4;I++){var O=u.getChild(I);w=de(O,e,t.position),m.add(new pe(O,w))}else R?C.push(u):P.push(u)}}var N=0;G=!1;var k=!0;for(l=0;l<C.length;++l){var W=oe(u=C[l]);W&&W.material.map.needsUpdate&&!j&&(N<5||c?N++:(W=re(u,null),G=!0,k=!1)),W||(W=re(u,null),k=!1),f.add(W)}F[a]=!1;var X=ve(D,e,t.position);B+=z;var Y=[];for(l=0;l<P.length&&!(B>=n.maxActiveTiles);l++)if(te(u=P[l]))for(var Z=0;Z<=u.level;Z++){if(ge(u.getParentAtLevel(Z),a),B>n.maxActiveTiles)break}else Y.push(u),B++;if(X+=ve(Y,e,t.position),j){for(Y=[],l=0;l<C.length;++l)if((u=C[l]).level!==n.maxLevel&&n.isLevelPresent(u.level+1))for(var Q=0;Q<4;Q++){var J=u.getChild(Q);!K(J)&&he(J,e)&&(te(J)||(Y.push(J),B++))}X+=ve(Y,e,t.position)}if(c||function(e,t,r){var o=Object.keys(V),a=o.length,s=e-(n.cacheSize-a);if(!(s<=0)){o.sort((function(e,n){var o=V[e].timeStamps[0],a=V[n].timeStamps[0];if(o!==a)return o-a;var s=(0,i.index2Tile)(e),l=(0,i.index2Tile)(n);return de(s,t,r)-de(l,t,r)}));for(var l=Math.min(s,o.length),u=0;u<l;u++){var c=o[u];if(0!==(0,i.index2Tile)(c).level){var h=V[c];if(2===h.state){if(be(h))break;ye(h),delete V[c]}}}}}(X,e,t.position),k&&H.length>0){var $=H.splice(0,H.length);setTimeout((function(){for(var e=0;e<$.length;e++)$[e](a)}),1)}return k},this.callWhenRefined=function(e){H.push(e)},this.update=function(){return G},this.setDpiScale=function(e){a=e},this.getDpiScale=function(){return a},this.setThemingColor=function(e){P.copy(e)},this.clearThemingColor=function(){P.copy(C)},this.unregisterView=function(e){h[e]=void 0,U[e]=void 0,F[e]=void 0;for(var t=h.length;t>0&&!h[t-1];)t--;h.length=t,U.length=t,F.length=t},this._updateMaterialVisibility=function(e){!e.defines.GHOSTED^!O&&(O?e.defines.GHOSTED=1:delete e.defines.GHOSTED,e.needsUpdate=!0)},this.setVisibility=function(e){var t=this;O=!e,L.forEachInModel(D,!1,(function(e){t._updateMaterialVisibility(e)}))},this._updateMaterialSelection=function(e){e.uniforms.selectionColor.value.set(k.r,k.g,k.b,N?.6:0)},this.highlightSelection=function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:k;N=e,k=r,L.forEachInModel(D,!1,(function(e){t._updateMaterialSelection(e)}))}}},67317:(e,t,r)=>{"use strict";function n(e,t,r){this.level=e,this.x=t,this.y=r}function i(e){var t=((1<<2*e.level)-1)/3,r=1<<e.level;return t+e.y*r+e.x}function o(e){for(var t=new n(0,0,0);i(t)<=e;)t.level++;t.level--;var r=e-i(t),o=1<<t.level;return t.y=Math.floor(r/o),t.x=r%o,t}r.r(t),r.d(t,{TileCoords:()=>n,tile2Index:()=>i,index2Tile:()=>o}),n.prototype={constructor:n,copy:function(){return new n(this.level,this.x,this.y)},isValid:function(){return Number.isInteger(this.level)&&this.level>=0&&Number.isInteger(this.x)&&Number.isInteger(this.y)},getChild:function(e){var t=1&e?1:0,r=2&e?1:0;return new n(this.level+1,2*this.x+t,2*this.y+r)},getParent:function(){return 0===this.level?null:new n(this.level-1,Math.floor(this.x/2),Math.floor(this.y/2))},getParentAtLevel:function(e){if(e<0||e>this.level)return null;var t=this.level-e;return new n(e,Math.floor(this.x>>t),Math.floor(this.y>>t))},toString:function(){return"("+this.level+", "+this.x+", "+this.y+")"},equals:function(e,t,r){return e instanceof n?this.equals(e.level,e.x,e.y):this.level===e&&this.x===t&&this.y===r}}},41145:(e,t,r)=>{var n;function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)
/*! Hammer.JS - v2.0.8 - 2016-04-23
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */}!function(o,a,s,l){"use strict";var u=["","webkit","Moz","MS","ms","o"],c=a.createElement("div"),h=Math.round,d=Math.abs,f=Date.now;function p(e,t,r){return setTimeout(E(e,r),t)}function m(e,t,r){return!!Array.isArray(e)&&(g(e,r[t],r),!0)}function g(e,t,r){var n;if(e)if(e.forEach)e.forEach(t,r);else if(e.length!==l)for(n=0;n<e.length;)t.call(r,e[n],n,e),n++;else for(n in e)e.hasOwnProperty(n)&&t.call(r,e[n],n,e)}function v(e,t,r){var n="DEPRECATED METHOD: "+t+"\n"+r+" AT \n";return function(){var t=new Error("get-stack-trace"),r=t&&t.stack?t.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",i=o.console&&(o.console.warn||o.console.log);return i&&i.call(o.console,n,r),e.apply(this,arguments)}}var y=function(e){if(e===l||null===e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),r=1;r<arguments.length;r++){var n=arguments[r];if(n!==l&&null!==n)for(var i in n)n.hasOwnProperty(i)&&(t[i]=Array.isArray(n[i])?n[i].slice(0):n[i])}return t},b=v((function(e,t,r){for(var n=Object.keys(t),i=0;i<n.length;)(!r||r&&e[n[i]]===l)&&(e[n[i]]=t[n[i]]),i++;return e}),"extend","Use `assign`."),x=v((function(e,t){return b(e,t,!0)}),"merge","Use `assign`.");function _(e,t,r){var n,i=t.prototype;(n=e.prototype=Object.create(i)).constructor=e,n._super=i,r&&y(n,r)}function E(e,t){return function(){return e.apply(t,arguments)}}function w(e,t){return"function"==i(e)?e.apply(t&&t[0]||l,t):e}function A(e,t){return e===l?t:e}function S(e,t,r){g(P(t),(function(t){e.addEventListener(t,r,!1)}))}function M(e,t,r){g(P(t),(function(t){e.removeEventListener(t,r,!1)}))}function T(e,t){for(;e;){if(e==t)return!0;e=e.parentNode}return!1}function C(e,t){return e.indexOf(t)>-1}function P(e){return e.trim().split(/\s+/g)}function D(e,t,r){if(e.indexOf&&!r)return e.indexOf(t);for(var n=0;n<e.length;){if(r&&e[n][r]==t||!r&&e[n]===t)return n;n++}return-1}function L(e){return Array.prototype.slice.call(e,0)}function R(e,t,r){for(var n=[],i=[],o=0;o<e.length;){var a=t?e[o][t]:e[o];D(i,a)<0&&n.push(e[o]),i[o]=a,o++}return r&&(n=t?n.sort((function(e,r){return e[t]>r[t]})):n.sort()),n}function I(e,t){for(var r,n,i=t[0].toUpperCase()+t.slice(1),o=0;o<u.length;){if((n=(r=u[o])?r+i:t)in e)return n;o++}return l}var O=1;function N(e){var t=e.ownerDocument||e;return t.defaultView||t.parentWindow||o}var k="ontouchstart"in o,F=I(o,"PointerEvent")!==l,V=k&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),U="touch",B="mouse",z=24,G=["x","y"],H=["clientX","clientY"];function W(e,t){var r=this;this.manager=e,this.callback=t,this.element=e.element,this.target=e.options.inputTarget,this.domHandler=function(t){w(e.options.enable,[e])&&r.handler(t)},this.init()}function j(e,t,r){var n=r.pointers.length,i=r.changedPointers.length,o=1&t&&n-i==0,a=12&t&&n-i==0;r.isFirst=!!o,r.isFinal=!!a,o&&(e.session={}),r.eventType=t,function(e,t){var r=e.session,n=t.pointers,i=n.length;r.firstInput||(r.firstInput=q(t));i>1&&!r.firstMultiple?r.firstMultiple=q(t):1===i&&(r.firstMultiple=!1);var o=r.firstInput,a=r.firstMultiple,s=a?a.center:o.center,u=t.center=X(n);t.timeStamp=f(),t.deltaTime=t.timeStamp-o.timeStamp,t.angle=Q(s,u),t.distance=Z(s,u),function(e,t){var r=t.center,n=e.offsetDelta||{},i=e.prevDelta||{},o=e.prevInput||{};1!==t.eventType&&4!==o.eventType||(i=e.prevDelta={x:o.deltaX||0,y:o.deltaY||0},n=e.offsetDelta={x:r.x,y:r.y});t.deltaX=i.x+(r.x-n.x),t.deltaY=i.y+(r.y-n.y)}(r,t),t.offsetDirection=K(t.deltaX,t.deltaY);var c=Y(t.deltaTime,t.deltaX,t.deltaY);t.overallVelocityX=c.x,t.overallVelocityY=c.y,t.overallVelocity=d(c.x)>d(c.y)?c.x:c.y,t.scale=a?(h=a.pointers,p=n,Z(p[0],p[1],H)/Z(h[0],h[1],H)):1,t.rotation=a?function(e,t){return Q(t[1],t[0],H)-Q(e[1],e[0],H)}(a.pointers,n):0,t.maxPointers=r.prevInput?t.pointers.length>r.prevInput.maxPointers?t.pointers.length:r.prevInput.maxPointers:t.pointers.length,function(e,t){var r,n,i,o,a=e.lastInterval||t,s=t.timeStamp-a.timeStamp;if(8!=t.eventType&&(s>25||a.velocity===l)){var u=t.deltaX-a.deltaX,c=t.deltaY-a.deltaY,h=Y(s,u,c);n=h.x,i=h.y,r=d(h.x)>d(h.y)?h.x:h.y,o=K(u,c),e.lastInterval=t}else r=a.velocity,n=a.velocityX,i=a.velocityY,o=a.direction;t.velocity=r,t.velocityX=n,t.velocityY=i,t.direction=o}(r,t);var h,p;var m=e.element;T(t.srcEvent.target,m)&&(m=t.srcEvent.target);t.target=m}(e,r),e.emit("hammer.input",r),e.recognize(r),e.session.prevInput=r}function q(e){for(var t=[],r=0;r<e.pointers.length;)t[r]={clientX:h(e.pointers[r].clientX),clientY:h(e.pointers[r].clientY)},r++;return{timeStamp:f(),pointers:t,center:X(t),deltaX:e.deltaX,deltaY:e.deltaY}}function X(e){var t=e.length;if(1===t)return{x:h(e[0].clientX),y:h(e[0].clientY)};for(var r=0,n=0,i=0;i<t;)r+=e[i].clientX,n+=e[i].clientY,i++;return{x:h(r/t),y:h(n/t)}}function Y(e,t,r){return{x:t/e||0,y:r/e||0}}function K(e,t){return e===t?1:d(e)>=d(t)?e<0?2:4:t<0?8:16}function Z(e,t,r){r||(r=G);var n=t[r[0]]-e[r[0]],i=t[r[1]]-e[r[1]];return Math.sqrt(n*n+i*i)}function Q(e,t,r){r||(r=G);var n=t[r[0]]-e[r[0]],i=t[r[1]]-e[r[1]];return 180*Math.atan2(i,n)/Math.PI}W.prototype={handler:function(){},init:function(){this.evEl&&S(this.element,this.evEl,this.domHandler),this.evTarget&&S(this.target,this.evTarget,this.domHandler),this.evWin&&S(N(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&M(this.element,this.evEl,this.domHandler),this.evTarget&&M(this.target,this.evTarget,this.domHandler),this.evWin&&M(N(this.element),this.evWin,this.domHandler)}};var J={mousedown:1,mousemove:2,mouseup:4},$="mousedown",ee="mousemove mouseup";function te(){this.evEl=$,this.evWin=ee,this.pressed=!1,W.apply(this,arguments)}_(te,W,{handler:function(e){var t=J[e.type];1&t&&0===e.button&&(this.pressed=!0),2&t&&1!==e.which&&(t=4),this.pressed&&(4&t&&(this.pressed=!1),this.callback(this.manager,t,{pointers:[e],changedPointers:[e],pointerType:B,srcEvent:e}))}});var re={pointerdown:1,pointermove:2,pointerup:4,pointercancel:8,pointerout:8},ne={2:U,3:"pen",4:B,5:"kinect"},ie="pointerdown",oe="pointermove pointerup pointercancel";function ae(){this.evEl=ie,this.evWin=oe,W.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}o.MSPointerEvent&&!o.PointerEvent&&(ie="MSPointerDown",oe="MSPointerMove MSPointerUp MSPointerCancel"),_(ae,W,{handler:function(e){var t=this.store,r=!1,n=e.type.toLowerCase().replace("ms",""),i=re[n],o=ne[e.pointerType]||e.pointerType,a=o===U,s=o===B,l=D(t,e.pointerId,"pointerId");1&i&&(0===e.button||a)?l<0&&(t.push(e),l=t.length-1):12&i&&(r=!0),l<0||(t[l]=e,s&&!this.manager.options.handlePointerEventMouse||this.callback(this.manager,i,{pointers:t,changedPointers:[e],pointerType:o,srcEvent:e}),r&&t.splice(l,1))}});var se={touchstart:1,touchmove:2,touchend:4,touchcancel:8},le="touchstart",ue="touchstart touchmove touchend touchcancel";function ce(){this.evTarget=le,this.evWin=ue,this.started=!1,W.apply(this,arguments)}function he(e,t){var r=L(e.touches),n=L(e.changedTouches);return 12&t&&(r=R(r.concat(n),"identifier",!0)),[r,n]}_(ce,W,{handler:function(e){var t=se[e.type];if(1===t&&(this.started=!0),this.started){var r=he.call(this,e,t);12&t&&r[0].length-r[1].length==0&&(this.started=!1),this.callback(this.manager,t,{pointers:r[0],changedPointers:r[1],pointerType:U,srcEvent:e})}}});var de={touchstart:1,touchmove:2,touchend:4,touchcancel:8},fe="touchstart touchmove touchend touchcancel";function pe(){this.evTarget=fe,this.targetIds={},W.apply(this,arguments)}function me(e,t){var r=L(e.touches),n=this.targetIds;if(3&t&&1===r.length)return n[r[0].identifier]=!0,[r,r];var i,o,a=L(e.changedTouches),s=[],l=this.target;if(o=r.filter((function(e){return T(e.target,l)})),1===t)for(i=0;i<o.length;)n[o[i].identifier]=!0,i++;for(i=0;i<a.length;)n[a[i].identifier]&&s.push(a[i]),12&t&&delete n[a[i].identifier],i++;return s.length?[R(o.concat(s),"identifier",!0),s]:void 0}_(pe,W,{handler:function(e){var t=de[e.type],r=me.call(this,e,t);r&&this.callback(this.manager,t,{pointers:r[0],changedPointers:r[1],pointerType:U,srcEvent:e})}});function ge(){W.apply(this,arguments);var e=E(this.handler,this);this.touch=new pe(this.manager,e),this.mouse=new te(this.manager,e),this.primaryTouch=null,this.lastTouches=[]}function ve(e,t){1&e?(this.primaryTouch=t.changedPointers[0].identifier,ye.call(this,t)):12&e&&ye.call(this,t)}function ye(e){var t=e.changedPointers[0];if(t.identifier===this.primaryTouch){var r={x:t.clientX,y:t.clientY};this.lastTouches.push(r);var n=this.lastTouches;setTimeout((function(){var e=n.indexOf(r);e>-1&&n.splice(e,1)}),2500)}}function be(e){for(var t=e.srcEvent.clientX,r=e.srcEvent.clientY,n=0;n<this.lastTouches.length;n++){var i=this.lastTouches[n],o=Math.abs(t-i.x),a=Math.abs(r-i.y);if(o<=25&&a<=25)return!0}return!1}_(ge,W,{handler:function(e,t,r){var n=r.pointerType==U,i=r.pointerType==B;if(!(i&&r.sourceCapabilities&&r.sourceCapabilities.firesTouchEvents)){if(n)ve.call(this,t,r);else if(i&&be.call(this,r))return;this.callback(e,t,r)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var xe=I(c.style,"touchAction"),_e=xe!==l,Ee="compute",we="auto",Ae="manipulation",Se="none",Me="pan-x",Te="pan-y",Ce=function(){if(!_e)return!1;var e={},t=o.CSS&&o.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach((function(r){e[r]=!t||o.CSS.supports("touch-action",r)})),e}();function Pe(e,t){this.manager=e,this.set(t)}Pe.prototype={set:function(e){e==Ee&&(e=this.compute()),_e&&this.manager.element.style&&Ce[e]&&(this.manager.element.style[xe]=e),this.actions=e.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var e=[];return g(this.manager.recognizers,(function(t){w(t.options.enable,[t])&&(e=e.concat(t.getTouchAction()))})),function(e){if(C(e,Se))return Se;var t=C(e,Me),r=C(e,Te);if(t&&r)return Se;if(t||r)return t?Me:Te;if(C(e,Ae))return Ae;return we}(e.join(" "))},preventDefaults:function(e){var t=e.srcEvent,r=e.offsetDirection;if(this.manager.session.prevented)t.preventDefault();else{var n=this.actions,i=C(n,Se)&&!Ce.none,o=C(n,Te)&&!Ce["pan-y"],a=C(n,Me)&&!Ce["pan-x"];if(i){var s=1===e.pointers.length,l=e.distance<2,u=e.deltaTime<250;if(s&&l&&u)return}if(!a||!o)return i||o&&6&r||a&&r&z?this.preventSrc(t):void 0}},preventSrc:function(e){this.manager.session.prevented=!0,e.preventDefault()}};var De=32;function Le(e){this.options=y({},this.defaults,e||{}),this.id=O++,this.manager=null,this.options.enable=A(this.options.enable,!0),this.state=1,this.simultaneous={},this.requireFail=[]}function Re(e){return 16&e?"cancel":8&e?"end":4&e?"move":2&e?"start":""}function Ie(e){return 16==e?"down":8==e?"up":2==e?"left":4==e?"right":""}function Oe(e,t){var r=t.manager;return r?r.get(e):e}function Ne(){Le.apply(this,arguments)}function ke(){Ne.apply(this,arguments),this.pX=null,this.pY=null}function Fe(){Ne.apply(this,arguments)}function Ve(){Le.apply(this,arguments),this._timer=null,this._input=null}function Ue(){Ne.apply(this,arguments)}function Be(){Ne.apply(this,arguments)}function ze(){Le.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function Ge(e,t){return(t=t||{}).recognizers=A(t.recognizers,Ge.defaults.preset),new He(e,t)}Le.prototype={defaults:{},set:function(e){return y(this.options,e),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(e){if(m(e,"recognizeWith",this))return this;var t=this.simultaneous;return t[(e=Oe(e,this)).id]||(t[e.id]=e,e.recognizeWith(this)),this},dropRecognizeWith:function(e){return m(e,"dropRecognizeWith",this)||(e=Oe(e,this),delete this.simultaneous[e.id]),this},requireFailure:function(e){if(m(e,"requireFailure",this))return this;var t=this.requireFail;return-1===D(t,e=Oe(e,this))&&(t.push(e),e.requireFailure(this)),this},dropRequireFailure:function(e){if(m(e,"dropRequireFailure",this))return this;e=Oe(e,this);var t=D(this.requireFail,e);return t>-1&&this.requireFail.splice(t,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(e){return!!this.simultaneous[e.id]},emit:function(e){var t=this,r=this.state;function n(r){t.manager.emit(r,e)}r<8&&n(t.options.event+Re(r)),n(t.options.event),e.additionalEvent&&n(e.additionalEvent),r>=8&&n(t.options.event+Re(r))},tryEmit:function(e){if(this.canEmit())return this.emit(e);this.state=De},canEmit:function(){for(var e=0;e<this.requireFail.length;){if(!(33&this.requireFail[e].state))return!1;e++}return!0},recognize:function(e){var t=y({},e);if(!w(this.options.enable,[this,t]))return this.reset(),void(this.state=De);56&this.state&&(this.state=1),this.state=this.process(t),30&this.state&&this.tryEmit(t)},process:function(e){},getTouchAction:function(){},reset:function(){}},_(Ne,Le,{defaults:{pointers:1},attrTest:function(e){var t=this.options.pointers;return 0===t||e.pointers.length===t},process:function(e){var t=this.state,r=e.eventType,n=6&t,i=this.attrTest(e);return n&&(8&r||!i)?16|t:n||i?4&r?8|t:2&t?4|t:2:De}}),_(ke,Ne,{defaults:{event:"pan",threshold:10,pointers:1,direction:30},getTouchAction:function(){var e=this.options.direction,t=[];return 6&e&&t.push(Te),e&z&&t.push(Me),t},directionTest:function(e){var t=this.options,r=!0,n=e.distance,i=e.direction,o=e.deltaX,a=e.deltaY;return i&t.direction||(6&t.direction?(i=0===o?1:o<0?2:4,r=o!=this.pX,n=Math.abs(e.deltaX)):(i=0===a?1:a<0?8:16,r=a!=this.pY,n=Math.abs(e.deltaY))),e.direction=i,r&&n>t.threshold&&i&t.direction},attrTest:function(e){return Ne.prototype.attrTest.call(this,e)&&(2&this.state||!(2&this.state)&&this.directionTest(e))},emit:function(e){this.pX=e.deltaX,this.pY=e.deltaY;var t=Ie(e.direction);t&&(e.additionalEvent=this.options.event+t),this._super.emit.call(this,e)}}),_(Fe,Ne,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Se]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.scale-1)>this.options.threshold||2&this.state)},emit:function(e){if(1!==e.scale){var t=e.scale<1?"in":"out";e.additionalEvent=this.options.event+t}this._super.emit.call(this,e)}}),_(Ve,Le,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[we]},process:function(e){var t=this.options,r=e.pointers.length===t.pointers,n=e.distance<t.threshold,i=e.deltaTime>t.time;if(this._input=e,!n||!r||12&e.eventType&&!i)this.reset();else if(1&e.eventType)this.reset(),this._timer=p((function(){this.state=8,this.tryEmit()}),t.time,this);else if(4&e.eventType)return 8;return De},reset:function(){clearTimeout(this._timer)},emit:function(e){8===this.state&&(e&&4&e.eventType?this.manager.emit(this.options.event+"up",e):(this._input.timeStamp=f(),this.manager.emit(this.options.event,this._input)))}}),_(Ue,Ne,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Se]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.rotation)>this.options.threshold||2&this.state)}}),_(Be,Ne,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:30,pointers:1},getTouchAction:function(){return ke.prototype.getTouchAction.call(this)},attrTest:function(e){var t,r=this.options.direction;return 30&r?t=e.overallVelocity:6&r?t=e.overallVelocityX:r&z&&(t=e.overallVelocityY),this._super.attrTest.call(this,e)&&r&e.offsetDirection&&e.distance>this.options.threshold&&e.maxPointers==this.options.pointers&&d(t)>this.options.velocity&&4&e.eventType},emit:function(e){var t=Ie(e.offsetDirection);t&&this.manager.emit(this.options.event+t,e),this.manager.emit(this.options.event,e)}}),_(ze,Le,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[Ae]},process:function(e){var t=this.options,r=e.pointers.length===t.pointers,n=e.distance<t.threshold,i=e.deltaTime<t.time;if(this.reset(),1&e.eventType&&0===this.count)return this.failTimeout();if(n&&i&&r){if(4!=e.eventType)return this.failTimeout();var o=!this.pTime||e.timeStamp-this.pTime<t.interval,a=!this.pCenter||Z(this.pCenter,e.center)<t.posThreshold;if(this.pTime=e.timeStamp,this.pCenter=e.center,a&&o?this.count+=1:this.count=1,this._input=e,0===this.count%t.taps)return this.hasRequireFailures()?(this._timer=p((function(){this.state=8,this.tryEmit()}),t.interval,this),2):8}return De},failTimeout:function(){return this._timer=p((function(){this.state=De}),this.options.interval,this),De},reset:function(){clearTimeout(this._timer)},emit:function(){8==this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),Ge.VERSION="2.0.8",Ge.defaults={domEvents:!1,touchAction:Ee,enable:!0,handlePointerEventMouse:!0,inputTarget:null,inputClass:null,preset:[[Ue,{enable:!1}],[Fe,{enable:!1},["rotate"]],[Be,{direction:6}],[ke,{direction:6},["swipe"]],[ze],[ze,{event:"doubletap",taps:2},["tap"]],[Ve]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};function He(e,t){var r;this.options=y({},Ge.defaults,t||{}),this.options.inputTarget=this.options.inputTarget||e,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=e,this.input=new((r=this).options.inputClass||(F?ae:V?pe:k?ge:te))(r,j),this.touchAction=new Pe(this,this.options.touchAction),We(this,!0),g(this.options.recognizers,(function(e){var t=this.add(new e[0](e[1]));e[2]&&t.recognizeWith(e[2]),e[3]&&t.requireFailure(e[3])}),this)}function We(e,t){var r,n=e.element;n.style&&(g(e.options.cssProps,(function(i,o){r=I(n.style,o),t?(e.oldCssProps[r]=n.style[r],n.style[r]=i):n.style[r]=e.oldCssProps[r]||""})),t||(e.oldCssProps={}))}He.prototype={set:function(e){return y(this.options,e),e.touchAction&&this.touchAction.update(),e.inputTarget&&(this.input.destroy(),this.input.target=e.inputTarget,this.input.init()),this},stop:function(e){this.session.stopped=e?2:1},recognize:function(e){var t=this.session;if(!t.stopped){var r;this.touchAction.preventDefaults(e);var n=this.recognizers,i=t.curRecognizer;(!i||i&&8&i.state)&&(i=t.curRecognizer=null);for(var o=0;o<n.length;)r=n[o],2===t.stopped||i&&r!=i&&!r.canRecognizeWith(i)?r.reset():r.recognize(e),!i&&14&r.state&&(i=t.curRecognizer=r),o++}},get:function(e){if(e instanceof Le)return e;for(var t=this.recognizers,r=0;r<t.length;r++)if(t[r].options.event==e)return t[r];return null},add:function(e){if(m(e,"add",this))return this;var t=this.get(e.options.event);return t&&this.remove(t),this.recognizers.push(e),e.manager=this,this.touchAction.update(),e},remove:function(e){if(m(e,"remove",this))return this;if(e=this.get(e)){var t=this.recognizers,r=D(t,e);-1!==r&&(t.splice(r,1),this.touchAction.update())}return this},on:function(e,t){if(e!==l&&t!==l){var r=this.handlers;return g(P(e),(function(e){r[e]=r[e]||[],r[e].push(t)})),this}},off:function(e,t){if(e!==l){var r=this.handlers;return g(P(e),(function(e){t?r[e]&&r[e].splice(D(r[e],t),1):delete r[e]})),this}},emit:function(e,t){this.options.domEvents&&function(e,t){var r=a.createEvent("Event");r.initEvent(e,!0,!0),r.gesture=t,t.target.dispatchEvent(r)}(e,t);var r=this.handlers[e]&&this.handlers[e].slice();if(r&&r.length){t.type=e,t.preventDefault=function(){t.srcEvent.preventDefault()},t.stopPropagation=function(){t.srcEvent.stopPropagation()};for(var n=0;n<r.length;)r[n](t),n++}},destroy:function(){this.element&&We(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},y(Ge,{INPUT_START:1,INPUT_MOVE:2,INPUT_END:4,INPUT_CANCEL:8,STATE_POSSIBLE:1,STATE_BEGAN:2,STATE_CHANGED:4,STATE_ENDED:8,STATE_RECOGNIZED:8,STATE_CANCELLED:16,STATE_FAILED:De,DIRECTION_NONE:1,DIRECTION_LEFT:2,DIRECTION_RIGHT:4,DIRECTION_UP:8,DIRECTION_DOWN:16,DIRECTION_HORIZONTAL:6,DIRECTION_VERTICAL:z,DIRECTION_ALL:30,Manager:He,Input:W,TouchAction:Pe,TouchInput:pe,MouseInput:te,PointerEventInput:ae,TouchMouseInput:ge,SingleTouchInput:ce,Recognizer:Le,AttrRecognizer:Ne,Tap:ze,Pan:ke,Swipe:Be,Pinch:Fe,Rotate:Ue,Press:Ve,on:S,off:M,each:g,merge:x,extend:b,assign:y,inherit:_,bindFn:E,prefixed:I}),(void 0!==o?o:"undefined"!=typeof self?self:{}).Hammer=Ge,(n=function(){return Ge}.call(t,r,t,e))===l||(e.exports=n)}(window,document)},90050:(e,t,r)=>{"use strict";r.r(t),r.d(t,{DDSLoader:()=>i});var n=r(23909),i=function e(){this._parser=e.parse};i.prototype=Object.create(n.CompressedTextureLoader.prototype),i.prototype.constructor=i,i.parse=function(e,t){var r={mipmaps:[],width:0,height:0,format:null,mipmapCount:1};function i(e){return e.charCodeAt(0)+(e.charCodeAt(1)<<8)+(e.charCodeAt(2)<<16)+(e.charCodeAt(3)<<24)}function o(e,t,r,n){for(var i=r*n*4,o=new Uint8Array(e,t,i),a=new Uint8Array(i),s=0,l=0,u=0;u<n;u++)for(var c=0;c<r;c++){var h=o[l],d=o[++l],f=o[++l],p=o[++l];l++,a[s]=f,a[++s]=d,a[++s]=h,a[++s]=p,s++}return a}var a=i("DXT1"),s=i("DXT3"),l=i("DXT5");if(e.byteLength<124)return console.error("THREE.DDSLoader.parse: File is empty or incomplete."),r;var u,c=new Int32Array(e,0,31);if(542327876!==c[0])return console.error("THREE.DDSLoader.parse: Invalid magic number in DDS header."),r;if(4&!c[20])return console.error("THREE.DDSLoader.parse: Unsupported format, must contain a FourCC code."),r;var h,d=c[21],f=!1;switch(d){case a:u=8,r.format=n.RGB_S3TC_DXT1_Format;break;case s:u=16,r.format=n.RGBA_S3TC_DXT3_Format;break;case l:u=16,r.format=n.RGBA_S3TC_DXT5_Format;break;default:if(!(32==c[22]&&16711680&c[23]&&65280&c[24]&&255&c[25]&&4278190080&c[26]))return console.error("THREE.DDSLoader.parse: Unsupported FourCC code ",(h=d,String.fromCharCode(255&h,h>>8&255,h>>16&255,h>>24&255))),r;f=!0,u=64,r.format=n.RGBAFormat}r.mipmapCount=1,c[7]>0&&!1!==t&&(r.mipmapCount=Math.max(1,c[7])),r.isCubemap=!!(512&c[28]),r.width=c[4],r.height=c[3];for(var p=c[1]+4,m=r.width,g=r.height,v=r.isCubemap?6:1,y=0;y<v;y++){for(var b=0;b<r.mipmapCount;b++){if(f)var x=(_=o(e,p,m,g)).length;else{x=Math.max(4,m)/4*Math.max(4,g)/4*u;var _=new Uint8Array(e,p,x)}var E={data:_,width:m,height:g};r.mipmaps.push(E),p+=x,m=Math.max(.5*m,1),g=Math.max(.5*g,1)}m=r.width,g=r.height}return r}},85212:(e,t,r)=>{"use strict";
/*!
MIT License

Copyright (c) 2019 Fyrestar

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.
*/
function n(e,t){for(var r in t){var n=t[r];if("@"===r[0]){var i=r.substr(1);e=e.replace(i,n)}else if("?"===r[0]){var o=r.substr(1);e=e.replace(o,n+"\n"+o)}else e=e.replace(r,r+"\n"+n)}return e}function i(e,t){var r=(t.header||"")+"\n",i=(t.vertexHeader||"")+"\n"+e.vertexShader,o=(t.fragmentHeader||"")+"\n"+e.fragmentShader;return t.vertexEnd&&(i=i.replace(/\}(?=[^\}]*$)/g,t.vertexEnd+"\n}")),t.fragmentEnd&&(o=o.replace(/\}(?=[^\}]*$)/g,t.fragmentEnd+"\n}")),void 0!==t.vertex&&(i=n(i,t.vertex)),void 0!==t.fragment&&(o=n(o,t.fragment)),e.vertexShader=r+i,e.fragmentShader=r+o,e}r.r(t),r.d(t,{patchShader:()=>i})},32895:(e,t,r)=>{"use strict";function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}r.r(t),r.d(t,{polyfillTHREE:()=>be});var i=function(e,t,r){"object"!==n(e)&&"function"!=typeof e||Object.prototype.hasOwnProperty.call(e,t)||(e[t]=r)},o=function(e,t,r){"object"===n(e)&&Object.defineProperty(e,t,r)};function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){return u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},u(e,t)}function c(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=f(e);if(t){var i=f(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return h(this,r)}}function h(e,t){if(t&&("object"===a(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return d(e)}function d(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function f(e){return f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},f(e)}var p=function(e){var t=parseInt(e.REVISION)>=72;i(e,"BoxBufferGeometry",function(r){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u(e,t)}(h,r);var n,i,o,a=c(h);function h(){var r,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1;l(this,h),(r=a.call(this)).type="BoxGeometry",r.parameters={width:n,height:i,depth:o,widthSegments:s,heightSegments:u,depthSegments:c};var f=d(r);s=Math.floor(s),u=Math.floor(u),c=Math.floor(c);var p=[],m=[],g=[],v=[],y=0,b=0;function x(r,n,i,o,a,s,l,u,c,h,d){for(var x=s/c,_=l/h,E=s/2,w=l/2,A=u/2,S=c+1,M=h+1,T=0,C=0,P=new e.Vector3,D=0;D<M;D++)for(var L=D*_-w,R=0;R<S;R++){var I=R*x-E;P[r]=I*o,P[n]=L*a,P[i]=A,m.push(P.x,P.y,P.z),P[r]=0,P[n]=0,P[i]=u>0?1:-1,g.push(P.x,P.y,P.z),v.push(R/c),v.push(1-D/h),T+=1}for(var O=0;O<h;O++)for(var N=0;N<c;N++){var k=y+N+S*O,F=y+N+S*(O+1),V=y+(N+1)+S*(O+1),U=y+(N+1)+S*O;p.push(k,F,U),p.push(F,V,U),C+=6}t||(d=0),f.addGroup(b,C,d),b+=C,y+=T}return x("z","y","x",-1,-1,o,i,n,c,u,0),x("z","y","x",1,-1,o,i,-n,c,u,1),x("x","z","y",1,1,n,o,i,s,c,2),x("x","z","y",1,-1,n,o,-i,s,c,3),x("x","y","z",1,-1,n,i,o,s,u,4),x("x","y","z",-1,-1,n,i,-o,s,u,5),r.setIndex(p),r.setAttribute("position",new e.Float32BufferAttribute(m,3)),r.setAttribute("normal",new e.Float32BufferAttribute(g,3)),r.setAttribute("uv",new e.Float32BufferAttribute(v,2)),r}return n=h,i&&s(n.prototype,i),o&&s(n,o),Object.defineProperty(n,"prototype",{writable:!1}),n}(e.BufferGeometry))};function m(e){return m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},m(e)}function g(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function v(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function y(e,t){return y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},y(e,t)}function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=_(e);if(t){var i=_(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return x(this,r)}}function x(e,t){if(t&&("object"===m(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function _(e){return _=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},_(e)}var E=function(e){i(e,"CircleBufferGeometry",function(t){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&y(e,t)}(a,t);var r,n,i,o=b(a);function a(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2*Math.PI;v(this,a),(t=o.call(this)).type="CircleGeometry",t.parameters={radius:r,segments:n,thetaStart:i,thetaLength:s},n=Math.max(3,n);var l=[],u=[],c=[],h=[],d=new e.Vector3,f=new e.Vector2;u.push(0,0,0),c.push(0,0,1),h.push(.5,.5);for(var p=0,m=3;p<=n;p++,m+=3){var g=i+p/n*s;d.x=r*Math.cos(g),d.y=r*Math.sin(g),u.push(d.x,d.y,d.z),c.push(0,0,1),f.x=(u[m]/r+1)/2,f.y=(u[m+1]/r+1)/2,h.push(f.x,f.y)}for(var y=1;y<=n;y++)l.push(y,y+1,0);return t.setIndex(l),t.setAttribute("position",new e.Float32BufferAttribute(u,3)),t.setAttribute("normal",new e.Float32BufferAttribute(c,3)),t.setAttribute("uv",new e.Float32BufferAttribute(h,2)),t}return r=a,n&&g(r.prototype,n),i&&g(r,i),Object.defineProperty(r,"prototype",{writable:!1}),r}(e.BufferGeometry))};function w(e){return w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},w(e)}function A(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function S(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function M(e,t){return M=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},M(e,t)}function T(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=D(e);if(t){var i=D(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return C(this,r)}}function C(e,t){if(t&&("object"===w(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return P(e)}function P(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function D(e){return D=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},D(e)}var L=function(e){var t=parseInt(e.REVISION)>=72;i(e,"CylinderBufferGeometry",function(r){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&M(e,t)}(s,r);var n,i,o,a=T(s);function s(){var r,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:8,u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,c=arguments.length>5&&void 0!==arguments[5]&&arguments[5],h=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,d=arguments.length>7&&void 0!==arguments[7]?arguments[7]:2*Math.PI;S(this,s),(r=a.call(this)).type="CylinderGeometry",r.parameters={radiusTop:n,radiusBottom:i,height:o,radialSegments:l,heightSegments:u,openEnded:c,thetaStart:h,thetaLength:d};var f=P(r);l=Math.floor(l),u=Math.floor(u);var p=[],m=[],g=[],v=[],y=0,b=[],x=o/2,_=0;function E(){for(var t=new e.Vector3,r=new e.Vector3,a=0,s=(i-n)/o,c=0;c<=u;c++){for(var E=[],w=c/u,A=w*(i-n)+n,S=0;S<=l;S++){var M=S/l,T=M*d+h,C=Math.sin(T),P=Math.cos(T);r.x=A*C,r.y=-w*o+x,r.z=A*P,m.push(r.x,r.y,r.z),t.set(C,s,P).normalize(),g.push(t.x,t.y,t.z),v.push(M,1-w),E.push(y++)}b.push(E)}for(var D=0;D<l;D++)for(var L=0;L<u;L++){var R=b[L][D],I=b[L+1][D],O=b[L+1][D+1],N=b[L][D+1];p.push(R,I,N),p.push(I,O,N),a+=6}f.addGroup(_,a,0),_+=a}function w(r){for(var o=y,a=new e.Vector2,s=new e.Vector3,u=0,c=!0===r?n:i,b=!0===r?1:-1,E=1;E<=l;E++)m.push(0,x*b,0),g.push(0,b,0),v.push(.5,.5),y++;for(var w=y,A=0;A<=l;A++){var S=A/l*d+h,M=Math.cos(S),T=Math.sin(S);s.x=c*T,s.y=x*b,s.z=c*M,m.push(s.x,s.y,s.z),g.push(0,b,0),a.x=.5*M+.5,a.y=.5*T*b+.5,v.push(a.x,a.y),y++}for(var C=0;C<l;C++){var P=o+C,D=w+C;!0===r?p.push(D,D+1,P):p.push(D+1,D,P),u+=3}var L=t?!0===r?1:2:0;f.addGroup(_,u,L),_+=u}return E(),!1===c&&(n>0&&w(!0),i>0&&w(!1)),r.setIndex(p),r.setAttribute("position",new e.Float32BufferAttribute(m,3)),r.setAttribute("normal",new e.Float32BufferAttribute(g,3)),r.setAttribute("uv",new e.Float32BufferAttribute(v,2)),r}return n=s,i&&A(n.prototype,i),o&&A(n,o),Object.defineProperty(n,"prototype",{writable:!1}),n}(e.BufferGeometry))};function R(e){return R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},R(e)}function I(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function O(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function N(e,t){return N=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},N(e,t)}function k(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=V(e);if(t){var i=V(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return F(this,r)}}function F(e,t){if(t&&("object"===R(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function V(e){return V=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},V(e)}var U=function(e){i(e,"PolyhedronBufferGeometry",function(t){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&N(e,t)}(a,t);var r,n,i,o=k(a);function a(t,r){var n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;O(this,a),(n=o.call(this)).type="PolyhedronGeometry",n.parameters={vertices:t,indices:r,radius:i,detail:s};var l=[],u=[];function c(t){for(var n=new e.Vector3,i=new e.Vector3,o=new e.Vector3,a=0;a<r.length;a+=3)g(r[a+0],n),g(r[a+1],i),g(r[a+2],o),h(n,i,o,t)}function h(e,t,r,n){for(var i=n+1,o=[],a=0;a<=i;a++){o[a]=[];for(var s=e.clone().lerp(r,a/i),l=t.clone().lerp(r,a/i),u=i-a,c=0;c<=u;c++)o[a][c]=0===c&&a===i?s:s.clone().lerp(l,c/u)}for(var h=0;h<i;h++)for(var d=0;d<2*(i-h)-1;d++){var f=Math.floor(d/2);d%2==0?(m(o[h][f+1]),m(o[h+1][f]),m(o[h][f])):(m(o[h][f+1]),m(o[h+1][f+1]),m(o[h+1][f]))}}function d(t){for(var r=new e.Vector3,n=0;n<l.length;n+=3)r.x=l[n+0],r.y=l[n+1],r.z=l[n+2],r.normalize().multiplyScalar(t),l[n+0]=r.x,l[n+1]=r.y,l[n+2]=r.z}function f(){for(var t=new e.Vector3,r=0;r<l.length;r+=3){t.x=l[r+0],t.y=l[r+1],t.z=l[r+2];var n=b(t)/2/Math.PI+.5,i=x(t)/Math.PI+.5;u.push(n,1-i)}v(),p()}function p(){for(var e=0;e<u.length;e+=6){var t=u[e+0],r=u[e+2],n=u[e+4],i=Math.max(t,r,n),o=Math.min(t,r,n);i>.9&&o<.1&&(t<.2&&(u[e+0]+=1),r<.2&&(u[e+2]+=1),n<.2&&(u[e+4]+=1))}}function m(e){l.push(e.x,e.y,e.z)}function g(e,r){var n=3*e;r.x=t[n+0],r.y=t[n+1],r.z=t[n+2]}function v(){for(var t=new e.Vector3,r=new e.Vector3,n=new e.Vector3,i=new e.Vector3,o=new e.Vector2,a=new e.Vector2,s=new e.Vector2,c=0,h=0;c<l.length;c+=9,h+=6){t.set(l[c+0],l[c+1],l[c+2]),r.set(l[c+3],l[c+4],l[c+5]),n.set(l[c+6],l[c+7],l[c+8]),o.set(u[h+0],u[h+1]),a.set(u[h+2],u[h+3]),s.set(u[h+4],u[h+5]),i.copy(t).add(r).add(n).divideScalar(3);var d=b(i);y(o,h+0,t,d),y(a,h+2,r,d),y(s,h+4,n,d)}}function y(e,t,r,n){n<0&&1===e.x&&(u[t]=e.x-1),0===r.x&&0===r.z&&(u[t]=n/2/Math.PI+.5)}function b(e){return Math.atan2(e.z,-e.x)}function x(e){return Math.atan2(-e.y,Math.sqrt(e.x*e.x+e.z*e.z))}return c(s),d(i),f(),n.setAttribute("position",new e.Float32BufferAttribute(l,3)),n.setAttribute("normal",new e.Float32BufferAttribute(l.slice(),3)),n.setAttribute("uv",new e.Float32BufferAttribute(u,2)),0===s?n.computeVertexNormals():n.normalizeNormals(),n}return r=a,n&&I(r.prototype,n),i&&I(r,i),Object.defineProperty(r,"prototype",{writable:!1}),r}(e.BufferGeometry))};function B(e){return B="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},B(e)}function z(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function G(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function H(e,t){return H=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},H(e,t)}function W(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=q(e);if(t){var i=q(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return j(this,r)}}function j(e,t){if(t&&("object"===B(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function q(e){return q=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},q(e)}var X=function(e){i(e,"OctahedronBufferGeometry",function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&H(e,t)}(o,e);var t,r,n,i=W(o);function o(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;G(this,o);var n=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],a=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];return(e=i.call(this,n,a,t,r)).type="OctahedronGeometry",e.parameters={radius:t,detail:r},e}return t=o,r&&z(t.prototype,r),n&&z(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(e.PolyhedronBufferGeometry))};function Y(e){return Y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Y(e)}function K(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Z(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Q(e,t){return Q=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Q(e,t)}function J(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=ee(e);if(t){var i=ee(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return $(this,r)}}function $(e,t){if(t&&("object"===Y(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function ee(e){return ee=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},ee(e)}var te=function(e){i(e,"SphereBufferGeometry",function(t){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Q(e,t)}(a,t);var r,n,i,o=J(a);function a(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:6,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2*Math.PI,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:Math.PI;Z(this,a),(t=o.call(this)).type="SphereGeometry",t.parameters={radius:r,widthSegments:n,heightSegments:i,phiStart:s,phiLength:l,thetaStart:u,thetaLength:c},n=Math.max(3,Math.floor(n)),i=Math.max(2,Math.floor(i));for(var h=Math.min(u+c,Math.PI),d=0,f=[],p=new e.Vector3,m=new e.Vector3,g=[],v=[],y=[],b=[],x=0;x<=i;x++){var _=[],E=x/i,w=0;0==x&&0==u?w=.5/n:x==i&&h==Math.PI&&(w=-.5/n);for(var A=0;A<=n;A++){var S=A/n;p.x=-r*Math.cos(s+S*l)*Math.sin(u+E*c),p.y=r*Math.cos(u+E*c),p.z=r*Math.sin(s+S*l)*Math.sin(u+E*c),v.push(p.x,p.y,p.z),m.copy(p).normalize(),y.push(m.x,m.y,m.z),b.push(S+w,1-E),_.push(d++)}f.push(_)}for(var M=0;M<i;M++)for(var T=0;T<n;T++){var C=f[M][T+1],P=f[M][T],D=f[M+1][T],L=f[M+1][T+1];(0!==M||u>0)&&g.push(C,P,L),(M!==i-1||h<Math.PI)&&g.push(P,D,L)}return t.setIndex(g),t.setAttribute("position",new e.Float32BufferAttribute(v,3)),t.setAttribute("normal",new e.Float32BufferAttribute(y,3)),t.setAttribute("uv",new e.Float32BufferAttribute(b,2)),t}return r=a,n&&K(r.prototype,n),i&&K(r,i),Object.defineProperty(r,"prototype",{writable:!1}),r}(e.BufferGeometry))};function re(e){return re="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},re(e)}function ne(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ie(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function oe(e,t){return oe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},oe(e,t)}function ae(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=le(e);if(t){var i=le(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return se(this,r)}}function se(e,t){if(t&&("object"===re(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function le(e){return le=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},le(e)}var ue=function(e){i(e,"TorusBufferGeometry",function(t){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&oe(e,t)}(a,t);var r,n,i,o=ae(a);function a(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.4,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:8,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:6,l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2*Math.PI;ie(this,a),(t=o.call(this)).type="TorusGeometry",t.parameters={radius:r,tube:n,radialSegments:i,tubularSegments:s,arc:l},i=Math.floor(i),s=Math.floor(s);for(var u=[],c=[],h=[],d=[],f=new e.Vector3,p=new e.Vector3,m=new e.Vector3,g=0;g<=i;g++)for(var v=0;v<=s;v++){var y=v/s*l,b=g/i*Math.PI*2;p.x=(r+n*Math.cos(b))*Math.cos(y),p.y=(r+n*Math.cos(b))*Math.sin(y),p.z=n*Math.sin(b),c.push(p.x,p.y,p.z),f.x=r*Math.cos(y),f.y=r*Math.sin(y),m.subVectors(p,f).normalize(),h.push(m.x,m.y,m.z),d.push(v/s),d.push(g/i)}for(var x=1;x<=i;x++)for(var _=1;_<=s;_++){var E=(s+1)*x+_-1,w=(s+1)*(x-1)+_-1,A=(s+1)*(x-1)+_,S=(s+1)*x+_;u.push(E,w,S),u.push(w,A,S)}return t.setIndex(u),t.setAttribute("position",new e.Float32BufferAttribute(c,3)),t.setAttribute("normal",new e.Float32BufferAttribute(h,3)),t.setAttribute("uv",new e.Float32BufferAttribute(d,2)),t}return r=a,n&&ne(r.prototype,n),i&&ne(r,i),Object.defineProperty(r,"prototype",{writable:!1}),r}(e.BufferGeometry))};function ce(e){return ce="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ce(e)}function he(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function de(e,t,r){return t&&he(e.prototype,t),r&&he(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function fe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pe(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&me(e,t)}function me(e,t){return me=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},me(e,t)}function ge(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=ye(e);if(t){var i=ye(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return ve(this,r)}}function ve(e,t){if(t&&("object"===ce(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function ye(e){return ye=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},ye(e)}var be=function(e){var t,r,n,a,s,l,u,c,h,d,f,m,g,v,y,b,x,_,w,A,S,M,T,C,P,D,R,I,O,N=new e.Vector3;i(null==e||null===(t=e.Camera)||void 0===t?void 0:t.prototype,"updateMatrixWorld",(function(t){e.Object3D.prototype.updateMatrixWorld.call(this,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()})),i(null==e||null===(r=e.Box2)||void 0===r?void 0:r.prototype,"getSize",(function(e){return this.isEmpty()?e.set(0,0):this.size(e)})),i(null==e||null===(n=e.Box3)||void 0===n?void 0:n.prototype,"getSize",(function(e){return this.isEmpty()?e.set(0,0,0):this.size(e)})),i(null==e||null===(a=e.Box2)||void 0===a?void 0:a.prototype,"intersectsBox",(function(e){return this.isIntersectionBox(e)})),i(null==e||null===(s=e.Box3)||void 0===s?void 0:s.prototype,"intersectsBox",(function(e){return this.isIntersectionBox(e)})),i(null==e||null===(l=e.Ray)||void 0===l?void 0:l.prototype,"intersectsBox",(function(e){return this.isIntersectionBox(e)})),i(null==e||null===(u=e.BufferAttribute)||void 0===u?void 0:u.prototype,"applyMatrix4",(function(e){for(var t=0,r=this.count;t<r;t++)N.x=this.getX(t),N.y=this.getY(t),N.z=this.getZ(t),N.applyMatrix4(e),this.setXYZ(t,N.x,N.y,N.z);return this})),i(null==e||null===(c=e.BufferAttribute)||void 0===c?void 0:c.prototype,"getX",(function(e){return this.array[e*this.itemSize]})),i(null==e||null===(h=e.BufferAttribute)||void 0===h?void 0:h.prototype,"getY",(function(e){return this.array[e*this.itemSize+1]})),i(null==e||null===(d=e.BufferAttribute)||void 0===d?void 0:d.prototype,"getZ",(function(e){return this.array[e*this.itemSize+2]})),"function"==typeof(null==e?void 0:e.BufferAttribute)&&(i(e,"Float32BufferAttribute",function(e){pe(r,e);var t=ge(r);function r(e,n,i){return fe(this,r),t.call(this,new Float32Array(e),n,i)}return de(r)}(e.BufferAttribute)),i(e,"Uint16BufferAttribute",function(e){pe(r,e);var t=ge(r);function r(e,n,i){return fe(this,r),t.call(this,new Uint16Array(e),n,i)}return de(r)}(e.BufferAttribute)),i(e,"Uint32BufferAttribute",function(e){pe(r,e);var t=ge(r);function r(e,n,i){return fe(this,r),t.call(this,new Uint32Array(e),n,i)}return de(r)}(e.BufferAttribute))),i(null==e||null===(f=e.BufferGeometry)||void 0===f?void 0:f.prototype,"applyMatrix4",(function(e){return this.applyMatrix(e),this})),o(null==e||null===(m=e.BufferGeometry)||void 0===m?void 0:m.prototype,"groups",{get:function(){return this.offsets},set:function(e){this.offsets=e,this.drawcalls=e}}),i(null==e||null===(g=e.BufferGeometry)||void 0===g?void 0:g.prototype,"addGroup",(function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return void 0!==r&&0!==r&&console.warn("THREE.BufferGeometry: .addGroup() with `materialIndex !== 0` is not supported in this Three.js version. Ignoring the `materialIndex` parameter."),this.addDrawCall(e,t)})),o(null==e||null===(v=e.BufferGeometry)||void 0===v?void 0:v.prototype,"index",{get:function(){return this.attributes.index},set:function(e){this.attributes.index=e}}),i(null==e||null===(y=e.BufferGeometry)||void 0===y?void 0:y.prototype,"setFromPoints",(function(t){for(var r=[],n=0,i=t.length;n<i;n++){var o=t[n];r.push(o.x,o.y,o.z||0)}return this.setAttribute("position",new e.Float32BufferAttribute(r,3)),this})),i(null==e||null===(b=e.BufferGeometry)||void 0===b?void 0:b.prototype,"setIndex",(function(t){return Array.isArray(t)?this.index=new(function(e){if(0===e.length)return-1/0;for(var t=e[0],r=1,n=e.length;r<n;++r)e[r]>t&&(t=e[r]);return t}(t)>65535?e.Uint32BufferAttribute:e.Uint16BufferAttribute)(t,1):this.index=t,this})),"function"==typeof(null==e?void 0:e.BufferGeometry)&&(p(e),E(e),L(e),U(e),X(e),te(e),ue(e)),i(null==e||null===(x=e.Frustum)||void 0===x?void 0:x.prototype,"setFromProjectionMatrix",(function(e){return this.setFromMatrix(e)})),i(null==e||null===(_=e.Geometry)||void 0===_?void 0:_.prototype,"applyMatrix4",(function(e){return this.applyMatrix(e),this})),i(e,"Interpolant",(function(){})),i(null==e||null===(w=e.Line)||void 0===w?void 0:w.prototype,"computeLineDistances",(function(){var e=this.geometry;if(e.isBufferGeometry)if(null===e.index){for(var t=e.attributes.position,r=[0],n=1,i=t.count;n<i;n++)_start.fromBufferAttribute(t,n-1),_end.fromBufferAttribute(t,n),r[n]=r[n-1],r[n]+=_start.distanceTo(_end);e.setAttribute("lineDistance",new Float32BufferAttribute(r,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else e.isGeometry&&console.error("THREE.Line.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this})),i(null==e||null===(A=e.Matrix3)||void 0===A?void 0:A.prototype,"invert",(function(){var e=this.elements,t=e[0],r=e[1],n=e[2],i=e[3],o=e[4],a=e[5],s=e[6],l=e[7],u=e[8],c=u*o-a*l,h=a*s-u*i,d=l*i-o*s,f=t*c+r*h+n*d;if(0===f)return this.set(0,0,0,0,0,0,0,0,0);var p=1/f;return e[0]=c*p,e[1]=(n*l-u*r)*p,e[2]=(a*r-n*o)*p,e[3]=h*p,e[4]=(u*t-n*s)*p,e[5]=(n*i-a*t)*p,e[6]=d*p,e[7]=(r*s-l*t)*p,e[8]=(o*t-r*i)*p,this})),i(null==e||null===(S=e.Matrix4)||void 0===S?void 0:S.prototype,"invert",(function(){var e=this.elements,t=e[0],r=e[1],n=e[2],i=e[3],o=e[4],a=e[5],s=e[6],l=e[7],u=e[8],c=e[9],h=e[10],d=e[11],f=e[12],p=e[13],m=e[14],g=e[15],v=c*m*l-p*h*l+p*s*d-a*m*d-c*s*g+a*h*g,y=f*h*l-u*m*l-f*s*d+o*m*d+u*s*g-o*h*g,b=u*p*l-f*c*l+f*a*d-o*p*d-u*a*g+o*c*g,x=f*c*s-u*p*s-f*a*h+o*p*h+u*a*m-o*c*m,_=t*v+r*y+n*b+i*x;if(0===_)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);var E=1/_;return e[0]=v*E,e[1]=(p*h*i-c*m*i-p*n*d+r*m*d+c*n*g-r*h*g)*E,e[2]=(a*m*i-p*s*i+p*n*l-r*m*l-a*n*g+r*s*g)*E,e[3]=(c*s*i-a*h*i-c*n*l+r*h*l+a*n*d-r*s*d)*E,e[4]=y*E,e[5]=(u*m*i-f*h*i+f*n*d-t*m*d-u*n*g+t*h*g)*E,e[6]=(f*s*i-o*m*i-f*n*l+t*m*l+o*n*g-t*s*g)*E,e[7]=(o*h*i-u*s*i+u*n*l-t*h*l-o*n*d+t*s*d)*E,e[8]=b*E,e[9]=(f*c*i-u*p*i-f*r*d+t*p*d+u*r*g-t*c*g)*E,e[10]=(o*p*i-f*a*i+f*r*l-t*p*l-o*r*g+t*a*g)*E,e[11]=(u*a*i-o*c*i-u*r*l+t*c*l+o*r*d-t*a*d)*E,e[12]=x*E,e[13]=(u*p*n-f*c*n+f*r*h-t*p*h-u*r*m+t*c*m)*E,e[14]=(f*a*n-o*p*n-f*r*s+t*p*s+o*r*m-t*a*m)*E,e[15]=(o*c*n-u*a*n+u*r*s-t*c*s-o*r*h+t*a*h)*E,this})),o(null==e||null===(M=e.MeshPhongMaterial)||void 0===M?void 0:M.prototype,"flatShading",{get:function(){return this.shading===e.FlatShading},set:function(t){this.shading=!0===t?e.FlatShading:e.SmoothShading}}),i(e,"MeshStandardMaterial",e.MeshBasicMaterial),i(null==e||null===(T=e.Object3D)||void 0===T?void 0:T.prototype,"applyMatrix4",(function(e){return this.applyMatrix(e)})),i(e,"PointsMaterial",e.PointCloudMaterial),i(null==e||null===(C=e.Quaternion)||void 0===C?void 0:C.prototype,"invert",(function(){return this.inverse()})),i(null==e?void 0:e.Triangle,"getNormal",(function(e,t,r,n){return this.normal(e,t,r,n)})),i(null==e||null===(P=e.Vector2)||void 0===P?void 0:P.prototype,"fromBufferAttribute",(function(e,t,r){return this.fromAttribute(e,t,r)})),i(null==e||null===(D=e.Vector3)||void 0===D?void 0:D.prototype,"fromBufferAttribute",(function(e,t,r){return this.fromAttribute(e,t,r)})),i(null==e||null===(R=e.Vector4)||void 0===R?void 0:R.prototype,"fromBufferAttribute",(function(e,t,r){return this.fromAttribute(e,t,r)})),o(null==e||null===(I=e.WebGLRenderTarget)||void 0===I?void 0:I.prototype,"texture",{get:function(){return this}}),i(null==e||null===(O=e.Material)||void 0===O?void 0:O.prototype,"onBeforeCompile",(function(){}))}},94370:(e,t,r)=>{"use strict";r.d(t,{r:()=>n});var n=function(e,t){return e.applyProjection(t)}},23909:(e,t,r)=>{var n,i,o,a,s,l,u,c,h,d,f,p,m,g,v,y,b,x,_,E,w,A,S,M,T,C,P,D,L,R,I,O,N,k,F,V,U,B,z,G,H,W,j,q,X,Y,K=e.exports={REVISION:"71"};void 0===Math.sign&&(Math.sign=function(e){return e<0?-1:e>0?1:+e}),K.log=function(){console.log.apply(console,arguments)},K.warn=function(){console.warn.apply(console,arguments)},K.error=function(){console.error.apply(console,arguments)},K.MOUSE={LEFT:0,MIDDLE:1,RIGHT:2},K.CullFaceNone=0,K.CullFaceBack=1,K.CullFaceFront=2,K.CullFaceFrontBack=3,K.FrontFaceDirectionCW=0,K.FrontFaceDirectionCCW=1,K.BasicShadowMap=0,K.PCFShadowMap=1,K.PCFSoftShadowMap=2,K.FrontSide=0,K.BackSide=1,K.DoubleSide=2,K.NoShading=0,K.FlatShading=1,K.SmoothShading=2,K.NoColors=0,K.FaceColors=1,K.VertexColors=2,K.NoBlending=0,K.NormalBlending=1,K.AdditiveBlending=2,K.SubtractiveBlending=3,K.MultiplyBlending=4,K.CustomBlending=5,K.AddEquation=100,K.SubtractEquation=101,K.ReverseSubtractEquation=102,K.MinEquation=103,K.MaxEquation=104,K.ZeroFactor=200,K.OneFactor=201,K.SrcColorFactor=202,K.OneMinusSrcColorFactor=203,K.SrcAlphaFactor=204,K.OneMinusSrcAlphaFactor=205,K.DstAlphaFactor=206,K.OneMinusDstAlphaFactor=207,K.DstColorFactor=208,K.OneMinusDstColorFactor=209,K.SrcAlphaSaturateFactor=210,K.MultiplyOperation=0,K.MixOperation=1,K.AddOperation=2,K.UVMapping=300,K.CubeReflectionMapping=301,K.CubeRefractionMapping=302,K.EquirectangularReflectionMapping=303,K.EquirectangularRefractionMapping=304,K.SphericalReflectionMapping=305,K.RepeatWrapping=1e3,K.ClampToEdgeWrapping=1001,K.MirroredRepeatWrapping=1002,K.NearestFilter=1003,K.NearestMipMapNearestFilter=1004,K.NearestMipMapLinearFilter=1005,K.LinearFilter=1006,K.LinearMipMapNearestFilter=1007,K.LinearMipMapLinearFilter=1008,K.UnsignedByteType=1009,K.ByteType=1010,K.ShortType=1011,K.UnsignedShortType=1012,K.IntType=1013,K.UnsignedIntType=1014,K.FloatType=1015,K.HalfFloatType=1025,K.UnsignedShort4444Type=1016,K.UnsignedShort5551Type=1017,K.UnsignedShort565Type=1018,K.AlphaFormat=1019,K.RGBFormat=1020,K.RGBAFormat=1021,K.LuminanceFormat=1022,K.LuminanceAlphaFormat=1023,K.RGBEFormat=K.RGBAFormat,K.RGB_S3TC_DXT1_Format=2001,K.RGBA_S3TC_DXT1_Format=2002,K.RGBA_S3TC_DXT3_Format=2003,K.RGBA_S3TC_DXT5_Format=2004,K.RGB_PVRTC_4BPPV1_Format=2100,K.RGB_PVRTC_2BPPV1_Format=2101,K.RGBA_PVRTC_4BPPV1_Format=2102,K.RGBA_PVRTC_2BPPV1_Format=2103,K.Projector=function(){K.error("THREE.Projector has been moved to /examples/js/renderers/Projector.js."),this.projectVector=function(e,t){K.warn("THREE.Projector: .projectVector() is now vector.project()."),e.project(t)},this.unprojectVector=function(e,t){K.warn("THREE.Projector: .unprojectVector() is now vector.unproject()."),e.unproject(t)},this.pickingRay=function(e,t){K.error("THREE.Projector: .pickingRay() is now raycaster.setFromCamera().")}},K.CanvasRenderer=function(){K.error("THREE.CanvasRenderer has been moved to /examples/js/renderers/CanvasRenderer.js"),this.domElement=document.createElement("canvas"),this.clear=function(){},this.render=function(){},this.setClearColor=function(){},this.setSize=function(){}},K.Color=function(e){return 3===arguments.length?this.setRGB(arguments[0],arguments[1],arguments[2]):this.set(e)},K.Color.prototype={constructor:K.Color,r:1,g:1,b:1,set:function(e){return e instanceof K.Color?this.copy(e):"number"==typeof e?this.setHex(e):"string"==typeof e&&this.setStyle(e),this},setHex:function(e){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,this},setRGB:function(e,t,r){return this.r=e,this.g=t,this.b=r,this},setHSL:function(e,t,r){if(0===t)this.r=this.g=this.b=r;else{var n=function(e,t,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?e+6*(t-e)*r:r<.5?t:r<2/3?e+6*(t-e)*(2/3-r):e},i=r<=.5?r*(1+t):r+t-r*t,o=2*r-i;this.r=n(o,i,e+1/3),this.g=n(o,i,e),this.b=n(o,i,e-1/3)}return this},setStyle:function(e){if(/^rgb\((\d+), ?(\d+), ?(\d+)\)$/i.test(e)){var t=/^rgb\((\d+), ?(\d+), ?(\d+)\)$/i.exec(e);return this.r=Math.min(255,parseInt(t[1],10))/255,this.g=Math.min(255,parseInt(t[2],10))/255,this.b=Math.min(255,parseInt(t[3],10))/255,this}if(/^rgb\((\d+)\%, ?(\d+)\%, ?(\d+)\%\)$/i.test(e)){t=/^rgb\((\d+)\%, ?(\d+)\%, ?(\d+)\%\)$/i.exec(e);return this.r=Math.min(100,parseInt(t[1],10))/100,this.g=Math.min(100,parseInt(t[2],10))/100,this.b=Math.min(100,parseInt(t[3],10))/100,this}if(/^\#([0-9a-f]{6})$/i.test(e)){t=/^\#([0-9a-f]{6})$/i.exec(e);return this.setHex(parseInt(t[1],16)),this}if(/^\#([0-9a-f])([0-9a-f])([0-9a-f])$/i.test(e)){t=/^\#([0-9a-f])([0-9a-f])([0-9a-f])$/i.exec(e);return this.setHex(parseInt(t[1]+t[1]+t[2]+t[2]+t[3]+t[3],16)),this}if(/^(\w+)$/i.test(e))return this.setHex(K.ColorKeywords[e]),this},copy:function(e){return this.r=e.r,this.g=e.g,this.b=e.b,this},copyGammaToLinear:function(e,t){return void 0===t&&(t=2),this.r=Math.pow(e.r,t),this.g=Math.pow(e.g,t),this.b=Math.pow(e.b,t),this},copyLinearToGamma:function(e,t){void 0===t&&(t=2);var r=t>0?1/t:1;return this.r=Math.pow(e.r,r),this.g=Math.pow(e.g,r),this.b=Math.pow(e.b,r),this},convertGammaToLinear:function(){var e=this.r,t=this.g,r=this.b;return this.r=e*e,this.g=t*t,this.b=r*r,this},convertLinearToGamma:function(){return this.r=Math.sqrt(this.r),this.g=Math.sqrt(this.g),this.b=Math.sqrt(this.b),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(e){var t,r,n=e||{h:0,s:0,l:0},i=this.r,o=this.g,a=this.b,s=Math.max(i,o,a),l=Math.min(i,o,a),u=(l+s)/2;if(l===s)t=0,r=0;else{var c=s-l;switch(r=u<=.5?c/(s+l):c/(2-s-l),s){case i:t=(o-a)/c+(o<a?6:0);break;case o:t=(a-i)/c+2;break;case a:t=(i-o)/c+4}t/=6}return n.h=t,n.s=r,n.l=u,n},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(e,t,r){var n=this.getHSL();return n.h+=e,n.s+=t,n.l+=r,this.setHSL(n.h,n.s,n.l),this},add:function(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this},addColors:function(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this},addScalar:function(e){return this.r+=e,this.g+=e,this.b+=e,this},multiply:function(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this},multiplyScalar:function(e){return this.r*=e,this.g*=e,this.b*=e,this},lerp:function(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this},equals:function(e){return e.r===this.r&&e.g===this.g&&e.b===this.b},fromArray:function(e){return this.r=e[0],this.g=e[1],this.b=e[2],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e},clone:function(){return(new K.Color).setRGB(this.r,this.g,this.b)}},K.ColorKeywords={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},K.Quaternion=function(e,t,r,n){this._x=e||0,this._y=t||0,this._z=r||0,this._w=void 0!==n?n:1},K.Quaternion.prototype={constructor:K.Quaternion,_x:0,_y:0,_z:0,_w:0,get x(){return this._x},set x(e){this._x=e,this.onChangeCallback()},get y(){return this._y},set y(e){this._y=e,this.onChangeCallback()},get z(){return this._z},set z(e){this._z=e,this.onChangeCallback()},get w(){return this._w},set w(e){this._w=e,this.onChangeCallback()},set:function(e,t,r,n){return this._x=e,this._y=t,this._z=r,this._w=n,this.onChangeCallback(),this},copy:function(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this.onChangeCallback(),this},setFromEuler:function(e,t){if(e instanceof K.Euler==!1)throw new Error("THREE.Quaternion: .setFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var r=Math.cos(e._x/2),n=Math.cos(e._y/2),i=Math.cos(e._z/2),o=Math.sin(e._x/2),a=Math.sin(e._y/2),s=Math.sin(e._z/2);return"XYZ"===e.order?(this._x=o*n*i+r*a*s,this._y=r*a*i-o*n*s,this._z=r*n*s+o*a*i,this._w=r*n*i-o*a*s):"YXZ"===e.order?(this._x=o*n*i+r*a*s,this._y=r*a*i-o*n*s,this._z=r*n*s-o*a*i,this._w=r*n*i+o*a*s):"ZXY"===e.order?(this._x=o*n*i-r*a*s,this._y=r*a*i+o*n*s,this._z=r*n*s+o*a*i,this._w=r*n*i-o*a*s):"ZYX"===e.order?(this._x=o*n*i-r*a*s,this._y=r*a*i+o*n*s,this._z=r*n*s-o*a*i,this._w=r*n*i+o*a*s):"YZX"===e.order?(this._x=o*n*i+r*a*s,this._y=r*a*i+o*n*s,this._z=r*n*s-o*a*i,this._w=r*n*i-o*a*s):"XZY"===e.order&&(this._x=o*n*i-r*a*s,this._y=r*a*i-o*n*s,this._z=r*n*s+o*a*i,this._w=r*n*i+o*a*s),!1!==t&&this.onChangeCallback(),this},setFromAxisAngle:function(e,t){var r=t/2,n=Math.sin(r);return this._x=e.x*n,this._y=e.y*n,this._z=e.z*n,this._w=Math.cos(r),this.onChangeCallback(),this},setFromRotationMatrix:function(e){var t,r=e.elements,n=r[0],i=r[4],o=r[8],a=r[1],s=r[5],l=r[9],u=r[2],c=r[6],h=r[10],d=n+s+h;return d>0?(t=.5/Math.sqrt(d+1),this._w=.25/t,this._x=(c-l)*t,this._y=(o-u)*t,this._z=(a-i)*t):n>s&&n>h?(t=2*Math.sqrt(1+n-s-h),this._w=(c-l)/t,this._x=.25*t,this._y=(i+a)/t,this._z=(o+u)/t):s>h?(t=2*Math.sqrt(1+s-n-h),this._w=(o-u)/t,this._x=(i+a)/t,this._y=.25*t,this._z=(l+c)/t):(t=2*Math.sqrt(1+h-n-s),this._w=(a-i)/t,this._x=(o+u)/t,this._y=(l+c)/t,this._z=.25*t),this.onChangeCallback(),this},setFromUnitVectors:function(e,t){return void 0===n&&(n=new K.Vector3),(i=e.dot(t)+1)<1e-6?(i=0,Math.abs(e.x)>Math.abs(e.z)?n.set(-e.y,e.x,0):n.set(0,-e.z,e.y)):n.crossVectors(e,t),this._x=n.x,this._y=n.y,this._z=n.z,this._w=i,this.normalize(),this},inverse:function(){return this.conjugate().normalize(),this},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this.onChangeCallback(),this},dot:function(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this.onChangeCallback(),this},multiply:function(e,t){return void 0!==t?(K.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,t)):this.multiplyQuaternions(this,e)},multiplyQuaternions:function(e,t){var r=e._x,n=e._y,i=e._z,o=e._w,a=t._x,s=t._y,l=t._z,u=t._w;return this._x=r*u+o*a+n*l-i*s,this._y=n*u+o*s+i*a-r*l,this._z=i*u+o*l+r*s-n*a,this._w=o*u-r*a-n*s-i*l,this.onChangeCallback(),this},multiplyVector3:function(e){return K.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),e.applyQuaternion(this)},slerp:function(e,t){if(0===t)return this;if(1===t)return this.copy(e);var r=this._x,n=this._y,i=this._z,o=this._w,a=o*e._w+r*e._x+n*e._y+i*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=o,this._x=r,this._y=n,this._z=i,this;var s=Math.acos(a),l=Math.sqrt(1-a*a);if(Math.abs(l)<.001)return this._w=.5*(o+this._w),this._x=.5*(r+this._x),this._y=.5*(n+this._y),this._z=.5*(i+this._z),this;var u=Math.sin((1-t)*s)/l,c=Math.sin(t*s)/l;return this._w=o*u+this._w*c,this._x=r*u+this._x*c,this._y=n*u+this._y*c,this._z=i*u+this._z*c,this.onChangeCallback(),this},equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w},fromArray:function(e,t){return void 0===t&&(t=0),this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this.onChangeCallback(),this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e},onChange:function(e){return this.onChangeCallback=e,this},onChangeCallback:function(){},clone:function(){return new K.Quaternion(this._x,this._y,this._z,this._w)}},K.Quaternion.slerp=function(e,t,r,n){return r.copy(e).slerp(t,n)},K.Vector2=function(e,t){this.x=e||0,this.y=t||0},K.Vector2.prototype={constructor:K.Vector2,set:function(e,t){return this.x=e,this.y=t,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}},copy:function(e){return this.x=e.x,this.y=e.y,this},add:function(e,t){return void 0!==t?(K.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this)},addScalar:function(e){return this.x+=e,this.y+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this},sub:function(e,t){return void 0!==t?(K.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this)},subScalar:function(e){return this.x-=e,this.y-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this},multiply:function(e){return this.x*=e.x,this.y*=e.y,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this},divide:function(e){return this.x/=e.x,this.y/=e.y,this},divideScalar:function(e){if(0!==e){var t=1/e;this.x*=t,this.y*=t}else this.x=0,this.y=0;return this},min:function(e){return this.x>e.x&&(this.x=e.x),this.y>e.y&&(this.y=e.y),this},max:function(e){return this.x<e.x&&(this.x=e.x),this.y<e.y&&(this.y=e.y),this},clamp:function(e,t){return this.x<e.x?this.x=e.x:this.x>t.x&&(this.x=t.x),this.y<e.y?this.y=e.y:this.y>t.y&&(this.y=t.y),this},clampScalar:function(e,t){return void 0===o&&(o=new K.Vector2,a=new K.Vector2),o.set(e,e),a.set(t,t),this.clamp(o,a)},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(e){return this.x*e.x+this.y*e.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,r=this.y-e.y;return t*t+r*r},setLength:function(e){var t=this.length();return 0!==t&&e!==t&&this.multiplyScalar(e/t),this},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this},lerpVectors:function(e,t,r){return this.subVectors(t,e).multiplyScalar(r).add(e),this},equals:function(e){return e.x===this.x&&e.y===this.y},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e},fromAttribute:function(e,t,r){return void 0===r&&(r=0),t=t*e.itemSize+r,this.x=e.array[t],this.y=e.array[t+1],this},clone:function(){return new K.Vector2(this.x,this.y)}},K.Vector3=function(e,t,r){this.x=e||0,this.y=t||0,this.z=r||0},K.Vector3.prototype={constructor:K.Vector3,set:function(e,t,r){return this.x=e,this.y=t,this.z=r,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this},add:function(e,t){return void 0!==t?(K.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this},sub:function(e,t){return void 0!==t?(K.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this},multiply:function(e,t){return void 0!==t?(K.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this},multiplyVectors:function(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this},applyEuler:function(e){return e instanceof K.Euler==0&&K.error("THREE.Vector3: .applyEuler() now expects a Euler rotation rather than a Vector3 and order."),void 0===l&&(l=new K.Quaternion),this.applyQuaternion(l.setFromEuler(e)),this},applyAxisAngle:function(){var e;return function(t,r){return void 0===e&&(e=new K.Quaternion),this.applyQuaternion(e.setFromAxisAngle(t,r)),this}}(),applyMatrix3:function(e){var t=this.x,r=this.y,n=this.z,i=e.elements;return this.x=i[0]*t+i[3]*r+i[6]*n,this.y=i[1]*t+i[4]*r+i[7]*n,this.z=i[2]*t+i[5]*r+i[8]*n,this},applyMatrix4:function(e){var t=this.x,r=this.y,n=this.z,i=e.elements;return this.x=i[0]*t+i[4]*r+i[8]*n+i[12],this.y=i[1]*t+i[5]*r+i[9]*n+i[13],this.z=i[2]*t+i[6]*r+i[10]*n+i[14],this},applyProjection:function(e){var t=this.x,r=this.y,n=this.z,i=e.elements,o=1/(i[3]*t+i[7]*r+i[11]*n+i[15]);return this.x=(i[0]*t+i[4]*r+i[8]*n+i[12])*o,this.y=(i[1]*t+i[5]*r+i[9]*n+i[13])*o,this.z=(i[2]*t+i[6]*r+i[10]*n+i[14])*o,this},applyQuaternion:function(e){var t=this.x,r=this.y,n=this.z,i=e.x,o=e.y,a=e.z,s=e.w,l=s*t+o*n-a*r,u=s*r+a*t-i*n,c=s*n+i*r-o*t,h=-i*t-o*r-a*n;return this.x=l*s+h*-i+u*-a-c*-o,this.y=u*s+h*-o+c*-i-l*-a,this.z=c*s+h*-a+l*-o-u*-i,this},project:function(e){return void 0===s&&(s=new K.Matrix4),s.multiplyMatrices(e.projectionMatrix,s.getInverse(e.matrixWorld)),this.applyProjection(s)},unproject:function(){var e;return function(t){return void 0===e&&(e=new K.Matrix4),e.multiplyMatrices(t.matrixWorld,e.getInverse(t.projectionMatrix)),this.applyProjection(e)}}(),transformDirection:function(e){var t=this.x,r=this.y,n=this.z,i=e.elements;return this.x=i[0]*t+i[4]*r+i[8]*n,this.y=i[1]*t+i[5]*r+i[9]*n,this.z=i[2]*t+i[6]*r+i[10]*n,this.normalize(),this},divide:function(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this},divideScalar:function(e){if(0!==e){var t=1/e;this.x*=t,this.y*=t,this.z*=t}else this.x=0,this.y=0,this.z=0;return this},min:function(e){return this.x>e.x&&(this.x=e.x),this.y>e.y&&(this.y=e.y),this.z>e.z&&(this.z=e.z),this},max:function(e){return this.x<e.x&&(this.x=e.x),this.y<e.y&&(this.y=e.y),this.z<e.z&&(this.z=e.z),this},clamp:function(e,t){return this.x<e.x?this.x=e.x:this.x>t.x&&(this.x=t.x),this.y<e.y?this.y=e.y:this.y>t.y&&(this.y=t.y),this.z<e.z?this.z=e.z:this.z>t.z&&(this.z=t.z),this},clampScalar:function(){var e,t;return function(r,n){return void 0===e&&(e=new K.Vector3,t=new K.Vector3),e.set(r,r,r),t.set(n,n,n),this.clamp(e,t)}}(),floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length())},setLength:function(e){var t=this.length();return 0!==t&&e!==t&&this.multiplyScalar(e/t),this},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this},lerpVectors:function(e,t,r){return this.subVectors(t,e).multiplyScalar(r).add(e),this},cross:function(e,t){if(void 0!==t)return K.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t);var r=this.x,n=this.y,i=this.z;return this.x=n*e.z-i*e.y,this.y=i*e.x-r*e.z,this.z=r*e.y-n*e.x,this},crossVectors:function(e,t){var r=e.x,n=e.y,i=e.z,o=t.x,a=t.y,s=t.z;return this.x=n*s-i*a,this.y=i*o-r*s,this.z=r*a-n*o,this},projectOnVector:function(){var e,t;return function(r){return void 0===e&&(e=new K.Vector3),e.copy(r).normalize(),t=this.dot(e),this.copy(e).multiplyScalar(t)}}(),projectOnPlane:function(){var e;return function(t){return void 0===e&&(e=new K.Vector3),e.copy(this).projectOnVector(t),this.sub(e)}}(),reflect:function(){var e;return function(t){return void 0===e&&(e=new K.Vector3),this.sub(e.copy(t).multiplyScalar(2*this.dot(t)))}}(),angleTo:function(e){var t=this.dot(e)/(this.length()*e.length());return Math.acos(K.Math.clamp(t,-1,1))},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,r=this.y-e.y,n=this.z-e.z;return t*t+r*r+n*n},setEulerFromRotationMatrix:function(e,t){K.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(e,t){K.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(e){return K.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(e)},getScaleFromMatrix:function(e){return K.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(e)},getColumnFromMatrix:function(e,t){return K.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(e,t)},setFromMatrixPosition:function(e){return this.x=e.elements[12],this.y=e.elements[13],this.z=e.elements[14],this},setFromMatrixScale:function(e){var t=this.set(e.elements[0],e.elements[1],e.elements[2]).length(),r=this.set(e.elements[4],e.elements[5],e.elements[6]).length(),n=this.set(e.elements[8],e.elements[9],e.elements[10]).length();return this.x=t,this.y=r,this.z=n,this},setFromMatrixColumn:function(e,t){var r=4*e,n=t.elements;return this.x=n[r],this.y=n[r+1],this.z=n[r+2],this},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this.z=e[t+2],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e},fromAttribute:function(e,t,r){return void 0===r&&(r=0),t=t*e.itemSize+r,this.x=e.array[t],this.y=e.array[t+1],this.z=e.array[t+2],this},clone:function(){return new K.Vector3(this.x,this.y,this.z)}},K.Vector4=function(e,t,r,n){this.x=e||0,this.y=t||0,this.z=r||0,this.w=void 0!==n?n:1},K.Vector4.prototype={constructor:K.Vector4,set:function(e,t,r,n){return this.x=e,this.y=t,this.z=r,this.w=n,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setW:function(e){return this.w=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this},add:function(e,t){return void 0!==t?(K.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this},sub:function(e,t){return void 0!==t?(K.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this},applyMatrix4:function(e){var t=this.x,r=this.y,n=this.z,i=this.w,o=e.elements;return this.x=o[0]*t+o[4]*r+o[8]*n+o[12]*i,this.y=o[1]*t+o[5]*r+o[9]*n+o[13]*i,this.z=o[2]*t+o[6]*r+o[10]*n+o[14]*i,this.w=o[3]*t+o[7]*r+o[11]*n+o[15]*i,this},divideScalar:function(e){if(0!==e){var t=1/e;this.x*=t,this.y*=t,this.z*=t,this.w*=t}else this.x=0,this.y=0,this.z=0,this.w=1;return this},setAxisAngleFromQuaternion:function(e){this.w=2*Math.acos(e.w);var t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this},setAxisAngleFromRotationMatrix:function(e){var t,r,n,i,o=.01,a=.1,s=e.elements,l=s[0],u=s[4],c=s[8],h=s[1],d=s[5],f=s[9],p=s[2],m=s[6],g=s[10];if(Math.abs(u-h)<o&&Math.abs(c-p)<o&&Math.abs(f-m)<o){if(Math.abs(u+h)<a&&Math.abs(c+p)<a&&Math.abs(f+m)<a&&Math.abs(l+d+g-3)<a)return this.set(1,0,0,0),this;t=Math.PI;var v=(l+1)/2,y=(d+1)/2,b=(g+1)/2,x=(u+h)/4,_=(c+p)/4,E=(f+m)/4;return v>y&&v>b?v<o?(r=0,n=.707106781,i=.707106781):(n=x/(r=Math.sqrt(v)),i=_/r):y>b?y<o?(r=.707106781,n=0,i=.707106781):(r=x/(n=Math.sqrt(y)),i=E/n):b<o?(r=.707106781,n=.707106781,i=0):(r=_/(i=Math.sqrt(b)),n=E/i),this.set(r,n,i,t),this}var w=Math.sqrt((m-f)*(m-f)+(c-p)*(c-p)+(h-u)*(h-u));return Math.abs(w)<.001&&(w=1),this.x=(m-f)/w,this.y=(c-p)/w,this.z=(h-u)/w,this.w=Math.acos((l+d+g-1)/2),this},min:function(e){return this.x>e.x&&(this.x=e.x),this.y>e.y&&(this.y=e.y),this.z>e.z&&(this.z=e.z),this.w>e.w&&(this.w=e.w),this},max:function(e){return this.x<e.x&&(this.x=e.x),this.y<e.y&&(this.y=e.y),this.z<e.z&&(this.z=e.z),this.w<e.w&&(this.w=e.w),this},clamp:function(e,t){return this.x<e.x?this.x=e.x:this.x>t.x&&(this.x=t.x),this.y<e.y?this.y=e.y:this.y>t.y&&(this.y=t.y),this.z<e.z?this.z=e.z:this.z>t.z&&(this.z=t.z),this.w<e.w?this.w=e.w:this.w>t.w&&(this.w=t.w),this},clampScalar:function(){var e,t;return function(r,n){return void 0===e&&(e=new K.Vector4,t=new K.Vector4),e.set(r,r,r,r),t.set(n,n,n,n),this.clamp(e,t)}}(),floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length())},setLength:function(e){var t=this.length();return 0!==t&&e!==t&&this.multiplyScalar(e/t),this},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this},lerpVectors:function(e,t,r){return this.subVectors(t,e).multiplyScalar(r).add(e),this},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e},fromAttribute:function(e,t,r){return void 0===r&&(r=0),t=t*e.itemSize+r,this.x=e.array[t],this.y=e.array[t+1],this.z=e.array[t+2],this.w=e.array[t+3],this},clone:function(){return new K.Vector4(this.x,this.y,this.z,this.w)}},K.Euler=function(e,t,r,n){this._x=e||0,this._y=t||0,this._z=r||0,this._order=n||K.Euler.DefaultOrder},K.Euler.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],K.Euler.DefaultOrder="XYZ",K.Euler.prototype={constructor:K.Euler,_x:0,_y:0,_z:0,_order:K.Euler.DefaultOrder,get x(){return this._x},set x(e){this._x=e,this.onChangeCallback()},get y(){return this._y},set y(e){this._y=e,this.onChangeCallback()},get z(){return this._z},set z(e){this._z=e,this.onChangeCallback()},get order(){return this._order},set order(e){this._order=e,this.onChangeCallback()},set:function(e,t,r,n){return this._x=e,this._y=t,this._z=r,this._order=n||this._order,this.onChangeCallback(),this},copy:function(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this.onChangeCallback(),this},setFromRotationMatrix:function(e,t,r){var n=K.Math.clamp,i=e.elements,o=i[0],a=i[4],s=i[8],l=i[1],u=i[5],c=i[9],h=i[2],d=i[6],f=i[10];return"XYZ"===(t=t||this._order)?(this._y=Math.asin(n(s,-1,1)),Math.abs(s)<.99999?(this._x=Math.atan2(-c,f),this._z=Math.atan2(-a,o)):(this._x=Math.atan2(d,u),this._z=0)):"YXZ"===t?(this._x=Math.asin(-n(c,-1,1)),Math.abs(c)<.99999?(this._y=Math.atan2(s,f),this._z=Math.atan2(l,u)):(this._y=Math.atan2(-h,o),this._z=0)):"ZXY"===t?(this._x=Math.asin(n(d,-1,1)),Math.abs(d)<.99999?(this._y=Math.atan2(-h,f),this._z=Math.atan2(-a,u)):(this._y=0,this._z=Math.atan2(l,o))):"ZYX"===t?(this._y=Math.asin(-n(h,-1,1)),Math.abs(h)<.99999?(this._x=Math.atan2(d,f),this._z=Math.atan2(l,o)):(this._x=0,this._z=Math.atan2(-a,u))):"YZX"===t?(this._z=Math.asin(n(l,-1,1)),Math.abs(l)<.99999?(this._x=Math.atan2(-c,u),this._y=Math.atan2(-h,o)):(this._x=0,this._y=Math.atan2(s,f))):"XZY"===t?(this._z=Math.asin(-n(a,-1,1)),Math.abs(a)<.99999?(this._x=Math.atan2(d,u),this._y=Math.atan2(s,o)):(this._x=Math.atan2(-c,f),this._y=0)):K.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+t),this._order=t,!1!==r&&this.onChangeCallback(),this},setFromQuaternion:function(){var e;return function(t,r,n){return void 0===e&&(e=new K.Matrix4),e.makeRotationFromQuaternion(t),this.setFromRotationMatrix(e,r,n),this}}(),setFromVector3:function(e,t){return this.set(e.x,e.y,e.z,t||this._order)},reorder:(u=new K.Quaternion,function(e){u.setFromEuler(this),this.setFromQuaternion(u,e)}),equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order},fromArray:function(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this.onChangeCallback(),this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e},toVector3:function(e){return e?e.set(this._x,this._y,this._z):new K.Vector3(this._x,this._y,this._z)},onChange:function(e){return this.onChangeCallback=e,this},onChangeCallback:function(){},clone:function(){return new K.Euler(this._x,this._y,this._z,this._order)}},K.Line3=function(e,t){this.start=void 0!==e?e:new K.Vector3,this.end=void 0!==t?t:new K.Vector3},K.Line3.prototype={constructor:K.Line3,set:function(e,t){return this.start.copy(e),this.end.copy(t),this},copy:function(e){return this.start.copy(e.start),this.end.copy(e.end),this},center:function(e){return(e||new K.Vector3).addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(e){return(e||new K.Vector3).subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(e,t){var r=t||new K.Vector3;return this.delta(r).multiplyScalar(e).add(this.start)},closestPointToPointParameter:(c=new K.Vector3,h=new K.Vector3,function(e,t){c.subVectors(e,this.start),h.subVectors(this.end,this.start);var r=h.dot(h),n=h.dot(c)/r;return t&&(n=K.Math.clamp(n,0,1)),n}),closestPointToPoint:function(e,t,r){var n=this.closestPointToPointParameter(e,t),i=r||new K.Vector3;return this.delta(i).multiplyScalar(n).add(this.start)},applyMatrix4:function(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this},equals:function(e){return e.start.equals(this.start)&&e.end.equals(this.end)},clone:function(){return(new K.Line3).copy(this)}},K.Box2=function(e,t){this.min=void 0!==e?e:new K.Vector2(1/0,1/0),this.max=void 0!==t?t:new K.Vector2(-1/0,-1/0)},K.Box2.prototype={constructor:K.Box2,set:function(e,t){return this.min.copy(e),this.max.copy(t),this},setFromPoints:function(e){this.makeEmpty();for(var t=0,r=e.length;t<r;t++)this.expandByPoint(e[t]);return this},setFromCenterAndSize:function(){var e=new K.Vector2;return function(t,r){var n=e.copy(r).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this}}(),copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},empty:function(){return console.warn("Box2.empty has been deprecated. Use Box2.isEmpty instead"),this.isEmpty()},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},center:function(e){return console.warn("Box2.center() is deprecated. Use Box2.getCenter() instead."),this.getCenter(e)},getCenter:function(e){return(e||new K.Vector2).addVectors(this.min,this.max).multiplyScalar(.5)},size:function(e){return(e||new K.Vector2).subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},containsPoint:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y},getParameter:function(e,t){return(t||new K.Vector2).set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))},isIntersectionBox:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)},clampPoint:function(e,t){return(t||new K.Vector2).copy(e).clamp(this.min,this.max)},distanceToPoint:function(){var e=new K.Vector2;return function(t){return e.copy(t).clamp(this.min,this.max).sub(t).length()}}(),intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)},clone:function(){return(new K.Box2).copy(this)}},K.Box3=function(e,t){this.min=void 0!==e?e:new K.Vector3(1/0,1/0,1/0),this.max=void 0!==t?t:new K.Vector3(-1/0,-1/0,-1/0)},K.Box3.prototype={constructor:K.Box3,set:function(e,t){return this.min.copy(e),this.max.copy(t),this},setFromPoints:function(e){this.makeEmpty();for(var t=0,r=e.length;t<r;t++)this.expandByPoint(e[t]);return this},setFromCenterAndSize:function(){var e=new K.Vector3;return function(t,r){var n=e.copy(r).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this}}(),setFromObject:function(){var e=new K.Vector3;return function(t){var r=this;return t.updateMatrixWorld(!0),this.makeEmpty(),t.traverse((function(t){var n=t.geometry;if(void 0!==n)if(n instanceof K.Geometry)for(var i=n.vertices,o=0,a=i.length;o<a;o++)e.copy(i[o]),e.applyMatrix4(t.matrixWorld),r.expandByPoint(e);else if(n instanceof K.BufferGeometry&&void 0!==n.attributes.position){var s=n.attributes.position.array;for(o=0,a=s.length;o<a;o+=3)e.set(s[o],s[o+1],s[o+2]),e.applyMatrix4(t.matrixWorld),r.expandByPoint(e)}})),this}}(),copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},empty:function(){return console.warn("Box3.empty has been deprecated. Use Box3.isEmpty instead"),this.isEmpty()},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},center:function(e){return console.warn("Box3.center() is deprecated. Use Box3.getCenter() instead."),this.getCenter(e)},getCenter:function(e){return e=e||new K.Vector3,this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)},size:function(e){return(e||new K.Vector3).subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},containsPoint:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z},getParameter:function(e,t){return(t||new K.Vector3).set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))},isIntersectionBox:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)},clampPoint:function(e,t){return(t||new K.Vector3).copy(e).clamp(this.min,this.max)},distanceToPoint:function(){var e=new K.Vector3;return function(t){return e.copy(t).clamp(this.min,this.max).sub(t).length()}}(),getBoundingSphere:function(){var e=new K.Vector3;return function(t){var r=t||new K.Sphere;return r.center=this.getCenter(),r.radius=.5*this.size(e).length(),r}}(),intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},applyMatrix4:(d=[new K.Vector3,new K.Vector3,new K.Vector3,new K.Vector3,new K.Vector3,new K.Vector3,new K.Vector3,new K.Vector3],function(e){return d[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),d[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),d[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),d[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),d[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),d[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),d[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),d[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.makeEmpty(),this.setFromPoints(d),this}),translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)},clone:function(){return(new K.Box3).copy(this)}},K.Matrix3=function(){this.elements=new Float32Array([1,0,0,0,1,0,0,0,1]),arguments.length>0&&K.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")},K.Matrix3.prototype={constructor:K.Matrix3,set:function(e,t,r,n,i,o,a,s,l){var u=this.elements;return u[0]=e,u[3]=t,u[6]=r,u[1]=n,u[4]=i,u[7]=o,u[2]=a,u[5]=s,u[8]=l,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},copy:function(e){var t=e.elements;return this.set(t[0],t[3],t[6],t[1],t[4],t[7],t[2],t[5],t[8]),this},multiplyVector3:function(e){return K.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},multiplyVector3Array:function(e){return K.warn("THREE.Matrix3: .multiplyVector3Array() has been renamed. Use matrix.applyToVector3Array( array ) instead."),this.applyToVector3Array(e)},applyToVector3Array:function(){var e=new K.Vector3;return function(t,r,n){void 0===r&&(r=0),void 0===n&&(n=t.length);for(var i=0,o=r;i<n;i+=3,o+=3)e.x=t[o],e.y=t[o+1],e.z=t[o+2],e.applyMatrix3(this),t[o]=e.x,t[o+1]=e.y,t[o+2]=e.z;return t}}(),multiplyScalar:function(e){var t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this},determinant:function(){var e=this.elements,t=e[0],r=e[1],n=e[2],i=e[3],o=e[4],a=e[5],s=e[6],l=e[7],u=e[8];return t*o*u-t*a*l-r*i*u+r*a*s+n*i*l-n*o*s},getInverse:function(e,t){var r=e.elements,n=this.elements;n[0]=r[10]*r[5]-r[6]*r[9],n[1]=-r[10]*r[1]+r[2]*r[9],n[2]=r[6]*r[1]-r[2]*r[5],n[3]=-r[10]*r[4]+r[6]*r[8],n[4]=r[10]*r[0]-r[2]*r[8],n[5]=-r[6]*r[0]+r[2]*r[4],n[6]=r[9]*r[4]-r[5]*r[8],n[7]=-r[9]*r[0]+r[1]*r[8],n[8]=r[5]*r[0]-r[1]*r[4];var i=r[0]*n[0]+r[1]*n[3]+r[2]*n[6];if(0===i){var o="Matrix3.getInverse(): can't invert matrix, determinant is 0";if(t)throw new Error(o);return K.warn(o),this.identity(),this}return this.multiplyScalar(1/i),this},transpose:function(){var e,t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this},flattenToArrayOffset:function(e,t){var r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e},getNormalMatrix:function(e){return this.getInverse(e).transpose(),this},transposeIntoArray:function(e){var t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this},fromArray:function(e){return this.elements.set(e),this},toArray:function(){var e=this.elements;return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8]]},clone:function(){return(new K.Matrix3).fromArray(this.elements)}},K.Matrix4=function(){this.elements=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),arguments.length>0&&K.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")},K.Matrix4.prototype={constructor:K.Matrix4,set:function(e,t,r,n,i,o,a,s,l,u,c,h,d,f,p,m){var g=this.elements;return g[0]=e,g[4]=t,g[8]=r,g[12]=n,g[1]=i,g[5]=o,g[9]=a,g[13]=s,g[2]=l,g[6]=u,g[10]=c,g[14]=h,g[3]=d,g[7]=f,g[11]=p,g[15]=m,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},copy:function(e){return this.elements.set(e.elements),this},extractPosition:function(e){return K.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(e)},copyPosition:function(e){var t=this.elements,r=e.elements;return t[12]=r[12],t[13]=r[13],t[14]=r[14],this},extractBasis:function(e,t,r){var n=this.elements;return e.set(n[0],n[1],n[2]),t.set(n[4],n[5],n[6]),r.set(n[8],n[9],n[10]),this},makeBasis:function(e,t,r){return this.set(e.x,t.x,r.x,0,e.y,t.y,r.y,0,e.z,t.z,r.z,0,0,0,0,1),this},extractRotation:function(){var e=new K.Vector3;return function(t){var r=this.elements,n=t.elements,i=1/e.set(n[0],n[1],n[2]).length(),o=1/e.set(n[4],n[5],n[6]).length(),a=1/e.set(n[8],n[9],n[10]).length();return r[0]=n[0]*i,r[1]=n[1]*i,r[2]=n[2]*i,r[4]=n[4]*o,r[5]=n[5]*o,r[6]=n[6]*o,r[8]=n[8]*a,r[9]=n[9]*a,r[10]=n[10]*a,this}}(),makeRotationFromEuler:function(e){e instanceof K.Euler==!1&&K.error("THREE.Matrix: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var t=this.elements,r=e.x,n=e.y,i=e.z,o=Math.cos(r),a=Math.sin(r),s=Math.cos(n),l=Math.sin(n),u=Math.cos(i),c=Math.sin(i);if("XYZ"===e.order){var h=o*u,d=o*c,f=a*u,p=a*c;t[0]=s*u,t[4]=-s*c,t[8]=l,t[1]=d+f*l,t[5]=h-p*l,t[9]=-a*s,t[2]=p-h*l,t[6]=f+d*l,t[10]=o*s}else if("YXZ"===e.order){var m=s*u,g=s*c,v=l*u,y=l*c;t[0]=m+y*a,t[4]=v*a-g,t[8]=o*l,t[1]=o*c,t[5]=o*u,t[9]=-a,t[2]=g*a-v,t[6]=y+m*a,t[10]=o*s}else if("ZXY"===e.order){m=s*u,g=s*c,v=l*u,y=l*c;t[0]=m-y*a,t[4]=-o*c,t[8]=v+g*a,t[1]=g+v*a,t[5]=o*u,t[9]=y-m*a,t[2]=-o*l,t[6]=a,t[10]=o*s}else if("ZYX"===e.order){h=o*u,d=o*c,f=a*u,p=a*c;t[0]=s*u,t[4]=f*l-d,t[8]=h*l+p,t[1]=s*c,t[5]=p*l+h,t[9]=d*l-f,t[2]=-l,t[6]=a*s,t[10]=o*s}else if("YZX"===e.order){var b=o*s,x=o*l,_=a*s,E=a*l;t[0]=s*u,t[4]=E-b*c,t[8]=_*c+x,t[1]=c,t[5]=o*u,t[9]=-a*u,t[2]=-l*u,t[6]=x*c+_,t[10]=b-E*c}else if("XZY"===e.order){b=o*s,x=o*l,_=a*s,E=a*l;t[0]=s*u,t[4]=-c,t[8]=l*u,t[1]=b*c+E,t[5]=o*u,t[9]=x*c-_,t[2]=_*c-x,t[6]=a*u,t[10]=E*c+b}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this},setRotationFromQuaternion:function(e){return K.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(e)},makeRotationFromQuaternion:function(e){var t=this.elements,r=e.x,n=e.y,i=e.z,o=e.w,a=r+r,s=n+n,l=i+i,u=r*a,c=r*s,h=r*l,d=n*s,f=n*l,p=i*l,m=o*a,g=o*s,v=o*l;return t[0]=1-(d+p),t[4]=c-v,t[8]=h+g,t[1]=c+v,t[5]=1-(u+p),t[9]=f-m,t[2]=h-g,t[6]=f+m,t[10]=1-(u+d),t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this},lookAt:function(){var e=new K.Vector3,t=new K.Vector3,r=new K.Vector3;return function(n,i,o){var a=this.elements;return r.subVectors(n,i).normalize(),0===r.length()&&(r.z=1),e.crossVectors(o,r).normalize(),0===e.length()&&(r.x+=1e-4,e.crossVectors(o,r).normalize()),t.crossVectors(r,e),a[0]=e.x,a[4]=t.x,a[8]=r.x,a[1]=e.y,a[5]=t.y,a[9]=r.y,a[2]=e.z,a[6]=t.z,a[10]=r.z,this}}(),multiply:function(e,t){return void 0!==t?(K.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,t)):this.multiplyMatrices(this,e)},multiplyMatrices:function(e,t){var r=e.elements,n=t.elements,i=this.elements,o=r[0],a=r[4],s=r[8],l=r[12],u=r[1],c=r[5],h=r[9],d=r[13],f=r[2],p=r[6],m=r[10],g=r[14],v=r[3],y=r[7],b=r[11],x=r[15],_=n[0],E=n[4],w=n[8],A=n[12],S=n[1],M=n[5],T=n[9],C=n[13],P=n[2],D=n[6],L=n[10],R=n[14],I=n[3],O=n[7],N=n[11],k=n[15];return i[0]=o*_+a*S+s*P+l*I,i[4]=o*E+a*M+s*D+l*O,i[8]=o*w+a*T+s*L+l*N,i[12]=o*A+a*C+s*R+l*k,i[1]=u*_+c*S+h*P+d*I,i[5]=u*E+c*M+h*D+d*O,i[9]=u*w+c*T+h*L+d*N,i[13]=u*A+c*C+h*R+d*k,i[2]=f*_+p*S+m*P+g*I,i[6]=f*E+p*M+m*D+g*O,i[10]=f*w+p*T+m*L+g*N,i[14]=f*A+p*C+m*R+g*k,i[3]=v*_+y*S+b*P+x*I,i[7]=v*E+y*M+b*D+x*O,i[11]=v*w+y*T+b*L+x*N,i[15]=v*A+y*C+b*R+x*k,this},multiplyToArray:function(e,t,r){var n=this.elements;return this.multiplyMatrices(e,t),r[0]=n[0],r[1]=n[1],r[2]=n[2],r[3]=n[3],r[4]=n[4],r[5]=n[5],r[6]=n[6],r[7]=n[7],r[8]=n[8],r[9]=n[9],r[10]=n[10],r[11]=n[11],r[12]=n[12],r[13]=n[13],r[14]=n[14],r[15]=n[15],this},multiplyScalar:function(e){var t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this},multiplyVector3:function(e){return K.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) or vector.applyProjection( matrix ) instead."),e.applyProjection(this)},multiplyVector4:function(e){return K.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},multiplyVector3Array:function(e){return K.warn("THREE.Matrix4: .multiplyVector3Array() has been renamed. Use matrix.applyToVector3Array( array ) instead."),this.applyToVector3Array(e)},applyToVector3Array:function(){var e=new K.Vector3;return function(t,r,n){void 0===r&&(r=0),void 0===n&&(n=t.length);for(var i=0,o=r;i<n;i+=3,o+=3)e.x=t[o],e.y=t[o+1],e.z=t[o+2],e.applyMatrix4(this),t[o]=e.x,t[o+1]=e.y,t[o+2]=e.z;return t}}(),rotateAxis:function(e){K.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),e.transformDirection(this)},crossVector:function(e){return K.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},determinant:function(){var e=this.elements,t=e[0],r=e[4],n=e[8],i=e[12],o=e[1],a=e[5],s=e[9],l=e[13],u=e[2],c=e[6],h=e[10],d=e[14];return e[3]*(+i*s*c-n*l*c-i*a*h+r*l*h+n*a*d-r*s*d)+e[7]*(+t*s*d-t*l*h+i*o*h-n*o*d+n*l*u-i*s*u)+e[11]*(+t*l*c-t*a*d-i*o*c+r*o*d+i*a*u-r*l*u)+e[15]*(-n*a*u-t*s*c+t*a*h+n*o*c-r*o*h+r*s*u)},transpose:function(){var e,t=this.elements;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this},flattenToArrayOffset:function(e,t){var r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e[t+9]=r[9],e[t+10]=r[10],e[t+11]=r[11],e[t+12]=r[12],e[t+13]=r[13],e[t+14]=r[14],e[t+15]=r[15],e},getPosition:function(){var e=new K.Vector3;return function(){K.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead.");var t=this.elements;return e.set(t[12],t[13],t[14])}}(),setPosition:function(e){var t=this.elements;return t[12]=e.x,t[13]=e.y,t[14]=e.z,this},getInverse:function(e,t){var r=this.elements,n=e.elements,i=n[0],o=n[4],a=n[8],s=n[12],l=n[1],u=n[5],c=n[9],h=n[13],d=n[2],f=n[6],p=n[10],m=n[14],g=n[3],v=n[7],y=n[11],b=n[15];r[0]=c*m*v-h*p*v+h*f*y-u*m*y-c*f*b+u*p*b,r[4]=s*p*v-a*m*v-s*f*y+o*m*y+a*f*b-o*p*b,r[8]=a*h*v-s*c*v+s*u*y-o*h*y-a*u*b+o*c*b,r[12]=s*c*f-a*h*f-s*u*p+o*h*p+a*u*m-o*c*m,r[1]=h*p*g-c*m*g-h*d*y+l*m*y+c*d*b-l*p*b,r[5]=a*m*g-s*p*g+s*d*y-i*m*y-a*d*b+i*p*b,r[9]=s*c*g-a*h*g-s*l*y+i*h*y+a*l*b-i*c*b,r[13]=a*h*d-s*c*d+s*l*p-i*h*p-a*l*m+i*c*m,r[2]=u*m*g-h*f*g+h*d*v-l*m*v-u*d*b+l*f*b,r[6]=s*f*g-o*m*g-s*d*v+i*m*v+o*d*b-i*f*b,r[10]=o*h*g-s*u*g+s*l*v-i*h*v-o*l*b+i*u*b,r[14]=s*u*d-o*h*d-s*l*f+i*h*f+o*l*m-i*u*m,r[3]=c*f*g-u*p*g-c*d*v+l*p*v+u*d*y-l*f*y,r[7]=o*p*g-a*f*g+a*d*v-i*p*v-o*d*y+i*f*y,r[11]=a*u*g-o*c*g-a*l*v+i*c*v+o*l*y-i*u*y,r[15]=o*c*d-a*u*d+a*l*f-i*c*f-o*l*p+i*u*p;var x=i*r[0]+l*r[4]+d*r[8]+g*r[12];if(0==x){var _="THREE.Matrix4.getInverse(): can't invert matrix, determinant is 0";if(t)throw new Error(_);return K.warn(_),this.identity(),this}return this.multiplyScalar(1/x),this},translate:function(e){K.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(e){K.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(e){K.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(e){K.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(e,t){K.error("THREE.Matrix4: .rotateByAxis() has been removed.")},scale:function(e){var t=this.elements,r=e.x,n=e.y,i=e.z;return t[0]*=r,t[4]*=n,t[8]*=i,t[1]*=r,t[5]*=n,t[9]*=i,t[2]*=r,t[6]*=n,t[10]*=i,t[3]*=r,t[7]*=n,t[11]*=i,this},getMaxScaleOnAxis:function(){var e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],r=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],n=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,Math.max(r,n)))},makeTranslation:function(e,t,r){return this.set(1,0,0,e,0,1,0,t,0,0,1,r,0,0,0,1),this},makeRotationX:function(e){var t=Math.cos(e),r=Math.sin(e);return this.set(1,0,0,0,0,t,-r,0,0,r,t,0,0,0,0,1),this},makeRotationY:function(e){var t=Math.cos(e),r=Math.sin(e);return this.set(t,0,r,0,0,1,0,0,-r,0,t,0,0,0,0,1),this},makeRotationZ:function(e){var t=Math.cos(e),r=Math.sin(e);return this.set(t,-r,0,0,r,t,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(e,t){var r=Math.cos(t),n=Math.sin(t),i=1-r,o=e.x,a=e.y,s=e.z,l=i*o,u=i*a;return this.set(l*o+r,l*a-n*s,l*s+n*a,0,l*a+n*s,u*a+r,u*s-n*o,0,l*s-n*a,u*s+n*o,i*s*s+r,0,0,0,0,1),this},makeScale:function(e,t,r){return this.set(e,0,0,0,0,t,0,0,0,0,r,0,0,0,0,1),this},compose:function(e,t,r){return this.makeRotationFromQuaternion(t),this.scale(r),this.setPosition(e),this},decompose:function(){var e=new K.Vector3,t=new K.Matrix4;return function(r,n,i){var o=this.elements,a=e.set(o[0],o[1],o[2]).length(),s=e.set(o[4],o[5],o[6]).length(),l=e.set(o[8],o[9],o[10]).length();this.determinant()<0&&(a=-a),r.x=o[12],r.y=o[13],r.z=o[14],t.elements.set(this.elements);var u=1/a,c=1/s,h=1/l;return t.elements[0]*=u,t.elements[1]*=u,t.elements[2]*=u,t.elements[4]*=c,t.elements[5]*=c,t.elements[6]*=c,t.elements[8]*=h,t.elements[9]*=h,t.elements[10]*=h,n.setFromRotationMatrix(t),i.x=a,i.y=s,i.z=l,this}}(),makeFrustum:function(e,t,r,n,i,o){var a=this.elements,s=2*i/(t-e),l=2*i/(n-r),u=(t+e)/(t-e),c=(n+r)/(n-r),h=-(o+i)/(o-i),d=-2*o*i/(o-i);return a[0]=s,a[4]=0,a[8]=u,a[12]=0,a[1]=0,a[5]=l,a[9]=c,a[13]=0,a[2]=0,a[6]=0,a[10]=h,a[14]=d,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this},makePerspective:function(e,t,r,n){var i=r*Math.tan(K.Math.degToRad(.5*e)),o=-i,a=o*t,s=i*t;return this.makeFrustum(a,s,o,i,r,n)},makeOrthographic:function(e,t,r,n,i,o){var a=this.elements,s=t-e,l=r-n,u=o-i,c=(t+e)/s,h=(r+n)/l,d=(o+i)/u;return a[0]=2/s,a[4]=0,a[8]=0,a[12]=-c,a[1]=0,a[5]=2/l,a[9]=0,a[13]=-h,a[2]=0,a[6]=0,a[10]=-2/u,a[14]=-d,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this},equals:function(e){for(var t=this.elements,r=e.elements,n=0;n<16;n++)if(t[n]!==r[n])return!1;return!0},fromArray:function(e){return this.elements.set(e),this},toArray:function(){var e=this.elements;return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15]]},clone:function(){return(new K.Matrix4).fromArray(this.elements)}},K.Ray=function(e,t){this.origin=void 0!==e?e:new K.Vector3,this.direction=void 0!==t?t:new K.Vector3},K.Ray.prototype={constructor:K.Ray,set:function(e,t){return this.origin.copy(e),this.direction.copy(t),this},copy:function(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this},at:function(e,t){return(t||new K.Vector3).copy(this.direction).multiplyScalar(e).add(this.origin)},recast:function(){var e=new K.Vector3;return function(t){return this.origin.copy(this.at(t,e)),this}}(),closestPointToPoint:function(e,t){var r=t||new K.Vector3;r.subVectors(e,this.origin);var n=r.dot(this.direction);return n<0?r.copy(this.origin):r.copy(this.direction).multiplyScalar(n).add(this.origin)},distanceToPoint:function(){var e=new K.Vector3;return function(t){var r=e.subVectors(t,this.origin).dot(this.direction);return r<0?this.origin.distanceTo(t):(e.copy(this.direction).multiplyScalar(r).add(this.origin),e.distanceTo(t))}}(),distanceSqToSegment:(p=new K.Vector3,m=new K.Vector3,g=new K.Vector3,function(e,t,r,n){p.copy(e).add(t).multiplyScalar(.5),m.copy(t).sub(e).normalize(),g.copy(this.origin).sub(p);var i,o,a,s,l=.5*e.distanceTo(t),u=-this.direction.dot(m),c=g.dot(this.direction),h=-g.dot(m),d=g.lengthSq(),f=Math.abs(1-u*u);if(f>0)if(o=u*c-h,s=l*f,(i=u*h-c)>=0)if(o>=-s)if(o<=s){var v=1/f;a=(i*=v)*(i+u*(o*=v)+2*c)+o*(u*i+o+2*h)+d}else o=l,a=-(i=Math.max(0,-(u*o+c)))*i+o*(o+2*h)+d;else o=-l,a=-(i=Math.max(0,-(u*o+c)))*i+o*(o+2*h)+d;else o<=-s?a=-(i=Math.max(0,-(-u*l+c)))*i+(o=i>0?-l:Math.min(Math.max(-l,-h),l))*(o+2*h)+d:o<=s?(i=0,a=(o=Math.min(Math.max(-l,-h),l))*(o+2*h)+d):a=-(i=Math.max(0,-(u*l+c)))*i+(o=i>0?l:Math.min(Math.max(-l,-h),l))*(o+2*h)+d;else o=u>0?-l:l,a=-(i=Math.max(0,-(u*o+c)))*i+o*(o+2*h)+d;return r&&r.copy(this.direction).multiplyScalar(i).add(this.origin),n&&n.copy(m).multiplyScalar(o).add(p),a}),isIntersectionSphere:function(e){return this.distanceToPoint(e.center)<=e.radius},intersectSphere:function(){var e=new K.Vector3;return function(t,r){e.subVectors(t.center,this.origin);var n=e.dot(this.direction),i=e.dot(e)-n*n,o=t.radius*t.radius;if(i>o)return null;var a=Math.sqrt(o-i),s=n-a,l=n+a;return s<0&&l<0?null:s<0?this.at(l,r):this.at(s,r)}}(),isIntersectionPlane:function(e){var t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0},distanceToPlane:function(e){var t=e.normal.dot(this.direction);if(0==t)return 0==e.distanceToPoint(this.origin)?0:null;var r=-(this.origin.dot(e.normal)+e.constant)/t;return r>=0?r:null},intersectPlane:function(e,t){var r=this.distanceToPlane(e);return null===r?null:this.at(r,t)},isIntersectionBox:(f=new K.Vector3,function(e){return null!==this.intersectBox(e,f)}),intersectBox:function(e,t){var r,n,i,o,a,s,l=1/this.direction.x,u=1/this.direction.y,c=1/this.direction.z,h=this.origin;return l>=0?(r=(e.min.x-h.x)*l,n=(e.max.x-h.x)*l):(r=(e.max.x-h.x)*l,n=(e.min.x-h.x)*l),u>=0?(i=(e.min.y-h.y)*u,o=(e.max.y-h.y)*u):(i=(e.max.y-h.y)*u,o=(e.min.y-h.y)*u),r>o||i>n?null:((i>r||r!=r)&&(r=i),(o<n||n!=n)&&(n=o),c>=0?(a=(e.min.z-h.z)*c,s=(e.max.z-h.z)*c):(a=(e.max.z-h.z)*c,s=(e.min.z-h.z)*c),r>s||a>n?null:((a>r||r!=r)&&(r=a),(s<n||n!=n)&&(n=s),n<0?null:this.at(r>=0?r:n,t)))},intersectTriangle:function(){var e=new K.Vector3,t=new K.Vector3,r=new K.Vector3,n=new K.Vector3;return function(i,o,a,s,l){t.subVectors(o,i),r.subVectors(a,i),n.crossVectors(t,r);var u,c=this.direction.dot(n);if(c>0){if(s)return null;u=1}else{if(!(c<0))return null;u=-1,c=-c}e.subVectors(this.origin,i);var h=u*this.direction.dot(r.crossVectors(e,r));if(h<0)return null;var d=u*this.direction.dot(t.cross(e));if(d<0)return null;if(h+d>c)return null;var f=-u*e.dot(n);return f<0?null:this.at(f/c,l)}}(),applyMatrix4:function(e){return this.direction.add(this.origin).applyMatrix4(e),this.origin.applyMatrix4(e),this.direction.sub(this.origin),this.direction.normalize(),this},equals:function(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)},clone:function(){return(new K.Ray).copy(this)}},K.Sphere=function(e,t){this.center=void 0!==e?e:new K.Vector3,this.radius=void 0!==t?t:0},K.Sphere.prototype={constructor:K.Sphere,set:function(e,t){return this.center.copy(e),this.radius=t,this},setFromPoints:(v=new K.Box3,function(e,t){var r=this.center;void 0!==t?r.copy(t):v.setFromPoints(e).getCenter(r);for(var n=0,i=0,o=e.length;i<o;i++)n=Math.max(n,r.distanceToSquared(e[i]));return this.radius=Math.sqrt(n),this}),copy:function(e){return this.center.copy(e.center),this.radius=e.radius,this},empty:function(){return this.radius<=0},containsPoint:function(e){return e.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(e){return e.distanceTo(this.center)-this.radius},intersectsSphere:function(e){var t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t},clampPoint:function(e,t){var r=this.center.distanceToSquared(e),n=t||new K.Vector3;return n.copy(e),r>this.radius*this.radius&&(n.sub(this.center).normalize(),n.multiplyScalar(this.radius).add(this.center)),n},getBoundingBox:function(e){var t=e||new K.Box3;return t.set(this.center,this.center),t.expandByScalar(this.radius),t},applyMatrix4:function(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this},translate:function(e){return this.center.add(e),this},equals:function(e){return e.center.equals(this.center)&&e.radius===this.radius},clone:function(){return(new K.Sphere).copy(this)}},K.Frustum=function(e,t,r,n,i,o){this.planes=[void 0!==e?e:new K.Plane,void 0!==t?t:new K.Plane,void 0!==r?r:new K.Plane,void 0!==n?n:new K.Plane,void 0!==i?i:new K.Plane,void 0!==o?o:new K.Plane]},K.Frustum.prototype={constructor:K.Frustum,set:function(e,t,r,n,i,o){var a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(r),a[3].copy(n),a[4].copy(i),a[5].copy(o),this},copy:function(e){for(var t=this.planes,r=0;r<6;r++)t[r].copy(e.planes[r]);return this},setFromMatrix:function(e){var t=this.planes,r=e.elements,n=r[0],i=r[1],o=r[2],a=r[3],s=r[4],l=r[5],u=r[6],c=r[7],h=r[8],d=r[9],f=r[10],p=r[11],m=r[12],g=r[13],v=r[14],y=r[15];return t[0].setComponents(a-n,c-s,p-h,y-m).normalize(),t[1].setComponents(a+n,c+s,p+h,y+m).normalize(),t[2].setComponents(a+i,c+l,p+d,y+g).normalize(),t[3].setComponents(a-i,c-l,p-d,y-g).normalize(),t[4].setComponents(a-o,c-u,p-f,y-v).normalize(),t[5].setComponents(a+o,c+u,p+f,y+v).normalize(),this},intersectsObject:(x=new K.Sphere,function(e){var t=e.geometry;return null===t.boundingSphere&&t.computeBoundingSphere(),x.copy(t.boundingSphere),x.applyMatrix4(e.matrixWorld),this.intersectsSphere(x)}),intersectsSphere:function(e){for(var t=this.planes,r=e.center,n=-e.radius,i=0;i<6;i++){if(t[i].distanceToPoint(r)<n)return!1}return!0},intersectsBox:(y=new K.Vector3,b=new K.Vector3,function(e){for(var t=this.planes,r=0;r<6;r++){var n=t[r];y.x=n.normal.x>0?e.min.x:e.max.x,b.x=n.normal.x>0?e.max.x:e.min.x,y.y=n.normal.y>0?e.min.y:e.max.y,b.y=n.normal.y>0?e.max.y:e.min.y,y.z=n.normal.z>0?e.min.z:e.max.z,b.z=n.normal.z>0?e.max.z:e.min.z;var i=n.distanceToPoint(y),o=n.distanceToPoint(b);if(i<0&&o<0)return!1}return!0}),containsPoint:function(e){for(var t=this.planes,r=0;r<6;r++)if(t[r].distanceToPoint(e)<0)return!1;return!0},clone:function(){return(new K.Frustum).copy(this)}},K.Plane=function(e,t){this.normal=void 0!==e?e:new K.Vector3(1,0,0),this.constant=void 0!==t?t:0},K.Plane.prototype={constructor:K.Plane,set:function(e,t){return this.normal.copy(e),this.constant=t,this},setComponents:function(e,t,r,n){return this.normal.set(e,t,r),this.constant=n,this},setFromNormalAndCoplanarPoint:function(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this},setFromCoplanarPoints:function(){var e=new K.Vector3,t=new K.Vector3;return function(r,n,i){var o=e.subVectors(i,n).cross(t.subVectors(r,n)).normalize();return this.setFromNormalAndCoplanarPoint(o,r),this}}(),copy:function(e){return this.normal.copy(e.normal),this.constant=e.constant,this},normalize:function(){var e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(e){return this.normal.dot(e)+this.constant},distanceToSphere:function(e){return this.distanceToPoint(e.center)-e.radius},projectPoint:function(e,t){return this.orthoPoint(e,t).sub(e).negate()},orthoPoint:function(e,t){var r=this.distanceToPoint(e);return(t||new K.Vector3).copy(this.normal).multiplyScalar(r)},isIntersectionLine:function(e){var t=this.distanceToPoint(e.start),r=this.distanceToPoint(e.end);return t<0&&r>0||r<0&&t>0},intersectLine:function(){var e=new K.Vector3;return function(t,r){var n=r||new K.Vector3,i=t.delta(e),o=this.normal.dot(i);if(0==o)return 0==this.distanceToPoint(t.start)?n.copy(t.start):void 0;var a=-(t.start.dot(this.normal)+this.constant)/o;return a<0||a>1?void 0:n.copy(i).multiplyScalar(a).add(t.start)}}(),coplanarPoint:function(e){return(e||new K.Vector3).copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var e=new K.Vector3,t=new K.Vector3,r=new K.Matrix3;return function(n,i){var o=i||r.getNormalMatrix(n),a=e.copy(this.normal).applyMatrix3(o);a.normalize();var s=this.coplanarPoint(t);return s.applyMatrix4(n),this.setFromNormalAndCoplanarPoint(a,s),this}}(),translate:function(e){return this.constant=this.constant-e.dot(this.normal),this},equals:function(e){return e.normal.equals(this.normal)&&e.constant==this.constant},clone:function(){return(new K.Plane).copy(this)}},K.Math={generateUUID:function(){var e,t="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),r=new Array(36),n=0;return function(){for(var i=0;i<36;i++)8==i||13==i||18==i||23==i?r[i]="-":14==i?r[i]="4":(n<=2&&(n=33554432+16777216*Math.random()|0),e=15&n,n>>=4,r[i]=t[19==i?3&e|8:e]);return r.join("")}}(),clamp:function(e,t,r){return e<t?t:e>r?r:e},clampBottom:function(e,t){return e<t?t:e},mapLinear:function(e,t,r,n,i){return n+(e-t)*(i-n)/(r-t)},smoothstep:function(e,t,r){return e<=t?0:e>=r?1:(e=(e-t)/(r-t))*e*(3-2*e)},smootherstep:function(e,t,r){return e<=t?0:e>=r?1:(e=(e-t)/(r-t))*e*e*(e*(6*e-15)+10)},random16:function(){return(65280*Math.random()+255*Math.random())/65535},randInt:function(e,t){return Math.floor(this.randFloat(e,t))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},degToRad:(E=Math.PI/180,function(e){return e*E}),radToDeg:(_=180/Math.PI,function(e){return e*_}),isPowerOfTwo:function(e){return 0==(e&e-1)&&0!==e},nextPowerOfTwo:function(e){return e--,e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,e|=e>>16,++e}},K.Spline=function(e){this.points=e;var t,r,n,i,o,a,s,l,u,c=[],h={x:0,y:0,z:0};function d(e,t,r,n,i,o,a){var s=.5*(r-e),l=.5*(n-t);return(2*(t-r)+s+l)*a+(-3*(t-r)-2*s-l)*o+s*i+t}this.initFromArray=function(e){this.points=[];for(var t=0;t<e.length;t++)this.points[t]={x:e[t][0],y:e[t][1],z:e[t][2]}},this.getPoint=function(e){return t=(this.points.length-1)*e,r=Math.floor(t),n=t-r,c[0]=0===r?r:r-1,c[1]=r,c[2]=r>this.points.length-2?this.points.length-1:r+1,c[3]=r>this.points.length-3?this.points.length-1:r+2,a=this.points[c[0]],s=this.points[c[1]],l=this.points[c[2]],u=this.points[c[3]],o=n*(i=n*n),h.x=d(a.x,s.x,l.x,u.x,n,i,o),h.y=d(a.y,s.y,l.y,u.y,n,i,o),h.z=d(a.z,s.z,l.z,u.z,n,i,o),h},this.getControlPointsArray=function(){var e,t,r=this.points.length,n=[];for(e=0;e<r;e++)t=this.points[e],n[e]=[t.x,t.y,t.z];return n},this.getLength=function(e){var t,r,n,i,o=0,a=0,s=0,l=new K.Vector3,u=new K.Vector3,c=[],h=0;for(c[0]=0,e||(e=100),n=this.points.length*e,l.copy(this.points[0]),t=1;t<n;t++)r=t/n,i=this.getPoint(r),u.copy(i),h+=u.distanceTo(l),l.copy(i),o=(this.points.length-1)*r,(a=Math.floor(o))!=s&&(c[a]=h,s=a);return c[c.length]=h,{chunks:c,total:h}},this.reparametrizeByArcLength=function(e){var t,r,n,i,o,a,s,l,u=[],c=new K.Vector3,h=this.getLength();for(u.push(c.copy(this.points[0]).clone()),t=1;t<this.points.length;t++){for(a=h.chunks[t]-h.chunks[t-1],s=Math.ceil(e*a/h.total),i=(t-1)/(this.points.length-1),o=t/(this.points.length-1),r=1;r<s-1;r++)n=i+r*(1/s)*(o-i),l=this.getPoint(n),u.push(c.copy(l).clone());u.push(c.copy(this.points[t]).clone())}this.points=u}},K.Triangle=function(e,t,r){this.a=void 0!==e?e:new K.Vector3,this.b=void 0!==t?t:new K.Vector3,this.c=void 0!==r?r:new K.Vector3},K.Triangle.normal=(w=new K.Vector3,function(e,t,r,n){var i=n||new K.Vector3;i.subVectors(r,t),w.subVectors(e,t),i.cross(w);var o=i.lengthSq();return o>0?i.multiplyScalar(1/Math.sqrt(o)):i.set(0,0,0)}),K.Triangle.barycoordFromPoint=function(){var e=new K.Vector3,t=new K.Vector3,r=new K.Vector3;return function(n,i,o,a,s){e.subVectors(a,i),t.subVectors(o,i),r.subVectors(n,i);var l=e.dot(e),u=e.dot(t),c=e.dot(r),h=t.dot(t),d=t.dot(r),f=l*h-u*u,p=s||new K.Vector3;if(0==f)return p.set(-2,-1,-1);var m=1/f,g=(h*c-u*d)*m,v=(l*d-u*c)*m;return p.set(1-g-v,v,g)}}(),K.Triangle.containsPoint=function(){var e=new K.Vector3;return function(t,r,n,i){var o=K.Triangle.barycoordFromPoint(t,r,n,i,e);return o.x>=0&&o.y>=0&&o.x+o.y<=1}}(),K.Triangle.prototype={constructor:K.Triangle,set:function(e,t,r){return this.a.copy(e),this.b.copy(t),this.c.copy(r),this},setFromPointsAndIndices:function(e,t,r,n){return this.a.copy(e[t]),this.b.copy(e[r]),this.c.copy(e[n]),this},copy:function(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this},area:function(){var e=new K.Vector3,t=new K.Vector3;return function(){return e.subVectors(this.c,this.b),t.subVectors(this.a,this.b),.5*e.cross(t).length()}}(),midpoint:function(e){return(e||new K.Vector3).addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},normal:function(e){return K.Triangle.normal(this.a,this.b,this.c,e)},plane:function(e){return(e||new K.Plane).setFromCoplanarPoints(this.a,this.b,this.c)},barycoordFromPoint:function(e,t){return K.Triangle.barycoordFromPoint(e,this.a,this.b,this.c,t)},containsPoint:function(e){return K.Triangle.containsPoint(e,this.a,this.b,this.c)},equals:function(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)},clone:function(){return(new K.Triangle).copy(this)}},K.Clock=function(e){this.autoStart=void 0===e||e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1},K.Clock.prototype={constructor:K.Clock,start:function(){this.startTime=void 0!==self.performance&&void 0!==self.performance.now?self.performance.now():Date.now(),this.oldTime=this.startTime,this.running=!0},stop:function(){this.getElapsedTime(),this.running=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var e=0;if(this.autoStart&&!this.running&&this.start(),this.running){var t=void 0!==self.performance&&void 0!==self.performance.now?self.performance.now():Date.now();e=.001*(t-this.oldTime),this.oldTime=t,this.elapsedTime+=e}return e}},K.EventDispatcher=function(){},K.EventDispatcher.prototype={constructor:K.EventDispatcher,apply:function(e){e.addEventListener=K.EventDispatcher.prototype.addEventListener,e.hasEventListener=K.EventDispatcher.prototype.hasEventListener,e.removeEventListener=K.EventDispatcher.prototype.removeEventListener,e.dispatchEvent=K.EventDispatcher.prototype.dispatchEvent},addEventListener:function(e,t){void 0===this._listeners&&(this._listeners={});var r=this._listeners;void 0===r[e]&&(r[e]=[]),-1===r[e].indexOf(t)&&r[e].push(t)},hasEventListener:function(e,t){if(void 0===this._listeners)return!1;var r=this._listeners;return void 0!==r[e]&&-1!==r[e].indexOf(t)},removeEventListener:function(e,t){if(void 0!==this._listeners){var r=this._listeners[e];if(void 0!==r){var n=r.indexOf(t);-1!==n&&r.splice(n,1)}}},dispatchEvent:function(e){if(void 0!==this._listeners){var t=this._listeners[e.type];if(void 0!==t){e.target=this;for(var r=[],n=t.length,i=0;i<n;i++)r[i]=t[i];for(i=0;i<n;i++)r[i].call(this,e)}}}},function(e){e.Raycaster=function(t,r,n,i){this.ray=new e.Ray(t,r),this.near=n||0,this.far=i||1/0,this.params={Sprite:{},Mesh:{},PointCloud:{threshold:1},LOD:{},Line:{threshold:1}}};var t=function(e,t){return e.distance-t.distance},r=function(e,t,n,i){if(e.raycast(t,n),!0===i)for(var o=e.children,a=0,s=o.length;a<s;a++)r(o[a],t,n,!0)};e.Raycaster.prototype={constructor:e.Raycaster,precision:1e-4,set:function(e,t){this.ray.set(e,t)},setFromCamera:function(t,r){r instanceof e.PerspectiveCamera?(this.ray.origin.copy(r.position),this.ray.direction.set(t.x,t.y,.5).unproject(r).sub(r.position).normalize()):r instanceof e.OrthographicCamera?(this.ray.origin.set(t.x,t.y,-1).unproject(r),this.ray.direction.set(0,0,-1).transformDirection(r.matrixWorld)):e.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(e,n){var i=[];return r(e,this,i,n),i.sort(t),i},intersectObjects:function(n,i){var o=[];if(n instanceof Array==!1)return e.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),o;for(var a=0,s=n.length;a<s;a++)r(n[a],this,o,i);return o.sort(t),o}},Object.defineProperty(e.Raycaster.prototype,"linePrecision",{get:function(){return console.warn("THREE.Raycaster: .linePrecision is now .params.Line.threshold."),this.params.Line.threshold},set:function(e){console.warn("THREE.Raycaster: .linePrecision is now .params.Line.threshold."),this.params.Line.threshold=e}})}(K),K.Object3D=function(){Object.defineProperty(this,"id",{value:K.Object3DIdCount++}),this.uuid=K.Math.generateUUID(),this.name="",this.type="Object3D",this.parent=void 0,this.children=[],this.up=K.Object3D.DefaultUp.clone();var e=new K.Vector3,t=new K.Euler,r=new K.Quaternion,n=new K.Vector3(1,1,1);t.onChange((function(){r.setFromEuler(t,!1)})),r.onChange((function(){t.setFromQuaternion(r,void 0,!1)})),Object.defineProperties(this,{position:{enumerable:!0,value:e},rotation:{enumerable:!0,value:t},quaternion:{enumerable:!0,value:r},scale:{enumerable:!0,value:n}}),this.rotationAutoUpdate=!0,this.matrix=new K.Matrix4,this.matrixWorld=new K.Matrix4,this.matrixAutoUpdate=!0,this.matrixWorldNeedsUpdate=!1,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}},K.Object3D.DefaultUp=new K.Vector3(0,1,0),K.Object3D.prototype={constructor:K.Object3D,get eulerOrder(){return K.warn("THREE.Object3D: .eulerOrder has been moved to .rotation.order."),this.rotation.order},set eulerOrder(e){K.warn("THREE.Object3D: .eulerOrder has been moved to .rotation.order."),this.rotation.order=e},get useQuaternion(){K.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set useQuaternion(e){K.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},applyMatrix:function(e){this.matrix.multiplyMatrices(e,this.matrix),this.matrix.decompose(this.position,this.quaternion,this.scale)},setRotationFromAxisAngle:function(e,t){this.quaternion.setFromAxisAngle(e,t)},setRotationFromEuler:function(e){this.quaternion.setFromEuler(e,!0)},setRotationFromMatrix:function(e){this.quaternion.setFromRotationMatrix(e)},setRotationFromQuaternion:function(e){this.quaternion.copy(e)},rotateOnAxis:(T=new K.Quaternion,function(e,t){return T.setFromAxisAngle(e,t),this.quaternion.multiply(T),this}),rotateX:function(){var e=new K.Vector3(1,0,0);return function(t){return this.rotateOnAxis(e,t)}}(),rotateY:function(){var e=new K.Vector3(0,1,0);return function(t){return this.rotateOnAxis(e,t)}}(),rotateZ:function(){var e=new K.Vector3(0,0,1);return function(t){return this.rotateOnAxis(e,t)}}(),translateOnAxis:function(){var e=new K.Vector3;return function(t,r){return e.copy(t).applyQuaternion(this.quaternion),this.position.add(e.multiplyScalar(r)),this}}(),translate:function(e,t){return K.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(t,e)},translateX:function(){var e=new K.Vector3(1,0,0);return function(t){return this.translateOnAxis(e,t)}}(),translateY:function(){var e=new K.Vector3(0,1,0);return function(t){return this.translateOnAxis(e,t)}}(),translateZ:function(){var e=new K.Vector3(0,0,1);return function(t){return this.translateOnAxis(e,t)}}(),localToWorld:function(e){return e.applyMatrix4(this.matrixWorld)},worldToLocal:(M=new K.Matrix4,function(e){return e.applyMatrix4(M.getInverse(this.matrixWorld))}),lookAt:function(){var e=new K.Matrix4;return function(t){e.lookAt(t,this.position,this.up),this.quaternion.setFromRotationMatrix(e)}}(),add:function(e){if(arguments.length>1){for(var t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(K.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e instanceof K.Object3D?(void 0!==e.parent&&e.parent.remove(e),e.parent=this,e.dispatchEvent({type:"added"}),this.children.push(e)):K.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)},remove:function(e){if(arguments.length>1)for(var t=0;t<arguments.length;t++)this.remove(arguments[t]);var r=this.children.indexOf(e);-1!==r&&(e.parent=void 0,e.dispatchEvent({type:"removed"}),this.children.splice(r,1))},getChildByName:function(e){return K.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(e)},getObjectById:function(e){return this.getObjectByProperty("id",e)},getObjectByName:function(e){return this.getObjectByProperty("name",e)},getObjectByProperty:function(e,t){if(this[e]===t)return this;for(var r=0,n=this.children.length;r<n;r++){var i=this.children[r].getObjectByProperty(e,t);if(void 0!==i)return i}},getWorldPosition:function(e){var t=e||new K.Vector3;return this.updateMatrixWorld(!0),t.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:(A=new K.Vector3,S=new K.Vector3,function(e){var t=e||new K.Quaternion;return this.updateMatrixWorld(!0),this.matrixWorld.decompose(A,t,S),t}),getWorldRotation:function(){var e=new K.Quaternion;return function(t){var r=t||new K.Euler;return this.getWorldQuaternion(e),r.setFromQuaternion(e,this.rotation.order,!1)}}(),getWorldScale:function(){var e=new K.Vector3,t=new K.Quaternion;return function(r){var n=r||new K.Vector3;return this.updateMatrixWorld(!0),this.matrixWorld.decompose(e,t,n),n}}(),getWorldDirection:function(){var e=new K.Quaternion;return function(t){var r=t||new K.Vector3;return this.getWorldQuaternion(e),r.set(0,0,1).applyQuaternion(e)}}(),raycast:function(){},traverse:function(e){e(this);for(var t=0,r=this.children.length;t<r;t++)this.children[t].traverse(e)},traverseVisible:function(e){if(!1!==this.visible){e(this);for(var t=0,r=this.children.length;t<r;t++)this.children[t].traverseVisible(e)}},traverseAncestors:function(e){this.parent&&(e(this.parent),this.parent.traverseAncestors(e))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(e){!0===this.matrixAutoUpdate&&this.updateMatrix(),!0!==this.matrixWorldNeedsUpdate&&!0!==e||(void 0===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);for(var t=0,r=this.children.length;t<r;t++)this.children[t].updateMatrixWorld(e)},toJSON:function(){var e={metadata:{version:4.3,type:"Object",generator:"ObjectExporter"}},t={},r={},n=function(t){if(void 0===e.materials&&(e.materials=[]),void 0===r[t.uuid]){var n=t.toJSON();delete n.metadata,r[t.uuid]=n,e.materials.push(n)}return t.uuid};return e.object=function r(i){var o={};if(o.uuid=i.uuid,o.type=i.type,""!==i.name&&(o.name=i.name),"{}"!==JSON.stringify(i.userData)&&(o.userData=i.userData),!0!==i.visible&&(o.visible=i.visible),i instanceof K.PerspectiveCamera?(o.fov=i.fov,o.aspect=i.aspect,o.near=i.near,o.far=i.far):i instanceof K.OrthographicCamera?(o.left=i.left,o.right=i.right,o.top=i.top,o.bottom=i.bottom,o.near=i.near,o.far=i.far):i instanceof K.AmbientLight?o.color=i.color.getHex():i instanceof K.DirectionalLight?(o.color=i.color.getHex(),o.intensity=i.intensity):i instanceof K.PointLight?(o.color=i.color.getHex(),o.intensity=i.intensity,o.distance=i.distance,o.decay=i.decay):i instanceof K.SpotLight?(o.color=i.color.getHex(),o.intensity=i.intensity,o.distance=i.distance,o.angle=i.angle,o.exponent=i.exponent,o.decay=i.decay):i instanceof K.HemisphereLight?(o.color=i.color.getHex(),o.groundColor=i.groundColor.getHex()):i instanceof K.Mesh||i instanceof K.Line||i instanceof K.PointCloud?(o.geometry=function(r){if(void 0===e.geometries&&(e.geometries=[]),void 0===t[r.uuid]){var n=r.toJSON();delete n.metadata,t[r.uuid]=n,e.geometries.push(n)}return r.uuid}(i.geometry),o.material=n(i.material),i instanceof K.Line&&(o.mode=i.mode)):i instanceof K.Sprite&&(o.material=n(i.material)),o.matrix=i.matrix.toArray(),i.children.length>0){o.children=[];for(var a=0;a<i.children.length;a++)o.children.push(r(i.children[a]))}return o}(this),e},clone:function(e,t){if(void 0===e&&(e=new K.Object3D),void 0===t&&(t=!0),e.name=this.name,e.up.copy(this.up),e.position.copy(this.position),e.quaternion.copy(this.quaternion),e.scale.copy(this.scale),e.rotationAutoUpdate=this.rotationAutoUpdate,e.matrix.copy(this.matrix),e.matrixWorld.copy(this.matrixWorld),e.matrixAutoUpdate=this.matrixAutoUpdate,e.matrixWorldNeedsUpdate=this.matrixWorldNeedsUpdate,e.visible=this.visible,e.castShadow=this.castShadow,e.receiveShadow=this.receiveShadow,e.frustumCulled=this.frustumCulled,e.userData=JSON.parse(JSON.stringify(this.userData)),!0===t)for(var r=0;r<this.children.length;r++){var n=this.children[r];e.add(n.clone())}return e}},K.EventDispatcher.prototype.apply(K.Object3D.prototype),K.Object3DIdCount=0,K.Face3=function(e,t,r,n,i,o){this.a=e,this.b=t,this.c=r,this.normal=n instanceof K.Vector3?n:new K.Vector3,this.vertexNormals=n instanceof Array?n:[],this.color=i instanceof K.Color?i:new K.Color,this.vertexColors=i instanceof Array?i:[],this.vertexTangents=[],this.materialIndex=void 0!==o?o:0},K.Face3.prototype={constructor:K.Face3,clone:function(){var e=new K.Face3(this.a,this.b,this.c);e.normal.copy(this.normal),e.color.copy(this.color),e.materialIndex=this.materialIndex;for(var t=0,r=this.vertexNormals.length;t<r;t++)e.vertexNormals[t]=this.vertexNormals[t].clone();for(t=0,r=this.vertexColors.length;t<r;t++)e.vertexColors[t]=this.vertexColors[t].clone();for(t=0,r=this.vertexTangents.length;t<r;t++)e.vertexTangents[t]=this.vertexTangents[t].clone();return e}},K.Face4=function(e,t,r,n,i,o,a){return K.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead."),new K.Face3(e,t,r,i,o,a)},K.BufferAttribute=function(e,t){this.array=e,this.itemSize=t,this.count=null!=e?e.length/t:0,this.needsUpdate=!1},K.BufferAttribute.prototype={constructor:K.BufferAttribute,get length(){return this.array.length},copyAt:function(e,t,r){e*=this.itemSize,r*=t.itemSize;for(var n=0,i=this.itemSize;n<i;n++)this.array[e+n]=t.array[r+n];return this},set:function(e,t){return void 0===t&&(t=0),this.array.set(e,t),this},setX:function(e,t){return this.array[e*this.itemSize]=t,this},setY:function(e,t){return this.array[e*this.itemSize+1]=t,this},setZ:function(e,t){return this.array[e*this.itemSize+2]=t,this},setXY:function(e,t,r){return e*=this.itemSize,this.array[e]=t,this.array[e+1]=r,this},setXYZ:function(e,t,r,n){return e*=this.itemSize,this.array[e]=t,this.array[e+1]=r,this.array[e+2]=n,this},setXYZW:function(e,t,r,n,i){return e*=this.itemSize,this.array[e]=t,this.array[e+1]=r,this.array[e+2]=n,this.array[e+3]=i,this},clone:function(){return new K.BufferAttribute(new this.array.constructor(this.array),this.itemSize)}},K.Int8Attribute=function(e,t){return K.warn("THREE.Int8Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead."),new K.BufferAttribute(e,t)},K.Uint8Attribute=function(e,t){return K.warn("THREE.Uint8Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead."),new K.BufferAttribute(e,t)},K.Uint8ClampedAttribute=function(e,t){return K.warn("THREE.Uint8ClampedAttribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead."),new K.BufferAttribute(e,t)},K.Int16Attribute=function(e,t){return K.warn("THREE.Int16Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead."),new K.BufferAttribute(e,t)},K.Uint16Attribute=function(e,t){return K.warn("THREE.Uint16Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead."),new K.BufferAttribute(e,t)},K.Int32Attribute=function(e,t){return K.warn("THREE.Int32Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead."),new K.BufferAttribute(e,t)},K.Uint32Attribute=function(e,t){return K.warn("THREE.Uint32Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead."),new K.BufferAttribute(e,t)},K.Float32Attribute=function(e,t){return K.warn("THREE.Float32Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead."),new K.BufferAttribute(e,t)},K.Float64Attribute=function(e,t){return K.warn("THREE.Float64Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead."),new K.BufferAttribute(e,t)},K.DynamicBufferAttribute=function(e,t){K.BufferAttribute.call(this,e,t),this.updateRange={offset:0,count:-1}},K.DynamicBufferAttribute.prototype=Object.create(K.BufferAttribute.prototype),K.DynamicBufferAttribute.prototype.constructor=K.DynamicBufferAttribute,K.DynamicBufferAttribute.prototype.clone=function(){return new K.DynamicBufferAttribute(new this.array.constructor(this.array),this.itemSize)},K.BufferGeometry=function(){Object.defineProperty(this,"id",{value:K.GeometryIdCount++}),this.uuid=K.Math.generateUUID(),this.name="",this.type="BufferGeometry",this.attributes={},this.attributesKeys=[],this.drawcalls=[],this.offsets=this.drawcalls,this.boundingBox=null,this.boundingSphere=null},K.BufferGeometry.prototype={constructor:K.BufferGeometry,addAttribute:function(e,t){console.warn("BufferGeometry.addAttribute() is deprecated. Use BufferGeometry.setAttribute() instead."),this.setAttribute(e,t)},setAttribute:function(e,t){if(t instanceof K.BufferAttribute==!1)return K.warn("THREE.BufferGeometry: .setAttribute() now expects ( name, attribute )."),void(this.attributes[e]={array:arguments[1],itemSize:arguments[2]});this.attributes[e]=t,this.attributesKeys=Object.keys(this.attributes)},getAttribute:function(e){return this.attributes[e]},addDrawCall:function(e,t,r){this.drawcalls.push({start:e,count:t,index:void 0!==r?r:0})},applyMatrix:function(e){var t=this.attributes.position;void 0!==t&&(e.applyToVector3Array(t.array),t.needsUpdate=!0);var r=this.attributes.normal;void 0!==r&&((new K.Matrix3).getNormalMatrix(e).applyToVector3Array(r.array),r.needsUpdate=!0);null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere()},center:function(){this.computeBoundingBox();var e=this.boundingBox.getCenter().negate();return this.applyMatrix((new K.Matrix4).setPosition(e)),e},fromGeometry:function(e,t){t=t||{vertexColors:K.NoColors};var r=e.vertices,n=e.faces,i=e.faceVertexUvs,o=t.vertexColors,a=i[0].length>0,s=3==n[0].vertexNormals.length,l=new Float32Array(3*n.length*3);this.setAttribute("position",new K.BufferAttribute(l,3));var u=new Float32Array(3*n.length*3);if(this.setAttribute("normal",new K.BufferAttribute(u,3)),o!==K.NoColors){var c=new Float32Array(3*n.length*3);this.setAttribute("color",new K.BufferAttribute(c,3))}if(!0===a){var h=new Float32Array(3*n.length*2);this.setAttribute("uv",new K.BufferAttribute(h,2))}for(var d=0,f=0,p=0;d<n.length;d++,f+=6,p+=9){var m=n[d],g=r[m.a],v=r[m.b],y=r[m.c];if(l[p]=g.x,l[p+1]=g.y,l[p+2]=g.z,l[p+3]=v.x,l[p+4]=v.y,l[p+5]=v.z,l[p+6]=y.x,l[p+7]=y.y,l[p+8]=y.z,!0===s){var b=m.vertexNormals[0],x=m.vertexNormals[1],_=m.vertexNormals[2];u[p]=b.x,u[p+1]=b.y,u[p+2]=b.z,u[p+3]=x.x,u[p+4]=x.y,u[p+5]=x.z,u[p+6]=_.x,u[p+7]=_.y,u[p+8]=_.z}else{var E=m.normal;u[p]=E.x,u[p+1]=E.y,u[p+2]=E.z,u[p+3]=E.x,u[p+4]=E.y,u[p+5]=E.z,u[p+6]=E.x,u[p+7]=E.y,u[p+8]=E.z}if(o===K.FaceColors){var w=m.color;c[p]=w.r,c[p+1]=w.g,c[p+2]=w.b,c[p+3]=w.r,c[p+4]=w.g,c[p+5]=w.b,c[p+6]=w.r,c[p+7]=w.g,c[p+8]=w.b}else if(o===K.VertexColors){var A=m.vertexColors[0],S=m.vertexColors[1],M=m.vertexColors[2];c[p]=A.r,c[p+1]=A.g,c[p+2]=A.b,c[p+3]=S.r,c[p+4]=S.g,c[p+5]=S.b,c[p+6]=M.r,c[p+7]=M.g,c[p+8]=M.b}if(!0===a){var T=i[0][d][0],C=i[0][d][1],P=i[0][d][2];h[f]=T.x,h[f+1]=T.y,h[f+2]=C.x,h[f+3]=C.y,h[f+4]=P.x,h[f+5]=P.y}}return this.computeBoundingSphere(),this},computeBoundingBox:function(){var e=new K.Vector3;return function(){null===this.boundingBox&&(this.boundingBox=new K.Box3);var t=this.attributes.position.array;if(t){var r=this.boundingBox;r.makeEmpty();for(var n=0,i=t.length;n<i;n+=3)e.set(t[n],t[n+1],t[n+2]),r.expandByPoint(e)}void 0!==t&&0!==t.length||(this.boundingBox.min.set(0,0,0),this.boundingBox.max.set(0,0,0)),(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&K.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.')}}(),computeBoundingSphere:function(){var e=new K.Box3,t=new K.Vector3;return function(){null===this.boundingSphere&&(this.boundingSphere=new K.Sphere);var r=this.attributes.position.array;if(r){e.makeEmpty();for(var n=this.boundingSphere.center,i=0,o=r.length;i<o;i+=3)t.set(r[i],r[i+1],r[i+2]),e.expandByPoint(t);e.getCenter(n);var a=0;for(i=0,o=r.length;i<o;i+=3)t.set(r[i],r[i+1],r[i+2]),a=Math.max(a,n.distanceToSquared(t));this.boundingSphere.radius=Math.sqrt(a),isNaN(this.boundingSphere.radius)&&K.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.')}}}(),computeFaceNormals:function(){},computeVertexNormals:function(){var e=this.attributes;if(e.position){var t=e.position.array;if(void 0===e.normal)this.setAttribute("normal",new K.BufferAttribute(new Float32Array(t.length),3));else for(var r=0,n=(s=e.normal.array).length;r<n;r++)s[r]=0;var i,o,a,s=e.normal.array,l=new K.Vector3,u=new K.Vector3,c=new K.Vector3,h=new K.Vector3,d=new K.Vector3;if(e.index)for(var f=e.index.array,p=this.offsets.length>0?this.offsets:[{start:0,count:f.length,index:0}],m=0,g=p.length;m<g;++m){var v=p[m].start,y=p[m].count,b=p[m].index;for(r=v,n=v+y;r<n;r+=3)i=3*(b+f[r]),o=3*(b+f[r+1]),a=3*(b+f[r+2]),l.fromArray(t,i),u.fromArray(t,o),c.fromArray(t,a),h.subVectors(c,u),d.subVectors(l,u),h.cross(d),s[i]+=h.x,s[i+1]+=h.y,s[i+2]+=h.z,s[o]+=h.x,s[o+1]+=h.y,s[o+2]+=h.z,s[a]+=h.x,s[a+1]+=h.y,s[a+2]+=h.z}else for(r=0,n=t.length;r<n;r+=9)l.fromArray(t,r),u.fromArray(t,r+3),c.fromArray(t,r+6),h.subVectors(c,u),d.subVectors(l,u),h.cross(d),s[r]=h.x,s[r+1]=h.y,s[r+2]=h.z,s[r+3]=h.x,s[r+4]=h.y,s[r+5]=h.z,s[r+6]=h.x,s[r+7]=h.y,s[r+8]=h.z;this.normalizeNormals(),e.normal.needsUpdate=!0}},computeTangents:function(){if(void 0!==this.attributes.index&&void 0!==this.attributes.position&&void 0!==this.attributes.normal&&void 0!==this.attributes.uv){var e=this.attributes.index.array,t=this.attributes.position.array,r=this.attributes.normal.array,n=this.attributes.uv.array,i=t.length/3;void 0===this.attributes.tangent&&this.setAttribute("tangent",new K.BufferAttribute(new Float32Array(4*i),4));for(var o=this.attributes.tangent.array,a=[],s=[],l=0;l<i;l++)a[l]=new K.Vector3,s[l]=new K.Vector3;var u,c,h,d,f,p,m,g,v,y,b,x,_,E,w,A,S,M,T=new K.Vector3,C=new K.Vector3,P=new K.Vector3,D=new K.Vector2,L=new K.Vector2,R=new K.Vector2,I=new K.Vector3,O=new K.Vector3;0===this.drawcalls.length&&this.addDrawCall(0,e.length,0);var N,k,F,V=this.drawcalls;for(E=0,w=V.length;E<w;++E){var U=V[E].start,B=V[E].count,z=V[E].index;for(x=U,_=U+B;x<_;x+=3)A=z+e[x],S=z+e[x+1],M=z+e[x+2],N=A,k=S,F=M,T.fromArray(t,3*N),C.fromArray(t,3*k),P.fromArray(t,3*F),D.fromArray(n,2*N),L.fromArray(n,2*k),R.fromArray(n,2*F),u=C.x-T.x,c=P.x-T.x,h=C.y-T.y,d=P.y-T.y,f=C.z-T.z,p=P.z-T.z,m=L.x-D.x,g=R.x-D.x,v=L.y-D.y,y=R.y-D.y,b=1/(m*y-g*v),I.set((y*u-v*c)*b,(y*h-v*d)*b,(y*f-v*p)*b),O.set((m*c-g*u)*b,(m*d-g*h)*b,(m*p-g*f)*b),a[N].add(I),a[k].add(I),a[F].add(I),s[N].add(O),s[k].add(O),s[F].add(O)}var G,H,W,j=new K.Vector3,q=new K.Vector3,X=new K.Vector3,Y=new K.Vector3;for(E=0,w=V.length;E<w;++E){U=V[E].start,B=V[E].count,z=V[E].index;for(x=U,_=U+B;x<_;x+=3)A=z+e[x],S=z+e[x+1],M=z+e[x+2],Z(A),Z(S),Z(M)}}else K.warn("THREE.BufferGeometry: Missing required attributes (index, position, normal or uv) in BufferGeometry.computeTangents()");function Z(e){X.fromArray(r,3*e),Y.copy(X),H=a[e],j.copy(H),j.sub(X.multiplyScalar(X.dot(H))).normalize(),q.crossVectors(Y,H),W=q.dot(s[e]),G=W<0?-1:1,o[4*e]=j.x,o[4*e+1]=j.y,o[4*e+2]=j.z,o[4*e+3]=G}},computeOffsets:function(e){void 0===e&&(e=65535);for(var t=this.attributes.index.array,r=this.attributes.position.array,n=t.length/3,i=new Uint16Array(t.length),o=0,a=0,s=[{start:0,count:0,index:0}],l=s[0],u=0,c=new Int32Array(6),h=new Int32Array(r.length),d=new Int32Array(r.length),f=0;f<r.length;f++)h[f]=-1,d[f]=-1;for(var p=0;p<n;p++){u=0;for(var m=0;m<3;m++){-1==h[b=t[3*p+m]]?(c[2*m]=b,c[2*m+1]=-1,u++):h[b]<l.index?(c[2*m]=b,c[2*m+1]=-1):(c[2*m]=b,c[2*m+1]=h[b])}if(a+u>l.index+e){var g={start:o,count:0,index:a};s.push(g),l=g;for(var v=0;v<6;v+=2){(y=c[v+1])>-1&&y<l.index&&(c[v+1]=-1)}}for(v=0;v<6;v+=2){var y,b=c[v];-1===(y=c[v+1])&&(y=a++),h[b]=y,d[y]=b,i[o++]=y-l.index,l.count++}}return this.reorderBuffers(i,d,a),this.offsets=s,this.drawcalls=s,s},merge:function(e,t){if(e instanceof K.BufferGeometry!=!1){void 0===t&&(t=0);var r=this.attributes;for(var n in r)if(void 0!==e.attributes[n])for(var i=r[n].array,o=e.attributes[n],a=o.array,s=0,l=o.itemSize*t;s<a.length;s++,l++)i[l]=a[s];return this}K.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",e)},normalizeNormals:function(){for(var e,t,r,n,i=this.attributes.normal.array,o=0,a=i.length;o<a;o+=3)e=i[o],t=i[o+1],r=i[o+2],n=1/Math.sqrt(e*e+t*t+r*r),i[o]*=n,i[o+1]*=n,i[o+2]*=n},reorderBuffers:function(e,t,r){var n={};for(var i in this.attributes)if("index"!=i){var o=this.attributes[i].array;n[i]=new o.constructor(this.attributes[i].itemSize*r)}for(var a=0;a<r;a++){var s=t[a];for(var i in this.attributes)if("index"!=i)for(var l=this.attributes[i].array,u=this.attributes[i].itemSize,c=n[i],h=0;h<u;h++)c[a*u+h]=l[s*u+h]}for(var i in this.attributes.index.array=e,this.attributes)"index"!=i&&(this.attributes[i].array=n[i],this.attributes[i].numItems=this.attributes[i].itemSize*r)},toJSON:function(){var e={metadata:{version:4,type:"BufferGeometry",generator:"BufferGeometryExporter"},uuid:this.uuid,type:this.type,data:{attributes:{}}},t=this.attributes,r=this.offsets,n=this.boundingSphere;for(var i in t){var o=t[i],a=Array.prototype.slice.call(o.array);e.data.attributes[i]={itemSize:o.itemSize,type:o.array.constructor.name,array:a}}return r.length>0&&(e.data.offsets=JSON.parse(JSON.stringify(r))),null!==n&&(e.data.boundingSphere={center:n.center.toArray(),radius:n.radius}),e},clone:function(){var e=new K.BufferGeometry;for(var t in this.attributes){var r=this.attributes[t];e.setAttribute(t,r.clone())}for(var n=0,i=this.offsets.length;n<i;n++){var o=this.offsets[n];e.offsets.push({start:o.start,index:o.index,count:o.count})}return e},dispose:function(){this.dispatchEvent({type:"dispose"})}},K.EventDispatcher.prototype.apply(K.BufferGeometry.prototype),K.Geometry=function(){Object.defineProperty(this,"id",{value:K.GeometryIdCount++}),this.uuid=K.Math.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphColors=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.hasTangents=!1,this.dynamic=!0,this.verticesNeedUpdate=!1,this.elementsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.tangentsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1},K.Geometry.prototype={constructor:K.Geometry,applyMatrix:function(e){for(var t=(new K.Matrix3).getNormalMatrix(e),r=0,n=this.vertices.length;r<n;r++){this.vertices[r].applyMatrix4(e)}for(r=0,n=this.faces.length;r<n;r++){var i=this.faces[r];i.normal.applyMatrix3(t).normalize();for(var o=0,a=i.vertexNormals.length;o<a;o++)i.vertexNormals[o].applyMatrix3(t).normalize()}null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0},fromBufferGeometry:function(e){for(var t=this,r=e.attributes,n=r.position.array,i=void 0!==r.index?r.index.array:void 0,o=void 0!==r.normal?r.normal.array:void 0,a=void 0!==r.color?r.color.array:void 0,s=void 0!==r.uv?r.uv.array:void 0,l=[],u=[],c=0,h=0;c<n.length;c+=3,h+=2)t.vertices.push(new K.Vector3(n[c],n[c+1],n[c+2])),void 0!==o&&l.push(new K.Vector3(o[c],o[c+1],o[c+2])),void 0!==a&&t.colors.push(new K.Color(a[c],a[c+1],a[c+2])),void 0!==s&&u.push(new K.Vector2(s[h],s[h+1]));var d=function(e,r,n){var i=void 0!==o?[l[e].clone(),l[r].clone(),l[n].clone()]:[],c=void 0!==a?[t.colors[e].clone(),t.colors[r].clone(),t.colors[n].clone()]:[];t.faces.push(new K.Face3(e,r,n,i,c)),void 0!==s&&t.faceVertexUvs[0].push([u[e].clone(),u[r].clone(),u[n].clone()])};if(void 0!==i){var f=e.drawcalls;if(f.length>0)for(c=0;c<f.length;c++)for(var p=f[c],m=p.start,g=p.count,v=p.index,y=(h=m,m+g);h<y;h+=3)d(v+i[h],v+i[h+1],v+i[h+2]);else for(c=0;c<i.length;c+=3)d(i[c],i[c+1],i[c+2])}else for(c=0;c<n.length/3;c+=3)d(c,c+1,c+2);return this.computeFaceNormals(),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this},center:function(){this.computeBoundingBox();var e=this.boundingBox.getCenter().negate();return this.applyMatrix((new K.Matrix4).setPosition(e)),e},computeFaceNormals:function(){for(var e=new K.Vector3,t=new K.Vector3,r=0,n=this.faces.length;r<n;r++){var i=this.faces[r],o=this.vertices[i.a],a=this.vertices[i.b],s=this.vertices[i.c];e.subVectors(s,a),t.subVectors(o,a),e.cross(t),e.normalize(),i.normal.copy(e)}},computeVertexNormals:function(e){var t,r,n,i,o,a;for(a=new Array(this.vertices.length),t=0,r=this.vertices.length;t<r;t++)a[t]=new K.Vector3;if(e){var s,l,u,c=new K.Vector3,h=new K.Vector3;for(n=0,i=this.faces.length;n<i;n++)o=this.faces[n],s=this.vertices[o.a],l=this.vertices[o.b],u=this.vertices[o.c],c.subVectors(u,l),h.subVectors(s,l),c.cross(h),a[o.a].add(c),a[o.b].add(c),a[o.c].add(c)}else for(n=0,i=this.faces.length;n<i;n++)a[(o=this.faces[n]).a].add(o.normal),a[o.b].add(o.normal),a[o.c].add(o.normal);for(t=0,r=this.vertices.length;t<r;t++)a[t].normalize();for(n=0,i=this.faces.length;n<i;n++)(o=this.faces[n]).vertexNormals[0]=a[o.a].clone(),o.vertexNormals[1]=a[o.b].clone(),o.vertexNormals[2]=a[o.c].clone()},computeMorphNormals:function(){var e,t,r,n,i;for(r=0,n=this.faces.length;r<n;r++)for((i=this.faces[r]).__originalFaceNormal?i.__originalFaceNormal.copy(i.normal):i.__originalFaceNormal=i.normal.clone(),i.__originalVertexNormals||(i.__originalVertexNormals=[]),e=0,t=i.vertexNormals.length;e<t;e++)i.__originalVertexNormals[e]?i.__originalVertexNormals[e].copy(i.vertexNormals[e]):i.__originalVertexNormals[e]=i.vertexNormals[e].clone();var o=new K.Geometry;for(o.faces=this.faces,e=0,t=this.morphTargets.length;e<t;e++){if(!this.morphNormals[e]){this.morphNormals[e]={},this.morphNormals[e].faceNormals=[],this.morphNormals[e].vertexNormals=[];var a=this.morphNormals[e].faceNormals,s=this.morphNormals[e].vertexNormals;for(r=0,n=this.faces.length;r<n;r++)l=new K.Vector3,u={a:new K.Vector3,b:new K.Vector3,c:new K.Vector3},a.push(l),s.push(u)}var l,u,c=this.morphNormals[e];for(o.vertices=this.morphTargets[e].vertices,o.computeFaceNormals(),o.computeVertexNormals(),r=0,n=this.faces.length;r<n;r++)i=this.faces[r],l=c.faceNormals[r],u=c.vertexNormals[r],l.copy(i.normal),u.a.copy(i.vertexNormals[0]),u.b.copy(i.vertexNormals[1]),u.c.copy(i.vertexNormals[2])}for(r=0,n=this.faces.length;r<n;r++)(i=this.faces[r]).normal=i.__originalFaceNormal,i.vertexNormals=i.__originalVertexNormals},computeTangents:function(){var e,t,r,n,i,o,a,s,l,u,c,h,d,f,p,m,g,v,y,b,x,_,E,w,A,S,M,T,C,P,D,L,R,I,O=[],N=[],k=new K.Vector3,F=new K.Vector3,V=new K.Vector3,U=new K.Vector3,B=new K.Vector3;for(r=0,n=this.vertices.length;r<n;r++)O[r]=new K.Vector3,N[r]=new K.Vector3;for(e=0,t=this.faces.length;e<t;e++)a=this.faces[e],s=this.faceVertexUvs[0][e],T=this,C=a.a,P=a.b,D=a.c,L=0,R=1,I=2,l=T.vertices[C],u=T.vertices[P],c=T.vertices[D],h=s[L],d=s[R],f=s[I],p=u.x-l.x,m=c.x-l.x,g=u.y-l.y,v=c.y-l.y,y=u.z-l.z,b=c.z-l.z,x=d.x-h.x,_=f.x-h.x,E=d.y-h.y,w=f.y-h.y,A=1/(x*w-_*E),k.set((w*p-E*m)*A,(w*g-E*v)*A,(w*y-E*b)*A),F.set((x*m-_*p)*A,(x*v-_*g)*A,(x*b-_*y)*A),O[C].add(k),O[P].add(k),O[D].add(k),N[C].add(F),N[P].add(F),N[D].add(F);var z=["a","b","c","d"];for(e=0,t=this.faces.length;e<t;e++)for(a=this.faces[e],i=0;i<Math.min(a.vertexNormals.length,3);i++)B.copy(a.vertexNormals[i]),o=a[z[i]],S=O[o],V.copy(S),V.sub(B.multiplyScalar(B.dot(S))).normalize(),U.crossVectors(a.vertexNormals[i],S),M=U.dot(N[o])<0?-1:1,a.vertexTangents[i]=new K.Vector4(V.x,V.y,V.z,M);this.hasTangents=!0},computeLineDistances:function(){for(var e=0,t=this.vertices,r=0,n=t.length;r<n;r++)r>0&&(e+=t[r].distanceTo(t[r-1])),this.lineDistances[r]=e},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new K.Box3),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new K.Sphere),this.boundingSphere.setFromPoints(this.vertices)},merge:function(e,t,r){if(e instanceof K.Geometry!=!1){var n,i=this.vertices.length,o=this.vertices,a=e.vertices,s=this.faces,l=e.faces,u=this.faceVertexUvs[0],c=e.faceVertexUvs[0];void 0===r&&(r=0),void 0!==t&&(n=(new K.Matrix3).getNormalMatrix(t));for(var h=0,d=a.length;h<d;h++){var f=a[h].clone();void 0!==t&&f.applyMatrix4(t),o.push(f)}for(h=0,d=l.length;h<d;h++){var p,m,g,v=l[h],y=v.vertexNormals,b=v.vertexColors;(p=new K.Face3(v.a+i,v.b+i,v.c+i)).normal.copy(v.normal),void 0!==n&&p.normal.applyMatrix3(n).normalize();for(var x=0,_=y.length;x<_;x++)m=y[x].clone(),void 0!==n&&m.applyMatrix3(n).normalize(),p.vertexNormals.push(m);p.color.copy(v.color);for(x=0,_=b.length;x<_;x++)g=b[x],p.vertexColors.push(g.clone());p.materialIndex=v.materialIndex+r,s.push(p)}for(h=0,d=c.length;h<d;h++){var E=c[h],w=[];if(void 0!==E){for(x=0,_=E.length;x<_;x++)w.push(E[x].clone());u.push(w)}}}else K.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",e)},mergeMesh:function(e){e instanceof K.Mesh!=!1?(e.matrixAutoUpdate&&e.updateMatrix(),this.merge(e.geometry,e.matrix)):K.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",e)},mergeVertices:function(){var e,t,r,n,i,o,a,s,l={},u=[],c=[],h=Math.pow(10,4);for(r=0,n=this.vertices.length;r<n;r++)e=this.vertices[r],void 0===l[t=Math.round(e.x*h)+"_"+Math.round(e.y*h)+"_"+Math.round(e.z*h)]?(l[t]=r,u.push(this.vertices[r]),c[r]=u.length-1):c[r]=c[l[t]];var d=[];for(r=0,n=this.faces.length;r<n;r++){(i=this.faces[r]).a=c[i.a],i.b=c[i.b],i.c=c[i.c],o=[i.a,i.b,i.c];for(var f=0;f<3;f++)if(o[f]==o[(f+1)%3]){f,d.push(r);break}}for(r=d.length-1;r>=0;r--){var p=d[r];for(this.faces.splice(p,1),a=0,s=this.faceVertexUvs.length;a<s;a++)this.faceVertexUvs[a].splice(p,1)}var m=this.vertices.length-u.length;return this.vertices=u,m},toJSON:function(){var e={metadata:{version:4,type:"BufferGeometry",generator:"BufferGeometryExporter"},uuid:this.uuid,type:this.type};if(""!==this.name&&(e.name=this.name),void 0!==this.parameters){var t=this.parameters;for(var r in t)void 0!==t[r]&&(e[r]=t[r]);return e}for(var n=[],i=0;i<this.vertices.length;i++){var o=this.vertices[i];n.push(o.x,o.y,o.z)}var a=[],s=[],l={},u=[],c={},h=[],d={};for(i=0;i<this.faces.length;i++){var f=this.faces[i],p=void 0!==this.faceVertexUvs[0][i],m=f.normal.length()>0,g=f.vertexNormals.length>0,v=1!==f.color.r||1!==f.color.g||1!==f.color.b,y=f.vertexColors.length>0,b=0;if(b=w(b,0,0),b=w(b,1,!1),b=w(b,2,!1),b=w(b,3,p),b=w(b,4,m),b=w(b,5,g),b=w(b,6,v),b=w(b,7,y),a.push(b),a.push(f.a,f.b,f.c),p){var x=this.faceVertexUvs[0][i];a.push(M(x[0]),M(x[1]),M(x[2]))}if(m&&a.push(A(f.normal)),g){var _=f.vertexNormals;a.push(A(_[0]),A(_[1]),A(_[2]))}if(v&&a.push(S(f.color)),y){var E=f.vertexColors;a.push(S(E[0]),S(E[1]),S(E[2]))}}function w(e,t,r){return r?e|1<<t:e&~(1<<t)}function A(e){var t=e.x.toString()+e.y.toString()+e.z.toString();return void 0!==l[t]||(l[t]=s.length/3,s.push(e.x,e.y,e.z)),l[t]}function S(e){var t=e.r.toString()+e.g.toString()+e.b.toString();return void 0!==c[t]||(c[t]=u.length,u.push(e.getHex())),c[t]}function M(e){var t=e.x.toString()+e.y.toString();return void 0!==d[t]||(d[t]=h.length/2,h.push(e.x,e.y)),d[t]}return e.data={},e.data.vertices=n,e.data.normals=s,u.length>0&&(e.data.colors=u),h.length>0&&(e.data.uvs=[h]),e.data.faces=a,e},clone:function(){for(var e=new K.Geometry,t=this.vertices,r=0,n=t.length;r<n;r++)e.vertices.push(t[r].clone());var i=this.faces;for(r=0,n=i.length;r<n;r++)e.faces.push(i[r].clone());for(r=0,n=this.faceVertexUvs.length;r<n;r++){var o=this.faceVertexUvs[r];void 0===e.faceVertexUvs[r]&&(e.faceVertexUvs[r]=[]);for(var a=0,s=o.length;a<s;a++){for(var l=o[a],u=[],c=0,h=l.length;c<h;c++){var d=l[c];u.push(d.clone())}e.faceVertexUvs[r].push(u)}}return e},dispose:function(){this.dispatchEvent({type:"dispose"})}},K.EventDispatcher.prototype.apply(K.Geometry.prototype),K.GeometryIdCount=0,K.Camera=function(){K.Object3D.call(this),this.type="Camera",this.matrixWorldInverse=new K.Matrix4,this.projectionMatrix=new K.Matrix4},K.Camera.prototype=Object.create(K.Object3D.prototype),K.Camera.prototype.constructor=K.Camera,K.Camera.prototype.getWorldDirection=function(){var e=new K.Quaternion;return function(t){var r=t||new K.Vector3;return this.getWorldQuaternion(e),r.set(0,0,-1).applyQuaternion(e)}}(),K.Camera.prototype.lookAt=function(){var e=new K.Matrix4;return function(t){e.lookAt(this.position,t,this.up),this.quaternion.setFromRotationMatrix(e)}}(),K.Camera.prototype.clone=function(e){return void 0===e&&(e=new K.Camera),K.Object3D.prototype.clone.call(this,e),e.matrixWorldInverse.copy(this.matrixWorldInverse),e.projectionMatrix.copy(this.projectionMatrix),e},K.CubeCamera=function(e,t,r){K.Object3D.call(this),this.type="CubeCamera";var n=90,i=new K.PerspectiveCamera(n,1,e,t);i.up.set(0,-1,0),i.lookAt(new K.Vector3(1,0,0)),this.add(i);var o=new K.PerspectiveCamera(n,1,e,t);o.up.set(0,-1,0),o.lookAt(new K.Vector3(-1,0,0)),this.add(o);var a=new K.PerspectiveCamera(n,1,e,t);a.up.set(0,0,1),a.lookAt(new K.Vector3(0,1,0)),this.add(a);var s=new K.PerspectiveCamera(n,1,e,t);s.up.set(0,0,-1),s.lookAt(new K.Vector3(0,-1,0)),this.add(s);var l=new K.PerspectiveCamera(n,1,e,t);l.up.set(0,-1,0),l.lookAt(new K.Vector3(0,0,1)),this.add(l);var u=new K.PerspectiveCamera(n,1,e,t);u.up.set(0,-1,0),u.lookAt(new K.Vector3(0,0,-1)),this.add(u),this.renderTarget=new K.WebGLRenderTargetCube(r,r,{format:K.RGBFormat,magFilter:K.LinearFilter,minFilter:K.LinearFilter}),this.updateCubeMap=function(e,t){var r=this.renderTarget,n=r.generateMipmaps;r.generateMipmaps=!1,r.activeCubeFace=0,e.render(t,i,r),r.activeCubeFace=1,e.render(t,o,r),r.activeCubeFace=2,e.render(t,a,r),r.activeCubeFace=3,e.render(t,s,r),r.activeCubeFace=4,e.render(t,l,r),r.generateMipmaps=n,r.activeCubeFace=5,e.render(t,u,r)}},K.CubeCamera.prototype=Object.create(K.Object3D.prototype),K.CubeCamera.prototype.constructor=K.CubeCamera,K.OrthographicCamera=function(e,t,r,n,i,o){K.Camera.call(this),this.type="OrthographicCamera",this.zoom=1,this.left=e,this.right=t,this.top=r,this.bottom=n,this.near=void 0!==i?i:.1,this.far=void 0!==o?o:2e3,this.updateProjectionMatrix()},K.OrthographicCamera.prototype=Object.create(K.Camera.prototype),K.OrthographicCamera.prototype.constructor=K.OrthographicCamera,K.OrthographicCamera.prototype.updateProjectionMatrix=function(){var e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),r=(this.right+this.left)/2,n=(this.top+this.bottom)/2;this.projectionMatrix.makeOrthographic(r-e,r+e,n+t,n-t,this.near,this.far)},K.OrthographicCamera.prototype.clone=function(){var e=new K.OrthographicCamera;return K.Camera.prototype.clone.call(this,e),e.zoom=this.zoom,e.left=this.left,e.right=this.right,e.top=this.top,e.bottom=this.bottom,e.near=this.near,e.far=this.far,e.projectionMatrix.copy(this.projectionMatrix),e},K.PerspectiveCamera=function(e,t,r,n){K.Camera.call(this),this.type="PerspectiveCamera",this.zoom=1,this.fov=void 0!==e?e:50,this.aspect=void 0!==t?t:1,this.near=void 0!==r?r:.1,this.far=void 0!==n?n:2e3,this.updateProjectionMatrix()},K.PerspectiveCamera.prototype=Object.create(K.Camera.prototype),K.PerspectiveCamera.prototype.constructor=K.PerspectiveCamera,K.PerspectiveCamera.prototype.setLens=function(e,t){void 0===t&&(t=24),this.fov=2*K.Math.radToDeg(Math.atan(t/(2*e))),this.updateProjectionMatrix()},K.PerspectiveCamera.prototype.setViewOffset=function(e,t,r,n,i,o){this.fullWidth=e,this.fullHeight=t,this.x=r,this.y=n,this.width=i,this.height=o,this.updateProjectionMatrix()},K.PerspectiveCamera.prototype.updateProjectionMatrix=function(){var e=K.Math.radToDeg(2*Math.atan(Math.tan(.5*K.Math.degToRad(this.fov))/this.zoom));if(this.fullWidth){var t=this.fullWidth/this.fullHeight,r=Math.tan(K.Math.degToRad(.5*e))*this.near,n=-r,i=t*n,o=t*r,a=Math.abs(o-i),s=Math.abs(r-n);this.projectionMatrix.makeFrustum(i+this.x*a/this.fullWidth,i+(this.x+this.width)*a/this.fullWidth,r-(this.y+this.height)*s/this.fullHeight,r-this.y*s/this.fullHeight,this.near,this.far)}else this.projectionMatrix.makePerspective(e,this.aspect,this.near,this.far)},K.PerspectiveCamera.prototype.clone=function(){var e=new K.PerspectiveCamera;return K.Camera.prototype.clone.call(this,e),e.zoom=this.zoom,e.fov=this.fov,e.aspect=this.aspect,e.near=this.near,e.far=this.far,e.projectionMatrix.copy(this.projectionMatrix),e},K.Light=function(e){K.Object3D.call(this),this.type="Light",this.color=new K.Color(e)},K.Light.prototype=Object.create(K.Object3D.prototype),K.Light.prototype.constructor=K.Light,K.Light.prototype.clone=function(e){return void 0===e&&(e=new K.Light),K.Object3D.prototype.clone.call(this,e),e.color.copy(this.color),e},K.AmbientLight=function(e){K.Light.call(this,e),this.type="AmbientLight"},K.AmbientLight.prototype=Object.create(K.Light.prototype),K.AmbientLight.prototype.constructor=K.AmbientLight,K.AmbientLight.prototype.clone=function(){var e=new K.AmbientLight;return K.Light.prototype.clone.call(this,e),e},K.AreaLight=function(e,t){K.Light.call(this,e),this.type="AreaLight",this.normal=new K.Vector3(0,-1,0),this.right=new K.Vector3(1,0,0),this.intensity=void 0!==t?t:1,this.width=1,this.height=1,this.constantAttenuation=1.5,this.linearAttenuation=.5,this.quadraticAttenuation=.1},K.AreaLight.prototype=Object.create(K.Light.prototype),K.AreaLight.prototype.constructor=K.AreaLight,K.DirectionalLight=function(e,t){K.Light.call(this,e),this.type="DirectionalLight",this.position.set(0,1,0),this.target=new K.Object3D,this.intensity=void 0!==t?t:1,this.castShadow=!1,this.onlyShadow=!1,this.shadowCameraNear=50,this.shadowCameraFar=5e3,this.shadowCameraLeft=-500,this.shadowCameraRight=500,this.shadowCameraTop=500,this.shadowCameraBottom=-500,this.shadowCameraVisible=!1,this.shadowBias=0,this.shadowDarkness=.5,this.shadowMapWidth=512,this.shadowMapHeight=512,this.shadowCascade=!1,this.shadowCascadeOffset=new K.Vector3(0,0,-1e3),this.shadowCascadeCount=2,this.shadowCascadeBias=[0,0,0],this.shadowCascadeWidth=[512,512,512],this.shadowCascadeHeight=[512,512,512],this.shadowCascadeNearZ=[-1,.99,.998],this.shadowCascadeFarZ=[.99,.998,1],this.shadowCascadeArray=[],this.shadowMap=null,this.shadowMapSize=null,this.shadowCamera=null,this.shadowMatrix=null},K.DirectionalLight.prototype=Object.create(K.Light.prototype),K.DirectionalLight.prototype.constructor=K.DirectionalLight,K.DirectionalLight.prototype.clone=function(){var e=new K.DirectionalLight;return K.Light.prototype.clone.call(this,e),e.target=this.target.clone(),e.intensity=this.intensity,e.castShadow=this.castShadow,e.onlyShadow=this.onlyShadow,e.shadowCameraNear=this.shadowCameraNear,e.shadowCameraFar=this.shadowCameraFar,e.shadowCameraLeft=this.shadowCameraLeft,e.shadowCameraRight=this.shadowCameraRight,e.shadowCameraTop=this.shadowCameraTop,e.shadowCameraBottom=this.shadowCameraBottom,e.shadowCameraVisible=this.shadowCameraVisible,e.shadowBias=this.shadowBias,e.shadowDarkness=this.shadowDarkness,e.shadowMapWidth=this.shadowMapWidth,e.shadowMapHeight=this.shadowMapHeight,e.shadowCascade=this.shadowCascade,e.shadowCascadeOffset.copy(this.shadowCascadeOffset),e.shadowCascadeCount=this.shadowCascadeCount,e.shadowCascadeBias=this.shadowCascadeBias.slice(0),e.shadowCascadeWidth=this.shadowCascadeWidth.slice(0),e.shadowCascadeHeight=this.shadowCascadeHeight.slice(0),e.shadowCascadeNearZ=this.shadowCascadeNearZ.slice(0),e.shadowCascadeFarZ=this.shadowCascadeFarZ.slice(0),e},K.HemisphereLight=function(e,t,r){K.Light.call(this,e),this.type="HemisphereLight",this.position.set(0,100,0),this.groundColor=new K.Color(t),this.intensity=void 0!==r?r:1},K.HemisphereLight.prototype=Object.create(K.Light.prototype),K.HemisphereLight.prototype.constructor=K.HemisphereLight,K.HemisphereLight.prototype.clone=function(){var e=new K.HemisphereLight;return K.Light.prototype.clone.call(this,e),e.groundColor.copy(this.groundColor),e.intensity=this.intensity,e},K.PointLight=function(e,t,r,n){K.Light.call(this,e),this.type="PointLight",this.intensity=void 0!==t?t:1,this.distance=void 0!==r?r:0,this.decay=void 0!==n?n:1},K.PointLight.prototype=Object.create(K.Light.prototype),K.PointLight.prototype.constructor=K.PointLight,K.PointLight.prototype.clone=function(){var e=new K.PointLight;return K.Light.prototype.clone.call(this,e),e.intensity=this.intensity,e.distance=this.distance,e.decay=this.decay,e},K.SpotLight=function(e,t,r,n,i,o){K.Light.call(this,e),this.type="SpotLight",this.position.set(0,1,0),this.target=new K.Object3D,this.intensity=void 0!==t?t:1,this.distance=void 0!==r?r:0,this.angle=void 0!==n?n:Math.PI/3,this.exponent=void 0!==i?i:10,this.decay=void 0!==o?o:1,this.castShadow=!1,this.onlyShadow=!1,this.shadowCameraNear=50,this.shadowCameraFar=5e3,this.shadowCameraFov=50,this.shadowCameraVisible=!1,this.shadowBias=0,this.shadowDarkness=.5,this.shadowMapWidth=512,this.shadowMapHeight=512,this.shadowMap=null,this.shadowMapSize=null,this.shadowCamera=null,this.shadowMatrix=null},K.SpotLight.prototype=Object.create(K.Light.prototype),K.SpotLight.prototype.constructor=K.SpotLight,K.SpotLight.prototype.clone=function(){var e=new K.SpotLight;return K.Light.prototype.clone.call(this,e),e.target=this.target.clone(),e.intensity=this.intensity,e.distance=this.distance,e.angle=this.angle,e.exponent=this.exponent,e.decay=this.decay,e.castShadow=this.castShadow,e.onlyShadow=this.onlyShadow,e.shadowCameraNear=this.shadowCameraNear,e.shadowCameraFar=this.shadowCameraFar,e.shadowCameraFov=this.shadowCameraFov,e.shadowCameraVisible=this.shadowCameraVisible,e.shadowBias=this.shadowBias,e.shadowDarkness=this.shadowDarkness,e.shadowMapWidth=this.shadowMapWidth,e.shadowMapHeight=this.shadowMapHeight,e},K.Cache={files:{},add:function(e,t){this.files[e]=t},get:function(e){return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}},K.Loader=function(e){this.showStatus=e,this.statusDomElement=e?K.Loader.prototype.addStatusElement():null,this.imageLoader=new K.ImageLoader,this.onLoadStart=function(){},this.onLoadProgress=function(){},this.onLoadComplete=function(){}},K.Loader.prototype={constructor:K.Loader,crossOrigin:void 0,addStatusElement:function(){var e=document.createElement("div");return e.style.position="absolute",e.style.right="0px",e.style.top="0px",e.style.fontSize="0.8em",e.style.textAlign="left",e.style.background="rgba(0,0,0,0.25)",e.style.color="#fff",e.style.width="120px",e.style.padding="0.5em 0.5em 0.5em 0.5em",e.style.zIndex=1e3,e.innerHTML="Loading ...",e},updateProgress:function(e){var t="Loaded ";e.total?t+=(100*e.loaded/e.total).toFixed(0)+"%":t+=(e.loaded/1024).toFixed(2)+" KB",this.statusDomElement.innerHTML=t},extractUrlBase:function(e){var t=e.split("/");return 1===t.length?"./":(t.pop(),t.join("/")+"/")},initMaterials:function(e,t){for(var r=[],n=0;n<e.length;++n)r[n]=this.createMaterial(e[n],t);return r},needsTangents:function(e){for(var t=0,r=e.length;t<r;t++){if(e[t]instanceof K.ShaderMaterial)return!0}return!1},createMaterial:function(e,t){var r=this;function n(e){var t=Math.log(e)/Math.LN2;return Math.pow(2,Math.round(t))}function i(e,i,o,a,s,l,u){var c,h=t+o,d=K.Loader.Handlers.get(h);if(null!==d?c=d.load(h):(c=new K.Texture,(d=r.imageLoader).crossOrigin=r.crossOrigin,d.load(h,(function(e){if(!1===K.Math.isPowerOfTwo(e.width)||!1===K.Math.isPowerOfTwo(e.height)){var t=n(e.width),r=n(e.height),i=document.createElement("canvas");i.width=t,i.height=r,i.getContext("2d").drawImage(e,0,0,t,r),c.image=i}else c.image=e;c.needsUpdate=!0}))),c.sourceFile=o,a&&(c.repeat.set(a[0],a[1]),1!==a[0]&&(c.wrapS=K.RepeatWrapping),1!==a[1]&&(c.wrapT=K.RepeatWrapping)),s&&c.offset.set(s[0],s[1]),l){var f={repeat:K.RepeatWrapping,mirror:K.MirroredRepeatWrapping};void 0!==f[l[0]]&&(c.wrapS=f[l[0]]),void 0!==f[l[1]]&&(c.wrapT=f[l[1]])}u&&(c.anisotropy=u),e[i]=c}function o(e){return(255*e[0]<<16)+(255*e[1]<<8)+255*e[2]}var a="MeshLambertMaterial",s={color:15658734,opacity:1,map:null,lightMap:null,normalMap:null,bumpMap:null,wireframe:!1};if(e.shading){var l=e.shading.toLowerCase();"phong"===l?a="MeshPhongMaterial":"basic"===l&&(a="MeshBasicMaterial")}void 0!==e.blending&&void 0!==K[e.blending]&&(s.blending=K[e.blending]),void 0!==e.transparent&&(s.transparent=e.transparent),void 0!==e.opacity&&e.opacity<1&&(s.transparent=!0),void 0!==e.depthTest&&(s.depthTest=e.depthTest),void 0!==e.depthWrite&&(s.depthWrite=e.depthWrite),void 0!==e.visible&&(s.visible=e.visible),void 0!==e.flipSided&&(s.side=K.BackSide),void 0!==e.doubleSided&&(s.side=K.DoubleSide),void 0!==e.wireframe&&(s.wireframe=e.wireframe),void 0!==e.vertexColors&&("face"===e.vertexColors?s.vertexColors=K.FaceColors:e.vertexColors&&(s.vertexColors=K.VertexColors)),e.colorDiffuse?s.color=o(e.colorDiffuse):e.DbgColor&&(s.color=e.DbgColor),e.colorSpecular&&(s.specular=o(e.colorSpecular)),e.colorEmissive&&(s.emissive=o(e.colorEmissive)),void 0!==e.transparency&&(console.warn("THREE.Loader: transparency has been renamed to opacity"),e.opacity=e.transparency),void 0!==e.opacity&&(s.opacity=e.opacity),e.specularCoef&&(s.shininess=e.specularCoef),e.mapDiffuse&&t&&i(s,"map",e.mapDiffuse,e.mapDiffuseRepeat,e.mapDiffuseOffset,e.mapDiffuseWrap,e.mapDiffuseAnisotropy),e.mapLight&&t&&i(s,"lightMap",e.mapLight,e.mapLightRepeat,e.mapLightOffset,e.mapLightWrap,e.mapLightAnisotropy),e.mapBump&&t&&i(s,"bumpMap",e.mapBump,e.mapBumpRepeat,e.mapBumpOffset,e.mapBumpWrap,e.mapBumpAnisotropy),e.mapNormal&&t&&i(s,"normalMap",e.mapNormal,e.mapNormalRepeat,e.mapNormalOffset,e.mapNormalWrap,e.mapNormalAnisotropy),e.mapSpecular&&t&&i(s,"specularMap",e.mapSpecular,e.mapSpecularRepeat,e.mapSpecularOffset,e.mapSpecularWrap,e.mapSpecularAnisotropy),e.mapAlpha&&t&&i(s,"alphaMap",e.mapAlpha,e.mapAlphaRepeat,e.mapAlphaOffset,e.mapAlphaWrap,e.mapAlphaAnisotropy),e.mapBumpScale&&(s.bumpScale=e.mapBumpScale),e.mapNormalFactor&&(s.normalScale=new K.Vector2(e.mapNormalFactor,e.mapNormalFactor));var u=new K[a](s);return void 0!==e.DbgName&&(u.name=e.DbgName),u}},K.Loader.Handlers={handlers:[],add:function(e,t){this.handlers.push(e,t)},get:function(e){for(var t=0,r=this.handlers.length;t<r;t+=2){var n=this.handlers[t],i=this.handlers[t+1];if(n.test(e))return i}return null}},K.XHRLoader=function(e){this.manager=void 0!==e?e:K.DefaultLoadingManager},K.XHRLoader.prototype={constructor:K.XHRLoader,load:function(e,t,r,n){var i=this,o=K.Cache.get(e);if(void 0===o){var a=new XMLHttpRequest;a.open("GET",e,!0),a.addEventListener("load",(function(r){K.Cache.add(e,this.response),t&&t(this.response),i.manager.itemEnd(e)}),!1),void 0!==r&&a.addEventListener("progress",(function(e){r(e)}),!1),void 0!==n&&a.addEventListener("error",(function(e){n(e)}),!1),void 0!==this.crossOrigin&&(a.crossOrigin=this.crossOrigin),void 0!==this.responseType&&(a.responseType=this.responseType),a.send(null),i.manager.itemStart(e)}else t&&t(o)},setResponseType:function(e){this.responseType=e},setCrossOrigin:function(e){this.crossOrigin=e}},K.ImageLoader=function(e){this.manager=void 0!==e?e:K.DefaultLoadingManager},K.ImageLoader.prototype={constructor:K.ImageLoader,load:function(e,t,r,n){var i=this,o=K.Cache.get(e);if(void 0===o){var a=document.createElement("img");return a.addEventListener("load",(function(r){K.Cache.add(e,this),t&&t(this),i.manager.itemEnd(e)}),!1),void 0!==r&&a.addEventListener("progress",(function(e){r(e)}),!1),void 0!==n&&a.addEventListener("error",(function(e){n(e)}),!1),void 0!==this.crossOrigin&&(a.crossOrigin=this.crossOrigin),a.src=e,i.manager.itemStart(e),a}t(o)},setCrossOrigin:function(e){this.crossOrigin=e}},K.JSONLoader=function(e){K.Loader.call(this,e),this.withCredentials=!1},K.JSONLoader.prototype=Object.create(K.Loader.prototype),K.JSONLoader.prototype.constructor=K.JSONLoader,K.JSONLoader.prototype.load=function(e,t,r){r=r&&"string"==typeof r?r:this.extractUrlBase(e),this.onLoadStart(),this.loadAjaxJSON(this,e,t,r)},K.JSONLoader.prototype.loadAjaxJSON=function(e,t,r,n,i){var o=new XMLHttpRequest,a=0;o.onreadystatechange=function(){if(o.readyState===o.DONE)if(200===o.status||0===o.status){if(o.responseText){var s=JSON.parse(o.responseText),l=s.metadata;if(void 0!==l){if("object"===l.type)return void K.error("THREE.JSONLoader: "+t+" should be loaded with THREE.ObjectLoader instead.");if("scene"===l.type)return void K.error("THREE.JSONLoader: "+t+" seems to be a Scene. Use THREE.SceneLoader instead.")}var u=e.parse(s,n);r(u.geometry,u.materials)}else K.error("THREE.JSONLoader: "+t+" seems to be unreachable or the file is empty.");e.onLoadComplete()}else K.error("THREE.JSONLoader: Couldn't load "+t+" ("+o.status+")");else o.readyState===o.LOADING?i&&(0===a&&(a=o.getResponseHeader("Content-Length")),i({total:a,loaded:o.responseText.length})):o.readyState===o.HEADERS_RECEIVED&&void 0!==i&&(a=o.getResponseHeader("Content-Length"))},o.open("GET",t,!0),o.withCredentials=this.withCredentials,o.send(null)},K.JSONLoader.prototype.parse=function(e,t){var r=new K.Geometry,n=void 0!==e.scale?1/e.scale:1;if(function(t){function n(e,t){return e&1<<t}var i,o,a,s,l,u,c,h,d,f,p,m,g,v,y,b,x,_,E,w,A,S,M,T,C,P,D,L=e.faces,R=e.vertices,I=e.normals,O=e.colors,N=0;if(void 0!==e.uvs){for(i=0;i<e.uvs.length;i++)e.uvs[i].length&&N++;for(i=0;i<N;i++)r.faceVertexUvs[i]=[]}s=0,l=R.length;for(;s<l;)(_=new K.Vector3).x=R[s++]*t,_.y=R[s++]*t,_.z=R[s++]*t,r.vertices.push(_);s=0,l=L.length;for(;s<l;)if(f=L[s++],p=n(f,0),m=n(f,1),g=n(f,3),v=n(f,4),y=n(f,5),b=n(f,6),x=n(f,7),p){if((w=new K.Face3).a=L[s],w.b=L[s+1],w.c=L[s+3],(A=new K.Face3).a=L[s+1],A.b=L[s+2],A.c=L[s+3],s+=4,m&&(d=L[s++],w.materialIndex=d,A.materialIndex=d),a=r.faces.length,g)for(i=0;i<N;i++)for(T=e.uvs[i],r.faceVertexUvs[i][a]=[],r.faceVertexUvs[i][a+1]=[],o=0;o<4;o++)h=L[s++],P=T[2*h],D=T[2*h+1],C=new K.Vector2(P,D),2!==o&&r.faceVertexUvs[i][a].push(C),0!==o&&r.faceVertexUvs[i][a+1].push(C);if(v&&(c=3*L[s++],w.normal.set(I[c++],I[c++],I[c]),A.normal.copy(w.normal)),y)for(i=0;i<4;i++)c=3*L[s++],M=new K.Vector3(I[c++],I[c++],I[c]),2!==i&&w.vertexNormals.push(M),0!==i&&A.vertexNormals.push(M);if(b&&(u=L[s++],S=O[u],w.color.setHex(S),A.color.setHex(S)),x)for(i=0;i<4;i++)u=L[s++],S=O[u],2!==i&&w.vertexColors.push(new K.Color(S)),0!==i&&A.vertexColors.push(new K.Color(S));r.faces.push(w),r.faces.push(A)}else{if((E=new K.Face3).a=L[s++],E.b=L[s++],E.c=L[s++],m&&(d=L[s++],E.materialIndex=d),a=r.faces.length,g)for(i=0;i<N;i++)for(T=e.uvs[i],r.faceVertexUvs[i][a]=[],o=0;o<3;o++)h=L[s++],P=T[2*h],D=T[2*h+1],C=new K.Vector2(P,D),r.faceVertexUvs[i][a].push(C);if(v&&(c=3*L[s++],E.normal.set(I[c++],I[c++],I[c])),y)for(i=0;i<3;i++)c=3*L[s++],M=new K.Vector3(I[c++],I[c++],I[c]),E.vertexNormals.push(M);if(b&&(u=L[s++],E.color.setHex(O[u])),x)for(i=0;i<3;i++)u=L[s++],E.vertexColors.push(new K.Color(O[u]));r.faces.push(E)}}(n),function(){var t=void 0!==e.influencesPerVertex?e.influencesPerVertex:2;if(e.skinWeights)for(var n=0,i=e.skinWeights.length;n<i;n+=t){var o=e.skinWeights[n],a=t>1?e.skinWeights[n+1]:0,s=t>2?e.skinWeights[n+2]:0,l=t>3?e.skinWeights[n+3]:0;r.skinWeights.push(new K.Vector4(o,a,s,l))}if(e.skinIndices)for(n=0,i=e.skinIndices.length;n<i;n+=t){var u=e.skinIndices[n],c=t>1?e.skinIndices[n+1]:0,h=t>2?e.skinIndices[n+2]:0,d=t>3?e.skinIndices[n+3]:0;r.skinIndices.push(new K.Vector4(u,c,h,d))}r.bones=e.bones,r.bones&&r.bones.length>0&&(r.skinWeights.length!==r.skinIndices.length||r.skinIndices.length!==r.vertices.length)&&K.warn("THREE.JSONLoader: When skinning, number of vertices ("+r.vertices.length+"), skinIndices ("+r.skinIndices.length+"), and skinWeights ("+r.skinWeights.length+") should match.");r.animation=e.animation,r.animations=e.animations}(),function(t){var n,i,o,a,s,l,u,c,h,d,f;if(void 0!==e.morphTargets)for(s=0,l=e.morphTargets.length;s<l;s++)for(r.morphTargets[s]={},r.morphTargets[s].name=e.morphTargets[s].name,r.morphTargets[s].vertices=[],o=r.morphTargets[s].vertices,a=e.morphTargets[s].vertices,n=0,i=a.length;n<i;n+=3){var p=new K.Vector3;p.x=a[n]*t,p.y=a[n+1]*t,p.z=a[n+2]*t,o.push(p)}if(void 0!==e.morphColors)for(s=0,l=e.morphColors.length;s<l;s++)for(r.morphColors[s]={},r.morphColors[s].name=e.morphColors[s].name,r.morphColors[s].colors=[],h=r.morphColors[s].colors,d=e.morphColors[s].colors,u=0,c=d.length;u<c;u+=3)(f=new K.Color(16755200)).setRGB(d[u],d[u+1],d[u+2]),h.push(f)}(n),r.computeFaceNormals(),r.computeBoundingSphere(),void 0===e.materials||0===e.materials.length)return{geometry:r};var i=this.initMaterials(e.materials,t);return this.needsTangents(i)&&r.computeTangents(),{geometry:r,materials:i}},K.LoadingManager=function(e,t,r){var n=this,i=0,o=0;this.onLoad=e,this.onProgress=t,this.onError=r,this.itemStart=function(e){o++},this.itemEnd=function(e){i++,void 0!==n.onProgress&&n.onProgress(e,i,o),i===o&&void 0!==n.onLoad&&n.onLoad()}},K.DefaultLoadingManager=new K.LoadingManager,K.BufferGeometryLoader=function(e){this.manager=void 0!==e?e:K.DefaultLoadingManager},K.BufferGeometryLoader.prototype={constructor:K.BufferGeometryLoader,load:function(e,t,r,n){var i=this,o=new K.XHRLoader(i.manager);o.setCrossOrigin(this.crossOrigin),o.load(e,(function(e){t(i.parse(JSON.parse(e)))}),r,n)},setCrossOrigin:function(e){this.crossOrigin=e},parse:function(e){var t=new K.BufferGeometry,r=e.data.attributes;for(var n in r){var i=r[n],o=new self[i.type](i.array);t.setAttribute(n,new K.BufferAttribute(o,i.itemSize))}var a=e.data.offsets;void 0!==a&&(t.offsets=JSON.parse(JSON.stringify(a)));var s=e.data.boundingSphere;if(void 0!==s){var l=new K.Vector3;void 0!==s.center&&l.fromArray(s.center),t.boundingSphere=new K.Sphere(l,s.radius)}return t}},K.MaterialLoader=function(e){this.manager=void 0!==e?e:K.DefaultLoadingManager},K.MaterialLoader.prototype={constructor:K.MaterialLoader,load:function(e,t,r,n){var i=this,o=new K.XHRLoader(i.manager);o.setCrossOrigin(this.crossOrigin),o.load(e,(function(e){t(i.parse(JSON.parse(e)))}),r,n)},setCrossOrigin:function(e){this.crossOrigin=e},parse:function(e){var t=new K[e.type];if(void 0!==e.color&&t.color.setHex(e.color),void 0!==e.emissive&&t.emissive.setHex(e.emissive),void 0!==e.specular&&t.specular.setHex(e.specular),void 0!==e.shininess&&(t.shininess=e.shininess),void 0!==e.uniforms&&(t.uniforms=e.uniforms),void 0!==e.vertexShader&&(t.vertexShader=e.vertexShader),void 0!==e.fragmentShader&&(t.fragmentShader=e.fragmentShader),void 0!==e.vertexColors&&(t.vertexColors=e.vertexColors),void 0!==e.shading&&(t.shading=e.shading),void 0!==e.blending&&(t.blending=e.blending),void 0!==e.side&&(t.side=e.side),void 0!==e.opacity&&(t.opacity=e.opacity),void 0!==e.transparent&&(t.transparent=e.transparent),void 0!==e.wireframe&&(t.wireframe=e.wireframe),void 0!==e.size&&(t.size=e.size),void 0!==e.sizeAttenuation&&(t.sizeAttenuation=e.sizeAttenuation),void 0!==e.materials)for(var r=0,n=e.materials.length;r<n;r++)t.materials.push(this.parse(e.materials[r]));return t}},K.ObjectLoader=function(e){this.manager=void 0!==e?e:K.DefaultLoadingManager,this.texturePath=""},K.ObjectLoader.prototype={constructor:K.ObjectLoader,load:function(e,t,r,n){""===this.texturePath&&(this.texturePath=e.substring(0,e.lastIndexOf("/")+1));var i=this,o=new K.XHRLoader(i.manager);o.setCrossOrigin(this.crossOrigin),o.load(e,(function(e){i.parse(JSON.parse(e),t)}),r,n)},setTexturePath:function(e){this.texturePath=e},setCrossOrigin:function(e){this.crossOrigin=e},parse:function(e,t){var r=this.parseGeometries(e.geometries),n=this.parseImages(e.images,(function(){void 0!==t&&t(a)})),i=this.parseTextures(e.textures,n),o=this.parseMaterials(e.materials,i),a=this.parseObject(e.object,r,o);return void 0!==e.images&&0!==e.images.length||void 0!==t&&t(a),a},parseGeometries:function(e){var t={};if(void 0!==e)for(var r=new K.JSONLoader,n=new K.BufferGeometryLoader,i=0,o=e.length;i<o;i++){var a,s=e[i];switch(s.type){case"PlaneGeometry":case"PlaneBufferGeometry":a=new K[s.type](s.width,s.height,s.widthSegments,s.heightSegments);break;case"BoxGeometry":case"CubeGeometry":a=new K.BoxGeometry(s.width,s.height,s.depth,s.widthSegments,s.heightSegments,s.depthSegments);break;case"CircleGeometry":a=new K.CircleGeometry(s.radius,s.segments);break;case"CylinderGeometry":a=new K.CylinderGeometry(s.radiusTop,s.radiusBottom,s.height,s.radialSegments,s.heightSegments,s.openEnded);break;case"SphereGeometry":a=new K.SphereGeometry(s.radius,s.widthSegments,s.heightSegments,s.phiStart,s.phiLength,s.thetaStart,s.thetaLength);break;case"IcosahedronGeometry":a=new K.IcosahedronGeometry(s.radius,s.detail);break;case"TorusGeometry":a=new K.TorusGeometry(s.radius,s.tube,s.radialSegments,s.tubularSegments,s.arc);break;case"TorusKnotGeometry":a=new K.TorusKnotGeometry(s.radius,s.tube,s.radialSegments,s.tubularSegments,s.p,s.q,s.heightScale);break;case"BufferGeometry":a=n.parse(s);break;case"Geometry":a=r.parse(s.data).geometry}a.uuid=s.uuid,void 0!==s.name&&(a.name=s.name),t[s.uuid]=a}return t},parseMaterials:function(e,t){var r={};if(void 0!==e)for(var n=function(e){return void 0===t[e]&&K.warn("THREE.ObjectLoader: Undefined texture",e),t[e]},i=new K.MaterialLoader,o=0,a=e.length;o<a;o++){var s=e[o],l=i.parse(s);l.uuid=s.uuid,void 0!==s.name&&(l.name=s.name),void 0!==s.map&&(l.map=n(s.map)),void 0!==s.bumpMap&&(l.bumpMap=n(s.bumpMap),s.bumpScale&&(l.bumpScale=new K.Vector2(s.bumpScale,s.bumpScale))),void 0!==s.alphaMap&&(l.alphaMap=n(s.alphaMap)),void 0!==s.envMap&&(l.envMap=n(s.envMap)),void 0!==s.normalMap&&(l.normalMap=n(s.normalMap),s.normalScale&&(l.normalScale=new K.Vector2(s.normalScale,s.normalScale))),void 0!==s.lightMap&&(l.lightMap=n(s.lightMap)),void 0!==s.specularMap&&(l.specularMap=n(s.specularMap)),r[s.uuid]=l}return r},parseImages:function(e,t){var r=this,n={};if(void 0!==e&&e.length>0){var i=new K.LoadingManager(t),o=new K.ImageLoader(i);o.setCrossOrigin(this.crossOrigin);for(var a=function(e){return r.manager.itemStart(e),o.load(e,(function(){r.manager.itemEnd(e)}))},s=0,l=e.length;s<l;s++){var u=e[s],c=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(u.url)?u.url:r.texturePath+u.url;n[u.uuid]=a(c)}}return n},parseTextures:function(e,t){var r={};if(void 0!==e)for(var n=0,i=e.length;n<i;n++){var o=e[n];void 0===o.image&&K.warn('THREE.ObjectLoader: No "image" speficied for',o.uuid),void 0===t[o.image]&&K.warn("THREE.ObjectLoader: Undefined image",o.image);var a=new K.Texture(t[o.image]);a.needsUpdate=!0,a.uuid=o.uuid,void 0!==o.name&&(a.name=o.name),void 0!==o.repeat&&(a.repeat=new K.Vector2(o.repeat[0],o.repeat[1])),void 0!==o.minFilter&&(a.minFilter=K[o.minFilter]),void 0!==o.magFilter&&(a.magFilter=K[o.magFilter]),void 0!==o.anisotropy&&(a.anisotropy=o.anisotropy),o.wrap instanceof Array&&(a.wrapS=K[o.wrap[0]],a.wrapT=K[o.wrap[1]]),r[o.uuid]=a}return r},parseObject:function(){var e=new K.Matrix4;return function(t,r,n){var i,o=function(e){return void 0===r[e]&&K.warn("THREE.ObjectLoader: Undefined geometry",e),r[e]},a=function(e){return void 0===n[e]&&K.warn("THREE.ObjectLoader: Undefined material",e),n[e]};switch(t.type){case"Scene":i=new K.Scene;break;case"PerspectiveCamera":i=new K.PerspectiveCamera(t.fov,t.aspect,t.near,t.far);break;case"OrthographicCamera":i=new K.OrthographicCamera(t.left,t.right,t.top,t.bottom,t.near,t.far);break;case"AmbientLight":i=new K.AmbientLight(t.color);break;case"DirectionalLight":i=new K.DirectionalLight(t.color,t.intensity);break;case"PointLight":i=new K.PointLight(t.color,t.intensity,t.distance,t.decay);break;case"SpotLight":i=new K.SpotLight(t.color,t.intensity,t.distance,t.angle,t.exponent,t.decay);break;case"HemisphereLight":i=new K.HemisphereLight(t.color,t.groundColor,t.intensity);break;case"Mesh":i=new K.Mesh(o(t.geometry),a(t.material));break;case"Line":i=new K.Line(o(t.geometry),a(t.material),t.mode);break;case"PointCloud":i=new K.PointCloud(o(t.geometry),a(t.material));break;case"Sprite":i=new K.Sprite(a(t.material));break;case"Group":i=new K.Group;break;default:i=new K.Object3D}if(i.uuid=t.uuid,void 0!==t.name&&(i.name=t.name),void 0!==t.matrix?(e.fromArray(t.matrix),e.decompose(i.position,i.quaternion,i.scale)):(void 0!==t.position&&i.position.fromArray(t.position),void 0!==t.rotation&&i.rotation.fromArray(t.rotation),void 0!==t.scale&&i.scale.fromArray(t.scale)),void 0!==t.visible&&(i.visible=t.visible),void 0!==t.userData&&(i.userData=t.userData),void 0!==t.children)for(var s in t.children)i.add(this.parseObject(t.children[s],r,n));return i}}()},K.TextureLoader=function(e){this.manager=void 0!==e?e:K.DefaultLoadingManager},K.TextureLoader.prototype={constructor:K.TextureLoader,load:function(e,t,r,n){var i=new K.ImageLoader(this.manager);i.setCrossOrigin(this.crossOrigin),i.load(e,(function(e){var r=new K.Texture(e);r.needsUpdate=!0,void 0!==t&&t(r)}),r,n)},setCrossOrigin:function(e){this.crossOrigin=e}},K.DataTextureLoader=K.BinaryTextureLoader=function(){this._parser=null},K.BinaryTextureLoader.prototype={constructor:K.BinaryTextureLoader,load:function(e,t,r,n){var i=this,o=new K.DataTexture,a=new K.XHRLoader;return a.setResponseType("arraybuffer"),a.load(e,(function(e){var r=i._parser(e);r&&(void 0!==r.image?o.image=r.image:void 0!==r.data&&(o.image.width=r.width,o.image.height=r.height,o.image.data=r.data),o.wrapS=void 0!==r.wrapS?r.wrapS:K.ClampToEdgeWrapping,o.wrapT=void 0!==r.wrapT?r.wrapT:K.ClampToEdgeWrapping,o.magFilter=void 0!==r.magFilter?r.magFilter:K.LinearFilter,o.minFilter=void 0!==r.minFilter?r.minFilter:K.LinearMipMapLinearFilter,o.anisotropy=void 0!==r.anisotropy?r.anisotropy:1,void 0!==r.format&&(o.format=r.format),void 0!==r.type&&(o.type=r.type),void 0!==r.mipmaps&&(o.mipmaps=r.mipmaps),1===r.mipmapCount&&(o.minFilter=K.LinearFilter),o.needsUpdate=!0,t&&t(o,r))}),r,n),o}},K.CompressedTextureLoader=function(){this._parser=null},K.CompressedTextureLoader.prototype={constructor:K.CompressedTextureLoader,load:function(e,t,r){var n=this,i=[],o=new K.CompressedTexture;o.image=i;var a=new K.XHRLoader;if(a.setResponseType("arraybuffer"),e instanceof Array)for(var s=0,l=function(r){a.load(e[r],(function(e){var a=n._parser(e,!0);i[r]={width:a.width,height:a.height,format:a.format,mipmaps:a.mipmaps},6===(s+=1)&&(1==a.mipmapCount&&(o.minFilter=K.LinearFilter),o.format=a.format,o.needsUpdate=!0,t&&t(o))}))},u=0,c=e.length;u<c;++u)l(u);else a.load(e,(function(e){var r=n._parser(e,!0);if(r.isCubemap)for(var a=r.mipmaps.length/r.mipmapCount,s=0;s<a;s++){i[s]={mipmaps:[]};for(var l=0;l<r.mipmapCount;l++)i[s].mipmaps.push(r.mipmaps[s*r.mipmapCount+l]),i[s].format=r.format,i[s].width=r.width,i[s].height=r.height}else o.image.width=r.width,o.image.height=r.height,o.mipmaps=r.mipmaps;1===r.mipmapCount&&(o.minFilter=K.LinearFilter),o.format=r.format,o.needsUpdate=!0,t&&t(o)}));return o}},K.Material=function(){Object.defineProperty(this,"id",{value:K.MaterialIdCount++}),this.uuid=K.Math.generateUUID(),this.name="",this.type="Material",this.side=K.FrontSide,this.opacity=1,this.transparent=!1,this.blending=K.NormalBlending,this.blendSrc=K.SrcAlphaFactor,this.blendDst=K.OneMinusSrcAlphaFactor,this.blendEquation=K.AddEquation,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthTest=!0,this.depthWrite=!0,this.colorWrite=!0,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.alphaTest=0,this.overdraw=0,this.visible=!0,this._needsUpdate=!0},K.Material.prototype={constructor:K.Material,get needsUpdate(){return this._needsUpdate},set needsUpdate(e){!0===e&&this.update(),this._needsUpdate=e},setValues:function(e){if(void 0!==e)for(var t in e){var r=e[t];if(void 0!==r){if(t in this){var n=this[t];n instanceof K.Color?n.set(r):n instanceof K.Vector3&&r instanceof K.Vector3?n.copy(r):this[t]="overdraw"==t?Number(r):r}}else K.warn("THREE.Material: '"+t+"' parameter is undefined.")}},toJSON:function(){var e={metadata:{version:4.2,type:"material",generator:"MaterialExporter"},uuid:this.uuid,type:this.type};return""!==this.name&&(e.name=this.name),this instanceof K.MeshBasicMaterial?(e.color=this.color.getHex(),this.vertexColors!==K.NoColors&&(e.vertexColors=this.vertexColors),this.blending!==K.NormalBlending&&(e.blending=this.blending),this.side!==K.FrontSide&&(e.side=this.side)):this instanceof K.MeshLambertMaterial?(e.color=this.color.getHex(),e.emissive=this.emissive.getHex(),this.vertexColors!==K.NoColors&&(e.vertexColors=this.vertexColors),this.shading!==K.SmoothShading&&(e.shading=this.shading),this.blending!==K.NormalBlending&&(e.blending=this.blending),this.side!==K.FrontSide&&(e.side=this.side)):this instanceof K.MeshPhongMaterial?(e.color=this.color.getHex(),e.emissive=this.emissive.getHex(),e.specular=this.specular.getHex(),e.shininess=this.shininess,this.vertexColors!==K.NoColors&&(e.vertexColors=this.vertexColors),this.shading!==K.SmoothShading&&(e.shading=this.shading),this.blending!==K.NormalBlending&&(e.blending=this.blending),this.side!==K.FrontSide&&(e.side=this.side)):this instanceof K.MeshNormalMaterial||this instanceof K.MeshDepthMaterial?(this.blending!==K.NormalBlending&&(e.blending=this.blending),this.side!==K.FrontSide&&(e.side=this.side)):this instanceof K.PointCloudMaterial?(e.size=this.size,e.sizeAttenuation=this.sizeAttenuation,e.color=this.color.getHex(),this.vertexColors!==K.NoColors&&(e.vertexColors=this.vertexColors),this.blending!==K.NormalBlending&&(e.blending=this.blending)):this instanceof K.ShaderMaterial?(e.uniforms=this.uniforms,e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader):this instanceof K.SpriteMaterial&&(e.color=this.color.getHex()),this.opacity<1&&(e.opacity=this.opacity),!1!==this.transparent&&(e.transparent=this.transparent),!1!==this.wireframe&&(e.wireframe=this.wireframe),e},clone:function(e){return void 0===e&&(e=new K.Material),e.name=this.name,e.side=this.side,e.opacity=this.opacity,e.transparent=this.transparent,e.blending=this.blending,e.blendSrc=this.blendSrc,e.blendDst=this.blendDst,e.blendEquation=this.blendEquation,e.blendSrcAlpha=this.blendSrcAlpha,e.blendDstAlpha=this.blendDstAlpha,e.blendEquationAlpha=this.blendEquationAlpha,e.depthTest=this.depthTest,e.depthWrite=this.depthWrite,e.polygonOffset=this.polygonOffset,e.polygonOffsetFactor=this.polygonOffsetFactor,e.polygonOffsetUnits=this.polygonOffsetUnits,e.alphaTest=this.alphaTest,e.overdraw=this.overdraw,e.visible=this.visible,e},update:function(){this.dispatchEvent({type:"update"})},dispose:function(){this.dispatchEvent({type:"dispose"})}},K.EventDispatcher.prototype.apply(K.Material.prototype),K.MaterialIdCount=0,K.LineBasicMaterial=function(e){K.Material.call(this),this.type="LineBasicMaterial",this.color=new K.Color(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.vertexColors=K.NoColors,this.fog=!0,this.setValues(e)},K.LineBasicMaterial.prototype=Object.create(K.Material.prototype),K.LineBasicMaterial.prototype.constructor=K.LineBasicMaterial,K.LineBasicMaterial.prototype.clone=function(){var e=new K.LineBasicMaterial;return K.Material.prototype.clone.call(this,e),e.color.copy(this.color),e.linewidth=this.linewidth,e.linecap=this.linecap,e.linejoin=this.linejoin,e.vertexColors=this.vertexColors,e.fog=this.fog,e},K.LineDashedMaterial=function(e){K.Material.call(this),this.type="LineDashedMaterial",this.color=new K.Color(16777215),this.linewidth=1,this.scale=1,this.dashSize=3,this.gapSize=1,this.vertexColors=!1,this.fog=!0,this.setValues(e)},K.LineDashedMaterial.prototype=Object.create(K.Material.prototype),K.LineDashedMaterial.prototype.constructor=K.LineDashedMaterial,K.LineDashedMaterial.prototype.clone=function(){var e=new K.LineDashedMaterial;return K.Material.prototype.clone.call(this,e),e.color.copy(this.color),e.linewidth=this.linewidth,e.scale=this.scale,e.dashSize=this.dashSize,e.gapSize=this.gapSize,e.vertexColors=this.vertexColors,e.fog=this.fog,e},K.MeshBasicMaterial=function(e){K.Material.call(this),this.type="MeshBasicMaterial",this.color=new K.Color(16777215),this.map=null,this.lightMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=K.MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.shading=K.SmoothShading,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.vertexColors=K.NoColors,this.skinning=!1,this.morphTargets=!1,this.setValues(e)},K.MeshBasicMaterial.prototype=Object.create(K.Material.prototype),K.MeshBasicMaterial.prototype.constructor=K.MeshBasicMaterial,K.MeshBasicMaterial.prototype.clone=function(){var e=new K.MeshBasicMaterial;return K.Material.prototype.clone.call(this,e),e.color.copy(this.color),e.map=this.map,e.lightMap=this.lightMap,e.specularMap=this.specularMap,e.alphaMap=this.alphaMap,e.envMap=this.envMap,e.combine=this.combine,e.reflectivity=this.reflectivity,e.refractionRatio=this.refractionRatio,e.fog=this.fog,e.shading=this.shading,e.wireframe=this.wireframe,e.wireframeLinewidth=this.wireframeLinewidth,e.wireframeLinecap=this.wireframeLinecap,e.wireframeLinejoin=this.wireframeLinejoin,e.vertexColors=this.vertexColors,e.skinning=this.skinning,e.morphTargets=this.morphTargets,e},K.MeshLambertMaterial=function(e){K.Material.call(this),this.type="MeshLambertMaterial",this.color=new K.Color(16777215),this.emissive=new K.Color(0),this.wrapAround=!1,this.wrapRGB=new K.Vector3(1,1,1),this.map=null,this.lightMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=K.MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.shading=K.SmoothShading,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.vertexColors=K.NoColors,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)},K.MeshLambertMaterial.prototype=Object.create(K.Material.prototype),K.MeshLambertMaterial.prototype.constructor=K.MeshLambertMaterial,K.MeshLambertMaterial.prototype.clone=function(){var e=new K.MeshLambertMaterial;return K.Material.prototype.clone.call(this,e),e.color.copy(this.color),e.emissive.copy(this.emissive),e.wrapAround=this.wrapAround,e.wrapRGB.copy(this.wrapRGB),e.map=this.map,e.lightMap=this.lightMap,e.specularMap=this.specularMap,e.alphaMap=this.alphaMap,e.envMap=this.envMap,e.combine=this.combine,e.reflectivity=this.reflectivity,e.refractionRatio=this.refractionRatio,e.fog=this.fog,e.shading=this.shading,e.wireframe=this.wireframe,e.wireframeLinewidth=this.wireframeLinewidth,e.wireframeLinecap=this.wireframeLinecap,e.wireframeLinejoin=this.wireframeLinejoin,e.vertexColors=this.vertexColors,e.skinning=this.skinning,e.morphTargets=this.morphTargets,e.morphNormals=this.morphNormals,e},K.MeshPhongMaterial=function(e){K.Material.call(this),this.type="MeshPhongMaterial",this.color=new K.Color(16777215),this.emissive=new K.Color(0),this.specular=new K.Color(1118481),this.shininess=30,this.metal=!1,this.wrapAround=!1,this.wrapRGB=new K.Vector3(1,1,1),this.map=null,this.lightMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new K.Vector2(1,1),this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=K.MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.shading=K.SmoothShading,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.vertexColors=K.NoColors,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)},K.MeshPhongMaterial.prototype=Object.create(K.Material.prototype),K.MeshPhongMaterial.prototype.constructor=K.MeshPhongMaterial,K.MeshPhongMaterial.prototype.clone=function(){var e=new K.MeshPhongMaterial;return K.Material.prototype.clone.call(this,e),e.color.copy(this.color),e.emissive.copy(this.emissive),e.specular.copy(this.specular),e.shininess=this.shininess,e.metal=this.metal,e.wrapAround=this.wrapAround,e.wrapRGB.copy(this.wrapRGB),e.map=this.map,e.lightMap=this.lightMap,e.bumpMap=this.bumpMap,e.bumpScale=this.bumpScale,e.normalMap=this.normalMap,e.normalScale.copy(this.normalScale),e.specularMap=this.specularMap,e.alphaMap=this.alphaMap,e.envMap=this.envMap,e.combine=this.combine,e.reflectivity=this.reflectivity,e.refractionRatio=this.refractionRatio,e.fog=this.fog,e.shading=this.shading,e.wireframe=this.wireframe,e.wireframeLinewidth=this.wireframeLinewidth,e.wireframeLinecap=this.wireframeLinecap,e.wireframeLinejoin=this.wireframeLinejoin,e.vertexColors=this.vertexColors,e.skinning=this.skinning,e.morphTargets=this.morphTargets,e.morphNormals=this.morphNormals,e},K.MeshDepthMaterial=function(e){K.Material.call(this),this.type="MeshDepthMaterial",this.morphTargets=!1,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)},K.MeshDepthMaterial.prototype=Object.create(K.Material.prototype),K.MeshDepthMaterial.prototype.constructor=K.MeshDepthMaterial,K.MeshDepthMaterial.prototype.clone=function(){var e=new K.MeshDepthMaterial;return K.Material.prototype.clone.call(this,e),e.wireframe=this.wireframe,e.wireframeLinewidth=this.wireframeLinewidth,e},K.MeshNormalMaterial=function(e){K.Material.call(this,e),this.type="MeshNormalMaterial",this.wireframe=!1,this.wireframeLinewidth=1,this.morphTargets=!1,this.setValues(e)},K.MeshNormalMaterial.prototype=Object.create(K.Material.prototype),K.MeshNormalMaterial.prototype.constructor=K.MeshNormalMaterial,K.MeshNormalMaterial.prototype.clone=function(){var e=new K.MeshNormalMaterial;return K.Material.prototype.clone.call(this,e),e.wireframe=this.wireframe,e.wireframeLinewidth=this.wireframeLinewidth,e},K.MeshFaceMaterial=function(e){this.uuid=K.Math.generateUUID(),this.type="MeshFaceMaterial",this.materials=e instanceof Array?e:[]},K.MeshFaceMaterial.prototype={constructor:K.MeshFaceMaterial,toJSON:function(){for(var e={metadata:{version:4.2,type:"material",generator:"MaterialExporter"},uuid:this.uuid,type:this.type,materials:[]},t=0,r=this.materials.length;t<r;t++)e.materials.push(this.materials[t].toJSON());return e},clone:function(){for(var e=new K.MeshFaceMaterial,t=0;t<this.materials.length;t++)e.materials.push(this.materials[t].clone());return e}},K.PointCloudMaterial=function(e){K.Material.call(this),this.type="PointCloudMaterial",this.color=new K.Color(16777215),this.map=null,this.size=1,this.sizeAttenuation=!0,this.vertexColors=K.NoColors,this.fog=!0,this.setValues(e)},K.PointCloudMaterial.prototype=Object.create(K.Material.prototype),K.PointCloudMaterial.prototype.constructor=K.PointCloudMaterial,K.PointCloudMaterial.prototype.clone=function(){var e=new K.PointCloudMaterial;return K.Material.prototype.clone.call(this,e),e.color.copy(this.color),e.map=this.map,this.defines&&(e.defines=Object.assign({},this.defines)),e.size=this.size,e.sizeAttenuation=this.sizeAttenuation,e.vertexColors=this.vertexColors,e.fog=this.fog,e},K.ParticleBasicMaterial=function(e){return K.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointCloudMaterial."),new K.PointCloudMaterial(e)},K.ParticleSystemMaterial=function(e){return K.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointCloudMaterial."),new K.PointCloudMaterial(e)},K.ShaderMaterial=function(e){K.Material.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.attributes=null,this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.shading=K.SmoothShading,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.vertexColors=K.NoColors,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.setValues(e)},K.ShaderMaterial.prototype=Object.create(K.Material.prototype),K.ShaderMaterial.prototype.constructor=K.ShaderMaterial,K.ShaderMaterial.prototype.clone=function(){var e=new K.ShaderMaterial;return K.Material.prototype.clone.call(this,e),e.fragmentShader=this.fragmentShader,e.vertexShader=this.vertexShader,e.uniforms=K.UniformsUtils.clone(this.uniforms),e.attributes=this.attributes,e.defines=this.defines,e.shading=this.shading,e.wireframe=this.wireframe,e.wireframeLinewidth=this.wireframeLinewidth,e.fog=this.fog,e.lights=this.lights,e.vertexColors=this.vertexColors,e.skinning=this.skinning,e.morphTargets=this.morphTargets,e.morphNormals=this.morphNormals,e},K.RawShaderMaterial=function(e){K.ShaderMaterial.call(this,e),this.type="RawShaderMaterial"},K.RawShaderMaterial.prototype=Object.create(K.ShaderMaterial.prototype),K.RawShaderMaterial.prototype.constructor=K.RawShaderMaterial,K.RawShaderMaterial.prototype.clone=function(){var e=new K.RawShaderMaterial;return K.ShaderMaterial.prototype.clone.call(this,e),e},K.SpriteMaterial=function(e){K.Material.call(this),this.type="SpriteMaterial",this.color=new K.Color(16777215),this.map=null,this.rotation=0,this.fog=!1,this.setValues(e)},K.SpriteMaterial.prototype=Object.create(K.Material.prototype),K.SpriteMaterial.prototype.constructor=K.SpriteMaterial,K.SpriteMaterial.prototype.clone=function(){var e=new K.SpriteMaterial;return K.Material.prototype.clone.call(this,e),e.color.copy(this.color),e.map=this.map,e.rotation=this.rotation,e.fog=this.fog,e},K.Texture=function(e,t,r,n,i,o,a,s,l){Object.defineProperty(this,"id",{value:K.TextureIdCount++}),this.uuid=K.Math.generateUUID(),this.name="",this.sourceFile="",this.image=void 0!==e?e:K.Texture.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=void 0!==t?t:K.Texture.DEFAULT_MAPPING,this.wrapS=void 0!==r?r:K.ClampToEdgeWrapping,this.wrapT=void 0!==n?n:K.ClampToEdgeWrapping,this.magFilter=void 0!==i?i:K.LinearFilter,this.minFilter=void 0!==o?o:K.LinearMipMapLinearFilter,this.anisotropy=void 0!==l?l:1,this.format=void 0!==a?a:K.RGBAFormat,this.type=void 0!==s?s:K.UnsignedByteType,this.offset=new K.Vector2(0,0),this.repeat=new K.Vector2(1,1),this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this._needsUpdate=!1,this.onUpdate=null},K.Texture.DEFAULT_IMAGE=void 0,K.Texture.DEFAULT_MAPPING=K.UVMapping,K.Texture.prototype={constructor:K.Texture,get needsUpdate(){return this._needsUpdate},set needsUpdate(e){!0===e&&this.update(),this._needsUpdate=e},clone:function(e){return void 0===e&&(e=new K.Texture),e.image=this.image,e.mipmaps=this.mipmaps.slice(0),e.mapping=this.mapping,e.wrapS=this.wrapS,e.wrapT=this.wrapT,e.magFilter=this.magFilter,e.minFilter=this.minFilter,e.anisotropy=this.anisotropy,e.format=this.format,e.type=this.type,e.offset.copy(this.offset),e.repeat.copy(this.repeat),e.generateMipmaps=this.generateMipmaps,e.premultiplyAlpha=this.premultiplyAlpha,e.flipY=this.flipY,e.unpackAlignment=this.unpackAlignment,e},update:function(){this.dispatchEvent({type:"update"})},dispose:function(){this.dispatchEvent({type:"dispose"})}},K.EventDispatcher.prototype.apply(K.Texture.prototype),K.TextureIdCount=0,K.CubeTexture=function(e,t,r,n,i,o,a,s,l){t=void 0!==t?t:K.CubeReflectionMapping,K.Texture.call(this,e,t,r,n,i,o,a,s,l),this.images=e},K.CubeTexture.prototype=Object.create(K.Texture.prototype),K.CubeTexture.prototype.constructor=K.CubeTexture,K.CubeTexture.clone=function(e){return void 0===e&&(e=new K.CubeTexture),K.Texture.prototype.clone.call(this,e),e.images=this.images,e},K.CompressedTexture=function(e,t,r,n,i,o,a,s,l,u,c){K.Texture.call(this,null,o,a,s,l,u,n,i,c),this.image={width:t,height:r},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1},K.CompressedTexture.prototype=Object.create(K.Texture.prototype),K.CompressedTexture.prototype.constructor=K.CompressedTexture,K.CompressedTexture.prototype.clone=function(){var e=new K.CompressedTexture;return K.Texture.prototype.clone.call(this,e),e},K.DataTexture=function(e,t,r,n,i,o,a,s,l,u,c){K.Texture.call(this,null,o,a,s,l,u,n,i,c),this.image={data:e,width:t,height:r}},K.DataTexture.prototype=Object.create(K.Texture.prototype),K.DataTexture.prototype.constructor=K.DataTexture,K.DataTexture.prototype.clone=function(){var e=new K.DataTexture;return K.Texture.prototype.clone.call(this,e),e},K.VideoTexture=function(e,t,r,n,i,o,a,s,l){K.Texture.call(this,e,t,r,n,i,o,a,s,l),this.generateMipmaps=!1;var u=this;!function t(){requestAnimationFrame(t),e.readyState===e.HAVE_ENOUGH_DATA&&(u.needsUpdate=!0)}()},K.VideoTexture.prototype=Object.create(K.Texture.prototype),K.VideoTexture.prototype.constructor=K.VideoTexture,K.Group=function(){K.Object3D.call(this),this.type="Group"},K.Group.prototype=Object.create(K.Object3D.prototype),K.Group.prototype.constructor=K.Group,K.PointCloud=function(e,t){K.Object3D.call(this),this.type="PointCloud",this.geometry=void 0!==e?e:new K.Geometry,this.material=void 0!==t?t:new K.PointCloudMaterial({color:16777215*Math.random()})},K.PointCloud.prototype=Object.create(K.Object3D.prototype),K.PointCloud.prototype.constructor=K.PointCloud,K.PointCloud.prototype.raycast=(C=new K.Matrix4,P=new K.Ray,function(e,t){var r=this,n=r.geometry,i=e.params.PointCloud.threshold;if(C.getInverse(this.matrixWorld),P.copy(e.ray).applyMatrix4(C),null===n.boundingBox||!1!==P.isIntersectionBox(n.boundingBox)){var o=i/((this.scale.x+this.scale.y+this.scale.z)/3),a=new K.Vector3,s=function(n,i){var a=P.distanceToPoint(n);if(a<o){var s=P.closestPointToPoint(n);s.applyMatrix4(r.matrixWorld);var l=e.ray.origin.distanceTo(s);t.push({distance:l,distanceToRay:a,point:s.clone(),index:i,face:null,object:r})}};if(n instanceof K.BufferGeometry){var l=n.attributes,u=l.position.array;if(void 0!==l.index){var c=l.index.array,h=n.offsets;0===h.length&&(h=[{start:0,count:c.length,index:0}]);for(var d=0,f=h.length;d<f;++d)for(var p=h[d].start,m=h[d].count,g=h[d].index,v=p,y=p+m;v<y;v++){var b=g+c[v];a.fromArray(u,3*b),s(a,b)}}else{var x=u.length/3;for(v=0;v<x;v++)a.set(u[3*v],u[3*v+1],u[3*v+2]),s(a,v)}}else{var _=this.geometry.vertices;for(v=0;v<_.length;v++)s(_[v],v)}}}),K.PointCloud.prototype.clone=function(e){return void 0===e&&(e=new K.PointCloud(this.geometry,this.material)),K.Object3D.prototype.clone.call(this,e),e},K.ParticleSystem=function(e,t){return K.warn("THREE.ParticleSystem has been renamed to THREE.PointCloud."),new K.PointCloud(e,t)},K.Line=function(e,t,r){K.Object3D.call(this),this.type="Line",this.geometry=void 0!==e?e:new K.Geometry,this.material=void 0!==t?t:new K.LineBasicMaterial({color:16777215*Math.random()}),this.mode=void 0!==r?r:K.LineStrip},K.LineStrip=0,K.LinePieces=1,K.Line.prototype=Object.create(K.Object3D.prototype),K.Line.prototype.constructor=K.Line,K.Line.prototype.raycast=function(){var e=new K.Matrix4,t=new K.Ray,r=new K.Sphere;return function(n,i){var o=n.linePrecision,a=o*o,s=this.geometry;if(null===s.boundingSphere&&s.computeBoundingSphere(),r.copy(s.boundingSphere),r.applyMatrix4(this.matrixWorld),!1!==n.ray.isIntersectionSphere(r)){e.getInverse(this.matrixWorld),t.copy(n.ray).applyMatrix4(e);var l=new K.Vector3,u=new K.Vector3,c=new K.Vector3,h=new K.Vector3,d=this.mode===K.LineStrip?1:2;if(s instanceof K.BufferGeometry){var f=s.attributes;if(void 0!==f.index){var p=f.index.array,m=f.position.array,g=s.offsets;0===g.length&&(g=[{start:0,count:p.length,index:0}]);for(var v=0;v<g.length;v++)for(var y=g[v].start,b=g[v].count,x=g[v].index,_=y;_<y+b-1;_+=d){var E=x+p[_],w=x+p[_+1];if(l.fromArray(m,3*E),u.fromArray(m,3*w),!(t.distanceSqToSegment(l,u,h,c)>a))(M=t.origin.distanceTo(h))<n.near||M>n.far||i.push({distance:M,point:c.clone().applyMatrix4(this.matrixWorld),index:_,offsetIndex:v,face:null,faceIndex:null,object:this})}}else for(m=f.position.array,_=0;_<m.length/3-1;_+=d){if(l.fromArray(m,3*_),u.fromArray(m,3*_+3),!(t.distanceSqToSegment(l,u,h,c)>a))(M=t.origin.distanceTo(h))<n.near||M>n.far||i.push({distance:M,point:c.clone().applyMatrix4(this.matrixWorld),index:_,face:null,faceIndex:null,object:this})}}else if(s instanceof K.Geometry){var A=s.vertices,S=A.length;for(_=0;_<S-1;_+=d){var M;if(!(t.distanceSqToSegment(A[_],A[_+1],h,c)>a))(M=t.origin.distanceTo(h))<n.near||M>n.far||i.push({distance:M,point:c.clone().applyMatrix4(this.matrixWorld),index:_,face:null,faceIndex:null,object:this})}}}}}(),K.Line.prototype.clone=function(e){return void 0===e&&(e=new K.Line(this.geometry,this.material,this.mode)),K.Object3D.prototype.clone.call(this,e),e},K.Mesh=function(e,t){K.Object3D.call(this),this.type="Mesh",this.geometry=void 0!==e?e:new K.Geometry,this.material=void 0!==t?t:new K.MeshBasicMaterial({color:16777215*Math.random()}),this.updateMorphTargets()},K.Mesh.prototype=Object.create(K.Object3D.prototype),K.Mesh.prototype.constructor=K.Mesh,K.Mesh.prototype.updateMorphTargets=function(){if(void 0!==this.geometry.morphTargets&&this.geometry.morphTargets.length>0){this.morphTargetBase=-1,this.morphTargetForcedOrder=[],this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var e=0,t=this.geometry.morphTargets.length;e<t;e++)this.morphTargetInfluences.push(0),this.morphTargetDictionary[this.geometry.morphTargets[e].name]=e}},K.Mesh.prototype.getMorphTargetIndexByName=function(e){return void 0!==this.morphTargetDictionary[e]?this.morphTargetDictionary[e]:(K.warn("THREE.Mesh.getMorphTargetIndexByName: morph target "+e+" does not exist. Returning 0."),0)},K.Mesh.prototype.raycast=function(){var e=new K.Matrix4,t=new K.Ray,r=new K.Sphere,n=new K.Vector3,i=new K.Vector3,o=new K.Vector3;return function(a,s){var l=this.geometry;if(null===l.boundingSphere&&l.computeBoundingSphere(),r.copy(l.boundingSphere),r.applyMatrix4(this.matrixWorld),!1!==a.ray.isIntersectionSphere(r)&&(e.getInverse(this.matrixWorld),t.copy(a.ray).applyMatrix4(e),null===l.boundingBox||!1!==t.isIntersectionBox(l.boundingBox)))if(l instanceof K.BufferGeometry){if(void 0===(L=this.material))return;var u=l.attributes,c=a.precision;if(void 0!==u.index){var h=u.index.array,d=u.position.array,f=l.offsets;0===f.length&&(f=[{start:0,count:h.length,index:0}]);for(var p=0,m=f.length;p<m;++p)for(var g=f[p].start,v=f[p].count,y=f[p].index,b=g,x=g+v;b<x;b+=3){if(w=y+h[b],A=y+h[b+1],S=y+h[b+2],n.fromArray(d,3*w),i.fromArray(d,3*A),o.fromArray(d,3*S),L.side===K.BackSide)var _=t.intersectTriangle(o,i,n,!0);else _=t.intersectTriangle(n,i,o,L.side!==K.DoubleSide);if(null!==_)_.applyMatrix4(this.matrixWorld),(U=a.ray.origin.distanceTo(_))<c||U<a.near||U>a.far||s.push({distance:U,point:_,face:new K.Face3(w,A,S,K.Triangle.normal(n,i,o)),faceIndex:null,object:this})}}else{b=0;var E=0;for(x=(d=u.position.array).length;b<x;b+=3,E+=9){if(w=b,A=b+1,S=b+2,n.fromArray(d,E),i.fromArray(d,E+3),o.fromArray(d,E+6),L.side===K.BackSide)_=t.intersectTriangle(o,i,n,!0);else _=t.intersectTriangle(n,i,o,L.side!==K.DoubleSide);if(null!==_)_.applyMatrix4(this.matrixWorld),(U=a.ray.origin.distanceTo(_))<c||U<a.near||U>a.far||s.push({distance:U,point:_,face:new K.Face3(w,A,S,K.Triangle.normal(n,i,o)),faceIndex:null,object:this})}}}else if(l instanceof K.Geometry)for(var w,A,S,M=this.material instanceof K.MeshFaceMaterial,T=!0===M?this.material.materials:null,C=(c=a.precision,l.vertices),P=0,D=l.faces.length;P<D;P++){var L,R=l.faces[P];if(void 0!==(L=!0===M?T[R.materialIndex]:this.material)){if(w=C[R.a],A=C[R.b],S=C[R.c],!0===L.morphTargets){var I=l.morphTargets,O=this.morphTargetInfluences;n.set(0,0,0),i.set(0,0,0),o.set(0,0,0);for(var N=0,k=I.length;N<k;N++){var F=O[N];if(0!==F){var V=I[N].vertices;n.x+=(V[R.a].x-w.x)*F,n.y+=(V[R.a].y-w.y)*F,n.z+=(V[R.a].z-w.z)*F,i.x+=(V[R.b].x-A.x)*F,i.y+=(V[R.b].y-A.y)*F,i.z+=(V[R.b].z-A.z)*F,o.x+=(V[R.c].x-S.x)*F,o.y+=(V[R.c].y-S.y)*F,o.z+=(V[R.c].z-S.z)*F}}n.add(w),i.add(A),o.add(S),w=n,A=i,S=o}if(L.side===K.BackSide)_=t.intersectTriangle(S,A,w,!0);else _=t.intersectTriangle(w,A,S,L.side!==K.DoubleSide);var U;if(null!==_)_.applyMatrix4(this.matrixWorld),(U=a.ray.origin.distanceTo(_))<c||U<a.near||U>a.far||s.push({distance:U,point:_,face:R,faceIndex:P,object:this})}}}}(),K.Mesh.prototype.clone=function(e,t){return void 0===e&&(e=new K.Mesh(this.geometry,this.material)),K.Object3D.prototype.clone.call(this,e,t),e},K.Bone=function(e){K.Object3D.call(this),this.type="Bone",this.skin=e},K.Bone.prototype=Object.create(K.Object3D.prototype),K.Bone.prototype.constructor=K.Bone,K.Skeleton=function(e,t,r){var n;(this.useVertexTexture=void 0===r||r,this.identityMatrix=new K.Matrix4,e=e||[],this.bones=e.slice(0),this.useVertexTexture)?(n=this.bones.length>256?64:this.bones.length>64?32:this.bones.length>16?16:8,this.boneTextureWidth=n,this.boneTextureHeight=n,this.boneMatrices=new Float32Array(this.boneTextureWidth*this.boneTextureHeight*4),this.boneTexture=new K.DataTexture(this.boneMatrices,this.boneTextureWidth,this.boneTextureHeight,K.RGBAFormat,K.FloatType),this.boneTexture.minFilter=K.NearestFilter,this.boneTexture.magFilter=K.NearestFilter,this.boneTexture.generateMipmaps=!1,this.boneTexture.flipY=!1):this.boneMatrices=new Float32Array(16*this.bones.length);if(void 0===t)this.calculateInverses();else if(this.bones.length===t.length)this.boneInverses=t.slice(0);else{K.warn("THREE.Skeleton bonInverses is the wrong length."),this.boneInverses=[];for(var i=0,o=this.bones.length;i<o;i++)this.boneInverses.push(new K.Matrix4)}},K.Skeleton.prototype.calculateInverses=function(){this.boneInverses=[];for(var e=0,t=this.bones.length;e<t;e++){var r=new K.Matrix4;this.bones[e]&&r.getInverse(this.bones[e].matrixWorld),this.boneInverses.push(r)}},K.Skeleton.prototype.pose=function(){for(var e,t=0,r=this.bones.length;t<r;t++)(e=this.bones[t])&&e.matrixWorld.getInverse(this.boneInverses[t]);for(t=0,r=this.bones.length;t<r;t++)(e=this.bones[t])&&(e.parent?(e.matrix.getInverse(e.parent.matrixWorld),e.matrix.multiply(e.matrixWorld)):e.matrix.copy(e.matrixWorld),e.matrix.decompose(e.position,e.quaternion,e.scale))},K.Skeleton.prototype.update=(D=new K.Matrix4,function(){for(var e=0,t=this.bones.length;e<t;e++){var r=this.bones[e]?this.bones[e].matrixWorld:this.identityMatrix;D.multiplyMatrices(r,this.boneInverses[e]),D.flattenToArrayOffset(this.boneMatrices,16*e)}this.useVertexTexture&&(this.boneTexture.needsUpdate=!0)}),K.SkinnedMesh=function(e,t,r){K.Mesh.call(this,e,t),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new K.Matrix4,this.bindMatrixInverse=new K.Matrix4;var n=[];if(this.geometry&&void 0!==this.geometry.bones){for(var i,o,a,s,l,u=0,c=this.geometry.bones.length;u<c;++u)a=(o=this.geometry.bones[u]).pos,s=o.rotq,l=o.scl,i=new K.Bone(this),n.push(i),i.name=o.name,i.position.set(a[0],a[1],a[2]),i.quaternion.set(s[0],s[1],s[2],s[3]),void 0!==l?i.scale.set(l[0],l[1],l[2]):i.scale.set(1,1,1);for(u=0,c=this.geometry.bones.length;u<c;++u)-1!==(o=this.geometry.bones[u]).parent?n[o.parent].add(n[u]):this.add(n[u])}this.normalizeSkinWeights(),this.updateMatrixWorld(!0),this.bind(new K.Skeleton(n,void 0,r))},K.SkinnedMesh.prototype=Object.create(K.Mesh.prototype),K.SkinnedMesh.prototype.constructor=K.SkinnedMesh,K.SkinnedMesh.prototype.bind=function(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.getInverse(t)},K.SkinnedMesh.prototype.pose=function(){this.skeleton.pose()},K.SkinnedMesh.prototype.normalizeSkinWeights=function(){if(this.geometry instanceof K.Geometry)for(var e=0;e<this.geometry.skinIndices.length;e++){var t=this.geometry.skinWeights[e],r=1/t.lengthManhattan();r!==1/0?t.multiplyScalar(r):t.set(1)}},K.SkinnedMesh.prototype.updateMatrixWorld=function(e){K.Mesh.prototype.updateMatrixWorld.call(this,!0),"attached"===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):K.warn("THREE.SkinnedMesh unreckognized bindMode: "+this.bindMode)},K.SkinnedMesh.prototype.clone=function(e){return void 0===e&&(e=new K.SkinnedMesh(this.geometry,this.material,this.useVertexTexture)),K.Mesh.prototype.clone.call(this,e),e},K.MorphAnimMesh=function(e,t){K.Mesh.call(this,e,t),this.type="MorphAnimMesh",this.duration=1e3,this.mirroredLoop=!1,this.time=0,this.lastKeyframe=0,this.currentKeyframe=0,this.direction=1,this.directionBackwards=!1,this.setFrameRange(0,this.geometry.morphTargets.length-1)},K.MorphAnimMesh.prototype=Object.create(K.Mesh.prototype),K.MorphAnimMesh.prototype.constructor=K.MorphAnimMesh,K.MorphAnimMesh.prototype.setFrameRange=function(e,t){this.startKeyframe=e,this.endKeyframe=t,this.length=this.endKeyframe-this.startKeyframe+1},K.MorphAnimMesh.prototype.setDirectionForward=function(){this.direction=1,this.directionBackwards=!1},K.MorphAnimMesh.prototype.setDirectionBackward=function(){this.direction=-1,this.directionBackwards=!0},K.MorphAnimMesh.prototype.parseAnimations=function(){var e=this.geometry;e.animations||(e.animations={});for(var t,r=e.animations,n=/([a-z]+)_?(\d+)/,i=0,o=e.morphTargets.length;i<o;i++){var a=e.morphTargets[i].name.match(n);if(a&&a.length>1){var s=a[1];r[s]||(r[s]={start:1/0,end:-1/0});var l=r[s];i<l.start&&(l.start=i),i>l.end&&(l.end=i),t||(t=s)}}e.firstAnimation=t},K.MorphAnimMesh.prototype.setAnimationLabel=function(e,t,r){this.geometry.animations||(this.geometry.animations={}),this.geometry.animations[e]={start:t,end:r}},K.MorphAnimMesh.prototype.playAnimation=function(e,t){var r=this.geometry.animations[e];r?(this.setFrameRange(r.start,r.end),this.duration=(r.end-r.start)/t*1e3,this.time=0):K.warn("THREE.MorphAnimMesh: animation["+e+"] undefined in .playAnimation()")},K.MorphAnimMesh.prototype.updateAnimation=function(e){var t=this.duration/this.length;this.time+=this.direction*e,this.mirroredLoop?(this.time>this.duration||this.time<0)&&(this.direction*=-1,this.time>this.duration&&(this.time=this.duration,this.directionBackwards=!0),this.time<0&&(this.time=0,this.directionBackwards=!1)):(this.time=this.time%this.duration,this.time<0&&(this.time+=this.duration));var r=this.startKeyframe+K.Math.clamp(Math.floor(this.time/t),0,this.length-1);r!==this.currentKeyframe&&(this.morphTargetInfluences[this.lastKeyframe]=0,this.morphTargetInfluences[this.currentKeyframe]=1,this.morphTargetInfluences[r]=0,this.lastKeyframe=this.currentKeyframe,this.currentKeyframe=r);var n=this.time%t/t;this.directionBackwards&&(n=1-n),this.morphTargetInfluences[this.currentKeyframe]=n,this.morphTargetInfluences[this.lastKeyframe]=1-n},K.MorphAnimMesh.prototype.interpolateTargets=function(e,t,r){for(var n=this.morphTargetInfluences,i=0,o=n.length;i<o;i++)n[i]=0;e>-1&&(n[e]=1-r),t>-1&&(n[t]=r)},K.MorphAnimMesh.prototype.clone=function(e){return void 0===e&&(e=new K.MorphAnimMesh(this.geometry,this.material)),e.duration=this.duration,e.mirroredLoop=this.mirroredLoop,e.time=this.time,e.lastKeyframe=this.lastKeyframe,e.currentKeyframe=this.currentKeyframe,e.direction=this.direction,e.directionBackwards=this.directionBackwards,K.Mesh.prototype.clone.call(this,e),e},K.LOD=function(){K.Object3D.call(this),this.objects=[]},K.LOD.prototype=Object.create(K.Object3D.prototype),K.LOD.prototype.constructor=K.LOD,K.LOD.prototype.addLevel=function(e,t){void 0===t&&(t=0),t=Math.abs(t);for(var r=0;r<this.objects.length&&!(t<this.objects[r].distance);r++);this.objects.splice(r,0,{distance:t,object:e}),this.add(e)},K.LOD.prototype.getObjectForDistance=function(e){for(var t=1,r=this.objects.length;t<r&&!(e<this.objects[t].distance);t++);return this.objects[t-1].object},K.LOD.prototype.raycast=(L=new K.Vector3,function(e,t){L.setFromMatrixPosition(this.matrixWorld);var r=e.ray.origin.distanceTo(L);this.getObjectForDistance(r).raycast(e,t)}),K.LOD.prototype.update=function(){var e=new K.Vector3,t=new K.Vector3;return function(r){if(this.objects.length>1){e.setFromMatrixPosition(r.matrixWorld),t.setFromMatrixPosition(this.matrixWorld);var n=e.distanceTo(t);this.objects[0].object.visible=!0;for(var i=1,o=this.objects.length;i<o&&n>=this.objects[i].distance;i++)this.objects[i-1].object.visible=!1,this.objects[i].object.visible=!0;for(;i<o;i++)this.objects[i].object.visible=!1}}}(),K.LOD.prototype.clone=function(e){void 0===e&&(e=new K.LOD),K.Object3D.prototype.clone.call(this,e);for(var t=0,r=this.objects.length;t<r;t++){var n=this.objects[t].object.clone();n.visible=0===t,e.addLevel(n,this.objects[t].distance)}return e},K.Sprite=(R=new Uint16Array([0,1,2,0,2,3]),I=new Float32Array([-.5,-.5,0,.5,-.5,0,.5,.5,0,-.5,.5,0]),O=new Float32Array([0,0,1,0,1,1,0,1]),(N=new K.BufferGeometry).setAttribute("index",new K.BufferAttribute(R,1)),N.setAttribute("position",new K.BufferAttribute(I,3)),N.setAttribute("uv",new K.BufferAttribute(O,2)),function(e){K.Object3D.call(this),this.type="Sprite",this.geometry=N,this.material=void 0!==e?e:new K.SpriteMaterial}),K.Sprite.prototype=Object.create(K.Object3D.prototype),K.Sprite.prototype.constructor=K.Sprite,K.Sprite.prototype.raycast=function(){var e=new K.Vector3;return function(t,r){e.setFromMatrixPosition(this.matrixWorld);var n=t.ray.distanceToPoint(e);n>this.scale.x||r.push({distance:n,point:this.position,face:null,object:this})}}(),K.Sprite.prototype.clone=function(e){return void 0===e&&(e=new K.Sprite(this.material)),K.Object3D.prototype.clone.call(this,e),e},K.Particle=K.Sprite,K.LensFlare=function(e,t,r,n,i){K.Object3D.call(this),this.lensFlares=[],this.positionScreen=new K.Vector3,this.customUpdateCallback=void 0,void 0!==e&&this.add(e,t,r,n,i)},K.LensFlare.prototype=Object.create(K.Object3D.prototype),K.LensFlare.prototype.constructor=K.LensFlare,K.LensFlare.prototype.add=function(e,t,r,n,i,o){void 0===t&&(t=-1),void 0===r&&(r=0),void 0===o&&(o=1),void 0===i&&(i=new K.Color(16777215)),void 0===n&&(n=K.NormalBlending),r=Math.min(r,Math.max(0,r)),this.lensFlares.push({texture:e,size:t,distance:r,x:0,y:0,z:0,scale:1,rotation:1,opacity:o,color:i,blending:n})},K.LensFlare.prototype.updateLensFlares=function(){var e,t,r=this.lensFlares.length,n=2*-this.positionScreen.x,i=2*-this.positionScreen.y;for(e=0;e<r;e++)(t=this.lensFlares[e]).x=this.positionScreen.x+n*t.distance,t.y=this.positionScreen.y+i*t.distance,t.wantedRotation=t.x*Math.PI*.25,t.rotation+=.25*(t.wantedRotation-t.rotation)},K.Scene=function(){K.Object3D.call(this),this.type="Scene",this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0},K.Scene.prototype=Object.create(K.Object3D.prototype),K.Scene.prototype.constructor=K.Scene,K.Scene.prototype.clone=function(e){return void 0===e&&(e=new K.Scene),K.Object3D.prototype.clone.call(this,e),null!==this.fog&&(e.fog=this.fog.clone()),null!==this.overrideMaterial&&(e.overrideMaterial=this.overrideMaterial.clone()),e.autoUpdate=this.autoUpdate,e.matrixAutoUpdate=this.matrixAutoUpdate,e},K.Fog=function(e,t,r){this.name="",this.color=new K.Color(e),this.near=void 0!==t?t:1,this.far=void 0!==r?r:1e3},K.Fog.prototype.clone=function(){return new K.Fog(this.color.getHex(),this.near,this.far)},K.FogExp2=function(e,t){this.name="",this.color=new K.Color(e),this.density=void 0!==t?t:25e-5},K.FogExp2.prototype.clone=function(){return new K.FogExp2(this.color.getHex(),this.density)},K.ShaderChunk={},K.ShaderChunk.common="#define PI 3.14159\n#define PI2 6.28318\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n\nfloat square( in float a ) { return a*a; }\nvec2  square( in vec2 a )  { return vec2( a.x*a.x, a.y*a.y ); }\nvec3  square( in vec3 a )  { return vec3( a.x*a.x, a.y*a.y, a.z*a.z ); }\nvec4  square( in vec4 a )  { return vec4( a.x*a.x, a.y*a.y, a.z*a.z, a.w*a.w ); }\nfloat saturate( in float a ) { return clamp( a, 0.0, 1.0 ); }\nvec2  saturate( in vec2 a )  { return clamp( a, 0.0, 1.0 ); }\nvec3  saturate( in vec3 a )  { return clamp( a, 0.0, 1.0 ); }\nvec4  saturate( in vec4 a )  { return clamp( a, 0.0, 1.0 ); }\nfloat average( in float a ) { return a; }\nfloat average( in vec2 a )  { return ( a.x + a.y) * 0.5; }\nfloat average( in vec3 a )  { return ( a.x + a.y + a.z) / 3.0; }\nfloat average( in vec4 a )  { return ( a.x + a.y + a.z + a.w) * 0.25; }\nfloat whiteCompliment( in float a ) { return saturate( 1.0 - a ); }\nvec2  whiteCompliment( in vec2 a )  { return saturate( vec2(1.0) - a ); }\nvec3  whiteCompliment( in vec3 a )  { return saturate( vec3(1.0) - a ); }\nvec4  whiteCompliment( in vec4 a )  { return saturate( vec4(1.0) - a ); }\nvec3 transformDirection( in vec3 normal, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( normal, 0.0 ) ).xyz );\n}\n// http://en.wikibooks.org/wiki/GLSL_Programming/Applying_Matrix_Transformations\nvec3 inverseTransformDirection( in vec3 normal, in mat4 matrix ) {\n\treturn normalize( ( vec4( normal, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal) {\n\tfloat distance = dot( planeNormal, point-pointOnPlane );\n\treturn point - distance * planeNormal;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn pointOnLine + lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) );\n}\nfloat calcLightAttenuation( float lightDistance, float cutoffDistance, float decayExponent ) {\n\tif ( decayExponent > 0.0 ) {\n\t  return pow( saturate( 1.0 - lightDistance / cutoffDistance ), decayExponent );\n\t}\n\treturn 1.0;\n}\n\nvec3 inputToLinear( in vec3 a ) {\n#ifdef GAMMA_INPUT\n\treturn pow( a, vec3( float( GAMMA_FACTOR ) ) );\n#else\n\treturn a;\n#endif\n}\nvec3 linearToOutput( in vec3 a ) {\n#ifdef GAMMA_OUTPUT\n\treturn pow( a, vec3( 1.0 / float( GAMMA_FACTOR ) ) );\n#else\n\treturn a;\n#endif\n}\n",K.ShaderChunk.alphatest_fragment="#ifdef ALPHATEST\n\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n\n#endif\n",K.ShaderChunk.lights_lambert_vertex="vLightFront = vec3( 0.0 );\n\n#ifdef DOUBLE_SIDED\n\n\tvLightBack = vec3( 0.0 );\n\n#endif\n\ntransformedNormal = normalize( transformedNormal );\n\n#if MAX_DIR_LIGHTS > 0\n\nfor( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {\n\n\tvec3 dirVector = transformDirection( directionalLightDirection[ i ], viewMatrix );\n\n\tfloat dotProduct = dot( transformedNormal, dirVector );\n\tvec3 directionalLightWeighting = vec3( max( dotProduct, 0.0 ) );\n\n\t#ifdef DOUBLE_SIDED\n\n\t\tvec3 directionalLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );\n\n\t\t#ifdef WRAP_AROUND\n\n\t\t\tvec3 directionalLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );\n\n\t\t#endif\n\n\t#endif\n\n\t#ifdef WRAP_AROUND\n\n\t\tvec3 directionalLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );\n\t\tdirectionalLightWeighting = mix( directionalLightWeighting, directionalLightWeightingHalf, wrapRGB );\n\n\t\t#ifdef DOUBLE_SIDED\n\n\t\t\tdirectionalLightWeightingBack = mix( directionalLightWeightingBack, directionalLightWeightingHalfBack, wrapRGB );\n\n\t\t#endif\n\n\t#endif\n\n\tvLightFront += directionalLightColor[ i ] * directionalLightWeighting;\n\n\t#ifdef DOUBLE_SIDED\n\n\t\tvLightBack += directionalLightColor[ i ] * directionalLightWeightingBack;\n\n\t#endif\n\n}\n\n#endif\n\n#if MAX_POINT_LIGHTS > 0\n\n\tfor( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\n\n\t\tvec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\n\t\tvec3 lVector = lPosition.xyz - mvPosition.xyz;\n\n\t\tfloat attenuation = calcLightAttenuation( length( lVector ), pointLightDistance[ i ], pointLightDecay[ i ] );\n\n\t\tlVector = normalize( lVector );\n\t\tfloat dotProduct = dot( transformedNormal, lVector );\n\n\t\tvec3 pointLightWeighting = vec3( max( dotProduct, 0.0 ) );\n\n\t\t#ifdef DOUBLE_SIDED\n\n\t\t\tvec3 pointLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );\n\n\t\t\t#ifdef WRAP_AROUND\n\n\t\t\t\tvec3 pointLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );\n\n\t\t\t#endif\n\n\t\t#endif\n\n\t\t#ifdef WRAP_AROUND\n\n\t\t\tvec3 pointLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );\n\t\t\tpointLightWeighting = mix( pointLightWeighting, pointLightWeightingHalf, wrapRGB );\n\n\t\t\t#ifdef DOUBLE_SIDED\n\n\t\t\t\tpointLightWeightingBack = mix( pointLightWeightingBack, pointLightWeightingHalfBack, wrapRGB );\n\n\t\t\t#endif\n\n\t\t#endif\n\n\t\tvLightFront += pointLightColor[ i ] * pointLightWeighting * attenuation;\n\n\t\t#ifdef DOUBLE_SIDED\n\n\t\t\tvLightBack += pointLightColor[ i ] * pointLightWeightingBack * attenuation;\n\n\t\t#endif\n\n\t}\n\n#endif\n\n#if MAX_SPOT_LIGHTS > 0\n\n\tfor( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\n\n\t\tvec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );\n\t\tvec3 lVector = lPosition.xyz - mvPosition.xyz;\n\n\t\tfloat spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - worldPosition.xyz ) );\n\n\t\tif ( spotEffect > spotLightAngleCos[ i ] ) {\n\n\t\t\tspotEffect = max( pow( max( spotEffect, 0.0 ), spotLightExponent[ i ] ), 0.0 );\n\n\t\t\tfloat attenuation = calcLightAttenuation( length( lVector ), spotLightDistance[ i ], spotLightDecay[ i ] );\n\n\t\t\tlVector = normalize( lVector );\n\n\t\t\tfloat dotProduct = dot( transformedNormal, lVector );\n\t\t\tvec3 spotLightWeighting = vec3( max( dotProduct, 0.0 ) );\n\n\t\t\t#ifdef DOUBLE_SIDED\n\n\t\t\t\tvec3 spotLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );\n\n\t\t\t\t#ifdef WRAP_AROUND\n\n\t\t\t\t\tvec3 spotLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );\n\n\t\t\t\t#endif\n\n\t\t\t#endif\n\n\t\t\t#ifdef WRAP_AROUND\n\n\t\t\t\tvec3 spotLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );\n\t\t\t\tspotLightWeighting = mix( spotLightWeighting, spotLightWeightingHalf, wrapRGB );\n\n\t\t\t\t#ifdef DOUBLE_SIDED\n\n\t\t\t\t\tspotLightWeightingBack = mix( spotLightWeightingBack, spotLightWeightingHalfBack, wrapRGB );\n\n\t\t\t\t#endif\n\n\t\t\t#endif\n\n\t\t\tvLightFront += spotLightColor[ i ] * spotLightWeighting * attenuation * spotEffect;\n\n\t\t\t#ifdef DOUBLE_SIDED\n\n\t\t\t\tvLightBack += spotLightColor[ i ] * spotLightWeightingBack * attenuation * spotEffect;\n\n\t\t\t#endif\n\n\t\t}\n\n\t}\n\n#endif\n\n#if MAX_HEMI_LIGHTS > 0\n\n\tfor( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {\n\n\t\tvec3 lVector = transformDirection( hemisphereLightDirection[ i ], viewMatrix );\n\n\t\tfloat dotProduct = dot( transformedNormal, lVector );\n\n\t\tfloat hemiDiffuseWeight = 0.5 * dotProduct + 0.5;\n\t\tfloat hemiDiffuseWeightBack = -0.5 * dotProduct + 0.5;\n\n\t\tvLightFront += mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );\n\n\t\t#ifdef DOUBLE_SIDED\n\n\t\t\tvLightBack += mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeightBack );\n\n\t\t#endif\n\n\t}\n\n#endif\n\nvLightFront += ambientLightColor;\n\n#ifdef DOUBLE_SIDED\n\n\tvLightBack += ambientLightColor;\n\n#endif\n",K.ShaderChunk.map_particle_pars_fragment="#ifdef USE_MAP\n\n\tuniform vec4 offsetRepeat;\n\tuniform sampler2D map;\n\n#endif\n",K.ShaderChunk.default_vertex="#ifdef USE_SKINNING\n\n\tvec4 mvPosition = modelViewMatrix * skinned;\n\n#elif defined( USE_MORPHTARGETS )\n\n\tvec4 mvPosition = modelViewMatrix * vec4( morphed, 1.0 );\n\n#else\n\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\n#endif\n\ngl_Position = projectionMatrix * mvPosition;\n",K.ShaderChunk.map_pars_fragment="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP )\n\n\tvarying vec2 vUv;\n\n#endif\n\n#ifdef USE_MAP\n\n\tuniform sampler2D map;\n\n#endif",K.ShaderChunk.skinnormal_vertex="#ifdef USE_SKINNING\n\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\n\t#ifdef USE_MORPHNORMALS\n\n\tvec4 skinnedNormal = skinMatrix * vec4( morphedNormal, 0.0 );\n\n\t#else\n\n\tvec4 skinnedNormal = skinMatrix * vec4( normal, 0.0 );\n\n\t#endif\n\n#endif\n",K.ShaderChunk.logdepthbuf_pars_vertex="#ifdef USE_LOGDEPTHBUF\n\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\n\t\tvarying float vFragDepth;\n\n\t#endif\n\n\tuniform float logDepthBufFC;\n\n#endif",K.ShaderChunk.lightmap_pars_vertex="#ifdef USE_LIGHTMAP\n\n\tvarying vec2 vUv2;\n\n#endif",K.ShaderChunk.lights_phong_fragment="#ifndef FLAT_SHADED\n\n\tvec3 normal = normalize( vNormal );\n\n\t#ifdef DOUBLE_SIDED\n\n\t\tnormal = normal * ( -1.0 + 2.0 * float( gl_FrontFacing ) );\n\n\t#endif\n\n#else\n\n\tvec3 fdx = dFdx( vViewPosition );\n\tvec3 fdy = dFdy( vViewPosition );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n\n#endif\n\nvec3 viewPosition = normalize( vViewPosition );\n\n#ifdef USE_NORMALMAP\n\n\tnormal = perturbNormal2Arb( -vViewPosition, normal );\n\n#elif defined( USE_BUMPMAP )\n\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n\n#endif\n\nvec3 totalDiffuseLight = vec3( 0.0 );\nvec3 totalSpecularLight = vec3( 0.0 );\n\n#if MAX_POINT_LIGHTS > 0\n\n\tfor ( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\n\n\t\tvec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\n\t\tvec3 lVector = lPosition.xyz + vViewPosition.xyz;\n\n\t\tfloat attenuation = calcLightAttenuation( length( lVector ), pointLightDistance[ i ], pointLightDecay[ i ] );\n\n\t\tlVector = normalize( lVector );\n\n\t\t// diffuse\n\n\t\tfloat dotProduct = dot( normal, lVector );\n\n\t\t#ifdef WRAP_AROUND\n\n\t\t\tfloat pointDiffuseWeightFull = max( dotProduct, 0.0 );\n\t\t\tfloat pointDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\n\n\t\t\tvec3 pointDiffuseWeight = mix( vec3( pointDiffuseWeightFull ), vec3( pointDiffuseWeightHalf ), wrapRGB );\n\n\t\t#else\n\n\t\t\tfloat pointDiffuseWeight = max( dotProduct, 0.0 );\n\n\t\t#endif\n\n\t\ttotalDiffuseLight += pointLightColor[ i ] * pointDiffuseWeight * attenuation;\n\n\t\t\t\t// specular\n\n\t\tvec3 pointHalfVector = normalize( lVector + viewPosition );\n\t\tfloat pointDotNormalHalf = max( dot( normal, pointHalfVector ), 0.0 );\n\t\tfloat pointSpecularWeight = specularStrength * max( pow( pointDotNormalHalf, shininess ), 0.0 );\n\n\t\tfloat specularNormalization = ( shininess + 2.0 ) / 8.0;\n\n\t\tvec3 schlick = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( lVector, pointHalfVector ), 0.0 ), 5.0 );\n\t\ttotalSpecularLight += schlick * pointLightColor[ i ] * pointSpecularWeight * pointDiffuseWeight * attenuation * specularNormalization;\n\n\t}\n\n#endif\n\n#if MAX_SPOT_LIGHTS > 0\n\n\tfor ( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\n\n\t\tvec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );\n\t\tvec3 lVector = lPosition.xyz + vViewPosition.xyz;\n\n\t\tfloat attenuation = calcLightAttenuation( length( lVector ), spotLightDistance[ i ], spotLightDecay[ i ] );\n\n\t\tlVector = normalize( lVector );\n\n\t\tfloat spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - vWorldPosition ) );\n\n\t\tif ( spotEffect > spotLightAngleCos[ i ] ) {\n\n\t\t\tspotEffect = max( pow( max( spotEffect, 0.0 ), spotLightExponent[ i ] ), 0.0 );\n\n\t\t\t// diffuse\n\n\t\t\tfloat dotProduct = dot( normal, lVector );\n\n\t\t\t#ifdef WRAP_AROUND\n\n\t\t\t\tfloat spotDiffuseWeightFull = max( dotProduct, 0.0 );\n\t\t\t\tfloat spotDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\n\n\t\t\t\tvec3 spotDiffuseWeight = mix( vec3( spotDiffuseWeightFull ), vec3( spotDiffuseWeightHalf ), wrapRGB );\n\n\t\t\t#else\n\n\t\t\t\tfloat spotDiffuseWeight = max( dotProduct, 0.0 );\n\n\t\t\t#endif\n\n\t\t\ttotalDiffuseLight += spotLightColor[ i ] * spotDiffuseWeight * attenuation * spotEffect;\n\n\t\t\t// specular\n\n\t\t\tvec3 spotHalfVector = normalize( lVector + viewPosition );\n\t\t\tfloat spotDotNormalHalf = max( dot( normal, spotHalfVector ), 0.0 );\n\t\t\tfloat spotSpecularWeight = specularStrength * max( pow( spotDotNormalHalf, shininess ), 0.0 );\n\n\t\t\tfloat specularNormalization = ( shininess + 2.0 ) / 8.0;\n\n\t\t\tvec3 schlick = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( lVector, spotHalfVector ), 0.0 ), 5.0 );\n\t\t\ttotalSpecularLight += schlick * spotLightColor[ i ] * spotSpecularWeight * spotDiffuseWeight * attenuation * specularNormalization * spotEffect;\n\n\t\t}\n\n\t}\n\n#endif\n\n#if MAX_DIR_LIGHTS > 0\n\n\tfor( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {\n\n\t\tvec3 dirVector = transformDirection( directionalLightDirection[ i ], viewMatrix );\n\n\t\t// diffuse\n\n\t\tfloat dotProduct = dot( normal, dirVector );\n\n\t\t#ifdef WRAP_AROUND\n\n\t\t\tfloat dirDiffuseWeightFull = max( dotProduct, 0.0 );\n\t\t\tfloat dirDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\n\n\t\t\tvec3 dirDiffuseWeight = mix( vec3( dirDiffuseWeightFull ), vec3( dirDiffuseWeightHalf ), wrapRGB );\n\n\t\t#else\n\n\t\t\tfloat dirDiffuseWeight = max( dotProduct, 0.0 );\n\n\t\t#endif\n\n\t\ttotalDiffuseLight += directionalLightColor[ i ] * dirDiffuseWeight;\n\n\t\t// specular\n\n\t\tvec3 dirHalfVector = normalize( dirVector + viewPosition );\n\t\tfloat dirDotNormalHalf = max( dot( normal, dirHalfVector ), 0.0 );\n\t\tfloat dirSpecularWeight = specularStrength * max( pow( dirDotNormalHalf, shininess ), 0.0 );\n\n\t\t/*\n\t\t// fresnel term from skin shader\n\t\tconst float F0 = 0.128;\n\n\t\tfloat base = 1.0 - dot( viewPosition, dirHalfVector );\n\t\tfloat exponential = pow( base, 5.0 );\n\n\t\tfloat fresnel = exponential + F0 * ( 1.0 - exponential );\n\t\t*/\n\n\t\t/*\n\t\t// fresnel term from fresnel shader\n\t\tconst float mFresnelBias = 0.08;\n\t\tconst float mFresnelScale = 0.3;\n\t\tconst float mFresnelPower = 5.0;\n\n\t\tfloat fresnel = mFresnelBias + mFresnelScale * pow( 1.0 + dot( normalize( -viewPosition ), normal ), mFresnelPower );\n\t\t*/\n\n\t\tfloat specularNormalization = ( shininess + 2.0 ) / 8.0;\n\n\t\t// \t\tdirSpecular += specular * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight * specularNormalization * fresnel;\n\n\t\tvec3 schlick = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( dirVector, dirHalfVector ), 0.0 ), 5.0 );\n\t\ttotalSpecularLight += schlick * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight * specularNormalization;\n\n\n\t}\n\n#endif\n\n#if MAX_HEMI_LIGHTS > 0\n\n\tfor( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {\n\n\t\tvec3 lVector = transformDirection( hemisphereLightDirection[ i ], viewMatrix );\n\n\t\t// diffuse\n\n\t\tfloat dotProduct = dot( normal, lVector );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotProduct + 0.5;\n\n\t\tvec3 hemiColor = mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );\n\n\t\ttotalDiffuseLight += hemiColor;\n\n\t\t// specular (sky light)\n\n\t\tvec3 hemiHalfVectorSky = normalize( lVector + viewPosition );\n\t\tfloat hemiDotNormalHalfSky = 0.5 * dot( normal, hemiHalfVectorSky ) + 0.5;\n\t\tfloat hemiSpecularWeightSky = specularStrength * max( pow( max( hemiDotNormalHalfSky, 0.0 ), shininess ), 0.0 );\n\n\t\t// specular (ground light)\n\n\t\tvec3 lVectorGround = -lVector;\n\n\t\tvec3 hemiHalfVectorGround = normalize( lVectorGround + viewPosition );\n\t\tfloat hemiDotNormalHalfGround = 0.5 * dot( normal, hemiHalfVectorGround ) + 0.5;\n\t\tfloat hemiSpecularWeightGround = specularStrength * max( pow( max( hemiDotNormalHalfGround, 0.0 ), shininess ), 0.0 );\n\n\t\tfloat dotProductGround = dot( normal, lVectorGround );\n\n\t\tfloat specularNormalization = ( shininess + 2.0 ) / 8.0;\n\n\t\tvec3 schlickSky = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( lVector, hemiHalfVectorSky ), 0.0 ), 5.0 );\n\t\tvec3 schlickGround = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( lVectorGround, hemiHalfVectorGround ), 0.0 ), 5.0 );\n\t\ttotalSpecularLight += hemiColor * specularNormalization * ( schlickSky * hemiSpecularWeightSky * max( dotProduct, 0.0 ) + schlickGround * hemiSpecularWeightGround * max( dotProductGround, 0.0 ) );\n\n\t}\n\n#endif\n\n#ifdef METAL\n\n\toutgoingLight += diffuseColor.rgb * ( totalDiffuseLight + ambientLightColor ) * specular + totalSpecularLight + emissive;\n\n#else\n\n\toutgoingLight += diffuseColor.rgb * ( totalDiffuseLight + ambientLightColor ) + totalSpecularLight + emissive;\n\n#endif\n",K.ShaderChunk.fog_pars_fragment="#ifdef USE_FOG\n\n\tuniform vec3 fogColor;\n\n\t#ifdef FOG_EXP2\n\n\t\tuniform float fogDensity;\n\n\t#else\n\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n\n#endif",K.ShaderChunk.morphnormal_vertex="#ifdef USE_MORPHNORMALS\n\n\tvec3 morphedNormal = vec3( 0.0 );\n\n\tmorphedNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\n\tmorphedNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\n\tmorphedNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\n\tmorphedNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\n\n\tmorphedNormal += normal;\n\n#endif",K.ShaderChunk.envmap_pars_fragment="#ifdef USE_ENVMAP\n\n\tuniform float reflectivity;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\tuniform float flipEnvMap;\n\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\n\t\tuniform float refractionRatio;\n\n\t#else\n\n\t\tvarying vec3 vReflect;\n\n\t#endif\n\n#endif\n",K.ShaderChunk.logdepthbuf_fragment="#if defined(USE_LOGDEPTHBUF) && defined(USE_LOGDEPTHBUF_EXT)\n\n\tgl_FragDepthEXT = log2(vFragDepth) * logDepthBufFC * 0.5;\n\n#endif",K.ShaderChunk.normalmap_pars_fragment="#ifdef USE_NORMALMAP\n\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n\n\t// Per-Pixel Tangent Space Normal Mapping\n\t// http://hacksoflife.blogspot.ch/2009/11/per-pixel-tangent-space-normal-mapping.html\n\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\n\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\n\t\tvec3 S = normalize( q0 * st1.t - q1 * st0.t );\n\t\tvec3 T = normalize( -q0 * st1.s + q1 * st0.s );\n\t\tvec3 N = normalize( surf_norm );\n\n\t\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\tmapN.xy = normalScale * mapN.xy;\n\t\tmat3 tsn = mat3( S, T, N );\n\t\treturn normalize( tsn * mapN );\n\n\t}\n\n#endif\n",K.ShaderChunk.lights_phong_pars_vertex="#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP ) || defined( USE_ENVMAP )\n\n\tvarying vec3 vWorldPosition;\n\n#endif\n",K.ShaderChunk.lightmap_pars_fragment="#ifdef USE_LIGHTMAP\n\n\tvarying vec2 vUv2;\n\tuniform sampler2D lightMap;\n\n#endif",K.ShaderChunk.shadowmap_vertex="#ifdef USE_SHADOWMAP\n\n\tfor( int i = 0; i < MAX_SHADOWS; i ++ ) {\n\n\t\tvShadowCoord[ i ] = shadowMatrix[ i ] * worldPosition;\n\n\t}\n\n#endif",K.ShaderChunk.lights_phong_vertex="#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP ) || defined( USE_ENVMAP )\n\n\tvWorldPosition = worldPosition.xyz;\n\n#endif",K.ShaderChunk.map_fragment="#ifdef USE_MAP\n\n\tvec4 texelColor = texture2D( map, vUv );\n\n\ttexelColor.xyz = inputToLinear( texelColor.xyz );\n\n\tdiffuseColor *= texelColor;\n\n#endif",K.ShaderChunk.lightmap_vertex="#ifdef USE_LIGHTMAP\n\n\tvUv2 = uv2;\n\n#endif",K.ShaderChunk.map_particle_fragment="#ifdef USE_MAP\n\n\tdiffuseColor *= texture2D( map, vec2( gl_PointCoord.x, 1.0 - gl_PointCoord.y ) * offsetRepeat.zw + offsetRepeat.xy );\n\n#endif\n",K.ShaderChunk.color_pars_fragment="#ifdef USE_COLOR\n\n\tvarying vec3 vColor;\n\n#endif\n",K.ShaderChunk.color_vertex="#ifdef USE_COLOR\n\n\tvColor.xyz = inputToLinear( color.xyz );\n\n#endif",K.ShaderChunk.skinning_vertex="#ifdef USE_SKINNING\n\n\t#ifdef USE_MORPHTARGETS\n\n\tvec4 skinVertex = bindMatrix * vec4( morphed, 1.0 );\n\n\t#else\n\n\tvec4 skinVertex = bindMatrix * vec4( position, 1.0 );\n\n\t#endif\n\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\tskinned  = bindMatrixInverse * skinned;\n\n#endif\n",K.ShaderChunk.envmap_pars_vertex="#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP ) && ! defined( PHONG )\n\n\tvarying vec3 vReflect;\n\n\tuniform float refractionRatio;\n\n#endif\n",K.ShaderChunk.linear_to_gamma_fragment="\n\toutgoingLight = linearToOutput( outgoingLight );\n",K.ShaderChunk.color_pars_vertex="#ifdef USE_COLOR\n\n\tvarying vec3 vColor;\n\n#endif",K.ShaderChunk.lights_lambert_pars_vertex="uniform vec3 ambientLightColor;\n\n#if MAX_DIR_LIGHTS > 0\n\n\tuniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\n\tuniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\n\n#endif\n\n#if MAX_HEMI_LIGHTS > 0\n\n\tuniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];\n\tuniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];\n\tuniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];\n\n#endif\n\n#if MAX_POINT_LIGHTS > 0\n\n\tuniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\n\tuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\n\tuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\n\tuniform float pointLightDecay[ MAX_POINT_LIGHTS ];\n\n#endif\n\n#if MAX_SPOT_LIGHTS > 0\n\n\tuniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];\n\tuniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\n\tuniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];\n\tuniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\n\tuniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];\n\tuniform float spotLightExponent[ MAX_SPOT_LIGHTS ];\n\tuniform float spotLightDecay[ MAX_SPOT_LIGHTS ];\n\n#endif\n\n#ifdef WRAP_AROUND\n\n\tuniform vec3 wrapRGB;\n\n#endif\n",K.ShaderChunk.map_pars_vertex="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP )\n\n\tvarying vec2 vUv;\n\tuniform vec4 offsetRepeat;\n\n#endif\n",K.ShaderChunk.envmap_fragment="#ifdef USE_ENVMAP\n\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\n\t\tvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\n\n\t\t// Transforming Normal Vectors with the Inverse Transformation\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\n\t\t\tvec3 reflectVec = reflect( cameraToVertex, worldNormal );\n\n\t\t#else\n\n\t\t\tvec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\n\n\t\t#endif\n\n\t#else\n\n\t\tvec3 reflectVec = vReflect;\n\n\t#endif\n\n\t#ifdef DOUBLE_SIDED\n\t\tfloat flipNormal = ( -1.0 + 2.0 * float( gl_FrontFacing ) );\n\t#else\n\t\tfloat flipNormal = 1.0;\n\t#endif\n\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\tvec2 sampleUV;\n\t\tsampleUV.y = saturate( flipNormal * reflectVec.y * 0.5 + 0.5 );\n\t\tsampleUV.x = atan( flipNormal * reflectVec.z, flipNormal * reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\n\n\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\tvec3 reflectView = flipNormal * normalize((viewMatrix * vec4( reflectVec, 0.0 )).xyz + vec3(0.0,0.0,1.0));\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\n\t#endif\n\n\tenvColor.xyz = inputToLinear( envColor.xyz );\n\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\n\t#endif\n\n#endif\n",K.ShaderChunk.specularmap_pars_fragment="#ifdef USE_SPECULARMAP\n\n\tuniform sampler2D specularMap;\n\n#endif",K.ShaderChunk.logdepthbuf_vertex="#ifdef USE_LOGDEPTHBUF\n\n\tgl_Position.z = log2(max( EPSILON, gl_Position.w + 1.0 )) * logDepthBufFC;\n\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\n#else\n\n\t\tgl_Position.z = (gl_Position.z - 1.0) * gl_Position.w;\n\n\t#endif\n\n#endif",K.ShaderChunk.morphtarget_pars_vertex="#ifdef USE_MORPHTARGETS\n\n\t#ifndef USE_MORPHNORMALS\n\n\tuniform float morphTargetInfluences[ 8 ];\n\n\t#else\n\n\tuniform float morphTargetInfluences[ 4 ];\n\n\t#endif\n\n#endif",K.ShaderChunk.specularmap_fragment="float specularStrength;\n\n#ifdef USE_SPECULARMAP\n\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n\n#else\n\n\tspecularStrength = 1.0;\n\n#endif",K.ShaderChunk.fog_fragment="#ifdef USE_FOG\n\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\n\t\tfloat depth = gl_FragDepthEXT / gl_FragCoord.w;\n\n\t#else\n\n\t\tfloat depth = gl_FragCoord.z / gl_FragCoord.w;\n\n\t#endif\n\n\t#ifdef FOG_EXP2\n\n\t\tfloat fogFactor = exp2( - square( fogDensity ) * square( depth ) * LOG2 );\n\t\tfogFactor = whiteCompliment( fogFactor );\n\n\t#else\n\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, depth );\n\n\t#endif\n\t\n\toutgoingLight = mix( outgoingLight, fogColor, fogFactor );\n\n#endif",K.ShaderChunk.bumpmap_pars_fragment="#ifdef USE_BUMPMAP\n\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\n\t// Derivative maps - bump mapping unparametrized surfaces by Morten Mikkelsen\n\t// http://mmikkelsen3d.blogspot.sk/2011/07/derivative-maps.html\n\n\t// Evaluate the derivative of the height w.r.t. screen-space using forward differencing (listing 2)\n\n\tvec2 dHdxy_fwd() {\n\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\n\t\treturn vec2( dBx, dBy );\n\n\t}\n\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\n\t\tvec3 vSigmaX = dFdx( surf_pos );\n\t\tvec3 vSigmaY = dFdy( surf_pos );\n\t\tvec3 vN = surf_norm;\t\t// normalized\n\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\n\t}\n\n#endif\n",K.ShaderChunk.defaultnormal_vertex="#ifdef USE_SKINNING\n\n\tvec3 objectNormal = skinnedNormal.xyz;\n\n#elif defined( USE_MORPHNORMALS )\n\n\tvec3 objectNormal = morphedNormal;\n\n#else\n\n\tvec3 objectNormal = normal;\n\n#endif\n\n#ifdef FLIP_SIDED\n\n\tobjectNormal = -objectNormal;\n\n#endif\n\nvec3 transformedNormal = normalMatrix * objectNormal;\n",K.ShaderChunk.lights_phong_pars_fragment="uniform vec3 ambientLightColor;\n\n#if MAX_DIR_LIGHTS > 0\n\n\tuniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\n\tuniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\n\n#endif\n\n#if MAX_HEMI_LIGHTS > 0\n\n\tuniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];\n\tuniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];\n\tuniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];\n\n#endif\n\n#if MAX_POINT_LIGHTS > 0\n\n\tuniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\n\n\tuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\n\tuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\n\tuniform float pointLightDecay[ MAX_POINT_LIGHTS ];\n\n#endif\n\n#if MAX_SPOT_LIGHTS > 0\n\n\tuniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];\n\tuniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\n\tuniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];\n\tuniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];\n\tuniform float spotLightExponent[ MAX_SPOT_LIGHTS ];\n\tuniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\n\tuniform float spotLightDecay[ MAX_SPOT_LIGHTS ];\n\n#endif\n\n#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP ) || defined( USE_ENVMAP )\n\n\tvarying vec3 vWorldPosition;\n\n#endif\n\n#ifdef WRAP_AROUND\n\n\tuniform vec3 wrapRGB;\n\n#endif\n\nvarying vec3 vViewPosition;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n#endif\n",K.ShaderChunk.skinbase_vertex="#ifdef USE_SKINNING\n\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n\n#endif",K.ShaderChunk.map_vertex="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP )\n\n\tvUv = uv * offsetRepeat.zw + offsetRepeat.xy;\n\n#endif",K.ShaderChunk.lightmap_fragment="#ifdef USE_LIGHTMAP\n\n\toutgoingLight *= diffuseColor.xyz * texture2D( lightMap, vUv2 ).xyz;\n\n#endif",K.ShaderChunk.shadowmap_pars_vertex="#ifdef USE_SHADOWMAP\n\n\tvarying vec4 vShadowCoord[ MAX_SHADOWS ];\n\tuniform mat4 shadowMatrix[ MAX_SHADOWS ];\n\n#endif",K.ShaderChunk.color_fragment="#ifdef USE_COLOR\n\n\tdiffuseColor.rgb *= vColor;\n\n#endif",K.ShaderChunk.morphtarget_vertex="#ifdef USE_MORPHTARGETS\n\n\tvec3 morphed = vec3( 0.0 );\n\tmorphed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\n\tmorphed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\n\tmorphed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\n\tmorphed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n\n\t#ifndef USE_MORPHNORMALS\n\n\tmorphed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\n\tmorphed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\n\tmorphed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\n\tmorphed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n\n\t#endif\n\n\tmorphed += position;\n\n#endif",K.ShaderChunk.envmap_vertex="#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP ) && ! defined( PHONG )\n\n\tvec3 worldNormal = transformDirection( objectNormal, modelMatrix );\n\n\tvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\n\t#ifdef ENVMAP_MODE_REFLECTION\n\n\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\n\t#else\n\n\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\n\t#endif\n\n#endif\n",K.ShaderChunk.shadowmap_fragment="#ifdef USE_SHADOWMAP\n\n\t#ifdef SHADOWMAP_DEBUG\n\n\t\tvec3 frustumColors[3];\n\t\tfrustumColors[0] = vec3( 1.0, 0.5, 0.0 );\n\t\tfrustumColors[1] = vec3( 0.0, 1.0, 0.8 );\n\t\tfrustumColors[2] = vec3( 0.0, 0.5, 1.0 );\n\n\t#endif\n\n\t#ifdef SHADOWMAP_CASCADE\n\n\t\tint inFrustumCount = 0;\n\n\t#endif\n\n\tfloat fDepth;\n\tvec3 shadowColor = vec3( 1.0 );\n\n\tfor( int i = 0; i < MAX_SHADOWS; i ++ ) {\n\n\t\tvec3 shadowCoord = vShadowCoord[ i ].xyz / vShadowCoord[ i ].w;\n\n\t\t\t\t// if ( something && something ) breaks ATI OpenGL shader compiler\n\t\t\t\t// if ( all( something, something ) ) using this instead\n\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\n\t\t\t\t// don't shadow pixels outside of light frustum\n\t\t\t\t// use just first frustum (for cascades)\n\t\t\t\t// don't shadow pixels behind far plane of light frustum\n\n\t\t#ifdef SHADOWMAP_CASCADE\n\n\t\t\tinFrustumCount += int( inFrustum );\n\t\t\tbvec3 frustumTestVec = bvec3( inFrustum, inFrustumCount == 1, shadowCoord.z <= 1.0 );\n\n\t\t#else\n\n\t\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\n\t\t#endif\n\n\t\tbool frustumTest = all( frustumTestVec );\n\n\t\tif ( frustumTest ) {\n\n\t\t\tshadowCoord.z += shadowBias[ i ];\n\n\t\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\n\t\t\t\t\t\t// Percentage-close filtering\n\t\t\t\t\t\t// (9 pixel kernel)\n\t\t\t\t\t\t// http://fabiensanglard.net/shadowmappingPCF/\n\n\t\t\t\tfloat shadow = 0.0;\n\n\t\t/*\n\t\t\t\t\t\t// nested loops breaks shader compiler / validator on some ATI cards when using OpenGL\n\t\t\t\t\t\t// must enroll loop manually\n\n\t\t\t\tfor ( float y = -1.25; y <= 1.25; y += 1.25 )\n\t\t\t\t\tfor ( float x = -1.25; x <= 1.25; x += 1.25 ) {\n\n\t\t\t\t\t\tvec4 rgbaDepth = texture2D( shadowMap[ i ], vec2( x * xPixelOffset, y * yPixelOffset ) + shadowCoord.xy );\n\n\t\t\t\t\t\t\t\t// doesn't seem to produce any noticeable visual difference compared to simple texture2D lookup\n\t\t\t\t\t\t\t\t//vec4 rgbaDepth = texture2DProj( shadowMap[ i ], vec4( vShadowCoord[ i ].w * ( vec2( x * xPixelOffset, y * yPixelOffset ) + shadowCoord.xy ), 0.05, vShadowCoord[ i ].w ) );\n\n\t\t\t\t\t\tfloat fDepth = unpackDepth( rgbaDepth );\n\n\t\t\t\t\t\tif ( fDepth < shadowCoord.z )\n\t\t\t\t\t\t\tshadow += 1.0;\n\n\t\t\t\t}\n\n\t\t\t\tshadow /= 9.0;\n\n\t\t*/\n\n\t\t\t\tconst float shadowDelta = 1.0 / 9.0;\n\n\t\t\t\tfloat xPixelOffset = 1.0 / shadowMapSize[ i ].x;\n\t\t\t\tfloat yPixelOffset = 1.0 / shadowMapSize[ i ].y;\n\n\t\t\t\tfloat dx0 = -1.25 * xPixelOffset;\n\t\t\t\tfloat dy0 = -1.25 * yPixelOffset;\n\t\t\t\tfloat dx1 = 1.25 * xPixelOffset;\n\t\t\t\tfloat dy1 = 1.25 * yPixelOffset;\n\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy0 ) ) );\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy0 ) ) );\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy0 ) ) );\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, 0.0 ) ) );\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy ) );\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, 0.0 ) ) );\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy1 ) ) );\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy1 ) ) );\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy1 ) ) );\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n\t\t\t\tshadowColor = shadowColor * vec3( ( 1.0 - shadowDarkness[ i ] * shadow ) );\n\n\t\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\n\t\t\t\t\t\t// Percentage-close filtering\n\t\t\t\t\t\t// (9 pixel kernel)\n\t\t\t\t\t\t// http://fabiensanglard.net/shadowmappingPCF/\n\n\t\t\t\tfloat shadow = 0.0;\n\n\t\t\t\tfloat xPixelOffset = 1.0 / shadowMapSize[ i ].x;\n\t\t\t\tfloat yPixelOffset = 1.0 / shadowMapSize[ i ].y;\n\n\t\t\t\tfloat dx0 = -1.0 * xPixelOffset;\n\t\t\t\tfloat dy0 = -1.0 * yPixelOffset;\n\t\t\t\tfloat dx1 = 1.0 * xPixelOffset;\n\t\t\t\tfloat dy1 = 1.0 * yPixelOffset;\n\n\t\t\t\tmat3 shadowKernel;\n\t\t\t\tmat3 depthKernel;\n\n\t\t\t\tdepthKernel[0][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy0 ) ) );\n\t\t\t\tdepthKernel[0][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, 0.0 ) ) );\n\t\t\t\tdepthKernel[0][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy1 ) ) );\n\t\t\t\tdepthKernel[1][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy0 ) ) );\n\t\t\t\tdepthKernel[1][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy ) );\n\t\t\t\tdepthKernel[1][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy1 ) ) );\n\t\t\t\tdepthKernel[2][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy0 ) ) );\n\t\t\t\tdepthKernel[2][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, 0.0 ) ) );\n\t\t\t\tdepthKernel[2][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy1 ) ) );\n\n\t\t\t\tvec3 shadowZ = vec3( shadowCoord.z );\n\t\t\t\tshadowKernel[0] = vec3(lessThan(depthKernel[0], shadowZ ));\n\t\t\t\tshadowKernel[0] *= vec3(0.25);\n\n\t\t\t\tshadowKernel[1] = vec3(lessThan(depthKernel[1], shadowZ ));\n\t\t\t\tshadowKernel[1] *= vec3(0.25);\n\n\t\t\t\tshadowKernel[2] = vec3(lessThan(depthKernel[2], shadowZ ));\n\t\t\t\tshadowKernel[2] *= vec3(0.25);\n\n\t\t\t\tvec2 fractionalCoord = 1.0 - fract( shadowCoord.xy * shadowMapSize[i].xy );\n\n\t\t\t\tshadowKernel[0] = mix( shadowKernel[1], shadowKernel[0], fractionalCoord.x );\n\t\t\t\tshadowKernel[1] = mix( shadowKernel[2], shadowKernel[1], fractionalCoord.x );\n\n\t\t\t\tvec4 shadowValues;\n\t\t\t\tshadowValues.x = mix( shadowKernel[0][1], shadowKernel[0][0], fractionalCoord.y );\n\t\t\t\tshadowValues.y = mix( shadowKernel[0][2], shadowKernel[0][1], fractionalCoord.y );\n\t\t\t\tshadowValues.z = mix( shadowKernel[1][1], shadowKernel[1][0], fractionalCoord.y );\n\t\t\t\tshadowValues.w = mix( shadowKernel[1][2], shadowKernel[1][1], fractionalCoord.y );\n\n\t\t\t\tshadow = dot( shadowValues, vec4( 1.0 ) );\n\n\t\t\t\tshadowColor = shadowColor * vec3( ( 1.0 - shadowDarkness[ i ] * shadow ) );\n\n\t\t\t#else\n\n\t\t\t\tvec4 rgbaDepth = texture2D( shadowMap[ i ], shadowCoord.xy );\n\t\t\t\tfloat fDepth = unpackDepth( rgbaDepth );\n\n\t\t\t\tif ( fDepth < shadowCoord.z )\n\n\t\t// spot with multiple shadows is darker\n\n\t\t\t\t\tshadowColor = shadowColor * vec3( 1.0 - shadowDarkness[ i ] );\n\n\t\t// spot with multiple shadows has the same color as single shadow spot\n\n\t\t// \t\t\t\t\tshadowColor = min( shadowColor, vec3( shadowDarkness[ i ] ) );\n\n\t\t\t#endif\n\n\t\t}\n\n\n\t\t#ifdef SHADOWMAP_DEBUG\n\n\t\t\t#ifdef SHADOWMAP_CASCADE\n\n\t\t\t\tif ( inFrustum && inFrustumCount == 1 ) outgoingLight *= frustumColors[ i ];\n\n\t\t\t#else\n\n\t\t\t\tif ( inFrustum ) outgoingLight *= frustumColors[ i ];\n\n\t\t\t#endif\n\n\t\t#endif\n\n\t}\n\n\t// NOTE: I am unsure if this is correct in linear space.  -bhouston, Dec 29, 2014\n\tshadowColor = inputToLinear( shadowColor );\n\n\toutgoingLight = outgoingLight * shadowColor;\n\n#endif\n",K.ShaderChunk.worldpos_vertex="#if defined( USE_ENVMAP ) || defined( PHONG ) || defined( LAMBERT ) || defined ( USE_SHADOWMAP )\n\n\t#ifdef USE_SKINNING\n\n\t\tvec4 worldPosition = modelMatrix * skinned;\n\n\t#elif defined( USE_MORPHTARGETS )\n\n\t\tvec4 worldPosition = modelMatrix * vec4( morphed, 1.0 );\n\n\t#else\n\n\t\tvec4 worldPosition = modelMatrix * vec4( position, 1.0 );\n\n\t#endif\n\n#endif\n",K.ShaderChunk.shadowmap_pars_fragment="#ifdef USE_SHADOWMAP\n\n\tuniform sampler2D shadowMap[ MAX_SHADOWS ];\n\tuniform vec2 shadowMapSize[ MAX_SHADOWS ];\n\n\tuniform float shadowDarkness[ MAX_SHADOWS ];\n\tuniform float shadowBias[ MAX_SHADOWS ];\n\n\tvarying vec4 vShadowCoord[ MAX_SHADOWS ];\n\n\tfloat unpackDepth( const in vec4 rgba_depth ) {\n\n\t\tconst vec4 bit_shift = vec4( 1.0 / ( 256.0 * 256.0 * 256.0 ), 1.0 / ( 256.0 * 256.0 ), 1.0 / 256.0, 1.0 );\n\t\tfloat depth = dot( rgba_depth, bit_shift );\n\t\treturn depth;\n\n\t}\n\n#endif",K.ShaderChunk.skinning_pars_vertex="#ifdef USE_SKINNING\n\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\n\t#ifdef BONE_TEXTURE\n\n\t\tuniform sampler2D boneTexture;\n\t\tuniform int boneTextureWidth;\n\t\tuniform int boneTextureHeight;\n\n\t\tmat4 getBoneMatrix( const in float i ) {\n\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureWidth ) );\n\t\t\tfloat y = floor( j / float( boneTextureWidth ) );\n\n\t\t\tfloat dx = 1.0 / float( boneTextureWidth );\n\t\t\tfloat dy = 1.0 / float( boneTextureHeight );\n\n\t\t\ty = dy * ( y + 0.5 );\n\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\n\t\t\treturn bone;\n\n\t\t}\n\n\t#else\n\n\t\tuniform mat4 boneGlobalMatrices[ MAX_BONES ];\n\n\t\tmat4 getBoneMatrix( const in float i ) {\n\n\t\t\tmat4 bone = boneGlobalMatrices[ int(i) ];\n\t\t\treturn bone;\n\n\t\t}\n\n\t#endif\n\n#endif\n",K.ShaderChunk.logdepthbuf_pars_fragment="#ifdef USE_LOGDEPTHBUF\n\n\tuniform float logDepthBufFC;\n\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\n\t\t#extension GL_EXT_frag_depth : enable\n\t\tvarying float vFragDepth;\n\n\t#endif\n\n#endif",K.ShaderChunk.alphamap_fragment="#ifdef USE_ALPHAMAP\n\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n\n#endif\n",K.ShaderChunk.alphamap_pars_fragment="#ifdef USE_ALPHAMAP\n\n\tuniform sampler2D alphaMap;\n\n#endif\n",K.UniformsUtils={merge:function(e){for(var t={},r=0;r<e.length;r++){var n=this.clone(e[r]);for(var i in n)t[i]=n[i]}return t},clone:function(e){var t={};for(var r in e)for(var n in t[r]={},e[r]){var i=e[r][n];i instanceof K.Color||i instanceof K.Vector2||i instanceof K.Vector3||i instanceof K.Vector4||i instanceof K.Matrix4||i instanceof K.Texture?t[r][n]=i.clone():t[r][n]=i instanceof Array?i.slice():i}return t}},K.UniformsLib={common:{diffuse:{type:"c",value:new K.Color(15658734)},opacity:{type:"f",value:1},map:{type:"t",value:null},offsetRepeat:{type:"v4",value:new K.Vector4(0,0,1,1)},lightMap:{type:"t",value:null},specularMap:{type:"t",value:null},alphaMap:{type:"t",value:null},envMap:{type:"t",value:null},flipEnvMap:{type:"f",value:-1},reflectivity:{type:"f",value:1},refractionRatio:{type:"f",value:.98},morphTargetInfluences:{type:"f",value:0}},bump:{bumpMap:{type:"t",value:null},bumpScale:{type:"f",value:1}},normalmap:{normalMap:{type:"t",value:null},normalScale:{type:"v2",value:new K.Vector2(1,1)}},fog:{fogDensity:{type:"f",value:25e-5},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},fogColor:{type:"c",value:new K.Color(16777215)}},lights:{ambientLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]},directionalLightColor:{type:"fv",value:[]},hemisphereLightDirection:{type:"fv",value:[]},hemisphereLightSkyColor:{type:"fv",value:[]},hemisphereLightGroundColor:{type:"fv",value:[]},pointLightColor:{type:"fv",value:[]},pointLightPosition:{type:"fv",value:[]},pointLightDistance:{type:"fv1",value:[]},pointLightDecay:{type:"fv1",value:[]},spotLightColor:{type:"fv",value:[]},spotLightPosition:{type:"fv",value:[]},spotLightDirection:{type:"fv",value:[]},spotLightDistance:{type:"fv1",value:[]},spotLightAngleCos:{type:"fv1",value:[]},spotLightExponent:{type:"fv1",value:[]},spotLightDecay:{type:"fv1",value:[]}},particle:{psColor:{type:"c",value:new K.Color(15658734)},opacity:{type:"f",value:1},size:{type:"f",value:1},scale:{type:"f",value:1},map:{type:"t",value:null},offsetRepeat:{type:"v4",value:new K.Vector4(0,0,1,1)},fogDensity:{type:"f",value:25e-5},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},fogColor:{type:"c",value:new K.Color(16777215)}},shadowmap:{shadowMap:{type:"tv",value:[]},shadowMapSize:{type:"v2v",value:[]},shadowBias:{type:"fv1",value:[]},shadowDarkness:{type:"fv1",value:[]},shadowMatrix:{type:"m4v",value:[]}}},K.ShaderLib={basic:{uniforms:K.UniformsUtils.merge([K.UniformsLib.common,K.UniformsLib.fog,K.UniformsLib.shadowmap]),vertexShader:[K.ShaderChunk.common,K.ShaderChunk.map_pars_vertex,K.ShaderChunk.lightmap_pars_vertex,K.ShaderChunk.envmap_pars_vertex,K.ShaderChunk.color_pars_vertex,K.ShaderChunk.morphtarget_pars_vertex,K.ShaderChunk.skinning_pars_vertex,K.ShaderChunk.shadowmap_pars_vertex,K.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",K.ShaderChunk.map_vertex,K.ShaderChunk.lightmap_vertex,K.ShaderChunk.color_vertex,K.ShaderChunk.skinbase_vertex,"\t#ifdef USE_ENVMAP",K.ShaderChunk.morphnormal_vertex,K.ShaderChunk.skinnormal_vertex,K.ShaderChunk.defaultnormal_vertex,"\t#endif",K.ShaderChunk.morphtarget_vertex,K.ShaderChunk.skinning_vertex,K.ShaderChunk.default_vertex,K.ShaderChunk.logdepthbuf_vertex,K.ShaderChunk.worldpos_vertex,K.ShaderChunk.envmap_vertex,K.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 diffuse;","uniform float opacity;",K.ShaderChunk.common,K.ShaderChunk.color_pars_fragment,K.ShaderChunk.map_pars_fragment,K.ShaderChunk.alphamap_pars_fragment,K.ShaderChunk.lightmap_pars_fragment,K.ShaderChunk.envmap_pars_fragment,K.ShaderChunk.fog_pars_fragment,K.ShaderChunk.shadowmap_pars_fragment,K.ShaderChunk.specularmap_pars_fragment,K.ShaderChunk.logdepthbuf_pars_fragment,"void main() {","\tvec3 outgoingLight = vec3( 0.0 );","\tvec4 diffuseColor = vec4( diffuse, opacity );",K.ShaderChunk.logdepthbuf_fragment,K.ShaderChunk.map_fragment,K.ShaderChunk.color_fragment,K.ShaderChunk.alphamap_fragment,K.ShaderChunk.alphatest_fragment,K.ShaderChunk.specularmap_fragment,"\toutgoingLight = diffuseColor.rgb;",K.ShaderChunk.lightmap_fragment,K.ShaderChunk.envmap_fragment,K.ShaderChunk.shadowmap_fragment,K.ShaderChunk.linear_to_gamma_fragment,K.ShaderChunk.fog_fragment,"\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );","}"].join("\n")},lambert:{uniforms:K.UniformsUtils.merge([K.UniformsLib.common,K.UniformsLib.fog,K.UniformsLib.lights,K.UniformsLib.shadowmap,{emissive:{type:"c",value:new K.Color(0)},wrapRGB:{type:"v3",value:new K.Vector3(1,1,1)}}]),vertexShader:["#define LAMBERT","varying vec3 vLightFront;","#ifdef DOUBLE_SIDED","\tvarying vec3 vLightBack;","#endif",K.ShaderChunk.common,K.ShaderChunk.map_pars_vertex,K.ShaderChunk.lightmap_pars_vertex,K.ShaderChunk.envmap_pars_vertex,K.ShaderChunk.lights_lambert_pars_vertex,K.ShaderChunk.color_pars_vertex,K.ShaderChunk.morphtarget_pars_vertex,K.ShaderChunk.skinning_pars_vertex,K.ShaderChunk.shadowmap_pars_vertex,K.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",K.ShaderChunk.map_vertex,K.ShaderChunk.lightmap_vertex,K.ShaderChunk.color_vertex,K.ShaderChunk.morphnormal_vertex,K.ShaderChunk.skinbase_vertex,K.ShaderChunk.skinnormal_vertex,K.ShaderChunk.defaultnormal_vertex,K.ShaderChunk.morphtarget_vertex,K.ShaderChunk.skinning_vertex,K.ShaderChunk.default_vertex,K.ShaderChunk.logdepthbuf_vertex,K.ShaderChunk.worldpos_vertex,K.ShaderChunk.envmap_vertex,K.ShaderChunk.lights_lambert_vertex,K.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 diffuse;","uniform vec3 emissive;","uniform float opacity;","varying vec3 vLightFront;","#ifdef DOUBLE_SIDED","\tvarying vec3 vLightBack;","#endif",K.ShaderChunk.common,K.ShaderChunk.color_pars_fragment,K.ShaderChunk.map_pars_fragment,K.ShaderChunk.alphamap_pars_fragment,K.ShaderChunk.lightmap_pars_fragment,K.ShaderChunk.envmap_pars_fragment,K.ShaderChunk.fog_pars_fragment,K.ShaderChunk.shadowmap_pars_fragment,K.ShaderChunk.specularmap_pars_fragment,K.ShaderChunk.logdepthbuf_pars_fragment,"void main() {","\tvec3 outgoingLight = vec3( 0.0 );","\tvec4 diffuseColor = vec4( diffuse, opacity );",K.ShaderChunk.logdepthbuf_fragment,K.ShaderChunk.map_fragment,K.ShaderChunk.color_fragment,K.ShaderChunk.alphamap_fragment,K.ShaderChunk.alphatest_fragment,K.ShaderChunk.specularmap_fragment,"\t#ifdef DOUBLE_SIDED","\t\tif ( gl_FrontFacing )","\t\t\toutgoingLight += diffuseColor.rgb * vLightFront + emissive;","\t\telse","\t\t\toutgoingLight += diffuseColor.rgb * vLightBack + emissive;","\t#else","\t\toutgoingLight += diffuseColor.rgb * vLightFront + emissive;","\t#endif",K.ShaderChunk.lightmap_fragment,K.ShaderChunk.envmap_fragment,K.ShaderChunk.shadowmap_fragment,K.ShaderChunk.linear_to_gamma_fragment,K.ShaderChunk.fog_fragment,"\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );","}"].join("\n")},phong:{uniforms:K.UniformsUtils.merge([K.UniformsLib.common,K.UniformsLib.bump,K.UniformsLib.normalmap,K.UniformsLib.fog,K.UniformsLib.lights,K.UniformsLib.shadowmap,{emissive:{type:"c",value:new K.Color(0)},specular:{type:"c",value:new K.Color(1118481)},shininess:{type:"f",value:30},wrapRGB:{type:"v3",value:new K.Vector3(1,1,1)}}]),vertexShader:["#define PHONG","varying vec3 vViewPosition;","#ifndef FLAT_SHADED","\tvarying vec3 vNormal;","#endif",K.ShaderChunk.common,K.ShaderChunk.map_pars_vertex,K.ShaderChunk.lightmap_pars_vertex,K.ShaderChunk.envmap_pars_vertex,K.ShaderChunk.lights_phong_pars_vertex,K.ShaderChunk.color_pars_vertex,K.ShaderChunk.morphtarget_pars_vertex,K.ShaderChunk.skinning_pars_vertex,K.ShaderChunk.shadowmap_pars_vertex,K.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",K.ShaderChunk.map_vertex,K.ShaderChunk.lightmap_vertex,K.ShaderChunk.color_vertex,K.ShaderChunk.morphnormal_vertex,K.ShaderChunk.skinbase_vertex,K.ShaderChunk.skinnormal_vertex,K.ShaderChunk.defaultnormal_vertex,"#ifndef FLAT_SHADED","\tvNormal = normalize( transformedNormal );","#endif",K.ShaderChunk.morphtarget_vertex,K.ShaderChunk.skinning_vertex,K.ShaderChunk.default_vertex,K.ShaderChunk.logdepthbuf_vertex,"\tvViewPosition = -mvPosition.xyz;",K.ShaderChunk.worldpos_vertex,K.ShaderChunk.envmap_vertex,K.ShaderChunk.lights_phong_vertex,K.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["#define PHONG","uniform vec3 diffuse;","uniform vec3 emissive;","uniform vec3 specular;","uniform float shininess;","uniform float opacity;",K.ShaderChunk.common,K.ShaderChunk.color_pars_fragment,K.ShaderChunk.map_pars_fragment,K.ShaderChunk.alphamap_pars_fragment,K.ShaderChunk.lightmap_pars_fragment,K.ShaderChunk.envmap_pars_fragment,K.ShaderChunk.fog_pars_fragment,K.ShaderChunk.lights_phong_pars_fragment,K.ShaderChunk.shadowmap_pars_fragment,K.ShaderChunk.bumpmap_pars_fragment,K.ShaderChunk.normalmap_pars_fragment,K.ShaderChunk.specularmap_pars_fragment,K.ShaderChunk.logdepthbuf_pars_fragment,"void main() {","\tvec3 outgoingLight = vec3( 0.0 );","\tvec4 diffuseColor = vec4( diffuse, opacity );",K.ShaderChunk.logdepthbuf_fragment,K.ShaderChunk.map_fragment,K.ShaderChunk.color_fragment,K.ShaderChunk.alphamap_fragment,K.ShaderChunk.alphatest_fragment,K.ShaderChunk.specularmap_fragment,K.ShaderChunk.lights_phong_fragment,K.ShaderChunk.lightmap_fragment,K.ShaderChunk.envmap_fragment,K.ShaderChunk.shadowmap_fragment,K.ShaderChunk.linear_to_gamma_fragment,K.ShaderChunk.fog_fragment,"\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );","}"].join("\n")},particle_basic:{uniforms:K.UniformsUtils.merge([K.UniformsLib.particle,K.UniformsLib.shadowmap]),vertexShader:["uniform float size;","uniform float scale;",K.ShaderChunk.common,K.ShaderChunk.color_pars_vertex,K.ShaderChunk.shadowmap_pars_vertex,K.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",K.ShaderChunk.color_vertex,"\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","\t#ifdef USE_SIZEATTENUATION","\t\tgl_PointSize = size * ( scale / length( mvPosition.xyz ) );","\t#else","\t\tgl_PointSize = size;","\t#endif","\tgl_Position = projectionMatrix * mvPosition;",K.ShaderChunk.logdepthbuf_vertex,K.ShaderChunk.worldpos_vertex,K.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 psColor;","uniform float opacity;",K.ShaderChunk.common,K.ShaderChunk.color_pars_fragment,K.ShaderChunk.map_particle_pars_fragment,K.ShaderChunk.fog_pars_fragment,K.ShaderChunk.shadowmap_pars_fragment,K.ShaderChunk.logdepthbuf_pars_fragment,"void main() {","\tvec3 outgoingLight = vec3( 0.0 );","\tvec4 diffuseColor = vec4( psColor, opacity );",K.ShaderChunk.logdepthbuf_fragment,K.ShaderChunk.map_particle_fragment,K.ShaderChunk.color_fragment,K.ShaderChunk.alphatest_fragment,"\toutgoingLight = diffuseColor.rgb;",K.ShaderChunk.shadowmap_fragment,K.ShaderChunk.fog_fragment,"\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );","}"].join("\n")},dashed:{uniforms:K.UniformsUtils.merge([K.UniformsLib.common,K.UniformsLib.fog,{scale:{type:"f",value:1},dashSize:{type:"f",value:1},totalSize:{type:"f",value:2}}]),vertexShader:["uniform float scale;","attribute float lineDistance;","varying float vLineDistance;",K.ShaderChunk.common,K.ShaderChunk.color_pars_vertex,K.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",K.ShaderChunk.color_vertex,"\tvLineDistance = scale * lineDistance;","\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","\tgl_Position = projectionMatrix * mvPosition;",K.ShaderChunk.logdepthbuf_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 diffuse;","uniform float opacity;","uniform float dashSize;","uniform float totalSize;","varying float vLineDistance;",K.ShaderChunk.common,K.ShaderChunk.color_pars_fragment,K.ShaderChunk.fog_pars_fragment,K.ShaderChunk.logdepthbuf_pars_fragment,"void main() {","\tif ( mod( vLineDistance, totalSize ) > dashSize ) {","\t\tdiscard;","\t}","\tvec3 outgoingLight = vec3( 0.0 );","\tvec4 diffuseColor = vec4( diffuse, opacity );",K.ShaderChunk.logdepthbuf_fragment,K.ShaderChunk.color_fragment,"\toutgoingLight = diffuseColor.rgb;",K.ShaderChunk.fog_fragment,"\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );","}"].join("\n")},depth:{uniforms:{mNear:{type:"f",value:1},mFar:{type:"f",value:2e3},opacity:{type:"f",value:1}},vertexShader:[K.ShaderChunk.common,K.ShaderChunk.morphtarget_pars_vertex,K.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",K.ShaderChunk.morphtarget_vertex,K.ShaderChunk.default_vertex,K.ShaderChunk.logdepthbuf_vertex,"}"].join("\n"),fragmentShader:["uniform float mNear;","uniform float mFar;","uniform float opacity;",K.ShaderChunk.common,K.ShaderChunk.logdepthbuf_pars_fragment,"void main() {",K.ShaderChunk.logdepthbuf_fragment,"\t#ifdef USE_LOGDEPTHBUF_EXT","\t\tfloat depth = gl_FragDepthEXT / gl_FragCoord.w;","\t#else","\t\tfloat depth = gl_FragCoord.z / gl_FragCoord.w;","\t#endif","\tfloat color = 1.0 - smoothstep( mNear, mFar, depth );","\tgl_FragColor = vec4( vec3( color ), opacity );","}"].join("\n")},normal:{uniforms:{opacity:{type:"f",value:1}},vertexShader:["varying vec3 vNormal;",K.ShaderChunk.common,K.ShaderChunk.morphtarget_pars_vertex,K.ShaderChunk.logdepthbuf_pars_vertex,"void main() {","\tvNormal = normalize( normalMatrix * normal );",K.ShaderChunk.morphtarget_vertex,K.ShaderChunk.default_vertex,K.ShaderChunk.logdepthbuf_vertex,"}"].join("\n"),fragmentShader:["uniform float opacity;","varying vec3 vNormal;",K.ShaderChunk.common,K.ShaderChunk.logdepthbuf_pars_fragment,"void main() {","\tgl_FragColor = vec4( 0.5 * normalize( vNormal ) + 0.5, opacity );",K.ShaderChunk.logdepthbuf_fragment,"}"].join("\n")},cube:{uniforms:{tCube:{type:"t",value:null},tFlip:{type:"f",value:-1}},vertexShader:["varying vec3 vWorldPosition;",K.ShaderChunk.common,K.ShaderChunk.logdepthbuf_pars_vertex,"void main() {","\tvWorldPosition = transformDirection( position, modelMatrix );","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );",K.ShaderChunk.logdepthbuf_vertex,"}"].join("\n"),fragmentShader:["uniform samplerCube tCube;","uniform float tFlip;","varying vec3 vWorldPosition;",K.ShaderChunk.common,K.ShaderChunk.logdepthbuf_pars_fragment,"void main() {","\tgl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );",K.ShaderChunk.logdepthbuf_fragment,"}"].join("\n")},equirect:{uniforms:{tEquirect:{type:"t",value:null},tFlip:{type:"f",value:-1}},vertexShader:["varying vec3 vWorldPosition;",K.ShaderChunk.common,K.ShaderChunk.logdepthbuf_pars_vertex,"void main() {","\tvWorldPosition = transformDirection( position, modelMatrix );","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );",K.ShaderChunk.logdepthbuf_vertex,"}"].join("\n"),fragmentShader:["uniform sampler2D tEquirect;","uniform float tFlip;","varying vec3 vWorldPosition;",K.ShaderChunk.common,K.ShaderChunk.logdepthbuf_pars_fragment,"void main() {","vec3 direction = normalize( vWorldPosition );","vec2 sampleUV;","sampleUV.y = saturate( tFlip * direction.y * -0.5 + 0.5 );","sampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;","gl_FragColor = texture2D( tEquirect, sampleUV );",K.ShaderChunk.logdepthbuf_fragment,"}"].join("\n")},depthRGBA:{uniforms:{},vertexShader:[K.ShaderChunk.common,K.ShaderChunk.morphtarget_pars_vertex,K.ShaderChunk.skinning_pars_vertex,K.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",K.ShaderChunk.skinbase_vertex,K.ShaderChunk.morphtarget_vertex,K.ShaderChunk.skinning_vertex,K.ShaderChunk.default_vertex,K.ShaderChunk.logdepthbuf_vertex,"}"].join("\n"),fragmentShader:[K.ShaderChunk.common,K.ShaderChunk.logdepthbuf_pars_fragment,"vec4 pack_depth( const in float depth ) {","\tconst vec4 bit_shift = vec4( 256.0 * 256.0 * 256.0, 256.0 * 256.0, 256.0, 1.0 );","\tconst vec4 bit_mask = vec4( 0.0, 1.0 / 256.0, 1.0 / 256.0, 1.0 / 256.0 );","\tvec4 res = mod( depth * bit_shift * vec4( 255 ), vec4( 256 ) ) / vec4( 255 );","\tres -= res.xxyz * bit_mask;","\treturn res;","}","void main() {",K.ShaderChunk.logdepthbuf_fragment,"\t#ifdef USE_LOGDEPTHBUF_EXT","\t\tgl_FragData[ 0 ] = pack_depth( gl_FragDepthEXT );","\t#else","\t\tgl_FragData[ 0 ] = pack_depth( gl_FragCoord.z );","\t#endif","}"].join("\n")}},K.WebGLRenderer=function(e){console.log("THREE.WebGLRenderer",K.REVISION);var t=void 0!==(e=e||{}).canvas?e.canvas:document.createElement("canvas"),r=void 0!==e.context?e.context:null,n=1,i=void 0!==e.precision?e.precision:"highp",o=void 0!==e.alpha&&e.alpha,a=void 0===e.depth||e.depth,s=void 0===e.stencil||e.stencil,l=void 0!==e.antialias&&e.antialias,u=void 0===e.premultipliedAlpha||e.premultipliedAlpha,c=void 0!==e.preserveDrawingBuffer&&e.preserveDrawingBuffer,h=void 0!==e.logarithmicDepthBuffer&&e.logarithmicDepthBuffer,d=new K.Color(0),f=0,p=[],m={},g=[],v=[],y=[],b=[],x=[];this.domElement=t,this.context=null,this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.gammaFactor=2,this.gammaInput=!1,this.gammaOutput=!1,this.shadowMapEnabled=!1,this.shadowMapType=K.PCFShadowMap,this.shadowMapCullFace=K.CullFaceFront,this.shadowMapDebug=!1,this.shadowMapCascade=!1,this.maxMorphTargets=8,this.maxMorphNormals=4,this.autoScaleCubemaps=!0,this.info={memory:{programs:0,geometries:0,textures:0},render:{calls:0,vertices:0,faces:0,points:0}};var _,E=this,w=[],A=null,S=null,M=-1,T="",C=null,P=0,D=0,L=0,R=t.width,I=t.height,O=0,N=0,k=new K.Frustum,F=new K.Matrix4,V=new K.Vector3,U=new K.Vector3,B=!0,z={ambient:[0,0,0],directional:{length:0,colors:[],positions:[]},point:{length:0,colors:[],positions:[],distances:[],decays:[]},spot:{length:0,colors:[],positions:[],distances:[],directions:[],anglesCos:[],exponents:[],decays:[]},hemi:{length:0,skyColors:[],groundColors:[],positions:[]}};try{var G={alpha:o,depth:a,stencil:s,antialias:l,premultipliedAlpha:u,preserveDrawingBuffer:c};if(null===(_=r||t.getContext("webgl",G)||t.getContext("experimental-webgl",G)))throw null!==t.getContext("webgl")?"Error creating WebGL context with your selected attributes.":"Error creating WebGL context.";t.addEventListener("webglcontextlost",(function(e){e.preventDefault(),X(),q(),m={}}),!1)}catch(e){K.error("THREE.WebGLRenderer: "+e)}var H=new K.WebGLState(_,at);void 0===_.getShaderPrecisionFormat&&(_.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}});var W=new K.WebGLExtensions(_);W.get("OES_texture_float"),W.get("OES_texture_float_linear"),W.get("OES_texture_half_float"),W.get("OES_texture_half_float_linear"),W.get("OES_standard_derivatives"),h&&W.get("EXT_frag_depth");var j=function(e,t,r,n){!0===u&&(e*=n,t*=n,r*=n),_.clearColor(e,t,r,n)},q=function(){_.clearColor(0,0,0,1),_.clearDepth(1),_.clearStencil(0),_.enable(_.DEPTH_TEST),_.depthFunc(_.LEQUAL),_.frontFace(_.CCW),_.cullFace(_.BACK),_.enable(_.CULL_FACE),_.enable(_.BLEND),_.blendEquation(_.FUNC_ADD),_.blendFunc(_.SRC_ALPHA,_.ONE_MINUS_SRC_ALPHA),_.viewport(D,L,R,I),j(d.r,d.g,d.b,f)},X=function(){A=null,C=null,T="",M=-1,B=!0,H.reset()};q(),this.context=_,this.state=H;var Y,Z=_.getParameter(_.MAX_TEXTURE_IMAGE_UNITS),Q=_.getParameter(_.MAX_VERTEX_TEXTURE_IMAGE_UNITS),J=_.getParameter(_.MAX_TEXTURE_SIZE),$=_.getParameter(_.MAX_CUBE_MAP_TEXTURE_SIZE),ee=Q>0,te=ee&&W.get("OES_texture_float"),re=_.getShaderPrecisionFormat(_.VERTEX_SHADER,_.HIGH_FLOAT),ne=_.getShaderPrecisionFormat(_.VERTEX_SHADER,_.MEDIUM_FLOAT),ie=_.getShaderPrecisionFormat(_.FRAGMENT_SHADER,_.HIGH_FLOAT),oe=_.getShaderPrecisionFormat(_.FRAGMENT_SHADER,_.MEDIUM_FLOAT),ae=function(){if(void 0!==Y)return Y;if(Y=[],W.get("WEBGL_compressed_texture_pvrtc")||W.get("WEBGL_compressed_texture_s3tc"))for(var e=_.getParameter(_.COMPRESSED_TEXTURE_FORMATS),t=0;t<e.length;t++)Y.push(e[t]);return Y},se=re.precision>0&&ie.precision>0,le=ne.precision>0&&oe.precision>0;"highp"!==i||se||(le?(i="mediump",K.warn("THREE.WebGLRenderer: highp not supported, using mediump.")):(i="lowp",K.warn("THREE.WebGLRenderer: highp and mediump not supported, using lowp."))),"mediump"!==i||le||(i="lowp",K.warn("THREE.WebGLRenderer: mediump not supported, using lowp."));var ue,ce=new K.ShadowMapPlugin(this,p,m,g),he=new K.SpritePlugin(this,b),de=new K.LensFlarePlugin(this,x);function fe(e){e.__webglVertexBuffer=_.createBuffer(),e.__webglNormalBuffer=_.createBuffer(),e.__webglTangentBuffer=_.createBuffer(),e.__webglColorBuffer=_.createBuffer(),e.__webglUVBuffer=_.createBuffer(),e.__webglUV2Buffer=_.createBuffer(),e.__webglSkinIndicesBuffer=_.createBuffer(),e.__webglSkinWeightsBuffer=_.createBuffer(),e.__webglFaceBuffer=_.createBuffer(),e.__webglLineBuffer=_.createBuffer();var t=e.numMorphTargets;if(t){e.__webglMorphTargetsBuffers=[];for(var r=0,n=t;r<n;r++)e.__webglMorphTargetsBuffers.push(_.createBuffer())}var i=e.numMorphNormals;if(i){e.__webglMorphNormalsBuffers=[];for(r=0,n=i;r<n;r++)e.__webglMorphNormalsBuffers.push(_.createBuffer())}E.info.memory.geometries++}this.getContext=function(){return _},this.forceContextLoss=function(){W.get("WEBGL_lose_context").loseContext()},this.supportsVertexTextures=function(){return ee},this.supportsFloatTextures=function(){return W.get("OES_texture_float")},this.supportsHalfFloatTextures=function(){return W.get("OES_texture_half_float")},this.supportsStandardDerivatives=function(){return W.get("OES_standard_derivatives")},this.supportsCompressedTextureS3TC=function(){return W.get("WEBGL_compressed_texture_s3tc")},this.supportsCompressedTexturePVRTC=function(){return W.get("WEBGL_compressed_texture_pvrtc")},this.supportsBlendMinMax=function(){return W.get("EXT_blend_minmax")},this.getMaxAnisotropy=function(){if(void 0!==ue)return ue;var e=W.get("EXT_texture_filter_anisotropic");return ue=null!==e?_.getParameter(e.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0},this.getPrecision=function(){return i},this.getPixelRatio=function(){return n},this.setPixelRatio=function(e){n=e},this.setSize=function(e,r,i){t.width=e*n,t.height=r*n,!1!==i&&(t.style.width=e+"px",t.style.height=r+"px"),this.setViewport(0,0,e,r)},this.setViewport=function(e,t,r,i){D=e*n,L=t*n,R=r*n,I=i*n,_.viewport(D,L,R,I)},this.setScissor=function(e,t,r,i){_.scissor(e*n,t*n,r*n,i*n)},this.enableScissorTest=function(e){e?_.enable(_.SCISSOR_TEST):_.disable(_.SCISSOR_TEST)},this.getClearColor=function(){return d},this.setClearColor=function(e,t){d.set(e),f=void 0!==t?t:1,j(d.r,d.g,d.b,f)},this.getClearAlpha=function(){return f},this.setClearAlpha=function(e){f=e,j(d.r,d.g,d.b,f)},this.clear=function(e,t,r){var n=0;(void 0===e||e)&&(n|=_.COLOR_BUFFER_BIT),(void 0===t||t)&&(n|=_.DEPTH_BUFFER_BIT),(void 0===r||r)&&(n|=_.STENCIL_BUFFER_BIT),_.clear(n)},this.clearColor=function(){_.clear(_.COLOR_BUFFER_BIT)},this.clearDepth=function(){_.clear(_.DEPTH_BUFFER_BIT)},this.clearStencil=function(){_.clear(_.STENCIL_BUFFER_BIT)},this.clearTarget=function(e,t,r,n){this.setRenderTarget(e),this.clear(t,r,n)},this.resetGLState=X;var pe=function e(t){t.target.traverse((function(t){t.removeEventListener("remove",e),function(e){e instanceof K.Mesh||e instanceof K.PointCloud||e instanceof K.Line?delete m[e.id]:(e instanceof K.ImmediateRenderObject||e.immediateRenderCallback)&&function(e,t){for(var r=e.length-1;r>=0;r--)e[r].object===t&&e.splice(r,1)}(g,e);delete e.__webglInit,delete e._modelViewMatrix,delete e._normalMatrix,delete e.__webglActive}(t)}))},me=function e(t){var r=t.target;r.removeEventListener("dispose",e),xe(r)},ge=function e(t){var r=t.target;r.removeEventListener("dispose",e),_e(r),E.info.memory.textures--},ve=function e(t){var r=t.target;r.removeEventListener("dispose",e),Ee(r),E.info.memory.textures--},ye=function e(t){var r=t.target;r.removeEventListener("dispose",e),we(r)},be=function(e){for(var t=["__webglVertexBuffer","__webglNormalBuffer","__webglTangentBuffer","__webglColorBuffer","__webglUVBuffer","__webglUV2Buffer","__webglSkinIndicesBuffer","__webglSkinWeightsBuffer","__webglFaceBuffer","__webglLineBuffer","__webglLineDistanceBuffer"],r=0,n=t.length;r<n;r++){void 0!==e[i=t[r]]&&(_.deleteBuffer(e[i]),delete e[i])}if(void 0!==e.__webglCustomAttributesList){for(var i in e.__webglCustomAttributesList)_.deleteBuffer(e.__webglCustomAttributesList[i].buffer);delete e.__webglCustomAttributesList}E.info.memory.geometries--},xe=function(e){if(delete e.__webglInit,e instanceof K.BufferGeometry){for(var t in e.attributes){var r=e.attributes[t];void 0!==r.buffer&&(_.deleteBuffer(r.buffer),delete r.buffer)}E.info.memory.geometries--}else{var n=Fe[e.id];if(void 0!==n){for(var i=0,o=n.length;i<o;i++){var a=n[i];if(void 0!==a.numMorphTargets){for(var s=0,l=a.numMorphTargets;s<l;s++)_.deleteBuffer(a.__webglMorphTargetsBuffers[s]);delete a.__webglMorphTargetsBuffers}if(void 0!==a.numMorphNormals){for(s=0,l=a.numMorphNormals;s<l;s++)_.deleteBuffer(a.__webglMorphNormalsBuffers[s]);delete a.__webglMorphNormalsBuffers}be(a)}delete Fe[e.id]}else be(e)}T=""},_e=function(e){if(e.image&&e.image.__webglTextureCube)_.deleteTexture(e.image.__webglTextureCube),delete e.image.__webglTextureCube;else{if(void 0===e.__webglInit)return;_.deleteTexture(e.__webglTexture),delete e.__webglTexture,delete e.__webglInit}},Ee=function(e){if(e&&void 0!==e.__webglTexture){if(_.deleteTexture(e.__webglTexture),delete e.__webglTexture,e instanceof K.WebGLRenderTargetCube)for(var t=0;t<6;t++)_.deleteFramebuffer(e.__webglFramebuffer[t]),_.deleteRenderbuffer(e.__webglRenderbuffer[t]);else _.deleteFramebuffer(e.__webglFramebuffer),_.deleteRenderbuffer(e.__webglRenderbuffer);delete e.__webglFramebuffer,delete e.__webglRenderbuffer}},we=function(e){var t=e.program.program;if(void 0!==t){var r,n,i;e.program=void 0;var o=!1;for(r=0,n=w.length;r<n;r++)if((i=w[r]).program===t){i.usedTimes--,0===i.usedTimes&&(o=!0);break}if(!0===o){var a=[];for(r=0,n=w.length;r<n;r++)(i=w[r]).program!==t&&a.push(i);w=a,_.deleteProgram(t),E.info.memory.programs--}}};function Ae(e){var t=e.geometry,r=e.material,n=t.vertices.length;if(r.attributes)for(var i in void 0===t.__webglCustomAttributesList&&(t.__webglCustomAttributesList=[]),r.attributes){var o=r.attributes[i];if(!o.__webglInitialized||o.createUniqueBuffers){o.__webglInitialized=!0;var a=1;"v2"===o.type?a=2:"v3"===o.type?a=3:"v4"===o.type?a=4:"c"===o.type&&(a=3),o.size=a,o.array=new Float32Array(n*a),o.buffer=_.createBuffer(),o.buffer.belongsToAttribute=i,o.needsUpdate=!0}t.__webglCustomAttributesList.push(o)}}function Se(e,t){var r=t.geometry,n=e.faces3,i=3*n.length,o=1*n.length,a=3*n.length,s=Me(t,e);e.__vertexArray=new Float32Array(3*i),e.__normalArray=new Float32Array(3*i),e.__colorArray=new Float32Array(3*i),e.__uvArray=new Float32Array(2*i),r.faceVertexUvs.length>1&&(e.__uv2Array=new Float32Array(2*i)),r.hasTangents&&(e.__tangentArray=new Float32Array(4*i)),t.geometry.skinWeights.length&&t.geometry.skinIndices.length&&(e.__skinIndexArray=new Float32Array(4*i),e.__skinWeightArray=new Float32Array(4*i));var l=null!==W.get("OES_element_index_uint")&&o>21845?Uint32Array:Uint16Array;e.__typeArray=l,e.__faceArray=new l(3*o),e.__lineArray=new l(2*a);var u=e.numMorphTargets;if(u){e.__morphTargetsArrays=[];for(var c=0,h=u;c<h;c++)e.__morphTargetsArrays.push(new Float32Array(3*i))}var d=e.numMorphNormals;if(d){e.__morphNormalsArrays=[];for(c=0,h=d;c<h;c++)e.__morphNormalsArrays.push(new Float32Array(3*i))}if(e.__webglFaceCount=3*o,e.__webglLineCount=2*a,s.attributes)for(var f in void 0===e.__webglCustomAttributesList&&(e.__webglCustomAttributesList=[]),s.attributes){var p=s.attributes[f],m={};for(var g in p)m[g]=p[g];if(!m.__webglInitialized||m.createUniqueBuffers){m.__webglInitialized=!0;var v=1;"v2"===m.type?v=2:"v3"===m.type?v=3:"v4"===m.type?v=4:"c"===m.type&&(v=3),m.size=v,m.array=new Float32Array(i*v),m.buffer=_.createBuffer(),m.buffer.belongsToAttribute=f,p.needsUpdate=!0,m.__original=p}e.__webglCustomAttributesList.push(m)}e.__inittedArrays=!0}function Me(e,t){return e.material instanceof K.MeshFaceMaterial?e.material.materials[t.materialIndex]:e.material}function Te(e,t,r,n,i){if(e.__inittedArrays){var o,a,s,l,u,c,h,d,f,p,m,g,v,y,b,x,E,w,A,S,M,T,C,P,D,L,R,I,O,N,k,F,V,U,B,z,G,H,W,j,q,X=function(e){return e instanceof K.MeshPhongMaterial==0&&e.shading===K.FlatShading}(i),Y=0,Z=0,Q=0,J=0,$=0,ee=0,te=0,re=0,ne=0,ie=0,oe=0,ae=0,se=e.__vertexArray,le=e.__uvArray,ue=e.__uv2Array,ce=e.__normalArray,he=e.__tangentArray,de=e.__colorArray,fe=e.__skinIndexArray,pe=e.__skinWeightArray,me=e.__morphTargetsArrays,ge=e.__morphNormalsArrays,ve=e.__webglCustomAttributesList,ye=e.__faceArray,be=e.__lineArray,xe=t.geometry,_e=xe.verticesNeedUpdate,Ee=xe.elementsNeedUpdate,we=xe.uvsNeedUpdate,Ae=xe.normalsNeedUpdate,Se=xe.tangentsNeedUpdate,Me=xe.colorsNeedUpdate,Te=xe.morphTargetsNeedUpdate,Ce=xe.vertices,Pe=e.faces3,De=xe.faces,Le=xe.faceVertexUvs[0],Re=xe.faceVertexUvs[1],Ie=xe.skinIndices,Oe=xe.skinWeights,Ne=xe.morphTargets,ke=xe.morphNormals;if(_e){for(o=0,a=Pe.length;o<a;o++)m=Ce[(s=De[Pe[o]]).a],g=Ce[s.b],v=Ce[s.c],se[Z]=m.x,se[Z+1]=m.y,se[Z+2]=m.z,se[Z+3]=g.x,se[Z+4]=g.y,se[Z+5]=g.z,se[Z+6]=v.x,se[Z+7]=v.y,se[Z+8]=v.z,Z+=9;_.bindBuffer(_.ARRAY_BUFFER,e.__webglVertexBuffer),_.bufferData(_.ARRAY_BUFFER,se,r)}if(Te)for(U=0,B=Ne.length;U<B;U++){for(oe=0,o=0,a=Pe.length;o<a;o++)s=De[H=Pe[o]],m=Ne[U].vertices[s.a],g=Ne[U].vertices[s.b],v=Ne[U].vertices[s.c],(z=me[U])[oe]=m.x,z[oe+1]=m.y,z[oe+2]=m.z,z[oe+3]=g.x,z[oe+4]=g.y,z[oe+5]=g.z,z[oe+6]=v.x,z[oe+7]=v.y,z[oe+8]=v.z,i.morphNormals&&(X?(w=E=ke[U].faceNormals[H],A=E):(E=(W=ke[U].vertexNormals[H]).a,w=W.b,A=W.c),(G=ge[U])[oe]=E.x,G[oe+1]=E.y,G[oe+2]=E.z,G[oe+3]=w.x,G[oe+4]=w.y,G[oe+5]=w.z,G[oe+6]=A.x,G[oe+7]=A.y,G[oe+8]=A.z),oe+=9;_.bindBuffer(_.ARRAY_BUFFER,e.__webglMorphTargetsBuffers[U]),_.bufferData(_.ARRAY_BUFFER,me[U],r),i.morphNormals&&(_.bindBuffer(_.ARRAY_BUFFER,e.__webglMorphNormalsBuffers[U]),_.bufferData(_.ARRAY_BUFFER,ge[U],r))}if(Oe.length){for(o=0,a=Pe.length;o<a;o++)C=Oe[(s=De[Pe[o]]).a],P=Oe[s.b],D=Oe[s.c],pe[ie]=C.x,pe[ie+1]=C.y,pe[ie+2]=C.z,pe[ie+3]=C.w,pe[ie+4]=P.x,pe[ie+5]=P.y,pe[ie+6]=P.z,pe[ie+7]=P.w,pe[ie+8]=D.x,pe[ie+9]=D.y,pe[ie+10]=D.z,pe[ie+11]=D.w,L=Ie[s.a],R=Ie[s.b],I=Ie[s.c],fe[ie]=L.x,fe[ie+1]=L.y,fe[ie+2]=L.z,fe[ie+3]=L.w,fe[ie+4]=R.x,fe[ie+5]=R.y,fe[ie+6]=R.z,fe[ie+7]=R.w,fe[ie+8]=I.x,fe[ie+9]=I.y,fe[ie+10]=I.z,fe[ie+11]=I.w,ie+=12;ie>0&&(_.bindBuffer(_.ARRAY_BUFFER,e.__webglSkinIndicesBuffer),_.bufferData(_.ARRAY_BUFFER,fe,r),_.bindBuffer(_.ARRAY_BUFFER,e.__webglSkinWeightsBuffer),_.bufferData(_.ARRAY_BUFFER,pe,r))}if(Me){for(o=0,a=Pe.length;o<a;o++)c=(s=De[Pe[o]]).vertexColors,h=s.color,3===c.length&&i.vertexColors===K.VertexColors?(S=c[0],M=c[1],T=c[2]):(S=h,M=h,T=h),de[ne]=S.r,de[ne+1]=S.g,de[ne+2]=S.b,de[ne+3]=M.r,de[ne+4]=M.g,de[ne+5]=M.b,de[ne+6]=T.r,de[ne+7]=T.g,de[ne+8]=T.b,ne+=9;ne>0&&(_.bindBuffer(_.ARRAY_BUFFER,e.__webglColorBuffer),_.bufferData(_.ARRAY_BUFFER,de,r))}if(Se&&xe.hasTangents){for(o=0,a=Pe.length;o<a;o++)y=(d=(s=De[Pe[o]]).vertexTangents)[0],b=d[1],x=d[2],he[te]=y.x,he[te+1]=y.y,he[te+2]=y.z,he[te+3]=y.w,he[te+4]=b.x,he[te+5]=b.y,he[te+6]=b.z,he[te+7]=b.w,he[te+8]=x.x,he[te+9]=x.y,he[te+10]=x.z,he[te+11]=x.w,te+=12;_.bindBuffer(_.ARRAY_BUFFER,e.__webglTangentBuffer),_.bufferData(_.ARRAY_BUFFER,he,r)}if(Ae){for(o=0,a=Pe.length;o<a;o++)if(l=(s=De[Pe[o]]).vertexNormals,u=s.normal,3===l.length&&!1===X)for(O=0;O<3;O++)k=l[O],ce[ee]=k.x,ce[ee+1]=k.y,ce[ee+2]=k.z,ee+=3;else for(O=0;O<3;O++)ce[ee]=u.x,ce[ee+1]=u.y,ce[ee+2]=u.z,ee+=3;_.bindBuffer(_.ARRAY_BUFFER,e.__webglNormalBuffer),_.bufferData(_.ARRAY_BUFFER,ce,r)}if(we&&Le){for(o=0,a=Pe.length;o<a;o++)if(void 0!==(f=Le[Pe[o]]))for(O=0;O<3;O++)F=f[O],le[Q]=F.x,le[Q+1]=F.y,Q+=2;Q>0&&(_.bindBuffer(_.ARRAY_BUFFER,e.__webglUVBuffer),_.bufferData(_.ARRAY_BUFFER,le,r))}if(we&&Re){for(o=0,a=Pe.length;o<a;o++)if(void 0!==(p=Re[Pe[o]]))for(O=0;O<3;O++)V=p[O],ue[J]=V.x,ue[J+1]=V.y,J+=2;J>0&&(_.bindBuffer(_.ARRAY_BUFFER,e.__webglUV2Buffer),_.bufferData(_.ARRAY_BUFFER,ue,r))}if(Ee){for(o=0,a=Pe.length;o<a;o++)ye[$]=Y,ye[$+1]=Y+1,ye[$+2]=Y+2,$+=3,be[re]=Y,be[re+1]=Y+1,be[re+2]=Y,be[re+3]=Y+2,be[re+4]=Y+1,be[re+5]=Y+2,re+=6,Y+=3;_.bindBuffer(_.ELEMENT_ARRAY_BUFFER,e.__webglFaceBuffer),_.bufferData(_.ELEMENT_ARRAY_BUFFER,ye,r),_.bindBuffer(_.ELEMENT_ARRAY_BUFFER,e.__webglLineBuffer),_.bufferData(_.ELEMENT_ARRAY_BUFFER,be,r)}if(ve)for(O=0,N=ve.length;O<N;O++)if((q=ve[O]).__original.needsUpdate){if(ae=0,1===q.size){if(void 0===q.boundTo||"vertices"===q.boundTo)for(o=0,a=Pe.length;o<a;o++)s=De[Pe[o]],q.array[ae]=q.value[s.a],q.array[ae+1]=q.value[s.b],q.array[ae+2]=q.value[s.c],ae+=3;else if("faces"===q.boundTo)for(o=0,a=Pe.length;o<a;o++)j=q.value[Pe[o]],q.array[ae]=j,q.array[ae+1]=j,q.array[ae+2]=j,ae+=3}else if(2===q.size){if(void 0===q.boundTo||"vertices"===q.boundTo)for(o=0,a=Pe.length;o<a;o++)s=De[Pe[o]],m=q.value[s.a],g=q.value[s.b],v=q.value[s.c],q.array[ae]=m.x,q.array[ae+1]=m.y,q.array[ae+2]=g.x,q.array[ae+3]=g.y,q.array[ae+4]=v.x,q.array[ae+5]=v.y,ae+=6;else if("faces"===q.boundTo)for(o=0,a=Pe.length;o<a;o++)m=j=q.value[Pe[o]],g=j,v=j,q.array[ae]=m.x,q.array[ae+1]=m.y,q.array[ae+2]=g.x,q.array[ae+3]=g.y,q.array[ae+4]=v.x,q.array[ae+5]=v.y,ae+=6}else if(3===q.size){var Fe;if(Fe="c"===q.type?["r","g","b"]:["x","y","z"],void 0===q.boundTo||"vertices"===q.boundTo)for(o=0,a=Pe.length;o<a;o++)s=De[Pe[o]],m=q.value[s.a],g=q.value[s.b],v=q.value[s.c],q.array[ae]=m[Fe[0]],q.array[ae+1]=m[Fe[1]],q.array[ae+2]=m[Fe[2]],q.array[ae+3]=g[Fe[0]],q.array[ae+4]=g[Fe[1]],q.array[ae+5]=g[Fe[2]],q.array[ae+6]=v[Fe[0]],q.array[ae+7]=v[Fe[1]],q.array[ae+8]=v[Fe[2]],ae+=9;else if("faces"===q.boundTo)for(o=0,a=Pe.length;o<a;o++)m=j=q.value[Pe[o]],g=j,v=j,q.array[ae]=m[Fe[0]],q.array[ae+1]=m[Fe[1]],q.array[ae+2]=m[Fe[2]],q.array[ae+3]=g[Fe[0]],q.array[ae+4]=g[Fe[1]],q.array[ae+5]=g[Fe[2]],q.array[ae+6]=v[Fe[0]],q.array[ae+7]=v[Fe[1]],q.array[ae+8]=v[Fe[2]],ae+=9;else if("faceVertices"===q.boundTo)for(o=0,a=Pe.length;o<a;o++)m=(j=q.value[Pe[o]])[0],g=j[1],v=j[2],q.array[ae]=m[Fe[0]],q.array[ae+1]=m[Fe[1]],q.array[ae+2]=m[Fe[2]],q.array[ae+3]=g[Fe[0]],q.array[ae+4]=g[Fe[1]],q.array[ae+5]=g[Fe[2]],q.array[ae+6]=v[Fe[0]],q.array[ae+7]=v[Fe[1]],q.array[ae+8]=v[Fe[2]],ae+=9}else if(4===q.size)if(void 0===q.boundTo||"vertices"===q.boundTo)for(o=0,a=Pe.length;o<a;o++)s=De[Pe[o]],m=q.value[s.a],g=q.value[s.b],v=q.value[s.c],q.array[ae]=m.x,q.array[ae+1]=m.y,q.array[ae+2]=m.z,q.array[ae+3]=m.w,q.array[ae+4]=g.x,q.array[ae+5]=g.y,q.array[ae+6]=g.z,q.array[ae+7]=g.w,q.array[ae+8]=v.x,q.array[ae+9]=v.y,q.array[ae+10]=v.z,q.array[ae+11]=v.w,ae+=12;else if("faces"===q.boundTo)for(o=0,a=Pe.length;o<a;o++)m=j=q.value[Pe[o]],g=j,v=j,q.array[ae]=m.x,q.array[ae+1]=m.y,q.array[ae+2]=m.z,q.array[ae+3]=m.w,q.array[ae+4]=g.x,q.array[ae+5]=g.y,q.array[ae+6]=g.z,q.array[ae+7]=g.w,q.array[ae+8]=v.x,q.array[ae+9]=v.y,q.array[ae+10]=v.z,q.array[ae+11]=v.w,ae+=12;else if("faceVertices"===q.boundTo)for(o=0,a=Pe.length;o<a;o++)m=(j=q.value[Pe[o]])[0],g=j[1],v=j[2],q.array[ae]=m.x,q.array[ae+1]=m.y,q.array[ae+2]=m.z,q.array[ae+3]=m.w,q.array[ae+4]=g.x,q.array[ae+5]=g.y,q.array[ae+6]=g.z,q.array[ae+7]=g.w,q.array[ae+8]=v.x,q.array[ae+9]=v.y,q.array[ae+10]=v.z,q.array[ae+11]=v.w,ae+=12;_.bindBuffer(_.ARRAY_BUFFER,q.buffer),_.bufferData(_.ARRAY_BUFFER,q.array,r)}n&&(delete e.__inittedArrays,delete e.__colorArray,delete e.__normalArray,delete e.__tangentArray,delete e.__uvArray,delete e.__uv2Array,delete e.__faceArray,delete e.__vertexArray,delete e.__lineArray,delete e.__skinIndexArray,delete e.__skinWeightArray)}}function Ce(e,t,r,n){for(var i=r.attributes,o=t.attributes,a=t.attributesKeys,s=0,l=a.length;s<l;s++){var u=a[s],c=o[u];if(c>=0){var h=i[u];if(void 0!==h){var d=h.itemSize;_.bindBuffer(_.ARRAY_BUFFER,h.buffer),H.enableAttribute(c),_.vertexAttribPointer(c,d,_.FLOAT,!1,0,n*d*4)}else void 0!==e.defaultAttributeValues&&(2===e.defaultAttributeValues[u].length?_.vertexAttrib2fv(c,e.defaultAttributeValues[u]):3===e.defaultAttributeValues[u].length&&_.vertexAttrib3fv(c,e.defaultAttributeValues[u]))}}H.disableUnusedAttributes()}function Pe(e,t){return e.object.renderOrder!==t.object.renderOrder?e.object.renderOrder-t.object.renderOrder:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function De(e,t){return e.object.renderOrder!==t.object.renderOrder?e.object.renderOrder-t.object.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function Le(e,t){return t[0]-e[0]}function Re(e){if(!1!==e.visible){if(e instanceof K.Scene||e instanceof K.Group);else if(function(e){void 0===e.__webglInit&&(e.__webglInit=!0,e._modelViewMatrix=new K.Matrix4,e._normalMatrix=new K.Matrix3,e.addEventListener("removed",pe));var t=e.geometry;void 0===t||void 0===t.__webglInit&&(t.__webglInit=!0,t.addEventListener("dispose",me),t instanceof K.BufferGeometry?E.info.memory.geometries++:e instanceof K.Mesh?Ue(e,t):e instanceof K.Line?void 0===t.__webglVertexBuffer&&(!function(e){e.__webglVertexBuffer=_.createBuffer(),e.__webglColorBuffer=_.createBuffer(),e.__webglLineDistanceBuffer=_.createBuffer(),E.info.memory.geometries++}(t),function(e,t){var r=e.vertices.length;e.__vertexArray=new Float32Array(3*r),e.__colorArray=new Float32Array(3*r),e.__lineDistanceArray=new Float32Array(1*r),e.__webglLineCount=r,Ae(t)}(t,e),t.verticesNeedUpdate=!0,t.colorsNeedUpdate=!0,t.lineDistancesNeedUpdate=!0):e instanceof K.PointCloud&&void 0===t.__webglVertexBuffer&&(!function(e){e.__webglVertexBuffer=_.createBuffer(),e.__webglColorBuffer=_.createBuffer(),E.info.memory.geometries++}(t),function(e,t){var r=e.vertices.length;e.__vertexArray=new Float32Array(3*r),e.__colorArray=new Float32Array(3*r),e.__webglParticleCount=r,Ae(t)}(t,e),t.verticesNeedUpdate=!0,t.colorsNeedUpdate=!0));if(void 0===e.__webglActive)if(e.__webglActive=!0,e instanceof K.Mesh){if(t instanceof K.BufferGeometry)Be(m,t,e);else if(t instanceof K.Geometry)for(var r=Fe[t.id],n=0,i=r.length;n<i;n++)Be(m,r[n],e)}else e instanceof K.Line||e instanceof K.PointCloud?Be(m,t,e):(e instanceof K.ImmediateRenderObject||e.immediateRenderCallback)&&function(e,t){e.push({id:null,object:t,opaque:null,transparent:null,z:0})}(g,e)}(e),e instanceof K.Light)p.push(e);else if(e instanceof K.Sprite)b.push(e);else if(e instanceof K.LensFlare)x.push(e);else{var t=m[e.id];if(t&&(!1===e.frustumCulled||!0===k.intersectsObject(e)))for(var r=0,n=t.length;r<n;r++){var i=t[r];ke(i),i.render=!0,!0===E.sortObjects&&(V.setFromMatrixPosition(e.matrixWorld),V.applyProjection(F),i.z=V.z)}}for(r=0,n=e.children.length;r<n;r++)Re(e.children[r])}}function Ie(e,t,r,n,i){for(var o,a=0,s=e.length;a<s;a++){var l=e[a],u=l.object,c=l.buffer;if(Qe(u,t),i)o=i;else{if(!(o=l.material))continue;qe(o)}E.setMaterialFaces(o),c instanceof K.BufferGeometry?E.renderBufferDirect(t,r,n,o,c,u):E.renderBuffer(t,r,n,o,c,u)}}function Oe(e,t,r,n,i,o){for(var a,s=0,l=e.length;s<l;s++){var u=e[s],c=u.object;if(c.visible){if(o)a=o;else{if(!(a=u[t]))continue;qe(a)}E.renderImmediateObject(r,n,i,a,c)}}}function Ne(e){var t=e.object.material;t.transparent?(e.transparent=t,e.opaque=null):(e.opaque=t,e.transparent=null)}function ke(e){var t=e.object,r=e.buffer,n=t.geometry,i=t.material;if(i instanceof K.MeshFaceMaterial){var o=n instanceof K.BufferGeometry?0:r.materialIndex;i=i.materials[o],e.material=i,i.transparent?y.push(e):v.push(e)}else i&&(e.material=i,i.transparent?y.push(e):v.push(e))}this.renderBufferImmediate=function(e,t,r){if(H.initAttributes(),e.hasPositions&&!e.__webglVertexBuffer&&(e.__webglVertexBuffer=_.createBuffer()),e.hasNormals&&!e.__webglNormalBuffer&&(e.__webglNormalBuffer=_.createBuffer()),e.hasUvs&&!e.__webglUvBuffer&&(e.__webglUvBuffer=_.createBuffer()),e.hasColors&&!e.__webglColorBuffer&&(e.__webglColorBuffer=_.createBuffer()),e.hasPositions&&(_.bindBuffer(_.ARRAY_BUFFER,e.__webglVertexBuffer),_.bufferData(_.ARRAY_BUFFER,e.positionArray,_.DYNAMIC_DRAW),H.enableAttribute(t.attributes.position),_.vertexAttribPointer(t.attributes.position,3,_.FLOAT,!1,0,0)),e.hasNormals){if(_.bindBuffer(_.ARRAY_BUFFER,e.__webglNormalBuffer),r instanceof K.MeshPhongMaterial==!1&&r.shading===K.FlatShading){var n,i,o,a,s,l,u,c,h,d,f,p=3*e.count;for(f=0;f<p;f+=9)a=(d=e.normalArray)[f],l=d[f+1],c=d[f+2],s=d[f+3],u=d[f+4],h=d[f+5],n=(a+s+d[f+6])/3,i=(l+u+d[f+7])/3,o=(c+h+d[f+8])/3,d[f]=n,d[f+1]=i,d[f+2]=o,d[f+3]=n,d[f+4]=i,d[f+5]=o,d[f+6]=n,d[f+7]=i,d[f+8]=o}_.bufferData(_.ARRAY_BUFFER,e.normalArray,_.DYNAMIC_DRAW),H.enableAttribute(t.attributes.normal),_.vertexAttribPointer(t.attributes.normal,3,_.FLOAT,!1,0,0)}e.hasUvs&&r.map&&(_.bindBuffer(_.ARRAY_BUFFER,e.__webglUvBuffer),_.bufferData(_.ARRAY_BUFFER,e.uvArray,_.DYNAMIC_DRAW),H.enableAttribute(t.attributes.uv),_.vertexAttribPointer(t.attributes.uv,2,_.FLOAT,!1,0,0)),e.hasColors&&r.vertexColors!==K.NoColors&&(_.bindBuffer(_.ARRAY_BUFFER,e.__webglColorBuffer),_.bufferData(_.ARRAY_BUFFER,e.colorArray,_.DYNAMIC_DRAW),H.enableAttribute(t.attributes.color),_.vertexAttribPointer(t.attributes.color,3,_.FLOAT,!1,0,0)),H.disableUnusedAttributes(),_.drawArrays(_.TRIANGLES,0,e.count),e.count=0},this.renderBufferDirect=function(e,t,r,i,o,a){if(!1!==i.visible){ze(a);var s=Xe(e,t,r,i,a),l=!1,u=i.wireframe?1:0,c="direct_"+o.id+"_"+s.id+"_"+u;if(c!==T&&(T=c,l=!0),l&&H.initAttributes(),a instanceof K.Mesh){var h=!0===i.wireframe?_.LINES:_.TRIANGLES;if(g=o.attributes.index){if(g.array instanceof Uint32Array&&W.get("OES_element_index_uint")?(v=_.UNSIGNED_INT,y=4):(v=_.UNSIGNED_SHORT,y=2),0===(b=o.offsets).length)l&&(Ce(i,s,o,0),_.bindBuffer(_.ELEMENT_ARRAY_BUFFER,g.buffer)),_.drawElements(h,g.array.length,v,0),E.info.render.calls++,E.info.render.vertices+=g.array.length,E.info.render.faces+=g.array.length/3;else{l=!0;for(var d=0,f=b.length;d<f;d++){var p=b[d].index;l&&(Ce(i,s,o,p),_.bindBuffer(_.ELEMENT_ARRAY_BUFFER,g.buffer)),_.drawElements(h,b[d].count,v,b[d].start*y),E.info.render.calls++,E.info.render.vertices+=b[d].count,E.info.render.faces+=b[d].count/3}}}else{l&&Ce(i,s,o,0);var m=o.attributes.position;_.drawArrays(h,0,m.array.length/m.itemSize),E.info.render.calls++,E.info.render.vertices+=m.array.length/m.itemSize,E.info.render.faces+=m.array.length/(3*m.itemSize)}}else if(a instanceof K.PointCloud){h=_.POINTS;if(g=o.attributes.index){if(g.array instanceof Uint32Array&&W.get("OES_element_index_uint")?(v=_.UNSIGNED_INT,y=4):(v=_.UNSIGNED_SHORT,y=2),0===(b=o.offsets).length)l&&(Ce(i,s,o,0),_.bindBuffer(_.ELEMENT_ARRAY_BUFFER,g.buffer)),_.drawElements(h,g.array.length,v,0),E.info.render.calls++,E.info.render.points+=g.array.length;else{b.length>1&&(l=!0);for(d=0,f=b.length;d<f;d++){p=b[d].index;l&&(Ce(i,s,o,p),_.bindBuffer(_.ELEMENT_ARRAY_BUFFER,g.buffer)),_.drawElements(h,b[d].count,v,b[d].start*y),E.info.render.calls++,E.info.render.points+=b[d].count}}}else{l&&Ce(i,s,o,0);m=o.attributes.position;if(0===(b=o.offsets).length)_.drawArrays(h,0,m.array.length/3),E.info.render.calls++,E.info.render.points+=m.array.length/3;else for(d=0,f=b.length;d<f;d++)_.drawArrays(h,b[d].index,b[d].count),E.info.render.calls++,E.info.render.points+=b[d].count}}else if(a instanceof K.Line){var g;h=a.mode===K.LineStrip?_.LINE_STRIP:_.LINES;if(H.setLineWidth(i.linewidth*n),g=o.attributes.index){var v,y;if(g.array instanceof Uint32Array?(v=_.UNSIGNED_INT,y=4):(v=_.UNSIGNED_SHORT,y=2),0===(b=o.offsets).length)l&&(Ce(i,s,o,0),_.bindBuffer(_.ELEMENT_ARRAY_BUFFER,g.buffer)),_.drawElements(h,g.array.length,v,0),E.info.render.calls++,E.info.render.vertices+=g.array.length;else{b.length>1&&(l=!0);for(d=0,f=b.length;d<f;d++){p=b[d].index;l&&(Ce(i,s,o,p),_.bindBuffer(_.ELEMENT_ARRAY_BUFFER,g.buffer)),_.drawElements(h,b[d].count,v,b[d].start*y),E.info.render.calls++,E.info.render.vertices+=b[d].count}}}else{l&&Ce(i,s,o,0);var b;m=o.attributes.position;if(0===(b=o.offsets).length)_.drawArrays(h,0,m.array.length/3),E.info.render.calls++,E.info.render.vertices+=m.array.length/3;else for(d=0,f=b.length;d<f;d++)_.drawArrays(h,b[d].index,b[d].count),E.info.render.calls++,E.info.render.vertices+=b[d].count}}}},this.renderBuffer=function(e,t,r,i,o,a){if(!1!==i.visible){ze(a);var s=Xe(e,t,r,i,a),l=s.attributes,u=!1,c=i.wireframe?1:0,h=o.id+"_"+s.id+"_"+c;if(h!==T&&(T=h,u=!0),u&&H.initAttributes(),!i.morphTargets&&l.position>=0?u&&(_.bindBuffer(_.ARRAY_BUFFER,o.__webglVertexBuffer),H.enableAttribute(l.position),_.vertexAttribPointer(l.position,3,_.FLOAT,!1,0,0)):a.morphTargetBase&&function(e,t,r){var n=e.program.attributes;-1!==r.morphTargetBase&&n.position>=0?(_.bindBuffer(_.ARRAY_BUFFER,t.__webglMorphTargetsBuffers[r.morphTargetBase]),H.enableAttribute(n.position),_.vertexAttribPointer(n.position,3,_.FLOAT,!1,0,0)):n.position>=0&&(_.bindBuffer(_.ARRAY_BUFFER,t.__webglVertexBuffer),H.enableAttribute(n.position),_.vertexAttribPointer(n.position,3,_.FLOAT,!1,0,0));if(r.morphTargetForcedOrder.length)for(var i=0,o=r.morphTargetForcedOrder,a=r.morphTargetInfluences;i<e.numSupportedMorphTargets&&i<o.length;)(s=n["morphTarget"+i])>=0&&(_.bindBuffer(_.ARRAY_BUFFER,t.__webglMorphTargetsBuffers[o[i]]),H.enableAttribute(s),_.vertexAttribPointer(s,3,_.FLOAT,!1,0,0)),(s=n["morphNormal"+i])>=0&&e.morphNormals&&(_.bindBuffer(_.ARRAY_BUFFER,t.__webglMorphNormalsBuffers[o[i]]),H.enableAttribute(s),_.vertexAttribPointer(s,3,_.FLOAT,!1,0,0)),r.__webglMorphTargetInfluences[i]=a[o[i]],i++;else{var s,l=[],u=(a=r.morphTargetInfluences,r.geometry.morphTargets);a.length>u.length&&(console.warn("THREE.WebGLRenderer: Influences array is bigger than morphTargets array."),a.length=u.length);for(var c=0,h=a.length;c<h;c++){var d=a[c];l.push([d,c])}l.length>e.numSupportedMorphTargets?(l.sort(Le),l.length=e.numSupportedMorphTargets):l.length>e.numSupportedMorphNormals?l.sort(Le):0===l.length&&l.push([0,0]);i=0;for(var f=e.numSupportedMorphTargets;i<f;i++)if(l[i]){var p=l[i][1];(s=n["morphTarget"+i])>=0&&(_.bindBuffer(_.ARRAY_BUFFER,t.__webglMorphTargetsBuffers[p]),H.enableAttribute(s),_.vertexAttribPointer(s,3,_.FLOAT,!1,0,0)),(s=n["morphNormal"+i])>=0&&e.morphNormals&&(_.bindBuffer(_.ARRAY_BUFFER,t.__webglMorphNormalsBuffers[p]),H.enableAttribute(s),_.vertexAttribPointer(s,3,_.FLOAT,!1,0,0)),r.__webglMorphTargetInfluences[i]=a[p]}else r.__webglMorphTargetInfluences[i]=0}null!==e.program.uniforms.morphTargetInfluences&&_.uniform1fv(e.program.uniforms.morphTargetInfluences,r.__webglMorphTargetInfluences)}(i,o,a),u){if(o.__webglCustomAttributesList)for(var d=0,f=o.__webglCustomAttributesList.length;d<f;d++){var p=o.__webglCustomAttributesList[d];l[p.buffer.belongsToAttribute]>=0&&(_.bindBuffer(_.ARRAY_BUFFER,p.buffer),H.enableAttribute(l[p.buffer.belongsToAttribute]),_.vertexAttribPointer(l[p.buffer.belongsToAttribute],p.size,_.FLOAT,!1,0,0))}l.color>=0&&(a.geometry.colors.length>0||a.geometry.faces.length>0?(_.bindBuffer(_.ARRAY_BUFFER,o.__webglColorBuffer),H.enableAttribute(l.color),_.vertexAttribPointer(l.color,3,_.FLOAT,!1,0,0)):void 0!==i.defaultAttributeValues&&_.vertexAttrib3fv(l.color,i.defaultAttributeValues.color)),l.normal>=0&&(_.bindBuffer(_.ARRAY_BUFFER,o.__webglNormalBuffer),H.enableAttribute(l.normal),_.vertexAttribPointer(l.normal,3,_.FLOAT,!1,0,0)),l.tangent>=0&&(_.bindBuffer(_.ARRAY_BUFFER,o.__webglTangentBuffer),H.enableAttribute(l.tangent),_.vertexAttribPointer(l.tangent,4,_.FLOAT,!1,0,0)),l.uv>=0&&(a.geometry.faceVertexUvs[0]?(_.bindBuffer(_.ARRAY_BUFFER,o.__webglUVBuffer),H.enableAttribute(l.uv),_.vertexAttribPointer(l.uv,2,_.FLOAT,!1,0,0)):void 0!==i.defaultAttributeValues&&_.vertexAttrib2fv(l.uv,i.defaultAttributeValues.uv)),l.uv2>=0&&(a.geometry.faceVertexUvs[1]?(_.bindBuffer(_.ARRAY_BUFFER,o.__webglUV2Buffer),H.enableAttribute(l.uv2),_.vertexAttribPointer(l.uv2,2,_.FLOAT,!1,0,0)):void 0!==i.defaultAttributeValues&&_.vertexAttrib2fv(l.uv2,i.defaultAttributeValues.uv2)),i.skinning&&l.skinIndex>=0&&l.skinWeight>=0&&(_.bindBuffer(_.ARRAY_BUFFER,o.__webglSkinIndicesBuffer),H.enableAttribute(l.skinIndex),_.vertexAttribPointer(l.skinIndex,4,_.FLOAT,!1,0,0),_.bindBuffer(_.ARRAY_BUFFER,o.__webglSkinWeightsBuffer),H.enableAttribute(l.skinWeight),_.vertexAttribPointer(l.skinWeight,4,_.FLOAT,!1,0,0)),l.lineDistance>=0&&(_.bindBuffer(_.ARRAY_BUFFER,o.__webglLineDistanceBuffer),H.enableAttribute(l.lineDistance),_.vertexAttribPointer(l.lineDistance,1,_.FLOAT,!1,0,0))}if(H.disableUnusedAttributes(),a instanceof K.Mesh){var m=o.__typeArray===Uint32Array?_.UNSIGNED_INT:_.UNSIGNED_SHORT;i.wireframe?(H.setLineWidth(i.wireframeLinewidth*n),u&&_.bindBuffer(_.ELEMENT_ARRAY_BUFFER,o.__webglLineBuffer),_.drawElements(_.LINES,o.__webglLineCount,m,0)):(u&&_.bindBuffer(_.ELEMENT_ARRAY_BUFFER,o.__webglFaceBuffer),_.drawElements(_.TRIANGLES,o.__webglFaceCount,m,0)),E.info.render.calls++,E.info.render.vertices+=o.__webglFaceCount,E.info.render.faces+=o.__webglFaceCount/3}else if(a instanceof K.Line){var g=a.mode===K.LineStrip?_.LINE_STRIP:_.LINES;H.setLineWidth(i.linewidth*n),_.drawArrays(g,0,o.__webglLineCount),E.info.render.calls++}else a instanceof K.PointCloud&&(_.drawArrays(_.POINTS,0,o.__webglParticleCount),E.info.render.calls++,E.info.render.points+=o.__webglParticleCount)}},this.render=function(e,t,r,n){if(t instanceof K.Camera!=!1){var i=e.fog;T="",M=-1,C=null,B=!0,!0===e.autoUpdate&&e.updateMatrixWorld(),void 0===t.parent&&t.updateMatrixWorld(),e.traverse((function(e){e instanceof K.SkinnedMesh&&e.skeleton.update()})),t.matrixWorldInverse.getInverse(t.matrixWorld),F.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),k.setFromMatrix(F),p.length=0,v.length=0,y.length=0,b.length=0,x.length=0,Re(e),!0===E.sortObjects&&(v.sort(Pe),y.sort(De)),ce.render(e,t),E.info.render.calls=0,E.info.render.vertices=0,E.info.render.faces=0,E.info.render.points=0,this.setRenderTarget(r),(this.autoClear||n)&&this.clear(this.autoClearColor,this.autoClearDepth,this.autoClearStencil);for(var o=0,a=g.length;o<a;o++){var s=g[o],l=s.object;l.visible&&(Qe(l,t),Ne(s))}if(e.overrideMaterial){var u=e.overrideMaterial;qe(u),Ie(v,t,p,i,u),Ie(y,t,p,i,u),Oe(g,"",t,p,i,u)}else H.setBlending(K.NoBlending),Ie(v,t,p,i,null),Oe(g,"opaque",t,p,i,null),Ie(y,t,p,i,null),Oe(g,"transparent",t,p,i,null);he.render(e,t),de.render(e,t,O,N),r&&r.generateMipmaps&&r.minFilter!==K.NearestFilter&&r.minFilter!==K.LinearFilter&&function(e){e instanceof K.WebGLRenderTargetCube?(_.bindTexture(_.TEXTURE_CUBE_MAP,e.__webglTexture),_.generateMipmap(_.TEXTURE_CUBE_MAP),_.bindTexture(_.TEXTURE_CUBE_MAP,null)):(_.bindTexture(_.TEXTURE_2D,e.__webglTexture),_.generateMipmap(_.TEXTURE_2D),_.bindTexture(_.TEXTURE_2D,null))}(r),H.setDepthTest(!0),H.setDepthWrite(!0),H.setColorWrite(!0)}else K.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.renderImmediateObject=function(e,t,r,n,i){var o=Xe(e,t,r,n,i);T="",E.setMaterialFaces(n),i.immediateRenderCallback?i.immediateRenderCallback(o,_,k):i.render((function(e){E.renderBufferImmediate(e,o,n)}))};var Fe={},Ve=0;function Ue(e,t){var r=e.material,n=!1;void 0!==Fe[t.id]&&!0!==t.groupsNeedUpdate||(delete m[e.id],Fe[t.id]=function(e,t){for(var r,n,i=W.get("OES_element_index_uint")?4294967296:65535,o={},a=e.morphTargets.length,s=e.morphNormals.length,l={},u=[],c=0,h=e.faces.length;c<h;c++){var d=e.faces[c],f=t?d.materialIndex:0;f in o||(o[f]={hash:f,counter:0}),(r=o[f].hash+"_"+o[f].counter)in l||(n={id:Ve++,faces3:[],materialIndex:f,vertices:0,numMorphTargets:a,numMorphNormals:s},l[r]=n,u.push(n)),l[r].vertices+3>i&&(o[f].counter+=1,(r=o[f].hash+"_"+o[f].counter)in l||(n={id:Ve++,faces3:[],materialIndex:f,vertices:0,numMorphTargets:a,numMorphNormals:s},l[r]=n,u.push(n))),l[r].faces3.push(c),l[r].vertices+=3}return u}(t,r instanceof K.MeshFaceMaterial),t.groupsNeedUpdate=!1);for(var i=Fe[t.id],o=0,a=i.length;o<a;o++){var s=i[o];void 0===s.__webglVertexBuffer?(fe(s),Se(s,e),t.verticesNeedUpdate=!0,t.morphTargetsNeedUpdate=!0,t.elementsNeedUpdate=!0,t.uvsNeedUpdate=!0,t.normalsNeedUpdate=!0,t.tangentsNeedUpdate=!0,t.colorsNeedUpdate=!0,n=!0):n=!1,(n||void 0===e.__webglActive)&&Be(m,s,e)}e.__webglActive=!0}function Be(e,t,r){var n=r.id;e[n]=e[n]||[],e[n].push({id:n,buffer:t,object:r,material:null,z:0})}function ze(e){var t=e.geometry;if(t instanceof K.BufferGeometry)for(var r=t.attributes,n=t.attributesKeys,i=0,o=n.length;i<o;i++){var a=n[i],s=r[a],l="index"===a?_.ELEMENT_ARRAY_BUFFER:_.ARRAY_BUFFER;void 0===s.buffer?(s.buffer=_.createBuffer(),_.bindBuffer(l,s.buffer),_.bufferData(l,s.array,s instanceof K.DynamicBufferAttribute?_.DYNAMIC_DRAW:_.STATIC_DRAW),s.needsUpdate=!1):!0===s.needsUpdate&&(_.bindBuffer(l,s.buffer),void 0===s.updateRange||-1===s.updateRange.count?_.bufferSubData(l,0,s.array):0===s.updateRange.count?console.error("THREE.WebGLRenderer.updateObject: using updateRange for THREE.DynamicBufferAttribute and marked as needsUpdate but count is 0, ensure you are using set methods or updating manually."):(_.bufferSubData(l,s.updateRange.offset*s.array.BYTES_PER_ELEMENT,s.array.subarray(s.updateRange.offset,s.updateRange.offset+s.updateRange.count)),s.updateRange.count=0),s.needsUpdate=!1)}else if(e instanceof K.Mesh){!0===t.groupsNeedUpdate&&Ue(e,t);for(var u=Fe[t.id],c=(i=0,u.length);i<c;i++){var h=u[i],d=(f=Me(e,h)).attributes&&Ge(f);(t.verticesNeedUpdate||t.morphTargetsNeedUpdate||t.elementsNeedUpdate||t.uvsNeedUpdate||t.normalsNeedUpdate||t.colorsNeedUpdate||t.tangentsNeedUpdate||d)&&Te(h,e,_.DYNAMIC_DRAW,!t.dynamic,f)}t.verticesNeedUpdate=!1,t.morphTargetsNeedUpdate=!1,t.elementsNeedUpdate=!1,t.uvsNeedUpdate=!1,t.normalsNeedUpdate=!1,t.colorsNeedUpdate=!1,t.tangentsNeedUpdate=!1,f.attributes&&He(f)}else if(e instanceof K.Line){d=(f=Me(e,t)).attributes&&Ge(f);(t.verticesNeedUpdate||t.colorsNeedUpdate||t.lineDistancesNeedUpdate||d)&&function(e,t){var r,n,i,o,a,s,l,u,c,h,d,f,p=e.vertices,m=e.colors,g=e.lineDistances,v=p.length,y=m.length,b=g.length,x=e.__vertexArray,E=e.__colorArray,w=e.__lineDistanceArray,A=e.verticesNeedUpdate,S=e.colorsNeedUpdate,M=e.lineDistancesNeedUpdate,T=e.__webglCustomAttributesList;if(A){for(r=0;r<v;r++)o=p[r],x[a=3*r]=o.x,x[a+1]=o.y,x[a+2]=o.z;_.bindBuffer(_.ARRAY_BUFFER,e.__webglVertexBuffer),_.bufferData(_.ARRAY_BUFFER,x,t)}if(S){for(n=0;n<y;n++)s=m[n],E[a=3*n]=s.r,E[a+1]=s.g,E[a+2]=s.b;_.bindBuffer(_.ARRAY_BUFFER,e.__webglColorBuffer),_.bufferData(_.ARRAY_BUFFER,E,t)}if(M){for(i=0;i<b;i++)w[i]=g[i];_.bindBuffer(_.ARRAY_BUFFER,e.__webglLineDistanceBuffer),_.bufferData(_.ARRAY_BUFFER,w,t)}if(T)for(l=0,u=T.length;l<u;l++)if((f=T[l]).needsUpdate&&(void 0===f.boundTo||"vertices"===f.boundTo)){if(a=0,h=f.value.length,1===f.size)for(c=0;c<h;c++)f.array[c]=f.value[c];else if(2===f.size)for(c=0;c<h;c++)d=f.value[c],f.array[a]=d.x,f.array[a+1]=d.y,a+=2;else if(3===f.size)if("c"===f.type)for(c=0;c<h;c++)d=f.value[c],f.array[a]=d.r,f.array[a+1]=d.g,f.array[a+2]=d.b,a+=3;else for(c=0;c<h;c++)d=f.value[c],f.array[a]=d.x,f.array[a+1]=d.y,f.array[a+2]=d.z,a+=3;else if(4===f.size)for(c=0;c<h;c++)d=f.value[c],f.array[a]=d.x,f.array[a+1]=d.y,f.array[a+2]=d.z,f.array[a+3]=d.w,a+=4;_.bindBuffer(_.ARRAY_BUFFER,f.buffer),_.bufferData(_.ARRAY_BUFFER,f.array,t),f.needsUpdate=!1}}(t,_.DYNAMIC_DRAW),t.verticesNeedUpdate=!1,t.colorsNeedUpdate=!1,t.lineDistancesNeedUpdate=!1,f.attributes&&He(f)}else if(e instanceof K.PointCloud){var f;d=(f=Me(e,t)).attributes&&Ge(f);(t.verticesNeedUpdate||t.colorsNeedUpdate||d)&&function(e,t,r){var n,i,o,a,s,l,u,c,h,d,f,p=e.vertices,m=p.length,g=e.colors,v=g.length,y=e.__vertexArray,b=e.__colorArray,x=e.verticesNeedUpdate,E=e.colorsNeedUpdate,w=e.__webglCustomAttributesList;if(x){for(n=0;n<m;n++)o=p[n],y[a=3*n]=o.x,y[a+1]=o.y,y[a+2]=o.z;_.bindBuffer(_.ARRAY_BUFFER,e.__webglVertexBuffer),_.bufferData(_.ARRAY_BUFFER,y,t)}if(E){for(i=0;i<v;i++)s=g[i],b[a=3*i]=s.r,b[a+1]=s.g,b[a+2]=s.b;_.bindBuffer(_.ARRAY_BUFFER,e.__webglColorBuffer),_.bufferData(_.ARRAY_BUFFER,b,t)}if(w)for(l=0,u=w.length;l<u;l++){if((f=w[l]).needsUpdate&&(void 0===f.boundTo||"vertices"===f.boundTo))if(h=f.value.length,a=0,1===f.size)for(c=0;c<h;c++)f.array[c]=f.value[c];else if(2===f.size)for(c=0;c<h;c++)d=f.value[c],f.array[a]=d.x,f.array[a+1]=d.y,a+=2;else if(3===f.size)if("c"===f.type)for(c=0;c<h;c++)d=f.value[c],f.array[a]=d.r,f.array[a+1]=d.g,f.array[a+2]=d.b,a+=3;else for(c=0;c<h;c++)d=f.value[c],f.array[a]=d.x,f.array[a+1]=d.y,f.array[a+2]=d.z,a+=3;else if(4===f.size)for(c=0;c<h;c++)d=f.value[c],f.array[a]=d.x,f.array[a+1]=d.y,f.array[a+2]=d.z,f.array[a+3]=d.w,a+=4;_.bindBuffer(_.ARRAY_BUFFER,f.buffer),_.bufferData(_.ARRAY_BUFFER,f.array,t),f.needsUpdate=!1}}(t,_.DYNAMIC_DRAW),t.verticesNeedUpdate=!1,t.colorsNeedUpdate=!1,f.attributes&&He(f)}}function Ge(e){for(var t in e.attributes)if(e.attributes[t].needsUpdate)return!0;return!1}function He(e){for(var t in e.attributes)e.attributes[t].needsUpdate=!1}var We={MeshDepthMaterial:"depth",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointCloudMaterial:"particle_basic"};function je(e,t,r,n){e.addEventListener("dispose",ye);var o=We[e.type];if(o){var a=K.ShaderLib[o];e.__webglShader={uniforms:K.UniformsUtils.clone(a.uniforms),vertexShader:a.vertexShader,fragmentShader:a.fragmentShader}}else e.__webglShader={uniforms:e.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader};var s=function(e){for(var t=0,r=0,n=0,i=0,o=0,a=e.length;o<a;o++){var s=e[o];s.onlyShadow||!1===s.visible||(s instanceof K.DirectionalLight&&t++,s instanceof K.PointLight&&r++,s instanceof K.SpotLight&&n++,s instanceof K.HemisphereLight&&i++)}return{directional:t,point:r,spot:n,hemi:i}}(t),l=function(e){for(var t=0,r=0,n=e.length;r<n;r++){var i=e[r];i.castShadow&&(i instanceof K.SpotLight&&t++,i instanceof K.DirectionalLight&&!i.shadowCascade&&t++)}return t}(t),u=function(e){if(te&&e&&e.skeleton&&e.skeleton.useVertexTexture)return 1024;var t=_.getParameter(_.MAX_VERTEX_UNIFORM_VECTORS),r=Math.floor((t-20)/4);return void 0!==e&&e instanceof K.SkinnedMesh&&(r=Math.min(e.skeleton.bones.length,r))<e.skeleton.bones.length&&K.warn("WebGLRenderer: too many bones - "+e.skeleton.bones.length+", this GPU supports just "+r+" (try OpenGL instead of ANGLE)"),r}(n),c={precision:i,supportsVertexTextures:ee,map:!!e.map,envMap:!!e.envMap,envMapMode:e.envMap&&e.envMap.mapping,lightMap:!!e.lightMap,bumpMap:!!e.bumpMap,normalMap:!!e.normalMap,specularMap:!!e.specularMap,alphaMap:!!e.alphaMap,combine:e.combine,vertexColors:e.vertexColors,fog:r,useFog:e.fog,fogExp:r instanceof K.FogExp2,flatShading:e.shading===K.FlatShading,sizeAttenuation:e.sizeAttenuation,logarithmicDepthBuffer:h,skinning:e.skinning,maxBones:u,useVertexTexture:te&&n&&n.skeleton&&n.skeleton.useVertexTexture,morphTargets:e.morphTargets,morphNormals:e.morphNormals,maxMorphTargets:E.maxMorphTargets,maxMorphNormals:E.maxMorphNormals,maxDirLights:s.directional,maxPointLights:s.point,maxSpotLights:s.spot,maxHemiLights:s.hemi,maxShadows:l,shadowMapEnabled:E.shadowMapEnabled&&n.receiveShadow&&l>0,shadowMapType:E.shadowMapType,shadowMapDebug:E.shadowMapDebug,shadowMapCascade:E.shadowMapCascade,alphaTest:e.alphaTest,metal:e.metal,wrapAround:e.wrapAround,doubleSided:e.side===K.DoubleSide,flipSided:e.side===K.BackSide},d=[];if(o?d.push(o):(d.push(e.fragmentShader),d.push(e.vertexShader)),void 0!==e.defines)for(var f in e.defines)d.push(f),d.push(e.defines[f]);for(var f in c)d.push(f),d.push(c[f]);for(var p,m=d.join(),g=0,v=w.length;g<v;g++){var y=w[g];if(y.code===m){(p=y).usedTimes++;break}}void 0===p&&(p=new K.WebGLProgram(E,m,e,c),w.push(p),E.info.memory.programs=w.length),e.program=p;var b=p.attributes;if(e.morphTargets){e.numSupportedMorphTargets=0;for(var x="morphTarget",A=0;A<E.maxMorphTargets;A++)b[x+A]>=0&&e.numSupportedMorphTargets++}if(e.morphNormals){e.numSupportedMorphNormals=0;x="morphNormal";for(A=0;A<E.maxMorphNormals;A++)b[x+A]>=0&&e.numSupportedMorphNormals++}for(var S in e.uniformsList=[],e.__webglShader.uniforms){var M=e.program.uniforms[S];M&&e.uniformsList.push([e.__webglShader.uniforms[S],M])}}function qe(e){!0===e.transparent?H.setBlending(e.blending,e.blendEquation,e.blendSrc,e.blendDst,e.blendEquationAlpha,e.blendSrcAlpha,e.blendDstAlpha):H.setBlending(K.NoBlending),H.setDepthTest(e.depthTest),H.setDepthWrite(e.depthWrite),H.setColorWrite(e.colorWrite),H.setPolygonOffset(e.polygonOffset,e.polygonOffsetFactor,e.polygonOffsetUnits)}function Xe(e,r,n,i,o){P=0,i.needsUpdate&&(i.program&&we(i),je(i,r,n,o),i.needsUpdate=!1),i.morphTargets&&(o.__webglMorphTargetInfluences||(o.__webglMorphTargetInfluences=new Float32Array(E.maxMorphTargets)));var a=!1,s=!1,l=!1,u=i.program,c=u.uniforms,d=i.__webglShader.uniforms;if(u.id!==A&&(_.useProgram(u.program),A=u.id,a=!0,s=!0,l=!0),i.id!==M&&(-1===M&&(l=!0),M=i.id,s=!0),(a||e!==C)&&(_.uniformMatrix4fv(c.projectionMatrix,!1,e.projectionMatrix.elements),h&&_.uniform1f(c.logDepthBufFC,2/(Math.log(e.far+1)/Math.LN2)),e!==C&&(C=e),(i instanceof K.ShaderMaterial||i instanceof K.MeshPhongMaterial||i.envMap)&&null!==c.cameraPosition&&(V.setFromMatrixPosition(e.matrixWorld),_.uniform3f(c.cameraPosition,V.x,V.y,V.z)),(i instanceof K.MeshPhongMaterial||i instanceof K.MeshLambertMaterial||i instanceof K.MeshBasicMaterial||i instanceof K.ShaderMaterial||i.skinning)&&null!==c.viewMatrix&&_.uniformMatrix4fv(c.viewMatrix,!1,e.matrixWorldInverse.elements)),i.skinning)if(o.bindMatrix&&null!==c.bindMatrix&&_.uniformMatrix4fv(c.bindMatrix,!1,o.bindMatrix.elements),o.bindMatrixInverse&&null!==c.bindMatrixInverse&&_.uniformMatrix4fv(c.bindMatrixInverse,!1,o.bindMatrixInverse.elements),te&&o.skeleton&&o.skeleton.useVertexTexture){if(null!==c.boneTexture){var f=Ze();_.uniform1i(c.boneTexture,f),E.setTexture(o.skeleton.boneTexture,f)}null!==c.boneTextureWidth&&_.uniform1i(c.boneTextureWidth,o.skeleton.boneTextureWidth),null!==c.boneTextureHeight&&_.uniform1i(c.boneTextureHeight,o.skeleton.boneTextureHeight)}else o.skeleton&&o.skeleton.boneMatrices&&null!==c.boneGlobalMatrices&&_.uniformMatrix4fv(c.boneGlobalMatrices,!1,o.skeleton.boneMatrices);return s&&(n&&i.fog&&function(e,t){e.fogColor.value=t.color,t instanceof K.Fog?(e.fogNear.value=t.near,e.fogFar.value=t.far):t instanceof K.FogExp2&&(e.fogDensity.value=t.density)}(d,n),(i instanceof K.MeshPhongMaterial||i instanceof K.MeshLambertMaterial||i.lights)&&(B&&(l=!0,function(e){var t,r,n,i,o,a,s,l,u=0,c=0,h=0,d=z,f=d.directional.colors,p=d.directional.positions,m=d.point.colors,g=d.point.positions,v=d.point.distances,y=d.point.decays,b=d.spot.colors,x=d.spot.positions,_=d.spot.distances,E=d.spot.directions,w=d.spot.anglesCos,A=d.spot.exponents,S=d.spot.decays,M=d.hemi.skyColors,T=d.hemi.groundColors,C=d.hemi.positions,P=0,D=0,L=0,R=0,I=0,O=0,N=0,k=0,F=0,B=0,G=0,H=0;for(t=0,r=e.length;t<r;t++)if(!(n=e[t]).onlyShadow)if(i=n.color,s=n.intensity,l=n.distance,n instanceof K.AmbientLight){if(!n.visible)continue;u+=i.r,c+=i.g,h+=i.b}else if(n instanceof K.DirectionalLight){if(I+=1,!n.visible)continue;U.setFromMatrixPosition(n.matrixWorld),V.setFromMatrixPosition(n.target.matrixWorld),U.sub(V),U.normalize(),p[F=3*P]=U.x,p[F+1]=U.y,p[F+2]=U.z,Je(f,F,i,s),P+=1}else if(n instanceof K.PointLight){if(O+=1,!n.visible)continue;Je(m,B=3*D,i,s),V.setFromMatrixPosition(n.matrixWorld),g[B]=V.x,g[B+1]=V.y,g[B+2]=V.z,v[D]=l,y[D]=0===n.distance?0:n.decay,D+=1}else if(n instanceof K.SpotLight){if(N+=1,!n.visible)continue;Je(b,G=3*L,i,s),U.setFromMatrixPosition(n.matrixWorld),x[G]=U.x,x[G+1]=U.y,x[G+2]=U.z,_[L]=l,V.setFromMatrixPosition(n.target.matrixWorld),U.sub(V),U.normalize(),E[G]=U.x,E[G+1]=U.y,E[G+2]=U.z,w[L]=Math.cos(n.angle),A[L]=n.exponent,S[L]=0===n.distance?0:n.decay,L+=1}else if(n instanceof K.HemisphereLight){if(k+=1,!n.visible)continue;U.setFromMatrixPosition(n.matrixWorld),U.normalize(),C[H=3*R]=U.x,C[H+1]=U.y,C[H+2]=U.z,o=n.color,a=n.groundColor,Je(M,H,o,s),Je(T,H,a,s),R+=1}for(t=3*P,r=Math.max(f.length,3*I);t<r;t++)f[t]=0;for(t=3*D,r=Math.max(m.length,3*O);t<r;t++)m[t]=0;for(t=3*L,r=Math.max(b.length,3*N);t<r;t++)b[t]=0;for(t=3*R,r=Math.max(M.length,3*k);t<r;t++)M[t]=0;for(t=3*R,r=Math.max(T.length,3*k);t<r;t++)T[t]=0;d.directional.length=P,d.point.length=D,d.spot.length=L,d.hemi.length=R,d.ambient[0]=u,d.ambient[1]=c,d.ambient[2]=h}(r),B=!1),l?(!function(e,t){e.ambientLightColor.value=t.ambient,e.directionalLightColor.value=t.directional.colors,e.directionalLightDirection.value=t.directional.positions,e.pointLightColor.value=t.point.colors,e.pointLightPosition.value=t.point.positions,e.pointLightDistance.value=t.point.distances,e.pointLightDecay.value=t.point.decays,e.spotLightColor.value=t.spot.colors,e.spotLightPosition.value=t.spot.positions,e.spotLightDistance.value=t.spot.distances,e.spotLightDirection.value=t.spot.directions,e.spotLightAngleCos.value=t.spot.anglesCos,e.spotLightExponent.value=t.spot.exponents,e.spotLightDecay.value=t.spot.decays,e.hemisphereLightSkyColor.value=t.hemi.skyColors,e.hemisphereLightGroundColor.value=t.hemi.groundColors,e.hemisphereLightDirection.value=t.hemi.positions}(d,z),Ke(d,!0)):Ke(d,!1)),(i instanceof K.MeshBasicMaterial||i instanceof K.MeshLambertMaterial||i instanceof K.MeshPhongMaterial)&&function(e,t){e.opacity.value=t.opacity,e.diffuse.value=t.color,e.map.value=t.map,e.lightMap.value=t.lightMap,e.specularMap.value=t.specularMap,e.alphaMap.value=t.alphaMap,t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale);t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale));var r;t.map?r=t.map:t.specularMap?r=t.specularMap:t.normalMap?r=t.normalMap:t.bumpMap?r=t.bumpMap:t.alphaMap&&(r=t.alphaMap);if(void 0!==r){var n=r.offset,i=r.repeat;e.offsetRepeat.value.set(n.x,n.y,i.x,i.y)}e.envMap.value=t.envMap,e.flipEnvMap.value=t.envMap instanceof K.WebGLRenderTargetCube?1:-1,e.reflectivity.value=t.reflectivity,e.refractionRatio.value=t.refractionRatio}(d,i),i instanceof K.LineBasicMaterial?Ye(d,i):i instanceof K.LineDashedMaterial?(Ye(d,i),function(e,t){e.dashSize.value=t.dashSize,e.totalSize.value=t.dashSize+t.gapSize,e.scale.value=t.scale}(d,i)):i instanceof K.PointCloudMaterial?function(e,r){if(e.psColor.value=r.color,e.opacity.value=r.opacity,e.size.value=r.size,e.scale.value=t.height/2,e.map.value=r.map,null!==r.map){var n=r.map.offset,i=r.map.repeat;e.offsetRepeat.value.set(n.x,n.y,i.x,i.y)}}(d,i):i instanceof K.MeshPhongMaterial?function(e,t){e.shininess.value=t.shininess,e.emissive.value=t.emissive,e.specular.value=t.specular,t.wrapAround&&e.wrapRGB.value.copy(t.wrapRGB)}(d,i):i instanceof K.MeshLambertMaterial?function(e,t){e.emissive.value=t.emissive,t.wrapAround&&e.wrapRGB.value.copy(t.wrapRGB)}(d,i):i instanceof K.MeshDepthMaterial?(d.mNear.value=e.near,d.mFar.value=e.far,d.opacity.value=i.opacity):i instanceof K.MeshNormalMaterial&&(d.opacity.value=i.opacity),o.receiveShadow&&!i._shadowPass&&function(e,t){if(e.shadowMatrix)for(var r=0,n=0,i=t.length;n<i;n++){var o=t[n];o.castShadow&&((o instanceof K.SpotLight||o instanceof K.DirectionalLight&&!o.shadowCascade)&&(e.shadowMap.value[r]=o.shadowMap,e.shadowMapSize.value[r]=o.shadowMapSize,e.shadowMatrix.value[r]=o.shadowMatrix,e.shadowDarkness.value[r]=o.shadowDarkness,e.shadowBias.value[r]=o.shadowBias,r++))}}(d,r),function(e){for(var t,r,n,i=0,o=e.length;i<o;i++){var a=e[i][0];if(!1!==a.needsUpdate){var s=a.type,l=a.value,u=e[i][1];switch(s){case"1i":case"i":_.uniform1i(u,l);break;case"1f":case"f":_.uniform1f(u,l);break;case"2f":_.uniform2f(u,l[0],l[1]);break;case"3f":_.uniform3f(u,l[0],l[1],l[2]);break;case"4f":_.uniform4f(u,l[0],l[1],l[2],l[3]);break;case"1iv":case"iv1":_.uniform1iv(u,l);break;case"3iv":case"iv":_.uniform3iv(u,l);break;case"1fv":case"fv1":_.uniform1fv(u,l);break;case"2fv":_.uniform2fv(u,l);break;case"3fv":case"fv":_.uniform3fv(u,l);break;case"4fv":_.uniform4fv(u,l);break;case"Matrix3fv":_.uniformMatrix3fv(u,!1,l);break;case"Matrix4fv":_.uniformMatrix4fv(u,!1,l);break;case"v2":_.uniform2f(u,l.x,l.y);break;case"v3":_.uniform3f(u,l.x,l.y,l.z);break;case"v4":_.uniform4f(u,l.x,l.y,l.z,l.w);break;case"c":_.uniform3f(u,l.r,l.g,l.b);break;case"v2v":void 0===a._array&&(a._array=new Float32Array(2*l.length));for(var c=0,h=l.length;c<h;c++)n=2*c,a._array[n]=l[c].x,a._array[n+1]=l[c].y;_.uniform2fv(u,a._array);break;case"v3v":void 0===a._array&&(a._array=new Float32Array(3*l.length));for(c=0,h=l.length;c<h;c++)n=3*c,a._array[n]=l[c].x,a._array[n+1]=l[c].y,a._array[n+2]=l[c].z;_.uniform3fv(u,a._array);break;case"v4v":void 0===a._array&&(a._array=new Float32Array(4*l.length));for(c=0,h=l.length;c<h;c++)n=4*c,a._array[n]=l[c].x,a._array[n+1]=l[c].y,a._array[n+2]=l[c].z,a._array[n+3]=l[c].w;_.uniform4fv(u,a._array);break;case"m3":_.uniformMatrix3fv(u,!1,l.elements);break;case"m3v":void 0===a._array&&(a._array=new Float32Array(9*l.length));for(c=0,h=l.length;c<h;c++)l[c].flattenToArrayOffset(a._array,9*c);_.uniformMatrix3fv(u,!1,a._array);break;case"m4":_.uniformMatrix4fv(u,!1,l.elements);break;case"m4v":void 0===a._array&&(a._array=new Float32Array(16*l.length));for(c=0,h=l.length;c<h;c++)l[c].flattenToArrayOffset(a._array,16*c);_.uniformMatrix4fv(u,!1,a._array);break;case"t":if(t=l,r=Ze(),_.uniform1i(u,r),!t)continue;t instanceof K.CubeTexture||t.image instanceof Array&&6===t.image.length?tt(t,r):t instanceof K.WebGLRenderTargetCube?rt(t,r):E.setTexture(t,r);break;case"tv":void 0===a._array&&(a._array=[]);for(c=0,h=a.value.length;c<h;c++)a._array[c]=Ze();_.uniform1iv(u,a._array);for(c=0,h=a.value.length;c<h;c++)t=a.value[c],r=a._array[c],t&&E.setTexture(t,r);break;default:K.warn("THREE.WebGLRenderer: Unknown uniform type: "+s)}}}}(i.uniformsList)),function(e,t){_.uniformMatrix4fv(e.modelViewMatrix,!1,t._modelViewMatrix.elements),e.normalMatrix&&_.uniformMatrix3fv(e.normalMatrix,!1,t._normalMatrix.elements)}(c,o),null!==c.modelMatrix&&_.uniformMatrix4fv(c.modelMatrix,!1,o.matrixWorld.elements),u}function Ye(e,t){e.diffuse.value=t.color,e.opacity.value=t.opacity}function Ke(e,t){e.ambientLightColor.needsUpdate=t,e.directionalLightColor.needsUpdate=t,e.directionalLightDirection.needsUpdate=t,e.pointLightColor.needsUpdate=t,e.pointLightPosition.needsUpdate=t,e.pointLightDistance.needsUpdate=t,e.pointLightDecay.needsUpdate=t,e.spotLightColor.needsUpdate=t,e.spotLightPosition.needsUpdate=t,e.spotLightDistance.needsUpdate=t,e.spotLightDirection.needsUpdate=t,e.spotLightAngleCos.needsUpdate=t,e.spotLightExponent.needsUpdate=t,e.spotLightDecay.needsUpdate=t,e.hemisphereLightSkyColor.needsUpdate=t,e.hemisphereLightGroundColor.needsUpdate=t,e.hemisphereLightDirection.needsUpdate=t}function Ze(){var e=P;return e>=Z&&K.warn("WebGLRenderer: trying to use "+e+" texture units while this GPU supports only "+Z),P+=1,e}function Qe(e,t){e._modelViewMatrix.multiplyMatrices(t.matrixWorldInverse,e.matrixWorld),e._normalMatrix.getNormalMatrix(e._modelViewMatrix)}function Je(e,t,r,n){e[t]=r.r*n,e[t+1]=r.g*n,e[t+2]=r.b*n}function $e(e,t,r){var n;r?(_.texParameteri(e,_.TEXTURE_WRAP_S,at(t.wrapS)),_.texParameteri(e,_.TEXTURE_WRAP_T,at(t.wrapT)),_.texParameteri(e,_.TEXTURE_MAG_FILTER,at(t.magFilter)),_.texParameteri(e,_.TEXTURE_MIN_FILTER,at(t.minFilter))):(_.texParameteri(e,_.TEXTURE_WRAP_S,_.CLAMP_TO_EDGE),_.texParameteri(e,_.TEXTURE_WRAP_T,_.CLAMP_TO_EDGE),t.wrapS===K.ClampToEdgeWrapping&&t.wrapT===K.ClampToEdgeWrapping||K.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping. ( "+t.sourceFile+" )"),_.texParameteri(e,_.TEXTURE_MAG_FILTER,ot(t.magFilter)),_.texParameteri(e,_.TEXTURE_MIN_FILTER,ot(t.minFilter)),t.minFilter!==K.NearestFilter&&t.minFilter!==K.LinearFilter&&K.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter. ( "+t.sourceFile+" )")),(n=W.get("EXT_texture_filter_anisotropic"))&&t.type!==K.FloatType&&t.type!==K.HalfFloatType&&(t.anisotropy>1||t.__currentAnisotropy)&&(_.texParameterf(e,n.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(t.anisotropy,E.getMaxAnisotropy())),t.__currentAnisotropy=t.anisotropy)}function et(e,t){if(e.width>t||e.height>t){var r=t/Math.max(e.width,e.height),n=document.createElement("canvas");return n.width=Math.floor(e.width*r),n.height=Math.floor(e.height*r),n.getContext("2d").drawImage(e,0,0,e.width,e.height,0,0,n.width,n.height),K.warn("THREE.WebGLRenderer: image is too big ("+e.width+"x"+e.height+"). Resized to "+n.width+"x"+n.height,e),n}return e}function tt(e,t){if(6===e.image.length)if(e.needsUpdate){e.image.__webglTextureCube||(e.addEventListener("dispose",ge),e.image.__webglTextureCube=_.createTexture(),E.info.memory.textures++),_.activeTexture(_.TEXTURE0+t),_.bindTexture(_.TEXTURE_CUBE_MAP,e.image.__webglTextureCube),_.pixelStorei(_.UNPACK_FLIP_Y_WEBGL,e.flipY);for(var r=e instanceof K.CompressedTexture,n=e.image[0]instanceof K.DataTexture,i=[],o=0;o<6;o++)!E.autoScaleCubemaps||r||n?i[o]=n?e.image[o].image:e.image[o]:i[o]=et(e.image[o],$);var a=i[0],s=K.Math.isPowerOfTwo(a.width)&&K.Math.isPowerOfTwo(a.height),l=at(e.format),u=at(e.type);$e(_.TEXTURE_CUBE_MAP,e,s);for(o=0;o<6;o++)if(r)for(var c,h=i[o].mipmaps,d=0,f=h.length;d<f;d++)c=h[d],e.format!==K.RGBAFormat&&e.format!==K.RGBFormat?ae().indexOf(l)>-1?_.compressedTexImage2D(_.TEXTURE_CUBE_MAP_POSITIVE_X+o,d,l,c.width,c.height,0,c.data):K.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setCubeTexture()"):_.texImage2D(_.TEXTURE_CUBE_MAP_POSITIVE_X+o,d,l,c.width,c.height,0,l,u,c.data);else n?_.texImage2D(_.TEXTURE_CUBE_MAP_POSITIVE_X+o,0,l,i[o].width,i[o].height,0,l,u,i[o].data):_.texImage2D(_.TEXTURE_CUBE_MAP_POSITIVE_X+o,0,l,l,u,i[o]);e.generateMipmaps&&s&&_.generateMipmap(_.TEXTURE_CUBE_MAP),e.needsUpdate=!1,e.onUpdate&&e.onUpdate()}else _.activeTexture(_.TEXTURE0+t),_.bindTexture(_.TEXTURE_CUBE_MAP,e.image.__webglTextureCube)}function rt(e,t){_.activeTexture(_.TEXTURE0+t),_.bindTexture(_.TEXTURE_CUBE_MAP,e.__webglTexture)}function nt(e,t,r){_.bindFramebuffer(_.FRAMEBUFFER,e),_.framebufferTexture2D(_.FRAMEBUFFER,_.COLOR_ATTACHMENT0,r,t.__webglTexture,0)}function it(e,t){_.bindRenderbuffer(_.RENDERBUFFER,e),t.depthBuffer&&!t.stencilBuffer?(_.renderbufferStorage(_.RENDERBUFFER,_.DEPTH_COMPONENT16,t.width,t.height),_.framebufferRenderbuffer(_.FRAMEBUFFER,_.DEPTH_ATTACHMENT,_.RENDERBUFFER,e)):t.depthBuffer&&t.stencilBuffer?(_.renderbufferStorage(_.RENDERBUFFER,_.DEPTH_STENCIL,t.width,t.height),_.framebufferRenderbuffer(_.FRAMEBUFFER,_.DEPTH_STENCIL_ATTACHMENT,_.RENDERBUFFER,e)):_.renderbufferStorage(_.RENDERBUFFER,_.RGBA4,t.width,t.height)}function ot(e){return e===K.NearestFilter||e===K.NearestMipMapNearestFilter||e===K.NearestMipMapLinearFilter?_.NEAREST:_.LINEAR}function at(e){var t;if(e===K.RepeatWrapping)return _.REPEAT;if(e===K.ClampToEdgeWrapping)return _.CLAMP_TO_EDGE;if(e===K.MirroredRepeatWrapping)return _.MIRRORED_REPEAT;if(e===K.NearestFilter)return _.NEAREST;if(e===K.NearestMipMapNearestFilter)return _.NEAREST_MIPMAP_NEAREST;if(e===K.NearestMipMapLinearFilter)return _.NEAREST_MIPMAP_LINEAR;if(e===K.LinearFilter)return _.LINEAR;if(e===K.LinearMipMapNearestFilter)return _.LINEAR_MIPMAP_NEAREST;if(e===K.LinearMipMapLinearFilter)return _.LINEAR_MIPMAP_LINEAR;if(e===K.UnsignedByteType)return _.UNSIGNED_BYTE;if(e===K.UnsignedShort4444Type)return _.UNSIGNED_SHORT_4_4_4_4;if(e===K.UnsignedShort5551Type)return _.UNSIGNED_SHORT_5_5_5_1;if(e===K.UnsignedShort565Type)return _.UNSIGNED_SHORT_5_6_5;if(e===K.ByteType)return _.BYTE;if(e===K.ShortType)return _.SHORT;if(e===K.UnsignedShortType)return _.UNSIGNED_SHORT;if(e===K.IntType)return _.INT;if(e===K.UnsignedIntType)return _.UNSIGNED_INT;if(e===K.FloatType)return _.FLOAT;if(null!==(t=W.get("OES_texture_half_float"))&&e===K.HalfFloatType)return t.HALF_FLOAT_OES;if(e===K.AlphaFormat)return _.ALPHA;if(e===K.RGBFormat)return _.RGB;if(e===K.RGBAFormat)return _.RGBA;if(e===K.LuminanceFormat)return _.LUMINANCE;if(e===K.LuminanceAlphaFormat)return _.LUMINANCE_ALPHA;if(e===K.AddEquation)return _.FUNC_ADD;if(e===K.SubtractEquation)return _.FUNC_SUBTRACT;if(e===K.ReverseSubtractEquation)return _.FUNC_REVERSE_SUBTRACT;if(e===K.ZeroFactor)return _.ZERO;if(e===K.OneFactor)return _.ONE;if(e===K.SrcColorFactor)return _.SRC_COLOR;if(e===K.OneMinusSrcColorFactor)return _.ONE_MINUS_SRC_COLOR;if(e===K.SrcAlphaFactor)return _.SRC_ALPHA;if(e===K.OneMinusSrcAlphaFactor)return _.ONE_MINUS_SRC_ALPHA;if(e===K.DstAlphaFactor)return _.DST_ALPHA;if(e===K.OneMinusDstAlphaFactor)return _.ONE_MINUS_DST_ALPHA;if(e===K.DstColorFactor)return _.DST_COLOR;if(e===K.OneMinusDstColorFactor)return _.ONE_MINUS_DST_COLOR;if(e===K.SrcAlphaSaturateFactor)return _.SRC_ALPHA_SATURATE;if(null!==(t=W.get("WEBGL_compressed_texture_s3tc"))){if(e===K.RGB_S3TC_DXT1_Format)return t.COMPRESSED_RGB_S3TC_DXT1_EXT;if(e===K.RGBA_S3TC_DXT1_Format)return t.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(e===K.RGBA_S3TC_DXT3_Format)return t.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(e===K.RGBA_S3TC_DXT5_Format)return t.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(null!==(t=W.get("WEBGL_compressed_texture_pvrtc"))){if(e===K.RGB_PVRTC_4BPPV1_Format)return t.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(e===K.RGB_PVRTC_2BPPV1_Format)return t.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(e===K.RGBA_PVRTC_4BPPV1_Format)return t.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(e===K.RGBA_PVRTC_2BPPV1_Format)return t.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(null!==(t=W.get("EXT_blend_minmax"))){if(e===K.MinEquation)return t.MIN_EXT;if(e===K.MaxEquation)return t.MAX_EXT}return 0}this.setFaceCulling=function(e,t){e===K.CullFaceNone?_.disable(_.CULL_FACE):(t===K.FrontFaceDirectionCW?_.frontFace(_.CW):_.frontFace(_.CCW),e===K.CullFaceBack?_.cullFace(_.BACK):e===K.CullFaceFront?_.cullFace(_.FRONT):_.cullFace(_.FRONT_AND_BACK),_.enable(_.CULL_FACE))},this.setMaterialFaces=function(e){H.setDoubleSided(e.side===K.DoubleSide),H.setFlipSided(e.side===K.BackSide)},this.uploadTexture=function(e){void 0===e.__webglInit&&(e.__webglInit=!0,e.addEventListener("dispose",ge),e.__webglTexture=_.createTexture(),E.info.memory.textures++),_.bindTexture(_.TEXTURE_2D,e.__webglTexture),_.pixelStorei(_.UNPACK_FLIP_Y_WEBGL,e.flipY),_.pixelStorei(_.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.premultiplyAlpha),_.pixelStorei(_.UNPACK_ALIGNMENT,e.unpackAlignment),e.image=et(e.image,J);var t=e.image,r=K.Math.isPowerOfTwo(t.width)&&K.Math.isPowerOfTwo(t.height),n=at(e.format),i=at(e.type);$e(_.TEXTURE_2D,e,r);var o,a=e.mipmaps;if(e instanceof K.DataTexture)if(a.length>0&&r){for(var s=0,l=a.length;s<l;s++)o=a[s],_.texImage2D(_.TEXTURE_2D,s,n,o.width,o.height,0,n,i,o.data);e.generateMipmaps=!1}else _.texImage2D(_.TEXTURE_2D,0,n,t.width,t.height,0,n,i,t.data);else if(e instanceof K.CompressedTexture)for(s=0,l=a.length;s<l;s++)o=a[s],e.format!==K.RGBAFormat&&e.format!==K.RGBFormat?ae().indexOf(n)>-1?_.compressedTexImage2D(_.TEXTURE_2D,s,n,o.width,o.height,0,o.data):K.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):_.texImage2D(_.TEXTURE_2D,s,n,o.width,o.height,0,n,i,o.data);else if(a.length>0&&r){for(s=0,l=a.length;s<l;s++)o=a[s],_.texImage2D(_.TEXTURE_2D,s,n,n,i,o);e.generateMipmaps=!1}else _.texImage2D(_.TEXTURE_2D,0,n,n,i,e.image);e.generateMipmaps&&r&&_.generateMipmap(_.TEXTURE_2D),e.needsUpdate=!1,e.onUpdate&&e.onUpdate()},this.setTexture=function(e,t){_.activeTexture(_.TEXTURE0+t),e.needsUpdate?E.uploadTexture(e):_.bindTexture(_.TEXTURE_2D,e.__webglTexture)},this.setRenderTarget=function(e){var t,r,n,i,o,a=e instanceof K.WebGLRenderTargetCube;if(e&&void 0===e.__webglFramebuffer){void 0===e.depthBuffer&&(e.depthBuffer=!0),void 0===e.stencilBuffer&&(e.stencilBuffer=!0),e.addEventListener("dispose",ve),e.__webglTexture=_.createTexture(),E.info.memory.textures++;var s=K.Math.isPowerOfTwo(e.width)&&K.Math.isPowerOfTwo(e.height),l=at(e.format),u=at(e.type);if(a){e.__webglFramebuffer=[],e.__webglRenderbuffer=[],_.bindTexture(_.TEXTURE_CUBE_MAP,e.__webglTexture),$e(_.TEXTURE_CUBE_MAP,e,s);for(var c=0;c<6;c++)e.__webglFramebuffer[c]=_.createFramebuffer(),e.__webglRenderbuffer[c]=_.createRenderbuffer(),_.texImage2D(_.TEXTURE_CUBE_MAP_POSITIVE_X+c,0,l,e.width,e.height,0,l,u,null),nt(e.__webglFramebuffer[c],e,_.TEXTURE_CUBE_MAP_POSITIVE_X+c),it(e.__webglRenderbuffer[c],e);s&&_.generateMipmap(_.TEXTURE_CUBE_MAP)}else e.__webglFramebuffer=_.createFramebuffer(),e.shareDepthFrom?e.__webglRenderbuffer=e.shareDepthFrom.__webglRenderbuffer:e.__webglRenderbuffer=_.createRenderbuffer(),_.bindTexture(_.TEXTURE_2D,e.__webglTexture),$e(_.TEXTURE_2D,e,s),_.texImage2D(_.TEXTURE_2D,0,l,e.width,e.height,0,l,u,null),nt(e.__webglFramebuffer,e,_.TEXTURE_2D),e.shareDepthFrom?e.depthBuffer&&!e.stencilBuffer?_.framebufferRenderbuffer(_.FRAMEBUFFER,_.DEPTH_ATTACHMENT,_.RENDERBUFFER,e.__webglRenderbuffer):e.depthBuffer&&e.stencilBuffer&&_.framebufferRenderbuffer(_.FRAMEBUFFER,_.DEPTH_STENCIL_ATTACHMENT,_.RENDERBUFFER,e.__webglRenderbuffer):it(e.__webglRenderbuffer,e),s&&_.generateMipmap(_.TEXTURE_2D);a?_.bindTexture(_.TEXTURE_CUBE_MAP,null):_.bindTexture(_.TEXTURE_2D,null),_.bindRenderbuffer(_.RENDERBUFFER,null),_.bindFramebuffer(_.FRAMEBUFFER,null)}e?(t=a?e.__webglFramebuffer[e.activeCubeFace]:e.__webglFramebuffer,r=e.width,n=e.height,i=0,o=0):(t=null,r=R,n=I,i=D,o=L),t!==S&&(_.bindFramebuffer(_.FRAMEBUFFER,t),_.viewport(i,o,r,n),S=t),O=r,N=n},this.readRenderTargetPixels=function(e,t,r,n,i,o){if(e instanceof K.WebGLRenderTarget){if(e.__webglFramebuffer){if(e.format!==K.RGBAFormat)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA format. readPixels can read only RGBA format.");var a=!1;e.__webglFramebuffer!==S&&(_.bindFramebuffer(_.FRAMEBUFFER,e.__webglFramebuffer),a=!0),_.checkFramebufferStatus(_.FRAMEBUFFER)===_.FRAMEBUFFER_COMPLETE?_.readPixels(t,r,n,i,_.RGBA,_.UNSIGNED_BYTE,o):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete."),a&&_.bindFramebuffer(_.FRAMEBUFFER,S)}}else console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.")},this.initMaterial=function(){K.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},this.addPrePlugin=function(){K.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},this.addPostPlugin=function(){K.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},this.updateShadowMap=function(){K.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")}},K.WebGLRenderTarget=function(e,t,r){this.width=e,this.height=t,r=r||{},this.wrapS=void 0!==r.wrapS?r.wrapS:K.ClampToEdgeWrapping,this.wrapT=void 0!==r.wrapT?r.wrapT:K.ClampToEdgeWrapping,this.magFilter=void 0!==r.magFilter?r.magFilter:K.LinearFilter,this.minFilter=void 0!==r.minFilter?r.minFilter:K.LinearMipMapLinearFilter,this.anisotropy=void 0!==r.anisotropy?r.anisotropy:1,this.offset=new K.Vector2(0,0),this.repeat=new K.Vector2(1,1),this.format=void 0!==r.format?r.format:K.RGBAFormat,this.type=void 0!==r.type?r.type:K.UnsignedByteType,this.depthBuffer=void 0===r.depthBuffer||r.depthBuffer,this.stencilBuffer=void 0===r.stencilBuffer||r.stencilBuffer,this.generateMipmaps=!0,this.shareDepthFrom=void 0!==r.shareDepthFrom?r.shareDepthFrom:null},K.WebGLRenderTarget.prototype={constructor:K.WebGLRenderTarget,setSize:function(e,t){this.width=e,this.height=t},clone:function(){var e=new K.WebGLRenderTarget(this.width,this.height);return e.wrapS=this.wrapS,e.wrapT=this.wrapT,e.magFilter=this.magFilter,e.minFilter=this.minFilter,e.anisotropy=this.anisotropy,e.offset.copy(this.offset),e.repeat.copy(this.repeat),e.format=this.format,e.type=this.type,e.depthBuffer=this.depthBuffer,e.stencilBuffer=this.stencilBuffer,e.generateMipmaps=this.generateMipmaps,e.shareDepthFrom=this.shareDepthFrom,e},dispose:function(){this.dispatchEvent({type:"dispose"})}},K.EventDispatcher.prototype.apply(K.WebGLRenderTarget.prototype),K.WebGLRenderTargetCube=function(e,t,r){K.WebGLRenderTarget.call(this,e,t,r),this.activeCubeFace=0},K.WebGLRenderTargetCube.prototype=Object.create(K.WebGLRenderTarget.prototype),K.WebGLRenderTargetCube.prototype.constructor=K.WebGLRenderTargetCube,K.WebGLExtensions=function(e){var t={};this.get=function(r){if(void 0!==t[r])return t[r];var n;switch(r){case"EXT_texture_filter_anisotropic":n=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":n=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":n=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:n=e.getExtension(r)}return null===n&&K.warn("THREE.WebGLRenderer: "+r+" extension not supported."),t[r]=n,n}},K.WebGLProgram=(k=0,function(e,t,r,n){var i=e,o=i.context,a=r.defines,s=r.__webglShader.uniforms,l=r.attributes,u=r.__webglShader.vertexShader,c=r.__webglShader.fragmentShader,h=r.index0AttributeName;void 0===h&&!0===n.morphTargets&&(h="position");var d="SHADOWMAP_TYPE_BASIC";n.shadowMapType===K.PCFShadowMap?d="SHADOWMAP_TYPE_PCF":n.shadowMapType===K.PCFSoftShadowMap&&(d="SHADOWMAP_TYPE_PCF_SOFT");var f="ENVMAP_TYPE_CUBE",p="ENVMAP_MODE_REFLECTION",m="ENVMAP_BLENDING_MULTIPLY";if(n.envMap){switch(r.envMap.mapping){case K.CubeReflectionMapping:case K.CubeRefractionMapping:f="ENVMAP_TYPE_CUBE";break;case K.EquirectangularReflectionMapping:case K.EquirectangularRefractionMapping:f="ENVMAP_TYPE_EQUIREC";break;case K.SphericalReflectionMapping:f="ENVMAP_TYPE_SPHERE"}switch(r.envMap.mapping){case K.CubeRefractionMapping:case K.EquirectangularRefractionMapping:p="ENVMAP_MODE_REFRACTION"}switch(r.combine){case K.MultiplyOperation:m="ENVMAP_BLENDING_MULTIPLY";break;case K.MixOperation:m="ENVMAP_BLENDING_MIX";break;case K.AddOperation:m="ENVMAP_BLENDING_ADD"}}var g,v,y=e.gammaFactor>0?e.gammaFactor:1,b=function(e){var t,r,n=[];for(var i in e)!1!==(t=e[i])&&(r="#define "+i+" "+t,n.push(r));return n.join("\n")}(a),x=o.createProgram();r instanceof K.RawShaderMaterial?(g="",v=""):(g=["precision "+n.precision+" float;","precision "+n.precision+" int;",b,n.supportsVertexTextures?"#define VERTEX_TEXTURES":"",i.gammaInput?"#define GAMMA_INPUT":"",i.gammaOutput?"#define GAMMA_OUTPUT":"","#define GAMMA_FACTOR "+y,"#define MAX_DIR_LIGHTS "+n.maxDirLights,"#define MAX_POINT_LIGHTS "+n.maxPointLights,"#define MAX_SPOT_LIGHTS "+n.maxSpotLights,"#define MAX_HEMI_LIGHTS "+n.maxHemiLights,"#define MAX_SHADOWS "+n.maxShadows,"#define MAX_BONES "+n.maxBones,n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+p:"",n.lightMap?"#define USE_LIGHTMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.vertexColors?"#define USE_COLOR":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.useVertexTexture?"#define BONE_TEXTURE":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals?"#define USE_MORPHNORMALS":"",n.wrapAround?"#define WRAP_AROUND":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+d:"",n.shadowMapDebug?"#define SHADOWMAP_DEBUG":"",n.shadowMapCascade?"#define SHADOWMAP_CASCADE":"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","attribute vec2 uv2;","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif",""].join("\n"),v=["precision "+n.precision+" float;","precision "+n.precision+" int;",n.bumpMap||n.normalMap||n.flatShading?"#extension GL_OES_standard_derivatives : enable":"",b,"#define MAX_DIR_LIGHTS "+n.maxDirLights,"#define MAX_POINT_LIGHTS "+n.maxPointLights,"#define MAX_SPOT_LIGHTS "+n.maxSpotLights,"#define MAX_HEMI_LIGHTS "+n.maxHemiLights,"#define MAX_SHADOWS "+n.maxShadows,n.alphaTest?"#define ALPHATEST "+n.alphaTest:"",i.gammaInput?"#define GAMMA_INPUT":"",i.gammaOutput?"#define GAMMA_OUTPUT":"","#define GAMMA_FACTOR "+y,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+f:"",n.envMap?"#define "+p:"",n.envMap?"#define "+m:"",n.lightMap?"#define USE_LIGHTMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.vertexColors?"#define USE_COLOR":"",n.flatShading?"#define FLAT_SHADED":"",n.metal?"#define METAL":"",n.wrapAround?"#define WRAP_AROUND":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+d:"",n.shadowMapDebug?"#define SHADOWMAP_DEBUG":"",n.shadowMapCascade?"#define SHADOWMAP_CASCADE":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;",""].join("\n"));var _=new K.WebGLShader(o,o.VERTEX_SHADER,g+u),E=new K.WebGLShader(o,o.FRAGMENT_SHADER,v+c);o.attachShader(x,_),o.attachShader(x,E),void 0!==h&&o.bindAttribLocation(x,0,h),o.linkProgram(x);var w=o.getProgramInfoLog(x);!1===o.getProgramParameter(x,o.LINK_STATUS)&&K.error("THREE.WebGLProgram: shader error: "+o.getError(),"gl.VALIDATE_STATUS",o.getProgramParameter(x,o.VALIDATE_STATUS),"gl.getPRogramInfoLog",w),""!==w&&K.warn("THREE.WebGLProgram: gl.getProgramInfoLog()"+w),o.deleteShader(_),o.deleteShader(E);var A=["viewMatrix","modelViewMatrix","projectionMatrix","normalMatrix","modelMatrix","cameraPosition","morphTargetInfluences","bindMatrix","bindMatrixInverse"];for(var S in n.useVertexTexture?(A.push("boneTexture"),A.push("boneTextureWidth"),A.push("boneTextureHeight")):A.push("boneGlobalMatrices"),n.logarithmicDepthBuffer&&A.push("logDepthBufFC"),s)A.push(S);this.uniforms=function(e,t,r){for(var n={},i=0,o=r.length;i<o;i++){var a=r[i];n[a]=e.getUniformLocation(t,a)}return n}(o,x,A),A=["position","normal","uv","uv2","tangent","color","skinIndex","skinWeight","lineDistance"];for(var M=0;M<n.maxMorphTargets;M++)A.push("morphTarget"+M);for(M=0;M<n.maxMorphNormals;M++)A.push("morphNormal"+M);for(var T in l)A.push(T);return this.attributes=function(e,t,r){for(var n={},i=0,o=r.length;i<o;i++){var a=r[i];n[a]=e.getAttribLocation(t,a)}return n}(o,x,A),this.attributesKeys=Object.keys(this.attributes),this.id=k++,this.code=t,this.usedTimes=1,this.program=x,this.vertexShader=_,this.fragmentShader=E,this}),K.WebGLShader=function(e,t,r){var n=e.createShader(t);return e.shaderSource(n,r),e.compileShader(n),!1===e.getShaderParameter(n,e.COMPILE_STATUS)&&K.error("THREE.WebGLShader: Shader couldn't compile."),""!==e.getShaderInfoLog(n)&&K.warn("THREE.WebGLShader: gl.getShaderInfoLog()",e.getShaderInfoLog(n),function(e){for(var t=e.split("\n"),r=0;r<t.length;r++)t[r]=r+1+": "+t[r];return t.join("\n")}(r)),n},K.WebGLState=function(e,t){var r=new Uint8Array(16),n=new Uint8Array(16),i=null,o=null,a=null,s=null,l=null,u=null,c=null,h=null,d=null,f=null,p=null,m=null,g=null,v=null,y=null,b=null;this.initAttributes=function(){for(var e=0,t=r.length;e<t;e++)r[e]=0},this.enableAttribute=function(t){r[t]=1,0===n[t]&&(e.enableVertexAttribArray(t),n[t]=1)},this.disableUnusedAttributes=function(){for(var t=0,i=n.length;t<i;t++)n[t]!==r[t]&&(e.disableVertexAttribArray(t),n[t]=0)},this.setBlending=function(r,n,h,d,f,p,m){r!==i&&(r===K.NoBlending?e.disable(e.BLEND):r===K.AdditiveBlending?(e.enable(e.BLEND),e.blendEquation(e.FUNC_ADD),e.blendFunc(e.SRC_ALPHA,e.ONE)):r===K.SubtractiveBlending?(e.enable(e.BLEND),e.blendEquation(e.FUNC_ADD),e.blendFunc(e.ZERO,e.ONE_MINUS_SRC_COLOR)):r===K.MultiplyBlending?(e.enable(e.BLEND),e.blendEquation(e.FUNC_ADD),e.blendFunc(e.ZERO,e.SRC_COLOR)):r===K.CustomBlending?e.enable(e.BLEND):(e.enable(e.BLEND),e.blendEquationSeparate(e.FUNC_ADD,e.FUNC_ADD),e.blendFuncSeparate(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA)),i=r),r===K.CustomBlending?(f=f||n,p=p||h,m=m||d,n===o&&f===l||(e.blendEquationSeparate(t(n),t(f)),o=n,l=f),h===a&&d===s&&p===u&&m===c||(e.blendFuncSeparate(t(h),t(d),t(p),t(m)),a=h,s=d,u=p,c=m)):(o=null,a=null,s=null,l=null,u=null,c=null)},this.setDepthTest=function(t){h!==t&&(t?e.enable(e.DEPTH_TEST):e.disable(e.DEPTH_TEST),h=t)},this.setDepthWrite=function(t){d!==t&&(e.depthMask(t),d=t)},this.setColorWrite=function(t){f!==t&&(e.colorMask(t,t,t,t),f=t)},this.setDoubleSided=function(t){p!==t&&(t?e.disable(e.CULL_FACE):e.enable(e.CULL_FACE),p=t)},this.setFlipSided=function(t){m!==t&&(t?e.frontFace(e.CW):e.frontFace(e.CCW),m=t)},this.setLineWidth=function(t){t!==g&&(e.lineWidth(t),g=t)},this.setPolygonOffset=function(t,r,n){v!==t&&(t?e.enable(e.POLYGON_OFFSET_FILL):e.disable(e.POLYGON_OFFSET_FILL),v=t),!t||y===r&&b===n||(e.polygonOffset(r,n),y=r,b=n)},this.reset=function(){for(var e=0;e<n.length;e++)n[e]=0;i=null,h=null,d=null,f=null,p=null,m=null}},K.LensFlarePlugin=function(e,t){var r,n,i,o,a,s,l,u,c=e.context,h=function(){var t,h=new Float32Array([-1,-1,0,0,1,-1,1,0,1,1,1,1,-1,1,0,1]),d=new Uint16Array([0,1,2,0,2,3]);r=c.createBuffer(),n=c.createBuffer(),c.bindBuffer(c.ARRAY_BUFFER,r),c.bufferData(c.ARRAY_BUFFER,h,c.STATIC_DRAW),c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,n),c.bufferData(c.ELEMENT_ARRAY_BUFFER,d,c.STATIC_DRAW),l=c.createTexture(),u=c.createTexture(),c.bindTexture(c.TEXTURE_2D,l),c.texImage2D(c.TEXTURE_2D,0,c.RGB,16,16,0,c.RGB,c.UNSIGNED_BYTE,null),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_S,c.CLAMP_TO_EDGE),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_T,c.CLAMP_TO_EDGE),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,c.NEAREST),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,c.NEAREST),c.bindTexture(c.TEXTURE_2D,u),c.texImage2D(c.TEXTURE_2D,0,c.RGBA,16,16,0,c.RGBA,c.UNSIGNED_BYTE,null),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_S,c.CLAMP_TO_EDGE),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_T,c.CLAMP_TO_EDGE),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,c.NEAREST),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,c.NEAREST),t=(s=c.getParameter(c.MAX_VERTEX_TEXTURE_IMAGE_UNITS)>0)?{vertexShader:["uniform lowp int renderType;","uniform vec3 screenPosition;","uniform vec2 scale;","uniform float rotation;","uniform sampler2D occlusionMap;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","varying float vVisibility;","void main() {","vUV = uv;","vec2 pos = position;","if( renderType == 2 ) {","vec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) );","visibility += texture2D( occlusionMap, vec2( 0.5, 0.1 ) );","visibility += texture2D( occlusionMap, vec2( 0.9, 0.1 ) );","visibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) );","visibility += texture2D( occlusionMap, vec2( 0.9, 0.9 ) );","visibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) );","visibility += texture2D( occlusionMap, vec2( 0.1, 0.9 ) );","visibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) );","visibility += texture2D( occlusionMap, vec2( 0.5, 0.5 ) );","vVisibility =        visibility.r / 9.0;","vVisibility *= 1.0 - visibility.g / 9.0;","vVisibility *=       visibility.b / 9.0;","vVisibility *= 1.0 - visibility.a / 9.0;","pos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;","pos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;","}","gl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );","}"].join("\n"),fragmentShader:["uniform lowp int renderType;","uniform sampler2D map;","uniform float opacity;","uniform vec3 color;","varying vec2 vUV;","varying float vVisibility;","void main() {","if( renderType == 0 ) {","gl_FragColor = vec4( 1.0, 0.0, 1.0, 0.0 );","} else if( renderType == 1 ) {","gl_FragColor = texture2D( map, vUV );","} else {","vec4 texture = texture2D( map, vUV );","texture.a *= opacity * vVisibility;","gl_FragColor = texture;","gl_FragColor.rgb *= color;","}","}"].join("\n")}:{vertexShader:["uniform lowp int renderType;","uniform vec3 screenPosition;","uniform vec2 scale;","uniform float rotation;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","void main() {","vUV = uv;","vec2 pos = position;","if( renderType == 2 ) {","pos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;","pos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;","}","gl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );","}"].join("\n"),fragmentShader:["precision mediump float;","uniform lowp int renderType;","uniform sampler2D map;","uniform sampler2D occlusionMap;","uniform float opacity;","uniform vec3 color;","varying vec2 vUV;","void main() {","if( renderType == 0 ) {","gl_FragColor = vec4( texture2D( map, vUV ).rgb, 0.0 );","} else if( renderType == 1 ) {","gl_FragColor = texture2D( map, vUV );","} else {","float visibility = texture2D( occlusionMap, vec2( 0.5, 0.1 ) ).a;","visibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) ).a;","visibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) ).a;","visibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) ).a;","visibility = ( 1.0 - visibility / 4.0 );","vec4 texture = texture2D( map, vUV );","texture.a *= opacity * visibility;","gl_FragColor = texture;","gl_FragColor.rgb *= color;","}","}"].join("\n")},i=function(t){var r=c.createProgram(),n=c.createShader(c.FRAGMENT_SHADER),i=c.createShader(c.VERTEX_SHADER),o="precision "+e.getPrecision()+" float;\n";return c.shaderSource(n,o+t.fragmentShader),c.shaderSource(i,o+t.vertexShader),c.compileShader(n),c.compileShader(i),c.attachShader(r,n),c.attachShader(r,i),c.linkProgram(r),r}(t),o={vertex:c.getAttribLocation(i,"position"),uv:c.getAttribLocation(i,"uv")},a={renderType:c.getUniformLocation(i,"renderType"),map:c.getUniformLocation(i,"map"),occlusionMap:c.getUniformLocation(i,"occlusionMap"),opacity:c.getUniformLocation(i,"opacity"),color:c.getUniformLocation(i,"color"),scale:c.getUniformLocation(i,"scale"),rotation:c.getUniformLocation(i,"rotation"),screenPosition:c.getUniformLocation(i,"screenPosition")}};this.render=function(d,f,p,m){if(0!==t.length){var g=new K.Vector3,v=m/p,y=.5*p,b=.5*m,x=16/m,_=new K.Vector2(x*v,x),E=new K.Vector3(1,1,0),w=new K.Vector2(1,1);void 0===i&&h(),c.useProgram(i),c.enableVertexAttribArray(o.vertex),c.enableVertexAttribArray(o.uv),c.uniform1i(a.occlusionMap,0),c.uniform1i(a.map,1),c.bindBuffer(c.ARRAY_BUFFER,r),c.vertexAttribPointer(o.vertex,2,c.FLOAT,!1,16,0),c.vertexAttribPointer(o.uv,2,c.FLOAT,!1,16,8),c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,n),c.disable(c.CULL_FACE),c.depthMask(!1);for(var A=0,S=t.length;A<S;A++){x=16/m,_.set(x*v,x);var M=t[A];if(g.set(M.matrixWorld.elements[12],M.matrixWorld.elements[13],M.matrixWorld.elements[14]),g.applyMatrix4(f.matrixWorldInverse),g.applyProjection(f.projectionMatrix),E.copy(g),w.x=E.x*y+y,w.y=E.y*b+b,s||w.x>0&&w.x<p&&w.y>0&&w.y<m){c.activeTexture(c.TEXTURE1),c.bindTexture(c.TEXTURE_2D,l),c.copyTexImage2D(c.TEXTURE_2D,0,c.RGB,w.x-8,w.y-8,16,16,0),c.uniform1i(a.renderType,0),c.uniform2f(a.scale,_.x,_.y),c.uniform3f(a.screenPosition,E.x,E.y,E.z),c.disable(c.BLEND),c.enable(c.DEPTH_TEST),c.drawElements(c.TRIANGLES,6,c.UNSIGNED_SHORT,0),c.activeTexture(c.TEXTURE0),c.bindTexture(c.TEXTURE_2D,u),c.copyTexImage2D(c.TEXTURE_2D,0,c.RGBA,w.x-8,w.y-8,16,16,0),c.uniform1i(a.renderType,1),c.disable(c.DEPTH_TEST),c.activeTexture(c.TEXTURE1),c.bindTexture(c.TEXTURE_2D,l),c.drawElements(c.TRIANGLES,6,c.UNSIGNED_SHORT,0),M.positionScreen.copy(E),M.customUpdateCallback?M.customUpdateCallback(M):M.updateLensFlares(),c.uniform1i(a.renderType,2),c.enable(c.BLEND);for(var T=0,C=M.lensFlares.length;T<C;T++){var P=M.lensFlares[T];P.opacity>.001&&P.scale>.001&&(E.x=P.x,E.y=P.y,E.z=P.z,x=P.size*P.scale/m,_.x=x*v,_.y=x,c.uniform3f(a.screenPosition,E.x,E.y,E.z),c.uniform2f(a.scale,_.x,_.y),c.uniform1f(a.rotation,P.rotation),c.uniform1f(a.opacity,P.opacity),c.uniform3f(a.color,P.color.r,P.color.g,P.color.b),e.state.setBlending(P.blending,P.blendEquation,P.blendSrc,P.blendDst),e.setTexture(P.texture,1),c.drawElements(c.TRIANGLES,6,c.UNSIGNED_SHORT,0))}}}c.enable(c.CULL_FACE),c.enable(c.DEPTH_TEST),c.depthMask(!0),e.resetGLState()}}},K.ShadowMapPlugin=function(e,t,r,n){var i,o,a,s,l=e.context,u=new K.Frustum,c=new K.Matrix4,h=new K.Vector3,d=new K.Vector3,f=new K.Vector3,p=[],m=K.ShaderLib.depthRGBA,g=K.UniformsUtils.clone(m.uniforms);function v(e,t,n){if(t.visible){var i=r[t.id];if(i&&t.castShadow&&(!1===t.frustumCulled||!0===u.intersectsObject(t)))for(var o=0,a=i.length;o<a;o++){var s=i[o];t._modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,t.matrixWorld),p.push(s)}for(o=0,a=t.children.length;o<a;o++)v(e,t.children[o],n)}}function y(e,t){var r=new K.DirectionalLight;r.isVirtual=!0,r.onlyShadow=!0,r.castShadow=!0,r.shadowCameraNear=e.shadowCameraNear,r.shadowCameraFar=e.shadowCameraFar,r.shadowCameraLeft=e.shadowCameraLeft,r.shadowCameraRight=e.shadowCameraRight,r.shadowCameraBottom=e.shadowCameraBottom,r.shadowCameraTop=e.shadowCameraTop,r.shadowCameraVisible=e.shadowCameraVisible,r.shadowDarkness=e.shadowDarkness,r.shadowBias=e.shadowCascadeBias[t],r.shadowMapWidth=e.shadowCascadeWidth[t],r.shadowMapHeight=e.shadowCascadeHeight[t],r.pointsWorld=[],r.pointsFrustum=[];for(var n=r.pointsWorld,i=r.pointsFrustum,o=0;o<8;o++)n[o]=new K.Vector3,i[o]=new K.Vector3;var a=e.shadowCascadeNearZ[t],s=e.shadowCascadeFarZ[t];return i[0].set(-1,-1,a),i[1].set(1,-1,a),i[2].set(-1,1,a),i[3].set(1,1,a),i[4].set(-1,-1,s),i[5].set(1,-1,s),i[6].set(-1,1,s),i[7].set(1,1,s),r}function b(e,t){var r=e.shadowCascadeArray[t];r.position.copy(e.position),r.target.position.copy(e.target.position),r.lookAt(r.target),r.shadowCameraVisible=e.shadowCameraVisible,r.shadowDarkness=e.shadowDarkness,r.shadowBias=e.shadowCascadeBias[t];var n=e.shadowCascadeNearZ[t],i=e.shadowCascadeFarZ[t],o=r.pointsFrustum;o[0].z=n,o[1].z=n,o[2].z=n,o[3].z=n,o[4].z=i,o[5].z=i,o[6].z=i,o[7].z=i}function x(e,t){var r=t.shadowCamera,n=t.pointsFrustum,i=t.pointsWorld;h.set(1/0,1/0,1/0),d.set(-1/0,-1/0,-1/0);for(var o=0;o<8;o++){var a=i[o];a.copy(n[o]),a.unproject(e),a.applyMatrix4(r.matrixWorldInverse),a.x<h.x&&(h.x=a.x),a.x>d.x&&(d.x=a.x),a.y<h.y&&(h.y=a.y),a.y>d.y&&(d.y=a.y),a.z<h.z&&(h.z=a.z),a.z>d.z&&(d.z=a.z)}r.left=h.x,r.right=d.x,r.top=d.y,r.bottom=h.y,r.updateProjectionMatrix()}function _(e){return e.material instanceof K.MeshFaceMaterial?e.material.materials[0]:e.material}i=new K.ShaderMaterial({uniforms:g,vertexShader:m.vertexShader,fragmentShader:m.fragmentShader}),o=new K.ShaderMaterial({uniforms:g,vertexShader:m.vertexShader,fragmentShader:m.fragmentShader,morphTargets:!0}),a=new K.ShaderMaterial({uniforms:g,vertexShader:m.vertexShader,fragmentShader:m.fragmentShader,skinning:!0}),s=new K.ShaderMaterial({uniforms:g,vertexShader:m.vertexShader,fragmentShader:m.fragmentShader,morphTargets:!0,skinning:!0}),i._shadowPass=!0,o._shadowPass=!0,a._shadowPass=!0,s._shadowPass=!0,this.render=function(r,h){if(!1!==e.shadowMapEnabled){var d,m,g,E,w,A,S,M,T,C,P,D,L,R=[],I=0,O=null;for(l.clearColor(1,1,1,1),l.disable(l.BLEND),l.enable(l.CULL_FACE),l.frontFace(l.CCW),e.shadowMapCullFace===K.CullFaceFront?l.cullFace(l.FRONT):l.cullFace(l.BACK),e.state.setDepthTest(!0),d=0,m=t.length;d<m;d++)if((L=t[d]).castShadow)if(L instanceof K.DirectionalLight&&L.shadowCascade)for(w=0;w<L.shadowCascadeCount;w++){var N;if(L.shadowCascadeArray[w])N=L.shadowCascadeArray[w];else{(N=y(L,w)).originalCamera=h;var k=new K.Gyroscope;k.position.copy(L.shadowCascadeOffset),k.add(N),k.add(N.target),h.add(k),L.shadowCascadeArray[w]=N}b(L,w),R[I]=N,I++}else R[I]=L,I++;for(d=0,m=R.length;d<m;d++){if(!(L=R[d]).shadowMap){var F=K.LinearFilter;e.shadowMapType===K.PCFSoftShadowMap&&(F=K.NearestFilter);var V={minFilter:F,magFilter:F,format:K.RGBAFormat};L.shadowMap=new K.WebGLRenderTarget(L.shadowMapWidth,L.shadowMapHeight,V),L.shadowMapSize=new K.Vector2(L.shadowMapWidth,L.shadowMapHeight),L.shadowMatrix=new K.Matrix4}if(!L.shadowCamera){if(L instanceof K.SpotLight)L.shadowCamera=new K.PerspectiveCamera(L.shadowCameraFov,L.shadowMapWidth/L.shadowMapHeight,L.shadowCameraNear,L.shadowCameraFar);else{if(!(L instanceof K.DirectionalLight)){K.error("THREE.ShadowMapPlugin: Unsupported light type for shadow",L);continue}L.shadowCamera=new K.OrthographicCamera(L.shadowCameraLeft,L.shadowCameraRight,L.shadowCameraTop,L.shadowCameraBottom,L.shadowCameraNear,L.shadowCameraFar)}r.add(L.shadowCamera),!0===r.autoUpdate&&r.updateMatrixWorld()}var U,B,z;for(L.shadowCameraVisible&&!L.cameraHelper&&(L.cameraHelper=new K.CameraHelper(L.shadowCamera),r.add(L.cameraHelper)),L.isVirtual&&N.originalCamera==h&&x(h,L),A=L.shadowMap,S=L.shadowMatrix,(M=L.shadowCamera).position.setFromMatrixPosition(L.matrixWorld),f.setFromMatrixPosition(L.target.matrixWorld),M.lookAt(f),M.updateMatrixWorld(),M.matrixWorldInverse.getInverse(M.matrixWorld),L.cameraHelper&&(L.cameraHelper.visible=L.shadowCameraVisible),L.shadowCameraVisible&&L.cameraHelper.update(),S.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),S.multiply(M.projectionMatrix),S.multiply(M.matrixWorldInverse),c.multiplyMatrices(M.projectionMatrix,M.matrixWorldInverse),u.setFromMatrix(c),e.setRenderTarget(A),e.clear(),p.length=0,v(r,r,M),g=0,E=p.length;g<E;g++)D=(P=p[g]).object,T=P.buffer,U=_(D),B=void 0!==D.geometry.morphTargets&&D.geometry.morphTargets.length>0&&U.morphTargets,z=D instanceof K.SkinnedMesh&&U.skinning,C=D.customDepthMaterial?D.customDepthMaterial:z?B?s:a:B?o:i,e.setMaterialFaces(U),T instanceof K.BufferGeometry?e.renderBufferDirect(M,t,O,C,T,D):e.renderBuffer(M,t,O,C,T,D);for(g=0,E=n.length;g<E;g++)(D=(P=n[g]).object).visible&&D.castShadow&&(D._modelViewMatrix.multiplyMatrices(M.matrixWorldInverse,D.matrixWorld),e.renderImmediateObject(M,t,O,i,D))}var G=e.getClearColor(),H=e.getClearAlpha();l.clearColor(G.r,G.g,G.b,H),l.enable(l.BLEND),e.shadowMapCullFace===K.CullFaceFront&&l.cullFace(l.BACK),e.resetGLState()}}},K.SpritePlugin=function(e,t){var r,n,i,o,a,s,l=e.context,u=new K.Vector3,c=new K.Quaternion,h=new K.Vector3,d=function(){var t=new Float32Array([-.5,-.5,0,0,.5,-.5,1,0,.5,.5,1,1,-.5,.5,0,1]),u=new Uint16Array([0,1,2,0,2,3]);r=l.createBuffer(),n=l.createBuffer(),l.bindBuffer(l.ARRAY_BUFFER,r),l.bufferData(l.ARRAY_BUFFER,t,l.STATIC_DRAW),l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,n),l.bufferData(l.ELEMENT_ARRAY_BUFFER,u,l.STATIC_DRAW),i=function(){var t=l.createProgram(),r=l.createShader(l.VERTEX_SHADER),n=l.createShader(l.FRAGMENT_SHADER);return l.shaderSource(r,["precision "+e.getPrecision()+" float;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform float rotation;","uniform vec2 scale;","uniform vec2 uvOffset;","uniform vec2 uvScale;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","void main() {","vUV = uvOffset + uv * uvScale;","vec2 alignedPosition = position * scale;","vec2 rotatedPosition;","rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;","rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;","vec4 finalPosition;","finalPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );","finalPosition.xy += rotatedPosition;","finalPosition = projectionMatrix * finalPosition;","gl_Position = finalPosition;","}"].join("\n")),l.shaderSource(n,["precision "+e.getPrecision()+" float;","uniform vec3 color;","uniform sampler2D map;","uniform float opacity;","uniform int fogType;","uniform vec3 fogColor;","uniform float fogDensity;","uniform float fogNear;","uniform float fogFar;","uniform float alphaTest;","varying vec2 vUV;","void main() {","vec4 texture = texture2D( map, vUV );","if ( texture.a < alphaTest ) discard;","gl_FragColor = vec4( color * texture.xyz, texture.a * opacity );","if ( fogType > 0 ) {","float depth = gl_FragCoord.z / gl_FragCoord.w;","float fogFactor = 0.0;","if ( fogType == 1 ) {","fogFactor = smoothstep( fogNear, fogFar, depth );","} else {","const float LOG2 = 1.442695;","float fogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );","fogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );","}","gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );","}","}"].join("\n")),l.compileShader(r),l.compileShader(n),l.attachShader(t,r),l.attachShader(t,n),l.linkProgram(t),t}(),o={position:l.getAttribLocation(i,"position"),uv:l.getAttribLocation(i,"uv")},a={uvOffset:l.getUniformLocation(i,"uvOffset"),uvScale:l.getUniformLocation(i,"uvScale"),rotation:l.getUniformLocation(i,"rotation"),scale:l.getUniformLocation(i,"scale"),color:l.getUniformLocation(i,"color"),map:l.getUniformLocation(i,"map"),opacity:l.getUniformLocation(i,"opacity"),modelViewMatrix:l.getUniformLocation(i,"modelViewMatrix"),projectionMatrix:l.getUniformLocation(i,"projectionMatrix"),fogType:l.getUniformLocation(i,"fogType"),fogDensity:l.getUniformLocation(i,"fogDensity"),fogNear:l.getUniformLocation(i,"fogNear"),fogFar:l.getUniformLocation(i,"fogFar"),fogColor:l.getUniformLocation(i,"fogColor"),alphaTest:l.getUniformLocation(i,"alphaTest")};var c=document.createElement("canvas");c.width=8,c.height=8;var h=c.getContext("2d");h.fillStyle="white",h.fillRect(0,0,8,8),(s=new K.Texture(c)).needsUpdate=!0};function f(e,t){return e.z!==t.z?t.z-e.z:t.id-e.id}this.render=function(p,m){if(0!==t.length){void 0===i&&d(),l.useProgram(i),l.enableVertexAttribArray(o.position),l.enableVertexAttribArray(o.uv),l.disable(l.CULL_FACE),l.enable(l.BLEND),l.bindBuffer(l.ARRAY_BUFFER,r),l.vertexAttribPointer(o.position,2,l.FLOAT,!1,16,0),l.vertexAttribPointer(o.uv,2,l.FLOAT,!1,16,8),l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,n),l.uniformMatrix4fv(a.projectionMatrix,!1,m.projectionMatrix.elements),l.activeTexture(l.TEXTURE0),l.uniform1i(a.map,0);var g=0,v=0,y=p.fog;y?(l.uniform3f(a.fogColor,y.color.r,y.color.g,y.color.b),y instanceof K.Fog?(l.uniform1f(a.fogNear,y.near),l.uniform1f(a.fogFar,y.far),l.uniform1i(a.fogType,1),g=1,v=1):y instanceof K.FogExp2&&(l.uniform1f(a.fogDensity,y.density),l.uniform1i(a.fogType,2),g=2,v=2)):(l.uniform1i(a.fogType,0),g=0,v=0);for(var b=0,x=t.length;b<x;b++){(E=t[b])._modelViewMatrix.multiplyMatrices(m.matrixWorldInverse,E.matrixWorld),E.z=-E._modelViewMatrix.elements[14]}t.sort(f);var _=[];for(b=0,x=t.length;b<x;b++){var E,w=(E=t[b]).material;l.uniform1f(a.alphaTest,w.alphaTest),l.uniformMatrix4fv(a.modelViewMatrix,!1,E._modelViewMatrix.elements),E.matrixWorld.decompose(u,c,h),_[0]=h.x,_[1]=h.y;var A=0;p.fog&&w.fog&&(A=v),g!==A&&(l.uniform1i(a.fogType,A),g=A),null!==w.map?(l.uniform2f(a.uvOffset,w.map.offset.x,w.map.offset.y),l.uniform2f(a.uvScale,w.map.repeat.x,w.map.repeat.y)):(l.uniform2f(a.uvOffset,0,0),l.uniform2f(a.uvScale,1,1)),l.uniform1f(a.opacity,w.opacity),l.uniform3f(a.color,w.color.r,w.color.g,w.color.b),l.uniform1f(a.rotation,w.rotation),l.uniform2fv(a.scale,_),e.state.setBlending(w.blending,w.blendEquation,w.blendSrc,w.blendDst),e.state.setDepthTest(w.depthTest),e.state.setDepthWrite(w.depthWrite),w.map&&w.map.image&&w.map.image.width?e.setTexture(w.map,0):e.setTexture(s,0),l.drawElements(l.TRIANGLES,6,l.UNSIGNED_SHORT,0)}l.enable(l.CULL_FACE),e.resetGLState()}}},K.GeometryUtils={merge:function(e,t,r){var n;K.warn("THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead."),t instanceof K.Mesh&&(t.matrixAutoUpdate&&t.updateMatrix(),n=t.matrix,t=t.geometry),e.merge(t,n,r)},center:function(e){return K.warn("THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead."),e.center()}},K.ImageUtils={crossOrigin:void 0,loadTexture:function(e,t,r,n){var i=new K.ImageLoader;i.crossOrigin=this.crossOrigin;var o=new K.Texture(void 0,t);return i.load(e,(function(e){o.image=e,o.needsUpdate=!0,r&&r(o)}),void 0,(function(e){n&&n(e)})),o.sourceFile=e,o},loadTextureCube:function(e,t,r,n){var i=new K.ImageLoader;i.crossOrigin=this.crossOrigin;var o=new K.CubeTexture([],t);o.flipY=!1;for(var a=0,s=function(t){i.load(e[t],(function(e){o.images[t]=e,6===(a+=1)&&(o.needsUpdate=!0,r&&r(o))}),void 0,n)},l=0,u=e.length;l<u;++l)s(l);return o},loadCompressedTexture:function(){K.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},loadCompressedTextureCube:function(){K.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")},getNormalMap:function(e,t){var r=function(e,t){return[e[0]-t[0],e[1]-t[1],e[2]-t[2]]},n=function(e){var t=Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);return[e[0]/t,e[1]/t,e[2]/t]};t|=1;var i=e.width,o=e.height,a=document.createElement("canvas");a.width=i,a.height=o;var s=a.getContext("2d");s.drawImage(e,0,0);for(var l,u,c=s.getImageData(0,0,i,o).data,h=s.createImageData(i,o),d=h.data,f=0;f<i;f++)for(var p=0;p<o;p++){var m=p-1<0?0:p-1,g=p+1>o-1?o-1:p+1,v=f-1<0?0:f-1,y=f+1>i-1?i-1:f+1,b=[],x=[0,0,c[4*(p*i+f)]/255*t];b.push([-1,0,c[4*(p*i+v)]/255*t]),b.push([-1,-1,c[4*(m*i+v)]/255*t]),b.push([0,-1,c[4*(m*i+f)]/255*t]),b.push([1,-1,c[4*(m*i+y)]/255*t]),b.push([1,0,c[4*(p*i+y)]/255*t]),b.push([1,1,c[4*(g*i+y)]/255*t]),b.push([0,1,c[4*(g*i+f)]/255*t]),b.push([-1,1,c[4*(g*i+v)]/255*t]);for(var _=[],E=b.length,w=0;w<E;w++){var A=b[w],S=b[(w+1)%E];A=r(A,x),S=r(S,x),_.push(n((u=S,[(l=A)[1]*u[2]-l[2]*u[1],l[2]*u[0]-l[0]*u[2],l[0]*u[1]-l[1]*u[0]])))}var M=[0,0,0];for(w=0;w<_.length;w++)M[0]+=_[w][0],M[1]+=_[w][1],M[2]+=_[w][2];M[0]/=_.length,M[1]/=_.length,M[2]/=_.length;var T=4*(p*i+f);d[T]=(M[0]+1)/2*255|0,d[T+1]=(M[1]+1)/2*255|0,d[T+2]=255*M[2]|0,d[T+3]=255}return s.putImageData(h,0,0),a},generateDataTexture:function(e,t,r){for(var n=e*t,i=new Uint8Array(3*n),o=Math.floor(255*r.r),a=Math.floor(255*r.g),s=Math.floor(255*r.b),l=0;l<n;l++)i[3*l]=o,i[3*l+1]=a,i[3*l+2]=s;var u=new K.DataTexture(i,e,t,K.RGBFormat);return u.needsUpdate=!0,u}},K.SceneUtils={createMultiMaterialObject:function(e,t){for(var r=new K.Object3D,n=0,i=t.length;n<i;n++)r.add(new K.Mesh(e,t[n]));return r},detach:function(e,t,r){e.applyMatrix(t.matrixWorld),t.remove(e),r.add(e)},attach:function(e,t,r){var n=new K.Matrix4;n.getInverse(r.matrixWorld),e.applyMatrix(n),t.remove(e),r.add(e)}},K.FontUtils={faces:{},face:"helvetiker",weight:"normal",style:"normal",size:150,divisions:10,getFace:function(){try{return this.faces[this.face][this.weight][this.style]}catch(e){throw"The font "+this.face+" with "+this.weight+" weight and "+this.style+" style is missing."}},loadFace:function(e){var t=e.familyName.toLowerCase(),r=this;return r.faces[t]=r.faces[t]||{},r.faces[t][e.cssFontWeight]=r.faces[t][e.cssFontWeight]||{},r.faces[t][e.cssFontWeight][e.cssFontStyle]=e,r.faces[t][e.cssFontWeight][e.cssFontStyle]=e,e},drawText:function(e){var t,r=this.getFace(),n=this.size/r.resolution,i=0,o=String(e).split(""),a=o.length,s=[];for(t=0;t<a;t++){var l=new K.Path,u=this.extractGlyphPoints(o[t],r,n,i,l);i+=u.offset,s.push(u.path)}return{paths:s,offset:i/2}},extractGlyphPoints:function(e,t,r,n,i){var o,a,s,l,u,c,h,d,f,p,m,g,v,y,b,x,_,E,w=[],A=t.glyphs[e]||t.glyphs["?"];if(A){if(A.o)for(u=(l=A._cachedOutline||(A._cachedOutline=A.o.split(" "))).length,c=r,h=r,o=0;o<u;)switch(l[o++]){case"m":d=l[o++]*c+n,f=l[o++]*h,i.moveTo(d,f);break;case"l":d=l[o++]*c+n,f=l[o++]*h,i.lineTo(d,f);break;case"q":if(p=l[o++]*c+n,m=l[o++]*h,y=l[o++]*c+n,b=l[o++]*h,i.quadraticCurveTo(y,b,p,m),E=w[w.length-1])for(g=E.x,v=E.y,a=1,s=this.divisions;a<=s;a++){var S=a/s;K.Shape.Utils.b2(S,g,y,p),K.Shape.Utils.b2(S,v,b,m)}break;case"b":if(p=l[o++]*c+n,m=l[o++]*h,y=l[o++]*c+n,b=l[o++]*h,x=l[o++]*c+n,_=l[o++]*h,i.bezierCurveTo(y,b,x,_,p,m),E=w[w.length-1])for(g=E.x,v=E.y,a=1,s=this.divisions;a<=s;a++){S=a/s;K.Shape.Utils.b3(S,g,y,x,p),K.Shape.Utils.b3(S,v,b,_,m)}}return{offset:A.ha*r,path:i}}}},K.FontUtils.generateShapes=function(e,t){var r=void 0!==(t=t||{}).size?t.size:100,n=void 0!==t.curveSegments?t.curveSegments:4,i=void 0!==t.font?t.font:"helvetiker",o=void 0!==t.weight?t.weight:"normal",a=void 0!==t.style?t.style:"normal";K.FontUtils.size=r,K.FontUtils.divisions=n,K.FontUtils.face=i,K.FontUtils.weight=o,K.FontUtils.style=a;for(var s=K.FontUtils.drawText(e).paths,l=[],u=0,c=s.length;u<c;u++)Array.prototype.push.apply(l,s[u].toShapes());return l},F=K.FontUtils,V=1e-10,U=function(e){for(var t=e.length,r=0,n=t-1,i=0;i<t;n=i++)r+=e[n].x*e[i].y-e[i].x*e[n].y;return.5*r},B=function(e,t,r,n,i,o){var a,s,l,u,c,h,d,f,p,m,g,v,y,b,x;if(s=e[o[t]].x,l=e[o[t]].y,u=e[o[r]].x,c=e[o[r]].y,h=e[o[n]].x,d=e[o[n]].y,V>(u-s)*(d-l)-(c-l)*(h-s))return!1;for(m=h-u,g=d-c,v=s-h,y=l-d,b=u-s,x=c-l,a=0;a<i;a++)if(f=e[o[a]].x,p=e[o[a]].y,!(f===s&&p===l||f===u&&p===c||f===h&&p===d)&&m*(p-c)-g*(f-u)>=-1e-10&&v*(p-d)-y*(f-h)>=-1e-10&&b*(p-l)-x*(f-s)>=-1e-10)return!1;return!0},F.Triangulate=function(e,t){var r=e.length;if(r<3)return null;var n,i,o,a=[],s=[],l=[];if(U(e)>0)for(i=0;i<r;i++)s[i]=i;else for(i=0;i<r;i++)s[i]=r-1-i;var u=r,c=2*u;for(i=u-1;u>2;){if(c--<=0)return K.warn("THREE.FontUtils: Warning, unable to triangulate polygon! in Triangulate.process()"),t?l:a;if(u<=(n=i)&&(n=0),u<=(i=n+1)&&(i=0),u<=(o=i+1)&&(o=0),B(e,n,i,o,u,s)){var h,d,f,p,m;for(h=s[n],d=s[i],f=s[o],a.push([e[h],e[d],e[f]]),l.push([s[n],s[i],s[o]]),p=i,m=i+1;m<u;p++,m++)s[p]=s[m];c=2*--u}}return t?l:a},F.Triangulate.area=U,K.Audio=function(e){K.Object3D.call(this),this.type="Audio",this.context=e.context,this.source=this.context.createBufferSource(),this.source.onended=this.onEnded.bind(this),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.panner=this.context.createPanner(),this.panner.connect(this.gain),this.autoplay=!1,this.startTime=0,this.isPlaying=!1},K.Audio.prototype=Object.create(K.Object3D.prototype),K.Audio.prototype.constructor=K.Audio,K.Audio.prototype.load=function(e){var t=this,r=new XMLHttpRequest;return r.open("GET",e,!0),r.responseType="arraybuffer",r.onload=function(e){t.context.decodeAudioData(this.response,(function(e){t.source.buffer=e,t.autoplay&&t.play()}))},r.send(),this},K.Audio.prototype.play=function(){if(!0!==this.isPlaying){var e=this.context.createBufferSource();e.buffer=this.source.buffer,e.loop=this.source.loop,e.onended=this.source.onended,e.connect(this.panner),e.start(0,this.startTime),this.isPlaying=!0,this.source=e}else K.warn("THREE.Audio: Audio is already playing.")},K.Audio.prototype.pause=function(){this.source.stop(),this.startTime=this.context.currentTime},K.Audio.prototype.stop=function(){this.source.stop(),this.startTime=0},K.Audio.prototype.onEnded=function(){this.isPlaying=!1},K.Audio.prototype.setLoop=function(e){this.source.loop=e},K.Audio.prototype.setRefDistance=function(e){this.panner.refDistance=e},K.Audio.prototype.setRolloffFactor=function(e){this.panner.rolloffFactor=e},K.Audio.prototype.setVolume=function(e){this.gain.gain.value=e},K.Audio.prototype.updateMatrixWorld=function(){var e=new K.Vector3;return function(t){K.Object3D.prototype.updateMatrixWorld.call(this,t),e.setFromMatrixPosition(this.matrixWorld),this.panner.setPosition(e.x,e.y,e.z)}}(),K.AudioListener=function(){K.Object3D.call(this),this.type="AudioListener",this.context=new(window.AudioContext||window.webkitAudioContext)},K.AudioListener.prototype=Object.create(K.Object3D.prototype),K.AudioListener.prototype.constructor=K.AudioListener,K.AudioListener.prototype.updateMatrixWorld=function(){var e=new K.Vector3,t=new K.Quaternion,r=new K.Vector3,n=new K.Vector3,i=new K.Vector3,o=new K.Vector3;return function(a){K.Object3D.prototype.updateMatrixWorld.call(this,a);var s=this.context.listener,l=this.up;this.matrixWorld.decompose(e,t,r),n.set(0,0,-1).applyQuaternion(t),i.subVectors(e,o),s.setPosition(e.x,e.y,e.z),s.setOrientation(n.x,n.y,n.z,l.x,l.y,l.z),s.setVelocity(i.x,i.y,i.z),o.copy(e)}}(),K.Curve=function(){},K.Curve.prototype.getPoint=function(e){return K.warn("THREE.Curve: Warning, getPoint() not implemented!"),null},K.Curve.prototype.getPointAt=function(e){var t=this.getUtoTmapping(e);return this.getPoint(t)},K.Curve.prototype.getPoints=function(e){e||(e=5);var t,r=[];for(t=0;t<=e;t++)r.push(this.getPoint(t/e));return r},K.Curve.prototype.getSpacedPoints=function(e){e||(e=5);var t,r=[];for(t=0;t<=e;t++)r.push(this.getPointAt(t/e));return r},K.Curve.prototype.getLength=function(){var e=this.getLengths();return e[e.length-1]},K.Curve.prototype.getLengths=function(e){if(e||(e=this.__arcLengthDivisions?this.__arcLengthDivisions:200),this.cacheArcLengths&&this.cacheArcLengths.length==e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var t,r,n=[],i=this.getPoint(0),o=0;for(n.push(0),r=1;r<=e;r++)o+=(t=this.getPoint(r/e)).distanceTo(i),n.push(o),i=t;return this.cacheArcLengths=n,n},K.Curve.prototype.updateArcLengths=function(){this.needsUpdate=!0,this.getLengths()},K.Curve.prototype.getUtoTmapping=function(e,t){var r,n=this.getLengths(),i=0,o=n.length;r=t||e*n[o-1];for(var a,s=0,l=o-1;s<=l;)if((a=n[i=Math.floor(s+(l-s)/2)]-r)<0)s=i+1;else{if(!(a>0)){l=i;break}l=i-1}if(n[i=l]==r)return i/(o-1);var u=n[i];return(i+(r-u)/(n[i+1]-u))/(o-1)},K.Curve.prototype.getTangent=function(e){var t=1e-4,r=e-t,n=e+t;r<0&&(r=0),n>1&&(n=1);var i=this.getPoint(r);return this.getPoint(n).clone().sub(i).normalize()},K.Curve.prototype.getTangentAt=function(e){var t=this.getUtoTmapping(e);return this.getTangent(t)},K.Curve.Utils={tangentQuadraticBezier:function(e,t,r,n){return 2*(1-e)*(r-t)+2*e*(n-r)},tangentCubicBezier:function(e,t,r,n,i){return-3*t*(1-e)*(1-e)+3*r*(1-e)*(1-e)-6*e*r*(1-e)+6*e*n*(1-e)-3*e*e*n+3*e*e*i},tangentSpline:function(e,t,r,n,i){return 6*e*e-6*e+(3*e*e-4*e+1)+(-6*e*e+6*e)+(3*e*e-2*e)},interpolate:function(e,t,r,n,i){var o=.5*(r-e),a=.5*(n-t),s=i*i;return(2*t-2*r+o+a)*(i*s)+(-3*t+3*r-2*o-a)*s+o*i+t}},K.Curve.create=function(e,t){return e.prototype=Object.create(K.Curve.prototype),e.prototype.constructor=e,e.prototype.getPoint=t,e},K.CurvePath=function(){this.curves=[],this.bends=[],this.autoClose=!1},K.CurvePath.prototype=Object.create(K.Curve.prototype),K.CurvePath.prototype.constructor=K.CurvePath,K.CurvePath.prototype.add=function(e){this.curves.push(e)},K.CurvePath.prototype.checkConnection=function(){},K.CurvePath.prototype.closePath=function(){var e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new K.LineCurve(t,e))},K.CurvePath.prototype.getPoint=function(e){for(var t,r=e*this.getLength(),n=this.getCurveLengths(),i=0;i<n.length;){if(n[i]>=r){var o=1-(n[i]-r)/(t=this.curves[i]).getLength();return t.getPointAt(o)}i++}return null},K.CurvePath.prototype.getLength=function(){var e=this.getCurveLengths();return e[e.length-1]},K.CurvePath.prototype.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length==this.curves.length)return this.cacheLengths;var e,t=[],r=0,n=this.curves.length;for(e=0;e<n;e++)r+=this.curves[e].getLength(),t.push(r);return this.cacheLengths=t,t},K.CurvePath.prototype.getBoundingBox=function(){var e,t,r,n,i,o,a,s,l,u,c=this.getPoints();e=t=Number.NEGATIVE_INFINITY,n=i=Number.POSITIVE_INFINITY;var h=c[0]instanceof K.Vector3;for(u=h?new K.Vector3:new K.Vector2,s=0,l=c.length;s<l;s++)(a=c[s]).x>e?e=a.x:a.x<n&&(n=a.x),a.y>t?t=a.y:a.y<i&&(i=a.y),h&&(a.z>r?r=a.z:a.z<o&&(o=a.z)),u.add(a);var d={minX:n,minY:i,maxX:e,maxY:t};return h&&(d.maxZ=r,d.minZ=o),d},K.CurvePath.prototype.createPointsGeometry=function(e){var t=this.getPoints(e,!0);return this.createGeometry(t)},K.CurvePath.prototype.createSpacedPointsGeometry=function(e){var t=this.getSpacedPoints(e,!0);return this.createGeometry(t)},K.CurvePath.prototype.createGeometry=function(e){for(var t=new K.Geometry,r=0;r<e.length;r++)t.vertices.push(new K.Vector3(e[r].x,e[r].y,e[r].z||0));return t},K.CurvePath.prototype.addWrapPath=function(e){this.bends.push(e)},K.CurvePath.prototype.getTransformedPoints=function(e,t){var r,n,i=this.getPoints(e);for(t||(t=this.bends),r=0,n=t.length;r<n;r++)i=this.getWrapPoints(i,t[r]);return i},K.CurvePath.prototype.getTransformedSpacedPoints=function(e,t){var r,n,i=this.getSpacedPoints(e);for(t||(t=this.bends),r=0,n=t.length;r<n;r++)i=this.getWrapPoints(i,t[r]);return i},K.CurvePath.prototype.getWrapPoints=function(e,t){var r,n,i,o,a,s,l=this.getBoundingBox();for(r=0,n=e.length;r<n;r++){o=(i=e[r]).x,a=i.y,s=o/l.maxX,s=t.getUtoTmapping(s,o);var u=t.getPoint(s),c=t.getTangent(s);c.set(-c.y,c.x).multiplyScalar(a),i.x=u.x+c.x,i.y=u.y+c.y}return e},K.Gyroscope=function(){K.Object3D.call(this)},K.Gyroscope.prototype=Object.create(K.Object3D.prototype),K.Gyroscope.prototype.constructor=K.Gyroscope,K.Gyroscope.prototype.updateMatrixWorld=(z=new K.Vector3,G=new K.Quaternion,H=new K.Vector3,W=new K.Vector3,j=new K.Quaternion,q=new K.Vector3,function(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent?(this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorld.decompose(W,j,q),this.matrix.decompose(z,G,H),this.matrixWorld.compose(W,G,q)):this.matrixWorld.copy(this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);for(var t=0,r=this.children.length;t<r;t++)this.children[t].updateMatrixWorld(e)}),K.Path=function(e){K.CurvePath.call(this),this.actions=[],e&&this.fromPoints(e)},K.Path.prototype=Object.create(K.CurvePath.prototype),K.Path.prototype.constructor=K.Path,K.PathActions={MOVE_TO:"moveTo",LINE_TO:"lineTo",QUADRATIC_CURVE_TO:"quadraticCurveTo",BEZIER_CURVE_TO:"bezierCurveTo",CSPLINE_THRU:"splineThru",ARC:"arc",ELLIPSE:"ellipse"},K.Path.prototype.fromPoints=function(e){this.moveTo(e[0].x,e[0].y);for(var t=1,r=e.length;t<r;t++)this.lineTo(e[t].x,e[t].y)},K.Path.prototype.moveTo=function(e,t){var r=Array.prototype.slice.call(arguments);this.actions.push({action:K.PathActions.MOVE_TO,args:r})},K.Path.prototype.lineTo=function(e,t){var r=Array.prototype.slice.call(arguments),n=this.actions[this.actions.length-1].args,i=n[n.length-2],o=n[n.length-1],a=new K.LineCurve(new K.Vector2(i,o),new K.Vector2(e,t));this.curves.push(a),this.actions.push({action:K.PathActions.LINE_TO,args:r})},K.Path.prototype.quadraticCurveTo=function(e,t,r,n){var i=Array.prototype.slice.call(arguments),o=this.actions[this.actions.length-1].args,a=o[o.length-2],s=o[o.length-1],l=new K.QuadraticBezierCurve(new K.Vector2(a,s),new K.Vector2(e,t),new K.Vector2(r,n));this.curves.push(l),this.actions.push({action:K.PathActions.QUADRATIC_CURVE_TO,args:i})},K.Path.prototype.bezierCurveTo=function(e,t,r,n,i,o){var a=Array.prototype.slice.call(arguments),s=this.actions[this.actions.length-1].args,l=s[s.length-2],u=s[s.length-1],c=new K.CubicBezierCurve(new K.Vector2(l,u),new K.Vector2(e,t),new K.Vector2(r,n),new K.Vector2(i,o));this.curves.push(c),this.actions.push({action:K.PathActions.BEZIER_CURVE_TO,args:a})},K.Path.prototype.splineThru=function(e){var t=Array.prototype.slice.call(arguments),r=this.actions[this.actions.length-1].args,n=r[r.length-2],i=r[r.length-1],o=[new K.Vector2(n,i)];Array.prototype.push.apply(o,e);var a=new K.SplineCurve(o);this.curves.push(a),this.actions.push({action:K.PathActions.CSPLINE_THRU,args:t})},K.Path.prototype.arc=function(e,t,r,n,i,o){var a=this.actions[this.actions.length-1].args,s=a[a.length-2],l=a[a.length-1];this.absarc(e+s,t+l,r,n,i,o)},K.Path.prototype.absarc=function(e,t,r,n,i,o){this.absellipse(e,t,r,r,n,i,o)},K.Path.prototype.ellipse=function(e,t,r,n,i,o,a){var s=this.actions[this.actions.length-1].args,l=s[s.length-2],u=s[s.length-1];this.absellipse(e+l,t+u,r,n,i,o,a)},K.Path.prototype.absellipse=function(e,t,r,n,i,o,a){var s=Array.prototype.slice.call(arguments),l=new K.EllipseCurve(e,t,r,n,i,o,a);this.curves.push(l);var u=l.getPoint(1);s.push(u.x),s.push(u.y),this.actions.push({action:K.PathActions.ELLIPSE,args:s})},K.Path.prototype.getSpacedPoints=function(e,t){e||(e=40);for(var r=[],n=0;n<e;n++)r.push(this.getPoint(n/e));return r},K.Path.prototype.getPoints=function(e,t){if(this.useSpacedPoints)return console.log("tata"),this.getSpacedPoints(e,t);e=e||12;var r,n,i,o,a,s,l,u,c,h,d,f,p,m,g,v,y,b,x=[];for(r=0,n=this.actions.length;r<n;r++)switch(o=(i=this.actions[r]).action,a=i.args,o){case K.PathActions.MOVE_TO:case K.PathActions.LINE_TO:x.push(new K.Vector2(a[0],a[1]));break;case K.PathActions.QUADRATIC_CURVE_TO:for(s=a[2],l=a[3],h=a[0],d=a[1],x.length>0?(f=(m=x[x.length-1]).x,p=m.y):(f=(m=this.actions[r-1].args)[m.length-2],p=m[m.length-1]),g=1;g<=e;g++)v=g/e,y=K.Shape.Utils.b2(v,f,h,s),b=K.Shape.Utils.b2(v,p,d,l),x.push(new K.Vector2(y,b));break;case K.PathActions.BEZIER_CURVE_TO:for(s=a[4],l=a[5],h=a[0],d=a[1],u=a[2],c=a[3],x.length>0?(f=(m=x[x.length-1]).x,p=m.y):(f=(m=this.actions[r-1].args)[m.length-2],p=m[m.length-1]),g=1;g<=e;g++)v=g/e,y=K.Shape.Utils.b3(v,f,h,u,s),b=K.Shape.Utils.b3(v,p,d,c,l),x.push(new K.Vector2(y,b));break;case K.PathActions.CSPLINE_THRU:m=this.actions[r-1].args;var _=[new K.Vector2(m[m.length-2],m[m.length-1])],E=e*a[0].length;_=_.concat(a[0]);var w=new K.SplineCurve(_);for(g=1;g<=E;g++)x.push(w.getPointAt(g/E));break;case K.PathActions.ARC:var A=a[0],S=a[1],M=a[2],T=a[3],C=a[4],P=!!a[5],D=C-T,L=2*e;for(g=1;g<=L;g++)v=g/L,P||(v=1-v),R=T+v*D,y=A+M*Math.cos(R),b=S+M*Math.sin(R),x.push(new K.Vector2(y,b));break;case K.PathActions.ELLIPSE:A=a[0],S=a[1];var R,I=a[2],O=a[3];T=a[4],C=a[5],P=!!a[6],D=C-T,L=2*e;for(g=1;g<=L;g++)v=g/L,P||(v=1-v),R=T+v*D,y=A+I*Math.cos(R),b=S+O*Math.sin(R),x.push(new K.Vector2(y,b))}var N=x[x.length-1];return Math.abs(N.x-x[0].x)<1e-10&&Math.abs(N.y-x[0].y)<1e-10&&x.splice(x.length-1,1),t&&x.push(x[0]),x},K.Path.prototype.toShapes=function(e,t){function r(e){for(var t=[],r=0,n=e.length;r<n;r++){var i=e[r],o=new K.Shape;o.actions=i.actions,o.curves=i.curves,t.push(o)}return t}function n(e,t){for(var r=t.length,n=!1,i=r-1,o=0;o<r;i=o++){var a=t[i],s=t[o],l=s.x-a.x,u=s.y-a.y;if(Math.abs(u)>1e-10){if(u<0&&(a=t[o],l=-l,s=t[i],u=-u),e.y<a.y||e.y>s.y)continue;if(e.y==a.y){if(e.x==a.x)return!0}else{var c=u*(e.x-a.x)-l*(e.y-a.y);if(0==c)return!0;if(c<0)continue;n=!n}}else{if(e.y!=a.y)continue;if(s.x<=e.x&&e.x<=a.x||a.x<=e.x&&e.x<=s.x)return!0}}return n}var i=function(e){var t,r,n,i,o,a=[],s=new K.Path;for(t=0,r=e.length;t<r;t++)o=(n=e[t]).args,(i=n.action)==K.PathActions.MOVE_TO&&0!=s.actions.length&&(a.push(s),s=new K.Path),s[i].apply(s,o);return 0!=s.actions.length&&a.push(s),a}(this.actions);if(0==i.length)return[];if(!0===t)return r(i);var o,a,s,l=[];if(1==i.length)return a=i[0],(s=new K.Shape).actions=a.actions,s.curves=a.curves,l.push(s),l;var u=!K.Shape.Utils.isClockWise(i[0].getPoints());u=e?!u:u;var c,h,d,f,p,m,g=[],v=[],y=[],b=0;for(v[b]=void 0,y[b]=[],h=0,d=i.length;h<d;h++)c=(a=i[h]).getPoints(),o=K.Shape.Utils.isClockWise(c),(o=e?!o:o)?(!u&&v[b]&&b++,v[b]={s:new K.Shape,p:c},v[b].s.actions=a.actions,v[b].s.curves=a.curves,u&&b++,y[b]=[]):y[b].push({h:a,p:c[0]});if(!v[0])return r(i);if(v.length>1){for(var x=!1,_=[],E=0,w=v.length;E<w;E++)g[E]=[];for(E=0,w=v.length;E<w;E++)for(var A=y[E],S=0;S<A.length;S++){for(var M=A[S],T=!0,C=0;C<v.length;C++)n(M.p,v[C].p)&&(E!=C&&_.push({froms:E,tos:C,hole:S}),T?(T=!1,g[C].push(M)):x=!0);T&&g[E].push(M)}_.length>0&&(x||(y=g))}for(h=0,d=v.length;h<d;h++)for(s=v[h].s,l.push(s),p=0,m=(f=y[h]).length;p<m;p++)s.holes.push(f[p].h);return l},K.Shape=function(){K.Path.apply(this,arguments),this.holes=[]},K.Shape.prototype=Object.create(K.Path.prototype),K.Shape.prototype.constructor=K.Shape,K.Shape.prototype.extrude=function(e){return new K.ExtrudeGeometry(this,e)},K.Shape.prototype.makeGeometry=function(e){return new K.ShapeGeometry(this,e)},K.Shape.prototype.getPointsHoles=function(e){var t,r=this.holes.length,n=[];for(t=0;t<r;t++)n[t]=this.holes[t].getTransformedPoints(e,this.bends);return n},K.Shape.prototype.getSpacedPointsHoles=function(e){var t,r=this.holes.length,n=[];for(t=0;t<r;t++)n[t]=this.holes[t].getTransformedSpacedPoints(e,this.bends);return n},K.Shape.prototype.extractAllPoints=function(e){return{shape:this.getTransformedPoints(e),holes:this.getPointsHoles(e)}},K.Shape.prototype.extractPoints=function(e){return this.useSpacedPoints?this.extractAllSpacedPoints(e):this.extractAllPoints(e)},K.Shape.prototype.extractAllSpacedPoints=function(e){return{shape:this.getTransformedSpacedPoints(e),holes:this.getSpacedPointsHoles(e)}},K.Shape.Utils={triangulateShape:function(e,t){function r(e,t,r){return e.x!=t.x?e.x<t.x?e.x<=r.x&&r.x<=t.x:t.x<=r.x&&r.x<=e.x:e.y<t.y?e.y<=r.y&&r.y<=t.y:t.y<=r.y&&r.y<=e.y}function n(e,t,n,i,o){var a=t.x-e.x,s=t.y-e.y,l=i.x-n.x,u=i.y-n.y,c=e.x-n.x,h=e.y-n.y,d=s*l-a*u,f=s*c-a*h;if(Math.abs(d)>1e-10){var p;if(d>0){if(f<0||f>d)return[];if((p=u*c-l*h)<0||p>d)return[]}else{if(f>0||f<d)return[];if((p=u*c-l*h)>0||p<d)return[]}if(0==p)return!o||0!=f&&f!=d?[e]:[];if(p==d)return!o||0!=f&&f!=d?[t]:[];if(0==f)return[n];if(f==d)return[i];var m=p/d;return[{x:e.x+m*a,y:e.y+m*s}]}if(0!=f||u*c!=l*h)return[];var g,v,y,b,x,_,E,w,A=0==a&&0==s,S=0==l&&0==u;return A&&S?e.x!=n.x||e.y!=n.y?[]:[e]:A?r(n,i,e)?[e]:[]:S?r(e,t,n)?[n]:[]:(0!=a?(e.x<t.x?(g=e,y=e.x,v=t,b=t.x):(g=t,y=t.x,v=e,b=e.x),n.x<i.x?(x=n,E=n.x,_=i,w=i.x):(x=i,E=i.x,_=n,w=n.x)):(e.y<t.y?(g=e,y=e.y,v=t,b=t.y):(g=t,y=t.y,v=e,b=e.y),n.y<i.y?(x=n,E=n.y,_=i,w=i.y):(x=i,E=i.y,_=n,w=n.y)),y<=E?b<E?[]:b==E?o?[]:[x]:b<=w?[x,v]:[x,_]:y>w?[]:y==w?o?[]:[g]:b<=w?[g,v]:[g,_])}function i(e,t,r,n){var i=t.x-e.x,o=t.y-e.y,a=r.x-e.x,s=r.y-e.y,l=n.x-e.x,u=n.y-e.y,c=i*s-o*a,h=i*u-o*l;if(Math.abs(c)>1e-10){var d=l*s-u*a;return c>0?h>=0&&d>=0:h>=0||d>=0}return h>0}for(var o,a,s,l,u,c,h={},d=e.concat(),f=0,p=t.length;f<p;f++)Array.prototype.push.apply(d,t[f]);for(o=0,a=d.length;o<a;o++)void 0!==h[u=d[o].x+":"+d[o].y]&&K.warn("THREE.Shape: Duplicate point",u),h[u]=o;var m=function(e,t){var r,o=e.concat();function a(e,t){var n=o.length-1,a=e-1;a<0&&(a=n);var s=e+1;s>n&&(s=0);var l=i(o[e],o[a],o[s],r[t]);if(!l)return!1;var u=r.length-1,c=t-1;c<0&&(c=u);var h=t+1;return h>u&&(h=0),!!(l=i(r[t],r[c],r[h],o[e]))}function s(e,t){var r,i;for(r=0;r<o.length;r++)if(i=r+1,i%=o.length,n(e,t,o[r],o[i],!0).length>0)return!0;return!1}var l=[];function u(e,r){var i,o,a,s;for(i=0;i<l.length;i++)for(o=t[l[i]],a=0;a<o.length;a++)if(s=a+1,s%=o.length,n(e,r,o[a],o[s],!0).length>0)return!0;return!1}for(var c,h,d,f,p,m,g,v,y,b,x=[],_=0,E=t.length;_<E;_++)l.push(_);for(var w=0,A=2*l.length;l.length>0;){if(--A<0){console.log("Infinite Loop! Holes left:"+l.length+", Probably Hole outside Shape!");break}for(h=w;h<o.length;h++){d=o[h],c=-1;for(_=0;_<l.length;_++)if(p=l[_],void 0===x[m=d.x+":"+d.y+":"+p]){r=t[p];for(var S=0;S<r.length;S++)if(f=r[S],a(h,S)&&!s(d,f)&&!u(d,f)){c=S,l.splice(_,1),g=o.slice(0,h+1),v=o.slice(h),y=r.slice(c),b=r.slice(0,c+1),o=g.concat(y).concat(b).concat(v),w=h;break}if(c>=0)break;x[m]=!0}if(c>=0)break}}return o}(e,t),g=K.FontUtils.Triangulate(m,!1);for(o=0,a=g.length;o<a;o++)for(l=g[o],s=0;s<3;s++)void 0!==(c=h[u=l[s].x+":"+l[s].y])&&(l[s]=c);return g.concat()},isClockWise:function(e){return K.FontUtils.Triangulate.area(e)<0},b2p0:function(e,t){var r=1-e;return r*r*t},b2p1:function(e,t){return 2*(1-e)*e*t},b2p2:function(e,t){return e*e*t},b2:function(e,t,r,n){return this.b2p0(e,t)+this.b2p1(e,r)+this.b2p2(e,n)},b3p0:function(e,t){var r=1-e;return r*r*r*t},b3p1:function(e,t){var r=1-e;return 3*r*r*e*t},b3p2:function(e,t){return 3*(1-e)*e*e*t},b3p3:function(e,t){return e*e*e*t},b3:function(e,t,r,n,i){return this.b3p0(e,t)+this.b3p1(e,r)+this.b3p2(e,n)+this.b3p3(e,i)}},K.LineCurve=function(e,t){this.v1=e,this.v2=t},K.LineCurve.prototype=Object.create(K.Curve.prototype),K.LineCurve.prototype.constructor=K.LineCurve,K.LineCurve.prototype.getPoint=function(e){var t=this.v2.clone().sub(this.v1);return t.multiplyScalar(e).add(this.v1),t},K.LineCurve.prototype.getPointAt=function(e){return this.getPoint(e)},K.LineCurve.prototype.getTangent=function(e){return this.v2.clone().sub(this.v1).normalize()},K.QuadraticBezierCurve=function(e,t,r){this.v0=e,this.v1=t,this.v2=r},K.QuadraticBezierCurve.prototype=Object.create(K.Curve.prototype),K.QuadraticBezierCurve.prototype.constructor=K.QuadraticBezierCurve,K.QuadraticBezierCurve.prototype.getPoint=function(e){var t=new K.Vector2;return t.x=K.Shape.Utils.b2(e,this.v0.x,this.v1.x,this.v2.x),t.y=K.Shape.Utils.b2(e,this.v0.y,this.v1.y,this.v2.y),t},K.QuadraticBezierCurve.prototype.getTangent=function(e){var t=new K.Vector2;return t.x=K.Curve.Utils.tangentQuadraticBezier(e,this.v0.x,this.v1.x,this.v2.x),t.y=K.Curve.Utils.tangentQuadraticBezier(e,this.v0.y,this.v1.y,this.v2.y),t.normalize()},K.CubicBezierCurve=function(e,t,r,n){this.v0=e,this.v1=t,this.v2=r,this.v3=n},K.CubicBezierCurve.prototype=Object.create(K.Curve.prototype),K.CubicBezierCurve.prototype.constructor=K.CubicBezierCurve,K.CubicBezierCurve.prototype.getPoint=function(e){var t,r;return t=K.Shape.Utils.b3(e,this.v0.x,this.v1.x,this.v2.x,this.v3.x),r=K.Shape.Utils.b3(e,this.v0.y,this.v1.y,this.v2.y,this.v3.y),new K.Vector2(t,r)},K.CubicBezierCurve.prototype.getTangent=function(e){var t,r;t=K.Curve.Utils.tangentCubicBezier(e,this.v0.x,this.v1.x,this.v2.x,this.v3.x),r=K.Curve.Utils.tangentCubicBezier(e,this.v0.y,this.v1.y,this.v2.y,this.v3.y);var n=new K.Vector2(t,r);return n.normalize(),n},K.SplineCurve=function(e){this.points=null==e?[]:e},K.SplineCurve.prototype=Object.create(K.Curve.prototype),K.SplineCurve.prototype.constructor=K.SplineCurve,K.SplineCurve.prototype.getPoint=function(e){var t=this.points,r=(t.length-1)*e,n=Math.floor(r),i=r-n,o=t[0==n?n:n-1],a=t[n],s=t[n>t.length-2?t.length-1:n+1],l=t[n>t.length-3?t.length-1:n+2],u=new K.Vector2;return u.x=K.Curve.Utils.interpolate(o.x,a.x,s.x,l.x,i),u.y=K.Curve.Utils.interpolate(o.y,a.y,s.y,l.y,i),u},K.EllipseCurve=function(e,t,r,n,i,o,a){this.aX=e,this.aY=t,this.xRadius=r,this.yRadius=n,this.aStartAngle=i,this.aEndAngle=o,this.aClockwise=a},K.EllipseCurve.prototype=Object.create(K.Curve.prototype),K.EllipseCurve.prototype.constructor=K.EllipseCurve,K.EllipseCurve.prototype.getPoint=function(e){var t,r=this.aEndAngle-this.aStartAngle;r<0&&(r+=2*Math.PI),r>2*Math.PI&&(r-=2*Math.PI),t=!0===this.aClockwise?this.aEndAngle+(1-e)*(2*Math.PI-r):this.aStartAngle+e*r;var n=new K.Vector2;return n.x=this.aX+this.xRadius*Math.cos(t),n.y=this.aY+this.yRadius*Math.sin(t),n},K.ArcCurve=function(e,t,r,n,i,o){K.EllipseCurve.call(this,e,t,r,r,n,i,o)},K.ArcCurve.prototype=Object.create(K.EllipseCurve.prototype),K.ArcCurve.prototype.constructor=K.ArcCurve,K.LineCurve3=K.Curve.create((function(e,t){this.v1=e,this.v2=t}),(function(e){var t=new K.Vector3;return t.subVectors(this.v2,this.v1),t.multiplyScalar(e),t.add(this.v1),t})),K.QuadraticBezierCurve3=K.Curve.create((function(e,t,r){this.v0=e,this.v1=t,this.v2=r}),(function(e){var t=new K.Vector3;return t.x=K.Shape.Utils.b2(e,this.v0.x,this.v1.x,this.v2.x),t.y=K.Shape.Utils.b2(e,this.v0.y,this.v1.y,this.v2.y),t.z=K.Shape.Utils.b2(e,this.v0.z,this.v1.z,this.v2.z),t})),K.CubicBezierCurve3=K.Curve.create((function(e,t,r,n){this.v0=e,this.v1=t,this.v2=r,this.v3=n}),(function(e){var t=new K.Vector3;return t.x=K.Shape.Utils.b3(e,this.v0.x,this.v1.x,this.v2.x,this.v3.x),t.y=K.Shape.Utils.b3(e,this.v0.y,this.v1.y,this.v2.y,this.v3.y),t.z=K.Shape.Utils.b3(e,this.v0.z,this.v1.z,this.v2.z,this.v3.z),t})),K.SplineCurve3=K.Curve.create((function(e){this.points=null==e?[]:e}),(function(e){var t=this.points,r=(t.length-1)*e,n=Math.floor(r),i=r-n,o=t[0==n?n:n-1],a=t[n],s=t[n>t.length-2?t.length-1:n+1],l=t[n>t.length-3?t.length-1:n+2],u=new K.Vector3;return u.x=K.Curve.Utils.interpolate(o.x,a.x,s.x,l.x,i),u.y=K.Curve.Utils.interpolate(o.y,a.y,s.y,l.y,i),u.z=K.Curve.Utils.interpolate(o.z,a.z,s.z,l.z,i),u})),K.ClosedSplineCurve3=K.Curve.create((function(e){this.points=null==e?[]:e}),(function(e){var t=this.points,r=(t.length-0)*e,n=Math.floor(r),i=r-n,o=t[((n+=n>0?0:(Math.floor(Math.abs(n)/t.length)+1)*t.length)-1)%t.length],a=t[n%t.length],s=t[(n+1)%t.length],l=t[(n+2)%t.length],u=new K.Vector3;return u.x=K.Curve.Utils.interpolate(o.x,a.x,s.x,l.x,i),u.y=K.Curve.Utils.interpolate(o.y,a.y,s.y,l.y,i),u.z=K.Curve.Utils.interpolate(o.z,a.z,s.z,l.z,i),u})),K.AnimationHandler={LINEAR:0,CATMULLROM:1,CATMULLROM_FORWARD:2,add:function(){K.warn("THREE.AnimationHandler.add() has been deprecated.")},get:function(){K.warn("THREE.AnimationHandler.get() has been deprecated.")},remove:function(){K.warn("THREE.AnimationHandler.remove() has been deprecated.")},animations:[],init:function(e){if(!0===e.initialized)return e;for(var t=0;t<e.hierarchy.length;t++){for(var r=0;r<e.hierarchy[t].keys.length;r++)if(e.hierarchy[t].keys[r].time<0&&(e.hierarchy[t].keys[r].time=0),void 0!==e.hierarchy[t].keys[r].rot&&!(e.hierarchy[t].keys[r].rot instanceof K.Quaternion)){var n=e.hierarchy[t].keys[r].rot;e.hierarchy[t].keys[r].rot=(new K.Quaternion).fromArray(n)}if(e.hierarchy[t].keys.length&&void 0!==e.hierarchy[t].keys[0].morphTargets){var i={};for(r=0;r<e.hierarchy[t].keys.length;r++)for(var o=0;o<e.hierarchy[t].keys[r].morphTargets.length;o++){i[s=e.hierarchy[t].keys[r].morphTargets[o]]=-1}e.hierarchy[t].usedMorphTargets=i;for(r=0;r<e.hierarchy[t].keys.length;r++){var a={};for(var s in i){for(o=0;o<e.hierarchy[t].keys[r].morphTargets.length;o++)if(e.hierarchy[t].keys[r].morphTargets[o]===s){a[s]=e.hierarchy[t].keys[r].morphTargetsInfluences[o];break}o===e.hierarchy[t].keys[r].morphTargets.length&&(a[s]=0)}e.hierarchy[t].keys[r].morphTargetsInfluences=a}}for(r=1;r<e.hierarchy[t].keys.length;r++)e.hierarchy[t].keys[r].time===e.hierarchy[t].keys[r-1].time&&(e.hierarchy[t].keys.splice(r,1),r--);for(r=0;r<e.hierarchy[t].keys.length;r++)e.hierarchy[t].keys[r].index=r}return e.initialized=!0,e},parse:function(e){var t=[];if(e instanceof K.SkinnedMesh)for(var r=0;r<e.skeleton.bones.length;r++)t.push(e.skeleton.bones[r]);else!function e(t,r){r.push(t);for(var n=0;n<t.children.length;n++)e(t.children[n],r)}(e,t);return t},play:function(e){-1===this.animations.indexOf(e)&&this.animations.push(e)},stop:function(e){var t=this.animations.indexOf(e);-1!==t&&this.animations.splice(t,1)},update:function(e){for(var t=0;t<this.animations.length;t++)this.animations[t].resetBlendWeights();for(t=0;t<this.animations.length;t++)this.animations[t].update(e)}},K.Animation=function(e,t){this.root=e,this.data=K.AnimationHandler.init(t),this.hierarchy=K.AnimationHandler.parse(e),this.currentTime=0,this.timeScale=1,this.isPlaying=!1,this.loop=!0,this.weight=0,this.interpolationType=K.AnimationHandler.LINEAR},K.Animation.prototype={constructor:K.Animation,keyTypes:["pos","rot","scl"],play:function(e,t){this.currentTime=void 0!==e?e:0,this.weight=void 0!==t?t:1,this.isPlaying=!0,this.reset(),K.AnimationHandler.play(this)},stop:function(){this.isPlaying=!1,K.AnimationHandler.stop(this)},reset:function(){for(var e=0,t=this.hierarchy.length;e<t;e++){var r=this.hierarchy[e];void 0===r.animationCache&&(r.animationCache={animations:{},blending:{positionWeight:0,quaternionWeight:0,scaleWeight:0}});var n=this.data.name,i=r.animationCache.animations,o=i[n];void 0===o&&(o={prevKey:{pos:0,rot:0,scl:0},nextKey:{pos:0,rot:0,scl:0},originalMatrix:r.matrix},i[n]=o);for(var a=0;a<3;a++){for(var s=this.keyTypes[a],l=this.data.hierarchy[e].keys[0],u=this.getNextKeyWith(s,e,1);u.time<this.currentTime&&u.index>l.index;)l=u,u=this.getNextKeyWith(s,e,u.index+1);o.prevKey[s]=l,o.nextKey[s]=u}}},resetBlendWeights:function(){for(var e=0,t=this.hierarchy.length;e<t;e++){var r=this.hierarchy[e].animationCache;if(void 0!==r){var n=r.blending;n.positionWeight=0,n.quaternionWeight=0,n.scaleWeight=0}}},update:function(){var e=[],t=new K.Vector3,r=new K.Vector3,n=new K.Quaternion,i=function(e,t){var r,n,i,a,s,l,u,c,h,d=[],f=[];return i=(r=(e.length-1)*t)-(n=Math.floor(r)),d[0]=0===n?n:n-1,d[1]=n,d[2]=n>e.length-2?n:n+1,d[3]=n>e.length-3?n:n+2,l=e[d[0]],u=e[d[1]],c=e[d[2]],h=e[d[3]],s=i*(a=i*i),f[0]=o(l[0],u[0],c[0],h[0],i,a,s),f[1]=o(l[1],u[1],c[1],h[1],i,a,s),f[2]=o(l[2],u[2],c[2],h[2],i,a,s),f},o=function(e,t,r,n,i,o,a){var s=.5*(r-e),l=.5*(n-t);return(2*(t-r)+s+l)*a+(-3*(t-r)-2*s-l)*o+s*i+t};return function(o){if(!1!==this.isPlaying&&(this.currentTime+=o*this.timeScale,0!==this.weight)){var a=this.data.length;(this.currentTime>a||this.currentTime<0)&&(this.loop?(this.currentTime%=a,this.currentTime<0&&(this.currentTime+=a),this.reset()):this.stop());for(var s=0,l=this.hierarchy.length;s<l;s++)for(var u=this.hierarchy[s],c=u.animationCache.animations[this.data.name],h=u.animationCache.blending,d=0;d<3;d++){var f=this.keyTypes[d],p=c.prevKey[f],m=c.nextKey[f];if(this.timeScale>0&&m.time<=this.currentTime||this.timeScale<0&&p.time>=this.currentTime){for(p=this.data.hierarchy[s].keys[0],m=this.getNextKeyWith(f,s,1);m.time<this.currentTime&&m.index>p.index;)p=m,m=this.getNextKeyWith(f,s,m.index+1);c.prevKey[f]=p,c.nextKey[f]=m}var g=(this.currentTime-p.time)/(m.time-p.time),v=p[f],y=m[f];if(g<0&&(g=0),g>1&&(g=1),"pos"===f){if(this.interpolationType===K.AnimationHandler.LINEAR){r.x=v[0]+(y[0]-v[0])*g,r.y=v[1]+(y[1]-v[1])*g,r.z=v[2]+(y[2]-v[2])*g;var b=this.weight/(this.weight+h.positionWeight);u.position.lerp(r,b),h.positionWeight+=this.weight}else if(this.interpolationType===K.AnimationHandler.CATMULLROM||this.interpolationType===K.AnimationHandler.CATMULLROM_FORWARD){e[0]=this.getPrevKeyWith("pos",s,p.index-1).pos,e[1]=v,e[2]=y,e[3]=this.getNextKeyWith("pos",s,m.index+1).pos;var x=i(e,g=.33*g+.33);b=this.weight/(this.weight+h.positionWeight);h.positionWeight+=this.weight;var _=u.position;if(_.x=_.x+(x[0]-_.x)*b,_.y=_.y+(x[1]-_.y)*b,_.z=_.z+(x[2]-_.z)*b,this.interpolationType===K.AnimationHandler.CATMULLROM_FORWARD){var E=i(e,1.01*g);t.set(E[0],E[1],E[2]),t.sub(_),t.y=0,t.normalize();var w=Math.atan2(t.x,t.z);u.rotation.set(0,w,0)}}}else if("rot"===f)if(K.Quaternion.slerp(v,y,n,g),0===h.quaternionWeight)u.quaternion.copy(n),h.quaternionWeight=this.weight;else{b=this.weight/(this.weight+h.quaternionWeight);K.Quaternion.slerp(u.quaternion,n,u.quaternion,b),h.quaternionWeight+=this.weight}else if("scl"===f){r.x=v[0]+(y[0]-v[0])*g,r.y=v[1]+(y[1]-v[1])*g,r.z=v[2]+(y[2]-v[2])*g;b=this.weight/(this.weight+h.scaleWeight);u.scale.lerp(r,b),h.scaleWeight+=this.weight}}return!0}}}(),getNextKeyWith:function(e,t,r){var n=this.data.hierarchy[t].keys;for(this.interpolationType===K.AnimationHandler.CATMULLROM||this.interpolationType===K.AnimationHandler.CATMULLROM_FORWARD?r=r<n.length-1?r:n.length-1:r%=n.length;r<n.length;r++)if(void 0!==n[r][e])return n[r];return this.data.hierarchy[t].keys[0]},getPrevKeyWith:function(e,t,r){var n=this.data.hierarchy[t].keys;for(r=this.interpolationType===K.AnimationHandler.CATMULLROM||this.interpolationType===K.AnimationHandler.CATMULLROM_FORWARD?r>0?r:0:r>=0?r:r+n.length;r>=0;r--)if(void 0!==n[r][e])return n[r];return this.data.hierarchy[t].keys[n.length-1]}},K.KeyFrameAnimation=function(e){this.root=e.node,this.data=K.AnimationHandler.init(e),this.hierarchy=K.AnimationHandler.parse(this.root),this.currentTime=0,this.timeScale=.001,this.isPlaying=!1,this.isPaused=!0,this.loop=!0;for(var t=0,r=this.hierarchy.length;t<r;t++){var n=this.data.hierarchy[t].keys,i=this.data.hierarchy[t].sids,o=this.hierarchy[t];if(n.length&&i){for(var a=0;a<i.length;a++){var s=i[a],l=this.getNextKeyWith(s,t,0);l&&l.apply(s)}o.matrixAutoUpdate=!1,this.data.hierarchy[t].node.updateMatrix(),o.matrixWorldNeedsUpdate=!0}}},K.KeyFrameAnimation.prototype={constructor:K.KeyFrameAnimation,play:function(e){if(this.currentTime=void 0!==e?e:0,!1===this.isPlaying){this.isPlaying=!0;var t,r,n,i=this.hierarchy.length;for(t=0;t<i;t++){r=this.hierarchy[t],void 0===(n=this.data.hierarchy[t]).animationCache&&(n.animationCache={},n.animationCache.prevKey=null,n.animationCache.nextKey=null,n.animationCache.originalMatrix=r.matrix);var o=this.data.hierarchy[t].keys;o.length&&(n.animationCache.prevKey=o[0],n.animationCache.nextKey=o[1],this.startTime=Math.min(o[0].time,this.startTime),this.endTime=Math.max(o[o.length-1].time,this.endTime))}this.update(0)}this.isPaused=!1,K.AnimationHandler.play(this)},stop:function(){this.isPlaying=!1,this.isPaused=!1,K.AnimationHandler.stop(this);for(var e=0;e<this.data.hierarchy.length;e++){var t=this.hierarchy[e],r=this.data.hierarchy[e];if(void 0!==r.animationCache){var n=r.animationCache.originalMatrix;n.copy(t.matrix),t.matrix=n,delete r.animationCache}}},update:function(e){if(!1!==this.isPlaying){this.currentTime+=e*this.timeScale;var t=this.data.length;!0===this.loop&&this.currentTime>t&&(this.currentTime%=t),this.currentTime=Math.min(this.currentTime,t);for(var r=0,n=this.hierarchy.length;r<n;r++){var i=this.hierarchy[r],o=this.data.hierarchy[r],a=o.keys,s=o.animationCache;if(a.length){var l=s.prevKey,u=s.nextKey;if(u.time<=this.currentTime){for(;u.time<this.currentTime&&u.index>l.index;)u=a[(l=u).index+1];s.prevKey=l,s.nextKey=u}u.time>=this.currentTime?l.interpolate(u,this.currentTime):l.interpolate(u,u.time),this.data.hierarchy[r].node.updateMatrix(),i.matrixWorldNeedsUpdate=!0}}}},getNextKeyWith:function(e,t,r){var n=this.data.hierarchy[t].keys;for(r%=n.length;r<n.length;r++)if(n[r].hasTarget(e))return n[r];return n[0]},getPrevKeyWith:function(e,t,r){var n=this.data.hierarchy[t].keys;for(r=r>=0?r:r+n.length;r>=0;r--)if(n[r].hasTarget(e))return n[r];return n[n.length-1]}},K.MorphAnimation=function(e){this.mesh=e,this.frames=e.morphTargetInfluences.length,this.currentTime=0,this.duration=1e3,this.loop=!0,this.lastFrame=0,this.currentFrame=0,this.isPlaying=!1},K.MorphAnimation.prototype={constructor:K.MorphAnimation,play:function(){this.isPlaying=!0},pause:function(){this.isPlaying=!1},update:function(e){if(!1!==this.isPlaying){this.currentTime+=e,!0===this.loop&&this.currentTime>this.duration&&(this.currentTime%=this.duration),this.currentTime=Math.min(this.currentTime,this.duration);var t=this.duration/this.frames,r=Math.floor(this.currentTime/t),n=this.mesh.morphTargetInfluences;r!=this.currentFrame&&(n[this.lastFrame]=0,n[this.currentFrame]=1,n[r]=0,this.lastFrame=this.currentFrame,this.currentFrame=r),n[r]=this.currentTime%t/t,n[this.lastFrame]=1-n[r]}}},K.BoxGeometry=function(e,t,r,n,i,o){K.Geometry.call(this),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:r,widthSegments:n,heightSegments:i,depthSegments:o},this.widthSegments=n||1,this.heightSegments=i||1,this.depthSegments=o||1;var a=this,s=e/2,l=t/2,u=r/2;function c(e,t,r,n,i,o,s,l){var u,c,h,d=a.widthSegments,f=a.heightSegments,p=i/2,m=o/2,g=a.vertices.length;"x"===e&&"y"===t||"y"===e&&"x"===t?u="z":"x"===e&&"z"===t||"z"===e&&"x"===t?(u="y",f=a.depthSegments):("z"===e&&"y"===t||"y"===e&&"z"===t)&&(u="x",d=a.depthSegments);var v=d+1,y=f+1,b=i/d,x=o/f,_=new K.Vector3;for(_[u]=s>0?1:-1,h=0;h<y;h++)for(c=0;c<v;c++){var E=new K.Vector3;E[e]=(c*b-p)*r,E[t]=(h*x-m)*n,E[u]=s,a.vertices.push(E)}for(h=0;h<f;h++)for(c=0;c<d;c++){var w=c+v*h,A=c+v*(h+1),S=c+1+v*(h+1),M=c+1+v*h,T=new K.Vector2(c/d,1-h/f),C=new K.Vector2(c/d,1-(h+1)/f),P=new K.Vector2((c+1)/d,1-(h+1)/f),D=new K.Vector2((c+1)/d,1-h/f),L=new K.Face3(w+g,A+g,M+g);L.normal.copy(_),L.vertexNormals.push(_.clone(),_.clone(),_.clone()),L.materialIndex=l,a.faces.push(L),a.faceVertexUvs[0].push([T,C,D]),(L=new K.Face3(A+g,S+g,M+g)).normal.copy(_),L.vertexNormals.push(_.clone(),_.clone(),_.clone()),L.materialIndex=l,a.faces.push(L),a.faceVertexUvs[0].push([C.clone(),P,D.clone()])}}c("z","y",-1,-1,r,t,s,0),c("z","y",1,-1,r,t,-s,1),c("x","z",1,1,e,r,l,2),c("x","z",1,-1,e,r,-l,3),c("x","y",1,-1,e,t,u,4),c("x","y",-1,-1,e,t,-u,5),this.mergeVertices()},K.BoxGeometry.prototype=Object.create(K.Geometry.prototype),K.BoxGeometry.prototype.constructor=K.BoxGeometry,K.CircleGeometry=function(e,t,r,n){K.Geometry.call(this),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:r,thetaLength:n},e=e||50,t=void 0!==t?Math.max(3,t):8,r=void 0!==r?r:0,n=void 0!==n?n:2*Math.PI;var i,o=[],a=new K.Vector3,s=new K.Vector2(.5,.5);for(this.vertices.push(a),o.push(s),i=0;i<=t;i++){var l=new K.Vector3,u=r+i/t*n;l.x=e*Math.cos(u),l.y=e*Math.sin(u),this.vertices.push(l),o.push(new K.Vector2((l.x/e+1)/2,(l.y/e+1)/2))}var c=new K.Vector3(0,0,1);for(i=1;i<=t;i++)this.faces.push(new K.Face3(i,i+1,0,[c.clone(),c.clone(),c.clone()])),this.faceVertexUvs[0].push([o[i].clone(),o[i+1].clone(),s.clone()]);this.computeFaceNormals(),this.boundingSphere=new K.Sphere(new K.Vector3,e)},K.CircleGeometry.prototype=Object.create(K.Geometry.prototype),K.CircleGeometry.prototype.constructor=K.CircleGeometry,K.CubeGeometry=function(e,t,r,n,i,o){return K.warn("THREE.CubeGeometry has been renamed to THREE.BoxGeometry."),new K.BoxGeometry(e,t,r,n,i,o)},K.CylinderGeometry=function(e,t,r,n,i,o,a,s){K.Geometry.call(this),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:r,radialSegments:n,heightSegments:i,openEnded:o,thetaStart:a,thetaLength:s},e=void 0!==e?e:20,t=void 0!==t?t:20,r=void 0!==r?r:100,n=n||8,i=i||1,o=void 0!==o&&o,a=void 0!==a?a:0,s=void 0!==s?s:2*Math.PI;var l,u,c=r/2,h=[],d=[];for(u=0;u<=i;u++){var f=[],p=[],m=u/i,g=m*(t-e)+e;for(l=0;l<=n;l++){var v=l/n,y=new K.Vector3;y.x=g*Math.sin(v*s+a),y.y=-m*r+c,y.z=g*Math.cos(v*s+a),this.vertices.push(y),f.push(this.vertices.length-1),p.push(new K.Vector2(v,1-m))}h.push(f),d.push(p)}var b,x,_=(t-e)/r;for(l=0;l<n;l++)for(0!==e?(b=this.vertices[h[0][l]].clone(),x=this.vertices[h[0][l+1]].clone()):(b=this.vertices[h[1][l]].clone(),x=this.vertices[h[1][l+1]].clone()),b.setY(Math.sqrt(b.x*b.x+b.z*b.z)*_).normalize(),x.setY(Math.sqrt(x.x*x.x+x.z*x.z)*_).normalize(),u=0;u<i;u++){var E=h[u][l],w=h[u+1][l],A=h[u+1][l+1],S=h[u][l+1],M=b.clone(),T=b.clone(),C=x.clone(),P=x.clone(),D=d[u][l].clone(),L=d[u+1][l].clone(),R=d[u+1][l+1].clone(),I=d[u][l+1].clone();this.faces.push(new K.Face3(E,w,S,[M,T,P])),this.faceVertexUvs[0].push([D,L,I]),this.faces.push(new K.Face3(w,A,S,[T.clone(),C,P.clone()])),this.faceVertexUvs[0].push([L.clone(),R,I.clone()])}if(!1===o&&e>0)for(this.vertices.push(new K.Vector3(0,c,0)),l=0;l<n;l++){E=h[0][l],w=h[0][l+1],A=this.vertices.length-1,M=new K.Vector3(0,1,0),T=new K.Vector3(0,1,0),C=new K.Vector3(0,1,0),D=d[0][l].clone(),L=d[0][l+1].clone(),R=new K.Vector2(L.x,0);this.faces.push(new K.Face3(E,w,A,[M,T,C])),this.faceVertexUvs[0].push([D,L,R])}if(!1===o&&t>0)for(this.vertices.push(new K.Vector3(0,-c,0)),l=0;l<n;l++){E=h[i][l+1],w=h[i][l],A=this.vertices.length-1,M=new K.Vector3(0,-1,0),T=new K.Vector3(0,-1,0),C=new K.Vector3(0,-1,0),D=d[i][l+1].clone(),L=d[i][l].clone(),R=new K.Vector2(L.x,1);this.faces.push(new K.Face3(E,w,A,[M,T,C])),this.faceVertexUvs[0].push([D,L,R])}this.computeFaceNormals()},K.CylinderGeometry.prototype=Object.create(K.Geometry.prototype),K.CylinderGeometry.prototype.constructor=K.CylinderGeometry,K.ExtrudeGeometry=function(e,t){void 0!==e?(K.Geometry.call(this),this.type="ExtrudeGeometry",e=e instanceof Array?e:[e],this.addShapeList(e,t),this.computeFaceNormals()):e=[]},K.ExtrudeGeometry.prototype=Object.create(K.Geometry.prototype),K.ExtrudeGeometry.prototype.constructor=K.ExtrudeGeometry,K.ExtrudeGeometry.prototype.addShapeList=function(e,t){for(var r=e.length,n=0;n<r;n++){var i=e[n];this.addShape(i,t)}},K.ExtrudeGeometry.prototype.addShape=function(e,t){var r,n,i,o,a,s,l,u,c=void 0!==t.amount?t.amount:100,h=void 0!==t.bevelThickness?t.bevelThickness:6,d=void 0!==t.bevelSize?t.bevelSize:h-2,f=void 0!==t.bevelSegments?t.bevelSegments:3,p=void 0===t.bevelEnabled||t.bevelEnabled,m=void 0!==t.curveSegments?t.curveSegments:12,g=void 0!==t.steps?t.steps:1,v=t.extrudePath,y=!1,b=t.material,x=t.extrudeMaterial,_=void 0!==t.UVGenerator?t.UVGenerator:K.ExtrudeGeometry.WorldUVGenerator;v&&(r=v.getSpacedPoints(g),y=!0,p=!1,n=void 0!==t.frames?t.frames:new K.TubeGeometry.FrenetFrames(v,g,!1),i=new K.Vector3,o=new K.Vector3,a=new K.Vector3),p||(f=0,h=0,d=0);var E=this,w=this.vertices.length,A=e.extractPoints(m),S=A.shape,M=A.holes,T=!K.Shape.Utils.isClockWise(S);if(T){for(S=S.reverse(),l=0,u=M.length;l<u;l++)s=M[l],K.Shape.Utils.isClockWise(s)&&(M[l]=s.reverse());T=!1}var C=K.Shape.Utils.triangulateShape(S,M),P=S;for(l=0,u=M.length;l<u;l++)s=M[l],S=S.concat(s);function D(e,t,r){return t||K.error("THREE.ExtrudeGeometry: vec does not exist"),t.clone().multiplyScalar(r).add(e)}var L,R,I,O,N,k,F=S.length,V=C.length;function U(e,t,r){var n,i,o=1e-10,a=1,s=e.x-t.x,l=e.y-t.y,u=r.x-e.x,c=r.y-e.y,h=s*s+l*l,d=s*c-l*u;if(Math.abs(d)>o){var f=Math.sqrt(h),p=Math.sqrt(u*u+c*c),m=t.x-l/f,g=t.y+s/f,v=((r.x-c/p-m)*c-(r.y+u/p-g)*u)/(s*c-l*u),y=(n=m+s*v-e.x)*n+(i=g+l*v-e.y)*i;if(y<=2)return new K.Vector2(n,i);a=Math.sqrt(y/2)}else{var b=!1;s>o?u>o&&(b=!0):s<-1e-10?u<-1e-10&&(b=!0):Math.sign(l)==Math.sign(c)&&(b=!0),b?(n=-l,i=s,a=Math.sqrt(h)):(n=s,i=l,a=Math.sqrt(h/2))}return new K.Vector2(n/a,i/a)}for(var B=[],z=0,G=P.length,H=G-1,W=z+1;z<G;z++,H++,W++)H===G&&(H=0),W===G&&(W=0),B[z]=U(P[z],P[H],P[W]);var j,q,X=[],Y=B.concat();for(l=0,u=M.length;l<u;l++){for(s=M[l],j=[],z=0,H=(G=s.length)-1,W=z+1;z<G;z++,H++,W++)H===G&&(H=0),W===G&&(W=0),j[z]=U(s[z],s[H],s[W]);X.push(j),Y=Y.concat(j)}for(L=0;L<f;L++){for(O=h*(1-(I=L/f)),R=d*Math.sin(I*Math.PI/2),z=0,G=P.length;z<G;z++)Q((N=D(P[z],B[z],R)).x,N.y,-O);for(l=0,u=M.length;l<u;l++)for(s=M[l],j=X[l],z=0,G=s.length;z<G;z++)Q((N=D(s[z],j[z],R)).x,N.y,-O)}for(R=d,z=0;z<F;z++)N=p?D(S[z],Y[z],R):S[z],y?(o.copy(n.normals[0]).multiplyScalar(N.x),i.copy(n.binormals[0]).multiplyScalar(N.y),a.copy(r[0]).add(o).add(i),Q(a.x,a.y,a.z)):Q(N.x,N.y,0);for(q=1;q<=g;q++)for(z=0;z<F;z++)N=p?D(S[z],Y[z],R):S[z],y?(o.copy(n.normals[q]).multiplyScalar(N.x),i.copy(n.binormals[q]).multiplyScalar(N.y),a.copy(r[q]).add(o).add(i),Q(a.x,a.y,a.z)):Q(N.x,N.y,c/g*q);for(L=f-1;L>=0;L--){for(O=h*(1-(I=L/f)),R=d*Math.sin(I*Math.PI/2),z=0,G=P.length;z<G;z++)Q((N=D(P[z],B[z],R)).x,N.y,c+O);for(l=0,u=M.length;l<u;l++)for(s=M[l],j=X[l],z=0,G=s.length;z<G;z++)N=D(s[z],j[z],R),y?Q(N.x,N.y+r[g-1].y,r[g-1].x+O):Q(N.x,N.y,c+O)}function Z(e,t){var r,n;for(z=e.length;--z>=0;){r=z,(n=z-1)<0&&(n=e.length-1);var i=0,o=g+2*f;for(i=0;i<o;i++){var a=F*i,s=F*(i+1);$(t+r+a,t+n+a,t+n+s,t+r+s,e,i,o,r,n)}}}function Q(e,t,r){E.vertices.push(new K.Vector3(e,t,r))}function J(e,t,r){e+=w,t+=w,r+=w,E.faces.push(new K.Face3(e,t,r,null,null,b));var n=_.generateTopUV(E,e,t,r);E.faceVertexUvs[0].push(n)}function $(e,t,r,n,i,o,a,s,l){e+=w,t+=w,r+=w,n+=w,E.faces.push(new K.Face3(e,t,n,null,null,x)),E.faces.push(new K.Face3(t,r,n,null,null,x));var u=_.generateSideWallUV(E,e,t,r,n);E.faceVertexUvs[0].push([u[0],u[1],u[3]]),E.faceVertexUvs[0].push([u[1],u[2],u[3]])}!function(){if(p){var e=0,t=F*e;for(z=0;z<V;z++)J((k=C[z])[2]+t,k[1]+t,k[0]+t);for(t=F*(e=g+2*f),z=0;z<V;z++)J((k=C[z])[0]+t,k[1]+t,k[2]+t)}else{for(z=0;z<V;z++)J((k=C[z])[2],k[1],k[0]);for(z=0;z<V;z++)J((k=C[z])[0]+F*g,k[1]+F*g,k[2]+F*g)}}(),function(){var e=0;for(Z(P,e),e+=P.length,l=0,u=M.length;l<u;l++)Z(s=M[l],e),e+=s.length}()},K.ExtrudeGeometry.WorldUVGenerator={generateTopUV:function(e,t,r,n){var i=e.vertices,o=i[t],a=i[r],s=i[n];return[new K.Vector2(o.x,o.y),new K.Vector2(a.x,a.y),new K.Vector2(s.x,s.y)]},generateSideWallUV:function(e,t,r,n,i){var o=e.vertices,a=o[t],s=o[r],l=o[n],u=o[i];return Math.abs(a.y-s.y)<.01?[new K.Vector2(a.x,1-a.z),new K.Vector2(s.x,1-s.z),new K.Vector2(l.x,1-l.z),new K.Vector2(u.x,1-u.z)]:[new K.Vector2(a.y,1-a.z),new K.Vector2(s.y,1-s.z),new K.Vector2(l.y,1-l.z),new K.Vector2(u.y,1-u.z)]}},K.ShapeGeometry=function(e,t){K.Geometry.call(this),this.type="ShapeGeometry",e instanceof Array==!1&&(e=[e]),this.addShapeList(e,t),this.computeFaceNormals()},K.ShapeGeometry.prototype=Object.create(K.Geometry.prototype),K.ShapeGeometry.prototype.constructor=K.ShapeGeometry,K.ShapeGeometry.prototype.addShapeList=function(e,t){for(var r=0,n=e.length;r<n;r++)this.addShape(e[r],t);return this},K.ShapeGeometry.prototype.addShape=function(e,t){void 0===t&&(t={});var r,n,i,o=void 0!==t.curveSegments?t.curveSegments:12,a=t.material,s=void 0===t.UVGenerator?K.ExtrudeGeometry.WorldUVGenerator:t.UVGenerator,l=this.vertices.length,u=e.extractPoints(o),c=u.shape,h=u.holes,d=!K.Shape.Utils.isClockWise(c);if(d){for(c=c.reverse(),r=0,n=h.length;r<n;r++)i=h[r],K.Shape.Utils.isClockWise(i)&&(h[r]=i.reverse());d=!1}var f=K.Shape.Utils.triangulateShape(c,h);for(r=0,n=h.length;r<n;r++)i=h[r],c=c.concat(i);var p,m,g=c.length,v=f.length;for(r=0;r<g;r++)p=c[r],this.vertices.push(new K.Vector3(p.x,p.y,0));for(r=0;r<v;r++){var y=(m=f[r])[0]+l,b=m[1]+l,x=m[2]+l;this.faces.push(new K.Face3(y,b,x,null,null,a)),this.faceVertexUvs[0].push(s.generateTopUV(this,y,b,x))}},K.LatheGeometry=function(e,t,r,n){K.Geometry.call(this),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:r,phiLength:n},t=t||12,r=r||0,n=n||2*Math.PI;for(var i=1/(e.length-1),o=1/t,a=0,s=t;a<=s;a++)for(var l=r+a*o*n,u=Math.cos(l),c=Math.sin(l),h=0,d=e.length;h<d;h++){var f=e[h],p=new K.Vector3;p.x=u*f.x-c*f.y,p.y=c*f.x+u*f.y,p.z=f.z,this.vertices.push(p)}var m=e.length;for(a=0,s=t;a<s;a++)for(h=0,d=e.length-1;h<d;h++){var g=h+m*a,v=g,y=g+m,b=(u=g+1+m,g+1),x=a*o,_=h*i,E=x+o,w=_+i;this.faces.push(new K.Face3(v,y,b)),this.faceVertexUvs[0].push([new K.Vector2(x,_),new K.Vector2(E,_),new K.Vector2(x,w)]),this.faces.push(new K.Face3(y,u,b)),this.faceVertexUvs[0].push([new K.Vector2(E,_),new K.Vector2(E,w),new K.Vector2(x,w)])}this.mergeVertices(),this.computeFaceNormals(),this.computeVertexNormals()},K.LatheGeometry.prototype=Object.create(K.Geometry.prototype),K.LatheGeometry.prototype.constructor=K.LatheGeometry,K.PlaneGeometry=function(e,t,r,n){console.info("THREE.PlaneGeometry: Consider using THREE.PlaneBufferGeometry for lower memory footprint."),K.Geometry.call(this),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:r,heightSegments:n},this.fromBufferGeometry(new K.PlaneBufferGeometry(e,t,r,n))},K.PlaneGeometry.prototype=Object.create(K.Geometry.prototype),K.PlaneGeometry.prototype.constructor=K.PlaneGeometry,K.PlaneBufferGeometry=function(e,t,r,n){K.BufferGeometry.call(this),this.type="PlaneBufferGeometry",this.parameters={width:e,height:t,widthSegments:r,heightSegments:n};for(var i=e/2,o=t/2,a=r||1,s=n||1,l=a+1,u=s+1,c=e/a,h=t/s,d=new Float32Array(l*u*3),f=new Float32Array(l*u*3),p=new Float32Array(l*u*2),m=0,g=0,v=0;v<u;v++)for(var y=v*h-o,b=0;b<l;b++){var x=b*c-i;d[m]=x,d[m+1]=-y,f[m+2]=1,p[g]=b/a,p[g+1]=1-v/s,m+=3,g+=2}m=0;var _=new(d.length/3>65535?Uint32Array:Uint16Array)(a*s*6);for(v=0;v<s;v++)for(b=0;b<a;b++){var E=b+l*v,w=b+l*(v+1),A=b+1+l*(v+1),S=b+1+l*v;_[m]=E,_[m+1]=w,_[m+2]=S,_[m+3]=w,_[m+4]=A,_[m+5]=S,m+=6}this.setAttribute("index",new K.BufferAttribute(_,1)),this.setAttribute("position",new K.BufferAttribute(d,3)),this.setAttribute("normal",new K.BufferAttribute(f,3)),this.setAttribute("uv",new K.BufferAttribute(p,2))},K.PlaneBufferGeometry.prototype=Object.create(K.BufferGeometry.prototype),K.PlaneBufferGeometry.prototype.constructor=K.PlaneBufferGeometry,K.RingGeometry=function(e,t,r,n,i,o){K.Geometry.call(this),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:r,phiSegments:n,thetaStart:i,thetaLength:o},e=e||0,t=t||50,i=void 0!==i?i:0,o=void 0!==o?o:2*Math.PI,r=void 0!==r?Math.max(3,r):8;var a,s,l=[],u=e,c=(t-e)/(n=void 0!==n?Math.max(1,n):8);for(a=0;a<n+1;a++){for(s=0;s<r+1;s++){var h=new K.Vector3,d=i+s/r*o;h.x=u*Math.cos(d),h.y=u*Math.sin(d),this.vertices.push(h),l.push(new K.Vector2((h.x/t+1)/2,(h.y/t+1)/2))}u+=c}var f=new K.Vector3(0,0,1);for(a=0;a<n;a++){var p=a*(r+1);for(s=0;s<r;s++){var m=d=s+p,g=d+r+1,v=d+r+2;this.faces.push(new K.Face3(m,g,v,[f.clone(),f.clone(),f.clone()])),this.faceVertexUvs[0].push([l[m].clone(),l[g].clone(),l[v].clone()]),m=d,g=d+r+2,v=d+1,this.faces.push(new K.Face3(m,g,v,[f.clone(),f.clone(),f.clone()])),this.faceVertexUvs[0].push([l[m].clone(),l[g].clone(),l[v].clone()])}}this.computeFaceNormals(),this.boundingSphere=new K.Sphere(new K.Vector3,u)},K.RingGeometry.prototype=Object.create(K.Geometry.prototype),K.RingGeometry.prototype.constructor=K.RingGeometry,K.SphereGeometry=function(e,t,r,n,i,o,a){K.Geometry.call(this),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:r,phiStart:n,phiLength:i,thetaStart:o,thetaLength:a},e=e||50,t=Math.max(3,Math.floor(t)||8),r=Math.max(2,Math.floor(r)||6),n=void 0!==n?n:0,i=void 0!==i?i:2*Math.PI,o=void 0!==o?o:0,a=void 0!==a?a:Math.PI;var s,l,u=[],c=[];for(l=0;l<=r;l++){var h=[],d=[];for(s=0;s<=t;s++){var f=s/t,p=l/r,m=new K.Vector3;m.x=-e*Math.cos(n+f*i)*Math.sin(o+p*a),m.y=e*Math.cos(o+p*a),m.z=e*Math.sin(n+f*i)*Math.sin(o+p*a),this.vertices.push(m),h.push(this.vertices.length-1),d.push(new K.Vector2(f,1-p))}u.push(h),c.push(d)}for(l=0;l<r;l++)for(s=0;s<t;s++){var g=u[l][s+1],v=u[l][s],y=u[l+1][s],b=u[l+1][s+1],x=this.vertices[g].clone().normalize(),_=this.vertices[v].clone().normalize(),E=this.vertices[y].clone().normalize(),w=this.vertices[b].clone().normalize(),A=c[l][s+1].clone(),S=c[l][s].clone(),M=c[l+1][s].clone(),T=c[l+1][s+1].clone();Math.abs(this.vertices[g].y)===e?(A.x=(A.x+S.x)/2,this.faces.push(new K.Face3(g,y,b,[x,E,w])),this.faceVertexUvs[0].push([A,M,T])):Math.abs(this.vertices[y].y)===e?(M.x=(M.x+T.x)/2,this.faces.push(new K.Face3(g,v,y,[x,_,E])),this.faceVertexUvs[0].push([A,S,M])):(this.faces.push(new K.Face3(g,v,b,[x,_,w])),this.faceVertexUvs[0].push([A,S,T]),this.faces.push(new K.Face3(v,y,b,[_.clone(),E,w.clone()])),this.faceVertexUvs[0].push([S.clone(),M,T.clone()]))}this.computeFaceNormals(),this.boundingSphere=new K.Sphere(new K.Vector3,e)},K.SphereGeometry.prototype=Object.create(K.Geometry.prototype),K.SphereGeometry.prototype.constructor=K.SphereGeometry,K.TextGeometry=function(e,t){t=t||{};var r=K.FontUtils.generateShapes(e,t);t.amount=void 0!==t.height?t.height:50,void 0===t.bevelThickness&&(t.bevelThickness=10),void 0===t.bevelSize&&(t.bevelSize=8),void 0===t.bevelEnabled&&(t.bevelEnabled=!1),K.ExtrudeGeometry.call(this,r,t),this.type="TextGeometry"},K.TextGeometry.prototype=Object.create(K.ExtrudeGeometry.prototype),K.TextGeometry.prototype.constructor=K.TextGeometry,K.TorusGeometry=function(e,t,r,n,i){K.Geometry.call(this),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:r,tubularSegments:n,arc:i},e=e||100,t=t||40,r=r||8,n=n||6,i=i||2*Math.PI;for(var o=new K.Vector3,a=[],s=[],l=0;l<=r;l++)for(var u=0;u<=n;u++){var c=u/n*i,h=l/r*Math.PI*2;o.x=e*Math.cos(c),o.y=e*Math.sin(c);var d=new K.Vector3;d.x=(e+t*Math.cos(h))*Math.cos(c),d.y=(e+t*Math.cos(h))*Math.sin(c),d.z=t*Math.sin(h),this.vertices.push(d),a.push(new K.Vector2(u/n,l/r)),s.push(d.clone().sub(o).normalize())}for(l=1;l<=r;l++)for(u=1;u<=n;u++){var f=(n+1)*l+u-1,p=(n+1)*(l-1)+u-1,m=(n+1)*(l-1)+u,g=(n+1)*l+u,v=new K.Face3(f,p,g,[s[f].clone(),s[p].clone(),s[g].clone()]);this.faces.push(v),this.faceVertexUvs[0].push([a[f].clone(),a[p].clone(),a[g].clone()]),v=new K.Face3(p,m,g,[s[p].clone(),s[m].clone(),s[g].clone()]),this.faces.push(v),this.faceVertexUvs[0].push([a[p].clone(),a[m].clone(),a[g].clone()])}this.computeFaceNormals()},K.TorusGeometry.prototype=Object.create(K.Geometry.prototype),K.TorusGeometry.prototype.constructor=K.TorusGeometry,K.TorusKnotGeometry=function(e,t,r,n,i,o,a){K.Geometry.call(this),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,radialSegments:r,tubularSegments:n,p:i,q:o,heightScale:a},e=e||100,t=t||40,r=r||64,n=n||8,i=i||2,o=o||3,a=a||1;for(var s=new Array(r),l=new K.Vector3,u=new K.Vector3,c=new K.Vector3,h=0;h<r;++h){s[h]=new Array(n);var d=h/r*2*i*Math.PI,f=D(d,o,i,e,a),p=D(d+.01,o,i,e,a);l.subVectors(p,f),u.addVectors(p,f),c.crossVectors(l,u),u.crossVectors(c,l),c.normalize(),u.normalize();for(var m=0;m<n;++m){var g=m/n*2*Math.PI,v=-t*Math.cos(g),y=t*Math.sin(g),b=new K.Vector3;b.x=f.x+v*u.x+y*c.x,b.y=f.y+v*u.y+y*c.y,b.z=f.z+v*u.z+y*c.z,s[h][m]=this.vertices.push(b)-1}}for(h=0;h<r;++h)for(m=0;m<n;++m){var x=(h+1)%r,_=(m+1)%n,E=s[h][m],w=s[x][m],A=s[x][_],S=s[h][_],M=new K.Vector2(h/r,m/n),T=new K.Vector2((h+1)/r,m/n),C=new K.Vector2((h+1)/r,(m+1)/n),P=new K.Vector2(h/r,(m+1)/n);this.faces.push(new K.Face3(E,w,S)),this.faceVertexUvs[0].push([M,T,P]),this.faces.push(new K.Face3(w,A,S)),this.faceVertexUvs[0].push([T.clone(),C,P.clone()])}function D(e,t,r,n,i){var o=Math.cos(e),a=Math.sin(e),s=t/r*e,l=Math.cos(s),u=n*(2+l)*.5*o,c=n*(2+l)*a*.5,h=i*n*Math.sin(s)*.5;return new K.Vector3(u,c,h)}this.computeFaceNormals(),this.computeVertexNormals()},K.TorusKnotGeometry.prototype=Object.create(K.Geometry.prototype),K.TorusKnotGeometry.prototype.constructor=K.TorusKnotGeometry,K.TubeGeometry=function(e,t,r,n,i,o){K.Geometry.call(this),this.type="TubeGeometry",this.parameters={path:e,segments:t,radius:r,radialSegments:n,closed:i},t=t||64,r=r||1,n=n||8,i=i||!1,o=o||K.TubeGeometry.NoTaper;var a,s,l,u,c,h,d,f,p,m,g,v,y,b,x,_,E,w,A,S,M=[],T=this,C=t+1,P=new K.Vector3,D=new K.TubeGeometry.FrenetFrames(e,t,i),L=D.tangents,R=D.normals,I=D.binormals;function O(e,t,r){return T.vertices.push(new K.Vector3(e,t,r))-1}for(this.tangents=L,this.normals=R,this.binormals=I,p=0;p<C;p++)for(M[p]=[],l=p/(C-1),f=e.getPointAt(l),L[p],a=R[p],s=I[p],c=r*o(l),m=0;m<n;m++)u=m/n*2*Math.PI,h=-c*Math.cos(u),d=c*Math.sin(u),P.copy(f),P.x+=h*a.x+d*s.x,P.y+=h*a.y+d*s.y,P.z+=h*a.z+d*s.z,M[p][m]=O(P.x,P.y,P.z);for(p=0;p<t;p++)for(m=0;m<n;m++)g=i?(p+1)%t:p+1,v=(m+1)%n,y=M[p][m],b=M[g][m],x=M[g][v],_=M[p][v],E=new K.Vector2(p/t,m/n),w=new K.Vector2((p+1)/t,m/n),A=new K.Vector2((p+1)/t,(m+1)/n),S=new K.Vector2(p/t,(m+1)/n),this.faces.push(new K.Face3(y,b,_)),this.faceVertexUvs[0].push([E,w,S]),this.faces.push(new K.Face3(b,x,_)),this.faceVertexUvs[0].push([w.clone(),A,S.clone()]);this.computeFaceNormals(),this.computeVertexNormals()},K.TubeGeometry.prototype=Object.create(K.Geometry.prototype),K.TubeGeometry.prototype.constructor=K.TubeGeometry,K.TubeGeometry.NoTaper=function(e){return 1},K.TubeGeometry.SinusoidalTaper=function(e){return Math.sin(Math.PI*e)},K.TubeGeometry.FrenetFrames=function(e,t,r){var n,i,o,a,s,l,u,c=new K.Vector3,h=[],d=[],f=[],p=new K.Vector3,m=new K.Matrix4,g=t+1;for(this.tangents=h,this.normals=d,this.binormals=f,l=0;l<g;l++)u=l/(g-1),h[l]=e.getTangentAt(u),h[l].normalize();for(function(){d[0]=new K.Vector3,f[0]=new K.Vector3,i=Number.MAX_VALUE,o=Math.abs(h[0].x),a=Math.abs(h[0].y),s=Math.abs(h[0].z),o<=i&&(i=o,c.set(1,0,0));a<=i&&(i=a,c.set(0,1,0));s<=i&&c.set(0,0,1);p.crossVectors(h[0],c).normalize(),d[0].crossVectors(h[0],p),f[0].crossVectors(h[0],d[0])}(),l=1;l<g;l++)d[l]=d[l-1].clone(),f[l]=f[l-1].clone(),p.crossVectors(h[l-1],h[l]),p.length()>1e-4&&(p.normalize(),n=Math.acos(K.Math.clamp(h[l-1].dot(h[l]),-1,1)),d[l].applyMatrix4(m.makeRotationAxis(p,n))),f[l].crossVectors(h[l],d[l]);if(r)for(n=Math.acos(K.Math.clamp(d[0].dot(d[g-1]),-1,1)),n/=g-1,h[0].dot(p.crossVectors(d[0],d[g-1]))>0&&(n=-n),l=1;l<g;l++)d[l].applyMatrix4(m.makeRotationAxis(h[l],n*l)),f[l].crossVectors(h[l],d[l])},K.PolyhedronGeometry=function(e,t,r,n){K.Geometry.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:r,detail:n},r=r||1,n=n||0;for(var i=this,o=0,a=e.length;o<a;o+=3)x(new K.Vector3(e[o],e[o+1],e[o+2]));var s=this.vertices,l=[],u=(o=0,0);for(a=t.length;o<a;o+=3,u++){var c=s[t[o]],h=s[t[o+1]],d=s[t[o+2]];l[u]=new K.Face3(c.index,h.index,d.index,[c.clone(),h.clone(),d.clone()])}var f=new K.Vector3;for(o=0,a=l.length;o<a;o++)E(l[o],n);for(o=0,a=this.faceVertexUvs[0].length;o<a;o++){var p=this.faceVertexUvs[0][o],m=p[0].x,g=p[1].x,v=p[2].x,y=Math.max(m,Math.max(g,v)),b=Math.min(m,Math.min(g,v));y>.9&&b<.1&&(m<.2&&(p[0].x+=1),g<.2&&(p[1].x+=1),v<.2&&(p[2].x+=1))}for(o=0,a=this.vertices.length;o<a;o++)this.vertices[o].multiplyScalar(r);function x(e){var t=e.normalize().clone();t.index=i.vertices.push(t)-1;var r=w(e)/2/Math.PI+.5,n=function(e){return Math.atan2(-e.y,Math.sqrt(e.x*e.x+e.z*e.z))}(e)/Math.PI+.5;return t.uv=new K.Vector2(r,1-n),t}function _(e,t,r){var n=new K.Face3(e.index,t.index,r.index,[e.clone(),t.clone(),r.clone()]);i.faces.push(n),f.copy(e).add(t).add(r).divideScalar(3);var o=w(f);i.faceVertexUvs[0].push([A(e.uv,e,o),A(t.uv,t,o),A(r.uv,r,o)])}function E(e,t){for(var r=Math.pow(2,t),n=x(i.vertices[e.a]),o=x(i.vertices[e.b]),a=x(i.vertices[e.c]),s=[],l=0;l<=r;l++){s[l]=[];for(var u=x(n.clone().lerp(a,l/r)),c=x(o.clone().lerp(a,l/r)),h=r-l,d=0;d<=h;d++)s[l][d]=0==d&&l==r?u:x(u.clone().lerp(c,d/h))}for(l=0;l<r;l++)for(d=0;d<2*(r-l)-1;d++){var f=Math.floor(d/2);d%2==0?_(s[l][f+1],s[l+1][f],s[l][f]):_(s[l][f+1],s[l+1][f+1],s[l+1][f])}}function w(e){return Math.atan2(e.z,-e.x)}function A(e,t,r){return r<0&&1===e.x&&(e=new K.Vector2(e.x-1,e.y)),0===t.x&&0===t.z&&(e=new K.Vector2(r/2/Math.PI+.5,e.y)),e.clone()}this.mergeVertices(),this.computeFaceNormals(),this.boundingSphere=new K.Sphere(new K.Vector3,r)},K.PolyhedronGeometry.prototype=Object.create(K.Geometry.prototype),K.PolyhedronGeometry.prototype.constructor=K.PolyhedronGeometry,K.DodecahedronGeometry=function(e,t){this.parameters={radius:e,detail:t};var r=(1+Math.sqrt(5))/2,n=1/r,i=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-n,-r,0,-n,r,0,n,-r,0,n,r,-n,-r,0,-n,r,0,n,-r,0,n,r,0,-r,0,-n,r,0,-n,-r,0,n,r,0,n];K.PolyhedronGeometry.call(this,i,[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],e,t)},K.DodecahedronGeometry.prototype=Object.create(K.Geometry.prototype),K.DodecahedronGeometry.prototype.constructor=K.DodecahedronGeometry,K.IcosahedronGeometry=function(e,t){var r=(1+Math.sqrt(5))/2,n=[-1,r,0,1,r,0,-1,-r,0,1,-r,0,0,-1,r,0,1,r,0,-1,-r,0,1,-r,r,0,-1,r,0,1,-r,0,-1,-r,0,1];K.PolyhedronGeometry.call(this,n,[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}},K.IcosahedronGeometry.prototype=Object.create(K.Geometry.prototype),K.IcosahedronGeometry.prototype.constructor=K.IcosahedronGeometry,K.OctahedronGeometry=function(e,t){this.parameters={radius:e,detail:t};K.PolyhedronGeometry.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],e,t),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}},K.OctahedronGeometry.prototype=Object.create(K.Geometry.prototype),K.OctahedronGeometry.prototype.constructor=K.OctahedronGeometry,K.TetrahedronGeometry=function(e,t){K.PolyhedronGeometry.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],e,t),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t}},K.TetrahedronGeometry.prototype=Object.create(K.Geometry.prototype),K.TetrahedronGeometry.prototype.constructor=K.TetrahedronGeometry,K.ParametricGeometry=function(e,t,r){K.Geometry.call(this),this.type="ParametricGeometry",this.parameters={func:e,slices:t,stacks:r};var n,i,o,a,s,l,u,c,h,d,f,p,m=this.vertices,g=this.faces,v=this.faceVertexUvs[0],y=t+1;for(n=0;n<=r;n++)for(a=n/r,i=0;i<=t;i++)o=e(i/t,a),m.push(o);for(n=0;n<r;n++)for(i=0;i<t;i++)s=n*y+i,l=n*y+i+1,u=(n+1)*y+i+1,c=(n+1)*y+i,h=new K.Vector2(i/t,n/r),d=new K.Vector2((i+1)/t,n/r),f=new K.Vector2((i+1)/t,(n+1)/r),p=new K.Vector2(i/t,(n+1)/r),g.push(new K.Face3(s,l,c)),v.push([h,d,p]),g.push(new K.Face3(l,u,c)),v.push([d.clone(),f,p.clone()]);this.computeFaceNormals(),this.computeVertexNormals()},K.ParametricGeometry.prototype=Object.create(K.Geometry.prototype),K.ParametricGeometry.prototype.constructor=K.ParametricGeometry,K.AxisHelper=function(e){e=e||1;var t=new Float32Array([0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e]),r=new Float32Array([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1]),n=new K.BufferGeometry;n.setAttribute("position",new K.BufferAttribute(t,3)),n.setAttribute("color",new K.BufferAttribute(r,3));var i=new K.LineBasicMaterial({vertexColors:K.VertexColors});K.Line.call(this,n,i,K.LinePieces)},K.AxisHelper.prototype=Object.create(K.Line.prototype),K.AxisHelper.prototype.constructor=K.AxisHelper,K.ArrowHelper=function(){var e=new K.Geometry;e.vertices.push(new K.Vector3(0,0,0),new K.Vector3(0,1,0));var t=new K.CylinderGeometry(0,.5,1,5,1);return t.applyMatrix((new K.Matrix4).makeTranslation(0,-.5,0)),function(r,n,i,o,a,s){K.Object3D.call(this),void 0===o&&(o=16776960),void 0===i&&(i=1),void 0===a&&(a=.2*i),void 0===s&&(s=.2*a),this.position.copy(n),this.line=new K.Line(e,new K.LineBasicMaterial({color:o})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new K.Mesh(t,new K.MeshBasicMaterial({color:o})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(r),this.setLength(i,a,s)}}(),K.ArrowHelper.prototype=Object.create(K.Object3D.prototype),K.ArrowHelper.prototype.constructor=K.ArrowHelper,K.ArrowHelper.prototype.setDirection=(Y=new K.Vector3,function(e){e.y>.99999?this.quaternion.set(0,0,0,1):e.y<-.99999?this.quaternion.set(1,0,0,0):(Y.set(e.z,0,-e.x).normalize(),X=Math.acos(e.y),this.quaternion.setFromAxisAngle(Y,X))}),K.ArrowHelper.prototype.setLength=function(e,t,r){void 0===t&&(t=.2*e),void 0===r&&(r=.2*t),this.line.scale.set(1,e-t,1),this.line.updateMatrix(),this.cone.scale.set(r,t,r),this.cone.position.y=e,this.cone.updateMatrix()},K.ArrowHelper.prototype.setColor=function(e){this.line.material.color.set(e),this.cone.material.color.set(e)},K.BoxHelper=function(e){var t=new K.BufferGeometry;t.setAttribute("position",new K.BufferAttribute(new Float32Array(72),3)),K.Line.call(this,t,new K.LineBasicMaterial({color:16776960}),K.LinePieces),void 0!==e&&this.update(e)},K.BoxHelper.prototype=Object.create(K.Line.prototype),K.BoxHelper.prototype.constructor=K.BoxHelper,K.BoxHelper.prototype.update=function(e){var t=e.geometry;null===t.boundingBox&&t.computeBoundingBox();var r=t.boundingBox.min,n=t.boundingBox.max,i=this.geometry.attributes.position.array;i[0]=n.x,i[1]=n.y,i[2]=n.z,i[3]=r.x,i[4]=n.y,i[5]=n.z,i[6]=r.x,i[7]=n.y,i[8]=n.z,i[9]=r.x,i[10]=r.y,i[11]=n.z,i[12]=r.x,i[13]=r.y,i[14]=n.z,i[15]=n.x,i[16]=r.y,i[17]=n.z,i[18]=n.x,i[19]=r.y,i[20]=n.z,i[21]=n.x,i[22]=n.y,i[23]=n.z,i[24]=n.x,i[25]=n.y,i[26]=r.z,i[27]=r.x,i[28]=n.y,i[29]=r.z,i[30]=r.x,i[31]=n.y,i[32]=r.z,i[33]=r.x,i[34]=r.y,i[35]=r.z,i[36]=r.x,i[37]=r.y,i[38]=r.z,i[39]=n.x,i[40]=r.y,i[41]=r.z,i[42]=n.x,i[43]=r.y,i[44]=r.z,i[45]=n.x,i[46]=n.y,i[47]=r.z,i[48]=n.x,i[49]=n.y,i[50]=n.z,i[51]=n.x,i[52]=n.y,i[53]=r.z,i[54]=r.x,i[55]=n.y,i[56]=n.z,i[57]=r.x,i[58]=n.y,i[59]=r.z,i[60]=r.x,i[61]=r.y,i[62]=n.z,i[63]=r.x,i[64]=r.y,i[65]=r.z,i[66]=n.x,i[67]=r.y,i[68]=n.z,i[69]=n.x,i[70]=r.y,i[71]=r.z,this.geometry.attributes.position.needsUpdate=!0,this.geometry.computeBoundingSphere(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1},K.BoundingBoxHelper=function(e,t){var r=void 0!==t?t:8947848;this.object=e,this.box=new K.Box3,K.Mesh.call(this,new K.BoxGeometry(1,1,1),new K.MeshBasicMaterial({color:r,wireframe:!0}))},K.BoundingBoxHelper.prototype=Object.create(K.Mesh.prototype),K.BoundingBoxHelper.prototype.constructor=K.BoundingBoxHelper,K.BoundingBoxHelper.prototype.update=function(){this.box.setFromObject(this.object),this.box.size(this.scale),this.box.getCenter(this.position)},K.CameraHelper=function(e){var t=new K.Geometry,r=new K.LineBasicMaterial({color:16777215,vertexColors:K.FaceColors}),n={},i=16755200,o=16711680,a=43775,s=3355443;function l(e,t,r){u(e,r),u(t,r)}function u(e,r){t.vertices.push(new K.Vector3),t.colors.push(new K.Color(r)),void 0===n[e]&&(n[e]=[]),n[e].push(t.vertices.length-1)}l("n1","n2",i),l("n2","n4",i),l("n4","n3",i),l("n3","n1",i),l("f1","f2",i),l("f2","f4",i),l("f4","f3",i),l("f3","f1",i),l("n1","f1",i),l("n2","f2",i),l("n3","f3",i),l("n4","f4",i),l("p","n1",o),l("p","n2",o),l("p","n3",o),l("p","n4",o),l("u1","u2",a),l("u2","u3",a),l("u3","u1",a),l("c","t",16777215),l("p","c",s),l("cn1","cn2",s),l("cn3","cn4",s),l("cf1","cf2",s),l("cf3","cf4",s),K.Line.call(this,t,r,K.LinePieces),this.camera=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=n,this.update()},K.CameraHelper.prototype=Object.create(K.Line.prototype),K.CameraHelper.prototype.constructor=K.CameraHelper,K.CameraHelper.prototype.update=function(){var e,t,r=new K.Vector3,n=new K.Camera,i=function(i,o,a,s){r.set(o,a,s).unproject(n);var l=t[i];if(void 0!==l)for(var u=0,c=l.length;u<c;u++)e.vertices[l[u]].copy(r)};return function(){e=this.geometry,t=this.pointMap;n.projectionMatrix.copy(this.camera.projectionMatrix),i("c",0,0,-1),i("t",0,0,1),i("n1",-1,-1,-1),i("n2",1,-1,-1),i("n3",-1,1,-1),i("n4",1,1,-1),i("f1",-1,-1,1),i("f2",1,-1,1),i("f3",-1,1,1),i("f4",1,1,1),i("u1",.7,1.1,-1),i("u2",-.7,1.1,-1),i("u3",0,2,-1),i("cf1",-1,0,1),i("cf2",1,0,1),i("cf3",0,-1,1),i("cf4",0,1,1),i("cn1",-1,0,-1),i("cn2",1,0,-1),i("cn3",0,-1,-1),i("cn4",0,1,-1),e.verticesNeedUpdate=!0}}(),K.DirectionalLightHelper=function(e,t){K.Object3D.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,t=t||1;var r=new K.Geometry;r.vertices.push(new K.Vector3(-t,t,0),new K.Vector3(t,t,0),new K.Vector3(t,-t,0),new K.Vector3(-t,-t,0),new K.Vector3(-t,t,0));var n=new K.LineBasicMaterial({fog:!1});n.color.copy(this.light.color).multiplyScalar(this.light.intensity),this.lightPlane=new K.Line(r,n),this.add(this.lightPlane),(r=new K.Geometry).vertices.push(new K.Vector3,new K.Vector3),(n=new K.LineBasicMaterial({fog:!1})).color.copy(this.light.color).multiplyScalar(this.light.intensity),this.targetLine=new K.Line(r,n),this.add(this.targetLine),this.update()},K.DirectionalLightHelper.prototype=Object.create(K.Object3D.prototype),K.DirectionalLightHelper.prototype.constructor=K.DirectionalLightHelper,K.DirectionalLightHelper.prototype.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},K.DirectionalLightHelper.prototype.update=function(){var e=new K.Vector3,t=new K.Vector3,r=new K.Vector3;return function(){e.setFromMatrixPosition(this.light.matrixWorld),t.setFromMatrixPosition(this.light.target.matrixWorld),r.subVectors(t,e),this.lightPlane.lookAt(r),this.lightPlane.material.color.copy(this.light.color).multiplyScalar(this.light.intensity),this.targetLine.geometry.vertices[1].copy(r),this.targetLine.geometry.verticesNeedUpdate=!0,this.targetLine.material.color.copy(this.lightPlane.material.color)}}(),K.EdgesHelper=function(e,t,r){var n=void 0!==t?t:16777215;r=void 0!==r?r:1;var i,o=Math.cos(K.Math.degToRad(r)),a=[0,0],s={},l=function(e,t){return e-t},u=["a","b","c"],c=new K.BufferGeometry;e.geometry instanceof K.BufferGeometry?(i=new K.Geometry).fromBufferGeometry(e.geometry):i=e.geometry.clone(),i.mergeVertices(),i.computeFaceNormals();for(var h=i.vertices,d=i.faces,f=0,p=0,m=d.length;p<m;p++)for(var g=d[p],v=0;v<3;v++){a[0]=g[u[v]],a[1]=g[u[(v+1)%3]],a.sort(l),void 0===s[x=a.toString()]?(s[x]={vert1:a[0],vert2:a[1],face1:p,face2:void 0},f++):s[x].face2=p}var y=new Float32Array(2*f*3),b=0;for(var x in s){var _=s[x];if(void 0===_.face2||d[_.face1].normal.dot(d[_.face2].normal)<=o){var E=h[_.vert1];y[b++]=E.x,y[b++]=E.y,y[b++]=E.z,E=h[_.vert2],y[b++]=E.x,y[b++]=E.y,y[b++]=E.z}}c.setAttribute("position",new K.BufferAttribute(y,3)),K.Line.call(this,c,new K.LineBasicMaterial({color:n}),K.LinePieces),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1},K.EdgesHelper.prototype=Object.create(K.Line.prototype),K.EdgesHelper.prototype.constructor=K.EdgesHelper,K.FaceNormalsHelper=function(e,t,r,n){this.object=e,this.size=void 0!==t?t:1;for(var i=void 0!==r?r:16776960,o=void 0!==n?n:1,a=new K.Geometry,s=0,l=this.object.geometry.faces.length;s<l;s++)a.vertices.push(new K.Vector3,new K.Vector3);K.Line.call(this,a,new K.LineBasicMaterial({color:i,linewidth:o}),K.LinePieces),this.matrixAutoUpdate=!1,this.normalMatrix=new K.Matrix3,this.update()},K.FaceNormalsHelper.prototype=Object.create(K.Line.prototype),K.FaceNormalsHelper.prototype.constructor=K.FaceNormalsHelper,K.FaceNormalsHelper.prototype.update=function(){var e=this.geometry.vertices,t=this.object,r=t.geometry.vertices,n=t.geometry.faces,i=t.matrixWorld;t.updateMatrixWorld(!0),this.normalMatrix.getNormalMatrix(i);for(var o=0,a=0,s=n.length;o<s;o++,a+=2){var l=n[o];e[a].copy(r[l.a]).add(r[l.b]).add(r[l.c]).divideScalar(3).applyMatrix4(i),e[a+1].copy(l.normal).applyMatrix3(this.normalMatrix).normalize().multiplyScalar(this.size).add(e[a])}return this.geometry.verticesNeedUpdate=!0,this},K.GridHelper=function(e,t){var r=new K.Geometry,n=new K.LineBasicMaterial({vertexColors:K.VertexColors});this.color1=new K.Color(4473924),this.color2=new K.Color(8947848);for(var i=-e;i<=e;i+=t){r.vertices.push(new K.Vector3(-e,0,i),new K.Vector3(e,0,i),new K.Vector3(i,0,-e),new K.Vector3(i,0,e));var o=0===i?this.color1:this.color2;r.colors.push(o,o,o,o)}K.Line.call(this,r,n,K.LinePieces)},K.GridHelper.prototype=Object.create(K.Line.prototype),K.GridHelper.prototype.constructor=K.GridHelper,K.GridHelper.prototype.setColors=function(e,t){this.color1.set(e),this.color2.set(t),this.geometry.colorsNeedUpdate=!0},K.HemisphereLightHelper=function(e,t){K.Object3D.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.colors=[new K.Color,new K.Color];var r=new K.SphereGeometry(t,4,2);r.applyMatrix((new K.Matrix4).makeRotationX(-Math.PI/2));for(var n=0;n<8;n++)r.faces[n].color=this.colors[n<4?0:1];var i=new K.MeshBasicMaterial({vertexColors:K.FaceColors,wireframe:!0});this.lightSphere=new K.Mesh(r,i),this.add(this.lightSphere),this.update()},K.HemisphereLightHelper.prototype=Object.create(K.Object3D.prototype),K.HemisphereLightHelper.prototype.constructor=K.HemisphereLightHelper,K.HemisphereLightHelper.prototype.dispose=function(){this.lightSphere.geometry.dispose(),this.lightSphere.material.dispose()},K.HemisphereLightHelper.prototype.update=function(){var e=new K.Vector3;return function(){this.colors[0].copy(this.light.color).multiplyScalar(this.light.intensity),this.colors[1].copy(this.light.groundColor).multiplyScalar(this.light.intensity),this.lightSphere.lookAt(e.setFromMatrixPosition(this.light.matrixWorld).negate()),this.lightSphere.geometry.colorsNeedUpdate=!0}}(),K.PointLightHelper=function(e,t){this.light=e,this.light.updateMatrixWorld();var r=new K.SphereGeometry(t,4,2),n=new K.MeshBasicMaterial({wireframe:!0,fog:!1});n.color.copy(this.light.color).multiplyScalar(this.light.intensity),K.Mesh.call(this,r,n),this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1},K.PointLightHelper.prototype=Object.create(K.Mesh.prototype),K.PointLightHelper.prototype.constructor=K.PointLightHelper,K.PointLightHelper.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},K.PointLightHelper.prototype.update=function(){this.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)},K.SkeletonHelper=function(e){this.bones=this.getBoneList(e);for(var t=new K.Geometry,r=0;r<this.bones.length;r++){this.bones[r].parent instanceof K.Bone&&(t.vertices.push(new K.Vector3),t.vertices.push(new K.Vector3),t.colors.push(new K.Color(0,0,1)),t.colors.push(new K.Color(0,1,0)))}var n=new K.LineBasicMaterial({vertexColors:K.VertexColors,depthTest:!1,depthWrite:!1,transparent:!0});K.Line.call(this,t,n,K.LinePieces),this.root=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.update()},K.SkeletonHelper.prototype=Object.create(K.Line.prototype),K.SkeletonHelper.prototype.constructor=K.SkeletonHelper,K.SkeletonHelper.prototype.getBoneList=function(e){var t=[];e instanceof K.Bone&&t.push(e);for(var r=0;r<e.children.length;r++)t.push.apply(t,this.getBoneList(e.children[r]));return t},K.SkeletonHelper.prototype.update=function(){for(var e=this.geometry,t=(new K.Matrix4).getInverse(this.root.matrixWorld),r=new K.Matrix4,n=0,i=0;i<this.bones.length;i++){var o=this.bones[i];o.parent instanceof K.Bone&&(r.multiplyMatrices(t,o.matrixWorld),e.vertices[n].setFromMatrixPosition(r),r.multiplyMatrices(t,o.parent.matrixWorld),e.vertices[n+1].setFromMatrixPosition(r),n+=2)}e.verticesNeedUpdate=!0,e.computeBoundingSphere()},K.SpotLightHelper=function(e){K.Object3D.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1;var t=new K.CylinderGeometry(0,1,1,8,1,!0);t.applyMatrix((new K.Matrix4).makeTranslation(0,-.5,0)),t.applyMatrix((new K.Matrix4).makeRotationX(-Math.PI/2));var r=new K.MeshBasicMaterial({wireframe:!0,fog:!1});this.cone=new K.Mesh(t,r),this.add(this.cone),this.update()},K.SpotLightHelper.prototype=Object.create(K.Object3D.prototype),K.SpotLightHelper.prototype.constructor=K.SpotLightHelper,K.SpotLightHelper.prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},K.SpotLightHelper.prototype.update=function(){var e=new K.Vector3,t=new K.Vector3;return function(){var r=this.light.distance?this.light.distance:1e4,n=r*Math.tan(this.light.angle);this.cone.scale.set(n,n,r),e.setFromMatrixPosition(this.light.matrixWorld),t.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(t.sub(e)),this.cone.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)}}(),K.VertexNormalsHelper=function(e,t,r,n){this.object=e,this.size=void 0!==t?t:1;for(var i=void 0!==r?r:16711680,o=void 0!==n?n:1,a=new K.Geometry,s=e.geometry.faces,l=0,u=s.length;l<u;l++)for(var c=0,h=s[l].vertexNormals.length;c<h;c++)a.vertices.push(new K.Vector3,new K.Vector3);K.Line.call(this,a,new K.LineBasicMaterial({color:i,linewidth:o}),K.LinePieces),this.matrixAutoUpdate=!1,this.normalMatrix=new K.Matrix3,this.update()},K.VertexNormalsHelper.prototype=Object.create(K.Line.prototype),K.VertexNormalsHelper.prototype.constructor=K.VertexNormalsHelper,K.VertexNormalsHelper.prototype.update=function(e){var t=new K.Vector3;return function(e){var r=["a","b","c","d"];this.object.updateMatrixWorld(!0),this.normalMatrix.getNormalMatrix(this.object.matrixWorld);for(var n=this.geometry.vertices,i=this.object.geometry.vertices,o=this.object.geometry.faces,a=this.object.matrixWorld,s=0,l=0,u=o.length;l<u;l++)for(var c=o[l],h=0,d=c.vertexNormals.length;h<d;h++){var f=i[c[r[h]]],p=c.vertexNormals[h];n[s].copy(f).applyMatrix4(a),t.copy(p).applyMatrix3(this.normalMatrix).normalize().multiplyScalar(this.size),t.add(n[s]),n[s+=1].copy(t),s+=1}return this.geometry.verticesNeedUpdate=!0,this}}(),K.VertexTangentsHelper=function(e,t,r,n){this.object=e,this.size=void 0!==t?t:1;for(var i=void 0!==r?r:255,o=void 0!==n?n:1,a=new K.Geometry,s=e.geometry.faces,l=0,u=s.length;l<u;l++)for(var c=0,h=s[l].vertexTangents.length;c<h;c++)a.vertices.push(new K.Vector3),a.vertices.push(new K.Vector3);K.Line.call(this,a,new K.LineBasicMaterial({color:i,linewidth:o}),K.LinePieces),this.matrixAutoUpdate=!1,this.update()},K.VertexTangentsHelper.prototype=Object.create(K.Line.prototype),K.VertexTangentsHelper.prototype.constructor=K.VertexTangentsHelper,K.VertexTangentsHelper.prototype.update=function(e){var t=new K.Vector3;return function(e){var r=["a","b","c","d"];this.object.updateMatrixWorld(!0);for(var n=this.geometry.vertices,i=this.object.geometry.vertices,o=this.object.geometry.faces,a=this.object.matrixWorld,s=0,l=0,u=o.length;l<u;l++)for(var c=o[l],h=0,d=c.vertexTangents.length;h<d;h++){var f=i[c[r[h]]],p=c.vertexTangents[h];n[s].copy(f).applyMatrix4(a),t.copy(p).transformDirection(a).multiplyScalar(this.size),t.add(n[s]),n[s+=1].copy(t),s+=1}return this.geometry.verticesNeedUpdate=!0,this}}(),K.WireframeHelper=function(e,t){var r=void 0!==t?t:16777215,n=[0,0],i={},o=function(e,t){return e-t},a=["a","b","c"],s=new K.BufferGeometry;if(e.geometry instanceof K.Geometry){for(var l=e.geometry.vertices,u=e.geometry.faces,c=0,h=new Uint32Array(6*u.length),d=0,f=u.length;d<f;d++)for(var p=u[d],m=0;m<3;m++){n[0]=p[a[m]],n[1]=p[a[(m+1)%3]],n.sort(o),void 0===i[M=n.toString()]&&(h[2*c]=n[0],h[2*c+1]=n[1],i[M]=!0,c++)}var g=new Float32Array(2*c*3);for(d=0,f=c;d<f;d++)for(m=0;m<2;m++){var v=l[h[2*d+m]];g[(A=6*d+3*m)+0]=v.x,g[A+1]=v.y,g[A+2]=v.z}s.setAttribute("position",new K.BufferAttribute(g,3))}else if(e.geometry instanceof K.BufferGeometry)if(void 0!==e.geometry.attributes.index){l=e.geometry.attributes.position.array;var y=e.geometry.attributes.index.array,b=e.geometry.drawcalls;c=0;0===b.length&&(b=[{count:y.length,index:0,start:0}]);h=new Uint32Array(2*y.length);for(var x=0,_=b.length;x<_;++x)for(var E=b[x].start,w=b[x].count,A=b[x].index,S=(d=E,E+w);d<S;d+=3)for(m=0;m<3;m++){var M;n[0]=A+y[d+m],n[1]=A+y[d+(m+1)%3],n.sort(o),void 0===i[M=n.toString()]&&(h[2*c]=n[0],h[2*c+1]=n[1],i[M]=!0,c++)}for(g=new Float32Array(2*c*3),d=0,f=c;d<f;d++)for(m=0;m<2;m++){A=6*d+3*m;var T=3*h[2*d+m];g[A+0]=l[T],g[A+1]=l[T+1],g[A+2]=l[T+2]}s.setAttribute("position",new K.BufferAttribute(g,3))}else{var C=(c=(l=e.geometry.attributes.position.array).length/3)/3;for(g=new Float32Array(2*c*3),d=0,f=C;d<f;d++)for(m=0;m<3;m++){var P=9*d+3*m;g[(A=18*d+6*m)+0]=l[P],g[A+1]=l[P+1],g[A+2]=l[P+2];T=9*d+(m+1)%3*3;g[A+3]=l[T],g[A+4]=l[T+1],g[A+5]=l[T+2]}s.setAttribute("position",new K.BufferAttribute(g,3))}K.Line.call(this,s,new K.LineBasicMaterial({color:r}),K.LinePieces),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1},K.WireframeHelper.prototype=Object.create(K.Line.prototype),K.WireframeHelper.prototype.constructor=K.WireframeHelper,K.ImmediateRenderObject=function(){K.Object3D.call(this),this.render=function(e){}},K.ImmediateRenderObject.prototype=Object.create(K.Object3D.prototype),K.ImmediateRenderObject.prototype.constructor=K.ImmediateRenderObject,K.MorphBlendMesh=function(e,t){K.Mesh.call(this,e,t),this.animationsMap={},this.animationsList=[];var r=this.geometry.morphTargets.length,n="__default",i=r-1,o=r/1;this.createAnimation(n,0,i,o),this.setAnimationWeight(n,1)},K.MorphBlendMesh.prototype=Object.create(K.Mesh.prototype),K.MorphBlendMesh.prototype.constructor=K.MorphBlendMesh,K.MorphBlendMesh.prototype.createAnimation=function(e,t,r,n){var i={startFrame:t,endFrame:r,length:r-t+1,fps:n,duration:(r-t)/n,lastFrame:0,currentFrame:0,active:!1,time:0,direction:1,weight:1,directionBackwards:!1,mirroredLoop:!1};this.animationsMap[e]=i,this.animationsList.push(i)},K.MorphBlendMesh.prototype.autoCreateAnimations=function(e){for(var t,r=/([a-z]+)_?(\d+)/,n={},i=this.geometry,o=0,a=i.morphTargets.length;o<a;o++){var s=i.morphTargets[o].name.match(r);if(s&&s.length>1)n[l=s[1]]||(n[l]={start:1/0,end:-1/0}),o<(u=n[l]).start&&(u.start=o),o>u.end&&(u.end=o),t||(t=l)}for(var l in n){var u=n[l];this.createAnimation(l,u.start,u.end,e)}this.firstAnimation=t},K.MorphBlendMesh.prototype.setAnimationDirectionForward=function(e){var t=this.animationsMap[e];t&&(t.direction=1,t.directionBackwards=!1)},K.MorphBlendMesh.prototype.setAnimationDirectionBackward=function(e){var t=this.animationsMap[e];t&&(t.direction=-1,t.directionBackwards=!0)},K.MorphBlendMesh.prototype.setAnimationFPS=function(e,t){var r=this.animationsMap[e];r&&(r.fps=t,r.duration=(r.end-r.start)/r.fps)},K.MorphBlendMesh.prototype.setAnimationDuration=function(e,t){var r=this.animationsMap[e];r&&(r.duration=t,r.fps=(r.end-r.start)/r.duration)},K.MorphBlendMesh.prototype.setAnimationWeight=function(e,t){var r=this.animationsMap[e];r&&(r.weight=t)},K.MorphBlendMesh.prototype.setAnimationTime=function(e,t){var r=this.animationsMap[e];r&&(r.time=t)},K.MorphBlendMesh.prototype.getAnimationTime=function(e){var t=0,r=this.animationsMap[e];return r&&(t=r.time),t},K.MorphBlendMesh.prototype.getAnimationDuration=function(e){var t=-1,r=this.animationsMap[e];return r&&(t=r.duration),t},K.MorphBlendMesh.prototype.playAnimation=function(e){var t=this.animationsMap[e];t?(t.time=0,t.active=!0):K.warn("THREE.MorphBlendMesh: animation["+e+"] undefined in .playAnimation()")},K.MorphBlendMesh.prototype.stopAnimation=function(e){var t=this.animationsMap[e];t&&(t.active=!1)},K.MorphBlendMesh.prototype.update=function(e){for(var t=0,r=this.animationsList.length;t<r;t++){var n=this.animationsList[t];if(n.active){var i=n.duration/n.length;n.time+=n.direction*e,n.mirroredLoop?(n.time>n.duration||n.time<0)&&(n.direction*=-1,n.time>n.duration&&(n.time=n.duration,n.directionBackwards=!0),n.time<0&&(n.time=0,n.directionBackwards=!1)):(n.time=n.time%n.duration,n.time<0&&(n.time+=n.duration));var o=n.startFrame+K.Math.clamp(Math.floor(n.time/i),0,n.length-1),a=n.weight;o!==n.currentFrame&&(this.morphTargetInfluences[n.lastFrame]=0,this.morphTargetInfluences[n.currentFrame]=1*a,this.morphTargetInfluences[o]=0,n.lastFrame=n.currentFrame,n.currentFrame=o);var s=n.time%i/i;n.directionBackwards&&(s=1-s),this.morphTargetInfluences[n.currentFrame]=s*a,this.morphTargetInfluences[n.lastFrame]=(1-s)*a}}},(0,r(32895).polyfillTHREE)(K)},62705:(e,t,r)=>{var n=r(55639).Symbol;e.exports=n},44239:(e,t,r)=>{var n=r(62705),i=r(89607),o=r(2333),a=n?n.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":a&&a in Object(e)?i(e):o(e)}},27561:(e,t,r)=>{var n=r(67990),i=/^\s+/;e.exports=function(e){return e?e.slice(0,n(e)+1).replace(i,""):e}},31957:(e,t,r)=>{var n="object"==typeof r.g&&r.g&&r.g.Object===Object&&r.g;e.exports=n},89607:(e,t,r)=>{var n=r(62705),i=Object.prototype,o=i.hasOwnProperty,a=i.toString,s=n?n.toStringTag:void 0;e.exports=function(e){var t=o.call(e,s),r=e[s];try{e[s]=void 0;var n=!0}catch(e){}var i=a.call(e);return n&&(t?e[s]=r:delete e[s]),i}},2333:e=>{var t=Object.prototype.toString;e.exports=function(e){return t.call(e)}},55639:(e,t,r)=>{var n=r(31957),i="object"==typeof self&&self&&self.Object===Object&&self,o=n||i||Function("return this")();e.exports=o},67990:e=>{var t=/\s/;e.exports=function(e){for(var r=e.length;r--&&t.test(e.charAt(r)););return r}},23279:(e,t,r)=>{var n=r(13218),i=r(7771),o=r(14841),a=Math.max,s=Math.min;e.exports=function(e,t,r){var l,u,c,h,d,f,p=0,m=!1,g=!1,v=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function y(t){var r=l,n=u;return l=u=void 0,p=t,h=e.apply(n,r)}function b(e){return p=e,d=setTimeout(_,t),m?y(e):h}function x(e){var r=e-f;return void 0===f||r>=t||r<0||g&&e-p>=c}function _(){var e=i();if(x(e))return E(e);d=setTimeout(_,function(e){var r=t-(e-f);return g?s(r,c-(e-p)):r}(e))}function E(e){return d=void 0,v&&l?y(e):(l=u=void 0,h)}function w(){var e=i(),r=x(e);if(l=arguments,u=this,f=e,r){if(void 0===d)return b(f);if(g)return clearTimeout(d),d=setTimeout(_,t),y(f)}return void 0===d&&(d=setTimeout(_,t)),h}return t=o(t)||0,n(r)&&(m=!!r.leading,c=(g="maxWait"in r)?a(o(r.maxWait)||0,t):c,v="trailing"in r?!!r.trailing:v),w.cancel=function(){void 0!==d&&clearTimeout(d),p=0,l=f=u=d=void 0},w.flush=function(){return void 0===d?h:E(i())},w}},13218:e=>{e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},37005:e=>{e.exports=function(e){return null!=e&&"object"==typeof e}},33448:(e,t,r)=>{var n=r(44239),i=r(37005);e.exports=function(e){return"symbol"==typeof e||i(e)&&"[object Symbol]"==n(e)}},7771:(e,t,r)=>{var n=r(55639);e.exports=function(){return n.Date.now()}},14841:(e,t,r)=>{var n=r(27561),i=r(13218),o=r(33448),a=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,l=/^0o[0-7]+$/i,u=parseInt;e.exports=function(e){if("number"==typeof e)return e;if(o(e))return NaN;if(i(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=i(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=n(e);var r=s.test(e);return r||l.test(e)?u(e.slice(2),r?2:8):a.test(e)?NaN:+e}},99591:(e,t,r)=>{"use strict";var n={};(0,r(24236).assign)(n,r(24555),r(78843),r(71619)),e.exports=n},24555:(e,t,r)=>{"use strict";var n=r(30405),i=r(24236),o=r(29373),a=r(48898),s=r(62292),l=Object.prototype.toString;function u(e){if(!(this instanceof u))return new u(e);this.options=i.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},e||{});var t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new s,this.strm.avail_out=0;var r=n.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(0!==r)throw new Error(a[r]);if(t.header&&n.deflateSetHeader(this.strm,t.header),t.dictionary){var c;if(c="string"==typeof t.dictionary?o.string2buf(t.dictionary):"[object ArrayBuffer]"===l.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,0!==(r=n.deflateSetDictionary(this.strm,c)))throw new Error(a[r]);this._dict_set=!0}}function c(e,t){var r=new u(t);if(r.push(e,!0),r.err)throw r.msg||a[r.err];return r.result}u.prototype.push=function(e,t){var r,a,s=this.strm,u=this.options.chunkSize;if(this.ended)return!1;a=t===~~t?t:!0===t?4:0,"string"==typeof e?s.input=o.string2buf(e):"[object ArrayBuffer]"===l.call(e)?s.input=new Uint8Array(e):s.input=e,s.next_in=0,s.avail_in=s.input.length;do{if(0===s.avail_out&&(s.output=new i.Buf8(u),s.next_out=0,s.avail_out=u),1!==(r=n.deflate(s,a))&&0!==r)return this.onEnd(r),this.ended=!0,!1;0!==s.avail_out&&(0!==s.avail_in||4!==a&&2!==a)||("string"===this.options.to?this.onData(o.buf2binstring(i.shrinkBuf(s.output,s.next_out))):this.onData(i.shrinkBuf(s.output,s.next_out)))}while((s.avail_in>0||0===s.avail_out)&&1!==r);return 4===a?(r=n.deflateEnd(this.strm),this.onEnd(r),this.ended=!0,0===r):2!==a||(this.onEnd(0),s.avail_out=0,!0)},u.prototype.onData=function(e){this.chunks.push(e)},u.prototype.onEnd=function(e){0===e&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},t.Deflate=u,t.deflate=c,t.deflateRaw=function(e,t){return(t=t||{}).raw=!0,c(e,t)},t.gzip=function(e,t){return(t=t||{}).gzip=!0,c(e,t)}},78843:(e,t,r)=>{"use strict";var n=r(27948),i=r(24236),o=r(29373),a=r(71619),s=r(48898),l=r(62292),u=r(42401),c=Object.prototype.toString;function h(e){if(!(this instanceof h))return new h(e);this.options=i.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new l,this.strm.avail_out=0;var r=n.inflateInit2(this.strm,t.windowBits);if(r!==a.Z_OK)throw new Error(s[r]);if(this.header=new u,n.inflateGetHeader(this.strm,this.header),t.dictionary&&("string"==typeof t.dictionary?t.dictionary=o.string2buf(t.dictionary):"[object ArrayBuffer]"===c.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(r=n.inflateSetDictionary(this.strm,t.dictionary))!==a.Z_OK))throw new Error(s[r])}function d(e,t){var r=new h(t);if(r.push(e,!0),r.err)throw r.msg||s[r.err];return r.result}h.prototype.push=function(e,t){var r,s,l,u,h,d=this.strm,f=this.options.chunkSize,p=this.options.dictionary,m=!1;if(this.ended)return!1;s=t===~~t?t:!0===t?a.Z_FINISH:a.Z_NO_FLUSH,"string"==typeof e?d.input=o.binstring2buf(e):"[object ArrayBuffer]"===c.call(e)?d.input=new Uint8Array(e):d.input=e,d.next_in=0,d.avail_in=d.input.length;do{if(0===d.avail_out&&(d.output=new i.Buf8(f),d.next_out=0,d.avail_out=f),(r=n.inflate(d,a.Z_NO_FLUSH))===a.Z_NEED_DICT&&p&&(r=n.inflateSetDictionary(this.strm,p)),r===a.Z_BUF_ERROR&&!0===m&&(r=a.Z_OK,m=!1),r!==a.Z_STREAM_END&&r!==a.Z_OK)return this.onEnd(r),this.ended=!0,!1;d.next_out&&(0!==d.avail_out&&r!==a.Z_STREAM_END&&(0!==d.avail_in||s!==a.Z_FINISH&&s!==a.Z_SYNC_FLUSH)||("string"===this.options.to?(l=o.utf8border(d.output,d.next_out),u=d.next_out-l,h=o.buf2string(d.output,l),d.next_out=u,d.avail_out=f-u,u&&i.arraySet(d.output,d.output,l,u,0),this.onData(h)):this.onData(i.shrinkBuf(d.output,d.next_out)))),0===d.avail_in&&0===d.avail_out&&(m=!0)}while((d.avail_in>0||0===d.avail_out)&&r!==a.Z_STREAM_END);return r===a.Z_STREAM_END&&(s=a.Z_FINISH),s===a.Z_FINISH?(r=n.inflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===a.Z_OK):s!==a.Z_SYNC_FLUSH||(this.onEnd(a.Z_OK),d.avail_out=0,!0)},h.prototype.onData=function(e){this.chunks.push(e)},h.prototype.onEnd=function(e){e===a.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},t.Inflate=h,t.inflate=d,t.inflateRaw=function(e,t){return(t=t||{}).raw=!0,d(e,t)},t.ungzip=d},24236:(e,t)=>{"use strict";var r="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;function n(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var r=t.shift();if(r){if("object"!=typeof r)throw new TypeError(r+"must be non-object");for(var i in r)n(r,i)&&(e[i]=r[i])}}return e},t.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var i={arraySet:function(e,t,r,n,i){if(t.subarray&&e.subarray)e.set(t.subarray(r,r+n),i);else for(var o=0;o<n;o++)e[i+o]=t[r+o]},flattenChunks:function(e){var t,r,n,i,o,a;for(n=0,t=0,r=e.length;t<r;t++)n+=e[t].length;for(a=new Uint8Array(n),i=0,t=0,r=e.length;t<r;t++)o=e[t],a.set(o,i),i+=o.length;return a}},o={arraySet:function(e,t,r,n,i){for(var o=0;o<n;o++)e[i+o]=t[r+o]},flattenChunks:function(e){return[].concat.apply([],e)}};t.setTyped=function(e){e?(t.Buf8=Uint8Array,t.Buf16=Uint16Array,t.Buf32=Int32Array,t.assign(t,i)):(t.Buf8=Array,t.Buf16=Array,t.Buf32=Array,t.assign(t,o))},t.setTyped(r)},29373:(e,t,r)=>{"use strict";var n=r(24236),i=!0,o=!0;try{String.fromCharCode.apply(null,[0])}catch(e){i=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){o=!1}for(var a=new n.Buf8(256),s=0;s<256;s++)a[s]=s>=252?6:s>=248?5:s>=240?4:s>=224?3:s>=192?2:1;function l(e,t){if(t<65534&&(e.subarray&&o||!e.subarray&&i))return String.fromCharCode.apply(null,n.shrinkBuf(e,t));for(var r="",a=0;a<t;a++)r+=String.fromCharCode(e[a]);return r}a[254]=a[254]=1,t.string2buf=function(e){var t,r,i,o,a,s=e.length,l=0;for(o=0;o<s;o++)55296==(64512&(r=e.charCodeAt(o)))&&o+1<s&&56320==(64512&(i=e.charCodeAt(o+1)))&&(r=65536+(r-55296<<10)+(i-56320),o++),l+=r<128?1:r<2048?2:r<65536?3:4;for(t=new n.Buf8(l),a=0,o=0;a<l;o++)55296==(64512&(r=e.charCodeAt(o)))&&o+1<s&&56320==(64512&(i=e.charCodeAt(o+1)))&&(r=65536+(r-55296<<10)+(i-56320),o++),r<128?t[a++]=r:r<2048?(t[a++]=192|r>>>6,t[a++]=128|63&r):r<65536?(t[a++]=224|r>>>12,t[a++]=128|r>>>6&63,t[a++]=128|63&r):(t[a++]=240|r>>>18,t[a++]=128|r>>>12&63,t[a++]=128|r>>>6&63,t[a++]=128|63&r);return t},t.buf2binstring=function(e){return l(e,e.length)},t.binstring2buf=function(e){for(var t=new n.Buf8(e.length),r=0,i=t.length;r<i;r++)t[r]=e.charCodeAt(r);return t},t.buf2string=function(e,t){var r,n,i,o,s=t||e.length,u=new Array(2*s);for(n=0,r=0;r<s;)if((i=e[r++])<128)u[n++]=i;else if((o=a[i])>4)u[n++]=65533,r+=o-1;else{for(i&=2===o?31:3===o?15:7;o>1&&r<s;)i=i<<6|63&e[r++],o--;o>1?u[n++]=65533:i<65536?u[n++]=i:(i-=65536,u[n++]=55296|i>>10&1023,u[n++]=56320|1023&i)}return l(u,n)},t.utf8border=function(e,t){var r;for((t=t||e.length)>e.length&&(t=e.length),r=t-1;r>=0&&128==(192&e[r]);)r--;return r<0||0===r?t:r+a[e[r]]>t?r:t}},66069:e=>{"use strict";e.exports=function(e,t,r,n){for(var i=65535&e|0,o=e>>>16&65535|0,a=0;0!==r;){r-=a=r>2e3?2e3:r;do{o=o+(i=i+t[n++]|0)|0}while(--a);i%=65521,o%=65521}return i|o<<16|0}},71619:e=>{"use strict";e.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},2869:e=>{"use strict";var t=function(){for(var e,t=[],r=0;r<256;r++){e=r;for(var n=0;n<8;n++)e=1&e?3988292384^e>>>1:e>>>1;t[r]=e}return t}();e.exports=function(e,r,n,i){var o=t,a=i+n;e^=-1;for(var s=i;s<a;s++)e=e>>>8^o[255&(e^r[s])];return-1^e}},30405:(e,t,r)=>{"use strict";var n,i=r(24236),o=r(10342),a=r(66069),s=r(2869),l=r(48898),u=-2,c=258,h=262,d=103,f=113,p=666;function m(e,t){return e.msg=l[t],t}function g(e){return(e<<1)-(e>4?9:0)}function v(e){for(var t=e.length;--t>=0;)e[t]=0}function y(e){var t=e.state,r=t.pending;r>e.avail_out&&(r=e.avail_out),0!==r&&(i.arraySet(e.output,t.pending_buf,t.pending_out,r,e.next_out),e.next_out+=r,t.pending_out+=r,e.total_out+=r,e.avail_out-=r,t.pending-=r,0===t.pending&&(t.pending_out=0))}function b(e,t){o._tr_flush_block(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,y(e.strm)}function x(e,t){e.pending_buf[e.pending++]=t}function _(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function E(e,t){var r,n,i=e.max_chain_length,o=e.strstart,a=e.prev_length,s=e.nice_match,l=e.strstart>e.w_size-h?e.strstart-(e.w_size-h):0,u=e.window,d=e.w_mask,f=e.prev,p=e.strstart+c,m=u[o+a-1],g=u[o+a];e.prev_length>=e.good_match&&(i>>=2),s>e.lookahead&&(s=e.lookahead);do{if(u[(r=t)+a]===g&&u[r+a-1]===m&&u[r]===u[o]&&u[++r]===u[o+1]){o+=2,r++;do{}while(u[++o]===u[++r]&&u[++o]===u[++r]&&u[++o]===u[++r]&&u[++o]===u[++r]&&u[++o]===u[++r]&&u[++o]===u[++r]&&u[++o]===u[++r]&&u[++o]===u[++r]&&o<p);if(n=c-(p-o),o=p-c,n>a){if(e.match_start=t,a=n,n>=s)break;m=u[o+a-1],g=u[o+a]}}}while((t=f[t&d])>l&&0!=--i);return a<=e.lookahead?a:e.lookahead}function w(e){var t,r,n,o,l,u,c,d,f,p,m=e.w_size;do{if(o=e.window_size-e.lookahead-e.strstart,e.strstart>=m+(m-h)){i.arraySet(e.window,e.window,m,m,0),e.match_start-=m,e.strstart-=m,e.block_start-=m,t=r=e.hash_size;do{n=e.head[--t],e.head[t]=n>=m?n-m:0}while(--r);t=r=m;do{n=e.prev[--t],e.prev[t]=n>=m?n-m:0}while(--r);o+=m}if(0===e.strm.avail_in)break;if(u=e.strm,c=e.window,d=e.strstart+e.lookahead,f=o,p=void 0,(p=u.avail_in)>f&&(p=f),r=0===p?0:(u.avail_in-=p,i.arraySet(c,u.input,u.next_in,p,d),1===u.state.wrap?u.adler=a(u.adler,c,p,d):2===u.state.wrap&&(u.adler=s(u.adler,c,p,d)),u.next_in+=p,u.total_in+=p,p),e.lookahead+=r,e.lookahead+e.insert>=3)for(l=e.strstart-e.insert,e.ins_h=e.window[l],e.ins_h=(e.ins_h<<e.hash_shift^e.window[l+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[l+3-1])&e.hash_mask,e.prev[l&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=l,l++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<h&&0!==e.strm.avail_in)}function A(e,t){for(var r,n;;){if(e.lookahead<h){if(w(e),e.lookahead<h&&0===t)return 1;if(0===e.lookahead)break}if(r=0,e.lookahead>=3&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==r&&e.strstart-r<=e.w_size-h&&(e.match_length=E(e,r)),e.match_length>=3)if(n=o._tr_tally(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){e.match_length--;do{e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else n=o._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(n&&(b(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<2?e.strstart:2,4===t?(b(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(b(e,!1),0===e.strm.avail_out)?1:2}function S(e,t){for(var r,n,i;;){if(e.lookahead<h){if(w(e),e.lookahead<h&&0===t)return 1;if(0===e.lookahead)break}if(r=0,e.lookahead>=3&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==r&&e.prev_length<e.max_lazy_match&&e.strstart-r<=e.w_size-h&&(e.match_length=E(e,r),e.match_length<=5&&(1===e.strategy||3===e.match_length&&e.strstart-e.match_start>4096)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){i=e.strstart+e.lookahead-3,n=o._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=i&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!=--e.prev_length);if(e.match_available=0,e.match_length=2,e.strstart++,n&&(b(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if((n=o._tr_tally(e,0,e.window[e.strstart-1]))&&b(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(n=o._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,4===t?(b(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(b(e,!1),0===e.strm.avail_out)?1:2}function M(e,t,r,n,i){this.good_length=e,this.max_lazy=t,this.nice_length=r,this.max_chain=n,this.func=i}function T(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new i.Buf16(1146),this.dyn_dtree=new i.Buf16(122),this.bl_tree=new i.Buf16(78),v(this.dyn_ltree),v(this.dyn_dtree),v(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new i.Buf16(16),this.heap=new i.Buf16(573),v(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new i.Buf16(573),v(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function C(e){var t;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=2,(t=e.state).pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?42:f,e.adler=2===t.wrap?0:1,t.last_flush=0,o._tr_init(t),0):m(e,u)}function P(e){var t,r=C(e);return 0===r&&((t=e.state).window_size=2*t.w_size,v(t.head),t.max_lazy_match=n[t.level].max_lazy,t.good_match=n[t.level].good_length,t.nice_match=n[t.level].nice_length,t.max_chain_length=n[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=2,t.match_available=0,t.ins_h=0),r}function D(e,t,r,n,o,a){if(!e)return u;var s=1;if(-1===t&&(t=6),n<0?(s=0,n=-n):n>15&&(s=2,n-=16),o<1||o>9||8!==r||n<8||n>15||t<0||t>9||a<0||a>4)return m(e,u);8===n&&(n=9);var l=new T;return e.state=l,l.strm=e,l.wrap=s,l.gzhead=null,l.w_bits=n,l.w_size=1<<l.w_bits,l.w_mask=l.w_size-1,l.hash_bits=o+7,l.hash_size=1<<l.hash_bits,l.hash_mask=l.hash_size-1,l.hash_shift=~~((l.hash_bits+3-1)/3),l.window=new i.Buf8(2*l.w_size),l.head=new i.Buf16(l.hash_size),l.prev=new i.Buf16(l.w_size),l.lit_bufsize=1<<o+6,l.pending_buf_size=4*l.lit_bufsize,l.pending_buf=new i.Buf8(l.pending_buf_size),l.d_buf=1*l.lit_bufsize,l.l_buf=3*l.lit_bufsize,l.level=t,l.strategy=a,l.method=r,P(e)}n=[new M(0,0,0,0,(function(e,t){var r=65535;for(r>e.pending_buf_size-5&&(r=e.pending_buf_size-5);;){if(e.lookahead<=1){if(w(e),0===e.lookahead&&0===t)return 1;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var n=e.block_start+r;if((0===e.strstart||e.strstart>=n)&&(e.lookahead=e.strstart-n,e.strstart=n,b(e,!1),0===e.strm.avail_out))return 1;if(e.strstart-e.block_start>=e.w_size-h&&(b(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(b(e,!0),0===e.strm.avail_out?3:4):(e.strstart>e.block_start&&(b(e,!1),e.strm.avail_out),1)})),new M(4,4,8,4,A),new M(4,5,16,8,A),new M(4,6,32,32,A),new M(4,4,16,16,S),new M(8,16,32,32,S),new M(8,16,128,128,S),new M(8,32,128,256,S),new M(32,128,258,1024,S),new M(32,258,258,4096,S)],t.deflateInit=function(e,t){return D(e,t,8,15,8,0)},t.deflateInit2=D,t.deflateReset=P,t.deflateResetKeep=C,t.deflateSetHeader=function(e,t){return e&&e.state?2!==e.state.wrap?u:(e.state.gzhead=t,0):u},t.deflate=function(e,t){var r,i,a,l;if(!e||!e.state||t>5||t<0)return e?m(e,u):u;if(i=e.state,!e.output||!e.input&&0!==e.avail_in||i.status===p&&4!==t)return m(e,0===e.avail_out?-5:u);if(i.strm=e,r=i.last_flush,i.last_flush=t,42===i.status)if(2===i.wrap)e.adler=0,x(i,31),x(i,139),x(i,8),i.gzhead?(x(i,(i.gzhead.text?1:0)+(i.gzhead.hcrc?2:0)+(i.gzhead.extra?4:0)+(i.gzhead.name?8:0)+(i.gzhead.comment?16:0)),x(i,255&i.gzhead.time),x(i,i.gzhead.time>>8&255),x(i,i.gzhead.time>>16&255),x(i,i.gzhead.time>>24&255),x(i,9===i.level?2:i.strategy>=2||i.level<2?4:0),x(i,255&i.gzhead.os),i.gzhead.extra&&i.gzhead.extra.length&&(x(i,255&i.gzhead.extra.length),x(i,i.gzhead.extra.length>>8&255)),i.gzhead.hcrc&&(e.adler=s(e.adler,i.pending_buf,i.pending,0)),i.gzindex=0,i.status=69):(x(i,0),x(i,0),x(i,0),x(i,0),x(i,0),x(i,9===i.level?2:i.strategy>=2||i.level<2?4:0),x(i,3),i.status=f);else{var h=8+(i.w_bits-8<<4)<<8;h|=(i.strategy>=2||i.level<2?0:i.level<6?1:6===i.level?2:3)<<6,0!==i.strstart&&(h|=32),h+=31-h%31,i.status=f,_(i,h),0!==i.strstart&&(_(i,e.adler>>>16),_(i,65535&e.adler)),e.adler=1}if(69===i.status)if(i.gzhead.extra){for(a=i.pending;i.gzindex<(65535&i.gzhead.extra.length)&&(i.pending!==i.pending_buf_size||(i.gzhead.hcrc&&i.pending>a&&(e.adler=s(e.adler,i.pending_buf,i.pending-a,a)),y(e),a=i.pending,i.pending!==i.pending_buf_size));)x(i,255&i.gzhead.extra[i.gzindex]),i.gzindex++;i.gzhead.hcrc&&i.pending>a&&(e.adler=s(e.adler,i.pending_buf,i.pending-a,a)),i.gzindex===i.gzhead.extra.length&&(i.gzindex=0,i.status=73)}else i.status=73;if(73===i.status)if(i.gzhead.name){a=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>a&&(e.adler=s(e.adler,i.pending_buf,i.pending-a,a)),y(e),a=i.pending,i.pending===i.pending_buf_size)){l=1;break}l=i.gzindex<i.gzhead.name.length?255&i.gzhead.name.charCodeAt(i.gzindex++):0,x(i,l)}while(0!==l);i.gzhead.hcrc&&i.pending>a&&(e.adler=s(e.adler,i.pending_buf,i.pending-a,a)),0===l&&(i.gzindex=0,i.status=91)}else i.status=91;if(91===i.status)if(i.gzhead.comment){a=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>a&&(e.adler=s(e.adler,i.pending_buf,i.pending-a,a)),y(e),a=i.pending,i.pending===i.pending_buf_size)){l=1;break}l=i.gzindex<i.gzhead.comment.length?255&i.gzhead.comment.charCodeAt(i.gzindex++):0,x(i,l)}while(0!==l);i.gzhead.hcrc&&i.pending>a&&(e.adler=s(e.adler,i.pending_buf,i.pending-a,a)),0===l&&(i.status=d)}else i.status=d;if(i.status===d&&(i.gzhead.hcrc?(i.pending+2>i.pending_buf_size&&y(e),i.pending+2<=i.pending_buf_size&&(x(i,255&e.adler),x(i,e.adler>>8&255),e.adler=0,i.status=f)):i.status=f),0!==i.pending){if(y(e),0===e.avail_out)return i.last_flush=-1,0}else if(0===e.avail_in&&g(t)<=g(r)&&4!==t)return m(e,-5);if(i.status===p&&0!==e.avail_in)return m(e,-5);if(0!==e.avail_in||0!==i.lookahead||0!==t&&i.status!==p){var E=2===i.strategy?function(e,t){for(var r;;){if(0===e.lookahead&&(w(e),0===e.lookahead)){if(0===t)return 1;break}if(e.match_length=0,r=o._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,r&&(b(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(b(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(b(e,!1),0===e.strm.avail_out)?1:2}(i,t):3===i.strategy?function(e,t){for(var r,n,i,a,s=e.window;;){if(e.lookahead<=c){if(w(e),e.lookahead<=c&&0===t)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&e.strstart>0&&(n=s[i=e.strstart-1])===s[++i]&&n===s[++i]&&n===s[++i]){a=e.strstart+c;do{}while(n===s[++i]&&n===s[++i]&&n===s[++i]&&n===s[++i]&&n===s[++i]&&n===s[++i]&&n===s[++i]&&n===s[++i]&&i<a);e.match_length=c-(a-i),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(r=o._tr_tally(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(r=o._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),r&&(b(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(b(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(b(e,!1),0===e.strm.avail_out)?1:2}(i,t):n[i.level].func(i,t);if(3!==E&&4!==E||(i.status=p),1===E||3===E)return 0===e.avail_out&&(i.last_flush=-1),0;if(2===E&&(1===t?o._tr_align(i):5!==t&&(o._tr_stored_block(i,0,0,!1),3===t&&(v(i.head),0===i.lookahead&&(i.strstart=0,i.block_start=0,i.insert=0))),y(e),0===e.avail_out))return i.last_flush=-1,0}return 4!==t?0:i.wrap<=0?1:(2===i.wrap?(x(i,255&e.adler),x(i,e.adler>>8&255),x(i,e.adler>>16&255),x(i,e.adler>>24&255),x(i,255&e.total_in),x(i,e.total_in>>8&255),x(i,e.total_in>>16&255),x(i,e.total_in>>24&255)):(_(i,e.adler>>>16),_(i,65535&e.adler)),y(e),i.wrap>0&&(i.wrap=-i.wrap),0!==i.pending?0:1)},t.deflateEnd=function(e){var t;return e&&e.state?42!==(t=e.state.status)&&69!==t&&73!==t&&91!==t&&t!==d&&t!==f&&t!==p?m(e,u):(e.state=null,t===f?m(e,-3):0):u},t.deflateSetDictionary=function(e,t){var r,n,o,s,l,c,h,d,f=t.length;if(!e||!e.state)return u;if(2===(s=(r=e.state).wrap)||1===s&&42!==r.status||r.lookahead)return u;for(1===s&&(e.adler=a(e.adler,t,f,0)),r.wrap=0,f>=r.w_size&&(0===s&&(v(r.head),r.strstart=0,r.block_start=0,r.insert=0),d=new i.Buf8(r.w_size),i.arraySet(d,t,f-r.w_size,r.w_size,0),t=d,f=r.w_size),l=e.avail_in,c=e.next_in,h=e.input,e.avail_in=f,e.next_in=0,e.input=t,w(r);r.lookahead>=3;){n=r.strstart,o=r.lookahead-2;do{r.ins_h=(r.ins_h<<r.hash_shift^r.window[n+3-1])&r.hash_mask,r.prev[n&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=n,n++}while(--o);r.strstart=n,r.lookahead=2,w(r)}return r.strstart+=r.lookahead,r.block_start=r.strstart,r.insert=r.lookahead,r.lookahead=0,r.match_length=r.prev_length=2,r.match_available=0,e.next_in=c,e.input=h,e.avail_in=l,r.wrap=s,0},t.deflateInfo="pako deflate (from Nodeca project)"},42401:e=>{"use strict";e.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},94264:e=>{"use strict";e.exports=function(e,t){var r,n,i,o,a,s,l,u,c,h,d,f,p,m,g,v,y,b,x,_,E,w,A,S,M;r=e.state,n=e.next_in,S=e.input,i=n+(e.avail_in-5),o=e.next_out,M=e.output,a=o-(t-e.avail_out),s=o+(e.avail_out-257),l=r.dmax,u=r.wsize,c=r.whave,h=r.wnext,d=r.window,f=r.hold,p=r.bits,m=r.lencode,g=r.distcode,v=(1<<r.lenbits)-1,y=(1<<r.distbits)-1;e:do{p<15&&(f+=S[n++]<<p,p+=8,f+=S[n++]<<p,p+=8),b=m[f&v];t:for(;;){if(f>>>=x=b>>>24,p-=x,0===(x=b>>>16&255))M[o++]=65535&b;else{if(!(16&x)){if(0==(64&x)){b=m[(65535&b)+(f&(1<<x)-1)];continue t}if(32&x){r.mode=12;break e}e.msg="invalid literal/length code",r.mode=30;break e}_=65535&b,(x&=15)&&(p<x&&(f+=S[n++]<<p,p+=8),_+=f&(1<<x)-1,f>>>=x,p-=x),p<15&&(f+=S[n++]<<p,p+=8,f+=S[n++]<<p,p+=8),b=g[f&y];r:for(;;){if(f>>>=x=b>>>24,p-=x,!(16&(x=b>>>16&255))){if(0==(64&x)){b=g[(65535&b)+(f&(1<<x)-1)];continue r}e.msg="invalid distance code",r.mode=30;break e}if(E=65535&b,p<(x&=15)&&(f+=S[n++]<<p,(p+=8)<x&&(f+=S[n++]<<p,p+=8)),(E+=f&(1<<x)-1)>l){e.msg="invalid distance too far back",r.mode=30;break e}if(f>>>=x,p-=x,E>(x=o-a)){if((x=E-x)>c&&r.sane){e.msg="invalid distance too far back",r.mode=30;break e}if(w=0,A=d,0===h){if(w+=u-x,x<_){_-=x;do{M[o++]=d[w++]}while(--x);w=o-E,A=M}}else if(h<x){if(w+=u+h-x,(x-=h)<_){_-=x;do{M[o++]=d[w++]}while(--x);if(w=0,h<_){_-=x=h;do{M[o++]=d[w++]}while(--x);w=o-E,A=M}}}else if(w+=h-x,x<_){_-=x;do{M[o++]=d[w++]}while(--x);w=o-E,A=M}for(;_>2;)M[o++]=A[w++],M[o++]=A[w++],M[o++]=A[w++],_-=3;_&&(M[o++]=A[w++],_>1&&(M[o++]=A[w++]))}else{w=o-E;do{M[o++]=M[w++],M[o++]=M[w++],M[o++]=M[w++],_-=3}while(_>2);_&&(M[o++]=M[w++],_>1&&(M[o++]=M[w++]))}break}}break}}while(n<i&&o<s);n-=_=p>>3,f&=(1<<(p-=_<<3))-1,e.next_in=n,e.next_out=o,e.avail_in=n<i?i-n+5:5-(n-i),e.avail_out=o<s?s-o+257:257-(o-s),r.hold=f,r.bits=p}},27948:(e,t,r)=>{"use strict";var n=r(24236),i=r(66069),o=r(2869),a=r(94264),s=r(9241),l=-2,u=12,c=30;function h(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function d(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new n.Buf16(320),this.work=new n.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function f(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=1,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new n.Buf32(852),t.distcode=t.distdyn=new n.Buf32(592),t.sane=1,t.back=-1,0):l}function p(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,f(e)):l}function m(e,t){var r,n;return e&&e.state?(n=e.state,t<0?(r=0,t=-t):(r=1+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?l:(null!==n.window&&n.wbits!==t&&(n.window=null),n.wrap=r,n.wbits=t,p(e))):l}function g(e,t){var r,n;return e?(n=new d,e.state=n,n.window=null,0!==(r=m(e,t))&&(e.state=null),r):l}var v,y,b=!0;function x(e){if(b){var t;for(v=new n.Buf32(512),y=new n.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(s(1,e.lens,0,288,v,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;s(2,e.lens,0,32,y,0,e.work,{bits:5}),b=!1}e.lencode=v,e.lenbits=9,e.distcode=y,e.distbits=5}function _(e,t,r,i){var o,a=e.state;return null===a.window&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new n.Buf8(a.wsize)),i>=a.wsize?(n.arraySet(a.window,t,r-a.wsize,a.wsize,0),a.wnext=0,a.whave=a.wsize):((o=a.wsize-a.wnext)>i&&(o=i),n.arraySet(a.window,t,r-i,o,a.wnext),(i-=o)?(n.arraySet(a.window,t,r-i,i,0),a.wnext=i,a.whave=a.wsize):(a.wnext+=o,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=o))),0}t.inflateReset=p,t.inflateReset2=m,t.inflateResetKeep=f,t.inflateInit=function(e){return g(e,15)},t.inflateInit2=g,t.inflate=function(e,t){var r,d,f,p,m,g,v,y,b,E,w,A,S,M,T,C,P,D,L,R,I,O,N,k,F=0,V=new n.Buf8(4),U=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return l;(r=e.state).mode===u&&(r.mode=13),m=e.next_out,f=e.output,v=e.avail_out,p=e.next_in,d=e.input,g=e.avail_in,y=r.hold,b=r.bits,E=g,w=v,O=0;e:for(;;)switch(r.mode){case 1:if(0===r.wrap){r.mode=13;break}for(;b<16;){if(0===g)break e;g--,y+=d[p++]<<b,b+=8}if(2&r.wrap&&35615===y){r.check=0,V[0]=255&y,V[1]=y>>>8&255,r.check=o(r.check,V,2,0),y=0,b=0,r.mode=2;break}if(r.flags=0,r.head&&(r.head.done=!1),!(1&r.wrap)||(((255&y)<<8)+(y>>8))%31){e.msg="incorrect header check",r.mode=c;break}if(8!=(15&y)){e.msg="unknown compression method",r.mode=c;break}if(b-=4,I=8+(15&(y>>>=4)),0===r.wbits)r.wbits=I;else if(I>r.wbits){e.msg="invalid window size",r.mode=c;break}r.dmax=1<<I,e.adler=r.check=1,r.mode=512&y?10:u,y=0,b=0;break;case 2:for(;b<16;){if(0===g)break e;g--,y+=d[p++]<<b,b+=8}if(r.flags=y,8!=(255&r.flags)){e.msg="unknown compression method",r.mode=c;break}if(57344&r.flags){e.msg="unknown header flags set",r.mode=c;break}r.head&&(r.head.text=y>>8&1),512&r.flags&&(V[0]=255&y,V[1]=y>>>8&255,r.check=o(r.check,V,2,0)),y=0,b=0,r.mode=3;case 3:for(;b<32;){if(0===g)break e;g--,y+=d[p++]<<b,b+=8}r.head&&(r.head.time=y),512&r.flags&&(V[0]=255&y,V[1]=y>>>8&255,V[2]=y>>>16&255,V[3]=y>>>24&255,r.check=o(r.check,V,4,0)),y=0,b=0,r.mode=4;case 4:for(;b<16;){if(0===g)break e;g--,y+=d[p++]<<b,b+=8}r.head&&(r.head.xflags=255&y,r.head.os=y>>8),512&r.flags&&(V[0]=255&y,V[1]=y>>>8&255,r.check=o(r.check,V,2,0)),y=0,b=0,r.mode=5;case 5:if(1024&r.flags){for(;b<16;){if(0===g)break e;g--,y+=d[p++]<<b,b+=8}r.length=y,r.head&&(r.head.extra_len=y),512&r.flags&&(V[0]=255&y,V[1]=y>>>8&255,r.check=o(r.check,V,2,0)),y=0,b=0}else r.head&&(r.head.extra=null);r.mode=6;case 6:if(1024&r.flags&&((A=r.length)>g&&(A=g),A&&(r.head&&(I=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Array(r.head.extra_len)),n.arraySet(r.head.extra,d,p,A,I)),512&r.flags&&(r.check=o(r.check,d,A,p)),g-=A,p+=A,r.length-=A),r.length))break e;r.length=0,r.mode=7;case 7:if(2048&r.flags){if(0===g)break e;A=0;do{I=d[p+A++],r.head&&I&&r.length<65536&&(r.head.name+=String.fromCharCode(I))}while(I&&A<g);if(512&r.flags&&(r.check=o(r.check,d,A,p)),g-=A,p+=A,I)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=8;case 8:if(4096&r.flags){if(0===g)break e;A=0;do{I=d[p+A++],r.head&&I&&r.length<65536&&(r.head.comment+=String.fromCharCode(I))}while(I&&A<g);if(512&r.flags&&(r.check=o(r.check,d,A,p)),g-=A,p+=A,I)break e}else r.head&&(r.head.comment=null);r.mode=9;case 9:if(512&r.flags){for(;b<16;){if(0===g)break e;g--,y+=d[p++]<<b,b+=8}if(y!==(65535&r.check)){e.msg="header crc mismatch",r.mode=c;break}y=0,b=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=u;break;case 10:for(;b<32;){if(0===g)break e;g--,y+=d[p++]<<b,b+=8}e.adler=r.check=h(y),y=0,b=0,r.mode=11;case 11:if(0===r.havedict)return e.next_out=m,e.avail_out=v,e.next_in=p,e.avail_in=g,r.hold=y,r.bits=b,2;e.adler=r.check=1,r.mode=u;case u:if(5===t||6===t)break e;case 13:if(r.last){y>>>=7&b,b-=7&b,r.mode=27;break}for(;b<3;){if(0===g)break e;g--,y+=d[p++]<<b,b+=8}switch(r.last=1&y,b-=1,3&(y>>>=1)){case 0:r.mode=14;break;case 1:if(x(r),r.mode=20,6===t){y>>>=2,b-=2;break e}break;case 2:r.mode=17;break;case 3:e.msg="invalid block type",r.mode=c}y>>>=2,b-=2;break;case 14:for(y>>>=7&b,b-=7&b;b<32;){if(0===g)break e;g--,y+=d[p++]<<b,b+=8}if((65535&y)!=(y>>>16^65535)){e.msg="invalid stored block lengths",r.mode=c;break}if(r.length=65535&y,y=0,b=0,r.mode=15,6===t)break e;case 15:r.mode=16;case 16:if(A=r.length){if(A>g&&(A=g),A>v&&(A=v),0===A)break e;n.arraySet(f,d,p,A,m),g-=A,p+=A,v-=A,m+=A,r.length-=A;break}r.mode=u;break;case 17:for(;b<14;){if(0===g)break e;g--,y+=d[p++]<<b,b+=8}if(r.nlen=257+(31&y),y>>>=5,b-=5,r.ndist=1+(31&y),y>>>=5,b-=5,r.ncode=4+(15&y),y>>>=4,b-=4,r.nlen>286||r.ndist>30){e.msg="too many length or distance symbols",r.mode=c;break}r.have=0,r.mode=18;case 18:for(;r.have<r.ncode;){for(;b<3;){if(0===g)break e;g--,y+=d[p++]<<b,b+=8}r.lens[U[r.have++]]=7&y,y>>>=3,b-=3}for(;r.have<19;)r.lens[U[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,N={bits:r.lenbits},O=s(0,r.lens,0,19,r.lencode,0,r.work,N),r.lenbits=N.bits,O){e.msg="invalid code lengths set",r.mode=c;break}r.have=0,r.mode=19;case 19:for(;r.have<r.nlen+r.ndist;){for(;C=(F=r.lencode[y&(1<<r.lenbits)-1])>>>16&255,P=65535&F,!((T=F>>>24)<=b);){if(0===g)break e;g--,y+=d[p++]<<b,b+=8}if(P<16)y>>>=T,b-=T,r.lens[r.have++]=P;else{if(16===P){for(k=T+2;b<k;){if(0===g)break e;g--,y+=d[p++]<<b,b+=8}if(y>>>=T,b-=T,0===r.have){e.msg="invalid bit length repeat",r.mode=c;break}I=r.lens[r.have-1],A=3+(3&y),y>>>=2,b-=2}else if(17===P){for(k=T+3;b<k;){if(0===g)break e;g--,y+=d[p++]<<b,b+=8}b-=T,I=0,A=3+(7&(y>>>=T)),y>>>=3,b-=3}else{for(k=T+7;b<k;){if(0===g)break e;g--,y+=d[p++]<<b,b+=8}b-=T,I=0,A=11+(127&(y>>>=T)),y>>>=7,b-=7}if(r.have+A>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=c;break}for(;A--;)r.lens[r.have++]=I}}if(r.mode===c)break;if(0===r.lens[256]){e.msg="invalid code -- missing end-of-block",r.mode=c;break}if(r.lenbits=9,N={bits:r.lenbits},O=s(1,r.lens,0,r.nlen,r.lencode,0,r.work,N),r.lenbits=N.bits,O){e.msg="invalid literal/lengths set",r.mode=c;break}if(r.distbits=6,r.distcode=r.distdyn,N={bits:r.distbits},O=s(2,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,N),r.distbits=N.bits,O){e.msg="invalid distances set",r.mode=c;break}if(r.mode=20,6===t)break e;case 20:r.mode=21;case 21:if(g>=6&&v>=258){e.next_out=m,e.avail_out=v,e.next_in=p,e.avail_in=g,r.hold=y,r.bits=b,a(e,w),m=e.next_out,f=e.output,v=e.avail_out,p=e.next_in,d=e.input,g=e.avail_in,y=r.hold,b=r.bits,r.mode===u&&(r.back=-1);break}for(r.back=0;C=(F=r.lencode[y&(1<<r.lenbits)-1])>>>16&255,P=65535&F,!((T=F>>>24)<=b);){if(0===g)break e;g--,y+=d[p++]<<b,b+=8}if(C&&0==(240&C)){for(D=T,L=C,R=P;C=(F=r.lencode[R+((y&(1<<D+L)-1)>>D)])>>>16&255,P=65535&F,!(D+(T=F>>>24)<=b);){if(0===g)break e;g--,y+=d[p++]<<b,b+=8}y>>>=D,b-=D,r.back+=D}if(y>>>=T,b-=T,r.back+=T,r.length=P,0===C){r.mode=26;break}if(32&C){r.back=-1,r.mode=u;break}if(64&C){e.msg="invalid literal/length code",r.mode=c;break}r.extra=15&C,r.mode=22;case 22:if(r.extra){for(k=r.extra;b<k;){if(0===g)break e;g--,y+=d[p++]<<b,b+=8}r.length+=y&(1<<r.extra)-1,y>>>=r.extra,b-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=23;case 23:for(;C=(F=r.distcode[y&(1<<r.distbits)-1])>>>16&255,P=65535&F,!((T=F>>>24)<=b);){if(0===g)break e;g--,y+=d[p++]<<b,b+=8}if(0==(240&C)){for(D=T,L=C,R=P;C=(F=r.distcode[R+((y&(1<<D+L)-1)>>D)])>>>16&255,P=65535&F,!(D+(T=F>>>24)<=b);){if(0===g)break e;g--,y+=d[p++]<<b,b+=8}y>>>=D,b-=D,r.back+=D}if(y>>>=T,b-=T,r.back+=T,64&C){e.msg="invalid distance code",r.mode=c;break}r.offset=P,r.extra=15&C,r.mode=24;case 24:if(r.extra){for(k=r.extra;b<k;){if(0===g)break e;g--,y+=d[p++]<<b,b+=8}r.offset+=y&(1<<r.extra)-1,y>>>=r.extra,b-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=c;break}r.mode=25;case 25:if(0===v)break e;if(A=w-v,r.offset>A){if((A=r.offset-A)>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=c;break}A>r.wnext?(A-=r.wnext,S=r.wsize-A):S=r.wnext-A,A>r.length&&(A=r.length),M=r.window}else M=f,S=m-r.offset,A=r.length;A>v&&(A=v),v-=A,r.length-=A;do{f[m++]=M[S++]}while(--A);0===r.length&&(r.mode=21);break;case 26:if(0===v)break e;f[m++]=r.length,v--,r.mode=21;break;case 27:if(r.wrap){for(;b<32;){if(0===g)break e;g--,y|=d[p++]<<b,b+=8}if(w-=v,e.total_out+=w,r.total+=w,w&&(e.adler=r.check=r.flags?o(r.check,f,w,m-w):i(r.check,f,w,m-w)),w=v,(r.flags?y:h(y))!==r.check){e.msg="incorrect data check",r.mode=c;break}y=0,b=0}r.mode=28;case 28:if(r.wrap&&r.flags){for(;b<32;){if(0===g)break e;g--,y+=d[p++]<<b,b+=8}if(y!==(4294967295&r.total)){e.msg="incorrect length check",r.mode=c;break}y=0,b=0}r.mode=29;case 29:O=1;break e;case c:O=-3;break e;case 31:return-4;default:return l}return e.next_out=m,e.avail_out=v,e.next_in=p,e.avail_in=g,r.hold=y,r.bits=b,(r.wsize||w!==e.avail_out&&r.mode<c&&(r.mode<27||4!==t))&&_(e,e.output,e.next_out,w-e.avail_out)?(r.mode=31,-4):(E-=e.avail_in,w-=e.avail_out,e.total_in+=E,e.total_out+=w,r.total+=w,r.wrap&&w&&(e.adler=r.check=r.flags?o(r.check,f,w,e.next_out-w):i(r.check,f,w,e.next_out-w)),e.data_type=r.bits+(r.last?64:0)+(r.mode===u?128:0)+(20===r.mode||15===r.mode?256:0),(0===E&&0===w||4===t)&&0===O&&(O=-5),O)},t.inflateEnd=function(e){if(!e||!e.state)return l;var t=e.state;return t.window&&(t.window=null),e.state=null,0},t.inflateGetHeader=function(e,t){var r;return e&&e.state?0==(2&(r=e.state).wrap)?l:(r.head=t,t.done=!1,0):l},t.inflateSetDictionary=function(e,t){var r,n=t.length;return e&&e.state?0!==(r=e.state).wrap&&11!==r.mode?l:11===r.mode&&i(1,t,n,0)!==r.check?-3:_(e,t,n,n)?(r.mode=31,-4):(r.havedict=1,0):l},t.inflateInfo="pako inflate (from Nodeca project)"},9241:(e,t,r)=>{"use strict";var n=r(24236),i=15,o=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],a=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],s=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],l=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];e.exports=function(e,t,r,u,c,h,d,f){var p,m,g,v,y,b,x,_,E,w=f.bits,A=0,S=0,M=0,T=0,C=0,P=0,D=0,L=0,R=0,I=0,O=null,N=0,k=new n.Buf16(16),F=new n.Buf16(16),V=null,U=0;for(A=0;A<=i;A++)k[A]=0;for(S=0;S<u;S++)k[t[r+S]]++;for(C=w,T=i;T>=1&&0===k[T];T--);if(C>T&&(C=T),0===T)return c[h++]=20971520,c[h++]=20971520,f.bits=1,0;for(M=1;M<T&&0===k[M];M++);for(C<M&&(C=M),L=1,A=1;A<=i;A++)if(L<<=1,(L-=k[A])<0)return-1;if(L>0&&(0===e||1!==T))return-1;for(F[1]=0,A=1;A<i;A++)F[A+1]=F[A]+k[A];for(S=0;S<u;S++)0!==t[r+S]&&(d[F[t[r+S]]++]=S);if(0===e?(O=V=d,b=19):1===e?(O=o,N-=257,V=a,U-=257,b=256):(O=s,V=l,b=-1),I=0,S=0,A=M,y=h,P=C,D=0,g=-1,v=(R=1<<C)-1,1===e&&R>852||2===e&&R>592)return 1;for(;;){x=A-D,d[S]<b?(_=0,E=d[S]):d[S]>b?(_=V[U+d[S]],E=O[N+d[S]]):(_=96,E=0),p=1<<A-D,M=m=1<<P;do{c[y+(I>>D)+(m-=p)]=x<<24|_<<16|E|0}while(0!==m);for(p=1<<A-1;I&p;)p>>=1;if(0!==p?(I&=p-1,I+=p):I=0,S++,0==--k[A]){if(A===T)break;A=t[r+d[S]]}if(A>C&&(I&v)!==g){for(0===D&&(D=C),y+=M,L=1<<(P=A-D);P+D<T&&!((L-=k[P+D])<=0);)P++,L<<=1;if(R+=1<<P,1===e&&R>852||2===e&&R>592)return 1;c[g=I&v]=C<<24|P<<16|y-h|0}}return 0!==I&&(c[y+I]=A-D<<24|64<<16|0),f.bits=C,0}},48898:e=>{"use strict";e.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},10342:(e,t,r)=>{"use strict";var n=r(24236);function i(e){for(var t=e.length;--t>=0;)e[t]=0}var o=256,a=286,s=30,l=15,u=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],c=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],h=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],d=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],f=new Array(576);i(f);var p=new Array(60);i(p);var m=new Array(512);i(m);var g=new Array(256);i(g);var v=new Array(29);i(v);var y,b,x,_=new Array(s);function E(e,t,r,n,i){this.static_tree=e,this.extra_bits=t,this.extra_base=r,this.elems=n,this.max_length=i,this.has_stree=e&&e.length}function w(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function A(e){return e<256?m[e]:m[256+(e>>>7)]}function S(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function M(e,t,r){e.bi_valid>16-r?(e.bi_buf|=t<<e.bi_valid&65535,S(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=r-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=r)}function T(e,t,r){M(e,r[2*t],r[2*t+1])}function C(e,t){var r=0;do{r|=1&e,e>>>=1,r<<=1}while(--t>0);return r>>>1}function P(e,t,r){var n,i,o=new Array(16),a=0;for(n=1;n<=l;n++)o[n]=a=a+r[n-1]<<1;for(i=0;i<=t;i++){var s=e[2*i+1];0!==s&&(e[2*i]=C(o[s]++,s))}}function D(e){var t;for(t=0;t<a;t++)e.dyn_ltree[2*t]=0;for(t=0;t<s;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function L(e){e.bi_valid>8?S(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function R(e,t,r,n){var i=2*t,o=2*r;return e[i]<e[o]||e[i]===e[o]&&n[t]<=n[r]}function I(e,t,r){for(var n=e.heap[r],i=r<<1;i<=e.heap_len&&(i<e.heap_len&&R(t,e.heap[i+1],e.heap[i],e.depth)&&i++,!R(t,n,e.heap[i],e.depth));)e.heap[r]=e.heap[i],r=i,i<<=1;e.heap[r]=n}function O(e,t,r){var n,i,a,s,l=0;if(0!==e.last_lit)do{n=e.pending_buf[e.d_buf+2*l]<<8|e.pending_buf[e.d_buf+2*l+1],i=e.pending_buf[e.l_buf+l],l++,0===n?T(e,i,t):(T(e,(a=g[i])+o+1,t),0!==(s=u[a])&&M(e,i-=v[a],s),T(e,a=A(--n),r),0!==(s=c[a])&&M(e,n-=_[a],s))}while(l<e.last_lit);T(e,256,t)}function N(e,t){var r,n,i,o=t.dyn_tree,a=t.stat_desc.static_tree,s=t.stat_desc.has_stree,u=t.stat_desc.elems,c=-1;for(e.heap_len=0,e.heap_max=573,r=0;r<u;r++)0!==o[2*r]?(e.heap[++e.heap_len]=c=r,e.depth[r]=0):o[2*r+1]=0;for(;e.heap_len<2;)o[2*(i=e.heap[++e.heap_len]=c<2?++c:0)]=1,e.depth[i]=0,e.opt_len--,s&&(e.static_len-=a[2*i+1]);for(t.max_code=c,r=e.heap_len>>1;r>=1;r--)I(e,o,r);i=u;do{r=e.heap[1],e.heap[1]=e.heap[e.heap_len--],I(e,o,1),n=e.heap[1],e.heap[--e.heap_max]=r,e.heap[--e.heap_max]=n,o[2*i]=o[2*r]+o[2*n],e.depth[i]=(e.depth[r]>=e.depth[n]?e.depth[r]:e.depth[n])+1,o[2*r+1]=o[2*n+1]=i,e.heap[1]=i++,I(e,o,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],function(e,t){var r,n,i,o,a,s,u=t.dyn_tree,c=t.max_code,h=t.stat_desc.static_tree,d=t.stat_desc.has_stree,f=t.stat_desc.extra_bits,p=t.stat_desc.extra_base,m=t.stat_desc.max_length,g=0;for(o=0;o<=l;o++)e.bl_count[o]=0;for(u[2*e.heap[e.heap_max]+1]=0,r=e.heap_max+1;r<573;r++)(o=u[2*u[2*(n=e.heap[r])+1]+1]+1)>m&&(o=m,g++),u[2*n+1]=o,n>c||(e.bl_count[o]++,a=0,n>=p&&(a=f[n-p]),s=u[2*n],e.opt_len+=s*(o+a),d&&(e.static_len+=s*(h[2*n+1]+a)));if(0!==g){do{for(o=m-1;0===e.bl_count[o];)o--;e.bl_count[o]--,e.bl_count[o+1]+=2,e.bl_count[m]--,g-=2}while(g>0);for(o=m;0!==o;o--)for(n=e.bl_count[o];0!==n;)(i=e.heap[--r])>c||(u[2*i+1]!==o&&(e.opt_len+=(o-u[2*i+1])*u[2*i],u[2*i+1]=o),n--)}}(e,t),P(o,c,e.bl_count)}function k(e,t,r){var n,i,o=-1,a=t[1],s=0,l=7,u=4;for(0===a&&(l=138,u=3),t[2*(r+1)+1]=65535,n=0;n<=r;n++)i=a,a=t[2*(n+1)+1],++s<l&&i===a||(s<u?e.bl_tree[2*i]+=s:0!==i?(i!==o&&e.bl_tree[2*i]++,e.bl_tree[32]++):s<=10?e.bl_tree[34]++:e.bl_tree[36]++,s=0,o=i,0===a?(l=138,u=3):i===a?(l=6,u=3):(l=7,u=4))}function F(e,t,r){var n,i,o=-1,a=t[1],s=0,l=7,u=4;for(0===a&&(l=138,u=3),n=0;n<=r;n++)if(i=a,a=t[2*(n+1)+1],!(++s<l&&i===a)){if(s<u)do{T(e,i,e.bl_tree)}while(0!=--s);else 0!==i?(i!==o&&(T(e,i,e.bl_tree),s--),T(e,16,e.bl_tree),M(e,s-3,2)):s<=10?(T(e,17,e.bl_tree),M(e,s-3,3)):(T(e,18,e.bl_tree),M(e,s-11,7));s=0,o=i,0===a?(l=138,u=3):i===a?(l=6,u=3):(l=7,u=4)}}i(_);var V=!1;function U(e,t,r,i){M(e,0+(i?1:0),3),function(e,t,r,i){L(e),i&&(S(e,r),S(e,~r)),n.arraySet(e.pending_buf,e.window,t,r,e.pending),e.pending+=r}(e,t,r,!0)}t._tr_init=function(e){V||(!function(){var e,t,r,n,i,o=new Array(16);for(r=0,n=0;n<28;n++)for(v[n]=r,e=0;e<1<<u[n];e++)g[r++]=n;for(g[r-1]=n,i=0,n=0;n<16;n++)for(_[n]=i,e=0;e<1<<c[n];e++)m[i++]=n;for(i>>=7;n<s;n++)for(_[n]=i<<7,e=0;e<1<<c[n]-7;e++)m[256+i++]=n;for(t=0;t<=l;t++)o[t]=0;for(e=0;e<=143;)f[2*e+1]=8,e++,o[8]++;for(;e<=255;)f[2*e+1]=9,e++,o[9]++;for(;e<=279;)f[2*e+1]=7,e++,o[7]++;for(;e<=287;)f[2*e+1]=8,e++,o[8]++;for(P(f,287,o),e=0;e<s;e++)p[2*e+1]=5,p[2*e]=C(e,5);y=new E(f,u,257,a,l),b=new E(p,c,0,s,l),x=new E(new Array(0),h,0,19,7)}(),V=!0),e.l_desc=new w(e.dyn_ltree,y),e.d_desc=new w(e.dyn_dtree,b),e.bl_desc=new w(e.bl_tree,x),e.bi_buf=0,e.bi_valid=0,D(e)},t._tr_stored_block=U,t._tr_flush_block=function(e,t,r,n){var i,a,s=0;e.level>0?(2===e.strm.data_type&&(e.strm.data_type=function(e){var t,r=4093624447;for(t=0;t<=31;t++,r>>>=1)if(1&r&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<o;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0}(e)),N(e,e.l_desc),N(e,e.d_desc),s=function(e){var t;for(k(e,e.dyn_ltree,e.l_desc.max_code),k(e,e.dyn_dtree,e.d_desc.max_code),N(e,e.bl_desc),t=18;t>=3&&0===e.bl_tree[2*d[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}(e),i=e.opt_len+3+7>>>3,(a=e.static_len+3+7>>>3)<=i&&(i=a)):i=a=r+5,r+4<=i&&-1!==t?U(e,t,r,n):4===e.strategy||a===i?(M(e,2+(n?1:0),3),O(e,f,p)):(M(e,4+(n?1:0),3),function(e,t,r,n){var i;for(M(e,t-257,5),M(e,r-1,5),M(e,n-4,4),i=0;i<n;i++)M(e,e.bl_tree[2*d[i]+1],3);F(e,e.dyn_ltree,t-1),F(e,e.dyn_dtree,r-1)}(e,e.l_desc.max_code+1,e.d_desc.max_code+1,s+1),O(e,e.dyn_ltree,e.dyn_dtree)),D(e),n&&L(e)},t._tr_tally=function(e,t,r){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&r,e.last_lit++,0===t?e.dyn_ltree[2*r]++:(e.matches++,t--,e.dyn_ltree[2*(g[r]+o+1)]++,e.dyn_dtree[2*A(t)]++),e.last_lit===e.lit_bufsize-1},t._tr_align=function(e){M(e,2,3),T(e,256,f),function(e){16===e.bi_valid?(S(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)}(e)}},62292:e=>{"use strict";e.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},79916:e=>{function t(){this.pending=0,this.max=1/0,this.listeners=[],this.waiting=[],this.error=null}function r(e){e.pending+=1;var t=!1;return function(i){if(t)throw new Error("callback called twice");if(t=!0,e.error=e.error||i,e.pending-=1,e.waiting.length>0&&e.pending<e.max)n(e,e.waiting.shift());else if(0===e.pending){var o=e.listeners;e.listeners=[],o.forEach(r)}};function r(t){t(e.error)}}function n(e,t){t(r(e))}e.exports=t,t.prototype.go=function(e){this.pending<this.max?n(this,e):this.waiting.push(e)},t.prototype.wait=function(e){0===this.pending?e(this.error):this.listeners.push(e)},t.prototype.hold=function(){return r(this)}},74971:function(e,t,r){var n;/*! https://mths.be/punycode v1.3.2 by @mathias */e=r.nmd(e),function(i){t&&t.nodeType,e&&e.nodeType;var o="object"==typeof r.g&&r.g;o.global!==o&&o.window!==o&&o.self;var a,s=2147483647,l=36,u=/^xn--/,c=/[^\x20-\x7E]/,h=/[\x2E\u3002\uFF0E\uFF61]/g,d={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},f=Math.floor,p=String.fromCharCode;function m(e){throw RangeError(d[e])}function g(e,t){for(var r=e.length,n=[];r--;)n[r]=t(e[r]);return n}function v(e,t){var r=e.split("@"),n="";return r.length>1&&(n=r[0]+"@",e=r[1]),n+g((e=e.replace(h,".")).split("."),t).join(".")}function y(e){for(var t,r,n=[],i=0,o=e.length;i<o;)(t=e.charCodeAt(i++))>=55296&&t<=56319&&i<o?56320==(64512&(r=e.charCodeAt(i++)))?n.push(((1023&t)<<10)+(1023&r)+65536):(n.push(t),i--):n.push(t);return n}function b(e){return g(e,(function(e){var t="";return e>65535&&(t+=p((e-=65536)>>>10&1023|55296),e=56320|1023&e),t+=p(e)})).join("")}function x(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function _(e,t,r){var n=0;for(e=r?f(e/700):e>>1,e+=f(e/t);e>455;n+=l)e=f(e/35);return f(n+36*e/(e+38))}function E(e){var t,r,n,i,o,a,u,c,h,d,p,g=[],v=e.length,y=0,x=128,E=72;for((r=e.lastIndexOf("-"))<0&&(r=0),n=0;n<r;++n)e.charCodeAt(n)>=128&&m("not-basic"),g.push(e.charCodeAt(n));for(i=r>0?r+1:0;i<v;){for(o=y,a=1,u=l;i>=v&&m("invalid-input"),((c=(p=e.charCodeAt(i++))-48<10?p-22:p-65<26?p-65:p-97<26?p-97:l)>=l||c>f((s-y)/a))&&m("overflow"),y+=c*a,!(c<(h=u<=E?1:u>=E+26?26:u-E));u+=l)a>f(s/(d=l-h))&&m("overflow"),a*=d;E=_(y-o,t=g.length+1,0==o),f(y/t)>s-x&&m("overflow"),x+=f(y/t),y%=t,g.splice(y++,0,x)}return b(g)}function w(e){var t,r,n,i,o,a,u,c,h,d,g,v,b,E,w,A=[];for(v=(e=y(e)).length,t=128,r=0,o=72,a=0;a<v;++a)(g=e[a])<128&&A.push(p(g));for(n=i=A.length,i&&A.push("-");n<v;){for(u=s,a=0;a<v;++a)(g=e[a])>=t&&g<u&&(u=g);for(u-t>f((s-r)/(b=n+1))&&m("overflow"),r+=(u-t)*b,t=u,a=0;a<v;++a)if((g=e[a])<t&&++r>s&&m("overflow"),g==t){for(c=r,h=l;!(c<(d=h<=o?1:h>=o+26?26:h-o));h+=l)w=c-d,E=l-d,A.push(p(x(d+w%E,0))),c=f(w/E);A.push(p(x(c,0))),o=_(r,b,n==i),r=0,++n}++r,++t}return A.join("")}a={version:"1.3.2",ucs2:{decode:y,encode:b},decode:E,encode:w,toASCII:function(e){return v(e,(function(e){return c.test(e)?"xn--"+w(e):e}))},toUnicode:function(e){return v(e,(function(e){return u.test(e)?E(e.slice(4).toLowerCase()):e}))}},void 0===(n=function(){return a}.call(t,r,t,e))||(e.exports=n)}()},62587:e=>{"use strict";function t(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e,r,n,i){r=r||"&",n=n||"=";var o={};if("string"!=typeof e||0===e.length)return o;var a=/\+/g;e=e.split(r);var s=1e3;i&&"number"==typeof i.maxKeys&&(s=i.maxKeys);var l=e.length;s>0&&l>s&&(l=s);for(var u=0;u<l;++u){var c,h,d,f,p=e[u].replace(a,"%20"),m=p.indexOf(n);m>=0?(c=p.substr(0,m),h=p.substr(m+1)):(c=p,h=""),d=decodeURIComponent(c),f=decodeURIComponent(h),t(o,d)?Array.isArray(o[d])?o[d].push(f):o[d]=[o[d],f]:o[d]=f}return o}},12361:e=>{"use strict";var t=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};e.exports=function(e,r,n,i){return r=r||"&",n=n||"=",null===e&&(e=void 0),"object"==typeof e?Object.keys(e).map((function(i){var o=encodeURIComponent(t(i))+n;return Array.isArray(e[i])?e[i].map((function(e){return o+encodeURIComponent(t(e))})).join(r):o+encodeURIComponent(t(e[i]))})).join(r):i?encodeURIComponent(t(i))+n+encodeURIComponent(t(e)):""}},17673:(e,t,r)=>{"use strict";t.decode=t.parse=r(62587),t.encode=t.stringify=r(12361)},35666:e=>{var t=function(e){"use strict";var t,r=Object.prototype,n=r.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function l(e,t,r,n){var i=t&&t.prototype instanceof m?t:m,o=Object.create(i.prototype),a=new T(n||[]);return o._invoke=function(e,t,r){var n=c;return function(i,o){if(n===d)throw new Error("Generator is already running");if(n===f){if("throw"===i)throw o;return P()}for(r.method=i,r.arg=o;;){var a=r.delegate;if(a){var s=A(a,r);if(s){if(s===p)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(n===c)throw n=f,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n=d;var l=u(e,t,r);if("normal"===l.type){if(n=r.done?f:h,l.arg===p)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(n=f,r.method="throw",r.arg=l.arg)}}}(e,r,a),o}function u(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=l;var c="suspendedStart",h="suspendedYield",d="executing",f="completed",p={};function m(){}function g(){}function v(){}var y={};y[o]=function(){return this};var b=Object.getPrototypeOf,x=b&&b(b(C([])));x&&x!==r&&n.call(x,o)&&(y=x);var _=v.prototype=m.prototype=Object.create(y);function E(e){["next","throw","return"].forEach((function(t){e[t]=function(e){return this._invoke(t,e)}}))}function w(e,t){function r(i,o,a,s){var l=u(e[i],e,o);if("throw"!==l.type){var c=l.arg,h=c.value;return h&&"object"==typeof h&&n.call(h,"__await")?t.resolve(h.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(h).then((function(e){c.value=e,a(c)}),(function(e){return r("throw",e,a,s)}))}s(l.arg)}var i;this._invoke=function(e,n){function o(){return new t((function(t,i){r(e,n,t,i)}))}return i=i?i.then(o,o):o()}}function A(e,r){var n=e.iterator[r.method];if(n===t){if(r.delegate=null,"throw"===r.method){if(e.iterator.return&&(r.method="return",r.arg=t,A(e,r),"throw"===r.method))return p;r.method="throw",r.arg=new TypeError("The iterator does not provide a 'throw' method")}return p}var i=u(n,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,p;var o=i.arg;return o?o.done?(r[e.resultName]=o.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,p):o:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,p)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function M(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function T(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function C(e){if(e){var r=e[o];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,a=function r(){for(;++i<e.length;)if(n.call(e,i))return r.value=e[i],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}return{next:P}}function P(){return{value:t,done:!0}}return g.prototype=_.constructor=v,v.constructor=g,v[s]=g.displayName="GeneratorFunction",e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,s in e||(e[s]="GeneratorFunction")),e.prototype=Object.create(_),e},e.awrap=function(e){return{__await:e}},E(w.prototype),w.prototype[a]=function(){return this},e.AsyncIterator=w,e.async=function(t,r,n,i,o){void 0===o&&(o=Promise);var a=new w(l(t,r,n,i),o);return e.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},E(_),_[s]="Generator",_[o]=function(){return this},_.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var n=t.pop();if(n in e)return r.value=n,r.done=!1,r}return r.done=!0,r}},e.values=C,T.prototype={constructor:T,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(M),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function i(n,i){return s.type="throw",s.arg=e,r.next=n,i&&(r.method="next",r.arg=t),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var l=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(l&&u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,p):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),M(r),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;M(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:C(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),p}},e}(e.exports);try{regeneratorRuntime=t}catch(e){Function("r","regeneratorRuntime = r")(t)}},8575:(e,t,r)=>{var n=r(74971);function i(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}t.parse=v,t.resolve=function(e,t){return v(e,!1,!0).resolve(t)},t.resolveObject=function(e,t){return e?v(e,!1,!0).resolveObject(t):t},t.format=function(e){y(e)&&(e=v(e));return e instanceof i?e.format():i.prototype.format.call(e)},t.Url=i;var o=/^([a-z0-9.+-]+:)/i,a=/:[0-9]*$/,s=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),l=["'"].concat(s),u=["%","/","?",";","#"].concat(l),c=["/","?","#"],h=/^[a-z0-9A-Z_-]{0,63}$/,d=/^([a-z0-9A-Z_-]{0,63})(.*)$/,f={javascript:!0,"javascript:":!0},p={javascript:!0,"javascript:":!0},m={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},g=r(17673);function v(e,t,r){if(e&&b(e)&&e instanceof i)return e;var n=new i;return n.parse(e,t,r),n}function y(e){return"string"==typeof e}function b(e){return"object"==typeof e&&null!==e}function x(e){return null===e}i.prototype.parse=function(e,t,r){if(!y(e))throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var i=e;i=i.trim();var a=o.exec(i);if(a){var s=(a=a[0]).toLowerCase();this.protocol=s,i=i.substr(a.length)}if(r||a||i.match(/^\/\/[^@\/]+@[^@\/]+/)){var v="//"===i.substr(0,2);!v||a&&p[a]||(i=i.substr(2),this.slashes=!0)}if(!p[a]&&(v||a&&!m[a])){for(var b,x,_=-1,E=0;E<c.length;E++){-1!==(w=i.indexOf(c[E]))&&(-1===_||w<_)&&(_=w)}-1!==(x=-1===_?i.lastIndexOf("@"):i.lastIndexOf("@",_))&&(b=i.slice(0,x),i=i.slice(x+1),this.auth=decodeURIComponent(b)),_=-1;for(E=0;E<u.length;E++){var w;-1!==(w=i.indexOf(u[E]))&&(-1===_||w<_)&&(_=w)}-1===_&&(_=i.length),this.host=i.slice(0,_),i=i.slice(_),this.parseHost(),this.hostname=this.hostname||"";var A="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!A)for(var S=this.hostname.split(/\./),M=(E=0,S.length);E<M;E++){var T=S[E];if(T&&!T.match(h)){for(var C="",P=0,D=T.length;P<D;P++)T.charCodeAt(P)>127?C+="x":C+=T[P];if(!C.match(h)){var L=S.slice(0,E),R=S.slice(E+1),I=T.match(d);I&&(L.push(I[1]),R.unshift(I[2])),R.length&&(i="/"+R.join(".")+i),this.hostname=L.join(".");break}}}if(this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),!A){var O=this.hostname.split("."),N=[];for(E=0;E<O.length;++E){var k=O[E];N.push(k.match(/[^A-Za-z0-9_-]/)?"xn--"+n.encode(k):k)}this.hostname=N.join(".")}var F=this.port?":"+this.port:"",V=this.hostname||"";this.host=V+F,this.href+=this.host,A&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==i[0]&&(i="/"+i))}if(!f[s])for(E=0,M=l.length;E<M;E++){var U=l[E],B=encodeURIComponent(U);B===U&&(B=escape(U)),i=i.split(U).join(B)}var z=i.indexOf("#");-1!==z&&(this.hash=i.substr(z),i=i.slice(0,z));var G=i.indexOf("?");if(-1!==G?(this.search=i.substr(G),this.query=i.substr(G+1),t&&(this.query=g.parse(this.query)),i=i.slice(0,G)):t&&(this.search="",this.query={}),i&&(this.pathname=i),m[s]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){F=this.pathname||"",k=this.search||"";this.path=F+k}return this.href=this.format(),this},i.prototype.format=function(){var e=this.auth||"";e&&(e=(e=encodeURIComponent(e)).replace(/%3A/i,":"),e+="@");var t=this.protocol||"",r=this.pathname||"",n=this.hash||"",i=!1,o="";this.host?i=e+this.host:this.hostname&&(i=e+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(i+=":"+this.port)),this.query&&b(this.query)&&Object.keys(this.query).length&&(o=g.stringify(this.query));var a=this.search||o&&"?"+o||"";return t&&":"!==t.substr(-1)&&(t+=":"),this.slashes||(!t||m[t])&&!1!==i?(i="//"+(i||""),r&&"/"!==r.charAt(0)&&(r="/"+r)):i||(i=""),n&&"#"!==n.charAt(0)&&(n="#"+n),a&&"?"!==a.charAt(0)&&(a="?"+a),t+i+(r=r.replace(/[?#]/g,(function(e){return encodeURIComponent(e)})))+(a=a.replace("#","%23"))+n},i.prototype.resolve=function(e){return this.resolveObject(v(e,!1,!0)).format()},i.prototype.resolveObject=function(e){if(y(e)){var t=new i;t.parse(e,!1,!0),e=t}var r=new i;if(Object.keys(this).forEach((function(e){r[e]=this[e]}),this),r.hash=e.hash,""===e.href)return r.href=r.format(),r;if(e.slashes&&!e.protocol)return Object.keys(e).forEach((function(t){"protocol"!==t&&(r[t]=e[t])})),m[r.protocol]&&r.hostname&&!r.pathname&&(r.path=r.pathname="/"),r.href=r.format(),r;if(e.protocol&&e.protocol!==r.protocol){if(!m[e.protocol])return Object.keys(e).forEach((function(t){r[t]=e[t]})),r.href=r.format(),r;if(r.protocol=e.protocol,e.host||p[e.protocol])r.pathname=e.pathname;else{for(var n=(e.pathname||"").split("/");n.length&&!(e.host=n.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==n[0]&&n.unshift(""),n.length<2&&n.unshift(""),r.pathname=n.join("/")}if(r.search=e.search,r.query=e.query,r.host=e.host||"",r.auth=e.auth,r.hostname=e.hostname||e.host,r.port=e.port,r.pathname||r.search){var o=r.pathname||"",a=r.search||"";r.path=o+a}return r.slashes=r.slashes||e.slashes,r.href=r.format(),r}var s=r.pathname&&"/"===r.pathname.charAt(0),l=e.host||e.pathname&&"/"===e.pathname.charAt(0),u=l||s||r.host&&e.pathname,c=u,h=r.pathname&&r.pathname.split("/")||[],d=(n=e.pathname&&e.pathname.split("/")||[],r.protocol&&!m[r.protocol]);if(d&&(r.hostname="",r.port=null,r.host&&(""===h[0]?h[0]=r.host:h.unshift(r.host)),r.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===n[0]?n[0]=e.host:n.unshift(e.host)),e.host=null),u=u&&(""===n[0]||""===h[0])),l)r.host=e.host||""===e.host?e.host:r.host,r.hostname=e.hostname||""===e.hostname?e.hostname:r.hostname,r.search=e.search,r.query=e.query,h=n;else if(n.length)h||(h=[]),h.pop(),h=h.concat(n),r.search=e.search,r.query=e.query;else if(null!=e.search){if(d)r.hostname=r.host=h.shift(),(_=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@"))&&(r.auth=_.shift(),r.host=r.hostname=_.shift());return r.search=e.search,r.query=e.query,x(r.pathname)&&x(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.href=r.format(),r}if(!h.length)return r.pathname=null,r.search?r.path="/"+r.search:r.path=null,r.href=r.format(),r;for(var f=h.slice(-1)[0],g=(r.host||e.host)&&("."===f||".."===f)||""===f,v=0,b=h.length;b>=0;b--)"."==(f=h[b])?h.splice(b,1):".."===f?(h.splice(b,1),v++):v&&(h.splice(b,1),v--);if(!u&&!c)for(;v--;v)h.unshift("..");!u||""===h[0]||h[0]&&"/"===h[0].charAt(0)||h.unshift(""),g&&"/"!==h.join("/").substr(-1)&&h.push("");var _,E=""===h[0]||h[0]&&"/"===h[0].charAt(0);d&&(r.hostname=r.host=E?"":h.length?h.shift():"",(_=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@"))&&(r.auth=_.shift(),r.host=r.hostname=_.shift()));return(u=u||r.host&&h.length)&&!E&&h.unshift(""),h.length?r.pathname=h.join("/"):(r.pathname=null,r.path=null),x(r.pathname)&&x(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.auth=e.auth||r.auth,r.slashes=r.slashes||e.slashes,r.href=r.format(),r},i.prototype.parseHost=function(){var e=this.host,t=a.exec(e);t&&(":"!==(t=t[0])&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)}},15523:e=>{"use strict";e.exports="DELETED_WORKERNODE"},74617:()=>{},75725:()=>{},80959:()=>{},78322:()=>{},83154:(e,t,r)=>{var n;if("function"==typeof fetch&&(void 0!==r.g&&r.g.fetch?n=r.g.fetch:"undefined"!=typeof window&&window.fetch&&(n=window.fetch)),"undefined"==typeof window||void 0===window.document){var i=n||r(54098);i.default&&(i=i.default),t.default=i,e.exports=t.default}},30325:e=>{"use strict";e.exports=JSON.parse('{"globals":{"dimension":{},"factor":{"factor":1},"factor.derived":{"parentFactors":{}},"quantity":{"units":[]},"symbol":{"doc":"http://docs.adskunits.apiary.io/#introduction/definitions/unit-symbols","unit":{"typeid":"unit","description":"Measurement unit this symbol applies to."}},"symbol.placement":{"Prefix":{"value":0},"Suffix":1},"symbol.prefixOrSuffix":{"text":{"typeid":"String","description":"Text to annotate the value."},"placement":{"typeid":"symbol.placement","description":"Placement of the annotation text."},"space":{"typeid":"Bool","description":"Specifies whether the annotation should be separated from the value by a space."}},"system":{"Metric":{"value":0,"description":"Metric system of measurement units."},"Imperial":1},"unit":{"doc":"http://docs.adskunits.apiary.io/#introduction/definitions/measurement-units","unitSystem":{"typeid":"system"}},"unit.absolute":{"parentUnit":{"typeid":"unit.relative","description":"Relative unit from which this absolute unit is derived."},"offset":{"typeid":"Float64","value":0,"description":"An offset used to position an absolute scale of measurement on the number line."}},"unit.derived":{"parentFactors":{},"parentUnits":{}},"unit.primitive":{},"unit.primitive.dimensional":{"dimension":{"typeid":"dimension"}},"unit.relative":{}},"factor":{"nineFifths":{"factor":1.8},"pi":{"factor":3.14159265358979},"atto":{"parentFactors":{"ten":-18}},"centi":{"parentFactors":{"ten":-2}},"deci":{"parentFactors":{"ten":-1}},"deka":{"parentFactors":{"ten":1}},"exa":{"parentFactors":{"ten":18}},"femto":{"parentFactors":{"ten":-15}},"giga":{"parentFactors":{"ten":9}},"hecto":{"parentFactors":{"ten":2}},"kilo":{"parentFactors":{"ten":3}},"mega":{"parentFactors":{"ten":6}},"micro":{"parentFactors":{"ten":-6}},"milli":{"parentFactors":{"ten":-3}},"nano":{"parentFactors":{"ten":-9}},"peta":{"parentFactors":{"ten":15}},"pico":{"parentFactors":{"ten":-12}},"tera":{"parentFactors":{"ten":12}},"yocto":{"parentFactors":{"ten":-24}},"yotta":{"parentFactors":{"ten":24}},"zepto":{"parentFactors":{"ten":-21}},"zetta":{"parentFactors":{"ten":21}},"ten":{"factor":10},"threeHundredSixty":{"factor":360},"threeThousandNineHundredThirtySeven":{"factor":3937},"twelve":{"factor":12}},"dimension":{"currency":{},"electricCurrent":{},"length":{},"luminousIntensity":{},"mass":{},"temperature":{},"time":{}},"unit":{"1ToRatio":{"unitSystem":"Metric","parentUnits":{"ratioTo1":-1},"symbols":{"1Colon":{"text":"1:","placement":"Prefix","space":false}}},"acres":{"unitSystem":"Imperial","factor":4840,"parentUnits":{"squareYards":1},"symbols":{"acres":{"text":"acres","placement":"Suffix","space":true}}},"ampereHours":{"unitSystem":"Metric","parentUnits":{"amperes":1,"hours":1},"symbols":{"aDashH":{"text":"A-h","placement":"Suffix","space":true}}},"ampereSeconds":{"unitSystem":"Metric","parentUnits":{"amperes":1,"seconds":1},"symbols":{"aDashS":{"text":"A-s","placement":"Suffix","space":true}}},"amperes":{"unitSystem":"Metric","dimension":"electricCurrent","symbols":{"ampere":{"text":"A","placement":"Suffix","space":true}}},"atmospheres":{"unitSystem":"Imperial","factor":101325,"parentUnits":{"pascals":1},"symbols":{"atm":{"text":"atm","placement":"Suffix","space":true}}},"bars":{"unitSystem":"Metric","factor":100,"parentUnits":{"kilopascals":1},"symbols":{"bar":{"text":"bar","placement":"Suffix","space":true}}},"britishThermalUnits":{"unitSystem":"Imperial","factor":1055.05585262,"parentUnits":{"joules":1},"symbols":{"btu":{"text":"Btu","placement":"Suffix","space":true}}},"britishThermalUnitsPerDegreeFahrenheit":{"unitSystem":"Imperial","parentUnits":{"britishThermalUnits":1,"fahrenheitInterval":-1},"symbols":{"btuPerDegreeF":{"text":"BTU/F","placement":"Suffix","space":true}}},"britishThermalUnitsPerHour":{"unitSystem":"Imperial","parentUnits":{"britishThermalUnits":1,"hours":-1},"symbols":{"btuPerH":{"text":"Btu/h","placement":"Suffix","space":true}}},"britishThermalUnitsPerHourCubicFoot":{"unitSystem":"Imperial","parentUnits":{"britishThermalUnitsPerHour":1,"cubicFeet":-1},"symbols":{"btuPerHFtSup3":{"text":"Btu/(hft)","placement":"Suffix","space":true}}},"britishThermalUnitsPerHourFootDegreeFahrenheit":{"unitSystem":"Imperial","parentUnits":{"britishThermalUnitsPerHour":1,"feet":-1,"fahrenheitInterval":-1},"symbols":{"btuPerHFtDegreeF":{"text":"BTU/(hftF)","placement":"Suffix","space":true}}},"britishThermalUnitsPerHourSquareFoot":{"unitSystem":"Imperial","parentUnits":{"britishThermalUnitsPerHour":1,"squareFeet":-1},"symbols":{"btuPerHFtSup2":{"text":"Btu/(hft)","placement":"Suffix","space":true}}},"britishThermalUnitsPerHourSquareFootDegreeFahrenheit":{"unitSystem":"Imperial","parentUnits":{"britishThermalUnitsPerHourSquareFoot":1,"fahrenheitInterval":-1},"symbols":{"btuPerHFtSup2DegreeF":{"text":"BTU/(hftF)","placement":"Suffix","space":true}}},"britishThermalUnitsPerPound":{"unitSystem":"Imperial","parentUnits":{"britishThermalUnits":1,"poundsMass":-1},"symbols":{"btuPerLb":{"text":"BTU/lb","placement":"Suffix","space":true}}},"britishThermalUnitsPerPoundDegreeFahrenheit":{"unitSystem":"Imperial","parentUnits":{"britishThermalUnitsPerPound":1,"fahrenheitInterval":-1},"symbols":{"btuPerLbDegreeF":{"text":"BTU/(lbF)","placement":"Suffix","space":true}}},"britishThermalUnitsPerSecond":{"unitSystem":"Imperial","parentUnits":{"britishThermalUnits":1,"seconds":-1},"symbols":{"btuPerS":{"text":"Btu/s","placement":"Suffix","space":true}}},"britishThermalUnitsPerSquareFootDegreeFahrenheit":{"unitSystem":"Imperial","parentUnits":{"britishThermalUnits":1,"squareFeet":-1,"fahrenheitInterval":-1},"symbols":{"btuPerFtSup2DegreeF":{"text":"BTU/(ftF)","placement":"Suffix","space":true}}},"calories":{"unitSystem":"Metric","factor":4.1868,"parentUnits":{"joules":1},"symbols":{"cal":{"text":"cal","placement":"Suffix","space":true}}},"caloriesPerSecond":{"unitSystem":"Metric","parentUnits":{"calories":1,"seconds":-1},"symbols":{"calPerS":{"text":"cal/s","placement":"Suffix","space":true}}},"candelas":{"unitSystem":"Metric","dimension":"luminousIntensity","symbols":{"cd":{"text":"cd","placement":"Suffix","space":true}}},"candelasPerSquareFoot":{"unitSystem":"Imperial","parentUnits":{"candelas":1,"squareFeet":-1},"symbols":{"cdPerFtSup2":{"text":"cd/ft","placement":"Suffix","space":true}}},"candelasPerSquareMeter":{"unitSystem":"Metric","parentUnits":{"candelas":1,"squareMeters":-1},"symbols":{"cdPerMSup2":{"text":"cd/m","placement":"Suffix","space":true}}},"celsius":{"unitSystem":"Metric","parentUnit":"celsiusInterval","offset":273.15,"symbols":{"degreeC":{"text":"C","placement":"Suffix","space":true}}},"celsiusInterval":{"unitSystem":"Metric","parentUnits":{"kelvinInterval":1},"symbols":{"degreeCInterval":{"text":"C","placement":"Suffix","space":true},"deltaDegreeC":{"text":"deltaC","placement":"Suffix","space":true}}},"centimeters":{"unitSystem":"Metric","parentFactors":{"centi":1},"parentUnits":{"meters":1},"symbols":{"cm":{"text":"cm","placement":"Suffix","space":true}}},"centimetersPerMinute":{"unitSystem":"Metric","parentUnits":{"centimeters":1,"minutes":-1},"symbols":{"cmPerMin":{"text":"cm/min","placement":"Suffix","space":true}}},"centimetersToTheFourthPower":{"unitSystem":"Metric","parentUnits":{"centimeters":4},"symbols":{"cmSup4":{"text":"cm","placement":"Suffix","space":true}}},"centimetersToTheSixthPower":{"unitSystem":"Metric","parentUnits":{"centimeters":6},"symbols":{"cmSup6":{"text":"cm","placement":"Suffix","space":true}}},"centipoises":{"unitSystem":"Metric","parentFactors":{"centi":1},"parentUnits":{"poises":1},"symbols":{"cP":{"text":"cP","placement":"Suffix","space":true}}},"circularMils":{"unitSystem":"Imperial","factor":0.25,"parentFactors":{"pi":1},"parentUnits":{"squareMils":1},"symbols":{"cMil":{"text":"cmil","placement":"Suffix","space":true}}},"coulombs":{"unitSystem":"Metric","parentUnits":{"ampereSeconds":1},"symbols":{"coulomb":{"text":"C","placement":"Suffix","space":true}}},"cubicCentimeters":{"defaultSymbol":"cmSup3","unitSystem":"Metric","parentUnits":{"centimeters":3},"symbols":{"cmCaret3":{"text":"cm^3","placement":"Suffix","space":true},"cmSup3":{"text":"cm","placement":"Suffix","space":true}}},"cubicFeet":{"defaultSymbol":"ftSup3","unitSystem":"Imperial","parentUnits":{"feet":3},"symbols":{"cf":{"text":"CF","placement":"Suffix","space":true},"ftCaret3":{"text":"ft^3","placement":"Suffix","space":true},"ftSup3":{"text":"ft","placement":"Suffix","space":true}}},"cubicFeetPerHour":{"defaultSymbol":"ftSup3PerHour","unitSystem":"Imperial","parentUnits":{"cubicFeet":1,"hours":-1},"symbols":{"cfh":{"text":"CFH","placement":"Suffix","space":true},"ftSup3PerH":{"text":"ft/h","placement":"Suffix","space":true}}},"cubicFeetPerKip":{"unitSystem":"Imperial","parentUnits":{"cubicFeet":1,"kips":-1},"symbols":{"ftSup3PerKip":{"text":"ft/kip","placement":"Suffix","space":true}}},"cubicFeetPerMinute":{"defaultSymbol":"ftSup3PerMin","unitSystem":"Imperial","parentUnits":{"cubicFeet":1,"minutes":-1},"symbols":{"cfm":{"text":"CFM","placement":"Suffix","space":true},"ftSup3PerMin":{"text":"ft/min","placement":"Suffix","space":true}}},"cubicFeetPerMinuteCubicFoot":{"defaultSymbol":"cfmPerFtSup3","unitSystem":"Imperial","parentUnits":{"cubicFeetPerMinute":1,"cubicFeet":-1},"symbols":{"cfmPerCf":{"text":"CFM/CF","placement":"Suffix","space":true},"cfmPerFtSup3":{"text":"CFM/ft","placement":"Suffix","space":true}}},"cubicFeetPerMinutePerBritishThermalUnitPerHour":{"unitSystem":"Imperial","parentUnits":{"cubicFeetPerMinute":1,"britishThermalUnitsPerHour":-1},"symbols":{"ftSup3HPerMinBtu":{"text":"fth/(minBtu)","placement":"Suffix","space":true}}},"cubicFeetPerMinuteSquareFoot":{"defaultSymbol":"cfmPerFtSup2","unitSystem":"Imperial","parentUnits":{"cubicFeetPerMinute":1,"squareFeet":-1},"symbols":{"cfmPerFtSup2":{"text":"CFM/ft","placement":"Suffix","space":true},"cfmPerSf":{"text":"CFM/SF","placement":"Suffix","space":true}}},"cubicFeetPerMinuteSquareMeter":{"unitSystem":"Metric","parentUnits":{"cubicFeetPerMinute":1,"squareMeters":-1}},"cubicFeetPerMinuteTonOfRefrigeration":{"unitSystem":"Imperial","parentUnits":{"cubicFeetPerMinute":1,"tonsOfRefrigeration":-1},"symbols":{"cfmPerTon":{"text":"CFM/ton","placement":"Suffix","space":true}}},"cubicFeetPerPoundMass":{"unitSystem":"Imperial","parentUnits":{"cubicFeet":1,"poundsMass":-1},"symbols":{"ftSup3PerLbMass":{"text":"ft/lb","placement":"Suffix","space":true}}},"cubicInches":{"defaultSymbol":"inSup3","unitSystem":"Imperial","parentUnits":{"inches":3},"symbols":{"inCaret3":{"text":"in^3","placement":"Suffix","space":true},"inSup3":{"text":"in","placement":"Suffix","space":true}}},"cubicMeters":{"defaultSymbol":"mSup3","unitSystem":"Metric","parentUnits":{"meters":3},"symbols":{"mCaret3":{"text":"m^3","placement":"Suffix","space":true},"mSup3":{"text":"m","placement":"Suffix","space":true}}},"cubicMetersPerHour":{"defaultSymbol":"mSup3PerH","unitSystem":"Metric","parentUnits":{"cubicMeters":1,"hours":-1},"symbols":{"cmh":{"text":"CMH","placement":"Suffix","space":true},"mSup3PerH":{"text":"m/h","placement":"Suffix","space":true}}},"cubicMetersPerHourCubicMeter":{"unitSystem":"Metric","parentUnits":{"cubicMetersPerHour":1,"cubicMeters":-1},"symbols":{"mSup3PerHMSup3":{"text":"m/(hm)","placement":"Suffix","space":true}}},"cubicMetersPerHourSquareMeter":{"unitSystem":"Metric","parentUnits":{"cubicMetersPerHour":1,"squareMeters":-1},"symbols":{"mSup3PerHMSup2":{"text":"m/(hm)","placement":"Suffix","space":true}}},"cubicMetersPerKilogram":{"unitSystem":"Metric","parentUnits":{"cubicMeters":1,"kilograms":-1},"symbols":{"mSup3PerKg":{"text":"m/kg","placement":"Suffix","space":true}}},"cubicMetersPerKilonewton":{"unitSystem":"Metric","parentUnits":{"cubicMeters":1,"kilonewtons":-1},"symbols":{"mSup3PerKN":{"text":"m/kN","placement":"Suffix","space":true}}},"cubicMetersPerSecond":{"defaultSymbol":"mSup3PerS","unitSystem":"Metric","parentUnits":{"cubicMeters":1,"seconds":-1},"symbols":{"cms":{"text":"CMS","placement":"Suffix","space":true},"mSup3PerS":{"text":"m/s","placement":"Suffix","space":true}}},"cubicMetersPerWattSecond":{"unitSystem":"Metric","parentUnits":{"cubicMeters":1,"watts":-1,"seconds":-1},"symbols":{"mSup3PerWS":{"text":"m/(Ws)","placement":"Suffix","space":true}}},"cubicMillimeters":{"defaultSymbol":"mmSup3","unitSystem":"Metric","parentUnits":{"millimeters":3},"symbols":{"mmCaret3":{"text":"mm^3","placement":"Suffix","space":true},"mmSup3":{"text":"mm","placement":"Suffix","space":true}}},"cubicYards":{"unitSystem":"Imperial","parentUnits":{"yards":3},"symbols":{"cy":{"text":"CY","placement":"Suffix","space":true}}},"currency":{"defaultSymbol":"usDollar","unitSystem":"Imperial","dimension":"currency","symbols":{"baht":{"description":"Baht is the official currency of Thailand.","text":"","placement":"Prefix","space":false},"chineseHongKongDollar":{"description":"Hong Kong Dollar is the official currency of Hong Kong..","text":"HK$","placement":"Prefix","space":false},"dong":{"description":"Dong is the official currency of Vietnam.","text":"","placement":"Suffix","space":false},"euroPrefix":{"text":"","placement":"Prefix","space":false},"euroSuffix":{"text":"","placement":"Suffix","space":false},"krone":{"description":"Krone is the official currency of Denmark, Greenland, and the Faroe Islands.","text":"kr","placement":"Suffix","space":true},"shekel":{"description":"Shekel is the official currency of Israel.","text":"","placement":"Prefix","space":false},"ukPound":{"text":"","placement":"Prefix","space":false},"usDollar":{"text":"$","placement":"Prefix","space":false},"won":{"description":"Won is the official currency of South Korea.","text":"","placement":"Prefix","space":false},"yen":{"text":"","placement":"Prefix","space":false}}},"currencyPerBritishThermalUnit":{"unitSystem":"Imperial","parentUnits":{"currency":1,"britishThermalUnits":-1},"symbols":{"dollarPerBtu":{"text":"$/Btu","placement":"Suffix","space":true}}},"currencyPerBritishThermalUnitPerHour":{"unitSystem":"Imperial","parentUnits":{"currency":1,"britishThermalUnitsPerHour":-1},"symbols":{"dollarHPerBtu":{"text":"$h/Btu","placement":"Suffix","space":true}}},"currencyPerSquareFoot":{"unitSystem":"Imperial","parentUnits":{"currency":1,"squareFeet":-1},"symbols":{"dollarPerFtSup2":{"text":"$/ft","placement":"Suffix","space":true}}},"currencyPerSquareMeter":{"unitSystem":"Metric","parentUnits":{"currency":1,"squareMeters":-1},"symbols":{"dollarPerMSup2":{"text":"$/m","placement":"Suffix","space":true}}},"currencyPerWatt":{"unitSystem":"Metric","parentUnits":{"currency":1,"watts":-1},"symbols":{"dollarPerW":{"text":"$/W","placement":"Suffix","space":true}}},"currencyPerWattHour":{"unitSystem":"Metric","parentUnits":{"currency":1,"watts":-1,"hours":-1},"symbols":{"dollarPerWH":{"text":"$/(Wh)","placement":"Suffix","space":true}}},"cyclesPerSecond":{"unitSystem":"Metric","parentUnits":{"seconds":-1},"symbols":{"cps":{"text":"cps","placement":"Suffix","space":true}}},"decimeters":{"unitSystem":"Metric","parentFactors":{"deci":1},"parentUnits":{"meters":1},"symbols":{"dm":{"text":"dm","placement":"Suffix","space":true}}},"degrees":{"defaultSymbol":"degree","unitSystem":"Metric","parentFactors":{"threeHundredSixty":-1},"parentUnits":{"turns":1},"symbols":{"degree":{"text":"","placement":"Suffix","space":false},"degreesMinutesSeconds":{"inherits":"symbol"}}},"dekanewtonMeters":{"unitSystem":"Metric","parentUnits":{"dekanewtons":1,"meters":1},"symbols":{"daNDashM":{"text":"daN-m","placement":"Suffix","space":true}}},"dekanewtonMetersPerMeter":{"unitSystem":"Metric","parentUnits":{"dekanewtonMeters":1,"meters":-1},"symbols":{"daNDashMPerM":{"text":"daN-m/m","placement":"Suffix","space":true}}},"dekanewtons":{"unitSystem":"Metric","parentFactors":{"deka":1},"parentUnits":{"newtons":1},"symbols":{"daN":{"text":"daN","placement":"Suffix","space":true}}},"dekanewtonsPerMeter":{"unitSystem":"Metric","parentUnits":{"dekanewtons":1,"meters":-1},"symbols":{"daNPerM":{"text":"daN/m","placement":"Suffix","space":true}}},"dekanewtonsPerSquareMeter":{"unitSystem":"Metric","parentUnits":{"dekanewtons":1,"squareMeters":-1},"symbols":{"daNPerMSup2":{"text":"daN/m","placement":"Suffix","space":true}}},"dynes":{"unitSystem":"Metric","factor":10,"parentFactors":{"micro":1},"parentUnits":{"newtons":1},"symbols":{"dyn":{"text":"dyn","placement":"Suffix","space":true}}},"ergs":{"unitSystem":"Metric","parentFactors":{"ten":-7},"parentUnits":{"joules":1},"symbols":{"erg":{"text":"erg","placement":"Suffix","space":true}}},"fahrenheit":{"unitSystem":"Imperial","parentUnit":"fahrenheitInterval","offset":459.67,"symbols":{"degreeF":{"text":"F","placement":"Suffix","space":true}}},"fahrenheitInterval":{"defaultSymbol":"degreeFInterval","unitSystem":"Imperial","parentUnits":{"rankineInterval":1},"symbols":{"degreeFInterval":{"text":"F","placement":"Suffix","space":true},"deltaDegreeF":{"text":"deltaF","placement":"Suffix","space":true}}},"farads":{"unitSystem":"Metric","parentUnits":{"coulombs":1,"volts":-1},"symbols":{"farad":{"text":"F","placement":"Suffix","space":true}}},"feet":{"defaultSymbol":"feetAndInches","unitSystem":"Imperial","factor":12,"parentUnits":{"inches":1},"symbols":{"feetAndInches":{"inherits":"symbol"},"footSingleQuote":{"text":"\'","placement":"Suffix","space":false},"ft":{"text":"ft","placement":"Suffix","space":true},"lf":{"text":"LF","placement":"Suffix","space":true}}},"feetOfWater39.2DegreesFahrenheit":{"defaultSymbol":"feetOfWater","unitSystem":"Imperial","factor":2988.98,"parentUnits":{"pascals":1},"symbols":{"feetOfWater":{"text":"Feet","placement":"Suffix","space":true},"ftH2O":{"text":"ftH2O","placement":"Suffix","space":true},"ftOfWater":{"text":"FT","placement":"Suffix","space":true}}},"feetOfWater39.2DegreesFahrenheitPer100Feet":{"defaultSymbol":"feetOfWaterPer100ft","unitSystem":"Imperial","factor":0.01,"parentUnits":{"feetOfWater39.2DegreesFahrenheit":1,"feet":-1},"symbols":{"feetOfWaterPer100ft":{"text":"Feet/100ft","placement":"Suffix","space":true},"ftH2OPer100ft":{"text":"ftH2O/100ft","placement":"Suffix","space":true},"ftOfWaterPer100ft":{"text":"FT/100ft","placement":"Suffix","space":true}}},"feetPerKip":{"unitSystem":"Imperial","parentUnits":{"feet":1,"kips":-1},"symbols":{"ftPerKip":{"text":"ft/kip","placement":"Suffix","space":true}}},"feetPerKipFoot":{"unitSystem":"Imperial","parentUnits":{"feet":1,"kipFeet":-1},"symbols":{"ftPerKipDashFt":{"text":"ft/kip-ft","placement":"Suffix","space":true}}},"feetPerMinute":{"defaultSymbol":"fpm","unitSystem":"Imperial","parentUnits":{"feet":1,"minutes":-1},"symbols":{"fpm":{"text":"FPM","placement":"Suffix","space":true},"ftPerMin":{"text":"ft/min","placement":"Suffix","space":true}}},"feetPerSecond":{"defaultSymbol":"fps","unitSystem":"Imperial","parentUnits":{"feet":1,"seconds":-1},"symbols":{"fps":{"text":"FPS","placement":"Suffix","space":true},"ftPerS":{"text":"ft/s","placement":"Suffix","space":true}}},"feetPerSecondSquared":{"unitSystem":"Imperial","parentUnits":{"feetPerSecond":1,"seconds":-1},"symbols":{"ftPerSSup2":{"text":"ft/s","placement":"Suffix","space":true}}},"feetToTheFourthPower":{"unitSystem":"Imperial","parentUnits":{"feet":4},"symbols":{"ftSup4":{"text":"ft","placement":"Suffix","space":true}}},"feetToTheSixthPower":{"unitSystem":"Imperial","parentUnits":{"feet":6},"symbols":{"ftSup6":{"text":"ft","placement":"Suffix","space":true}}},"fixed":{"unitSystem":"Metric","parentUnits":{"ratioTo1":1}},"footcandles":{"defaultSymbol":"fc","unitSystem":"Imperial","parentUnits":{"lumens":1,"squareFeet":-1},"symbols":{"fc":{"text":"fc","placement":"Suffix","space":true},"ftc":{"text":"Ftc","placement":"Suffix","space":true}}},"footlamberts":{"defaultSymbol":"fL","unitSystem":"Imperial","parentFactors":{"pi":-1},"parentUnits":{"candelas":1,"squareFeet":-1},"symbols":{"fL":{"text":"fL","placement":"Suffix","space":true},"flLowercase":{"text":"fl","placement":"Suffix","space":true},"ftL":{"text":"ftL","placement":"Suffix","space":true}}},"gammas":{"unitSystem":"Metric","parentFactors":{"nano":1},"parentUnits":{"teslas":1},"symbols":{"gamma":{"text":"gamma","placement":"Suffix","space":true}}},"gauss":{"unitSystem":"Metric","parentFactors":{"ten":-4},"parentUnits":{"teslas":1},"symbols":{"gs":{"text":"Gs","placement":"Suffix","space":true}}},"general":{"unitSystem":"Metric","parentUnits":{"ratioTo1":1}},"gigajoules":{"unitSystem":"Metric","parentFactors":{"giga":1},"parentUnits":{"joules":1}},"gradians":{"unitSystem":"Metric","factor":0.9,"parentUnits":{"degrees":1},"symbols":{"grad":{"text":"grad","placement":"Suffix","space":true}}},"grains":{"unitSystem":"Imperial","factor":64.79891,"parentUnits":{"milligrams":1},"symbols":{"gr":{"text":"gr","placement":"Suffix","space":true}}},"grainsPerHourSquareFootInchMercury":{"unitSystem":"Imperial","parentUnits":{"grains":1,"hours":-1,"squareFeet":-1,"inchesOfMercury32DegreesFahrenheit":-1},"symbols":{"grPerHFtSup2InHg":{"text":"gr/(hftinHg)","placement":"Suffix","space":true}}},"grams":{"unitSystem":"Metric","factor":0.001,"parentUnits":{"kilograms":1},"symbols":{"gram":{"text":"g","placement":"Suffix","space":true}}},"hectares":{"unitSystem":"Metric","parentUnits":{"squareHectometers":1},"symbols":{"hectare":{"text":"hectare","placement":"Suffix","space":true}}},"hectometers":{"unitSystem":"Metric","parentFactors":{"hecto":1},"parentUnits":{"meters":1},"symbols":{"hm":{"text":"hm","placement":"Suffix","space":true}}},"henries":{"unitSystem":"Metric","parentUnits":{"ohms":1,"seconds":1},"symbols":{"henry":{"text":"H","placement":"Suffix","space":true}}},"hertz":{"unitSystem":"Metric","parentUnits":{"cyclesPerSecond":1},"symbols":{"hz":{"text":"Hz","placement":"Suffix","space":true}}},"horsepower":{"unitSystem":"Imperial","factor":33000,"parentUnits":{"poundForceFeet":1,"minutes":-1},"symbols":{"hp":{"text":"hp","placement":"Suffix","space":true}}},"hourSquareFootDegreesFahrenheitPerBritishThermalUnit":{"unitSystem":"Imperial","parentUnits":{"hours":1,"squareFeet":1,"fahrenheitInterval":1,"britishThermalUnits":-1},"symbols":{"hFtSup2DegreeFPerBtu":{"text":"(hftF)/BTU","placement":"Suffix","space":true}}},"hours":{"unitSystem":"Metric","factor":60,"parentUnits":{"minutes":1},"symbols":{"hour":{"text":"h","placement":"Suffix","space":true}}},"inches":{"defaultSymbol":"in","unitSystem":"Imperial","factor":2.54,"parentUnits":{"centimeters":1},"symbols":{"in":{"text":"in","placement":"Suffix","space":true},"inchDoubleQuote":{"text":"\\"","placement":"Suffix","space":false}}},"inchesOfMercury32DegreesFahrenheit":{"unitSystem":"Imperial","factor":3386.389,"parentUnits":{"pascals":1},"symbols":{"inHg":{"text":"inHg","placement":"Suffix","space":true}}},"inchesOfWater60DegreesFahrenheit":{"unitSystem":"Imperial","factor":248.84,"parentUnits":{"pascals":1},"symbols":{"inDashWg":{"text":"in-wg","placement":"Suffix","space":true}}},"inchesOfWater60DegreesFahrenheitPer100Feet":{"unitSystem":"Imperial","factor":0.01,"parentUnits":{"inchesOfWater60DegreesFahrenheit":1,"feet":-1},"symbols":{"inDashWgPer100ft":{"text":"in-wg/100ft","placement":"Suffix","space":true}}},"inchesPerSecond":{"unitSystem":"Imperial","parentUnits":{"inches":1,"seconds":-1},"symbols":{"inPerS":{"text":"in/s","placement":"Suffix","space":true}}},"inchesPerSecondSquared":{"unitSystem":"Imperial","parentUnits":{"inchesPerSecond":1,"seconds":-1},"symbols":{"inPerSSup2":{"text":"in/s","placement":"Suffix","space":true}}},"inchesToTheFourthPower":{"unitSystem":"Imperial","parentUnits":{"inches":4},"symbols":{"inSup4":{"text":"in","placement":"Suffix","space":true}}},"inchesToTheSixthPower":{"unitSystem":"Imperial","parentUnits":{"inches":6},"symbols":{"inSup6":{"text":"in","placement":"Suffix","space":true}}},"inverseDegreesCelsius":{"unitSystem":"Metric","parentUnits":{"celsiusInterval":-1},"symbols":{"invDegreeC":{"text":"1/C","placement":"Suffix","space":true}}},"inverseDegreesFahrenheit":{"unitSystem":"Imperial","parentUnits":{"fahrenheitInterval":-1},"symbols":{"invDegreeF":{"text":"1/F","placement":"Suffix","space":true}}},"inverseKilonewtons":{"unitSystem":"Metric","parentUnits":{"kilonewtons":-1},"symbols":{"invKN":{"text":"1/kN","placement":"Suffix","space":true}}},"inverseKips":{"unitSystem":"Imperial","parentUnits":{"kips":-1},"symbols":{"invKip":{"text":"1/kip","placement":"Suffix","space":true}}},"joules":{"unitSystem":"Metric","parentUnits":{"newtonMeters":1},"symbols":{"joule":{"text":"J","placement":"Suffix","space":true}}},"joulesPerGram":{"unitSystem":"Metric","parentUnits":{"joules":1,"grams":-1},"symbols":{"jPerG":{"text":"J/g","placement":"Suffix","space":true}}},"joulesPerGramDegreeCelsius":{"unitSystem":"Metric","parentUnits":{"joulesPerGram":1,"celsiusInterval":-1},"symbols":{"jPerGDegreeC":{"text":"J/(gC)","placement":"Suffix","space":true}}},"joulesPerKelvin":{"unitSystem":"Metric","parentUnits":{"joules":1,"kelvinInterval":-1},"symbols":{"jPerK":{"text":"J/K","placement":"Suffix","space":true}}},"joulesPerKilogram":{"unitSystem":"Metric","parentUnits":{"joules":1,"kilograms":-1},"symbols":{"jPerKg":{"text":"J/kg","placement":"Suffix","space":true}}},"joulesPerKilogramDegreeCelsius":{"unitSystem":"Metric","parentUnits":{"joulesPerKilogram":1,"celsiusInterval":-1},"symbols":{"jPerKgDegreeC":{"text":"J/(kgC)","placement":"Suffix","space":true}}},"joulesPerSquareMeterKelvin":{"unitSystem":"Metric","parentUnits":{"joules":1,"squareMeters":-1,"kelvinInterval":-1},"symbols":{"jPerMSup2K":{"text":"J/(mK)","placement":"Suffix","space":true}}},"kelvin":{"unitSystem":"Metric","parentUnit":"kelvinInterval","symbols":{"kelvin":{"text":"K","placement":"Suffix","space":true}}},"kelvinInterval":{"defaultSymbol":"deltaK","unitSystem":"Metric","dimension":"temperature","symbols":{"deltaK":{"text":"deltaK","placement":"Suffix","space":true},"kelvinInterval":{"text":"K","placement":"Suffix","space":true}}},"kiloamperes":{"unitSystem":"Metric","parentFactors":{"kilo":1},"parentUnits":{"amperes":1},"symbols":{"kA":{"text":"kA","placement":"Suffix","space":true}}},"kilocalories":{"unitSystem":"Metric","parentFactors":{"kilo":1},"parentUnits":{"calories":1},"symbols":{"kcal":{"text":"kcal","placement":"Suffix","space":true}}},"kilocaloriesPerSecond":{"unitSystem":"Metric","parentUnits":{"kilocalories":1,"seconds":-1},"symbols":{"kcalPerS":{"text":"kcal/s","placement":"Suffix","space":true}}},"kilogramForceMeters":{"unitSystem":"Metric","parentUnits":{"kilogramsForce":1,"meters":1},"symbols":{"kgfDashM":{"text":"kgf-m","placement":"Suffix","space":true}}},"kilogramForceMetersPerMeter":{"unitSystem":"Metric","parentUnits":{"kilogramForceMeters":1,"meters":-1},"symbols":{"kgfDashMPerM":{"text":"kgf-m/m","placement":"Suffix","space":true}}},"kilogramKelvins":{"unitSystem":"Metric","parentUnits":{"kilograms":1,"kelvinInterval":1},"symbols":{"kgK":{"text":"kgK","placement":"Suffix","space":true}}},"kilograms":{"unitSystem":"Metric","dimension":"mass","symbols":{"kg":{"text":"kg","placement":"Suffix","space":true}}},"kilogramsForce":{"unitSystem":"Metric","parentUnits":{"kilograms":1,"standardGravity":1},"symbols":{"kgf":{"text":"kgf","placement":"Suffix","space":true}}},"kilogramsForcePerMeter":{"unitSystem":"Metric","parentUnits":{"kilogramsForce":1,"meters":-1},"symbols":{"kgfPerM":{"text":"kgf/m","placement":"Suffix","space":true}}},"kilogramsForcePerSquareMeter":{"unitSystem":"Metric","parentUnits":{"kilogramsForce":1,"squareMeters":-1},"symbols":{"kgfPerMSup2":{"text":"kgf/m","placement":"Suffix","space":true}}},"kilogramsPerCubicCentimeter":{"unitSystem":"Metric","parentUnits":{"kilograms":1,"cubicCentimeters":-1}},"kilogramsPerCubicMeter":{"unitSystem":"Metric","parentUnits":{"kilograms":1,"cubicMeters":-1},"symbols":{"kgPerMSup3":{"text":"kg/m","placement":"Suffix","space":true}}},"kilogramsPerHour":{"unitSystem":"Metric","parentUnits":{"kilograms":1,"hours":-1},"symbols":{"kgPerH":{"text":"kg/h","placement":"Suffix","space":true}}},"kilogramsPerKilogramKelvin":{"unitSystem":"Metric","parentUnits":{"kilograms":1,"kilogramKelvins":-1},"symbols":{"kgPerKgK":{"text":"kg/(kgK)","placement":"Suffix","space":true}}},"kilogramsPerMeter":{"unitSystem":"Metric","parentUnits":{"kilograms":1,"meters":-1},"symbols":{"kgPerM":{"text":"kg/m","placement":"Suffix","space":true}}},"kilogramsPerMeterHour":{"unitSystem":"Metric","parentUnits":{"kilograms":1,"meters":-1,"hours":-1},"symbols":{"kgPerMH":{"text":"kg/(mh)","placement":"Suffix","space":true}}},"kilogramsPerMeterSecond":{"unitSystem":"Metric","parentUnits":{"kilograms":1,"meters":-1,"seconds":-1},"symbols":{"kgPerMS":{"text":"kg/(ms)","placement":"Suffix","space":true}}},"kilogramsPerMinute":{"unitSystem":"Metric","parentUnits":{"kilograms":1,"minutes":-1},"symbols":{"kgPerMin":{"text":"kg/min","placement":"Suffix","space":true}}},"kilogramsPerSecond":{"unitSystem":"Metric","parentUnits":{"kilograms":1,"seconds":-1},"symbols":{"kgPerS":{"text":"kg/s","placement":"Suffix","space":true}}},"kilogramsPerSquareMeter":{"unitSystem":"Metric","parentUnits":{"kilograms":1,"squareMeters":-1},"symbols":{"kgPerMSup2":{"text":"kg/m","placement":"Suffix","space":true}}},"kilojoules":{"unitSystem":"Metric","parentFactors":{"kilo":1},"parentUnits":{"joules":1},"symbols":{"kJ":{"text":"kJ","placement":"Suffix","space":true}}},"kilojoulesPerKelvin":{"unitSystem":"Metric","parentUnits":{"kilojoules":1,"kelvinInterval":-1},"symbols":{"kJPerK":{"text":"kJ/K","placement":"Suffix","space":true}}},"kilojoulesPerSquareMeterKelvin":{"unitSystem":"Metric","parentUnits":{"kilojoules":1,"squareMeters":-1,"kelvinInterval":-1},"symbols":{"kJPerMSup2K":{"text":"kJ/(mK)","placement":"Suffix","space":true}}},"kilometers":{"unitSystem":"Metric","parentFactors":{"kilo":1},"parentUnits":{"meters":1},"symbols":{"km":{"text":"km","placement":"Suffix","space":true}}},"kilometersPerHour":{"unitSystem":"Metric","parentUnits":{"kilometers":1,"hours":-1},"symbols":{"kmPerH":{"text":"km/h","placement":"Suffix","space":true}}},"kilometersPerSecond":{"unitSystem":"Metric","parentUnits":{"kilometers":1,"seconds":-1},"symbols":{"kmPerS":{"text":"km/s","placement":"Suffix","space":true}}},"kilometersPerSecondSquared":{"unitSystem":"Metric","parentUnits":{"kilometersPerSecond":1,"seconds":-1},"symbols":{"kmPerSSup2":{"text":"km/s","placement":"Suffix","space":true}}},"kilonewtonMeters":{"unitSystem":"Metric","parentUnits":{"kilonewtons":1,"meters":1},"symbols":{"kNDashM":{"text":"kN-m","placement":"Suffix","space":true}}},"kilonewtonMetersPerDegree":{"unitSystem":"Metric","parentUnits":{"kilonewtonMeters":1,"degrees":-1},"symbols":{"kNDashMPerDegree":{"text":"kN-m/","placement":"Suffix","space":true}}},"kilonewtonMetersPerDegreePerMeter":{"unitSystem":"Metric","parentUnits":{"kilonewtonMetersPerDegree":1,"meters":-1},"symbols":{"kNDashMPerDegreePerM":{"text":"kN-m//m","placement":"Suffix","space":true}}},"kilonewtonMetersPerMeter":{"unitSystem":"Metric","parentUnits":{"kilonewtonMeters":1,"meters":-1},"symbols":{"kNDashMPerM":{"text":"kN-m/m","placement":"Suffix","space":true}}},"kilonewtons":{"unitSystem":"Metric","parentFactors":{"kilo":1},"parentUnits":{"newtons":1},"symbols":{"kN":{"text":"kN","placement":"Suffix","space":true}}},"kilonewtonsPerCubicMeter":{"unitSystem":"Metric","parentUnits":{"kilonewtons":1,"cubicMeters":-1},"symbols":{"kNPerMSup3":{"text":"kN/m","placement":"Suffix","space":true}}},"kilonewtonsPerMeter":{"unitSystem":"Metric","parentUnits":{"kilonewtons":1,"meters":-1},"symbols":{"kNPerM":{"text":"kN/m","placement":"Suffix","space":true}}},"kilonewtonsPerSquareCentimeter":{"unitSystem":"Metric","parentUnits":{"kilonewtons":1,"squareCentimeters":-1},"symbols":{"kNPerCmSup2":{"text":"kN/cm","placement":"Suffix","space":true}}},"kilonewtonsPerSquareMeter":{"unitSystem":"Metric","parentUnits":{"kilonewtons":1,"squareMeters":-1},"symbols":{"kNPerMSup2":{"text":"kN/m","placement":"Suffix","space":true}}},"kilonewtonsPerSquareMillimeter":{"unitSystem":"Metric","parentUnits":{"kilonewtons":1,"squareMillimeters":-1},"symbols":{"kNPerMmSup2":{"text":"kN/mm","placement":"Suffix","space":true}}},"kilopascals":{"unitSystem":"Metric","parentFactors":{"kilo":1},"parentUnits":{"pascals":1},"symbols":{"kPa":{"text":"kPa","placement":"Suffix","space":true}}},"kilovoltAmperes":{"unitSystem":"Metric","parentUnits":{"kilovolts":1,"amperes":1},"symbols":{"kVA":{"text":"kVA","placement":"Suffix","space":true}}},"kilovolts":{"unitSystem":"Metric","parentFactors":{"kilo":1},"parentUnits":{"volts":1},"symbols":{"kV":{"text":"kV","placement":"Suffix","space":true}}},"kilowattHours":{"unitSystem":"Metric","parentUnits":{"kilowatts":1,"hours":1},"symbols":{"kWh":{"text":"kWh","placement":"Suffix","space":true}}},"kilowattHoursPerSquareMeter":{"unitSystem":"Metric","parentUnits":{"kilowattHours":1,"squareMeters":-1},"symbols":{"kWhPerMSup2":{"text":"kWh/m","placement":"Suffix","space":true}}},"kilowatts":{"unitSystem":"Metric","parentFactors":{"kilo":1},"parentUnits":{"watts":1},"symbols":{"kW":{"text":"kW","placement":"Suffix","space":true}}},"kipFeet":{"unitSystem":"Imperial","parentUnits":{"kips":1,"feet":1},"symbols":{"kipDashFt":{"text":"kip-ft","placement":"Suffix","space":true}}},"kipFeetPerDegree":{"unitSystem":"Imperial","parentUnits":{"kipFeet":1,"degrees":-1},"symbols":{"kipDashFtPerDegree":{"text":"kip-ft/","placement":"Suffix","space":true}}},"kipFeetPerDegreePerFoot":{"unitSystem":"Imperial","parentUnits":{"kipFeetPerDegree":1,"feet":-1},"symbols":{"kipDashFtPerDegreePerFt":{"text":"kip-ft//ft","placement":"Suffix","space":true}}},"kipFeetPerFoot":{"unitSystem":"Imperial","parentUnits":{"kipFeet":1,"feet":-1},"symbols":{"kipDashFtPerFt":{"text":"kip-ft/ft","placement":"Suffix","space":true}}},"kips":{"unitSystem":"Imperial","parentFactors":{"kilo":1},"parentUnits":{"poundsForce":1},"symbols":{"kip":{"text":"kip","placement":"Suffix","space":true}}},"kipsPerCubicFoot":{"unitSystem":"Imperial","parentUnits":{"kips":1,"cubicFeet":-1},"symbols":{"kipPerFtSup3":{"text":"kip/ft","placement":"Suffix","space":true}}},"kipsPerCubicInch":{"unitSystem":"Imperial","parentUnits":{"kips":1,"cubicInches":-1},"symbols":{"kipPerInSup3":{"text":"kip/in","placement":"Suffix","space":true}}},"kipsPerFoot":{"unitSystem":"Imperial","parentUnits":{"kips":1,"feet":-1},"symbols":{"kipPerFt":{"text":"kip/ft","placement":"Suffix","space":true}}},"kipsPerInch":{"unitSystem":"Imperial","parentUnits":{"kips":1,"inches":-1},"symbols":{"kipPerIn":{"text":"kip/in","placement":"Suffix","space":true}}},"kipsPerSquareFoot":{"defaultSymbol":"kipPerFtSup2","unitSystem":"Imperial","parentUnits":{"kips":1,"squareFeet":-1},"symbols":{"kipPerFtSup2":{"text":"kip/ft","placement":"Suffix","space":true},"ksf":{"text":"ksf","placement":"Suffix","space":true}}},"kipsPerSquareInch":{"defaultSymbol":"kipPerInSup2","unitSystem":"Imperial","parentUnits":{"kips":1,"squareInches":-1},"symbols":{"kipPerInSup2":{"text":"kip/in","placement":"Suffix","space":true},"ksi":{"text":"ksi","placement":"Suffix","space":true}}},"liters":{"unitSystem":"Metric","parentUnits":{"decimeters":3},"symbols":{"liter":{"text":"L","placement":"Suffix","space":true}}},"litersPerHour":{"unitSystem":"Metric","parentUnits":{"liters":1,"hours":-1},"symbols":{"lPerH":{"text":"L/h","placement":"Suffix","space":true}}},"litersPerMinute":{"defaultSymbol":"lPerMin","unitSystem":"Metric","parentUnits":{"liters":1,"minutes":-1},"symbols":{"lPerMin":{"text":"L/min","placement":"Suffix","space":true},"lpm":{"text":"LPM","placement":"Suffix","space":true}}},"litersPerSecond":{"defaultSymbol":"lPerS","unitSystem":"Metric","parentUnits":{"liters":1,"seconds":-1},"symbols":{"lPerS":{"text":"L/s","placement":"Suffix","space":true},"lps":{"text":"LPS","placement":"Suffix","space":true}}},"litersPerSecondCubicMeter":{"unitSystem":"Metric","parentUnits":{"litersPerSecond":1,"cubicMeters":-1},"symbols":{"lPerSMSup3":{"text":"L/(sm)","placement":"Suffix","space":true}}},"litersPerSecondKilowatt":{"unitSystem":"Metric","parentUnits":{"litersPerSecond":1,"kilowatts":-1},"symbols":{"lPerSKw":{"text":"L/(skW)","placement":"Suffix","space":true}}},"litersPerSecondSquareMeter":{"defaultSymbol":"lPerSMSup2","unitSystem":"Metric","parentUnits":{"litersPerSecond":1,"squareMeters":-1},"symbols":{"lPerSMSup2":{"text":"L/(sm)","placement":"Suffix","space":true},"lpsPerMSup2":{"text":"LPS/m","placement":"Suffix","space":true}}},"lumens":{"unitSystem":"Metric","parentUnits":{"candelas":1,"steradians":1},"symbols":{"lm":{"text":"lm","placement":"Suffix","space":true}}},"lumensPerWatt":{"unitSystem":"Metric","parentUnits":{"lumens":1,"watts":-1},"symbols":{"lmPerW":{"text":"lm/W","placement":"Suffix","space":true}}},"lux":{"unitSystem":"Metric","parentUnits":{"lumens":1,"squareMeters":-1},"symbols":{"lx":{"text":"lx","placement":"Suffix","space":true}}},"maxwells":{"unitSystem":"Metric","parentFactors":{"ten":-8},"parentUnits":{"webers":1},"symbols":{"mx":{"text":"Mx","placement":"Suffix","space":true}}},"megajoules":{"unitSystem":"Metric","parentFactors":{"mega":1},"parentUnits":{"joules":1}},"megajoulesPerSquareMeter":{"unitSystem":"Metric","parentUnits":{"megajoules":1,"squareMeters":-1}},"meganewtonMeters":{"unitSystem":"Metric","parentUnits":{"meganewtons":1,"meters":1},"symbols":{"mNDashM":{"text":"MN-m","placement":"Suffix","space":true}}},"meganewtonMetersPerMeter":{"unitSystem":"Metric","parentUnits":{"meganewtonMeters":1,"meters":-1},"symbols":{"mNDashMPerM":{"text":"MN-m/m","placement":"Suffix","space":true}}},"meganewtons":{"unitSystem":"Metric","parentFactors":{"mega":1},"parentUnits":{"newtons":1},"symbols":{"mN":{"text":"MN","placement":"Suffix","space":true}}},"meganewtonsPerMeter":{"unitSystem":"Metric","parentUnits":{"meganewtons":1,"meters":-1},"symbols":{"mNPerM":{"text":"MN/m","placement":"Suffix","space":true}}},"meganewtonsPerSquareMeter":{"unitSystem":"Metric","parentUnits":{"meganewtons":1,"squareMeters":-1},"symbols":{"mNPerMSup2":{"text":"MN/m","placement":"Suffix","space":true}}},"megapascals":{"unitSystem":"Metric","parentFactors":{"mega":1},"parentUnits":{"pascals":1},"symbols":{"mPa":{"text":"MPa","placement":"Suffix","space":true}}},"megawattHours":{"unitSystem":"Metric","parentUnits":{"megawatts":1,"hours":1},"symbols":{"mWh":{"text":"mWh","placement":"Suffix","space":true}}},"megawatts":{"unitSystem":"Metric","parentFactors":{"mega":1},"parentUnits":{"watts":1}},"meters":{"defaultSymbol":"meter","unitSystem":"Metric","dimension":"length","symbols":{"meter":{"text":"m","placement":"Suffix","space":true},"metersAndCentimeters":{"inherits":"symbol"}}},"metersOfWaterColumn":{"unitSystem":"Metric","parentUnits":{"meters":1,"standardGravity":1,"waterDensity4DegreesCelsius":1},"symbols":{"mH2O":{"text":"mH2O","placement":"Suffix","space":true}}},"metersOfWaterColumnPerMeter":{"unitSystem":"Metric","parentUnits":{"metersOfWaterColumn":1,"meters":-1},"symbols":{"mH2OPerM":{"text":"mH2O/m","placement":"Suffix","space":true}}},"metersPerKilonewton":{"unitSystem":"Metric","parentUnits":{"meters":1,"kilonewtons":-1},"symbols":{"mPerKN":{"text":"m/kN","placement":"Suffix","space":true}}},"metersPerKilonewtonMeter":{"unitSystem":"Metric","parentUnits":{"meters":1,"kilonewtonMeters":-1},"symbols":{"mPerKNDashM":{"text":"m/kN-m","placement":"Suffix","space":true}}},"metersPerSecond":{"unitSystem":"Metric","parentUnits":{"meters":1,"seconds":-1},"symbols":{"mPerS":{"text":"m/s","placement":"Suffix","space":true}}},"metersPerSecondSquared":{"unitSystem":"Metric","parentUnits":{"metersPerSecond":1,"seconds":-1},"symbols":{"mPerSSup2":{"text":"m/s","placement":"Suffix","space":true}}},"metersToTheFourthPower":{"unitSystem":"Metric","parentUnits":{"meters":4},"symbols":{"mSup4":{"text":"m","placement":"Suffix","space":true}}},"metersToTheSixthPower":{"unitSystem":"Metric","parentUnits":{"meters":6},"symbols":{"mSup6":{"text":"m","placement":"Suffix","space":true}}},"mhos":{"unitSystem":"Metric","parentUnits":{"ohms":-1},"symbols":{"mho":{"text":"mho","placement":"Suffix","space":true}}},"microinches":{"unitSystem":"Imperial","parentFactors":{"micro":1},"parentUnits":{"inches":1},"symbols":{"uin":{"text":"in","placement":"Suffix","space":true}}},"microinchesPerInchDegreeFahrenheit":{"unitSystem":"Imperial","parentFactors":{"micro":1},"parentUnits":{"inverseDegreesFahrenheit":1},"symbols":{"uinPerInDegreeF":{"text":"in/(inF)","placement":"Suffix","space":true}}},"micrometersPerMeterDegreeCelsius":{"unitSystem":"Metric","parentFactors":{"micro":1},"parentUnits":{"inverseDegreesCelsius":1},"symbols":{"umPerMDegreeC":{"text":"m/(mC)","placement":"Suffix","space":true}}},"microns":{"unitSystem":"Metric","parentFactors":{"micro":1},"parentUnits":{"meters":1},"symbols":{"micron":{"text":"micron","placement":"Suffix","space":true}}},"miles":{"unitSystem":"Imperial","factor":1760,"parentUnits":{"yards":1},"symbols":{"mi":{"text":"mi","placement":"Suffix","space":true}}},"milesPerHour":{"unitSystem":"Imperial","parentUnits":{"miles":1,"hours":-1},"symbols":{"mph":{"text":"mph","placement":"Suffix","space":true}}},"milesPerSecond":{"unitSystem":"Imperial","parentUnits":{"miles":1,"seconds":-1},"symbols":{"miPerS":{"text":"mi/s","placement":"Suffix","space":true}}},"milesPerSecondSquared":{"unitSystem":"Imperial","parentUnits":{"milesPerSecond":1,"seconds":-1},"symbols":{"miPerSSup2":{"text":"mi/s","placement":"Suffix","space":true}}},"milliamperes":{"unitSystem":"Metric","parentFactors":{"milli":1},"parentUnits":{"amperes":1},"symbols":{"mA":{"text":"mA","placement":"Suffix","space":true}}},"milligrams":{"unitSystem":"Metric","parentFactors":{"milli":1},"parentUnits":{"grams":1},"symbols":{"mg":{"text":"mg","placement":"Suffix","space":true}}},"millimeters":{"unitSystem":"Metric","parentFactors":{"milli":1},"parentUnits":{"meters":1},"symbols":{"mm":{"text":"mm","placement":"Suffix","space":true}}},"millimetersOfMercury":{"unitSystem":"Metric","factor":133.3224,"parentUnits":{"pascals":1},"symbols":{"mmHg":{"text":"mmHg","placement":"Suffix","space":true}}},"millimetersOfWaterColumn":{"unitSystem":"Metric","parentFactors":{"milli":1},"parentUnits":{"metersOfWaterColumn":1},"symbols":{"mmH2O":{"text":"mmH2O","placement":"Suffix","space":true}}},"millimetersOfWaterColumnPerMeter":{"unitSystem":"Metric","parentUnits":{"millimetersOfWaterColumn":1,"meters":-1},"symbols":{"mmH2OPerM":{"text":"mmH2O/m","placement":"Suffix","space":true}}},"millimetersToTheFourthPower":{"unitSystem":"Metric","parentUnits":{"millimeters":4},"symbols":{"mmSup4":{"text":"mm","placement":"Suffix","space":true}}},"millimetersToTheSixthPower":{"unitSystem":"Metric","parentUnits":{"millimeters":6},"symbols":{"mmSup6":{"text":"mm","placement":"Suffix","space":true}}},"milliseconds":{"unitSystem":"Metric","parentFactors":{"milli":1},"parentUnits":{"seconds":1},"symbols":{"ms":{"text":"ms","placement":"Suffix","space":true}}},"millivolts":{"unitSystem":"Metric","parentFactors":{"milli":1},"parentUnits":{"volts":1},"symbols":{"mV":{"text":"mV","placement":"Suffix","space":true}}},"mils":{"unitSystem":"Imperial","parentFactors":{"milli":1},"parentUnits":{"inches":1},"symbols":{"mil":{"text":"mil","placement":"Suffix","space":true}}},"minutes":{"unitSystem":"Metric","factor":60,"parentUnits":{"seconds":1},"symbols":{"min":{"text":"min","placement":"Suffix","space":true}}},"nanograms":{"unitSystem":"Metric","parentFactors":{"nano":1},"parentUnits":{"grams":1},"symbols":{"ng":{"text":"ng","placement":"Suffix","space":true}}},"nanogramsPerPascalSecondSquareMeter":{"unitSystem":"Metric","parentUnits":{"nanograms":1,"seconds":-1,"squareMeters":-1,"pascals":-1},"symbols":{"ngPerPaSMSup2":{"text":"ng/(Pasm)","placement":"Suffix","space":true}}},"nanometers":{"unitSystem":"Metric","parentFactors":{"nano":1},"parentUnits":{"meters":1},"symbols":{"nm":{"text":"nm","placement":"Suffix","space":true}}},"nauticalMiles":{"unitSystem":"Imperial","factor":1852,"parentUnits":{"meters":1},"symbols":{"nauticalMile":{"text":"M","placement":"Suffix","space":true}}},"newtonMeters":{"unitSystem":"Metric","parentUnits":{"newtons":1,"meters":1},"symbols":{"nDashM":{"text":"N-m","placement":"Suffix","space":true}}},"newtonMetersPerMeter":{"unitSystem":"Metric","parentUnits":{"newtonMeters":1,"meters":-1},"symbols":{"nDashMPerM":{"text":"N-m/m","placement":"Suffix","space":true}}},"newtonSecondsPerSquareMeter":{"unitSystem":"Metric","parentUnits":{"newtons":1,"seconds":1,"squareMeters":-1},"symbols":{"nSPerMSup2":{"text":"Ns/m","placement":"Suffix","space":true}}},"newtons":{"unitSystem":"Metric","parentUnits":{"kilograms":1,"metersPerSecondSquared":1},"symbols":{"newton":{"text":"N","placement":"Suffix","space":true}}},"newtonsPerMeter":{"unitSystem":"Metric","parentUnits":{"newtons":1,"meters":-1},"symbols":{"nPerM":{"text":"N/m","placement":"Suffix","space":true}}},"newtonsPerSquareMeter":{"unitSystem":"Metric","parentUnits":{"newtons":1,"squareMeters":-1},"symbols":{"nPerMSup2":{"text":"N/m","placement":"Suffix","space":true}}},"newtonsPerSquareMillimeter":{"unitSystem":"Metric","parentUnits":{"newtons":1,"squareMillimeters":-1},"symbols":{"nPerMmSup2":{"text":"N/mm","placement":"Suffix","space":true}}},"oersteds":{"unitSystem":"Metric","factor":250,"parentFactors":{"pi":-1},"parentUnits":{"amperes":1,"meters":-1},"symbols":{"oe":{"text":"Oe","placement":"Suffix","space":true}}},"ohmMeters":{"unitSystem":"Metric","parentUnits":{"ohms":1,"meters":1},"symbols":{"ohmM":{"text":"ohmm","placement":"Suffix","space":true}}},"ohms":{"defaultSymbol":"omega","unitSystem":"Metric","parentUnits":{"volts":1,"amperes":-1},"symbols":{"ohm":{"text":"ohm","placement":"Suffix","space":true},"omega":{"text":"","placement":"Suffix","space":true}}},"ouncesForce":{"unitSystem":"Imperial","factor":0.0625,"parentUnits":{"poundsForce":1},"symbols":{"ozf":{"text":"ozf","placement":"Suffix","space":true}}},"ouncesMass":{"unitSystem":"Imperial","factor":0.0625,"parentUnits":{"poundsMass":1},"symbols":{"oz":{"text":"oz","placement":"Suffix","space":true}}},"pascalSeconds":{"unitSystem":"Metric","parentUnits":{"pascals":1,"seconds":1},"symbols":{"paDashS":{"text":"Pa-s","placement":"Suffix","space":true}}},"pascals":{"unitSystem":"Metric","parentUnits":{"newtonsPerSquareMeter":1},"symbols":{"pa":{"text":"Pa","placement":"Suffix","space":true}}},"pascalsPerMeter":{"unitSystem":"Metric","parentUnits":{"pascals":1,"meters":-1},"symbols":{"paPerM":{"text":"Pa/m","placement":"Suffix","space":true}}},"perMille":{"unitSystem":"Metric","parentFactors":{"milli":1},"parentUnits":{"ratioTo1":1},"symbols":{"perMille":{"text":"","placement":"Suffix","space":false}}},"percentage":{"unitSystem":"Metric","parentFactors":{"centi":1},"parentUnits":{"ratioTo1":1},"symbols":{"percent":{"text":"%","placement":"Suffix","space":false}}},"pi":{"unitSystem":"Imperial","parentFactors":{"pi":1},"parentUnits":{"radians":1},"symbols":{"pi":{"text":"","placement":"Suffix","space":true}}},"poises":{"unitSystem":"Metric","parentUnits":{"grams":1,"centimeters":-1,"seconds":-1},"symbols":{"poise":{"text":"P","placement":"Suffix","space":true}}},"poundForceFeet":{"defaultSymbol":"lbForceDashFt","unitSystem":"Imperial","parentUnits":{"poundsForce":1,"feet":1},"symbols":{"lbForceDashFt":{"text":"lb-ft","placement":"Suffix","space":true},"lbfDashFt":{"text":"lbf-ft","placement":"Suffix","space":true}}},"poundForceFeetPerFoot":{"defaultSymbol":"lbForceDashFtPerFt","unitSystem":"Imperial","parentUnits":{"poundForceFeet":1,"feet":-1},"symbols":{"lbForceDashFtPerFt":{"text":"lb-ft/ft","placement":"Suffix","space":true},"lbfDashFtPerFt":{"text":"lbf-ft/ft","placement":"Suffix","space":true}}},"poundForceSecondsPerSquareFoot":{"unitSystem":"Imperial","parentUnits":{"poundsForce":1,"seconds":1,"squareFeet":-1},"symbols":{"lbForceSPerFtSup2":{"text":"lbs/ft","placement":"Suffix","space":true}}},"poundMassDegreesFahrenheit":{"unitSystem":"Imperial","parentUnits":{"poundsMass":1,"fahrenheitInterval":1},"symbols":{"lbMassDegreeF":{"text":"lbF","placement":"Suffix","space":true}}},"poundsForce":{"defaultSymbol":"lbForce","unitSystem":"Imperial","parentUnits":{"poundsMass":1,"standardGravity":1},"symbols":{"lbForce":{"text":"lb","placement":"Suffix","space":true},"lbf":{"text":"lbf","placement":"Suffix","space":true}}},"poundsForcePerCubicFoot":{"defaultSymbol":"lbForcePerFtSup3","unitSystem":"Imperial","parentUnits":{"poundsForce":1,"cubicFeet":-1},"symbols":{"lbForcePerFtSup3":{"text":"lb/ft","placement":"Suffix","space":true},"lbfPerFtSup3":{"text":"lbf/ft","placement":"Suffix","space":true}}},"poundsForcePerFoot":{"defaultSymbol":"lbForcePerFt","unitSystem":"Imperial","parentUnits":{"poundsForce":1,"feet":-1},"symbols":{"lbForcePerFt":{"text":"lb/ft","placement":"Suffix","space":true},"lbfPerFt":{"text":"lbf/ft","placement":"Suffix","space":true}}},"poundsForcePerSquareFoot":{"defaultSymbol":"lbForcePerFtSup2","unitSystem":"Imperial","parentUnits":{"poundsForce":1,"squareFeet":-1},"symbols":{"lbForcePerFtSup2":{"text":"lb/ft","placement":"Suffix","space":true},"lbfPerFtSup2":{"text":"lbf/ft","placement":"Suffix","space":true},"psf":{"text":"psf","placement":"Suffix","space":true}}},"poundsForcePerSquareInch":{"defaultSymbol":"lbForcePerInSup2","unitSystem":"Imperial","parentUnits":{"poundsForce":1,"squareInches":-1},"symbols":{"lbForcePerInSup2":{"text":"lb/in","placement":"Suffix","space":true},"lbfPerInSup2":{"text":"lbf/in","placement":"Suffix","space":true},"psi":{"text":"psi","placement":"Suffix","space":true},"psia":{"text":"psia","placement":"Suffix","space":true},"psig":{"text":"psig","placement":"Suffix","space":true}}},"poundsMass":{"defaultSymbol":"lbMass","unitSystem":"Imperial","factor":0.45359237,"parentUnits":{"kilograms":1},"symbols":{"lbMass":{"text":"lb","placement":"Suffix","space":true},"lbm":{"text":"lbm","placement":"Suffix","space":true}}},"poundsMassPerCubicFoot":{"defaultSymbol":"lbMassPerFtSup3","unitSystem":"Imperial","parentUnits":{"poundsMass":1,"cubicFeet":-1},"symbols":{"lbMassPerFtSup3":{"text":"lb/ft","placement":"Suffix","space":true},"lbmPerFtSup3":{"text":"lbm/ft","placement":"Suffix","space":true}}},"poundsMassPerCubicInch":{"defaultSymbol":"lbMassPerInSup3","unitSystem":"Imperial","parentUnits":{"poundsMass":1,"cubicInches":-1},"symbols":{"lbMassPerInSup3":{"text":"lb/in","placement":"Suffix","space":true},"lbmPerInSup3":{"text":"lbm/in","placement":"Suffix","space":true}}},"poundsMassPerFoot":{"defaultSymbol":"lbMassPerFt","unitSystem":"Imperial","parentUnits":{"poundsMass":1,"feet":-1},"symbols":{"lbMassPerFt":{"text":"lb/ft","placement":"Suffix","space":true},"lbmPerFt":{"text":"lbm/ft","placement":"Suffix","space":true}}},"poundsMassPerFootHour":{"defaultSymbol":"lbMassPerFtDashH","unitSystem":"Imperial","parentUnits":{"poundsMassPerFoot":1,"hours":-1},"symbols":{"lbMassPerFtDashH":{"text":"lb/ft-h","placement":"Suffix","space":true},"lbmPerFtDashH":{"text":"lbm/ft-h","placement":"Suffix","space":true}}},"poundsMassPerFootSecond":{"defaultSymbol":"lbMassPerFtDashS","unitSystem":"Imperial","parentUnits":{"poundsMassPerFoot":1,"seconds":-1},"symbols":{"lbMassPerFtDashS":{"text":"lb/ft-s","placement":"Suffix","space":true},"lbmPerFtDashS":{"text":"lbm/ft-s","placement":"Suffix","space":true}}},"poundsMassPerHour":{"unitSystem":"Imperial","parentUnits":{"poundsMass":1,"hours":-1},"symbols":{"lbMassPerH":{"text":"lb/h","placement":"Suffix","space":true}}},"poundsMassPerMinute":{"unitSystem":"Imperial","parentUnits":{"poundsMass":1,"minutes":-1},"symbols":{"lbMassPerMin":{"text":"lb/min","placement":"Suffix","space":true}}},"poundsMassPerPoundDegreeFahrenheit":{"unitSystem":"Imperial","parentUnits":{"poundsMass":1,"poundMassDegreesFahrenheit":-1},"symbols":{"lbMassPerLbDegreeF":{"text":"lb/(lbF)","placement":"Suffix","space":true}}},"poundsMassPerSecond":{"unitSystem":"Imperial","parentUnits":{"poundsMass":1,"seconds":-1},"symbols":{"lbMassPerS":{"text":"lb/s","placement":"Suffix","space":true}}},"poundsMassPerSquareFoot":{"unitSystem":"Imperial","parentUnits":{"poundsMass":1,"squareFeet":-1},"symbols":{"lbMassPerFtSup2":{"text":"lb/ft","placement":"Suffix","space":true}}},"radians":{"unitSystem":"Metric","symbols":{"rad":{"text":"rad","placement":"Suffix","space":true}}},"radiansPerSecond":{"unitSystem":"Metric","parentUnits":{"radians":1,"seconds":-1},"symbols":{"radPerS":{"text":"rad/s","placement":"Suffix","space":true}}},"rankine":{"unitSystem":"Imperial","parentUnit":"rankineInterval","symbols":{"degreeR":{"text":"R","placement":"Suffix","space":true}}},"rankineInterval":{"defaultSymbol":"degreeRInterval","unitSystem":"Imperial","parentFactors":{"nineFifths":-1},"parentUnits":{"kelvinInterval":1},"symbols":{"degreeRInterval":{"text":"R","placement":"Suffix","space":true},"deltaDegreeR":{"text":"deltaR","placement":"Suffix","space":true}}},"ratioTo1":{"unitSystem":"Metric","symbols":{"colon1":{"text":":1","placement":"Suffix","space":false}}},"ratioTo10":{"unitSystem":"Metric","parentFactors":{"ten":-1},"parentUnits":{"ratioTo1":1},"symbols":{"colon10":{"text":":10","placement":"Suffix","space":false}}},"ratioTo12":{"unitSystem":"Imperial","parentFactors":{"twelve":-1},"parentUnits":{"ratioTo1":1},"symbols":{"colon12":{"text":":12","placement":"Suffix","space":false}}},"revolutionsPerMinute":{"unitSystem":"Imperial","parentUnits":{"turns":1,"minutes":-1},"symbols":{"rpm":{"text":"RPM","placement":"Suffix","space":true}}},"revolutionsPerSecond":{"unitSystem":"Metric","parentUnits":{"turns":1,"seconds":-1},"symbols":{"rps":{"text":"RPS","placement":"Suffix","space":true}}},"riseDividedBy1000Millimeters":{"unitSystem":"Metric","parentUnits":{"perMille":1}},"riseDividedBy10Feet":{"unitSystem":"Imperial","parentUnits":{"ratioTo10":1}},"riseDividedBy120Inches":{"unitSystem":"Imperial","parentFactors":{"ten":-1},"parentUnits":{"riseDividedBy12Inches":1}},"riseDividedBy12Inches":{"unitSystem":"Imperial","parentUnits":{"ratioTo12":1}},"riseDividedBy1Foot":{"unitSystem":"Imperial","parentUnits":{"ratioTo1":1}},"seconds":{"unitSystem":"Metric","dimension":"time","symbols":{"second":{"text":"s","placement":"Suffix","space":true}}},"siemens":{"unitSystem":"Metric","parentUnits":{"mhos":1},"symbols":{"siemens":{"text":"S","placement":"Suffix","space":true}}},"slugs":{"unitSystem":"Imperial","parentUnits":{"poundsForce":1,"seconds":2,"feet":-1},"symbols":{"slug":{"text":"slug","placement":"Suffix","space":true}}},"squareCentimeters":{"defaultSymbol":"cmSup2","unitSystem":"Metric","parentUnits":{"centimeters":2},"symbols":{"cmCaret2":{"text":"cm^2","placement":"Suffix","space":true},"cmSup2":{"text":"cm","placement":"Suffix","space":true}}},"squareCentimetersPerMeter":{"unitSystem":"Metric","parentUnits":{"squareCentimeters":1,"meters":-1},"symbols":{"cmSup2PerM":{"text":"cm/m","placement":"Suffix","space":true}}},"squareFeet":{"defaultSymbol":"ftSup2","unitSystem":"Imperial","parentUnits":{"feet":2},"symbols":{"ftCaret2":{"text":"ft^2","placement":"Suffix","space":true},"ftSup2":{"text":"ft","placement":"Suffix","space":true},"sf":{"text":"SF","placement":"Suffix","space":true}}},"squareFeetPer1000BritishThermalUnitsPerHour":{"defaultSymbol":"ftSup2HPerKbtu","unitSystem":"Imperial","factor":0.001,"parentUnits":{"squareFeet":1,"britishThermalUnitsPerHour":-1},"symbols":{"ftSup2HPerKbtu":{"text":"fth/kBtu","placement":"Suffix","space":true},"ftSup2PerMbh":{"text":"ft/MBh","placement":"Suffix","space":true},"sfHPerKbtu":{"text":"SFh/kBtu","placement":"Suffix","space":true},"sfPerMbh":{"text":"SF/MBh","placement":"Suffix","space":true}}},"squareFeetPerFoot":{"unitSystem":"Imperial","parentUnits":{"squareFeet":1,"feet":-1},"symbols":{"ftSup2PerFt":{"text":"ft/ft","placement":"Suffix","space":true}}},"squareFeetPerKip":{"unitSystem":"Imperial","parentUnits":{"squareFeet":1,"kips":-1},"symbols":{"ftSup2PerKip":{"text":"ft/kip","placement":"Suffix","space":true}}},"squareFeetPerKipFoot":{"unitSystem":"Imperial","parentUnits":{"squareFeet":1,"kipFeet":-1},"symbols":{"ftSup2PerKipDashFt":{"text":"ft/kip-ft","placement":"Suffix","space":true}}},"squareFeetPerSecond":{"unitSystem":"Imperial","parentUnits":{"squareFeet":1,"seconds":-1},"symbols":{"ftSup2PerS":{"text":"ft/s","placement":"Suffix","space":true}}},"squareFeetPerTonOfRefrigeration":{"defaultSymbol":"ftSup2PerTon","unitSystem":"Imperial","parentUnits":{"squareFeet":1,"tonsOfRefrigeration":-1},"symbols":{"ftSup2PerTon":{"text":"ft/ton","placement":"Suffix","space":true},"sfPerTon":{"text":"SF/ton","placement":"Suffix","space":true}}},"squareHectometers":{"unitSystem":"Metric","parentUnits":{"hectometers":2},"symbols":{"hmSup2":{"text":"hm","placement":"Suffix","space":true}}},"squareInches":{"defaultSymbol":"inSup2","unitSystem":"Imperial","parentUnits":{"inches":2},"symbols":{"inCaret2":{"text":"in^2","placement":"Suffix","space":true},"inSup2":{"text":"in","placement":"Suffix","space":true}}},"squareInchesPerFoot":{"unitSystem":"Imperial","parentUnits":{"squareInches":1,"feet":-1},"symbols":{"inSup2PerFt":{"text":"in/ft","placement":"Suffix","space":true}}},"squareMeterKelvinsPerWatt":{"unitSystem":"Metric","parentUnits":{"squareMeters":1,"kelvinInterval":1,"watts":-1},"symbols":{"mSup2KPerW":{"text":"(mK)/W","placement":"Suffix","space":true}}},"squareMeters":{"defaultSymbol":"mSup2","unitSystem":"Metric","parentUnits":{"meters":2},"symbols":{"mCaret2":{"text":"m^2","placement":"Suffix","space":true},"mSup2":{"text":"m","placement":"Suffix","space":true}}},"squareMetersPerKilonewton":{"unitSystem":"Metric","parentUnits":{"squareMeters":1,"kilonewtons":-1},"symbols":{"mSup2PerKN":{"text":"m/kN","placement":"Suffix","space":true}}},"squareMetersPerKilonewtonMeter":{"unitSystem":"Metric","parentUnits":{"squareMeters":1,"kilonewtonMeters":-1},"symbols":{"mSup2PerKNDashM":{"text":"m/kN-m","placement":"Suffix","space":true}}},"squareMetersPerKilowatt":{"unitSystem":"Metric","parentUnits":{"squareMeters":1,"kilowatts":-1},"symbols":{"mSup2PerKw":{"text":"m/kW","placement":"Suffix","space":true}}},"squareMetersPerMeter":{"unitSystem":"Metric","parentUnits":{"squareMeters":1,"meters":-1},"symbols":{"mSup2PerM":{"text":"m/m","placement":"Suffix","space":true}}},"squareMetersPerSecond":{"unitSystem":"Metric","parentUnits":{"squareMeters":1,"seconds":-1},"symbols":{"mSup2PerS":{"text":"m/s","placement":"Suffix","space":true}}},"squareMillimeters":{"defaultSymbol":"mmSup2","unitSystem":"Metric","parentUnits":{"millimeters":2},"symbols":{"mmCaret2":{"text":"mm^2","placement":"Suffix","space":true},"mmSup2":{"text":"mm","placement":"Suffix","space":true}}},"squareMillimetersPerMeter":{"unitSystem":"Metric","parentUnits":{"squareMillimeters":1,"meters":-1},"symbols":{"mmSup2PerM":{"text":"mm/m","placement":"Suffix","space":true}}},"squareMils":{"defaultSymbol":"milSup2","unitSystem":"Imperial","parentUnits":{"mils":2},"symbols":{"milCaret2":{"text":"mil^2","placement":"Suffix","space":true},"milSup2":{"text":"mil","placement":"Suffix","space":true}}},"squareYards":{"unitSystem":"Imperial","parentUnits":{"yards":2},"symbols":{"ydSup2":{"text":"yd","placement":"Suffix","space":true}}},"standardGravity":{"unitSystem":"Metric","factor":9.80665,"parentUnits":{"metersPerSecondSquared":1},"symbols":{"gravity":{"text":"","placement":"Suffix","space":true}}},"steradians":{"unitSystem":"Metric","symbols":{"sr":{"text":"sr","placement":"Suffix","space":true}}},"teslas":{"unitSystem":"Metric","parentUnits":{"webers":1,"meters":-2},"symbols":{"tesla":{"text":"T","placement":"Suffix","space":true}}},"therms":{"unitSystem":"Imperial","factor":100000,"parentUnits":{"britishThermalUnits":1},"symbols":{"therm":{"text":"therm","placement":"Suffix","space":true}}},"thousandBritishThermalUnits":{"unitSystem":"Imperial","parentFactors":{"kilo":1},"parentUnits":{"britishThermalUnits":1},"symbols":{"kBtu":{"text":"kBtu","placement":"Suffix","space":true}}},"thousandBritishThermalUnitsPerHour":{"unitSystem":"Imperial","factor":1000,"parentUnits":{"britishThermalUnitsPerHour":1},"symbols":{"mbh":{"text":"MBH","placement":"Suffix","space":true}}},"thousandBritishThermalUnitsPerSquareFoot":{"unitSystem":"Imperial","parentUnits":{"thousandBritishThermalUnits":1,"squareFeet":-1},"symbols":{"kBtuPerFtSup2":{"text":"kBtu/ft","placement":"Suffix","space":true}}},"tonneForceMeters":{"unitSystem":"Metric","parentUnits":{"tonnesForce":1,"meters":1},"symbols":{"tfDashM":{"text":"Tf-m","placement":"Suffix","space":true}}},"tonneForceMetersPerMeter":{"unitSystem":"Metric","parentUnits":{"tonneForceMeters":1,"meters":-1},"symbols":{"tfDashMPerM":{"text":"Tf-m/m","placement":"Suffix","space":true}}},"tonnes":{"unitSystem":"Metric","factor":1000,"parentUnits":{"kilograms":1},"symbols":{"tonne":{"text":"t","placement":"Suffix","space":true}}},"tonnesForce":{"unitSystem":"Metric","parentUnits":{"tonnes":1,"standardGravity":1},"symbols":{"tf":{"text":"Tf","placement":"Suffix","space":true}}},"tonnesForcePerMeter":{"unitSystem":"Metric","parentUnits":{"tonnesForce":1,"meters":-1},"symbols":{"tfPerM":{"text":"Tf/m","placement":"Suffix","space":true}}},"tonnesForcePerSquareMeter":{"unitSystem":"Metric","parentUnits":{"tonnesForce":1,"squareMeters":-1},"symbols":{"tfPerMSup2":{"text":"Tf/m","placement":"Suffix","space":true}}},"tonsOfRefrigeration":{"defaultSymbol":"ton","unitSystem":"Imperial","factor":12000,"parentUnits":{"britishThermalUnitsPerHour":1},"symbols":{"ton":{"text":"ton","placement":"Suffix","space":true},"tonOfRefrigeration":{"text":"ton of refrigeration","placement":"Suffix","space":true}}},"turns":{"unitSystem":"Metric","factor":2,"parentFactors":{"pi":1},"parentUnits":{"radians":1},"symbols":{"tr":{"text":"tr","placement":"Suffix","space":true}}},"usGallons":{"unitSystem":"Imperial","factor":231,"parentUnits":{"cubicInches":1},"symbols":{"gal":{"text":"gal","placement":"Suffix","space":true}}},"usGallonsPerHour":{"defaultSymbol":"galPerH","unitSystem":"Imperial","parentUnits":{"usGallons":1,"hours":-1},"symbols":{"galPerH":{"text":"gal/h","placement":"Suffix","space":true},"gph":{"text":"GPH","placement":"Suffix","space":true},"usgph":{"text":"usgph","placement":"Suffix","space":true}}},"usGallonsPerMinute":{"defaultSymbol":"galPerMin","unitSystem":"Imperial","parentUnits":{"usGallons":1,"minutes":-1},"symbols":{"galPerMin":{"text":"gal/min","placement":"Suffix","space":true},"gpm":{"text":"GPM","placement":"Suffix","space":true},"usgpm":{"text":"usgpm","placement":"Suffix","space":true}}},"usSurveyFeet":{"unitSystem":"Imperial","factor":1200,"parentFactors":{"threeThousandNineHundredThirtySeven":-1},"parentUnits":{"meters":1},"symbols":{"usft":{"text":"USft","placement":"Suffix","space":true}}},"usTonnesForce":{"defaultSymbol":"stf","unitSystem":"Imperial","parentUnits":{"usTonnesMass":1,"standardGravity":1},"symbols":{"stf":{"text":"STf","placement":"Suffix","space":true},"tonsf":{"text":"Tonsf","placement":"Suffix","space":true},"usTonnesForceSt":{"text":"ST","placement":"Suffix","space":true},"usTonnesForceT":{"text":"T","placement":"Suffix","space":true},"usTonnesForceTons":{"text":"Tons","placement":"Suffix","space":true}}},"usTonnesMass":{"defaultSymbol":"usTonnesMassSt","unitSystem":"Imperial","factor":2000,"parentUnits":{"poundsMass":1},"symbols":{"usTonnesMassSt":{"text":"ST","placement":"Suffix","space":true},"usTonnesMassT":{"text":"T","placement":"Suffix","space":true},"usTonnesMassTons":{"text":"Tons","placement":"Suffix","space":true}}},"voltAmperes":{"unitSystem":"Metric","parentUnits":{"volts":1,"amperes":1},"symbols":{"vA":{"text":"VA","placement":"Suffix","space":true}}},"voltAmperesPerSquareFoot":{"unitSystem":"Imperial","parentUnits":{"voltAmperes":1,"squareFeet":-1},"symbols":{"vAPerFtSup2":{"text":"VA/ft","placement":"Suffix","space":true}}},"voltAmperesPerSquareMeter":{"unitSystem":"Metric","parentUnits":{"voltAmperes":1,"squareMeters":-1},"symbols":{"vAPerMSup2":{"text":"VA/m","placement":"Suffix","space":true}}},"volts":{"unitSystem":"Metric","parentUnits":{"watts":1,"amperes":-1},"symbols":{"volt":{"text":"V","placement":"Suffix","space":true}}},"waterDensity4DegreesCelsius":{"unitSystem":"Metric","parentUnits":{"kilograms":1,"liters":-1}},"watts":{"unitSystem":"Metric","parentUnits":{"joules":1,"seconds":-1},"symbols":{"watt":{"text":"W","placement":"Suffix","space":true}}},"wattsPerCubicFoot":{"unitSystem":"Imperial","parentUnits":{"watts":1,"cubicFeet":-1},"symbols":{"wPerFtSup3":{"text":"W/ft","placement":"Suffix","space":true}}},"wattsPerCubicFootPerMinute":{"unitSystem":"Imperial","parentUnits":{"watts":1,"cubicFeetPerMinute":-1},"symbols":{"wMinPerFtSup3":{"text":"Wmin/ft","placement":"Suffix","space":true}}},"wattsPerCubicMeter":{"unitSystem":"Metric","parentUnits":{"watts":1,"cubicMeters":-1},"symbols":{"wPerMSup3":{"text":"W/m","placement":"Suffix","space":true}}},"wattsPerCubicMeterPerSecond":{"unitSystem":"Metric","parentUnits":{"watts":1,"cubicMetersPerSecond":-1},"symbols":{"wSPerMSup3":{"text":"Ws/m","placement":"Suffix","space":true}}},"wattsPerFoot":{"unitSystem":"Imperial","parentUnits":{"watts":1,"feet":-1},"symbols":{"wPerFt":{"text":"W/ft","placement":"Suffix","space":true}}},"wattsPerMeter":{"unitSystem":"Metric","parentUnits":{"watts":1,"meters":-1},"symbols":{"wPerM":{"text":"W/m","placement":"Suffix","space":true}}},"wattsPerMeterKelvin":{"unitSystem":"Metric","parentUnits":{"watts":1,"meters":-1,"kelvinInterval":-1},"symbols":{"wPerMK":{"text":"W/(mK)","placement":"Suffix","space":true}}},"wattsPerSquareFoot":{"unitSystem":"Imperial","parentUnits":{"watts":1,"squareFeet":-1},"symbols":{"wPerFtSup2":{"text":"W/ft","placement":"Suffix","space":true}}},"wattsPerSquareMeter":{"unitSystem":"Metric","parentUnits":{"watts":1,"squareMeters":-1},"symbols":{"wPerMSup2":{"text":"W/m","placement":"Suffix","space":true}}},"wattsPerSquareMeterKelvin":{"unitSystem":"Metric","parentUnits":{"wattsPerSquareMeter":1,"kelvinInterval":-1},"symbols":{"wPerMSup2K":{"text":"W/(mK)","placement":"Suffix","space":true}}},"webers":{"unitSystem":"Metric","parentUnits":{"volts":1,"seconds":1},"symbols":{"wb":{"text":"Wb","placement":"Suffix","space":true}}},"yards":{"unitSystem":"Imperial","factor":3,"parentUnits":{"feet":1},"symbols":{"yd":{"text":"yd","placement":"Suffix","space":true}}},"feetFractionalInches":{"defaultSymbol":"feetAndInches","unitSystem":"Imperial","factor":12,"parentUnits":{"inches":1},"symbols":{"feetAndInches":{"inherits":"symbol"},"footSingleQuote":{"text":"\'","placement":"Suffix","space":false},"ft":{"text":"ft","placement":"Suffix","space":true},"lf":{"text":"LF","placement":"Suffix","space":true}}},"fractionalInches":{"defaultSymbol":"in","unitSystem":"Imperial","factor":2.54,"parentUnits":{"centimeters":1},"symbols":{"in":{"text":"in","placement":"Suffix","space":true},"inchDoubleQuote":{"text":"\\"","placement":"Suffix","space":false}}},"metersCentimeters":{"defaultSymbol":"meter","unitSystem":"Metric","dimension":"length","symbols":{"meter":{"text":"m","placement":"Suffix","space":true},"metersAndCentimeters":{"inherits":"symbol"}}},"degreesMinutes":{"defaultSymbol":"degree","unitSystem":"Metric","parentFactors":{"threeHundredSixty":-1},"parentUnits":{"turns":1},"symbols":{"degree":{"text":"","placement":"Suffix","space":false},"degreesMinutesSeconds":{"inherits":"symbol"}}},"slopeDegrees":{"defaultSymbol":"slopeDegree","unitSystem":"Metric","parentFactors":{"threeHundredSixty":-1},"parentUnits":{"turns":1},"symbols":{"slopeDegree":{"text":"","placement":"Suffix","space":false}}},"stationingFeet":{"defaultSymbol":"feetAndInches","unitSystem":"Imperial","factor":12,"parentUnits":{"inches":1},"symbols":{"feetAndInches":{"inherits":"symbol"},"footSingleQuote":{"text":"\'","placement":"Suffix","space":false},"ft":{"text":"ft","placement":"Suffix","space":true},"lf":{"text":"LF","placement":"Suffix","space":true}}},"stationingMeters":{"defaultSymbol":"meter","unitSystem":"Metric","dimension":"length","symbols":{"meter":{"text":"m","placement":"Suffix","space":true},"metersAndCentimeters":{"inherits":"symbol"}}},"stationingSurveyFeet":{"unitSystem":"Imperial","factor":1200,"parentFactors":{"threeThousandNineHundredThirtySeven":-1},"parentUnits":{"meters":1},"symbols":{"usft":{"text":"USft","placement":"Suffix","space":true}}},"dateTime":{"symbols":{"date":{"text":"Date"},"dateTime":{"text":"ISODate","description":"default"},"dateAndTime":{"text":"Date, Time"}}}},"quantity":{"acceleration":{"units":["metersPerSecondSquared","kilometersPerSecondSquared","inchesPerSecondSquared","feetPerSecondSquared","milesPerSecondSquared","standardGravity"]},"angle":{"units":["degrees","radians","gradians","turns"]},"angularLineSpringCoefficient":{"units":["kipFeetPerDegreePerFoot","kilonewtonMetersPerDegreePerMeter"]},"angularPointSpringCoefficient":{"units":["kipFeetPerDegree","kilonewtonMetersPerDegree"]},"angularSpeed":{"units":["radiansPerSecond","revolutionsPerMinute"]},"area":{"units":["squareFeet","squareInches","squareMeters","squareCentimeters","squareHectometers","squareMillimeters","acres","hectares","squareYards","circularMils","squareMils"]},"areaPerLength":{"units":["squareFeetPerFoot","squareCentimetersPerMeter","squareMillimetersPerMeter","squareInchesPerFoot","squareMetersPerMeter"]},"areaPerPower":{"units":["squareFeetPerTonOfRefrigeration","squareMetersPerKilowatt","squareFeetPer1000BritishThermalUnitsPerHour"]},"areaPerTorque":{"units":["squareFeetPerKipFoot","squareMetersPerKilonewtonMeter"]},"colorTemperature":{"units":["kelvin"]},"costPerArea":{"units":["currencyPerSquareFoot","currencyPerSquareMeter"]},"currency":{"units":["currency"]},"density":{"units":["kilogramsPerCubicMeter","poundsMassPerCubicInch","poundsMassPerCubicFoot"]},"diffusivity":{"units":["squareFeetPerSecond","squareMetersPerSecond"]},"dynamicViscosity":{"units":["centipoises","kilogramsPerMeterHour","kilogramsPerMeterSecond","newtonSecondsPerSquareMeter","pascalSeconds","poises","poundForceSecondsPerSquareFoot","poundsMassPerFootHour","poundsMassPerFootSecond"]},"electricCapacitance":{"units":["farads"]},"electricCharge":{"units":["coulombs","ampereHours","ampereSeconds"]},"electricConductance":{"units":["mhos","siemens"]},"electricCurrent":{"units":["amperes","kiloamperes","milliamperes"]},"electricInductance":{"units":["henries"]},"electricPotential":{"units":["volts","kilovolts","millivolts"]},"electricResistance":{"units":["ohms"]},"electricResistivity":{"units":["ohmMeters"]},"energy":{"units":["joules","newtonMeters","kilogramForceMeters","poundForceFeet","kilojoules","britishThermalUnits","calories","kilocalories","kilowattHours","therms","ergs"]},"flow":{"units":["cubicFeetPerMinute","cubicFeetPerHour","cubicMetersPerSecond","cubicMetersPerHour","litersPerHour","litersPerMinute","litersPerSecond","usGallonsPerMinute","usGallonsPerHour"]},"flowPerArea":{"units":["cubicFeetPerMinuteSquareFoot","litersPerSecondSquareMeter"]},"flowPerPower":{"units":["cubicFeetPerMinutePerBritishThermalUnitPerHour","cubicFeetPerMinuteTonOfRefrigeration","cubicMetersPerWattSecond","litersPerSecondKilowatt","squareFeetPerKip","squareMetersPerKilonewton"]},"flowPerVolume":{"units":["cubicFeetPerMinuteCubicFoot","litersPerSecondCubicMeter"]},"force":{"units":["newtons","dekanewtons","kilonewtons","meganewtons","kips","kilogramsForce","tonnesForce","usTonnesForce","poundsForce","dynes","ouncesForce"]},"forceDensity":{"units":["kilonewtonsPerCubicMeter","poundsForcePerCubicFoot","kipsPerCubicInch","kipsPerCubicFoot"]},"forcePerLength":{"units":["newtonsPerMeter","dekanewtonsPerMeter","kilonewtonsPerMeter","meganewtonsPerMeter","kipsPerFoot","kilogramsForcePerMeter","tonnesForcePerMeter","poundsForcePerFoot","kipsPerInch"]},"frequency":{"units":["hertz","cyclesPerSecond"]},"friction":{"units":["pascalsPerMeter","feetOfWater39.2DegreesFahrenheitPer100Feet","inchesOfWater60DegreesFahrenheitPer100Feet"]},"heatCapacity":{"units":["britishThermalUnitsPerDegreeFahrenheit","joulesPerKelvin","kilojoulesPerKelvin"]},"heatTransferCoefficient":{"units":["wattsPerSquareMeterKelvin","britishThermalUnitsPerHourSquareFootDegreeFahrenheit"]},"illuminance":{"units":["lux","footcandles"]},"length":{"units":["centimeters","decimeters","feet","hectometers","inches","kilometers","meters","microinches","microns","miles","millimeters","mils","nanometers","nauticalMiles","usSurveyFeet","yards"]},"lengthPerTorque":{"units":["metersPerKilonewtonMeter","feetPerKipFoot"]},"lightingEfficacy":{"units":["lumensPerWatt"]},"luminance":{"units":["footlamberts","candelasPerSquareFoot","candelasPerSquareMeter"]},"luminousFlux":{"units":["lumens"]},"luminousIntensity":{"units":["candelas"]},"magneticFieldStrength":{"units":["oersteds"]},"magneticFlux":{"units":["webers","maxwells"]},"magneticFluxDensity":{"units":["teslas","gauss","gammas"]},"mass":{"units":["kilograms","tonnes","poundsMass","grams","milligrams","nanograms","grains","usTonnesMass","slugs","ouncesMass"]},"massPerArea":{"units":["kilogramsPerSquareMeter","poundsMassPerSquareFoot"]},"massPerLength":{"units":["kilogramsPerMeter","poundsMassPerFoot"]},"massPerTime":{"units":["poundsMassPerHour","poundsMassPerMinute","poundsMassPerSecond","kilogramsPerHour","kilogramsPerMinute","kilogramsPerSecond"]},"number":{"units":["general","fixed","percentage"]},"permeability":{"units":["nanogramsPerPascalSecondSquareMeter","grainsPerHourSquareFootInchMercury"]},"power":{"units":["watts","kilowatts","britishThermalUnitsPerSecond","britishThermalUnitsPerHour","caloriesPerSecond","kilocaloriesPerSecond","voltAmperes","kilovoltAmperes","horsepower","thousandBritishThermalUnitsPerHour","tonsOfRefrigeration"]},"powerDensity":{"units":["wattsPerCubicFoot","wattsPerCubicMeter","britishThermalUnitsPerHourCubicFoot"]},"powerPerArea":{"units":["wattsPerSquareFoot","wattsPerSquareMeter","britishThermalUnitsPerHourSquareFoot"]},"powerPerFlow":{"units":["wattsPerCubicFootPerMinute","wattsPerCubicMeterPerSecond"]},"powerPerLength":{"units":["wattsPerFoot","wattsPerMeter"]},"pressure":{"units":["pascals","kilopascals","megapascals","poundsForcePerSquareInch","inchesOfMercury32DegreesFahrenheit","millimetersOfMercury","atmospheres","bars","feetOfWater39.2DegreesFahrenheit","inchesOfWater60DegreesFahrenheit"]},"ratio":{"units":["fixed","percentage","perMille","ratioTo1","ratioTo10","ratioTo12","1ToRatio"]},"secondMomentOfArea":{"units":["feetToTheFourthPower","inchesToTheFourthPower","millimetersToTheFourthPower","centimetersToTheFourthPower","metersToTheFourthPower"]},"slope":{"units":["percentage","ratioTo1","ratioTo10","ratioTo12","riseDividedBy12Inches","riseDividedBy1Foot","riseDividedBy1000Millimeters","riseDividedBy120Inches","1ToRatio","riseDividedBy10Feet","perMille"]},"solidAngle":{"units":["steradians"]},"specificEnergy":{"units":["joulesPerGram","joulesPerKilogram","britishThermalUnitsPerPound"]},"specificHeatCapacity":{"units":["joulesPerGramDegreeCelsius","britishThermalUnitsPerPoundDegreeFahrenheit","joulesPerKilogramDegreeCelsius"]},"stress":{"units":["pascals","kilopascals","megapascals","poundsForcePerSquareInch","bars","newtonsPerSquareMeter","dekanewtonsPerSquareMeter","kilonewtonsPerSquareMeter","meganewtonsPerSquareMeter","kipsPerSquareFoot","kilogramsForcePerSquareMeter","tonnesForcePerSquareMeter","poundsForcePerSquareFoot","kipsPerSquareInch","kilonewtonsPerSquareCentimeter","newtonsPerSquareMillimeter","kilonewtonsPerSquareMillimeter"]},"temperature":{"units":["fahrenheit","celsius","kelvin","rankine"]},"temperatureInterval":{"units":["fahrenheitInterval","celsiusInterval","kelvinInterval","rankineInterval"]},"thermalConductivity":{"units":["wattsPerMeterKelvin","britishThermalUnitsPerHourFootDegreeFahrenheit"]},"thermalExpansionCoefficient":{"units":["inverseDegreesFahrenheit","inverseDegreesCelsius","micrometersPerMeterDegreeCelsius","microinchesPerInchDegreeFahrenheit"]},"thermalInsulance":{"units":["hourSquareFootDegreesFahrenheitPerBritishThermalUnit","squareMeterKelvinsPerWatt"]},"time":{"units":["milliseconds","seconds","minutes","hours"]},"torque":{"units":["newtonMeters","dekanewtonMeters","kilonewtonMeters","meganewtonMeters","kipFeet","kilogramForceMeters","tonneForceMeters","poundForceFeet"]},"torquePerLength":{"units":["newtonMetersPerMeter","dekanewtonMetersPerMeter","kilonewtonMetersPerMeter","meganewtonMetersPerMeter","kipFeetPerFoot","kilogramForceMetersPerMeter","tonneForceMetersPerMeter","poundForceFeetPerFoot"]},"velocity":{"units":["feetPerMinute","centimetersPerMinute","inchesPerSecond","metersPerSecond","feetPerSecond","kilometersPerSecond","milesPerSecond","kilometersPerHour","milesPerHour"]},"volume":{"units":["cubicYards","cubicFeet","cubicInches","cubicMeters","cubicCentimeters","cubicMillimeters","liters","usGallons"]},"volumePerForce":{"units":["cubicFeetPerKip","cubicMetersPerKilonewton"]},"warpingCoefficient":{"units":["feetToTheSixthPower","inchesToTheSixthPower","millimetersToTheSixthPower","centimetersToTheSixthPower","metersToTheSixthPower"]}}}')}},n={};function i(e){var t=n[e];if(void 0!==t)return t.exports;var o=n[e]={id:e,loaded:!1,exports:{}};return r[e].call(o.exports,o,o.exports,i),o.loaded=!0,o.exports}i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,i.t=function(r,n){if(1&n&&(r=this(r)),8&n)return r;if("object"==typeof r&&r){if(4&n&&r.__esModule)return r;if(16&n&&"function"==typeof r.then)return r}var o=Object.create(null);i.r(o);var a={};e=e||[null,t({}),t([]),t(t)];for(var s=2&n&&r;"object"==typeof s&&!~e.indexOf(s);s=t(s))Object.getOwnPropertyNames(s).forEach((e=>a[e]=()=>r[e]));return a.default=()=>r,i.d(o,a),o},i.d=(e,t)=>{for(var r in t)i.o(t,r)&&!i.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.nmd=e=>(e.paths=[],e.children||(e.children=[]),e);var o=i(78808);LMV=o})();
//# sourceMappingURL=viewer3D.min.js.map